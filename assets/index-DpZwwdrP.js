(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const sS=!1,aS=(t,e)=>t===e,Fo=Symbol("solid-proxy"),$b=typeof Proxy=="function",ph=Symbol("solid-track"),fh={equals:aS};let Eb=Fb;const ja=1,mh=2,Tb={owned:null,cleanups:null,context:null,owner:null};var Jr=null;let Fp=null,lS=null,cn=null,$i=null,Ds=null,Wh=0;function vl(t,e){const r=cn,n=Jr,i=t.length===0,o=e===void 0?n:e,s=i?Tb:{owned:null,cleanups:null,context:o?o.context:null,owner:o},l=i?t:()=>t(()=>Qi(()=>Iu(s)));Jr=s,cn=null;try{return Va(l,!0)}finally{cn=r,Jr=n}}function Ce(t,e){e=e?Object.assign({},fh,e):fh;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.value)),Mb(r,i));return[Db.bind(r),n]}function we(t,e,r){const n=Bm(t,e,!1,ja);zu(n)}function Ei(t,e,r){Eb=hS;const n=Bm(t,e,!1,ja);n.user=!0,Ds?Ds.push(n):zu(n)}function Lt(t,e,r){r=r?Object.assign({},fh,r):fh;const n=Bm(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,zu(n),Db.bind(n)}function kb(t){return Va(t,!1)}function Qi(t){if(cn===null)return t();const e=cn;cn=null;try{return t()}finally{cn=e}}function Mm(t,e,r){const n=Array.isArray(t);let i,o=r&&r.defer;return s=>{let l;if(n){l=Array(t.length);for(let u=0;u<t.length;u++)l[u]=t[u]()}else l=t();if(o)return o=!1,s;const c=Qi(()=>e(l,i,s));return i=l,c}}function Cn(t){Ei(()=>Qi(t))}function kl(t){return Jr===null||(Jr.cleanups===null?Jr.cleanups=[t]:Jr.cleanups.push(t)),t}function Of(){return cn}function Nb(){return Jr}function Lb(t,e){const r=Jr,n=cn;Jr=t,cn=null;try{return Va(e,!0)}catch(i){jm(i)}finally{Jr=r,cn=n}}function cS(t){const e=cn,r=Jr;return Promise.resolve().then(()=>{cn=e,Jr=r;let n;return Va(t,!1),cn=Jr=null,n?n.done:void 0})}const[$8,E8]=Ce(!1);function Rb(t,e){const r=Symbol("context");return{id:r,Provider:fS(r),defaultValue:t}}function Fm(t){let e;return Jr&&Jr.context&&(e=Jr.context[t.id])!==void 0?e:t.defaultValue}function Om(t){const e=Lt(t),r=Lt(()=>Bf(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function Db(){if(this.sources&&this.state)if(this.state===ja)zu(this);else{const t=$i;$i=null,Va(()=>gh(this),!1),$i=t}if(cn){const t=this.observers?this.observers.length:0;cn.sources?(cn.sources.push(this),cn.sourceSlots.push(t)):(cn.sources=[this],cn.sourceSlots=[t]),this.observers?(this.observers.push(cn),this.observerSlots.push(cn.sources.length-1)):(this.observers=[cn],this.observerSlots=[cn.sources.length-1])}return this.value}function Mb(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&Va(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],s=Fp&&Fp.running;s&&Fp.disposed.has(o),(s?!o.tState:!o.state)&&(o.pure?$i.push(o):Ds.push(o),o.observers&&Ob(o)),s||(o.state=ja)}if($i.length>1e6)throw $i=[],new Error},!1)),e}function zu(t){if(!t.fn)return;Iu(t);const e=Wh;uS(t,t.value,e)}function uS(t,e,r){let n;const i=Jr,o=cn;cn=Jr=t;try{n=t.fn(e)}catch(s){return t.pure&&(t.state=ja,t.owned&&t.owned.forEach(Iu),t.owned=null),t.updatedAt=r+1,jm(s)}finally{cn=o,Jr=i}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?Mb(t,n):t.value=n,t.updatedAt=r)}function Bm(t,e,r,n=ja,i){const o={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Jr,context:Jr?Jr.context:null,pure:r};return Jr===null||Jr!==Tb&&(Jr.owned?Jr.owned.push(o):Jr.owned=[o]),o}function yh(t){if(t.state===0)return;if(t.state===mh)return gh(t);if(t.suspense&&Qi(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Wh);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===ja)zu(t);else if(t.state===mh){const n=$i;$i=null,Va(()=>gh(t,e[0]),!1),$i=n}}function Va(t,e){if($i)return t();let r=!1;e||($i=[]),Ds?r=!0:Ds=[],Wh++;try{const n=t();return dS(r),n}catch(n){r||(Ds=null),$i=null,jm(n)}}function dS(t){if($i&&(Fb($i),$i=null),t)return;const e=Ds;Ds=null,e.length&&Va(()=>Eb(e),!1)}function Fb(t){for(let e=0;e<t.length;e++)yh(t[e])}function hS(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:yh(n)}for(e=0;e<r;e++)yh(t[e])}function gh(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const i=n.state;i===ja?n!==e&&(!n.updatedAt||n.updatedAt<Wh)&&yh(n):i===mh&&gh(n,e)}}}function Ob(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=mh,r.pure?$i.push(r):Ds.push(r),r.observers&&Ob(r))}}function Iu(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),s=r.observerSlots.pop();n<i.length&&(o.sourceSlots[s]=n,i[n]=o,r.observerSlots[n]=s)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Iu(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Iu(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function pS(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function jm(t,e=Jr){throw pS(t)}function Bf(t){if(typeof t=="function"&&!t.length)return Bf(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=Bf(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function fS(t,e){return function(n){let i;return we(()=>i=Qi(()=>(Jr.context={...Jr.context,[t]:n.value},Om(()=>n.children))),void 0),i}}const jf=Symbol("fallback");function vh(t){for(let e=0;e<t.length;e++)t[e]()}function mS(t,e,r={}){let n=[],i=[],o=[],s=0,l=e.length>1?[]:null;return kl(()=>vh(o)),()=>{let c=t()||[],u=c.length,h,m;return c[ph],Qi(()=>{let f,w,x,S,C,j,oe,te,Z;if(u===0)s!==0&&(vh(o),o=[],n=[],i=[],s=0,l&&(l=[])),r.fallback&&(n=[jf],i[0]=vl(re=>(o[0]=re,r.fallback())),s=1);else if(s===0){for(i=new Array(u),m=0;m<u;m++)n[m]=c[m],i[m]=vl(g);s=u}else{for(x=new Array(u),S=new Array(u),l&&(C=new Array(u)),j=0,oe=Math.min(s,u);j<oe&&n[j]===c[j];j++);for(oe=s-1,te=u-1;oe>=j&&te>=j&&n[oe]===c[te];oe--,te--)x[te]=i[oe],S[te]=o[oe],l&&(C[te]=l[oe]);for(f=new Map,w=new Array(te+1),m=te;m>=j;m--)Z=c[m],h=f.get(Z),w[m]=h===void 0?-1:h,f.set(Z,m);for(h=j;h<=oe;h++)Z=n[h],m=f.get(Z),m!==void 0&&m!==-1?(x[m]=i[h],S[m]=o[h],l&&(C[m]=l[h]),m=w[m],f.set(Z,m)):o[h]();for(m=j;m<u;m++)m in x?(i[m]=x[m],o[m]=S[m],l&&(l[m]=C[m],l[m](m))):i[m]=vl(g);i=i.slice(0,s=u),n=c.slice(0)}return i});function g(f){if(o[m]=f,l){const[w,x]=Ce(m);return l[m]=x,e(c[m],w)}return e(c[m])}}}function yS(t,e,r={}){let n=[],i=[],o=[],s=[],l=0,c;return kl(()=>vh(o)),()=>{const u=t()||[],h=u.length;return u[ph],Qi(()=>{if(h===0)return l!==0&&(vh(o),o=[],n=[],i=[],l=0,s=[]),r.fallback&&(n=[jf],i[0]=vl(g=>(o[0]=g,r.fallback())),l=1),i;for(n[0]===jf&&(o[0](),o=[],n=[],i=[],l=0),c=0;c<h;c++)c<n.length&&n[c]!==u[c]?s[c](()=>u[c]):c>=n.length&&(i[c]=vl(m));for(;c<n.length;c++)o[c]();return l=s.length=o.length=h,n=u.slice(0),i=i.slice(0,l)});function m(g){o[c]=g;const[f,w]=Ce(u[c]);return s[c]=w,e(f,c)}}}function D(t,e){return Qi(()=>t(e||{}))}function $d(){return!0}const Vf={get(t,e,r){return e===Fo?r:t.get(e)},has(t,e){return e===Fo?!0:t.has(e)},set:$d,deleteProperty:$d,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:$d,deleteProperty:$d}},ownKeys(t){return t.keys()}};function Op(t){return(t=typeof t=="function"?t():t)?t:{}}function gS(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function qf(...t){let e=!1;for(let s=0;s<t.length;s++){const l=t[s];e=e||!!l&&Fo in l,t[s]=typeof l=="function"?(e=!0,Lt(l)):l}if($b&&e)return new Proxy({get(s){for(let l=t.length-1;l>=0;l--){const c=Op(t[l])[s];if(c!==void 0)return c}},has(s){for(let l=t.length-1;l>=0;l--)if(s in Op(t[l]))return!0;return!1},keys(){const s=[];for(let l=0;l<t.length;l++)s.push(...Object.keys(Op(t[l])));return[...new Set(s)]}},Vf);const r={},n=Object.create(null);for(let s=t.length-1;s>=0;s--){const l=t[s];if(!l)continue;const c=Object.getOwnPropertyNames(l);for(let u=c.length-1;u>=0;u--){const h=c[u];if(h==="__proto__"||h==="constructor")continue;const m=Object.getOwnPropertyDescriptor(l,h);if(!n[h])n[h]=m.get?{enumerable:!0,configurable:!0,get:gS.bind(r[h]=[m.get.bind(l)])}:m.value!==void 0?m:void 0;else{const g=r[h];g&&(m.get?g.push(m.get.bind(l)):m.value!==void 0&&g.push(()=>m.value))}}}const i={},o=Object.keys(n);for(let s=o.length-1;s>=0;s--){const l=o[s],c=n[l];c&&c.get?Object.defineProperty(i,l,c):i[l]=c?c.value:void 0}return i}function vS(t,...e){if($b&&Fo in t){const i=new Set(e.length>1?e.flat():e[0]),o=e.map(s=>new Proxy({get(l){return s.includes(l)?t[l]:void 0},has(l){return s.includes(l)&&l in t},keys(){return s.filter(l=>l in t)}},Vf));return o.push(new Proxy({get(s){return i.has(s)?void 0:t[s]},has(s){return i.has(s)?!1:s in t},keys(){return Object.keys(t).filter(s=>!i.has(s))}},Vf)),o}const r={},n=e.map(()=>({}));for(const i of Object.getOwnPropertyNames(t)){const o=Object.getOwnPropertyDescriptor(t,i),s=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let l=!1,c=0;for(const u of e)u.includes(i)&&(l=!0,s?n[c][i]=o.value:Object.defineProperty(n[c],i,o)),++c;l||(s?r[i]=o.value:Object.defineProperty(r,i,o))}return[...n,r]}const bS=t=>`Stale read from <${t}>.`;function zt(t){const e="fallback"in t&&{fallback:()=>t.fallback};return Lt(mS(()=>t.each,t.children,e||void 0))}function _S(t){const e="fallback"in t&&{fallback:()=>t.fallback};return Lt(yS(()=>t.each,t.children,e||void 0))}function Ge(t){const e=t.keyed,r=Lt(()=>t.when,void 0,void 0),n=e?r:Lt(r,void 0,{equals:(i,o)=>!i==!o});return Lt(()=>{const i=n();if(i){const o=t.children;return typeof o=="function"&&o.length>0?Qi(()=>o(e?i:()=>{if(!Qi(n))throw bS("Show");return r()})):o}return t.fallback},void 0,void 0)}const SS=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],PS=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",...SS]),wS=new Set(["innerHTML","textContent","innerText","children"]),xS=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),AS=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function CS(t,e){const r=AS[t];return typeof r=="object"?r[e]?r.$:void 0:r}const IS=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),$e=t=>Lt(()=>t());function $S(t,e,r){let n=r.length,i=e.length,o=n,s=0,l=0,c=e[i-1].nextSibling,u=null;for(;s<i||l<o;){if(e[s]===r[l]){s++,l++;continue}for(;e[i-1]===r[o-1];)i--,o--;if(i===s){const h=o<n?l?r[l-1].nextSibling:r[o-l]:c;for(;l<o;)t.insertBefore(r[l++],h)}else if(o===l)for(;s<i;)(!u||!u.has(e[s]))&&e[s].remove(),s++;else if(e[s]===r[o-1]&&r[l]===e[i-1]){const h=e[--i].nextSibling;t.insertBefore(r[l++],e[s++].nextSibling),t.insertBefore(r[--o],h),e[i]=r[o]}else{if(!u){u=new Map;let m=l;for(;m<o;)u.set(r[m],m++)}const h=u.get(e[s]);if(h!=null)if(l<h&&h<o){let m=s,g=1,f;for(;++m<i&&m<o&&!((f=u.get(e[m]))==null||f!==h+g);)g++;if(g>h-l){const w=e[s];for(;l<h;)t.insertBefore(r[l++],w)}else t.replaceChild(r[l++],e[s++])}else s++;else e[s++].remove()}}}const xg="_$DX_DELEGATE";function ES(t,e,r,n={}){let i;return vl(o=>{i=o,e===document?t():a(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{i(),e.textContent=""}}function he(t,e,r,n){let i;const o=()=>{const l=n?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return l.innerHTML=t,r?l.content.firstChild.firstChild:n?l.firstChild:l.content.firstChild},s=e?()=>Qi(()=>document.importNode(i||(i=o()),!0)):()=>(i||(i=o())).cloneNode(!0);return s.cloneNode=s,s}function pr(t,e=window.document){const r=e[xg]||(e[xg]=new Set);for(let n=0,i=t.length;n<i;n++){const o=t[n];r.has(o)||(r.add(o),e.addEventListener(o,MS))}}function Qt(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function TS(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function Vm(t,e){e==null?t.removeAttribute("class"):t.className=e}function hs(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const i=r[0];t.addEventListener(e,r[0]=o=>i.call(t,r[1],o))}else t.addEventListener(e,r,typeof r!="function"&&r)}function kS(t,e,r={}){const n=Object.keys(e||{}),i=Object.keys(r);let o,s;for(o=0,s=i.length;o<s;o++){const l=i[o];!l||l==="undefined"||e[l]||(Ag(t,l,!1),delete r[l])}for(o=0,s=n.length;o<s;o++){const l=n[o],c=!!e[l];!l||l==="undefined"||r[l]===c||!c||(Ag(t,l,!0),r[l]=c)}return r}function y(t,e,r){if(!e)return r?Qt(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let i,o;for(o in r)e[o]==null&&n.removeProperty(o),delete r[o];for(o in e)i=e[o],i!==r[o]&&(n.setProperty(o,i),r[o]=i);return r}function NS(t,e={},r,n){const i={};return we(()=>i.children=$u(t,e.children,i.children)),we(()=>typeof e.ref=="function"&&LS(e.ref,t)),we(()=>RS(t,e,r,!0,i,!0)),i}function LS(t,e,r){return Qi(()=>t(e,r))}function a(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return $u(t,e,n,r);we(i=>$u(t,e(),i,r),n)}function RS(t,e,r,n,i={},o=!1){e||(e={});for(const s in i)if(!(s in e)){if(s==="children")continue;i[s]=Cg(t,s,null,i[s],r,o,e)}for(const s in e){if(s==="children")continue;const l=e[s];i[s]=Cg(t,s,l,i[s],r,o,e)}}function DS(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function Ag(t,e,r){const n=e.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)t.classList.toggle(n[i],r)}function Cg(t,e,r,n,i,o,s){let l,c,u,h,m;if(e==="style")return y(t,r,n);if(e==="classList")return kS(t,r,n);if(r===n)return n;if(e==="ref")o||r(t);else if(e.slice(0,3)==="on:"){const g=e.slice(3);n&&t.removeEventListener(g,n,typeof n!="function"&&n),r&&t.addEventListener(g,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const g=e.slice(10);n&&t.removeEventListener(g,n,!0),r&&t.addEventListener(g,r,!0)}else if(e.slice(0,2)==="on"){const g=e.slice(2).toLowerCase(),f=IS.has(g);if(!f&&n){const w=Array.isArray(n)?n[0]:n;t.removeEventListener(g,w)}(f||r)&&(hs(t,g,r,f),f&&pr([g]))}else e.slice(0,5)==="attr:"?Qt(t,e.slice(5),r):e.slice(0,5)==="bool:"?TS(t,e.slice(5),r):(m=e.slice(0,5)==="prop:")||(u=wS.has(e))||(h=CS(e,t.tagName))||(c=PS.has(e))||(l=t.nodeName.includes("-")||"is"in s)?(m&&(e=e.slice(5),c=!0),e==="class"||e==="className"?Vm(t,r):l&&!c&&!u?t[DS(e)]=r:t[h||e]=r):Qt(t,xS[e]||e,r);return r}function MS(t){let e=t.target;const r=`$$${t.type}`,n=t.target,i=t.currentTarget,o=c=>Object.defineProperty(t,"target",{configurable:!0,value:c}),s=()=>{const c=e[r];if(c&&!e.disabled){const u=e[`${r}Data`];if(u!==void 0?c.call(e,u,t):c.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},l=()=>{for(;s()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const c=t.composedPath();o(c[0]);for(let u=0;u<c.length-2&&(e=c[u],!!s());u++){if(e._$host){e=e._$host,l();break}if(e.parentNode===i)break}}else l();o(n)}function $u(t,e,r,n,i){for(;typeof r=="function";)r=r();if(e===r)return r;const o=typeof e,s=n!==void 0;if(t=s&&r[0]&&r[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===r))return r;if(s){let l=r[0];l&&l.nodeType===3?l.data!==e&&(l.data=e):l=document.createTextNode(e),r=Xl(t,r,n,l)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||o==="boolean")r=Xl(t,r,n);else{if(o==="function")return we(()=>{let l=e();for(;typeof l=="function";)l=l();r=$u(t,l,r,n)}),()=>r;if(Array.isArray(e)){const l=[],c=r&&Array.isArray(r);if(zf(l,e,r,i))return we(()=>r=$u(t,l,r,n,!0)),()=>r;if(l.length===0){if(r=Xl(t,r,n),s)return r}else c?r.length===0?Ig(t,l,n):$S(t,r,l):(r&&Xl(t),Ig(t,l));r=l}else if(e.nodeType){if(Array.isArray(r)){if(s)return r=Xl(t,r,n,e);Xl(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function zf(t,e,r,n){let i=!1;for(let o=0,s=e.length;o<s;o++){let l=e[o],c=r&&r[t.length],u;if(!(l==null||l===!0||l===!1))if((u=typeof l)=="object"&&l.nodeType)t.push(l);else if(Array.isArray(l))i=zf(t,l,c)||i;else if(u==="function")if(n){for(;typeof l=="function";)l=l();i=zf(t,Array.isArray(l)?l:[l],Array.isArray(c)?c:[c])||i}else t.push(l),i=!0;else{const h=String(l);c&&c.nodeType===3&&c.data===h?t.push(c):t.push(document.createTextNode(h))}}return i}function Ig(t,e,r=null){for(let n=0,i=e.length;n<i;n++)t.insertBefore(e[n],r)}function Xl(t,e,r,n){if(r===void 0)return t.textContent="";const i=n||document.createTextNode("");if(e.length){let o=!1;for(let s=e.length-1;s>=0;s--){const l=e[s];if(i!==l){const c=l.parentNode===t;!o&&!s?c?t.replaceChild(i,l):t.insertBefore(i,r):c&&l.remove()}else o=!0}}else t.insertBefore(i,r);return[i]}const FS=!1;function Bb(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function n(i,o){if(r)return!(r=!1);const s={to:i,options:o,defaultPrevented:!1,preventDefault:()=>s.defaultPrevented=!0};for(const l of t)l.listener({...s,from:l.location,retry:c=>{c&&(r=!0),l.navigate(i,{...o,resolve:!1})}});return!s.defaultPrevented}return{subscribe:e,confirm:n}}let Uf;function qm(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Uf=window.history.state._depth}qm();function OS(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function BS(t,e){let r=!1;return()=>{const n=Uf;qm();const i=n==null?null:Uf-n;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const jS=/^(?:[a-z0-9]+:)?\/\//i,VS=/^\/+|(\/)\/+$/g,jb="http://sr";function bl(t,e=!1){const r=t.replace(VS,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function Xd(t,e,r){if(jS.test(e))return;const n=bl(t),i=r&&bl(r);let o="";return!i||e.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+bl(e,!o)}function qS(t,e){if(t==null)throw new Error(e);return t}function zS(t,e){return bl(t).replace(/\/*(\*.*)?$/g,"")+bl(e)}function Vb(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function US(t,e,r){const[n,i]=t.split("/*",2),o=n.split("/").filter(Boolean),s=o.length;return l=>{const c=l.split("/").filter(Boolean),u=c.length-s;if(u<0||u>0&&i===void 0&&!e)return null;const h={path:s?"":"/",params:{}},m=g=>r===void 0?void 0:r[g];for(let g=0;g<s;g++){const f=o[g],w=f[0]===":",x=w?c[g]:c[g].toLowerCase(),S=w?f.slice(1):f.toLowerCase();if(w&&Bp(x,m(S)))h.params[S]=x;else if(w||!Bp(x,S))return null;h.path+=`/${x}`}if(i){const g=u?c.slice(-u).join("/"):"";if(Bp(g,m(i)))h.params[i]=g;else return null}return h}}function Bp(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function HS(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function qb(t){const e=new Map,r=Nb();return new Proxy({},{get(n,i){return e.has(i)||Lb(r,()=>e.set(i,Lt(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function zb(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)i.push(r+=e[1]),n=n.slice(e[0].length);return zb(n).reduce((o,s)=>[...o,...i.map(l=>l+s)],[])}const GS=100,Ub=Rb(),zm=Rb(),Uu=()=>qS(Fm(Ub),"<A> and 'use' router primitives can be only used inside a Route."),WS=()=>Fm(zm)||Uu().base,YS=t=>{const e=WS();return Lt(()=>e.resolvePath(t()))},KS=t=>{const e=Uu();return Lt(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},Um=()=>Uu().navigatorFactory(),JS=()=>Uu().location,QS=()=>Uu().params;function XS(t,e=""){const{component:r,preload:n,load:i,children:o,info:s}=t,l=!o||Array.isArray(o)&&!o.length,c={key:t,component:r,preload:n||i,info:s};return Hb(t.path).reduce((u,h)=>{for(const m of zb(h)){const g=zS(e,m);let f=l?g:g.split("/*",1)[0];f=f.split("/").map(w=>w.startsWith(":")||w.startsWith("*")?w:encodeURIComponent(w)).join("/"),u.push({...c,originalPath:h,pattern:f,matcher:US(f,!l,t.matchFilters)})}return u},[])}function ZS(t,e=0){return{routes:t,score:HS(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let i=t.length-1;i>=0;i--){const o=t[i],s=o.matcher(r);if(!s)return null;n.unshift({...s,route:o})}return n}}}function Hb(t){return Array.isArray(t)?t:[t]}function Gb(t,e="",r=[],n=[]){const i=Hb(t);for(let o=0,s=i.length;o<s;o++){const l=i[o];if(l&&typeof l=="object"){l.hasOwnProperty("path")||(l.path="");const c=XS(l,e);for(const u of c){r.push(u);const h=Array.isArray(l.children)&&l.children.length===0;if(l.children&&!h)Gb(l.children,u.pattern,r,n);else{const m=ZS([...r],n.length);n.push(m)}r.pop()}}}return r.length?n:n.sort((o,s)=>s.score-o.score)}function jp(t,e){for(let r=0,n=t.length;r<n;r++){const i=t[r].matcher(e);if(i)return i}return[]}function eP(t,e,r){const n=new URL(jb),i=Lt(h=>{const m=t();try{return new URL(m,n)}catch{return console.error(`Invalid path ${m}`),h}},n,{equals:(h,m)=>h.href===m.href}),o=Lt(()=>i().pathname),s=Lt(()=>i().search,!0),l=Lt(()=>i().hash),c=()=>"",u=Mm(s,()=>Vb(i()));return{get pathname(){return o()},get search(){return s()},get hash(){return l()},get state(){return e()},get key(){return c()},query:r?r(u):qb(u)}}let ul;function tP(){return ul}function rP(t,e,r,n={}){const{signal:[i,o],utils:s={}}=t,l=s.parsePath||(H=>H),c=s.renderPath||(H=>H),u=s.beforeLeave||Bb(),h=Xd("",n.base||"");if(h===void 0)throw new Error(`${h} is not a valid base path`);h&&!i().value&&o({value:h,replace:!0,scroll:!1});const[m,g]=Ce(!1);let f;const w=(H,K)=>{K.value===x()&&K.state===C()||(f===void 0&&g(!0),ul=H,f=K,cS(()=>{f===K&&(S(f.value),j(f.state),Z[1](R=>R.filter(k=>k.pending)))}).finally(()=>{f===K&&kb(()=>{ul=void 0,H==="navigate"&&P(f),g(!1),f=void 0})}))},[x,S]=Ce(i().value),[C,j]=Ce(i().state),oe=eP(x,C,s.queryWrapper),te=[],Z=Ce([]),re=Lt(()=>typeof n.transformUrl=="function"?jp(e(),n.transformUrl(oe.pathname)):jp(e(),oe.pathname)),E=()=>{const H=re(),K={};for(let R=0;R<H.length;R++)Object.assign(K,H[R].params);return K},$=s.paramsWrapper?s.paramsWrapper(E,e):qb(E),T={pattern:h,path:()=>h,outlet:()=>null,resolvePath(H){return Xd(h,H)}};return we(Mm(i,H=>w("native",H),{defer:!0})),{base:T,location:oe,params:$,isRouting:m,renderPath:c,parsePath:l,navigatorFactory:_,matches:re,beforeLeave:u,preloadRoute:b,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:Z};function B(H,K,R){Qi(()=>{if(typeof K=="number"){K&&(s.go?s.go(K):console.warn("Router integration does not support relative routing"));return}const k=!K||K[0]==="?",{replace:W,resolve:z,scroll:U,state:le}={replace:!1,resolve:!k,scroll:!0,...R},L=z?H.resolvePath(K):Xd(k&&oe.pathname||"",K);if(L===void 0)throw new Error(`Path '${K}' is not a routable path`);if(te.length>=GS)throw new Error("Too many redirects");const M=x();(L!==M||le!==C())&&(FS||u.confirm(L,R)&&(te.push({value:M,replace:W,scroll:U,state:C()}),w("navigate",{value:L,state:le})))})}function _(H){return H=H||Fm(zm)||T,(K,R)=>B(H,K,R)}function P(H){const K=te[0];K&&(o({...H,replace:K.replace,scroll:K.scroll}),te.length=0)}function b(H,K){const R=jp(e(),H.pathname),k=ul;ul="preload";for(let W in R){const{route:z,params:U}=R[W];z.component&&z.component.preload&&z.component.preload();const{preload:le}=z;K&&le&&Lb(r(),()=>le({params:U,location:{pathname:H.pathname,search:H.search,hash:H.hash,query:Vb(H),state:null,key:""},intent:"preload"}))}ul=k}}function nP(t,e,r,n){const{base:i,location:o,params:s}=t,{pattern:l,component:c,preload:u}=n().route,h=Lt(()=>n().path);c&&c.preload&&c.preload();const m=u?u({params:s,location:o,intent:ul||"initial"}):void 0;return{parent:e,pattern:l,path:h,outlet:()=>c?D(c,{params:s,location:o,data:m,get children(){return r()}}):r(),resolvePath(f){return Xd(i.path(),f,h())}}}const iP=t=>e=>{const{base:r}=e,n=Om(()=>e.children),i=Lt(()=>Gb(n(),e.base||""));let o;const s=rP(t,i,()=>o,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(s),D(Ub.Provider,{value:s,get children(){return D(oP,{routerState:s,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[$e(()=>(o=Nb())&&null),D(sP,{routerState:s,get branches(){return i()}})]}})}})};function oP(t){const e=t.routerState.location,r=t.routerState.params,n=Lt(()=>t.preload&&Qi(()=>{t.preload({params:r,location:e,intent:tP()||"initial"})}));return D(Ge,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:i=>D(i,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function sP(t){const e=[];let r;const n=Lt(Mm(t.routerState.matches,(i,o,s)=>{let l=o&&i.length===o.length;const c=[];for(let u=0,h=i.length;u<h;u++){const m=o&&o[u],g=i[u];s&&m&&g.route.key===m.route.key?c[u]=s[u]:(l=!1,e[u]&&e[u](),vl(f=>{e[u]=f,c[u]=nP(t.routerState,c[u-1]||t.routerState.base,$g(()=>n()[u+1]),()=>t.routerState.matches()[u])}))}return e.splice(i.length).forEach(u=>u()),s&&l?s:(r=c[0],c)}));return $g(()=>n()&&r)()}const $g=t=>()=>D(Ge,{get when(){return t()},keyed:!0,children:e=>D(zm.Provider,{value:e,get children(){return e.outlet()}})}),bo=t=>{const e=Om(()=>t.children);return qf(t,{get children(){return e()}})};function aP([t,e],r,n){return[t,n?i=>e(n(i)):e]}function lP(t){let e=!1;const r=i=>typeof i=="string"?{value:i}:i,n=aP(Ce(r(t.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!e&&t.set(i),i));return t.init&&kl(t.init((i=t.get())=>{e=!0,n[1](r(i)),e=!1})),iP({signal:n,create:t.create,utils:t.utils})}function cP(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function uP(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const dP=new Map;function hP(t=!0,e=!1,r="/_server",n){return i=>{const o=i.base.path(),s=i.navigatorFactory(i.base);let l,c;function u(x){return x.namespaceURI==="http://www.w3.org/2000/svg"}function h(x){if(x.defaultPrevented||x.button!==0||x.metaKey||x.altKey||x.ctrlKey||x.shiftKey)return;const S=x.composedPath().find(re=>re instanceof Node&&re.nodeName.toUpperCase()==="A");if(!S||e&&!S.hasAttribute("link"))return;const C=u(S),j=C?S.href.baseVal:S.href;if((C?S.target.baseVal:S.target)||!j&&!S.hasAttribute("state"))return;const te=(S.getAttribute("rel")||"").split(/\s+/);if(S.hasAttribute("download")||te&&te.includes("external"))return;const Z=C?new URL(j,document.baseURI):new URL(j);if(!(Z.origin!==window.location.origin||o&&Z.pathname&&!Z.pathname.toLowerCase().startsWith(o.toLowerCase())))return[S,Z]}function m(x){const S=h(x);if(!S)return;const[C,j]=S,oe=i.parsePath(j.pathname+j.search+j.hash),te=C.getAttribute("state");x.preventDefault(),s(oe,{resolve:!1,replace:C.hasAttribute("replace"),scroll:!C.hasAttribute("noscroll"),state:te?JSON.parse(te):void 0})}function g(x){const S=h(x);if(!S)return;const[C,j]=S;i.preloadRoute(j,C.getAttribute("preload")!=="false")}function f(x){clearTimeout(l);const S=h(x);if(!S)return c=null;const[C,j]=S;c!==C&&(l=setTimeout(()=>{i.preloadRoute(j,C.getAttribute("preload")!=="false"),c=C},20))}function w(x){if(x.defaultPrevented)return;let S=x.submitter&&x.submitter.hasAttribute("formaction")?x.submitter.getAttribute("formaction"):x.target.getAttribute("action");if(!S)return;if(!S.startsWith("https://action/")){const j=new URL(S,jb);if(S=i.parsePath(j.pathname+j.search),!S.startsWith(r))return}if(x.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const C=dP.get(S);if(C){x.preventDefault();const j=new FormData(x.target,x.submitter);C.call({r:i,f:x.target},x.target.enctype==="multipart/form-data"?j:new URLSearchParams(j))}}pr(["click","submit"]),document.addEventListener("click",m),t&&(document.addEventListener("mousemove",f,{passive:!0}),document.addEventListener("focusin",g,{passive:!0}),document.addEventListener("touchstart",g,{passive:!0})),document.addEventListener("submit",w),kl(()=>{document.removeEventListener("click",m),t&&(document.removeEventListener("mousemove",f),document.removeEventListener("focusin",g),document.removeEventListener("touchstart",g)),document.removeEventListener("submit",w)})}}function pP(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function fP(t){const e=()=>window.location.hash.slice(1),r=Bb();return lP({get:e,set({value:n,replace:i,scroll:o,state:s}){i?window.history.replaceState(OS(s),"","#"+n):window.history.pushState(s,"","#"+n);const l=n.indexOf("#"),c=l>=0?n.slice(l+1):"";uP(c,o),qm()},init:n=>cP(window,"hashchange",BS(n,i=>!r.confirm(i&&i<0?i:e()))),create:hP(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:pP,beforeLeave:r}})(t)}var mP=he("<a>");function oc(t){t=qf({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=vS(t,["href","state","class","activeClass","inactiveClass","end"]),r=YS(()=>t.href),n=KS(r),i=JS(),o=Lt(()=>{const s=r();if(s===void 0)return[!1,!1];const l=bl(s.split(/[?#]/,1)[0]).toLowerCase(),c=decodeURI(bl(i.pathname).toLowerCase());return[t.end?l===c:c.startsWith(l+"/")||c===l,l===c]});return(()=>{var s=mP();return NS(s,qf(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!o()[0],[t.activeClass]:o()[0],...e.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),s})()}const Hf=Symbol("store-raw"),hc=Symbol("store-node"),ks=Symbol("store-has"),Wb=Symbol("store-self");function Yb(t){let e=t[Fo];if(!e&&(Object.defineProperty(t,Fo,{value:e=new Proxy(t,vP)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let i=0,o=r.length;i<o;i++){const s=r[i];n[s].get&&Object.defineProperty(t,s,{enumerable:n[s].enumerable,get:n[s].get.bind(e)})}}return e}function bh(t){let e;return t!=null&&typeof t=="object"&&(t[Fo]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Eu(t,e=new Set){let r,n,i,o;if(r=t!=null&&t[Hf])return r;if(!bh(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let s=0,l=t.length;s<l;s++)i=t[s],(n=Eu(i,e))!==i&&(t[s]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const s=Object.keys(t),l=Object.getOwnPropertyDescriptors(t);for(let c=0,u=s.length;c<u;c++)o=s[c],!l[o].get&&(i=t[o],(n=Eu(i,e))!==i&&(t[o]=n))}return t}function _h(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function Tu(t,e,r){if(t[e])return t[e];const[n,i]=Ce(r,{equals:!1,internal:!0});return n.$=i,t[e]=n}function yP(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===Fo||e===hc||(delete r.value,delete r.writable,r.get=()=>t[Fo][e]),r}function Kb(t){Of()&&Tu(_h(t,hc),Wb)()}function gP(t){return Kb(t),Reflect.ownKeys(t)}const vP={get(t,e,r){if(e===Hf)return t;if(e===Fo)return r;if(e===ph)return Kb(t),r;const n=_h(t,hc),i=n[e];let o=i?i():t[e];if(e===hc||e===ks||e==="__proto__")return o;if(!i){const s=Object.getOwnPropertyDescriptor(t,e);Of()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(s&&s.get)&&(o=Tu(n,e,o)())}return bh(o)?Yb(o):o},has(t,e){return e===Hf||e===Fo||e===ph||e===hc||e===ks||e==="__proto__"?!0:(Of()&&Tu(_h(t,ks),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:gP,getOwnPropertyDescriptor:yP};function Sh(t,e,r,n=!1){if(!n&&t[e]===r)return;const i=t[e],o=t.length;r===void 0?(delete t[e],t[ks]&&t[ks][e]&&i!==void 0&&t[ks][e].$()):(t[e]=r,t[ks]&&t[ks][e]&&i===void 0&&t[ks][e].$());let s=_h(t,hc),l;if((l=Tu(s,e,i))&&l.$(()=>r),Array.isArray(t)&&t.length!==o){for(let c=t.length;c<o;c++)(l=s[c])&&l.$();(l=Tu(s,"length",o))&&l.$(t.length)}(l=s[Wb])&&l.$()}function Jb(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const i=r[n];Sh(t,i,e[i])}}function bP(t,e){if(typeof e=="function"&&(e=e(t)),e=Eu(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const i=e[r];t[r]!==i&&Sh(t,r,i)}Sh(t,"length",n)}else Jb(t,e)}function su(t,e,r=[]){let n,i=t;if(e.length>1){n=e.shift();const s=typeof n,l=Array.isArray(t);if(Array.isArray(n)){for(let c=0;c<n.length;c++)su(t,[n[c]].concat(e),r);return}else if(l&&s==="function"){for(let c=0;c<t.length;c++)n(t[c],c)&&su(t,[c].concat(e),r);return}else if(l&&s==="object"){const{from:c=0,to:u=t.length-1,by:h=1}=n;for(let m=c;m<=u;m+=h)su(t,[m].concat(e),r);return}else if(e.length>1){su(t[n],e,[n].concat(r));return}i=t[n],r=[n].concat(r)}let o=e[0];typeof o=="function"&&(o=o(i,r),o===i)||n===void 0&&o==null||(o=Eu(o),n===void 0||bh(i)&&bh(o)&&!Array.isArray(o)?Jb(i,o):Sh(t,n,o))}function Hu(...[t,e]){const r=Eu(t||{}),n=Array.isArray(r),i=Yb(r);function o(...s){kb(()=>{n&&s.length===1?bP(r,s[0]):su(r,s)})}return[i,o]}const Kr=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),nl=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let jt={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const Fn=(t=.05)=>Math.random()<t,On=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},Oi={products:{async getAll(t,e){await Kr(),Fn()&&On();let r=[...jt.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n)||i.category.toLowerCase().includes(n)||i.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await Kr(),Fn()&&On(),jt.products.find(e=>e.id===t)||null},async create(t){if(await Kr(),Fn()&&On(),jt.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:nl("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return jt.products.push(e),e},async update(t,e){await Kr(),Fn()&&On();const r=jt.products.findIndex(i=>i.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&jt.products.some(i=>i.id!==t&&i.sku===e.sku))throw new Error("SKU already exists");const n={...jt.products[r],...e,lastModified:new Date().toISOString()};return jt.products[r]=n,n},async delete(t){await Kr(),Fn()&&On();const e=jt.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return jt.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(jt.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await Kr(),Fn()&&On();let e=[...jt.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Kr(),jt.locations.find(e=>e.id===t)||null},async create(t){if(await Kr(),Fn()&&On(),jt.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:nl("loc-"),createdDate:new Date().toISOString()};return jt.locations.push(e),e},async update(t,e){await Kr(),Fn()&&On();const r=jt.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&jt.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return jt.locations[r]={...jt.locations[r],...e},jt.locations[r]}},movements:{async getAll(t){await Kr(),Fn()&&On();let e=[...jt.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await Kr(),jt.movements.find(e=>e.id===t)||null},async create(t){if(await Kr(),Fn()&&On(),!jt.products.find(i=>i.id===t.productId))throw new Error("Product not found");if(!jt.locations.find(i=>i.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const i=await this.getStockLevel(t.productId,t.locationId);if(i<t.quantity)throw new Error(`Insufficient stock. Available: ${i}, Requested: ${t.quantity}`)}const n={...t,id:nl("mov-"),createdDate:new Date().toISOString()};return jt.movements.push(n),n},async update(t,e){await Kr(),Fn()&&On();const r=jt.movements.findIndex(i=>i.id===t);if(r===-1)throw new Error("Movement not found");const n={...jt.movements[r],...e,lastModified:new Date().toISOString()};return jt.movements[r]=n,n},async delete(t){await Kr(),Fn()&&On();const e=jt.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return jt.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await Kr(),Fn()&&On();const e=[],r=[],n=new Date().toISOString(),i=jt.locations.find(o=>o.id===t.locationId);if(!i)return{success:!1,movements:[],errors:["Invalid location"]};for(let o=0;o<t.items.length;o++){const s=t.items[o],l=jt.products.find(h=>h.id===s.productId);if(!l){e.push(`Item ${o+1}: Product not found`);continue}if(s.quantity<=0){e.push(`Item ${o+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const h=await this.getStockLevel(s.productId,t.locationId);if(s.quantity>h){e.push(`Item ${o+1}: Insufficient stock. Available: ${h}, Requested: ${s.quantity}`);continue}}const c=s.unitCost||l.unitCost,u={id:nl("mov-"),productId:l.id,productName:l.name,productSku:l.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:s.quantity,unitCost:c,totalCost:s.quantity*c,referenceNumber:t.referenceNumber,notes:s.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?jt.locations.find(h=>h.id===t.fromLocationId)?.name:void 0};r.push(u)}return e.length>0?{success:!1,movements:[],errors:e}:(jt.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await Kr(50),jt.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await Kr();const t=new Map;for(const e of jt.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await Kr(),Fn()&&On();let e=[...jt.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Kr(),jt.accounts.find(e=>e.id===t)||null},async create(t){if(await Kr(),Fn()&&On(),jt.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:nl("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return jt.accounts.push(e),e},async update(t,e){await Kr(),Fn()&&On();const r=jt.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&jt.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return jt.accounts[r]={...jt.accounts[r],...e,lastModified:new Date().toISOString()},jt.accounts[r]}},journal:{async getAll(t){await Kr(),Fn()&&On();let e=[...jt.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await Kr(),jt.journalEntries.find(e=>e.id===t)||null},async create(t){await Kr(),Fn()&&On();const e=t.lines.reduce((l,c)=>l+(c.debitAmount||0),0),r=t.lines.reduce((l,c)=>l+(c.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=jt.journalEntries.sort((l,c)=>c.entryNumber.localeCompare(l.entryNumber))[0],o=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,s={...t,id:nl("je-"),entryNumber:o,createdAt:new Date().toISOString(),lines:t.lines.map(l=>({...l,id:nl("jel-")}))};return jt.journalEntries.push(s),s},async update(t,e){await Kr(),Fn()&&On();const r=jt.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(jt.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return jt.journalEntries[r]={...jt.journalEntries[r],...e},jt.journalEntries[r]},async post(t){await Kr(),Fn()&&On();const e=jt.journalEntries.findIndex(o=>o.id===t);if(e===-1)throw new Error("Journal entry not found");const r=jt.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((o,s)=>o+(s.debitAmount||0),0),i=r.lines.reduce((o,s)=>o+(s.creditAmount||0),0);if(Math.abs(n-i)>.01)throw new Error("Entry must be balanced before posting");return jt.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(o=>{const s=jt.accounts.findIndex(l=>l.id===o.accountId);if(s!==-1){const l=jt.accounts[s],c=o.debitAmount||0,u=o.creditAmount||0;["asset","expense"].includes(l.accountType)?l.balance+=c-u:l.balance+=u-c}}),jt.journalEntries[e]}},utils:{async getNextEntryNumber(){await Kr(100);const t=jt.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await Kr(100);const e=t.toUpperCase().slice(0,3),r=jt.products.filter(i=>i.productCode?.startsWith(e)).sort((i,o)=>(o.productCode||"").localeCompare(i.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await Kr(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await Kr(200),jt={products:[...jt.products.slice(0,3)],locations:[...jt.locations.slice(0,3)],movements:[...jt.movements.slice(0,2)],accounts:[...jt.accounts.slice(0,2)],journalEntries:[...jt.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await Kr(100),{products:jt.products.length,locations:jt.locations.length,movements:jt.movements.length,accounts:jt.accounts.length,journalEntries:jt.journalEntries.length,totalStockValue:jt.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},Hm=t=>t===null||typeof t!="object"?t:t instanceof Date?new Date(t.getTime()):Array.isArray(t)?t.map(e=>Hm(e)):JSON.parse(JSON.stringify(t)),Yh=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},Eg=(t=16)=>{const e="123456789";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},_P=(t=4)=>{const e="0123456789BCDFGKSY";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},_l=t=>typeof t=="string"&&t.trim().length>0,Fi=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();if(i.errors)throw new Error(i.errors[0]?.message||"GraphQL error");return i.data},SP=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],Gf=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function Wf(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function PP(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,i,o,s,l,c,u,h=[],m=0;m<t.length;m+=4)o=e.indexOf(t.charAt(m)),s=e.indexOf(t.charAt(m+1)),l=e.indexOf(t.charAt(m+2)),c=e.indexOf(t.charAt(m+3)),u=o<<18|s<<12|l<<6|c,r=u>>>16&255,n=u>>>8&255,i=u&255,h[m/4]=String.fromCharCode(r,n,i),c==64&&(h[m/4]=String.fromCharCode(r,n)),l==64&&(h[m/4]=String.fromCharCode(r));return t=h.join(""),t}const wP=(t,e,r,n)=>{let i=0,o={};return t.map(s=>{n?.[s]||Qb(e?.[s],r?.[s])||(i=1,o[s]=e[s])}),{hasChange:i,data:o}},Qb=(t,e)=>Object.prototype.toString.call(t)===Object.prototype.toString.call(e)?Object.prototype.toString.call(t)==="[object Object]"||Object.prototype.toString.call(t)==="[object Array]"?Object.keys(t).length!==Object.keys(e).length?!1:Object.keys(t).every(function(r){return Qb(t[r],e[r])}):t===e:!1,xP=()=>{};var Tg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},AP=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],s=t[r++],l=t[r++],c=((i&7)<<18|(o&63)<<12|(s&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const o=t[r++],s=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},Zb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],s=i+1<t.length,l=s?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,h=o>>2,m=(o&3)<<4|l>>4;let g=(l&15)<<2|u>>6,f=u&63;c||(f=64,s||(g=64)),n.push(r[h],r[m],r[g],r[f])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Xb(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):AP(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],l=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const m=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||l==null||u==null||m==null)throw new CP;const g=o<<2|l>>4;if(n.push(g),u!==64){const f=l<<4&240|u>>2;if(n.push(f),m!==64){const w=u<<6&192|m;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class CP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const IP=function(t){const e=Xb(t);return Zb.encodeByteArray(e,!0)},Ph=function(t){return IP(t).replace(/\./g,"")},e1=function(t){try{return Zb.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $P(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EP=()=>$P().__FIREBASE_DEFAULTS__,TP=()=>{if(typeof process>"u"||typeof Tg>"u")return;const t=Tg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},kP=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&e1(t[1]);return e&&JSON.parse(e)},Kh=()=>{try{return xP()||EP()||TP()||kP()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},t1=t=>Kh()?.emulatorHosts?.[t],NP=t=>{const e=t1(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},r1=()=>Kh()?.config,n1=t=>Kh()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ic(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function i1(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RP(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Ph(JSON.stringify(r)),Ph(JSON.stringify(s)),""].join(".")}const fu={};function DP(){const t={prod:[],emulator:[]};for(const e of Object.keys(fu))fu[e]?t.emulator.push(e):t.prod.push(e);return t}function MP(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let kg=!1;function o1(t,e){if(typeof window>"u"||typeof document>"u"||!Ic(window.location.host)||fu[t]===e||fu[t]||kg)return;fu[t]=e;function r(g){return`__firebase__banner__${g}`}const n="__firebase__banner",o=DP().prod.length>0;function s(){const g=document.getElementById(n);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,f){g.setAttribute("width","24"),g.setAttribute("id",f),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{kg=!0,s()},g}function h(g,f){g.setAttribute("id",f),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=MP(n),f=r("text"),w=document.getElementById(f)||document.createElement("span"),x=r("learnmore"),S=document.getElementById(x)||document.createElement("a"),C=r("preprendIcon"),j=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const oe=g.element;l(oe),h(S,x);const te=u();c(j,C),oe.append(j,w,S,te),document.body.appendChild(oe)}o?(w.innerText="Preview backend disconnected.",j.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(j.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",f)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function FP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ki())}function OP(){const t=Kh()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function BP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function jP(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function VP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function qP(){const t=ki();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function zP(){return!OP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function UP(){try{return typeof indexedDB=="object"}catch{return!1}}function HP(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GP="FirebaseError";class zs extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=GP,Object.setPrototypeOf(this,zs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gu.prototype.create)}}class Gu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?WP(o,n):"Error",l=`${this.serviceName}: ${s} (${i}).`;return new zs(i,l,n)}}function WP(t,e){return t.replace(YP,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const YP=/\{\$([^}]+)}/g;function KP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Cl(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],s=e[i];if(Ng(o)&&Ng(s)){if(!Cl(o,s))return!1}else if(o!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function Ng(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function JP(t,e){const r=new QP(t,e);return r.subscribe.bind(r)}class QP{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");XP(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Vp),i.error===void 0&&(i.error=Vp),i.complete===void 0&&(i.complete=Vp);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function XP(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Vp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function di(t){return t&&t._delegate?t._delegate:t}class Il{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ll="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new LP;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tw(e))try{this.getOrInitializeService({instanceIdentifier:ll})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=ll){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ll){return this.instances.has(e)}getOptions(e=ll){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,s]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);n===l&&s.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:ew(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ll){return this.component?this.component.multipleInstances?e:ll:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ew(t){return t===ll?void 0:t}function tw(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rw{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new ZP(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fr;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Fr||(Fr={}));const nw={debug:Fr.DEBUG,verbose:Fr.VERBOSE,info:Fr.INFO,warn:Fr.WARN,error:Fr.ERROR,silent:Fr.SILENT},iw=Fr.INFO,ow={[Fr.DEBUG]:"log",[Fr.VERBOSE]:"log",[Fr.INFO]:"info",[Fr.WARN]:"warn",[Fr.ERROR]:"error"},sw=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=ow[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Gm{constructor(e){this.name=e,this._logLevel=iw,this._logHandler=sw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?nw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fr.DEBUG,...e),this._logHandler(this,Fr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fr.VERBOSE,...e),this._logHandler(this,Fr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fr.INFO,...e),this._logHandler(this,Fr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fr.WARN,...e),this._logHandler(this,Fr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fr.ERROR,...e),this._logHandler(this,Fr.ERROR,...e)}}const aw=(t,e)=>e.some(r=>t instanceof r);let Lg,Rg;function lw(){return Lg||(Lg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cw(){return Rg||(Rg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const s1=new WeakMap,Yf=new WeakMap,a1=new WeakMap,qp=new WeakMap,Wm=new WeakMap;function uw(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",s)},o=()=>{r(Aa(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",s)});return e.then(r=>{r instanceof IDBCursor&&s1.set(r,t)}).catch(()=>{}),Wm.set(e,t),e}function dw(t){if(Yf.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",s),t.removeEventListener("abort",s)},o=()=>{r(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",s),t.addEventListener("abort",s)});Yf.set(t,e)}let Kf={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Yf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||a1.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Aa(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function hw(t){Kf=t(Kf)}function pw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(zp(this),e,...r);return a1.set(n,e.sort?e.sort():[e]),Aa(n)}:cw().includes(t)?function(...e){return t.apply(zp(this),e),Aa(s1.get(this))}:function(...e){return Aa(t.apply(zp(this),e))}}function fw(t){return typeof t=="function"?pw(t):(t instanceof IDBTransaction&&dw(t),aw(t,lw())?new Proxy(t,Kf):t)}function Aa(t){if(t instanceof IDBRequest)return uw(t);if(qp.has(t))return qp.get(t);const e=fw(t);return e!==t&&(qp.set(t,e),Wm.set(e,t)),e}const zp=t=>Wm.get(t);function mw(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),l=Aa(s);return n&&s.addEventListener("upgradeneeded",c=>{n(Aa(s.result),c.oldVersion,c.newVersion,Aa(s.transaction),c)}),r&&s.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const yw=["get","getKey","getAll","getAllKeys","count"],gw=["put","add","delete","clear"],Up=new Map;function Dg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Up.get(e))return Up.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=gw.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||yw.includes(r)))return;const o=async function(s,...l){const c=this.transaction(s,i?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),i&&c.done]))[0]};return Up.set(e,o),o}hw(t=>({...t,get:(e,r,n)=>Dg(e,r)||t.get(e,r,n),has:(e,r)=>!!Dg(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(bw(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function bw(t){return t.getComponent()?.type==="VERSION"}const Jf="@firebase/app",Mg="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fs=new Gm("@firebase/app"),_w="@firebase/app-compat",Sw="@firebase/analytics-compat",Pw="@firebase/analytics",ww="@firebase/app-check-compat",xw="@firebase/app-check",Aw="@firebase/auth",Cw="@firebase/auth-compat",Iw="@firebase/database",$w="@firebase/data-connect",Ew="@firebase/database-compat",Tw="@firebase/functions",kw="@firebase/functions-compat",Nw="@firebase/installations",Lw="@firebase/installations-compat",Rw="@firebase/messaging",Dw="@firebase/messaging-compat",Mw="@firebase/performance",Fw="@firebase/performance-compat",Ow="@firebase/remote-config",Bw="@firebase/remote-config-compat",jw="@firebase/storage",Vw="@firebase/storage-compat",qw="@firebase/firestore",zw="@firebase/ai",Uw="@firebase/firestore-compat",Hw="firebase",Gw="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf="[DEFAULT]",Ww={[Jf]:"fire-core",[_w]:"fire-core-compat",[Pw]:"fire-analytics",[Sw]:"fire-analytics-compat",[xw]:"fire-app-check",[ww]:"fire-app-check-compat",[Aw]:"fire-auth",[Cw]:"fire-auth-compat",[Iw]:"fire-rtdb",[$w]:"fire-data-connect",[Ew]:"fire-rtdb-compat",[Tw]:"fire-fn",[kw]:"fire-fn-compat",[Nw]:"fire-iid",[Lw]:"fire-iid-compat",[Rw]:"fire-fcm",[Dw]:"fire-fcm-compat",[Mw]:"fire-perf",[Fw]:"fire-perf-compat",[Ow]:"fire-rc",[Bw]:"fire-rc-compat",[jw]:"fire-gcs",[Vw]:"fire-gcs-compat",[qw]:"fire-fst",[Uw]:"fire-fst-compat",[zw]:"fire-vertex","fire-js":"fire-js",[Hw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wh=new Map,Yw=new Map,Xf=new Map;function Fg(t,e){try{t.container.addComponent(e)}catch(r){Fs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function bc(t){const e=t.name;if(Xf.has(e))return Fs.debug(`There were multiple attempts to register component ${e}.`),!1;Xf.set(e,t);for(const r of wh.values())Fg(r,t);for(const r of Yw.values())Fg(r,t);return!0}function Ym(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Po(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ca=new Gu("app","Firebase",Kw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Il("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ca.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $c=Gw;function l1(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Qf,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Ca.create("bad-app-name",{appName:String(i)});if(r||(r=r1()),!r)throw Ca.create("no-options");const o=wh.get(i);if(o){if(Cl(r,o.options)&&Cl(n,o.config))return o;throw Ca.create("duplicate-app",{appName:i})}const s=new rw(i);for(const c of Xf.values())s.addComponent(c);const l=new Jw(r,n,s);return wh.set(i,l),l}function c1(t=Qf){const e=wh.get(t);if(!e&&t===Qf&&r1())return l1();if(!e)throw Ca.create("no-app",{appName:t});return e}function Ia(t,e,r){let n=Ww[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const s=[`Unable to register library "${n}" with version "${e}":`];i&&s.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Fs.warn(s.join(" "));return}bc(new Il(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw="firebase-heartbeat-database",Xw=1,ku="firebase-heartbeat-store";let Hp=null;function u1(){return Hp||(Hp=mw(Qw,Xw,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ku)}catch(r){console.warn(r)}}}}).catch(t=>{throw Ca.create("idb-open",{originalErrorMessage:t.message})})),Hp}async function Zw(t){try{const r=(await u1()).transaction(ku),n=await r.objectStore(ku).get(d1(t));return await r.done,n}catch(e){if(e instanceof zs)Fs.warn(e.message);else{const r=Ca.create("idb-get",{originalErrorMessage:e?.message});Fs.warn(r.message)}}}async function Og(t,e){try{const n=(await u1()).transaction(ku,"readwrite");await n.objectStore(ku).put(e,d1(t)),await n.done}catch(r){if(r instanceof zs)Fs.warn(r.message);else{const n=Ca.create("idb-set",{originalErrorMessage:r?.message});Fs.warn(n.message)}}}function d1(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ex=1024,tx=30;class rx{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new ix(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Bg();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>tx){const i=ox(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Fs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Bg(),{heartbeatsToSend:r,unsentEntries:n}=nx(this._heartbeatsCache.heartbeats),i=Ph(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Fs.warn(e),""}}}function Bg(){return new Date().toISOString().substring(0,10)}function nx(t,e=ex){const r=[];let n=t.slice();for(const i of t){const o=r.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),jg(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),jg(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class ix{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return UP()?HP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Zw(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Og(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Og(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function jg(t){return Ph(JSON.stringify({version:2,heartbeats:t})).length}function ox(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sx(t){bc(new Il("platform-logger",e=>new vw(e),"PRIVATE")),bc(new Il("heartbeat",e=>new rx(e),"PRIVATE")),Ia(Jf,Mg,t),Ia(Jf,Mg,"esm2020"),Ia("fire-js","")}sx("");function h1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ax=h1,p1=new Gu("auth","Firebase",h1());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xh=new Gm("@firebase/auth");function lx(t,...e){xh.logLevel<=Fr.WARN&&xh.warn(`Auth (${$c}): ${t}`,...e)}function Zd(t,...e){xh.logLevel<=Fr.ERROR&&xh.error(`Auth (${$c}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(t,...e){throw Jm(t,...e)}function Mo(t,...e){return Jm(t,...e)}function Km(t,e,r){const n={...ax(),[e]:r};return new Gu("auth","Firebase",n).create(e,{appName:t.name})}function $a(t){return Km(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function f1(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&us(t,"argument-error"),Km(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Jm(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return p1.create(t,...e)}function yr(t,e,...r){if(!t)throw Jm(e,...r)}function Ns(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Zd(e),new Error(e)}function Os(t,e){t||Ns(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zf(){return typeof self<"u"&&self.location?.href||""}function cx(){return Vg()==="http:"||Vg()==="https:"}function Vg(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(cx()||jP()||"connection"in navigator)?navigator.onLine:!0}function dx(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e,r){this.shortDelay=e,this.longDelay=r,Os(r>e,"Short delay should be less than long delay!"),this.isMobile=FP()||VP()}get(){return ux()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qm(t,e){Os(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ns("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ns("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ns("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const px=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],fx=new Yu(3e4,6e4);function Xm(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ec(t,e,r,n,i={}){return y1(t,i,async()=>{let o={},s={};n&&(e==="GET"?s=n:o={body:JSON.stringify(n)});const l=Wu({key:t.config.apiKey,...s}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...o};return BP()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Ic(t.emulatorConfig.host)&&(u.credentials="include"),m1.fetch()(await g1(t,t.config.apiHost,r,l),u)})}async function y1(t,e,r){t._canInitEmulator=!1;const n={...hx,...e};try{const i=new yx(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const s=await o.json();if("needConfirmation"in s)throw Ed(t,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const l=o.ok?s.errorMessage:s.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ed(t,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw Ed(t,"email-already-in-use",s);if(c==="USER_DISABLED")throw Ed(t,"user-disabled",s);const h=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Km(t,h,u);us(t,h)}}catch(i){if(i instanceof zs)throw i;us(t,"network-request-failed",{message:String(i)})}}async function mx(t,e,r,n,i={}){const o=await Ec(t,e,r,n,i);return"mfaPendingCredential"in o&&us(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function g1(t,e,r,n){const i=`${e}${r}?${n}`,o=t,s=o.config.emulator?Qm(t.config,i):`${t.config.apiScheme}://${i}`;return px.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}class yx{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Mo(this.auth,"network-request-failed")),fx.get())})}}function Ed(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Mo(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gx(t,e){return Ec(t,"POST","/v1/accounts:delete",e)}async function Ah(t,e){return Ec(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function vx(t,e=!1){const r=di(t),n=await r.getIdToken(e),i=Zm(n);yr(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:n,authTime:mu(Gp(i.auth_time)),issuedAtTime:mu(Gp(i.iat)),expirationTime:mu(Gp(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Gp(t){return Number(t)*1e3}function Zm(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Zd("JWT malformed, contained fewer than 3 sections"),null;try{const i=e1(r);return i?JSON.parse(i):(Zd("Failed to decode base64 JWT payload"),null)}catch(i){return Zd("Caught error parsing JWT payload as JSON",i?.toString()),null}}function qg(t){const e=Zm(t);return yr(e,"internal-error"),yr(typeof e.exp<"u","internal-error"),yr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nu(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof zs&&bx(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function bx({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=mu(this.lastLoginAt),this.creationTime=mu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ch(t){const e=t.auth,r=await t.getIdToken(),n=await Nu(t,Ah(e,{idToken:r}));yr(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=i.providerUserInfo?.length?v1(i.providerUserInfo):[],s=Px(t.providerData,o),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!s?.length,u=l?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new em(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function Sx(t){const e=di(t);await Ch(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Px(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function v1(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wx(t,e){const r=await y1(t,{},async()=>{const n=Wu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,s=await g1(t,i,"/v1/token",`key=${o}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:n};return t.emulatorConfig&&Ic(t.emulatorConfig.host)&&(c.credentials="include"),m1.fetch()(s,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function xx(t,e){return Ec(t,"POST","/v2/accounts:revokeToken",Xm(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){yr(e.idToken,"internal-error"),yr(typeof e.idToken<"u","internal-error"),yr(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):qg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){yr(e.length!==0,"internal-error");const r=qg(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(yr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await wx(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,s=new pc;return n&&(yr(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),i&&(yr(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(yr(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new pc,this.toJSON())}_performRefresh(){return Ns("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function da(t,e){yr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ro{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new _x(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new em(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Nu(this,this.stsTokenManager.getToken(this.auth,e));return yr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return vx(this,e)}reload(){return Sx(this)}_assign(e){this!==e&&(yr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Ro({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){yr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Ch(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Po(this.auth.app))return Promise.reject($a(this.auth));const e=await this.getIdToken();return await Nu(this,gx(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,o=r.phoneNumber??void 0,s=r.photoURL??void 0,l=r.tenantId??void 0,c=r._redirectEventId??void 0,u=r.createdAt??void 0,h=r.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:f,providerData:w,stsTokenManager:x}=r;yr(m&&x,e,"internal-error");const S=pc.fromJSON(this.name,x);yr(typeof m=="string",e,"internal-error"),da(n,e.name),da(i,e.name),yr(typeof g=="boolean",e,"internal-error"),yr(typeof f=="boolean",e,"internal-error"),da(o,e.name),da(s,e.name),da(l,e.name),da(c,e.name),da(u,e.name),da(h,e.name);const C=new Ro({uid:m,auth:e,email:i,emailVerified:g,displayName:n,isAnonymous:f,photoURL:s,phoneNumber:o,tenantId:l,stsTokenManager:S,createdAt:u,lastLoginAt:h});return w&&Array.isArray(w)&&(C.providerData=w.map(j=>({...j}))),c&&(C._redirectEventId=c),C}static async _fromIdTokenResponse(e,r,n=!1){const i=new pc;i.updateFromServerResponse(r);const o=new Ro({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Ch(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];yr(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?v1(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!o?.length,l=new pc;l.updateFromIdToken(n);const c=new Ro({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:s}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new em(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zg=new Map;function Ls(t){Os(t instanceof Function,"Expected a class definition");let e=zg.get(t);return e?(Os(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,zg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}b1.type="NONE";const Ug=b1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(t,e,r){return`firebase:${t}:${e}:${r}`}class fc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=eh(this.userKey,i.apiKey,o),this.fullPersistenceKey=eh("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Ah(this.auth,{idToken:e}).catch(()=>{});return r?Ro._fromGetAccountInfoResponse(this.auth,r,e):null}return Ro._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new fc(Ls(Ug),e,n);const i=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let o=i[0]||Ls(Ug);const s=eh(n,e.config.apiKey,e.name);let l=null;for(const u of r)try{const h=await u._get(s);if(h){let m;if(typeof h=="string"){const g=await Ah(e,{idToken:h}).catch(()=>{});if(!g)break;m=await Ro._fromGetAccountInfoResponse(e,g,h)}else m=Ro._fromJSON(e,h);u!==o&&(l=m),o=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new fc(o,e,n):(o=c[0],l&&await o._set(s,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==o)try{await u._remove(s)}catch{}})),new fc(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(w1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(A1(e))return"Blackberry";if(C1(e))return"Webos";if(S1(e))return"Safari";if((e.includes("chrome/")||P1(e))&&!e.includes("edge/"))return"Chrome";if(x1(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function _1(t=ki()){return/firefox\//i.test(t)}function S1(t=ki()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function P1(t=ki()){return/crios\//i.test(t)}function w1(t=ki()){return/iemobile/i.test(t)}function x1(t=ki()){return/android/i.test(t)}function A1(t=ki()){return/blackberry/i.test(t)}function C1(t=ki()){return/webos/i.test(t)}function ey(t=ki()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Ax(t=ki()){return ey(t)&&!!window.navigator?.standalone}function Cx(){return qP()&&document.documentMode===10}function I1(t=ki()){return ey(t)||x1(t)||C1(t)||A1(t)||/windows phone/i.test(t)||w1(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $1(t,e=[]){let r;switch(t){case"Browser":r=Hg(ki());break;case"Worker":r=`${Hg(ki())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${$c}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ix{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((s,l)=>{try{const c=e(o);s(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $x(t,e={}){return Ec(t,"GET","/v2/passwordPolicy",Xm(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ex=6;class Tx{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??Ex,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kx{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Gg(this),this.idTokenSubscription=new Gg(this),this.beforeStateQueue=new Ix(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=p1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ls(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await fc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Ah(this,{idToken:e}),n=await Ro._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Po(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,s=n?._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===s)&&l?.user&&(n=l.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return yr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Ch(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=dx()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Po(this.app))return Promise.reject($a(this));const r=e?di(e):null;return r&&yr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&yr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Po(this.app)?Promise.reject($a(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Po(this.app)?Promise.reject($a(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ls(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await $x(this),r=new Tx(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Gu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await xx(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ls(e)||this._popupRedirectResolver;yr(r,this,"argument-error"),this.redirectPersistenceManager=await fc.create(this,[Ls(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let s=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(yr(l,this,"internal-error"),l.then(()=>{s||o(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,i);return()=>{s=!0,c()}}else{const c=e.addObserver(r);return()=>{s=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return yr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Po(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&lx(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Nl(t){return di(t)}class Gg{constructor(e){this.auth=e,this.observer=null,this.addObserver=JP(r=>this.observer=r)}get next(){return yr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ty={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Nx(t){ty=t}function Lx(t){return ty.loadJS(t)}function Rx(){return ty.gapiScript}function Dx(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mx(t,e){const r=Ym(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(Cl(o,e??{}))return i;us(i,"already-initialized")}return r.initialize({options:e})}function Fx(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Ls);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function Ox(t,e,r){const n=Nl(t);yr(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=E1(e),{host:s,port:l}=Bx(e),c=l===null?"":`:${l}`,u={url:`${o}//${s}${c}/`},h=Object.freeze({host:s,port:l,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){yr(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),yr(Cl(u,n.config.emulator)&&Cl(h,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=u,n.emulatorConfig=h,n.settings.appVerificationDisabledForTesting=!0,Ic(s)?(i1(`${o}//${s}${c}`),o1("Auth",!0)):jx()}function E1(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Bx(t){const e=E1(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:Wg(n.substr(o.length+1))}}else{const[o,s]=n.split(":");return{host:o,port:Wg(s)}}}function Wg(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function jx(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ns("not implemented")}_getIdTokenResponse(e){return Ns("not implemented")}_linkToIdToken(e,r){return Ns("not implemented")}_getReauthenticationResolver(e){return Ns("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mc(t,e){return mx(t,"POST","/v1/accounts:signInWithIdp",Xm(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx="http://localhost";class $l extends T1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new $l(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):us("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=r;if(!n||!i)return null;const s=new $l(n,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){const r=this.buildRequest();return mc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,mc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,mc(e,r)}buildRequest(){const e={requestUri:Vx,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Wu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku extends Jh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va extends Ku{constructor(){super("facebook.com")}static credential(e){return $l._fromParams({providerId:va.PROVIDER_ID,signInMethod:va.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return va.credentialFromTaggedObject(e)}static credentialFromError(e){return va.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return va.credential(e.oauthAccessToken)}catch{return null}}}va.FACEBOOK_SIGN_IN_METHOD="facebook.com";va.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts extends Ku{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return $l._fromParams({providerId:ts.PROVIDER_ID,signInMethod:ts.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return ts.credentialFromTaggedObject(e)}static credentialFromError(e){return ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return ts.credential(r,n)}catch{return null}}}ts.GOOGLE_SIGN_IN_METHOD="google.com";ts.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba extends Ku{constructor(){super("github.com")}static credential(e){return $l._fromParams({providerId:ba.PROVIDER_ID,signInMethod:ba.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ba.credentialFromTaggedObject(e)}static credentialFromError(e){return ba.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ba.credential(e.oauthAccessToken)}catch{return null}}}ba.GITHUB_SIGN_IN_METHOD="github.com";ba.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a extends Ku{constructor(){super("twitter.com")}static credential(e,r){return $l._fromParams({providerId:_a.PROVIDER_ID,signInMethod:_a.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return _a.credentialFromTaggedObject(e)}static credentialFromError(e){return _a.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return _a.credential(r,n)}catch{return null}}}_a.TWITTER_SIGN_IN_METHOD="twitter.com";_a.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await Ro._fromIdTokenResponse(e,n,i),s=Yg(n);return new _c({user:o,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=Yg(n);return new _c({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function Yg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih extends zs{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Ih.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Ih(e,r,n,i)}}function k1(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Ih._fromErrorAndOperation(t,o,e,n):o})}async function qx(t,e,r=!1){const n=await Nu(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return _c._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zx(t,e,r=!1){const{auth:n}=t;if(Po(n.app))return Promise.reject($a(n));const i="reauthenticate";try{const o=await Nu(t,k1(n,i,e,t),r);yr(o.idToken,n,"internal-error");const s=Zm(o.idToken);yr(s,n,"internal-error");const{sub:l}=s;return yr(t.uid===l,n,"user-mismatch"),_c._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&us(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N1(t,e,r=!1){if(Po(t.app))return Promise.reject($a(t));const n="signIn",i=await k1(t,n,e),o=await _c._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function Ux(t,e){return N1(Nl(t),e)}function Hx(t,e,r,n){return di(t).onIdTokenChanged(e,r,n)}function Gx(t,e,r){return di(t).beforeAuthStateChanged(e,r)}function Wx(t,e,r,n){return di(t).onAuthStateChanged(e,r,n)}function Yx(t){return di(t).signOut()}const $h="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem($h,"1"),this.storage.removeItem($h),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kx=1e3,Jx=10;class R1 extends L1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=I1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,l,c)=>{this.notifyListeners(s,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},o=this.storage.getItem(n);Cx()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Jx):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Kx)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}R1.type="LOCAL";const Qx=R1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1 extends L1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}D1.type="SESSION";const M1=D1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xx(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Qh(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,s=this.handlersMap[i];if(!s?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const l=Array.from(s).map(async u=>u(r.origin,o)),c=await Xx(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ry(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zx{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((l,c)=>{const u=ry("",20);i.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(m){const g=m;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(h),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),l(g.data.response);break;default:clearTimeout(h),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(){return window}function eA(t){ns().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(){return typeof ns().WorkerGlobalScope<"u"&&typeof ns().importScripts=="function"}async function tA(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function rA(){return navigator?.serviceWorker?.controller||null}function nA(){return F1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1="firebaseLocalStorageDb",iA=1,Eh="firebaseLocalStorage",B1="fbase_key";class Ju{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Xh(t,e){return t.transaction([Eh],e?"readwrite":"readonly").objectStore(Eh)}function oA(){const t=indexedDB.deleteDatabase(O1);return new Ju(t).toPromise()}function tm(){const t=indexedDB.open(O1,iA);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Eh,{keyPath:B1})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Eh)?e(n):(n.close(),await oA(),e(await tm()))})})}async function Kg(t,e,r){const n=Xh(t,!0).put({[B1]:e,value:r});return new Ju(n).toPromise()}async function sA(t,e){const r=Xh(t,!1).get(e),n=await new Ju(r).toPromise();return n===void 0?null:n.value}function Jg(t,e){const r=Xh(t,!0).delete(e);return new Ju(r).toPromise()}const aA=800,lA=3;class j1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await tm(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>lA)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return F1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qh._getInstance(nA()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await tA(),!this.activeServiceWorker)return;this.sender=new Zx(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||rA()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await tm();return await Kg(e,$h,"1"),await Jg(e,$h),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Kg(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>sA(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Jg(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Xh(i,!1).getAll();return new Ju(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),aA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}j1.type="LOCAL";const cA=j1;new Yu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ny(t,e){return e?Ls(e):(yr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy extends T1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return mc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return mc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function uA(t){return N1(t.auth,new iy(t),t.bypassAuthState)}function dA(t){const{auth:e,user:r}=t;return yr(r,e,"internal-error"),zx(r,new iy(t),t.bypassAuthState)}async function hA(t){const{auth:e,user:r}=t;return yr(r,e,"internal-error"),qx(r,new iy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:s,type:l}=e;if(s){this.reject(s);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return uA;case"linkViaPopup":case"linkViaRedirect":return hA;case"reauthViaPopup":case"reauthViaRedirect":return dA;default:us(this.auth,"internal-error")}}resolve(e){Os(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Os(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA=new Yu(2e3,1e4);async function fA(t,e,r){if(Po(t.app))return Promise.reject(Mo(t,"operation-not-supported-in-this-environment"));const n=Nl(t);f1(t,e,Jh);const i=ny(n,r);return new ml(n,"signInViaPopup",e,i).executeNotNull()}class ml extends V1{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,ml.currentPopupAction&&ml.currentPopupAction.cancel(),ml.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return yr(e,this.auth,"internal-error"),e}async onExecution(){Os(this.filter.length===1,"Popup operations only handle one event");const e=ry();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Mo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Mo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ml.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Mo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,pA.get())};e()}}ml.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA="pendingRedirect",th=new Map;class yA extends V1{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=th.get(this.auth._key());if(!e){try{const n=await gA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}th.set(this.auth._key(),e)}return this.bypassAuthState||th.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function gA(t,e){const r=z1(e),n=q1(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}async function vA(t,e){return q1(t)._set(z1(e),"true")}function bA(t,e){th.set(t._key(),e)}function q1(t){return Ls(t._redirectPersistence)}function z1(t){return eh(mA,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _A(t,e,r){return SA(t,e,r)}async function SA(t,e,r){if(Po(t.app))return Promise.reject($a(t));const n=Nl(t);f1(t,e,Jh),await n._initializationPromise;const i=ny(n,r);return await vA(i,n),i._openRedirect(n,e,"signInViaRedirect")}async function PA(t,e){return await Nl(t)._initializationPromise,U1(t,e,!1)}async function U1(t,e,r=!1){if(Po(t.app))return Promise.reject($a(t));const n=Nl(t),i=ny(n,e),s=await new yA(n,i,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wA=10*60*1e3;class xA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!AA(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!H1(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Mo(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=wA&&this.cachedEventUids.clear(),this.cachedEventUids.has(Qg(e))}saveEventToCache(e){this.cachedEventUids.add(Qg(e)),this.lastProcessedEventTime=Date.now()}}function Qg(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function H1({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function AA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return H1(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CA(t,e={}){return Ec(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$A=/^https?/;async function EA(t){if(t.config.emulator)return;const{authorizedDomains:e}=await CA(t);for(const r of e)try{if(TA(r))return}catch{}us(t,"unauthorized-domain")}function TA(t){const e=Zf(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!$A.test(r))return!1;if(IA.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA=new Yu(3e4,6e4);function Xg(){const t=ns().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function NA(t){return new Promise((e,r)=>{function n(){Xg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Xg(),r(Mo(t,"network-request-failed"))},timeout:kA.get()})}if(ns().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ns().gapi?.load)n();else{const i=Dx("iframefcb");return ns()[i]=()=>{gapi.load?n():r(Mo(t,"network-request-failed"))},Lx(`${Rx()}?onload=${i}`).catch(o=>r(o))}}).catch(e=>{throw rh=null,e})}let rh=null;function LA(t){return rh=rh||NA(t),rh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RA=new Yu(5e3,15e3),DA="__/auth/iframe",MA="emulator/auth/iframe",FA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},OA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function BA(t){const e=t.config;yr(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Qm(e,MA):`https://${t.config.authDomain}/${DA}`,n={apiKey:e.apiKey,appName:t.name,v:$c},i=OA.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${Wu(n).slice(1)}`}async function jA(t){const e=await LA(t),r=ns().gapi;return yr(r,t,"internal-error"),e.open({where:document.body,url:BA(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:FA,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const s=Mo(t,"network-request-failed"),l=ns().setTimeout(()=>{o(s)},RA.get());function c(){ns().clearTimeout(l),i(n)}n.ping(c).then(c,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},qA=500,zA=600,UA="_blank",HA="http://localhost";class Zg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function GA(t,e,r,n=qA,i=zA){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c={...VA,width:n.toString(),height:i.toString(),top:o,left:s},u=ki().toLowerCase();r&&(l=P1(u)?UA:r),_1(u)&&(e=e||HA,c.scrollbars="yes");const h=Object.entries(c).reduce((g,[f,w])=>`${g}${f}=${w},`,"");if(Ax(u)&&l!=="_self")return WA(e||"",l),new Zg(null);const m=window.open(e||"",l,h);yr(m,t,"popup-blocked");try{m.focus()}catch{}return new Zg(m)}function WA(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YA="__/auth/handler",KA="emulator/auth/handler",JA=encodeURIComponent("fac");async function ev(t,e,r,n,i,o){yr(t.config.authDomain,t,"auth-domain-config-required"),yr(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:$c,eventId:i};if(e instanceof Jh){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",KP(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,m]of Object.entries({}))s[h]=m}if(e instanceof Ku){const h=e.getScopes().filter(m=>m!=="");h.length>0&&(s.scopes=h.join(","))}t.tenantId&&(s.tid=t.tenantId);const l=s;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const c=await t._getAppCheckToken(),u=c?`#${JA}=${encodeURIComponent(c)}`:"";return`${QA(t)}?${Wu(l).slice(1)}${u}`}function QA({config:t}){return t.emulator?Qm(t,KA):`https://${t.authDomain}/${YA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp="webStorageSupport";class XA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=M1,this._completeRedirectFn=U1,this._overrideRedirectResult=bA}async _openPopup(e,r,n,i){Os(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await ev(e,r,n,Zf(),i);return GA(e,o,ry())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await ev(e,r,n,Zf(),i);return eA(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(Os(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await jA(e),n=new xA(e);return r.register("authEvent",i=>(yr(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Wp,{type:Wp},i=>{const o=i?.[0]?.[Wp];o!==void 0&&r(!!o),us(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=EA(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return I1()||S1()||ey()}}const ZA=XA;var tv="@firebase/auth",rv="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){yr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tC(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function rC(t){bc(new Il("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:l}=n.options;yr(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:s,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$1(t)},u=new kx(n,i,o,c);return Fx(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),bc(new Il("auth-internal",e=>{const r=Nl(e.getProvider("auth").getImmediate());return(n=>new eC(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ia(tv,rv,tC(t)),Ia(tv,rv,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nC=5*60,iC=n1("authIdTokenMaxAge")||nC;let nv=null;const oC=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>iC)return;const i=r?.token;nv!==i&&(nv=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function sC(t=c1()){const e=Ym(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Mx(t,{popupRedirectResolver:ZA,persistence:[cA,Qx,M1]}),n=n1("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const s=oC(o.toString());Gx(r,s,()=>s(r.currentUser)),Hx(r,l=>s(l))}}const i=t1("auth");return i&&Ox(r,`http://${i}`),r}function aC(){return document.getElementsByTagName("head")?.[0]??document}Nx({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Mo("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",aC().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});rC("Browser");var lC="firebase",cC="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ia(lC,cC,"app");var iv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ea,G1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,$){function T(){}T.prototype=$.prototype,E.D=$.prototype,E.prototype=new T,E.prototype.constructor=E,E.C=function(B,_,P){for(var b=Array(arguments.length-2),H=2;H<arguments.length;H++)b[H-2]=arguments[H];return $.prototype[_].apply(B,b)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,$,T){T||(T=0);var B=Array(16);if(typeof $=="string")for(var _=0;16>_;++_)B[_]=$.charCodeAt(T++)|$.charCodeAt(T++)<<8|$.charCodeAt(T++)<<16|$.charCodeAt(T++)<<24;else for(_=0;16>_;++_)B[_]=$[T++]|$[T++]<<8|$[T++]<<16|$[T++]<<24;$=E.g[0],T=E.g[1],_=E.g[2];var P=E.g[3],b=$+(P^T&(_^P))+B[0]+3614090360&4294967295;$=T+(b<<7&4294967295|b>>>25),b=P+(_^$&(T^_))+B[1]+3905402710&4294967295,P=$+(b<<12&4294967295|b>>>20),b=_+(T^P&($^T))+B[2]+606105819&4294967295,_=P+(b<<17&4294967295|b>>>15),b=T+($^_&(P^$))+B[3]+3250441966&4294967295,T=_+(b<<22&4294967295|b>>>10),b=$+(P^T&(_^P))+B[4]+4118548399&4294967295,$=T+(b<<7&4294967295|b>>>25),b=P+(_^$&(T^_))+B[5]+1200080426&4294967295,P=$+(b<<12&4294967295|b>>>20),b=_+(T^P&($^T))+B[6]+2821735955&4294967295,_=P+(b<<17&4294967295|b>>>15),b=T+($^_&(P^$))+B[7]+4249261313&4294967295,T=_+(b<<22&4294967295|b>>>10),b=$+(P^T&(_^P))+B[8]+1770035416&4294967295,$=T+(b<<7&4294967295|b>>>25),b=P+(_^$&(T^_))+B[9]+2336552879&4294967295,P=$+(b<<12&4294967295|b>>>20),b=_+(T^P&($^T))+B[10]+4294925233&4294967295,_=P+(b<<17&4294967295|b>>>15),b=T+($^_&(P^$))+B[11]+2304563134&4294967295,T=_+(b<<22&4294967295|b>>>10),b=$+(P^T&(_^P))+B[12]+1804603682&4294967295,$=T+(b<<7&4294967295|b>>>25),b=P+(_^$&(T^_))+B[13]+4254626195&4294967295,P=$+(b<<12&4294967295|b>>>20),b=_+(T^P&($^T))+B[14]+2792965006&4294967295,_=P+(b<<17&4294967295|b>>>15),b=T+($^_&(P^$))+B[15]+1236535329&4294967295,T=_+(b<<22&4294967295|b>>>10),b=$+(_^P&(T^_))+B[1]+4129170786&4294967295,$=T+(b<<5&4294967295|b>>>27),b=P+(T^_&($^T))+B[6]+3225465664&4294967295,P=$+(b<<9&4294967295|b>>>23),b=_+($^T&(P^$))+B[11]+643717713&4294967295,_=P+(b<<14&4294967295|b>>>18),b=T+(P^$&(_^P))+B[0]+3921069994&4294967295,T=_+(b<<20&4294967295|b>>>12),b=$+(_^P&(T^_))+B[5]+3593408605&4294967295,$=T+(b<<5&4294967295|b>>>27),b=P+(T^_&($^T))+B[10]+38016083&4294967295,P=$+(b<<9&4294967295|b>>>23),b=_+($^T&(P^$))+B[15]+3634488961&4294967295,_=P+(b<<14&4294967295|b>>>18),b=T+(P^$&(_^P))+B[4]+3889429448&4294967295,T=_+(b<<20&4294967295|b>>>12),b=$+(_^P&(T^_))+B[9]+568446438&4294967295,$=T+(b<<5&4294967295|b>>>27),b=P+(T^_&($^T))+B[14]+3275163606&4294967295,P=$+(b<<9&4294967295|b>>>23),b=_+($^T&(P^$))+B[3]+4107603335&4294967295,_=P+(b<<14&4294967295|b>>>18),b=T+(P^$&(_^P))+B[8]+1163531501&4294967295,T=_+(b<<20&4294967295|b>>>12),b=$+(_^P&(T^_))+B[13]+2850285829&4294967295,$=T+(b<<5&4294967295|b>>>27),b=P+(T^_&($^T))+B[2]+4243563512&4294967295,P=$+(b<<9&4294967295|b>>>23),b=_+($^T&(P^$))+B[7]+1735328473&4294967295,_=P+(b<<14&4294967295|b>>>18),b=T+(P^$&(_^P))+B[12]+2368359562&4294967295,T=_+(b<<20&4294967295|b>>>12),b=$+(T^_^P)+B[5]+4294588738&4294967295,$=T+(b<<4&4294967295|b>>>28),b=P+($^T^_)+B[8]+2272392833&4294967295,P=$+(b<<11&4294967295|b>>>21),b=_+(P^$^T)+B[11]+1839030562&4294967295,_=P+(b<<16&4294967295|b>>>16),b=T+(_^P^$)+B[14]+4259657740&4294967295,T=_+(b<<23&4294967295|b>>>9),b=$+(T^_^P)+B[1]+2763975236&4294967295,$=T+(b<<4&4294967295|b>>>28),b=P+($^T^_)+B[4]+1272893353&4294967295,P=$+(b<<11&4294967295|b>>>21),b=_+(P^$^T)+B[7]+4139469664&4294967295,_=P+(b<<16&4294967295|b>>>16),b=T+(_^P^$)+B[10]+3200236656&4294967295,T=_+(b<<23&4294967295|b>>>9),b=$+(T^_^P)+B[13]+681279174&4294967295,$=T+(b<<4&4294967295|b>>>28),b=P+($^T^_)+B[0]+3936430074&4294967295,P=$+(b<<11&4294967295|b>>>21),b=_+(P^$^T)+B[3]+3572445317&4294967295,_=P+(b<<16&4294967295|b>>>16),b=T+(_^P^$)+B[6]+76029189&4294967295,T=_+(b<<23&4294967295|b>>>9),b=$+(T^_^P)+B[9]+3654602809&4294967295,$=T+(b<<4&4294967295|b>>>28),b=P+($^T^_)+B[12]+3873151461&4294967295,P=$+(b<<11&4294967295|b>>>21),b=_+(P^$^T)+B[15]+530742520&4294967295,_=P+(b<<16&4294967295|b>>>16),b=T+(_^P^$)+B[2]+3299628645&4294967295,T=_+(b<<23&4294967295|b>>>9),b=$+(_^(T|~P))+B[0]+4096336452&4294967295,$=T+(b<<6&4294967295|b>>>26),b=P+(T^($|~_))+B[7]+1126891415&4294967295,P=$+(b<<10&4294967295|b>>>22),b=_+($^(P|~T))+B[14]+2878612391&4294967295,_=P+(b<<15&4294967295|b>>>17),b=T+(P^(_|~$))+B[5]+4237533241&4294967295,T=_+(b<<21&4294967295|b>>>11),b=$+(_^(T|~P))+B[12]+1700485571&4294967295,$=T+(b<<6&4294967295|b>>>26),b=P+(T^($|~_))+B[3]+2399980690&4294967295,P=$+(b<<10&4294967295|b>>>22),b=_+($^(P|~T))+B[10]+4293915773&4294967295,_=P+(b<<15&4294967295|b>>>17),b=T+(P^(_|~$))+B[1]+2240044497&4294967295,T=_+(b<<21&4294967295|b>>>11),b=$+(_^(T|~P))+B[8]+1873313359&4294967295,$=T+(b<<6&4294967295|b>>>26),b=P+(T^($|~_))+B[15]+4264355552&4294967295,P=$+(b<<10&4294967295|b>>>22),b=_+($^(P|~T))+B[6]+2734768916&4294967295,_=P+(b<<15&4294967295|b>>>17),b=T+(P^(_|~$))+B[13]+1309151649&4294967295,T=_+(b<<21&4294967295|b>>>11),b=$+(_^(T|~P))+B[4]+4149444226&4294967295,$=T+(b<<6&4294967295|b>>>26),b=P+(T^($|~_))+B[11]+3174756917&4294967295,P=$+(b<<10&4294967295|b>>>22),b=_+($^(P|~T))+B[2]+718787259&4294967295,_=P+(b<<15&4294967295|b>>>17),b=T+(P^(_|~$))+B[9]+3951481745&4294967295,E.g[0]=E.g[0]+$&4294967295,E.g[1]=E.g[1]+(_+(b<<21&4294967295|b>>>11))&4294967295,E.g[2]=E.g[2]+_&4294967295,E.g[3]=E.g[3]+P&4294967295}n.prototype.u=function(E,$){$===void 0&&($=E.length);for(var T=$-this.blockSize,B=this.B,_=this.h,P=0;P<$;){if(_==0)for(;P<=T;)i(this,E,P),P+=this.blockSize;if(typeof E=="string"){for(;P<$;)if(B[_++]=E.charCodeAt(P++),_==this.blockSize){i(this,B),_=0;break}}else for(;P<$;)if(B[_++]=E[P++],_==this.blockSize){i(this,B),_=0;break}}this.h=_,this.o+=$},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var $=1;$<E.length-8;++$)E[$]=0;var T=8*this.o;for($=E.length-8;$<E.length;++$)E[$]=T&255,T/=256;for(this.u(E),E=Array(16),$=T=0;4>$;++$)for(var B=0;32>B;B+=8)E[T++]=this.g[$]>>>B&255;return E};function o(E,$){var T=l;return Object.prototype.hasOwnProperty.call(T,E)?T[E]:T[E]=$(E)}function s(E,$){this.h=$;for(var T=[],B=!0,_=E.length-1;0<=_;_--){var P=E[_]|0;B&&P==$||(T[_]=P,B=!1)}this.g=T}var l={};function c(E){return-128<=E&&128>E?o(E,function($){return new s([$|0],0>$?-1:0)}):new s([E|0],0>E?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return m;if(0>E)return S(u(-E));for(var $=[],T=1,B=0;E>=T;B++)$[B]=E/T|0,T*=4294967296;return new s($,0)}function h(E,$){if(E.length==0)throw Error("number format error: empty string");if($=$||10,2>$||36<$)throw Error("radix out of range: "+$);if(E.charAt(0)=="-")return S(h(E.substring(1),$));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=u(Math.pow($,8)),B=m,_=0;_<E.length;_+=8){var P=Math.min(8,E.length-_),b=parseInt(E.substring(_,_+P),$);8>P?(P=u(Math.pow($,P)),B=B.j(P).add(u(b))):(B=B.j(T),B=B.add(u(b)))}return B}var m=c(0),g=c(1),f=c(16777216);t=s.prototype,t.m=function(){if(x(this))return-S(this).m();for(var E=0,$=1,T=0;T<this.g.length;T++){var B=this.i(T);E+=(0<=B?B:4294967296+B)*$,$*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(w(this))return"0";if(x(this))return"-"+S(this).toString(E);for(var $=u(Math.pow(E,6)),T=this,B="";;){var _=te(T,$).g;T=C(T,_.j($));var P=((0<T.g.length?T.g[0]:T.h)>>>0).toString(E);if(T=_,w(T))return P+B;for(;6>P.length;)P="0"+P;B=P+B}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function w(E){if(E.h!=0)return!1;for(var $=0;$<E.g.length;$++)if(E.g[$]!=0)return!1;return!0}function x(E){return E.h==-1}t.l=function(E){return E=C(this,E),x(E)?-1:w(E)?0:1};function S(E){for(var $=E.g.length,T=[],B=0;B<$;B++)T[B]=~E.g[B];return new s(T,~E.h).add(g)}t.abs=function(){return x(this)?S(this):this},t.add=function(E){for(var $=Math.max(this.g.length,E.g.length),T=[],B=0,_=0;_<=$;_++){var P=B+(this.i(_)&65535)+(E.i(_)&65535),b=(P>>>16)+(this.i(_)>>>16)+(E.i(_)>>>16);B=b>>>16,P&=65535,b&=65535,T[_]=b<<16|P}return new s(T,T[T.length-1]&-2147483648?-1:0)};function C(E,$){return E.add(S($))}t.j=function(E){if(w(this)||w(E))return m;if(x(this))return x(E)?S(this).j(S(E)):S(S(this).j(E));if(x(E))return S(this.j(S(E)));if(0>this.l(f)&&0>E.l(f))return u(this.m()*E.m());for(var $=this.g.length+E.g.length,T=[],B=0;B<2*$;B++)T[B]=0;for(B=0;B<this.g.length;B++)for(var _=0;_<E.g.length;_++){var P=this.i(B)>>>16,b=this.i(B)&65535,H=E.i(_)>>>16,K=E.i(_)&65535;T[2*B+2*_]+=b*K,j(T,2*B+2*_),T[2*B+2*_+1]+=P*K,j(T,2*B+2*_+1),T[2*B+2*_+1]+=b*H,j(T,2*B+2*_+1),T[2*B+2*_+2]+=P*H,j(T,2*B+2*_+2)}for(B=0;B<$;B++)T[B]=T[2*B+1]<<16|T[2*B];for(B=$;B<2*$;B++)T[B]=0;return new s(T,0)};function j(E,$){for(;(E[$]&65535)!=E[$];)E[$+1]+=E[$]>>>16,E[$]&=65535,$++}function oe(E,$){this.g=E,this.h=$}function te(E,$){if(w($))throw Error("division by zero");if(w(E))return new oe(m,m);if(x(E))return $=te(S(E),$),new oe(S($.g),S($.h));if(x($))return $=te(E,S($)),new oe(S($.g),$.h);if(30<E.g.length){if(x(E)||x($))throw Error("slowDivide_ only works with positive integers.");for(var T=g,B=$;0>=B.l(E);)T=Z(T),B=Z(B);var _=re(T,1),P=re(B,1);for(B=re(B,2),T=re(T,2);!w(B);){var b=P.add(B);0>=b.l(E)&&(_=_.add(T),P=b),B=re(B,1),T=re(T,1)}return $=C(E,_.j($)),new oe(_,$)}for(_=m;0<=E.l($);){for(T=Math.max(1,Math.floor(E.m()/$.m())),B=Math.ceil(Math.log(T)/Math.LN2),B=48>=B?1:Math.pow(2,B-48),P=u(T),b=P.j($);x(b)||0<b.l(E);)T-=B,P=u(T),b=P.j($);w(P)&&(P=g),_=_.add(P),E=C(E,b)}return new oe(_,E)}t.A=function(E){return te(this,E).h},t.and=function(E){for(var $=Math.max(this.g.length,E.g.length),T=[],B=0;B<$;B++)T[B]=this.i(B)&E.i(B);return new s(T,this.h&E.h)},t.or=function(E){for(var $=Math.max(this.g.length,E.g.length),T=[],B=0;B<$;B++)T[B]=this.i(B)|E.i(B);return new s(T,this.h|E.h)},t.xor=function(E){for(var $=Math.max(this.g.length,E.g.length),T=[],B=0;B<$;B++)T[B]=this.i(B)^E.i(B);return new s(T,this.h^E.h)};function Z(E){for(var $=E.g.length+1,T=[],B=0;B<$;B++)T[B]=E.i(B)<<1|E.i(B-1)>>>31;return new s(T,E.h)}function re(E,$){var T=$>>5;$%=32;for(var B=E.g.length-T,_=[],P=0;P<B;P++)_[P]=0<$?E.i(P+T)>>>$|E.i(P+T+1)<<32-$:E.i(P+T);return new s(_,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,G1=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=u,s.fromString=h,Ea=s}).apply(typeof iv<"u"?iv:typeof self<"u"?self:typeof window<"u"?window:{});var Td=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var W1,au,Y1,nh,rm,K1,J1,Q1;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,O,ae){return p==Array.prototype||p==Object.prototype||(p[O]=ae.value),p};function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Td=="object"&&Td];for(var O=0;O<p.length;++O){var ae=p[O];if(ae&&ae.Math==Math)return ae}throw Error("Cannot find global object")}var n=r(this);function i(p,O){if(O)e:{var ae=n;p=p.split(".");for(var Se=0;Se<p.length-1;Se++){var Ve=p[Se];if(!(Ve in ae))break e;ae=ae[Ve]}p=p[p.length-1],Se=ae[p],O=O(Se),O!=Se&&O!=null&&e(ae,p,{configurable:!0,writable:!0,value:O})}}function o(p,O){p instanceof String&&(p+="");var ae=0,Se=!1,Ve={next:function(){if(!Se&&ae<p.length){var Ze=ae++;return{value:O(Ze,p[Ze]),done:!1}}return Se=!0,{done:!0,value:void 0}}};return Ve[Symbol.iterator]=function(){return Ve},Ve}i("Array.prototype.values",function(p){return p||function(){return o(this,function(O,ae){return ae})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},l=this||self;function c(p){var O=typeof p;return O=O!="object"?O:p?Array.isArray(p)?"array":O:"null",O=="array"||O=="object"&&typeof p.length=="number"}function u(p){var O=typeof p;return O=="object"&&p!=null||O=="function"}function h(p,O,ae){return p.call.apply(p.bind,arguments)}function m(p,O,ae){if(!p)throw Error();if(2<arguments.length){var Se=Array.prototype.slice.call(arguments,2);return function(){var Ve=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Ve,Se),p.apply(O,Ve)}}return function(){return p.apply(O,arguments)}}function g(p,O,ae){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:m,g.apply(null,arguments)}function f(p,O){var ae=Array.prototype.slice.call(arguments,1);return function(){var Se=ae.slice();return Se.push.apply(Se,arguments),p.apply(this,Se)}}function w(p,O){function ae(){}ae.prototype=O.prototype,p.aa=O.prototype,p.prototype=new ae,p.prototype.constructor=p,p.Qb=function(Se,Ve,Ze){for(var At=Array(arguments.length-2),Sr=2;Sr<arguments.length;Sr++)At[Sr-2]=arguments[Sr];return O.prototype[Ve].apply(Se,At)}}function x(p){const O=p.length;if(0<O){const ae=Array(O);for(let Se=0;Se<O;Se++)ae[Se]=p[Se];return ae}return[]}function S(p,O){for(let ae=1;ae<arguments.length;ae++){const Se=arguments[ae];if(c(Se)){const Ve=p.length||0,Ze=Se.length||0;p.length=Ve+Ze;for(let At=0;At<Ze;At++)p[Ve+At]=Se[At]}else p.push(Se)}}class C{constructor(O,ae){this.i=O,this.j=ae,this.h=0,this.g=null}get(){let O;return 0<this.h?(this.h--,O=this.g,this.g=O.next,O.next=null):O=this.i(),O}}function j(p){return/^[\s\xa0]*$/.test(p)}function oe(){var p=l.navigator;return p&&(p=p.userAgent)?p:""}function te(p){return te[" "](p),p}te[" "]=function(){};var Z=oe().indexOf("Gecko")!=-1&&!(oe().toLowerCase().indexOf("webkit")!=-1&&oe().indexOf("Edge")==-1)&&!(oe().indexOf("Trident")!=-1||oe().indexOf("MSIE")!=-1)&&oe().indexOf("Edge")==-1;function re(p,O,ae){for(const Se in p)O.call(ae,p[Se],Se,p)}function E(p,O){for(const ae in p)O.call(void 0,p[ae],ae,p)}function $(p){const O={};for(const ae in p)O[ae]=p[ae];return O}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function B(p,O){let ae,Se;for(let Ve=1;Ve<arguments.length;Ve++){Se=arguments[Ve];for(ae in Se)p[ae]=Se[ae];for(let Ze=0;Ze<T.length;Ze++)ae=T[Ze],Object.prototype.hasOwnProperty.call(Se,ae)&&(p[ae]=Se[ae])}}function _(p){var O=1;p=p.split(":");const ae=[];for(;0<O&&p.length;)ae.push(p.shift()),O--;return p.length&&ae.push(p.join(":")),ae}function P(p){l.setTimeout(()=>{throw p},0)}function b(){var p=z;let O=null;return p.g&&(O=p.g,p.g=p.g.next,p.g||(p.h=null),O.next=null),O}class H{constructor(){this.h=this.g=null}add(O,ae){const Se=K.get();Se.set(O,ae),this.h?this.h.next=Se:this.g=Se,this.h=Se}}var K=new C(()=>new R,p=>p.reset());class R{constructor(){this.next=this.g=this.h=null}set(O,ae){this.h=O,this.g=ae,this.next=null}reset(){this.next=this.g=this.h=null}}let k,W=!1,z=new H,U=()=>{const p=l.Promise.resolve(void 0);k=()=>{p.then(le)}};var le=()=>{for(var p;p=b();){try{p.h.call(p.g)}catch(ae){P(ae)}var O=K;O.j(p),100>O.h&&(O.h++,p.next=O.g,O.g=p)}W=!1};function L(){this.s=this.s,this.C=this.C}L.prototype.s=!1,L.prototype.ma=function(){this.s||(this.s=!0,this.N())},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(p,O){this.type=p,this.g=this.target=O,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var G=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var p=!1,O=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const ae=()=>{};l.addEventListener("test",ae,O),l.removeEventListener("test",ae,O)}catch{}return p}();function I(p,O){if(M.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var ae=this.type=p.type,Se=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=O,O=p.relatedTarget){if(Z){e:{try{te(O.nodeName);var Ve=!0;break e}catch{}Ve=!1}Ve||(O=null)}}else ae=="mouseover"?O=p.fromElement:ae=="mouseout"&&(O=p.toElement);this.relatedTarget=O,Se?(this.clientX=Se.clientX!==void 0?Se.clientX:Se.pageX,this.clientY=Se.clientY!==void 0?Se.clientY:Se.pageY,this.screenX=Se.screenX||0,this.screenY=Se.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:F[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&I.aa.h.call(this)}}w(I,M);var F={2:"touch",3:"pen",4:"mouse"};I.prototype.h=function(){I.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var X="closure_listenable_"+(1e6*Math.random()|0),Y=0;function Q(p,O,ae,Se,Ve){this.listener=p,this.proxy=null,this.src=O,this.type=ae,this.capture=!!Se,this.ha=Ve,this.key=++Y,this.da=this.fa=!1}function J(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function V(p){this.src=p,this.g={},this.h=0}V.prototype.add=function(p,O,ae,Se,Ve){var Ze=p.toString();p=this.g[Ze],p||(p=this.g[Ze]=[],this.h++);var At=ee(p,O,Se,Ve);return-1<At?(O=p[At],ae||(O.fa=!1)):(O=new Q(O,this.src,Ze,!!Se,Ve),O.fa=ae,p.push(O)),O};function ne(p,O){var ae=O.type;if(ae in p.g){var Se=p.g[ae],Ve=Array.prototype.indexOf.call(Se,O,void 0),Ze;(Ze=0<=Ve)&&Array.prototype.splice.call(Se,Ve,1),Ze&&(J(O),p.g[ae].length==0&&(delete p.g[ae],p.h--))}}function ee(p,O,ae,Se){for(var Ve=0;Ve<p.length;++Ve){var Ze=p[Ve];if(!Ze.da&&Ze.listener==O&&Ze.capture==!!ae&&Ze.ha==Se)return Ve}return-1}var ce="closure_lm_"+(1e6*Math.random()|0),se={};function q(p,O,ae,Se,Ve){if(Array.isArray(O)){for(var Ze=0;Ze<O.length;Ze++)q(p,O[Ze],ae,Se,Ve);return null}return ae=Ee(ae),p&&p[X]?p.K(O,ae,u(Se)?!!Se.capture:!1,Ve):ue(p,O,ae,!1,Se,Ve)}function ue(p,O,ae,Se,Ve,Ze){if(!O)throw Error("Invalid event type");var At=u(Ve)?!!Ve.capture:!!Ve,Sr=_e(p);if(Sr||(p[ce]=Sr=new V(p)),ae=Sr.add(O,ae,Se,At,Ze),ae.proxy)return ae;if(Se=ye(),ae.proxy=Se,Se.src=p,Se.listener=ae,p.addEventListener)G||(Ve=At),Ve===void 0&&(Ve=!1),p.addEventListener(O.toString(),Se,Ve);else if(p.attachEvent)p.attachEvent(xe(O.toString()),Se);else if(p.addListener&&p.removeListener)p.addListener(Se);else throw Error("addEventListener and attachEvent are unavailable.");return ae}function ye(){function p(ae){return O.call(p.src,p.listener,ae)}const O=pe;return p}function de(p,O,ae,Se,Ve){if(Array.isArray(O))for(var Ze=0;Ze<O.length;Ze++)de(p,O[Ze],ae,Se,Ve);else Se=u(Se)?!!Se.capture:!!Se,ae=Ee(ae),p&&p[X]?(p=p.i,O=String(O).toString(),O in p.g&&(Ze=p.g[O],ae=ee(Ze,ae,Se,Ve),-1<ae&&(J(Ze[ae]),Array.prototype.splice.call(Ze,ae,1),Ze.length==0&&(delete p.g[O],p.h--)))):p&&(p=_e(p))&&(O=p.g[O.toString()],p=-1,O&&(p=ee(O,ae,Se,Ve)),(ae=-1<p?O[p]:null)&&ge(ae))}function ge(p){if(typeof p!="number"&&p&&!p.da){var O=p.src;if(O&&O[X])ne(O.i,p);else{var ae=p.type,Se=p.proxy;O.removeEventListener?O.removeEventListener(ae,Se,p.capture):O.detachEvent?O.detachEvent(xe(ae),Se):O.addListener&&O.removeListener&&O.removeListener(Se),(ae=_e(O))?(ne(ae,p),ae.h==0&&(ae.src=null,O[ce]=null)):J(p)}}}function xe(p){return p in se?se[p]:se[p]="on"+p}function pe(p,O){if(p.da)p=!0;else{O=new I(O,this);var ae=p.listener,Se=p.ha||p.src;p.fa&&ge(p),p=ae.call(Se,O)}return p}function _e(p){return p=p[ce],p instanceof V?p:null}var Re="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ee(p){return typeof p=="function"?p:(p[Re]||(p[Re]=function(O){return p.handleEvent(O)}),p[Re])}function Te(){L.call(this),this.i=new V(this),this.M=this,this.F=null}w(Te,L),Te.prototype[X]=!0,Te.prototype.removeEventListener=function(p,O,ae,Se){de(this,p,O,ae,Se)};function Le(p,O){var ae,Se=p.F;if(Se)for(ae=[];Se;Se=Se.F)ae.push(Se);if(p=p.M,Se=O.type||O,typeof O=="string")O=new M(O,p);else if(O instanceof M)O.target=O.target||p;else{var Ve=O;O=new M(Se,p),B(O,Ve)}if(Ve=!0,ae)for(var Ze=ae.length-1;0<=Ze;Ze--){var At=O.g=ae[Ze];Ve=Ie(At,Se,!0,O)&&Ve}if(At=O.g=p,Ve=Ie(At,Se,!0,O)&&Ve,Ve=Ie(At,Se,!1,O)&&Ve,ae)for(Ze=0;Ze<ae.length;Ze++)At=O.g=ae[Ze],Ve=Ie(At,Se,!1,O)&&Ve}Te.prototype.N=function(){if(Te.aa.N.call(this),this.i){var p=this.i,O;for(O in p.g){for(var ae=p.g[O],Se=0;Se<ae.length;Se++)J(ae[Se]);delete p.g[O],p.h--}}this.F=null},Te.prototype.K=function(p,O,ae,Se){return this.i.add(String(p),O,!1,ae,Se)},Te.prototype.L=function(p,O,ae,Se){return this.i.add(String(p),O,!0,ae,Se)};function Ie(p,O,ae,Se){if(O=p.i.g[String(O)],!O)return!0;O=O.concat();for(var Ve=!0,Ze=0;Ze<O.length;++Ze){var At=O[Ze];if(At&&!At.da&&At.capture==ae){var Sr=At.listener,Dr=At.ha||At.src;At.fa&&ne(p.i,At),Ve=Sr.call(Dr,Se)!==!1&&Ve}}return Ve&&!Se.defaultPrevented}function De(p,O,ae){if(typeof p=="function")ae&&(p=g(p,ae));else if(p&&typeof p.handleEvent=="function")p=g(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(O)?-1:l.setTimeout(p,O||0)}function Ye(p){p.g=De(()=>{p.g=null,p.i&&(p.i=!1,Ye(p))},p.l);const O=p.h;p.h=null,p.m.apply(null,O)}class Be extends L{constructor(O,ae){super(),this.m=O,this.l=ae,this.h=null,this.i=!1,this.g=null}j(O){this.h=arguments,this.g?this.i=!0:Ye(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function We(p){L.call(this),this.h=p,this.g={}}w(We,L);var Ke=[];function st(p){re(p.g,function(O,ae){this.g.hasOwnProperty(ae)&&ge(O)},p),p.g={}}We.prototype.N=function(){We.aa.N.call(this),st(this)},We.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var nt=l.JSON.stringify,He=l.JSON.parse,mt=class{stringify(p){return l.JSON.stringify(p,void 0)}parse(p){return l.JSON.parse(p,void 0)}};function ut(){}ut.prototype.h=null;function at(p){return p.h||(p.h=p.i())}function It(){}var Xe={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function kt(){M.call(this,"d")}w(kt,M);function Tt(){M.call(this,"c")}w(Tt,M);var wt={},Rt=null;function fr(){return Rt=Rt||new Te}wt.La="serverreachability";function ze(p){M.call(this,wt.La,p)}w(ze,M);function Ct(p){const O=fr();Le(O,new ze(O))}wt.STAT_EVENT="statevent";function xt(p,O){M.call(this,wt.STAT_EVENT,p),this.stat=O}w(xt,M);function tt(p){const O=fr();Le(O,new xt(O,p))}wt.Ma="timingevent";function bt(p,O){M.call(this,wt.Ma,p),this.size=O}w(bt,M);function Mt(p,O){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){p()},O)}function Wt(){this.g=!0}Wt.prototype.xa=function(){this.g=!1};function Jt(p,O,ae,Se,Ve,Ze){p.info(function(){if(p.g)if(Ze)for(var At="",Sr=Ze.split("&"),Dr=0;Dr<Sr.length;Dr++){var Pr=Sr[Dr].split("=");if(1<Pr.length){var Xr=Pr[0];Pr=Pr[1];var sn=Xr.split("_");At=2<=sn.length&&sn[1]=="type"?At+(Xr+"="+Pr+"&"):At+(Xr+"=redacted&")}}else At=null;else At=Ze;return"XMLHTTP REQ ("+Se+") [attempt "+Ve+"]: "+O+`
`+ae+`
`+At})}function lt(p,O,ae,Se,Ve,Ze,At){p.info(function(){return"XMLHTTP RESP ("+Se+") [ attempt "+Ve+"]: "+O+`
`+ae+`
`+Ze+" "+At})}function gt(p,O,ae,Se){p.info(function(){return"XMLHTTP TEXT ("+O+"): "+et(p,ae)+(Se?" "+Se:"")})}function $t(p,O){p.info(function(){return"TIMEOUT: "+O})}Wt.prototype.info=function(){};function et(p,O){if(!p.g)return O;if(!O)return null;try{var ae=JSON.parse(O);if(ae){for(p=0;p<ae.length;p++)if(Array.isArray(ae[p])){var Se=ae[p];if(!(2>Se.length)){var Ve=Se[1];if(Array.isArray(Ve)&&!(1>Ve.length)){var Ze=Ve[0];if(Ze!="noop"&&Ze!="stop"&&Ze!="close")for(var At=1;At<Ve.length;At++)Ve[At]=""}}}}return nt(ae)}catch{return O}}var Vt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ht={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Xt;function er(){}w(er,ut),er.prototype.g=function(){return new XMLHttpRequest},er.prototype.i=function(){return{}},Xt=new er;function Kt(p,O,ae,Se){this.j=p,this.i=O,this.l=ae,this.R=Se||1,this.U=new We(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ir}function ir(){this.i=null,this.g="",this.h=!1}var vr={},cr={};function br(p,O,ae){p.L=1,p.v=vn(Lr(O)),p.m=ae,p.P=!0,Nt(p,null)}function Nt(p,O){p.F=Date.now(),Tr(p),p.A=Lr(p.v);var ae=p.A,Se=p.R;Array.isArray(Se)||(Se=[String(Se)]),nr(ae.i,"t",Se),p.C=0,ae=p.j.J,p.h=new ir,p.g=fe(p.j,ae?O:null,!p.m),0<p.O&&(p.M=new Be(g(p.Y,p,p.g),p.O)),O=p.U,ae=p.g,Se=p.ca;var Ve="readystatechange";Array.isArray(Ve)||(Ve&&(Ke[0]=Ve.toString()),Ve=Ke);for(var Ze=0;Ze<Ve.length;Ze++){var At=q(ae,Ve[Ze],Se||O.handleEvent,!1,O.h||O);if(!At)break;O.g[At.key]=At}O=p.H?$(p.H):{},p.m?(p.u||(p.u="POST"),O["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,O)):(p.u="GET",p.g.ea(p.A,p.u,null,O)),Ct(),Jt(p.i,p.u,p.A,p.l,p.R,p.m)}Kt.prototype.ca=function(p){p=p.target;const O=this.M;O&&Hn(p)==3?O.j():this.Y(p)},Kt.prototype.Y=function(p){try{if(p==this.g)e:{const sn=Hn(this.g);var O=this.g.Ba();const Co=this.g.Z();if(!(3>sn)&&(sn!=3||this.g&&(this.h.h||this.g.oa()||Fl(this.g)))){this.J||sn!=4||O==7||(O==8||0>=Co?Ct(3):Ct(2)),gr(this);var ae=this.g.Z();this.X=ae;t:if(Et(this)){var Se=Fl(this.g);p="";var Ve=Se.length,Ze=Hn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Wr(this),Er(this);var At="";break t}this.h.i=new l.TextDecoder}for(O=0;O<Ve;O++)this.h.h=!0,p+=this.h.i.decode(Se[O],{stream:!(Ze&&O==Ve-1)});Se.length=0,this.h.g+=p,this.C=0,At=this.h.g}else At=this.g.oa();if(this.o=ae==200,lt(this.i,this.u,this.A,this.l,this.R,sn,ae),this.o){if(this.T&&!this.K){t:{if(this.g){var Sr,Dr=this.g;if((Sr=Dr.g?Dr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(Sr)){var Pr=Sr;break t}}Pr=null}if(ae=Pr)gt(this.i,this.l,ae,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ur(this,ae);else{this.o=!1,this.s=3,tt(12),Wr(this),Er(this);break e}}if(this.P){ae=!0;let si;for(;!this.J&&this.C<At.length;)if(si=Cr(this,At),si==cr){sn==4&&(this.s=4,tt(14),ae=!1),gt(this.i,this.l,null,"[Incomplete Response]");break}else if(si==vr){this.s=4,tt(15),gt(this.i,this.l,At,"[Invalid Chunk]"),ae=!1;break}else gt(this.i,this.l,si,null),ur(this,si);if(Et(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),sn!=4||At.length!=0||this.h.h||(this.s=1,tt(16),ae=!1),this.o=this.o&&ae,!ae)gt(this.i,this.l,At,"[Invalid Chunked Response]"),Wr(this),Er(this);else if(0<At.length&&!this.W){this.W=!0;var Xr=this.j;Xr.g==this&&Xr.ba&&!Xr.M&&(Xr.j.info("Great, no buffering proxy detected. Bytes received: "+At.length),Qs(Xr),Xr.M=!0,tt(11))}}else gt(this.i,this.l,At,null),ur(this,At);sn==4&&Wr(this),this.o&&!this.J&&(sn==4?Wo(this.j,this):(this.o=!1,Tr(this)))}else Ho(this.g),ae==400&&0<At.indexOf("Unknown SID")?(this.s=3,tt(12)):(this.s=0,tt(13)),Wr(this),Er(this)}}}catch{}finally{}};function Et(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function Cr(p,O){var ae=p.C,Se=O.indexOf(`
`,ae);return Se==-1?cr:(ae=Number(O.substring(ae,Se)),isNaN(ae)?vr:(Se+=1,Se+ae>O.length?cr:(O=O.slice(Se,Se+ae),p.C=Se+ae,O)))}Kt.prototype.cancel=function(){this.J=!0,Wr(this)};function Tr(p){p.S=Date.now()+p.I,mr(p,p.I)}function mr(p,O){if(p.B!=null)throw Error("WatchDog timer not null");p.B=Mt(g(p.ba,p),O)}function gr(p){p.B&&(l.clearTimeout(p.B),p.B=null)}Kt.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?($t(this.i,this.A),this.L!=2&&(Ct(),tt(17)),Wr(this),this.s=2,Er(this)):mr(this,this.S-p)};function Er(p){p.j.G==0||p.J||Wo(p.j,p)}function Wr(p){gr(p);var O=p.M;O&&typeof O.ma=="function"&&O.ma(),p.M=null,st(p.U),p.g&&(O=p.g,p.g=null,O.abort(),O.ma())}function ur(p,O){try{var ae=p.j;if(ae.G!=0&&(ae.g==p||gn(ae.h,p))){if(!p.K&&gn(ae.h,p)&&ae.G==3){try{var Se=ae.Da.g.parse(O)}catch{Se=null}if(Array.isArray(Se)&&Se.length==3){var Ve=Se;if(Ve[0]==0){e:if(!ae.u){if(ae.g)if(ae.g.F+3e3<p.F)Ao(ae),Ws(ae);else break e;vs(ae),tt(18)}}else ae.za=Ve[1],0<ae.za-ae.T&&37500>Ve[2]&&ae.F&&ae.v==0&&!ae.C&&(ae.C=Mt(g(ae.Za,ae),6e3));if(1>=bn(ae.h)&&ae.ca){try{ae.ca()}catch{}ae.ca=void 0}}else gi(ae,11)}else if((p.K||ae.g==p)&&Ao(ae),!j(O))for(Ve=ae.Da.g.parse(O),O=0;O<Ve.length;O++){let Pr=Ve[O];if(ae.T=Pr[0],Pr=Pr[1],ae.G==2)if(Pr[0]=="c"){ae.K=Pr[1],ae.ia=Pr[2];const Xr=Pr[3];Xr!=null&&(ae.la=Xr,ae.j.info("VER="+ae.la));const sn=Pr[4];sn!=null&&(ae.Aa=sn,ae.j.info("SVER="+ae.Aa));const Co=Pr[5];Co!=null&&typeof Co=="number"&&0<Co&&(Se=1.5*Co,ae.L=Se,ae.j.info("backChannelRequestTimeoutMs_="+Se)),Se=ae;const si=p.g;if(si){const Yo=si.g?si.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Yo){var Ze=Se.h;Ze.g||Yo.indexOf("spdy")==-1&&Yo.indexOf("quic")==-1&&Yo.indexOf("h2")==-1||(Ze.j=Ze.l,Ze.g=new Set,Ze.h&&(kr(Ze,Ze.h),Ze.h=null))}if(Se.D){const Ko=si.g?si.g.getResponseHeader("X-HTTP-Session-Id"):null;Ko&&(Se.ya=Ko,ar(Se.I,Se.D,Ko))}}ae.G=3,ae.l&&ae.l.ua(),ae.ba&&(ae.R=Date.now()-p.F,ae.j.info("Handshake RTT: "+ae.R+"ms")),Se=ae;var At=p;if(Se.qa=A(Se,Se.J?Se.ia:null,Se.W),At.K){Un(Se.h,At);var Sr=At,Dr=Se.L;Dr&&(Sr.I=Dr),Sr.B&&(gr(Sr),Tr(Sr)),Se.g=At}else Js(Se);0<ae.i.length&&Ys(ae)}else Pr[0]!="stop"&&Pr[0]!="close"||gi(ae,7);else ae.G==3&&(Pr[0]=="stop"||Pr[0]=="close"?Pr[0]=="stop"?gi(ae,7):xo(ae):Pr[0]!="noop"&&ae.l&&ae.l.ta(Pr),ae.v=0)}}Ct(4)}catch{}}var un=class{constructor(p,O){this.g=p,this.map=O}};function yn(p){this.l=p||10,l.PerformanceNavigationTiming?(p=l.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function zn(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function bn(p){return p.h?1:p.g?p.g.size:0}function gn(p,O){return p.h?p.h==O:p.g?p.g.has(O):!1}function kr(p,O){p.g?p.g.add(O):p.h=O}function Un(p,O){p.h&&p.h==O?p.h=null:p.g&&p.g.has(O)&&p.g.delete(O)}yn.prototype.cancel=function(){if(this.i=ei(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function ei(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let O=p.i;for(const ae of p.g.values())O=O.concat(ae.D);return O}return x(p.i)}function pi(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(c(p)){for(var O=[],ae=p.length,Se=0;Se<ae;Se++)O.push(p[Se]);return O}O=[],ae=0;for(Se in p)O[ae++]=p[Se];return O}function tr(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(c(p)||typeof p=="string"){var O=[];p=p.length;for(var ae=0;ae<p;ae++)O.push(ae);return O}O=[],ae=0;for(const Se in p)O[ae++]=Se;return O}}}function Nr(p,O){if(p.forEach&&typeof p.forEach=="function")p.forEach(O,void 0);else if(c(p)||typeof p=="string")Array.prototype.forEach.call(p,O,void 0);else for(var ae=tr(p),Se=pi(p),Ve=Se.length,Ze=0;Ze<Ve;Ze++)O.call(void 0,Se[Ze],ae&&ae[Ze],p)}var Vr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _n(p,O){if(p){p=p.split("&");for(var ae=0;ae<p.length;ae++){var Se=p[ae].indexOf("="),Ve=null;if(0<=Se){var Ze=p[ae].substring(0,Se);Ve=p[ae].substring(Se+1)}else Ze=p[ae];O(Ze,Ve?decodeURIComponent(Ve.replace(/\+/g," ")):"")}}}function qr(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof qr){this.h=p.h,ti(this,p.j),this.o=p.o,this.g=p.g,ri(this,p.s),this.l=p.l;var O=p.i,ae=new Rn;ae.i=O.i,O.g&&(ae.g=new Map(O.g),ae.h=O.h),_t(this,ae),this.m=p.m}else p&&(O=String(p).match(Vr))?(this.h=!1,ti(this,O[1]||"",!0),this.o=nn(O[2]||""),this.g=nn(O[3]||"",!0),ri(this,O[4]),this.l=nn(O[5]||"",!0),_t(this,O[6]||"",!0),this.m=nn(O[7]||"")):(this.h=!1,this.i=new Rn(null,this.h))}qr.prototype.toString=function(){var p=[],O=this.j;O&&p.push(Gr(O,ni,!0),":");var ae=this.g;return(ae||O=="file")&&(p.push("//"),(O=this.o)&&p.push(Gr(O,ni,!0),"@"),p.push(encodeURIComponent(String(ae)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ae=this.s,ae!=null&&p.push(":",String(ae))),(ae=this.l)&&(this.g&&ae.charAt(0)!="/"&&p.push("/"),p.push(Gr(ae,ae.charAt(0)=="/"?Pn:co,!0))),(ae=this.i.toString())&&p.push("?",ae),(ae=this.m)&&p.push("#",Gr(ae,fi)),p.join("")};function Lr(p){return new qr(p)}function ti(p,O,ae){p.j=ae?nn(O,!0):O,p.j&&(p.j=p.j.replace(/:$/,""))}function ri(p,O){if(O){if(O=Number(O),isNaN(O)||0>O)throw Error("Bad port number "+O);p.s=O}else p.s=null}function _t(p,O,ae){O instanceof Rn?(p.i=O,Ua(p.i,p.h)):(ae||(O=Gr(O,Bi)),p.i=new Rn(O,p.h))}function ar(p,O,ae){p.i.set(O,ae)}function vn(p){return ar(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function nn(p,O){return p?O?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Gr(p,O,ae){return typeof p=="string"?(p=encodeURI(p).replace(O,Jn),ae&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Jn(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var ni=/[#\/\?@]/g,co=/[#\?:]/g,Pn=/[#\?]/g,Bi=/[#\?@]/g,fi=/#/g;function Rn(p,O){this.h=this.g=null,this.i=p||null,this.j=!!O}function Rr(p){p.g||(p.g=new Map,p.h=0,p.i&&_n(p.i,function(O,ae){p.add(decodeURIComponent(O.replace(/\+/g," ")),ae)}))}t=Rn.prototype,t.add=function(p,O){Rr(this),this.i=null,p=uo(this,p);var ae=this.g.get(p);return ae||this.g.set(p,ae=[]),ae.push(O),this.h+=1,this};function mi(p,O){Rr(p),O=uo(p,O),p.g.has(O)&&(p.i=null,p.h-=p.g.get(O).length,p.g.delete(O))}function yi(p,O){return Rr(p),O=uo(p,O),p.g.has(O)}t.forEach=function(p,O){Rr(this),this.g.forEach(function(ae,Se){ae.forEach(function(Ve){p.call(O,Ve,Se,this)},this)},this)},t.na=function(){Rr(this);const p=Array.from(this.g.values()),O=Array.from(this.g.keys()),ae=[];for(let Se=0;Se<O.length;Se++){const Ve=p[Se];for(let Ze=0;Ze<Ve.length;Ze++)ae.push(O[Se])}return ae},t.V=function(p){Rr(this);let O=[];if(typeof p=="string")yi(this,p)&&(O=O.concat(this.g.get(uo(this,p))));else{p=Array.from(this.g.values());for(let ae=0;ae<p.length;ae++)O=O.concat(p[ae])}return O},t.set=function(p,O){return Rr(this),this.i=null,p=uo(this,p),yi(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[O]),this.h+=1,this},t.get=function(p,O){return p?(p=this.V(p),0<p.length?String(p[0]):O):O};function nr(p,O,ae){mi(p,O),0<ae.length&&(p.i=null,p.g.set(uo(p,O),x(ae)),p.h+=ae.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],O=Array.from(this.g.keys());for(var ae=0;ae<O.length;ae++){var Se=O[ae];const Ze=encodeURIComponent(String(Se)),At=this.V(Se);for(Se=0;Se<At.length;Se++){var Ve=Ze;At[Se]!==""&&(Ve+="="+encodeURIComponent(String(At[Se]))),p.push(Ve)}}return this.i=p.join("&")};function uo(p,O){return O=String(O),p.j&&(O=O.toLowerCase()),O}function Ua(p,O){O&&!p.j&&(Rr(p),p.i=null,p.g.forEach(function(ae,Se){var Ve=Se.toLowerCase();Se!=Ve&&(mi(this,Se),nr(this,Ve,ae))},p)),p.j=O}function ji(p,O){const ae=new Wt;if(l.Image){const Se=new Image;Se.onload=f(ii,ae,"TestLoadImage: loaded",!0,O,Se),Se.onerror=f(ii,ae,"TestLoadImage: error",!1,O,Se),Se.onabort=f(ii,ae,"TestLoadImage: abort",!1,O,Se),Se.ontimeout=f(ii,ae,"TestLoadImage: timeout",!1,O,Se),l.setTimeout(function(){Se.ontimeout&&Se.ontimeout()},1e4),Se.src=p}else O(!1)}function Vo(p,O){const ae=new Wt,Se=new AbortController,Ve=setTimeout(()=>{Se.abort(),ii(ae,"TestPingServer: timeout",!1,O)},1e4);fetch(p,{signal:Se.signal}).then(Ze=>{clearTimeout(Ve),Ze.ok?ii(ae,"TestPingServer: ok",!0,O):ii(ae,"TestPingServer: server error",!1,O)}).catch(()=>{clearTimeout(Ve),ii(ae,"TestPingServer: error",!1,O)})}function ii(p,O,ae,Se,Ve){try{Ve&&(Ve.onload=null,Ve.onerror=null,Ve.onabort=null,Ve.ontimeout=null),Se(ae)}catch{}}function qo(){this.g=new mt}function fs(p,O,ae){const Se=ae||"";try{Nr(p,function(Ve,Ze){let At=Ve;u(Ve)&&(At=nt(Ve)),O.push(Se+Ze+"="+encodeURIComponent(At))})}catch(Ve){throw O.push(Se+"type="+encodeURIComponent("_badmap")),Ve}}function zo(p){this.l=p.Ub||null,this.j=p.eb||!1}w(zo,ut),zo.prototype.g=function(){return new Uo(this.l,this.j)},zo.prototype.i=function(p){return function(){return p}}({});function Uo(p,O){Te.call(this),this.D=p,this.o=O,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(Uo,Te),t=Uo.prototype,t.open=function(p,O){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=O,this.readyState=1,Ni(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const O={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(O.body=p),(this.D||l).fetch(new Request(this.A,O)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Zi(this)),this.readyState=0},t.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Ni(this)),this.g&&(this.readyState=3,Ni(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Us(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function Us(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}t.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var O=p.value?p.value:new Uint8Array(0);(O=this.v.decode(O,{stream:!p.done}))&&(this.response=this.responseText+=O)}p.done?Zi(this):Ni(this),this.readyState==3&&Us(this)}},t.Ra=function(p){this.g&&(this.response=this.responseText=p,Zi(this))},t.Qa=function(p){this.g&&(this.response=p,Zi(this))},t.ga=function(){this.g&&Zi(this)};function Zi(p){p.readyState=4,p.l=null,p.j=null,p.v=null,Ni(p)}t.setRequestHeader=function(p,O){this.u.append(p,O)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],O=this.h.entries();for(var ae=O.next();!ae.done;)ae=ae.value,p.push(ae[0]+": "+ae[1]),ae=O.next();return p.join(`\r
`)};function Ni(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Uo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function eo(p){let O="";return re(p,function(ae,Se){O+=Se,O+=":",O+=ae,O+=`\r
`}),O}function Ha(p,O,ae){e:{for(Se in ae){var Se=!1;break e}Se=!0}Se||(ae=eo(ae),typeof p=="string"?ae!=null&&encodeURIComponent(String(ae)):ar(p,O,ae))}function Qr(p){Te.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(Qr,Te);var Ga=/^https?$/i,Hs=["POST","PUT"];t=Qr.prototype,t.Ha=function(p){this.J=p},t.ea=function(p,O,ae,Se){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);O=O?O.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Xt.g(),this.v=this.o?at(this.o):at(Xt),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(O,String(p),!0),this.B=!1}catch(Ze){Wa(this,Ze);return}if(p=ae||"",ae=new Map(this.headers),Se)if(Object.getPrototypeOf(Se)===Object.prototype)for(var Ve in Se)ae.set(Ve,Se[Ve]);else if(typeof Se.keys=="function"&&typeof Se.get=="function")for(const Ze of Se.keys())ae.set(Ze,Se.get(Ze));else throw Error("Unknown input type for opt_headers: "+String(Se));Se=Array.from(ae.keys()).find(Ze=>Ze.toLowerCase()=="content-type"),Ve=l.FormData&&p instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Hs,O,void 0))||Se||Ve||ae.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ze,At]of ae)this.g.setRequestHeader(Ze,At);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{to(this),this.u=!0,this.g.send(p),this.u=!1}catch(Ze){Wa(this,Ze)}};function Wa(p,O){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=O,p.m=5,Ya(p),ms(p)}function Ya(p){p.A||(p.A=!0,Le(p,"complete"),Le(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,Le(this,"complete"),Le(this,"abort"),ms(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ms(this,!0)),Qr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ka(this):this.bb())},t.bb=function(){Ka(this)};function Ka(p){if(p.h&&typeof s<"u"&&(!p.v[1]||Hn(p)!=4||p.Z()!=2)){if(p.u&&Hn(p)==4)De(p.Ea,0,p);else if(Le(p,"readystatechange"),Hn(p)==4){p.h=!1;try{const At=p.Z();e:switch(At){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var O=!0;break e;default:O=!1}var ae;if(!(ae=O)){var Se;if(Se=At===0){var Ve=String(p.D).match(Vr)[1]||null;!Ve&&l.self&&l.self.location&&(Ve=l.self.location.protocol.slice(0,-1)),Se=!Ga.test(Ve?Ve.toLowerCase():"")}ae=Se}if(ae)Le(p,"complete"),Le(p,"success");else{p.m=6;try{var Ze=2<Hn(p)?p.g.statusText:""}catch{Ze=""}p.l=Ze+" ["+p.Z()+"]",Ya(p)}}finally{ms(p)}}}}function ms(p,O){if(p.g){to(p);const ae=p.g,Se=p.v[0]?()=>{}:null;p.g=null,p.v=null,O||Le(p,"ready");try{ae.onreadystatechange=Se}catch{}}}function to(p){p.I&&(l.clearTimeout(p.I),p.I=null)}t.isActive=function(){return!!this.g};function Hn(p){return p.g?p.g.readyState:0}t.Z=function(){try{return 2<Hn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(p){if(this.g){var O=this.g.responseText;return p&&O.indexOf(p)==0&&(O=O.substring(p.length)),He(O)}};function Fl(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Ho(p){const O={};p=(p.g&&2<=Hn(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let Se=0;Se<p.length;Se++){if(j(p[Se]))continue;var ae=_(p[Se]);const Ve=ae[0];if(ae=ae[1],typeof ae!="string")continue;ae=ae.trim();const Ze=O[Ve]||[];O[Ve]=Ze,Ze.push(ae)}E(O,function(Se){return Se.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function oi(p,O,ae){return ae&&ae.internalChannelParams&&ae.internalChannelParams[p]||O}function Gs(p){this.Aa=0,this.i=[],this.j=new Wt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=oi("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=oi("baseRetryDelayMs",5e3,p),this.cb=oi("retryDelaySeedMs",1e4,p),this.Wa=oi("forwardChannelMaxRetries",2,p),this.wa=oi("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new yn(p&&p.concurrentRequestLimit),this.Da=new qo,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Gs.prototype,t.la=8,t.G=1,t.connect=function(p,O,ae,Se){tt(0),this.W=p,this.H=O||{},ae&&Se!==void 0&&(this.H.OSID=ae,this.H.OAID=Se),this.F=this.X,this.I=A(this,null,this.W),Ys(this)};function xo(p){if(ys(p),p.G==3){var O=p.U++,ae=Lr(p.I);if(ar(ae,"SID",p.K),ar(ae,"RID",O),ar(ae,"TYPE","terminate"),Go(p,ae),O=new Kt(p,p.j,O),O.L=2,O.v=vn(Lr(ae)),ae=!1,l.navigator&&l.navigator.sendBeacon)try{ae=l.navigator.sendBeacon(O.v.toString(),"")}catch{}!ae&&l.Image&&(new Image().src=O.v,ae=!0),ae||(O.g=fe(O.j,null),O.g.ea(O.v)),O.F=Date.now(),Tr(O)}Zs(p)}function Ws(p){p.g&&(Qs(p),p.g.cancel(),p.g=null)}function ys(p){Ws(p),p.u&&(l.clearTimeout(p.u),p.u=null),Ao(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&l.clearTimeout(p.s),p.s=null)}function Ys(p){if(!zn(p.h)&&!p.s){p.s=!0;var O=p.Ga;k||U(),W||(k(),W=!0),z.add(O,p),p.B=0}}function Ja(p,O){return bn(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=O.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=Mt(g(p.Ga,p,O),Xs(p,p.B)),p.B++,!0)}t.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const Ve=new Kt(this,this.j,p);let Ze=this.o;if(this.S&&(Ze?(Ze=$(Ze),B(Ze,this.S)):Ze=this.S),this.m!==null||this.O||(Ve.H=Ze,Ze=null),this.P)e:{for(var O=0,ae=0;ae<this.i.length;ae++){t:{var Se=this.i[ae];if("__data__"in Se.map&&(Se=Se.map.__data__,typeof Se=="string")){Se=Se.length;break t}Se=void 0}if(Se===void 0)break;if(O+=Se,4096<O){O=ae;break e}if(O===4096||ae===this.i.length-1){O=ae+1;break e}}O=1e3}else O=1e3;O=gs(this,Ve,O),ae=Lr(this.I),ar(ae,"RID",p),ar(ae,"CVER",22),this.D&&ar(ae,"X-HTTP-Session-Id",this.D),Go(this,ae),Ze&&(this.O?O="headers="+encodeURIComponent(String(eo(Ze)))+"&"+O:this.m&&Ha(ae,this.m,Ze)),kr(this.h,Ve),this.Ua&&ar(ae,"TYPE","init"),this.P?(ar(ae,"$req",O),ar(ae,"SID","null"),Ve.T=!0,br(Ve,ae,null)):br(Ve,ae,O),this.G=2}}else this.G==3&&(p?Ks(this,p):this.i.length==0||zn(this.h)||Ks(this))};function Ks(p,O){var ae;O?ae=O.l:ae=p.U++;const Se=Lr(p.I);ar(Se,"SID",p.K),ar(Se,"RID",ae),ar(Se,"AID",p.T),Go(p,Se),p.m&&p.o&&Ha(Se,p.m,p.o),ae=new Kt(p,p.j,ae,p.B+1),p.m===null&&(ae.H=p.o),O&&(p.i=O.D.concat(p.i)),O=gs(p,ae,1e3),ae.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),kr(p.h,ae),br(ae,Se,O)}function Go(p,O){p.H&&re(p.H,function(ae,Se){ar(O,Se,ae)}),p.l&&Nr({},function(ae,Se){ar(O,Se,ae)})}function gs(p,O,ae){ae=Math.min(p.i.length,ae);var Se=p.l?g(p.l.Na,p.l,p):null;e:{var Ve=p.i;let Ze=-1;for(;;){const At=["count="+ae];Ze==-1?0<ae?(Ze=Ve[0].g,At.push("ofs="+Ze)):Ze=0:At.push("ofs="+Ze);let Sr=!0;for(let Dr=0;Dr<ae;Dr++){let Pr=Ve[Dr].g;const Xr=Ve[Dr].map;if(Pr-=Ze,0>Pr)Ze=Math.max(0,Ve[Dr].g-100),Sr=!1;else try{fs(Xr,At,"req"+Pr+"_")}catch{Se&&Se(Xr)}}if(Sr){Se=At.join("&");break e}}}return p=p.i.splice(0,ae),O.D=p,Se}function Js(p){if(!p.g&&!p.u){p.Y=1;var O=p.Fa;k||U(),W||(k(),W=!0),z.add(O,p),p.v=0}}function vs(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=Mt(g(p.Fa,p),Xs(p,p.v)),p.v++,!0)}t.Fa=function(){if(this.u=null,Ol(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=Mt(g(this.ab,this),p)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,tt(10),Ws(this),Ol(this))};function Qs(p){p.A!=null&&(l.clearTimeout(p.A),p.A=null)}function Ol(p){p.g=new Kt(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var O=Lr(p.qa);ar(O,"RID","rpc"),ar(O,"SID",p.K),ar(O,"AID",p.T),ar(O,"CI",p.F?"0":"1"),!p.F&&p.ja&&ar(O,"TO",p.ja),ar(O,"TYPE","xmlhttp"),Go(p,O),p.m&&p.o&&Ha(O,p.m,p.o),p.L&&(p.g.I=p.L);var ae=p.g;p=p.ia,ae.L=1,ae.v=vn(Lr(O)),ae.m=null,ae.P=!0,Nt(ae,p)}t.Za=function(){this.C!=null&&(this.C=null,Ws(this),vs(this),tt(19))};function Ao(p){p.C!=null&&(l.clearTimeout(p.C),p.C=null)}function Wo(p,O){var ae=null;if(p.g==O){Ao(p),Qs(p),p.g=null;var Se=2}else if(gn(p.h,O))ae=O.D,Un(p.h,O),Se=1;else return;if(p.G!=0){if(O.o)if(Se==1){ae=O.m?O.m.length:0,O=Date.now()-O.F;var Ve=p.B;Se=fr(),Le(Se,new bt(Se,ae)),Ys(p)}else Js(p);else if(Ve=O.s,Ve==3||Ve==0&&0<O.X||!(Se==1&&Ja(p,O)||Se==2&&vs(p)))switch(ae&&0<ae.length&&(O=p.h,O.i=O.i.concat(ae)),Ve){case 1:gi(p,5);break;case 4:gi(p,10);break;case 3:gi(p,6);break;default:gi(p,2)}}}function Xs(p,O){let ae=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(ae*=2),ae*O}function gi(p,O){if(p.j.info("Error code "+O),O==2){var ae=g(p.fb,p),Se=p.Xa;const Ve=!Se;Se=new qr(Se||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ti(Se,"https"),vn(Se),Ve?ji(Se.toString(),ae):Vo(Se.toString(),ae)}else tt(2);p.G=0,p.l&&p.l.sa(O),Zs(p),ys(p)}t.fb=function(p){p?(this.j.info("Successfully pinged google.com"),tt(2)):(this.j.info("Failed to ping google.com"),tt(1))};function Zs(p){if(p.G=0,p.ka=[],p.l){const O=ei(p.h);(O.length!=0||p.i.length!=0)&&(S(p.ka,O),S(p.ka,p.i),p.h.i.length=0,x(p.i),p.i.length=0),p.l.ra()}}function A(p,O,ae){var Se=ae instanceof qr?Lr(ae):new qr(ae);if(Se.g!="")O&&(Se.g=O+"."+Se.g),ri(Se,Se.s);else{var Ve=l.location;Se=Ve.protocol,O=O?O+"."+Ve.hostname:Ve.hostname,Ve=+Ve.port;var Ze=new qr(null);Se&&ti(Ze,Se),O&&(Ze.g=O),Ve&&ri(Ze,Ve),ae&&(Ze.l=ae),Se=Ze}return ae=p.D,O=p.ya,ae&&O&&ar(Se,ae,O),ar(Se,"VER",p.la),Go(p,Se),Se}function fe(p,O,ae){if(O&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return O=p.Ca&&!p.pa?new Qr(new zo({eb:ae})):new Qr(p.pa),O.Ha(p.J),O}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ne(){}t=Ne.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Me(){}Me.prototype.g=function(p,O){return new qe(p,O)};function qe(p,O){Te.call(this),this.g=new Gs(O),this.l=p,this.h=O&&O.messageUrlParams||null,p=O&&O.messageHeaders||null,O&&O.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=O&&O.initMessageHeaders||null,O&&O.messageContentType&&(p?p["X-WebChannel-Content-Type"]=O.messageContentType:p={"X-WebChannel-Content-Type":O.messageContentType}),O&&O.va&&(p?p["X-WebChannel-Client-Profile"]=O.va:p={"X-WebChannel-Client-Profile":O.va}),this.g.S=p,(p=O&&O.Sb)&&!j(p)&&(this.g.m=p),this.v=O&&O.supportsCrossDomainXhr||!1,this.u=O&&O.sendRawJson||!1,(O=O&&O.httpSessionIdParam)&&!j(O)&&(this.g.D=O,p=this.h,p!==null&&O in p&&(p=this.h,O in p&&delete p[O])),this.j=new Ot(this)}w(qe,Te),qe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},qe.prototype.close=function(){xo(this.g)},qe.prototype.o=function(p){var O=this.g;if(typeof p=="string"){var ae={};ae.__data__=p,p=ae}else this.u&&(ae={},ae.__data__=nt(p),p=ae);O.i.push(new un(O.Ya++,p)),O.G==3&&Ys(O)},qe.prototype.N=function(){this.g.l=null,delete this.j,xo(this.g),delete this.g,qe.aa.N.call(this)};function it(p){kt.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var O=p.__sm__;if(O){e:{for(const ae in O){p=ae;break e}p=void 0}(this.i=p)&&(p=this.i,O=O!==null&&p in O?O[p]:void 0),this.data=O}else this.data=p}w(it,kt);function Pt(){Tt.call(this),this.status=1}w(Pt,Tt);function Ot(p){this.g=p}w(Ot,Ne),Ot.prototype.ua=function(){Le(this.g,"a")},Ot.prototype.ta=function(p){Le(this.g,new it(p))},Ot.prototype.sa=function(p){Le(this.g,new Pt)},Ot.prototype.ra=function(){Le(this.g,"b")},Me.prototype.createWebChannel=Me.prototype.g,qe.prototype.send=qe.prototype.o,qe.prototype.open=qe.prototype.m,qe.prototype.close=qe.prototype.close,Q1=function(){return new Me},J1=function(){return fr()},K1=wt,rm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Vt.NO_ERROR=0,Vt.TIMEOUT=8,Vt.HTTP_ERROR=6,nh=Vt,Ht.COMPLETE="complete",Y1=Ht,It.EventType=Xe,Xe.OPEN="a",Xe.CLOSE="b",Xe.ERROR="c",Xe.MESSAGE="d",Te.prototype.listen=Te.prototype.K,au=It,Qr.prototype.listenOnce=Qr.prototype.L,Qr.prototype.getLastError=Qr.prototype.Ka,Qr.prototype.getLastErrorCode=Qr.prototype.Ba,Qr.prototype.getStatus=Qr.prototype.Z,Qr.prototype.getResponseJson=Qr.prototype.Oa,Qr.prototype.getResponseText=Qr.prototype.oa,Qr.prototype.send=Qr.prototype.ea,Qr.prototype.setWithCredentials=Qr.prototype.Ha,W1=Qr}).apply(typeof Td<"u"?Td:typeof self<"u"?self:typeof window<"u"?window:{});const ov="@firebase/firestore",sv="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ai.UNAUTHENTICATED=new Ai(null),Ai.GOOGLE_CREDENTIALS=new Ai("google-credentials-uid"),Ai.FIRST_PARTY=new Ai("first-party-uid"),Ai.MOCK_USER=new Ai("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tc="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const El=new Gm("@firebase/firestore");function sc(){return El.logLevel}function Gt(t,...e){if(El.logLevel<=Fr.DEBUG){const r=e.map(oy);El.debug(`Firestore (${Tc}): ${t}`,...r)}}function Bs(t,...e){if(El.logLevel<=Fr.ERROR){const r=e.map(oy);El.error(`Firestore (${Tc}): ${t}`,...r)}}function Sc(t,...e){if(El.logLevel<=Fr.WARN){const r=e.map(oy);El.warn(`Firestore (${Tc}): ${t}`,...r)}}function oy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,X1(t,n,r)}function X1(t,e,r){let n=`FIRESTORE (${Tc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Bs(n),new Error(n)}function Zr(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||X1(e,i,n)}function xr(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qt extends zs{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class uC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Ai.UNAUTHENTICATED))}shutdown(){}}class dC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class hC{constructor(e){this.t=e,this.currentUser=Ai.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Zr(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let o=new Ms;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ms,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const c=o;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{Gt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Gt("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ms)}},0),s()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Gt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Zr(typeof n.accessToken=="string",31837,{l:n}),new Z1(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Zr(e===null||typeof e=="string",2055,{h:e}),new Ai(e)}}class pC{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Ai.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class fC{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new pC(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Ai.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class av{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class mC{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Po(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Zr(this.o===void 0,3512);const n=o=>{o.error!=null&&Gt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.m;return this.m=o.token,Gt("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{Gt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):Gt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new av(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Zr(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new av(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=yC(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function Or(t,e){return t<e?-1:t>e?1:0}function nm(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),o=e.charAt(n);if(i!==o)return Yp(i)===Yp(o)?Or(i,o):Yp(i)?1:-1}return Or(t.length,e.length)}const gC=55296,vC=57343;function Yp(t){const e=t.charCodeAt(0);return e>=gC&&e<=vC}function Pc(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lv="__name__";class es{constructor(e,r,n){r===void 0?r=0:r>e.length&&hr(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&hr(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return es.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof es?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=es.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return Or(e.length,r.length)}static compareSegments(e,r){const n=es.isNumericId(e),i=es.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?es.extractNumericId(e).compare(es.extractNumericId(r)):nm(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ea.fromString(e.substring(4,e.length-2))}}class pn extends es{construct(e,r,n){return new pn(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new qt(dt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new pn(r)}static emptyPath(){return new pn([])}}const bC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ui extends es{construct(e,r,n){return new ui(e,r,n)}static isValidIdentifier(e){return bC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ui.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===lv}static keyField(){return new ui([lv])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new qt(dt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let s=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new qt(dt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new qt(dt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else l==="`"?(s=!s,i++):l!=="."||s?(n+=l,i++):(o(),i++)}if(o(),s)throw new qt(dt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ui(r)}static emptyPath(){return new ui([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e){this.path=e}static fromPath(e){return new rr(pn.fromString(e))}static fromName(e){return new rr(pn.fromString(e).popFirst(5))}static empty(){return new rr(pn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return pn.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new rr(new pn(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2(t,e,r){if(!r)throw new qt(dt.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function _C(t,e,r,n){if(e===!0&&n===!0)throw new qt(dt.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function cv(t){if(!rr.isDocumentKey(t))throw new qt(dt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function uv(t){if(rr.isDocumentKey(t))throw new qt(dt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function t2(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Zh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":hr(12329,{type:typeof t})}function js(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new qt(dt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Zh(t);throw new qt(dt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vn(t,e){const r={typeString:t};return e&&(r.value=e),r}function Qu(t,e){if(!t2(t))throw new qt(dt.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const s=t[n];if(i&&typeof s!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new qt(dt.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dv=-62135596800,hv=1e6;class fn{static now(){return fn.fromMillis(Date.now())}static fromDate(e){return fn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*hv);return new fn(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new qt(dt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new qt(dt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<dv)throw new qt(dt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new qt(dt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/hv}_compareTo(e){return this.seconds===e.seconds?Or(this.nanoseconds,e.nanoseconds):Or(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:fn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Qu(e,fn._jsonSchema))return new fn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-dv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}fn._jsonSchemaVersion="firestore/timestamp/1.0",fn._jsonSchema={type:Vn("string",fn._jsonSchemaVersion),seconds:Vn("number"),nanoseconds:Vn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{static fromTimestamp(e){return new _r(e)}static min(){return new _r(new fn(0,0))}static max(){return new _r(new fn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lu=-1;function SC(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=_r.fromTimestamp(n===1e9?new fn(r+1,0):new fn(r,n));return new Na(i,rr.empty(),e)}function PC(t){return new Na(t.readTime,t.key,Lu)}class Na{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Na(_r.min(),rr.empty(),Lu)}static max(){return new Na(_r.max(),rr.empty(),Lu)}}function wC(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=rr.comparator(t.documentKey,e.documentKey),r!==0?r:Or(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class AC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kc(t){if(t.code!==dt.FAILED_PRECONDITION||t.message!==xC)throw t;Gt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&hr(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new vt((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof vt?r:vt.resolve(r)}catch(r){return vt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):vt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):vt.reject(r)}static resolve(e){return new vt((r,n)=>{r(e)})}static reject(e){return new vt((r,n)=>{n(e)})}static waitFor(e){return new vt((r,n)=>{let i=0,o=0,s=!1;e.forEach(l=>{++i,l.next(()=>{++o,s&&o===i&&r()},c=>n(c))}),s=!0,o===i&&r()})}static or(e){let r=vt.resolve(!1);for(const n of e)r=r.next(i=>i?vt.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new vt((n,i)=>{const o=e.length,s=new Array(o);let l=0;for(let c=0;c<o;c++){const u=c;r(e[u]).next(h=>{s[u]=h,++l,l===o&&n(s)},h=>i(h))}})}static doWhile(e,r){return new vt((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function CC(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Nc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ep.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ay=-1;function tp(t){return t==null}function Th(t){return t===0&&1/t==-1/0}function IC(t){return typeof t=="number"&&Number.isInteger(t)&&!Th(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r2="";function $C(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=pv(e)),e=EC(t.get(r),e);return pv(e)}function EC(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case r2:r+="";break;default:r+=o}}return r}function pv(t){return t+r2+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fv(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function qa(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function n2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e,r){this.comparator=e,this.root=r||ci.EMPTY}insert(e,r){return new Sn(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,ci.BLACK,null,null))}remove(e){return new Sn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ci.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new kd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new kd(this.root,e,this.comparator,!1)}getReverseIterator(){return new kd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new kd(this.root,e,this.comparator,!0)}}class kd{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ci{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??ci.RED,this.left=i??ci.EMPTY,this.right=o??ci.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new ci(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ci.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return ci.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ci.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ci.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw hr(43730,{key:this.key,value:this.value});if(this.right.isRed())throw hr(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw hr(27949);return e+(this.isRed()?0:1)}}ci.EMPTY=null,ci.RED=!0,ci.BLACK=!1;ci.EMPTY=new class{constructor(){this.size=0}get key(){throw hr(57766)}get value(){throw hr(16141)}get color(){throw hr(16727)}get left(){throw hr(29726)}get right(){throw hr(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new ci(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e){this.comparator=e,this.data=new Sn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new mv(this.data.getIterator())}getIteratorFrom(e){return new mv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Kn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Kn(this.comparator);return r.data=e,r}}class mv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e){this.fields=e,e.sort(ui.comparator)}static empty(){return new so([])}unionWith(e){let r=new Kn(ui.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new so(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Pc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new i2("Invalid base64 string: "+o):o}}(e);return new hi(r)}static fromUint8Array(e){const r=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new hi(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Or(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}hi.EMPTY_BYTE_STRING=new hi("");const TC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function La(t){if(Zr(!!t,39018),typeof t=="string"){let e=0;const r=TC.exec(t);if(Zr(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:En(t.seconds),nanos:En(t.nanos)}}function En(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ra(t){return typeof t=="string"?hi.fromBase64String(t):hi.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o2="server_timestamp",s2="__type__",a2="__previous_value__",l2="__local_write_time__";function ly(t){return(t?.mapValue?.fields||{})[s2]?.stringValue===o2}function rp(t){const e=t.mapValue.fields[a2];return ly(e)?rp(e):e}function Ru(t){const e=La(t.mapValue.fields[l2].timestampValue);return new fn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{constructor(e,r,n,i,o,s,l,c,u,h){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=h}}const kh="(default)";class Du{constructor(e,r){this.projectId=e,this.database=r||kh}static empty(){return new Du("","")}get isDefaultDatabase(){return this.database===kh}isEqual(e){return e instanceof Du&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c2="__type__",NC="__max__",Nd={mapValue:{}},u2="__vector__",Nh="value";function Da(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ly(t)?4:RC(t)?9007199254740991:LC(t)?10:11:hr(28295,{value:t})}function ds(t,e){if(t===e)return!0;const r=Da(t);if(r!==Da(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ru(t).isEqual(Ru(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=La(i.timestampValue),l=La(o.timestampValue);return s.seconds===l.seconds&&s.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Ra(i.bytesValue).isEqual(Ra(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return En(i.geoPointValue.latitude)===En(o.geoPointValue.latitude)&&En(i.geoPointValue.longitude)===En(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return En(i.integerValue)===En(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=En(i.doubleValue),l=En(o.doubleValue);return s===l?Th(s)===Th(l):isNaN(s)&&isNaN(l)}return!1}(t,e);case 9:return Pc(t.arrayValue.values||[],e.arrayValue.values||[],ds);case 10:case 11:return function(i,o){const s=i.mapValue.fields||{},l=o.mapValue.fields||{};if(fv(s)!==fv(l))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(l[c]===void 0||!ds(s[c],l[c])))return!1;return!0}(t,e);default:return hr(52216,{left:t})}}function Mu(t,e){return(t.values||[]).find(r=>ds(r,e))!==void 0}function wc(t,e){if(t===e)return 0;const r=Da(t),n=Da(e);if(r!==n)return Or(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Or(t.booleanValue,e.booleanValue);case 2:return function(o,s){const l=En(o.integerValue||o.doubleValue),c=En(s.integerValue||s.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return yv(t.timestampValue,e.timestampValue);case 4:return yv(Ru(t),Ru(e));case 5:return nm(t.stringValue,e.stringValue);case 6:return function(o,s){const l=Ra(o),c=Ra(s);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(o,s){const l=o.split("/"),c=s.split("/");for(let u=0;u<l.length&&u<c.length;u++){const h=Or(l[u],c[u]);if(h!==0)return h}return Or(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,s){const l=Or(En(o.latitude),En(s.latitude));return l!==0?l:Or(En(o.longitude),En(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return gv(t.arrayValue,e.arrayValue);case 10:return function(o,s){const l=o.fields||{},c=s.fields||{},u=l[Nh]?.arrayValue,h=c[Nh]?.arrayValue,m=Or(u?.values?.length||0,h?.values?.length||0);return m!==0?m:gv(u,h)}(t.mapValue,e.mapValue);case 11:return function(o,s){if(o===Nd.mapValue&&s===Nd.mapValue)return 0;if(o===Nd.mapValue)return 1;if(s===Nd.mapValue)return-1;const l=o.fields||{},c=Object.keys(l),u=s.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let m=0;m<c.length&&m<h.length;++m){const g=nm(c[m],h[m]);if(g!==0)return g;const f=wc(l[c[m]],u[h[m]]);if(f!==0)return f}return Or(c.length,h.length)}(t.mapValue,e.mapValue);default:throw hr(23264,{he:r})}}function yv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Or(t,e);const r=La(t),n=La(e),i=Or(r.seconds,n.seconds);return i!==0?i:Or(r.nanos,n.nanos)}function gv(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=wc(r[i],n[i]);if(o)return o}return Or(r.length,n.length)}function xc(t){return im(t)}function im(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=La(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Ra(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return rr.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=im(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const s of n)o?o=!1:i+=",",i+=`${s}:${im(r.fields[s])}`;return i+"}"}(t.mapValue):hr(61005,{value:t})}function ih(t){switch(Da(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=rp(t);return e?16+ih(e):16;case 5:return 2*t.stringValue.length;case 6:return Ra(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+ih(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return qa(n.fields,(o,s)=>{i+=o.length+ih(s)}),i}(t.mapValue);default:throw hr(13486,{value:t})}}function vv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function om(t){return!!t&&"integerValue"in t}function cy(t){return!!t&&"arrayValue"in t}function bv(t){return!!t&&"nullValue"in t}function _v(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function oh(t){return!!t&&"mapValue"in t}function LC(t){return(t?.mapValue?.fields||{})[c2]?.stringValue===u2}function yu(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return qa(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=yu(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=yu(t.arrayValue.values[r]);return e}return{...t}}function RC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===NC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e){this.value=e}static empty(){return new Yi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!oh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=yu(r)}setAll(e){let r=ui.emptyPath(),n={},i=[];e.forEach((s,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=l.popLast()}s?n[l.lastSegment()]=yu(s):i.push(l.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());oh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ds(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];oh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){qa(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new Yi(yu(this.value))}}function d2(t){const e=[];return qa(t.fields,(r,n)=>{const i=new ui([r]);if(oh(n)){const o=d2(n.mapValue).fields;if(o.length===0)e.push(i);else for(const s of o)e.push(i.child(s))}else e.push(i)}),new so(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e,r,n,i,o,s,l){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=s,this.documentState=l}static newInvalidDocument(e){return new Ci(e,0,_r.min(),_r.min(),_r.min(),Yi.empty(),0)}static newFoundDocument(e,r,n,i){return new Ci(e,1,r,_r.min(),n,i,0)}static newNoDocument(e,r){return new Ci(e,2,r,_r.min(),_r.min(),Yi.empty(),0)}static newUnknownDocument(e,r){return new Ci(e,3,r,_r.min(),_r.min(),Yi.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(_r.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Yi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Yi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=_r.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ci&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ci(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(e,r){this.position=e,this.inclusive=r}}function Sv(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],s=t.position[i];if(o.field.isKeyField()?n=rr.comparator(rr.fromName(s.referenceValue),r.key):n=wc(s,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function Pv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ds(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,r="asc"){this.field=e,this.dir=r}}function DC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{}class jn extends h2{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new FC(e,r,n):r==="array-contains"?new jC(e,n):r==="in"?new VC(e,n):r==="not-in"?new qC(e,n):r==="array-contains-any"?new zC(e,n):new jn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new OC(e,n):new BC(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(wc(r,this.value)):r!==null&&Da(this.value)===Da(r)&&this.matchesComparison(wc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return hr(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Oo extends h2{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Oo(e,r)}matches(e){return p2(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function p2(t){return t.op==="and"}function f2(t){return MC(t)&&p2(t)}function MC(t){for(const e of t.filters)if(e instanceof Oo)return!1;return!0}function sm(t){if(t instanceof jn)return t.field.canonicalString()+t.op.toString()+xc(t.value);if(f2(t))return t.filters.map(e=>sm(e)).join(",");{const e=t.filters.map(r=>sm(r)).join(",");return`${t.op}(${e})`}}function m2(t,e){return t instanceof jn?function(n,i){return i instanceof jn&&n.op===i.op&&n.field.isEqual(i.field)&&ds(n.value,i.value)}(t,e):t instanceof Oo?function(n,i){return i instanceof Oo&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,s,l)=>o&&m2(s,i.filters[l]),!0):!1}(t,e):void hr(19439)}function y2(t){return t instanceof jn?function(r){return`${r.field.canonicalString()} ${r.op} ${xc(r.value)}`}(t):t instanceof Oo?function(r){return r.op.toString()+" {"+r.getFilters().map(y2).join(" ,")+"}"}(t):"Filter"}class FC extends jn{constructor(e,r,n){super(e,r,n),this.key=rr.fromName(n.referenceValue)}matches(e){const r=rr.comparator(e.key,this.key);return this.matchesComparison(r)}}class OC extends jn{constructor(e,r){super(e,"in",r),this.keys=g2("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class BC extends jn{constructor(e,r){super(e,"not-in",r),this.keys=g2("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function g2(t,e){return(e.arrayValue?.values||[]).map(r=>rr.fromName(r.referenceValue))}class jC extends jn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return cy(r)&&Mu(r.arrayValue,this.value)}}class VC extends jn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Mu(this.value.arrayValue,r)}}class qC extends jn{constructor(e,r){super(e,"not-in",r)}matches(e){if(Mu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Mu(this.value.arrayValue,r)}}class zC extends jn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!cy(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Mu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(e,r=null,n=[],i=[],o=null,s=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=s,this.endAt=l,this.Te=null}}function wv(t,e=null,r=[],n=[],i=null,o=null,s=null){return new UC(t,e,r,n,i,o,s)}function uy(t){const e=xr(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>sm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),tp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>xc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>xc(n)).join(",")),e.Te=r}return e.Te}function dy(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!DC(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!m2(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Pv(t.startAt,e.startAt)&&Pv(t.endAt,e.endAt)}function am(t){return rr.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc{constructor(e,r=null,n=[],i=[],o=null,s="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=s,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function HC(t,e,r,n,i,o,s,l){return new Lc(t,e,r,n,i,o,s,l)}function hy(t){return new Lc(t)}function xv(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function v2(t){return t.collectionGroup!==null}function gu(t){const e=xr(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let l=new Kn(ui.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Fu(o,n))}),r.has(ui.keyField().canonicalString())||e.Ie.push(new Fu(ui.keyField(),n))}return e.Ie}function is(t){const e=xr(t);return e.Ee||(e.Ee=GC(e,gu(t))),e.Ee}function GC(t,e){if(t.limitType==="F")return wv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new Fu(i.field,o)});const r=t.endAt?new Lh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Lh(t.startAt.position,t.startAt.inclusive):null;return wv(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function lm(t,e){const r=t.filters.concat([e]);return new Lc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function cm(t,e,r){return new Lc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function np(t,e){return dy(is(t),is(e))&&t.limitType===e.limitType}function b2(t){return`${uy(is(t))}|lt:${t.limitType}`}function ac(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>y2(i)).join(", ")}]`),tp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>xc(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>xc(i)).join(",")),`Target(${n})`}(is(t))}; limitType=${t.limitType})`}function ip(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):rr.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of gu(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(s,l,c){const u=Sv(s,l,c);return s.inclusive?u<=0:u<0}(n.startAt,gu(n),i)||n.endAt&&!function(s,l,c){const u=Sv(s,l,c);return s.inclusive?u>=0:u>0}(n.endAt,gu(n),i))}(t,e)}function WC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function _2(t){return(e,r)=>{let n=!1;for(const i of gu(t)){const o=YC(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function YC(t,e,r){const n=t.field.isKeyField()?rr.comparator(e.key,r.key):function(o,s,l){const c=s.data.field(o),u=l.data.field(o);return c!==null&&u!==null?wc(c,u):hr(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return hr(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){qa(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return n2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KC=new Sn(rr.comparator);function Vs(){return KC}const S2=new Sn(rr.comparator);function lu(...t){let e=S2;for(const r of t)e=e.insert(r.key,r);return e}function P2(t){let e=S2;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function yl(){return vu()}function w2(){return vu()}function vu(){return new Ll(t=>t.toString(),(t,e)=>t.isEqual(e))}const JC=new Sn(rr.comparator),QC=new Kn(rr.comparator);function Br(...t){let e=QC;for(const r of t)e=e.add(r);return e}const XC=new Kn(Or);function ZC(){return XC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Th(e)?"-0":e}}function x2(t){return{integerValue:""+t}}function e3(t,e){return IC(e)?x2(e):py(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(){this._=void 0}}function t3(t,e,r){return t instanceof Rh?function(i,o){const s={fields:{[s2]:{stringValue:o2},[l2]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&ly(o)&&(o=rp(o)),o&&(s.fields[a2]=o),{mapValue:s}}(r,e):t instanceof Ou?C2(t,e):t instanceof Bu?I2(t,e):function(i,o){const s=A2(i,o),l=Av(s)+Av(i.Ae);return om(s)&&om(i.Ae)?x2(l):py(i.serializer,l)}(t,e)}function r3(t,e,r){return t instanceof Ou?C2(t,e):t instanceof Bu?I2(t,e):r}function A2(t,e){return t instanceof Dh?function(n){return om(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class Rh extends op{}class Ou extends op{constructor(e){super(),this.elements=e}}function C2(t,e){const r=$2(e);for(const n of t.elements)r.some(i=>ds(i,n))||r.push(n);return{arrayValue:{values:r}}}class Bu extends op{constructor(e){super(),this.elements=e}}function I2(t,e){let r=$2(e);for(const n of t.elements)r=r.filter(i=>!ds(i,n));return{arrayValue:{values:r}}}class Dh extends op{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Av(t){return En(t.integerValue||t.doubleValue)}function $2(t){return cy(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function n3(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Ou&&i instanceof Ou||n instanceof Bu&&i instanceof Bu?Pc(n.elements,i.elements,ds):n instanceof Dh&&i instanceof Dh?ds(n.Ae,i.Ae):n instanceof Rh&&i instanceof Rh}(t.transform,e.transform)}class i3{constructor(e,r){this.version=e,this.transformResults=r}}class os{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new os}static exists(e){return new os(void 0,e)}static updateTime(e){return new os(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class sp{}function E2(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new k2(t.key,os.none()):new Xu(t.key,t.data,os.none());{const r=t.data,n=Yi.empty();let i=new Kn(ui.comparator);for(let o of e.fields)if(!i.has(o)){let s=r.field(o);s===null&&o.length>1&&(o=o.popLast(),s=r.field(o)),s===null?n.delete(o):n.set(o,s),i=i.add(o)}return new za(t.key,n,new so(i.toArray()),os.none())}}function o3(t,e,r){t instanceof Xu?function(i,o,s){const l=i.value.clone(),c=Iv(i.fieldTransforms,o,s.transformResults);l.setAll(c),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(t,e,r):t instanceof za?function(i,o,s){if(!sh(i.precondition,o))return void o.convertToUnknownDocument(s.version);const l=Iv(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(T2(i)),c.setAll(l),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(t,e,r):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,r)}function bu(t,e,r,n){return t instanceof Xu?function(o,s,l,c){if(!sh(o.precondition,s))return l;const u=o.value.clone(),h=$v(o.fieldTransforms,c,s);return u.setAll(h),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof za?function(o,s,l,c){if(!sh(o.precondition,s))return l;const u=$v(o.fieldTransforms,c,s),h=s.data;return h.setAll(T2(o)),h.setAll(u),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(m=>m.field))}(t,e,r,n):function(o,s,l){return sh(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):l}(t,e,r)}function s3(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=A2(n.transform,i||null);o!=null&&(r===null&&(r=Yi.empty()),r.set(n.field,o))}return r||null}function Cv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Pc(n,i,(o,s)=>n3(o,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Xu extends sp{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class za extends sp{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function T2(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function Iv(t,e,r){const n=new Map;Zr(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const o=t[i],s=o.transform,l=e.data.field(o.field);n.set(o.field,r3(s,l,r[i]))}return n}function $v(t,e,r){const n=new Map;for(const i of t){const o=i.transform,s=r.data.field(i.field);n.set(i.field,t3(o,s,e))}return n}class k2 extends sp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class a3 extends sp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&o3(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=bu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=bu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=w2();return this.mutations.forEach(i=>{const o=e.get(i.key),s=o.overlayedDocument;let l=this.applyToLocalView(s,o.mutatedFields);l=r.has(i.key)?null:l;const c=E2(s,l);c!==null&&n.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(_r.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Br())}isEqual(e){return this.batchId===e.batchId&&Pc(this.mutations,e.mutations,(r,n)=>Cv(r,n))&&Pc(this.baseMutations,e.baseMutations,(r,n)=>Cv(r,n))}}class fy{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Zr(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return JC}();const o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,n[s].version);return new fy(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c3{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bn,jr;function d3(t){switch(t){case dt.OK:return hr(64938);case dt.CANCELLED:case dt.UNKNOWN:case dt.DEADLINE_EXCEEDED:case dt.RESOURCE_EXHAUSTED:case dt.INTERNAL:case dt.UNAVAILABLE:case dt.UNAUTHENTICATED:return!1;case dt.INVALID_ARGUMENT:case dt.NOT_FOUND:case dt.ALREADY_EXISTS:case dt.PERMISSION_DENIED:case dt.FAILED_PRECONDITION:case dt.ABORTED:case dt.OUT_OF_RANGE:case dt.UNIMPLEMENTED:case dt.DATA_LOSS:return!0;default:return hr(15467,{code:t})}}function N2(t){if(t===void 0)return Bs("GRPC error has no .code"),dt.UNKNOWN;switch(t){case Bn.OK:return dt.OK;case Bn.CANCELLED:return dt.CANCELLED;case Bn.UNKNOWN:return dt.UNKNOWN;case Bn.DEADLINE_EXCEEDED:return dt.DEADLINE_EXCEEDED;case Bn.RESOURCE_EXHAUSTED:return dt.RESOURCE_EXHAUSTED;case Bn.INTERNAL:return dt.INTERNAL;case Bn.UNAVAILABLE:return dt.UNAVAILABLE;case Bn.UNAUTHENTICATED:return dt.UNAUTHENTICATED;case Bn.INVALID_ARGUMENT:return dt.INVALID_ARGUMENT;case Bn.NOT_FOUND:return dt.NOT_FOUND;case Bn.ALREADY_EXISTS:return dt.ALREADY_EXISTS;case Bn.PERMISSION_DENIED:return dt.PERMISSION_DENIED;case Bn.FAILED_PRECONDITION:return dt.FAILED_PRECONDITION;case Bn.ABORTED:return dt.ABORTED;case Bn.OUT_OF_RANGE:return dt.OUT_OF_RANGE;case Bn.UNIMPLEMENTED:return dt.UNIMPLEMENTED;case Bn.DATA_LOSS:return dt.DATA_LOSS;default:return hr(39323,{code:t})}}(jr=Bn||(Bn={}))[jr.OK=0]="OK",jr[jr.CANCELLED=1]="CANCELLED",jr[jr.UNKNOWN=2]="UNKNOWN",jr[jr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",jr[jr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",jr[jr.NOT_FOUND=5]="NOT_FOUND",jr[jr.ALREADY_EXISTS=6]="ALREADY_EXISTS",jr[jr.PERMISSION_DENIED=7]="PERMISSION_DENIED",jr[jr.UNAUTHENTICATED=16]="UNAUTHENTICATED",jr[jr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",jr[jr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",jr[jr.ABORTED=10]="ABORTED",jr[jr.OUT_OF_RANGE=11]="OUT_OF_RANGE",jr[jr.UNIMPLEMENTED=12]="UNIMPLEMENTED",jr[jr.INTERNAL=13]="INTERNAL",jr[jr.UNAVAILABLE=14]="UNAVAILABLE",jr[jr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h3(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p3=new Ea([4294967295,4294967295],0);function Ev(t){const e=h3().encode(t),r=new G1;return r.update(e),new Uint8Array(r.digest())}function Tv(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ea([r,n],0),new Ea([i,o],0)]}class my{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new cu(`Invalid padding: ${r}`);if(n<0)throw new cu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new cu(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new cu(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Ea.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Ea.fromNumber(n)));return i.compare(p3)===1&&(i=new Ea([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Ev(e),[n,i]=Tv(r);for(let o=0;o<this.hashCount;o++){const s=this.ye(n,i,o);if(!this.we(s))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new my(o,i,r);return n.forEach(l=>s.insert(l)),s}insert(e){if(this.ge===0)return;const r=Ev(e),[n,i]=Tv(r);for(let o=0;o<this.hashCount;o++){const s=this.ye(n,i,o);this.Se(s)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class cu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Zu.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new ap(_r.min(),i,new Sn(Or),Vs(),Br())}}class Zu{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Zu(n,r,Br(),Br(),Br())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class L2{constructor(e,r){this.targetId=e,this.Ce=r}}class R2{constructor(e,r,n=hi.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class kv{constructor(){this.ve=0,this.Fe=Nv(),this.Me=hi.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Br(),r=Br(),n=Br();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:hr(38017,{changeType:o})}}),new Zu(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=Nv()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Zr(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class f3{constructor(e){this.Ge=e,this.ze=new Map,this.je=Vs(),this.Je=Ld(),this.He=Ld(),this.Ye=new Sn(Or)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:hr(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const o=i.target;if(am(o))if(n===0){const s=new rr(o.path);this.et(r,s,Ci.newNoDocument(s,_r.min()))}else Zr(n===1,20013,{expectedCount:n});else{const s=this._t(r);if(s!==n){const l=this.ut(e),c=l?this.ct(l,e,s):1;if(c!==0){this.it(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,u)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let s,l;try{s=Ra(n).toUint8Array()}catch(c){if(c instanceof i2)return Sc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new my(s,i,o)}catch(c){return Sc(c instanceof cu?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.ge===0?null:l}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const s=this.Ge.ht(),l=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(l)||(this.et(r,o,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((o,s)=>{const l=this.ot(s);if(l){if(o.current&&am(l.target)){const c=new rr(l.target.path);this.It(c).has(s)||this.Et(s,c)||this.et(s,c,Ci.newNoDocument(c,e))}o.Be&&(r.set(s,o.ke()),o.qe())}});let n=Br();this.He.forEach((o,s)=>{let l=!0;s.forEachWhile(c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));const i=new ap(e,r,this.Ye,this.je,n);return this.je=Vs(),this.Je=Ld(),this.He=Ld(),this.Ye=new Sn(Or),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new kv,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Kn(Or),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Kn(Or),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Gt("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new kv),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Ld(){return new Sn(rr.comparator)}function Nv(){return new Sn(rr.comparator)}const m3={asc:"ASCENDING",desc:"DESCENDING"},y3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},g3={and:"AND",or:"OR"};class v3{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function um(t,e){return t.useProto3Json||tp(e)?e:{value:e}}function Mh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function D2(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function b3(t,e){return Mh(t,e.toTimestamp())}function ss(t){return Zr(!!t,49232),_r.fromTimestamp(function(r){const n=La(r);return new fn(n.seconds,n.nanos)}(t))}function yy(t,e){return dm(t,e).canonicalString()}function dm(t,e){const r=function(i){return new pn(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function M2(t){const e=pn.fromString(t);return Zr(V2(e),10190,{key:e.toString()}),e}function hm(t,e){return yy(t.databaseId,e.path)}function Kp(t,e){const r=M2(e);if(r.get(1)!==t.databaseId.projectId)throw new qt(dt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new qt(dt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new rr(O2(r))}function F2(t,e){return yy(t.databaseId,e)}function _3(t){const e=M2(t);return e.length===4?pn.emptyPath():O2(e)}function pm(t){return new pn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function O2(t){return Zr(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Lv(t,e,r){return{name:hm(t,e),fields:r.value.mapValue.fields}}function S3(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:hr(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(u,h){return u.useProto3Json?(Zr(h===void 0||typeof h=="string",58123),hi.fromBase64String(h||"")):(Zr(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),hi.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,l=s&&function(u){const h=u.code===void 0?dt.UNKNOWN:N2(u.code);return new qt(h,u.message||"")}(s);r=new R2(n,i,o,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Kp(t,n.document.name),o=ss(n.document.updateTime),s=n.document.createTime?ss(n.document.createTime):_r.min(),l=new Yi({mapValue:{fields:n.document.fields}}),c=Ci.newFoundDocument(i,o,s,l),u=n.targetIds||[],h=n.removedTargetIds||[];r=new ah(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Kp(t,n.document),o=n.readTime?ss(n.readTime):_r.min(),s=Ci.newNoDocument(i,o),l=n.removedTargetIds||[];r=new ah([],l,s.key,s)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Kp(t,n.document),o=n.removedTargetIds||[];r=new ah([],o,i,null)}else{if(!("filter"in e))return hr(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,s=new u3(i,o),l=n.targetId;r=new L2(l,s)}}return r}function P3(t,e){let r;if(e instanceof Xu)r={update:Lv(t,e.key,e.value)};else if(e instanceof k2)r={delete:hm(t,e.key)};else if(e instanceof za)r={update:Lv(t,e.key,e.data),updateMask:k3(e.fieldMask)};else{if(!(e instanceof a3))return hr(16599,{Vt:e.type});r={verify:hm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,s){const l=s.transform;if(l instanceof Rh)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Ou)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Bu)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Dh)return{fieldPath:s.field.canonicalString(),increment:l.Ae};throw hr(20930,{transform:s.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:b3(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:hr(27497)}(t,e.precondition)),r}function w3(t,e){return t&&t.length>0?(Zr(e!==void 0,14353),t.map(r=>function(i,o){let s=i.updateTime?ss(i.updateTime):ss(o);return s.isEqual(_r.min())&&(s=ss(o)),new i3(s,i.transformResults||[])}(r,e))):[]}function x3(t,e){return{documents:[F2(t,e.path)]}}function A3(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=F2(t,i);const o=function(u){if(u.length!==0)return j2(Oo.create(u,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const s=function(u){if(u.length!==0)return u.map(h=>function(g){return{field:lc(g.field),direction:$3(g.dir)}}(h))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const l=um(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:r,parent:i}}function C3(t){let e=_3(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Zr(n===1,65062);const h=r.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];r.where&&(o=function(m){const g=B2(m);return g instanceof Oo&&f2(g)?g.getFilters():[g]}(r.where));let s=[];r.orderBy&&(s=function(m){return m.map(g=>function(w){return new Fu(cc(w.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(g))}(r.orderBy));let l=null;r.limit&&(l=function(m){let g;return g=typeof m=="object"?m.value:m,tp(g)?null:g}(r.limit));let c=null;r.startAt&&(c=function(m){const g=!!m.before,f=m.values||[];return new Lh(f,g)}(r.startAt));let u=null;return r.endAt&&(u=function(m){const g=!m.before,f=m.values||[];return new Lh(f,g)}(r.endAt)),HC(e,i,s,o,l,"F",c,u)}function I3(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return hr(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function B2(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=cc(r.unaryFilter.field);return jn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=cc(r.unaryFilter.field);return jn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=cc(r.unaryFilter.field);return jn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=cc(r.unaryFilter.field);return jn.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return hr(61313);default:return hr(60726)}}(t):t.fieldFilter!==void 0?function(r){return jn.create(cc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return hr(58110);default:return hr(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Oo.create(r.compositeFilter.filters.map(n=>B2(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return hr(1026)}}(r.compositeFilter.op))}(t):hr(30097,{filter:t})}function $3(t){return m3[t]}function E3(t){return y3[t]}function T3(t){return g3[t]}function lc(t){return{fieldPath:t.canonicalString()}}function cc(t){return ui.fromServerFormat(t.fieldPath)}function j2(t){return t instanceof jn?function(r){if(r.op==="=="){if(_v(r.value))return{unaryFilter:{field:lc(r.field),op:"IS_NAN"}};if(bv(r.value))return{unaryFilter:{field:lc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(_v(r.value))return{unaryFilter:{field:lc(r.field),op:"IS_NOT_NAN"}};if(bv(r.value))return{unaryFilter:{field:lc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lc(r.field),op:E3(r.op),value:r.value}}}(t):t instanceof Oo?function(r){const n=r.getFilters().map(i=>j2(i));return n.length===1?n[0]:{compositeFilter:{op:T3(r.op),filters:n}}}(t):hr(54877,{filter:t})}function k3(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function V2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e,r,n,i,o=_r.min(),s=_r.min(),l=hi.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Pa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Pa(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Pa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Pa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3{constructor(e){this.yt=e}}function L3(t){const e=C3({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?cm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3{constructor(){this.Cn=new D3}addToCollectionParentIndex(e,r){return this.Cn.add(r),vt.resolve()}getCollectionParents(e,r){return vt.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return vt.resolve()}deleteFieldIndex(e,r){return vt.resolve()}deleteAllFieldIndexes(e){return vt.resolve()}createTargetIndexes(e,r){return vt.resolve()}getDocumentsMatchingTarget(e,r){return vt.resolve(null)}getIndexType(e,r){return vt.resolve(0)}getFieldIndexes(e,r){return vt.resolve([])}getNextCollectionGroupToUpdate(e){return vt.resolve(null)}getMinOffset(e,r){return vt.resolve(Na.min())}getMinOffsetFromCollectionGroup(e,r){return vt.resolve(Na.min())}updateCollectionGroup(e,r,n){return vt.resolve()}updateIndexEntries(e,r){return vt.resolve()}}class D3{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Kn(pn.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Kn(pn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},q2=41943040;class Wi{static withCacheSize(e){return new Wi(e,Wi.DEFAULT_COLLECTION_PERCENTILE,Wi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Wi.DEFAULT_COLLECTION_PERCENTILE=10,Wi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Wi.DEFAULT=new Wi(q2,Wi.DEFAULT_COLLECTION_PERCENTILE,Wi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Wi.DISABLED=new Wi(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ac(0)}static cr(){return new Ac(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dv="LruGarbageCollector",M3=1048576;function Mv([t,e],[r,n]){const i=Or(t,r);return i===0?Or(e,n):i}class F3{constructor(e){this.Ir=e,this.buffer=new Kn(Mv),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Mv(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class O3{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Gt(Dv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Nc(r)?Gt(Dv,"Ignoring IndexedDB error during garbage collection: ",r):await kc(r)}await this.Vr(3e5)})}}class B3{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return vt.resolve(ep.ce);const n=new F3(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Gt("LruGarbageCollector","Garbage collection skipped; disabled"),vt.resolve(Rv)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Gt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Rv):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,o,s,l,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(Gt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,s=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(n=m,l=Date.now(),this.removeTargets(e,n,r))).next(m=>(o=m,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(m=>(u=Date.now(),sc()<=Fr.DEBUG&&Gt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(l-s)+`ms
	Removed ${o} targets in `+(c-l)+`ms
	Removed ${m} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),vt.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:m})))}}function j3(t,e){return new B3(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V3{constructor(){this.changes=new Ll(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Ci.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?vt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&bu(n.mutation,i,so.empty(),fn.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Br()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Br()){const i=yl();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let s=lu();return o.forEach((l,c)=>{s=s.insert(l,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,r){const n=yl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Br()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,l)=>{r.set(s,l)})})}computeViews(e,r,n,i){let o=Vs();const s=vu(),l=function(){return vu()}();return r.forEach((c,u)=>{const h=n.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof za)?o=o.insert(u.key,u):h!==void 0?(s.set(u.key,h.mutation.getFieldMask()),bu(h.mutation,u,h.mutation.getFieldMask(),fn.now())):s.set(u.key,so.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((u,h)=>s.set(u,h)),r.forEach((u,h)=>l.set(u,new q3(h,s.get(u)??null))),l))}recalculateAndSaveOverlays(e,r){const n=vu();let i=new Sn((s,l)=>s-l),o=Br();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(s=>{for(const l of s)l.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let h=n.get(c)||so.empty();h=l.applyToLocalView(u,h),n.set(c,h);const m=(i.get(l.batchId)||Br()).add(c);i=i.insert(l.batchId,m)})}).next(()=>{const s=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,h=c.value,m=w2();h.forEach(g=>{if(!o.has(g)){const f=E2(r.get(g),n.get(g));f!==null&&m.set(g,f),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,u,m))}return vt.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(s){return rr.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):v2(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):vt.resolve(yl());let l=Lu,c=o;return s.next(u=>vt.forEach(u,(h,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),o.get(h)?vt.resolve():this.remoteDocumentCache.getEntry(e,h).next(g=>{c=c.insert(h,g)}))).next(()=>this.populateOverlays(e,u,o)).next(()=>this.computeViews(e,c,u,Br())).next(h=>({batchId:l,changes:P2(h)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new rr(r)).next(n=>{let i=lu();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let s=lu();return this.indexManager.getCollectionParents(e,o).next(l=>vt.forEach(l,c=>{const u=function(m,g){return new Lc(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(r,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(h=>{h.forEach((m,g)=>{s=s.insert(m,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(s=>{o.forEach((c,u)=>{const h=u.getKey();s.get(h)===null&&(s=s.insert(h,Ci.newInvalidDocument(h)))});let l=lu();return s.forEach((c,u)=>{const h=o.get(c);h!==void 0&&bu(h.mutation,u,so.empty(),fn.now()),ip(r,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return vt.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ss(i.createTime)}}(r)),vt.resolve()}getNamedQuery(e,r){return vt.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:L3(i.bundledQuery),readTime:ss(i.readTime)}}(r)),vt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H3{constructor(){this.overlays=new Sn(rr.comparator),this.qr=new Map}getOverlay(e,r){return vt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=yl();return vt.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.St(e,r,o)}),vt.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(n)),vt.resolve()}getOverlaysForCollection(e,r,n){const i=yl(),o=r.length+1,s=new rr(r.child("")),l=this.overlays.getIteratorFrom(s);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===o&&c.largestBatchId>n&&i.set(c.getKey(),c)}return vt.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new Sn((u,h)=>u-h);const s=this.overlays.getIterator();for(;s.hasNext();){const u=s.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let h=o.get(u.largestBatchId);h===null&&(h=yl(),o=o.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const l=yl(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,h)=>l.set(u,h)),!(l.size()>=i)););return vt.resolve(l)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new c3(r,n));let o=this.qr.get(r);o===void 0&&(o=Br(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G3{constructor(){this.sessionToken=hi.EMPTY_BYTE_STRING}getSessionToken(e){return vt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,vt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{constructor(){this.Qr=new Kn(Zn.$r),this.Ur=new Kn(Zn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new Zn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new Zn(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new rr(new pn([])),n=new Zn(r,e),i=new Zn(r,e+1),o=[];return this.Ur.forEachInRange([n,i],s=>{this.Gr(s),o.push(s.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new rr(new pn([])),n=new Zn(r,e),i=new Zn(r,e+1);let o=Br();return this.Ur.forEachInRange([n,i],s=>{o=o.add(s.key)}),o}containsKey(e){const r=new Zn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Zn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return rr.comparator(e.key,r.key)||Or(e.Yr,r.Yr)}static Kr(e,r){return Or(e.Yr,r.Yr)||rr.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Kn(Zn.$r)}checkEmpty(e){return vt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new l3(o,r,n,i);this.mutationQueue.push(s);for(const l of i)this.Zr=this.Zr.add(new Zn(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return vt.resolve(s)}lookupMutationBatch(e,r){return vt.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),o=i<0?0:i;return vt.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return vt.resolve(this.mutationQueue.length===0?ay:this.tr-1)}getAllMutationBatches(e){return vt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Zn(r,0),i=new Zn(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],s=>{const l=this.Xr(s.Yr);o.push(l)}),vt.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Kn(Or);return r.forEach(i=>{const o=new Zn(i,0),s=new Zn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,s],l=>{n=n.add(l.Yr)})}),vt.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;rr.isDocumentKey(o)||(o=o.child(""));const s=new Zn(new rr(o),0);let l=new Kn(Or);return this.Zr.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(l=l.add(c.Yr)),!0)},s),vt.resolve(this.ti(l))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Zr(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return vt.forEach(r.mutations,i=>{const o=new Zn(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new Zn(r,0),i=this.Zr.firstAfterOrEqual(n);return vt.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,vt.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y3{constructor(e){this.ri=e,this.docs=function(){return new Sn(rr.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,s=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return vt.resolve(n?n.document.mutableCopy():Ci.newInvalidDocument(r))}getEntries(e,r){let n=Vs();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():Ci.newInvalidDocument(i))}),vt.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=Vs();const s=r.path,l=new rr(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!s.isPrefixOf(u.path))break;u.path.length>s.length+1||wC(PC(h),n)<=0||(i.has(h.key)||ip(r,h))&&(o=o.insert(h.key,h.mutableCopy()))}return vt.resolve(o)}getAllFromCollectionGroup(e,r,n,i){hr(9500)}ii(e,r){return vt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new K3(this)}getSize(e){return vt.resolve(this.size)}}class K3 extends V3{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),vt.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J3{constructor(e){this.persistence=e,this.si=new Ll(r=>uy(r),dy),this.lastRemoteSnapshotVersion=_r.min(),this.highestTargetId=0,this.oi=0,this._i=new gy,this.targetCount=0,this.ai=Ac.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),vt.resolve()}getLastRemoteSnapshotVersion(e){return vt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return vt.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),vt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),vt.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Ac(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,vt.resolve()}updateTargetData(e,r){return this.Pr(r),vt.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,vt.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.si.forEach((s,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.si.delete(s),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),vt.waitFor(o).next(()=>i)}getTargetCount(e){return vt.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return vt.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),vt.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),vt.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),vt.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return vt.resolve(n)}containsKey(e,r){return vt.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e,r){this.ui={},this.overlays={},this.ci=new ep(0),this.li=!1,this.li=!0,this.hi=new G3,this.referenceDelegate=e(this),this.Pi=new J3(this),this.indexManager=new R3,this.remoteDocumentCache=function(i){return new Y3(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new N3(r),this.Ii=new U3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new H3,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new W3(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Gt("MemoryPersistence","Starting transaction:",e);const i=new Q3(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,r){return vt.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class Q3 extends AC{constructor(e){super(),this.currentSequenceNumber=e}}class vy{constructor(e){this.persistence=e,this.Ri=new gy,this.Vi=null}static mi(e){return new vy(e)}get fi(){if(this.Vi)return this.Vi;throw hr(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),vt.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),vt.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),vt.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return vt.forEach(this.fi,n=>{const i=rr.fromPath(n);return this.gi(e,i).next(o=>{o||r.removeEntry(i,_r.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return vt.or([()=>vt.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Fh{constructor(e,r){this.persistence=e,this.pi=new Ll(n=>$C(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=j3(this,r)}static mi(e,r){return new Fh(e,r)}Ei(){}di(e){return vt.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return vt.forEach(this.pi,(n,i)=>this.br(e,n,i).next(o=>o?vt.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,s=>this.br(e,s,r).next(l=>{l||(n++,o.removeEntry(s,_r.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),vt.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),vt.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),vt.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),vt.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=ih(e.data.value)),r}br(e,r,n){return vt.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return vt.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class by{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=Br(),i=Br();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new by(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z3{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return zP()?8:CC(ki())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ys(e,r).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ws(e,r,i,n).next(s=>{o.result=s})}).next(()=>{if(o.result)return;const s=new X3;return this.Ss(e,r,s).next(l=>{if(o.result=l,this.Vs)return this.bs(e,r,s,l.size)})}).next(()=>o.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(sc()<=Fr.DEBUG&&Gt("QueryEngine","SDK will not create cache indexes for query:",ac(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),vt.resolve()):(sc()<=Fr.DEBUG&&Gt("QueryEngine","Query:",ac(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(sc()<=Fr.DEBUG&&Gt("QueryEngine","The SDK decides to create cache indexes for query:",ac(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,is(r))):vt.resolve())}ys(e,r){if(xv(r))return vt.resolve(null);let n=is(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=cm(r,null,"F"),n=is(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const s=Br(...o);return this.ps.getDocuments(e,s).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.Ds(r,l);return this.Cs(r,u,s,c.readTime)?this.ys(e,cm(r,null,"F")):this.vs(e,u,r,c)}))})))}ws(e,r,n,i){return xv(r)||i.isEqual(_r.min())?vt.resolve(null):this.ps.getDocuments(e,n).next(o=>{const s=this.Ds(r,o);return this.Cs(r,s,n,i)?vt.resolve(null):(sc()<=Fr.DEBUG&&Gt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ac(r)),this.vs(e,s,r,SC(i,Lu)).next(l=>l))})}Ds(e,r){let n=new Kn(_2(e));return r.forEach((i,o)=>{ip(e,o)&&(n=n.add(o))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,r,n){return sc()<=Fr.DEBUG&&Gt("QueryEngine","Using full collection scan to execute query:",ac(r)),this.ps.getDocumentsMatchingQuery(e,r,Na.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(s=>{o=o.insert(s.key,s)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _y="LocalStore",e4=3e8;class t4{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new Sn(Or),this.xs=new Ll(o=>uy(o),dy),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new z3(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function r4(t,e,r,n){return new t4(t,e,r,n)}async function U2(t,e){const r=xr(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const s=[],l=[];let c=Br();for(const u of i){s.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of o){l.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return r.localDocuments.getDocuments(n,c).next(u=>({Ls:u,removedBatchIds:s,addedBatchIds:l}))})})}function n4(t,e){const r=xr(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return function(l,c,u,h){const m=u.batch,g=m.keys();let f=vt.resolve();return g.forEach(w=>{f=f.next(()=>h.getEntry(c,w)).next(x=>{const S=u.docVersions.get(w);Zr(S!==null,48541),x.version.compareTo(S)<0&&(m.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),h.addEntry(x)))})}),f.next(()=>l.mutationQueue.removeMutationBatch(c,m))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=Br();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function H2(t){const e=xr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function i4(t,e){const r=xr(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const l=[];e.targetChanges.forEach((h,m)=>{const g=i.get(m);if(!g)return;l.push(r.Pi.removeMatchingKeys(o,h.removedDocuments,m).next(()=>r.Pi.addMatchingKeys(o,h.addedDocuments,m)));let f=g.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(m)!==null?f=f.withResumeToken(hi.EMPTY_BYTE_STRING,_r.min()).withLastLimboFreeSnapshotVersion(_r.min()):h.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(h.resumeToken,n)),i=i.insert(m,f),function(x,S,C){return x.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=e4?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(g,f,h)&&l.push(r.Pi.updateTargetData(o,f))});let c=Vs(),u=Br();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(o,h))}),l.push(o4(o,s,e.documentUpdates).next(h=>{c=h.ks,u=h.qs})),!n.isEqual(_r.min())){const h=r.Pi.getLastRemoteSnapshotVersion(o).next(m=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n));l.push(h)}return vt.waitFor(l).next(()=>s.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,c,u)).next(()=>c)}).then(o=>(r.Ms=i,o))}function o4(t,e,r){let n=Br(),i=Br();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let s=Vs();return r.forEach((l,c)=>{const u=o.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(_r.min())?(e.removeEntry(l,c.readTime),s=s.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),s=s.insert(l,c)):Gt(_y,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{ks:s,qs:i}})}function s4(t,e){const r=xr(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=ay),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function a4(t,e){const r=xr(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(o=>o?(i=o,vt.resolve(i)):r.Pi.allocateTargetId(n).next(s=>(i=new Pa(e,s,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function fm(t,e,r){const n=xr(t),i=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,s=>n.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!Nc(s))throw s;Gt(_y,`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Fv(t,e,r){const n=xr(t);let i=_r.min(),o=Br();return n.persistence.runTransaction("Execute query","readwrite",s=>function(c,u,h){const m=xr(c),g=m.xs.get(h);return g!==void 0?vt.resolve(m.Ms.get(g)):m.Pi.getTargetData(u,h)}(n,s,is(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(s,l.targetId).next(c=>{o=c})}).next(()=>n.Fs.getDocumentsMatchingQuery(s,e,r?i:_r.min(),r?o:Br())).next(l=>(l4(n,WC(e),l),{documents:l,Qs:o})))}function l4(t,e,r){let n=t.Os.get(e)||_r.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Os.set(e,n)}class Ov{constructor(){this.activeTargetIds=ZC()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class c4{constructor(){this.Mo=new Ov,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ov,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bv="ConnectivityMonitor";class jv{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Gt(Bv,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Gt(Bv,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rd=null;function mm(){return Rd===null?Rd=function(){return 268435456+Math.round(2147483648*Math.random())}():Rd++,"0x"+Rd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jp="RestConnection",d4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class h4{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===kh?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,o){const s=mm(),l=this.zo(e,r.toUriEncodedString());Gt(Jp,`Sending RPC '${e}' ${s}:`,l,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,o);const{host:u}=new URL(l),h=Ic(u);return this.Jo(e,l,c,n,h).then(m=>(Gt(Jp,`Received RPC '${e}' ${s}: `,m),m),m=>{throw Sc(Jp,`RPC '${e}' ${s} failed with error: `,m,"url: ",l,"request:",n),m})}Ho(e,r,n,i,o,s){return this.Go(e,r,n,i,o)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Tc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}zo(e,r){const n=d4[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi="WebChannelConnection";class f4 extends h4{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,o){const s=mm();return new Promise((l,c)=>{const u=new W1;u.setWithCredentials(!0),u.listenOnce(Y1.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case nh.NO_ERROR:const m=u.getResponseJson();Gt(vi,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(m)),l(m);break;case nh.TIMEOUT:Gt(vi,`RPC '${e}' ${s} timed out`),c(new qt(dt.DEADLINE_EXCEEDED,"Request time out"));break;case nh.HTTP_ERROR:const g=u.getStatus();if(Gt(vi,`RPC '${e}' ${s} failed with status:`,g,"response text:",u.getResponseText()),g>0){let f=u.getResponseJson();Array.isArray(f)&&(f=f[0]);const w=f?.error;if(w&&w.status&&w.message){const x=function(C){const j=C.toLowerCase().replace(/_/g,"-");return Object.values(dt).indexOf(j)>=0?j:dt.UNKNOWN}(w.status);c(new qt(x,w.message))}else c(new qt(dt.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new qt(dt.UNAVAILABLE,"Connection failed."));break;default:hr(9055,{l_:e,streamId:s,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Gt(vi,`RPC '${e}' ${s} completed.`)}});const h=JSON.stringify(i);Gt(vi,`RPC '${e}' ${s} sending request:`,i),u.send(r,"POST",h,n,15)})}T_(e,r,n){const i=mm(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Q1(),l=J1(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const h=o.join("");Gt(vi,`Creating RPC '${e}' stream ${i}: ${h}`,c);const m=s.createWebChannel(h,c);this.I_(m);let g=!1,f=!1;const w=new p4({Yo:S=>{f?Gt(vi,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(g||(Gt(vi,`Opening RPC '${e}' stream ${i} transport.`),m.open(),g=!0),Gt(vi,`RPC '${e}' stream ${i} sending:`,S),m.send(S))},Zo:()=>m.close()}),x=(S,C,j)=>{S.listen(C,oe=>{try{j(oe)}catch(te){setTimeout(()=>{throw te},0)}})};return x(m,au.EventType.OPEN,()=>{f||(Gt(vi,`RPC '${e}' stream ${i} transport opened.`),w.o_())}),x(m,au.EventType.CLOSE,()=>{f||(f=!0,Gt(vi,`RPC '${e}' stream ${i} transport closed`),w.a_(),this.E_(m))}),x(m,au.EventType.ERROR,S=>{f||(f=!0,Sc(vi,`RPC '${e}' stream ${i} transport errored. Name:`,S.name,"Message:",S.message),w.a_(new qt(dt.UNAVAILABLE,"The operation could not be completed")))}),x(m,au.EventType.MESSAGE,S=>{if(!f){const C=S.data[0];Zr(!!C,16349);const j=C,oe=j?.error||j[0]?.error;if(oe){Gt(vi,`RPC '${e}' stream ${i} received error:`,oe);const te=oe.status;let Z=function($){const T=Bn[$];if(T!==void 0)return N2(T)}(te),re=oe.message;Z===void 0&&(Z=dt.INTERNAL,re="Unknown error status: "+te+" with message "+oe.message),f=!0,w.a_(new qt(Z,re)),m.close()}else Gt(vi,`RPC '${e}' stream ${i} received:`,C),w.u_(C)}}),x(l,K1.STAT_EVENT,S=>{S.stat===rm.PROXY?Gt(vi,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===rm.NOPROXY&&Gt(vi,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.__()},0),w}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Qp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(t){return new v3(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&Gt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vv="PersistentStream";class W2{constructor(e,r,n,i,o,s,l,c){this.Mi=e,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new G2(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===dt.RESOURCE_EXHAUSTED?(Bs(r.toString()),Bs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===dt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new qt(dt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Gt(Vv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Gt(Vv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class m4 extends W2{constructor(e,r,n,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,s),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=S3(this.serializer,e),n=function(o){if(!("targetChange"in o))return _r.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?_r.min():s.readTime?ss(s.readTime):_r.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=pm(this.serializer),r.addTarget=function(o,s){let l;const c=s.target;if(l=am(c)?{documents:x3(o,c)}:{query:A3(o,c).ft},l.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){l.resumeToken=D2(o,s.resumeToken);const u=um(o,s.expectedCount);u!==null&&(l.expectedCount=u)}else if(s.snapshotVersion.compareTo(_r.min())>0){l.readTime=Mh(o,s.snapshotVersion.toTimestamp());const u=um(o,s.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const n=I3(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=pm(this.serializer),r.removeTarget=e,this.q_(r)}}class y4 extends W2{constructor(e,r,n,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,s),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Zr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Zr(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Zr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=w3(e.writeResults,e.commitTime),n=ss(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=pm(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>P3(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{}class v4 extends g4{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new qt(dt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Go(e,dm(r,n),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===dt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new qt(dt.UNKNOWN,o.toString())})}Ho(e,r,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,l])=>this.connection.Ho(e,dm(r,n),i,s,l,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===dt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new qt(dt.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class b4{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Bs(r),this.aa=!1):Gt("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tl="RemoteStore";class _4{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(s=>{n.enqueueAndForget(async()=>{Rl(this)&&(Gt(Tl,"Restarting streams for network reachability change."),await async function(c){const u=xr(c);u.Ea.add(4),await ed(u),u.Ra.set("Unknown"),u.Ea.delete(4),await cp(u)}(this))})}),this.Ra=new b4(n,i)}}async function cp(t){if(Rl(t))for(const e of t.da)await e(!0)}async function ed(t){for(const e of t.da)await e(!1)}function Y2(t,e){const r=xr(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),xy(r)?wy(r):Rc(r).O_()&&Py(r,e))}function Sy(t,e){const r=xr(t),n=Rc(r);r.Ia.delete(e),n.O_()&&K2(r,e),r.Ia.size===0&&(n.O_()?n.L_():Rl(r)&&r.Ra.set("Unknown"))}function Py(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(_r.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Rc(t).Y_(e)}function K2(t,e){t.Va.Ue(e),Rc(t).Z_(e)}function wy(t){t.Va=new f3({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Rc(t).start(),t.Ra.ua()}function xy(t){return Rl(t)&&!Rc(t).x_()&&t.Ia.size>0}function Rl(t){return xr(t).Ea.size===0}function J2(t){t.Va=void 0}async function S4(t){t.Ra.set("Online")}async function P4(t){t.Ia.forEach((e,r)=>{Py(t,e)})}async function w4(t,e){J2(t),xy(t)?(t.Ra.ha(e),wy(t)):t.Ra.set("Unknown")}async function x4(t,e,r){if(t.Ra.set("Online"),e instanceof R2&&e.state===2&&e.cause)try{await async function(i,o){const s=o.cause;for(const l of o.targetIds)i.Ia.has(l)&&(await i.remoteSyncer.rejectListen(l,s),i.Ia.delete(l),i.Va.removeTarget(l))}(t,e)}catch(n){Gt(Tl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Oh(t,n)}else if(e instanceof ah?t.Va.Ze(e):e instanceof L2?t.Va.st(e):t.Va.tt(e),!r.isEqual(_r.min()))try{const n=await H2(t.localStore);r.compareTo(n)>=0&&await function(o,s){const l=o.Va.Tt(s);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=o.Ia.get(u);h&&o.Ia.set(u,h.withResumeToken(c.resumeToken,s))}}),l.targetMismatches.forEach((c,u)=>{const h=o.Ia.get(c);if(!h)return;o.Ia.set(c,h.withResumeToken(hi.EMPTY_BYTE_STRING,h.snapshotVersion)),K2(o,c);const m=new Pa(h.target,c,u,h.sequenceNumber);Py(o,m)}),o.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){Gt(Tl,"Failed to raise snapshot:",n),await Oh(t,n)}}async function Oh(t,e,r){if(!Nc(e))throw e;t.Ea.add(1),await ed(t),t.Ra.set("Offline"),r||(r=()=>H2(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Gt(Tl,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await cp(t)})}function Q2(t,e){return e().catch(r=>Oh(t,r,e))}async function up(t){const e=xr(t),r=Ma(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ay;for(;A4(e);)try{const i=await s4(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,C4(e,i)}catch(i){await Oh(e,i)}X2(e)&&Z2(e)}function A4(t){return Rl(t)&&t.Ta.length<10}function C4(t,e){t.Ta.push(e);const r=Ma(t);r.O_()&&r.X_&&r.ea(e.mutations)}function X2(t){return Rl(t)&&!Ma(t).x_()&&t.Ta.length>0}function Z2(t){Ma(t).start()}async function I4(t){Ma(t).ra()}async function $4(t){const e=Ma(t);for(const r of t.Ta)e.ea(r.mutations)}async function E4(t,e,r){const n=t.Ta.shift(),i=fy.from(n,e,r);await Q2(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await up(t)}async function T4(t,e){e&&Ma(t).X_&&await async function(n,i){if(function(s){return d3(s)&&s!==dt.ABORTED}(i.code)){const o=n.Ta.shift();Ma(n).B_(),await Q2(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await up(n)}}(t,e),X2(t)&&Z2(t)}async function qv(t,e){const r=xr(t);r.asyncQueue.verifyOperationInProgress(),Gt(Tl,"RemoteStore received new credentials");const n=Rl(r);r.Ea.add(3),await ed(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await cp(r)}async function k4(t,e){const r=xr(t);e?(r.Ea.delete(2),await cp(r)):e||(r.Ea.add(2),await ed(r),r.Ra.set("Unknown"))}function Rc(t){return t.ma||(t.ma=function(r,n,i){const o=xr(r);return o.sa(),new m4(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:S4.bind(null,t),t_:P4.bind(null,t),r_:w4.bind(null,t),H_:x4.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),xy(t)?wy(t):t.Ra.set("Unknown")):(await t.ma.stop(),J2(t))})),t.ma}function Ma(t){return t.fa||(t.fa=function(r,n,i){const o=xr(r);return o.sa(),new y4(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:I4.bind(null,t),r_:T4.bind(null,t),ta:$4.bind(null,t),na:E4.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await up(t)):(await t.fa.stop(),t.Ta.length>0&&(Gt(Tl,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Ms,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const s=Date.now()+n,l=new Ay(e,r,s,i,o);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new qt(dt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Cy(t,e){if(Bs("AsyncQueue",`${e}: ${t}`),Nc(t))return new qt(dt.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{static emptySet(e){return new yc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||rr.comparator(r.key,n.key):(r,n)=>rr.comparator(r.key,n.key),this.keyedMap=lu(),this.sortedSet=new Sn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof yc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new yc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(){this.ga=new Sn(rr.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):hr(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Cc{constructor(e,r,n,i,o,s,l,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,o){const s=[];return r.forEach(l=>{s.push({type:0,doc:l})}),new Cc(e,r,yc.emptySet(r),s,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&np(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class L4{constructor(){this.queries=Uv(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=xr(r),o=i.queries;i.queries=Uv(),o.forEach((s,l)=>{for(const c of l.Sa)c.onError(n)})})(this,new qt(dt.ABORTED,"Firestore shutting down"))}}function Uv(){return new Ll(t=>b2(t),np)}async function e5(t,e){const r=xr(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.ba()&&e.Da()&&(n=2):(o=new N4,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(i,!0);break;case 1:o.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(s){const l=Cy(s,`Initialization of query '${ac(e.query)}' failed`);return void e.onError(l)}r.queries.set(i,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&Iy(r)}async function t5(t,e){const r=xr(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const s=o.Sa.indexOf(e);s>=0&&(o.Sa.splice(s,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function R4(t,e){const r=xr(t);let n=!1;for(const i of e){const o=i.query,s=r.queries.get(o);if(s){for(const l of s.Sa)l.Fa(i)&&(n=!0);s.wa=i}}n&&Iy(r)}function D4(t,e,r){const n=xr(t),i=n.queries.get(e);if(i)for(const o of i.Sa)o.onError(r);n.queries.delete(e)}function Iy(t){t.Ca.forEach(e=>{e.next()})}var ym,Hv;(Hv=ym||(ym={})).Ma="default",Hv.Cache="cache";class r5{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Cc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Cc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ym.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n5{constructor(e){this.key=e}}class i5{constructor(e){this.key=e}}class M4{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Br(),this.mutatedKeys=Br(),this.eu=_2(e),this.tu=new yc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new zv,i=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,s=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,m)=>{const g=i.get(h),f=ip(this.query,m)?m:null,w=!!g&&this.mutatedKeys.has(g.key),x=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let S=!1;g&&f?g.data.isEqual(f.data)?w!==x&&(n.track({type:3,doc:f}),S=!0):this.su(g,f)||(n.track({type:2,doc:f}),S=!0,(c&&this.eu(f,c)>0||u&&this.eu(f,u)<0)&&(l=!0)):!g&&f?(n.track({type:0,doc:f}),S=!0):g&&!f&&(n.track({type:1,doc:g}),S=!0,(c||u)&&(l=!0)),S&&(f?(s=s.add(f),o=x?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),n.track({type:1,doc:h})}return{tu:s,iu:n,Cs:l,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((h,m)=>function(f,w){const x=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return hr(20277,{Rt:S})}};return x(f)-x(w)}(h.type,m.type)||this.eu(h.doc,m.doc)),this.ou(n),i=i??!1;const l=r&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,u=c!==this.Za;return this.Za=c,s.length!==0||u?{snapshot:new Cc(this.query,e.tu,o,s,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new zv,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Br(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new i5(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new n5(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Br();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Cc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const $y="SyncEngine";class F4{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class O4{constructor(e){this.key=e,this.hu=!1}}class B4{constructor(e,r,n,i,o,s){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Ll(l=>b2(l),np),this.Iu=new Map,this.Eu=new Set,this.du=new Sn(rr.comparator),this.Au=new Map,this.Ru=new gy,this.Vu={},this.mu=new Map,this.fu=Ac.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function j4(t,e,r=!0){const n=u5(t);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await o5(n,e,r,!0),i}async function V4(t,e){const r=u5(t);await o5(r,e,!0,!1)}async function o5(t,e,r,n){const i=await a4(t.localStore,is(e)),o=i.targetId,s=t.sharedClientState.addLocalQueryTarget(o,r);let l;return n&&(l=await q4(t,e,o,s==="current",i.resumeToken)),t.isPrimaryClient&&r&&Y2(t.remoteStore,i),l}async function q4(t,e,r,n,i){t.pu=(m,g,f)=>async function(x,S,C,j){let oe=S.view.ru(C);oe.Cs&&(oe=await Fv(x.localStore,S.query,!1).then(({documents:E})=>S.view.ru(E,oe)));const te=j&&j.targetChanges.get(S.targetId),Z=j&&j.targetMismatches.get(S.targetId)!=null,re=S.view.applyChanges(oe,x.isPrimaryClient,te,Z);return Wv(x,S.targetId,re.au),re.snapshot}(t,m,g,f);const o=await Fv(t.localStore,e,!0),s=new M4(e,o.Qs),l=s.ru(o.documents),c=Zu.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=s.applyChanges(l,t.isPrimaryClient,c);Wv(t,r,u.au);const h=new F4(e,r,s);return t.Tu.set(e,h),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),u.snapshot}async function z4(t,e,r){const n=xr(t),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter(s=>!np(s,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await fm(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Sy(n.remoteStore,i.targetId),gm(n,i.targetId)}).catch(kc)):(gm(n,i.targetId),await fm(n.localStore,i.targetId,!0))}async function U4(t,e){const r=xr(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Sy(r.remoteStore,n.targetId))}async function H4(t,e,r){const n=X4(t);try{const i=await function(s,l){const c=xr(s),u=fn.now(),h=l.reduce((f,w)=>f.add(w.key),Br());let m,g;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let w=Vs(),x=Br();return c.Ns.getEntries(f,h).next(S=>{w=S,w.forEach((C,j)=>{j.isValidDocument()||(x=x.add(C))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,w)).next(S=>{m=S;const C=[];for(const j of l){const oe=s3(j,m.get(j.key).overlayedDocument);oe!=null&&C.push(new za(j.key,oe,d2(oe.value.mapValue),os.exists(!0)))}return c.mutationQueue.addMutationBatch(f,u,C,l)}).next(S=>{g=S;const C=S.applyToLocalDocumentSet(m,x);return c.documentOverlayCache.saveOverlays(f,S.batchId,C)})}).then(()=>({batchId:g.batchId,changes:P2(m)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,l,c){let u=s.Vu[s.currentUser.toKey()];u||(u=new Sn(Or)),u=u.insert(l,c),s.Vu[s.currentUser.toKey()]=u}(n,i.batchId,r),await td(n,i.changes),await up(n.remoteStore)}catch(i){const o=Cy(i,"Failed to persist write");r.reject(o)}}async function s5(t,e){const r=xr(t);try{const n=await i4(r.localStore,e);e.targetChanges.forEach((i,o)=>{const s=r.Au.get(o);s&&(Zr(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?Zr(s.hu,14607):i.removedDocuments.size>0&&(Zr(s.hu,42227),s.hu=!1))}),await td(r,n,e)}catch(n){await kc(n)}}function Gv(t,e,r){const n=xr(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((o,s)=>{const l=s.view.va(e);l.snapshot&&i.push(l.snapshot)}),function(s,l){const c=xr(s);c.onlineState=l;let u=!1;c.queries.forEach((h,m)=>{for(const g of m.Sa)g.va(l)&&(u=!0)}),u&&Iy(c)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function G4(t,e,r){const n=xr(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),o=i&&i.key;if(o){let s=new Sn(rr.comparator);s=s.insert(o,Ci.newNoDocument(o,_r.min()));const l=Br().add(o),c=new ap(_r.min(),new Map,new Sn(Or),s,l);await s5(n,c),n.du=n.du.remove(o),n.Au.delete(e),Ey(n)}else await fm(n.localStore,e,!1).then(()=>gm(n,e,r)).catch(kc)}async function W4(t,e){const r=xr(t),n=e.batch.batchId;try{const i=await n4(r.localStore,e);l5(r,n,null),a5(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await td(r,i)}catch(i){await kc(i)}}async function Y4(t,e,r){const n=xr(t);try{const i=await function(s,l){const c=xr(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,l).next(m=>(Zr(m!==null,37113),h=m.keys(),c.mutationQueue.removeMutationBatch(u,m))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(n.localStore,e);l5(n,e,r),a5(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await td(n,i)}catch(i){await kc(i)}}function a5(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function l5(t,e,r){const n=xr(t);let i=n.Vu[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function gm(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||c5(t,n)})}function c5(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Sy(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Ey(t))}function Wv(t,e,r){for(const n of r)n instanceof n5?(t.Ru.addReference(n.key,e),K4(t,n)):n instanceof i5?(Gt($y,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||c5(t,n.key)):hr(19791,{wu:n})}function K4(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Gt($y,"New document in limbo: "+r),t.Eu.add(n),Ey(t))}function Ey(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new rr(pn.fromString(e)),n=t.fu.next();t.Au.set(n,new O4(r)),t.du=t.du.insert(r,n),Y2(t.remoteStore,new Pa(is(hy(r.path)),n,"TargetPurposeLimboResolution",ep.ce))}}async function td(t,e,r){const n=xr(t),i=[],o=[],s=[];n.Tu.isEmpty()||(n.Tu.forEach((l,c)=>{s.push(n.pu(c,e,r).then(u=>{if((u||r)&&n.isPrimaryClient){const h=u?!u.fromCache:r?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){i.push(u);const h=by.As(c.targetId,u);o.push(h)}}))}),await Promise.all(s),n.Pu.H_(i),await async function(c,u){const h=xr(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>vt.forEach(u,g=>vt.forEach(g.Es,f=>h.persistence.referenceDelegate.addReference(m,g.targetId,f)).next(()=>vt.forEach(g.ds,f=>h.persistence.referenceDelegate.removeReference(m,g.targetId,f)))))}catch(m){if(!Nc(m))throw m;Gt(_y,"Failed to update sequence numbers: "+m)}for(const m of u){const g=m.targetId;if(!m.fromCache){const f=h.Ms.get(g),w=f.snapshotVersion,x=f.withLastLimboFreeSnapshotVersion(w);h.Ms=h.Ms.insert(g,x)}}}(n.localStore,o))}async function J4(t,e){const r=xr(t);if(!r.currentUser.isEqual(e)){Gt($y,"User change. New user:",e.toKey());const n=await U2(r.localStore,e);r.currentUser=e,function(o,s){o.mu.forEach(l=>{l.forEach(c=>{c.reject(new qt(dt.CANCELLED,s))})}),o.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await td(r,n.Ls)}}function Q4(t,e){const r=xr(t),n=r.Au.get(e);if(n&&n.hu)return Br().add(n.key);{let i=Br();const o=r.Iu.get(e);if(!o)return i;for(const s of o){const l=r.Tu.get(s);i=i.unionWith(l.view.nu)}return i}}function u5(t){const e=xr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=s5.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Q4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=G4.bind(null,e),e.Pu.H_=R4.bind(null,e.eventManager),e.Pu.yu=D4.bind(null,e.eventManager),e}function X4(t){const e=xr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=W4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Y4.bind(null,e),e}class Bh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=lp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return r4(this.persistence,new Z3,e.initialUser,this.serializer)}Cu(e){return new z2(vy.mi,this.serializer)}Du(e){return new c4}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bh.provider={build:()=>new Bh};class Z4 extends Bh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Zr(this.persistence.referenceDelegate instanceof Fh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new O3(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Wi.withCacheSize(this.cacheSizeBytes):Wi.DEFAULT;return new z2(n=>Fh.mi(n,r),this.serializer)}}class vm{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Gv(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=J4.bind(null,this.syncEngine),await k4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new L4}()}createDatastore(e){const r=lp(e.databaseInfo.databaseId),n=function(o){return new f4(o)}(e.databaseInfo);return function(o,s,l,c){return new v4(o,s,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,s,l){return new _4(n,i,o,s,l)}(this.localStore,this.datastore,e.asyncQueue,r=>Gv(this.syncEngine,r,0),function(){return jv.v()?new jv:new u4}())}createSyncEngine(e,r){return function(i,o,s,l,c,u,h){const m=new B4(i,o,s,l,c,u);return h&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=xr(r);Gt(Tl,"RemoteStore shutting down."),n.Ea.add(5),await ed(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}vm.provider={build:()=>new vm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d5{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Bs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fa="FirestoreClient";class eI{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Ai.UNAUTHENTICATED,this.clientId=sy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async s=>{Gt(Fa,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(Gt(Fa,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ms;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Cy(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Xp(t,e){t.asyncQueue.verifyOperationInProgress(),Gt(Fa,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await U2(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Yv(t,e){t.asyncQueue.verifyOperationInProgress();const r=await tI(t);Gt(Fa,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>qv(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>qv(e.remoteStore,i)),t._onlineComponents=e}async function tI(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Gt(Fa,"Using user provided OfflineComponentProvider");try{await Xp(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===dt.FAILED_PRECONDITION||i.code===dt.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Sc("Error using user provided cache. Falling back to memory cache: "+r),await Xp(t,new Bh)}}else Gt(Fa,"Using default OfflineComponentProvider"),await Xp(t,new Z4(void 0));return t._offlineComponents}async function h5(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Gt(Fa,"Using user provided OnlineComponentProvider"),await Yv(t,t._uninitializedComponentsProvider._online)):(Gt(Fa,"Using default OnlineComponentProvider"),await Yv(t,new vm))),t._onlineComponents}function rI(t){return h5(t).then(e=>e.syncEngine)}async function p5(t){const e=await h5(t),r=e.eventManager;return r.onListen=j4.bind(null,e.syncEngine),r.onUnlisten=z4.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=V4.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=U4.bind(null,e.syncEngine),r}function nI(t,e,r={}){const n=new Ms;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,l,c,u){const h=new d5({next:g=>{h.Nu(),s.enqueueAndForget(()=>t5(o,m));const f=g.docs.has(l);!f&&g.fromCache?u.reject(new qt(dt.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&g.fromCache&&c&&c.source==="server"?u.reject(new qt(dt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new r5(hy(l.path),h,{includeMetadataChanges:!0,qa:!0});return e5(o,m)}(await p5(t),t.asyncQueue,e,r,n)),n.promise}function iI(t,e,r={}){const n=new Ms;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,l,c,u){const h=new d5({next:g=>{h.Nu(),s.enqueueAndForget(()=>t5(o,m)),g.fromCache&&c.source==="server"?u.reject(new qt(dt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),m=new r5(l,h,{includeMetadataChanges:!0,qa:!0});return e5(o,m)}(await p5(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f5(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m5="firestore.googleapis.com",Jv=!0;class Qv{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new qt(dt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=m5,this.ssl=Jv}else this.host=e.host,this.ssl=e.ssl??Jv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=q2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<M3)throw new qt(dt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_C("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=f5(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new qt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new qt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new qt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class dp{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new qt(dt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new qt(dt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new uC;switch(n.type){case"firstParty":return new fC(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new qt(dt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Kv.get(r);n&&(Gt("ComponentProvider","Removing Datastore"),Kv.delete(r),n.terminate())}(this),Promise.resolve()}}function oI(t,e,r,n={}){t=js(t,dp);const i=Ic(e),o=t._getSettings(),s={...o,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${r}`;i&&(i1(`https://${l}`),o1("Firestore",!0)),o.host!==m5&&o.host!==l&&Sc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...o,host:l,ssl:i,emulatorOptions:n};if(!Cl(c,s)&&(t._setSettings(c),n.mockUserToken)){let u,h;if(typeof n.mockUserToken=="string")u=n.mockUserToken,h=Ai.MOCK_USER;else{u=RP(n.mockUserToken,t._app?.options.projectId);const m=n.mockUserToken.sub||n.mockUserToken.user_id;if(!m)throw new qt(dt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Ai(m)}t._authCredentials=new dC(new Z1(u,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Dl(this.firestore,e,this._query)}}class Ln{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ta(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ln(this.firestore,e,this._key)}toJSON(){return{type:Ln._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Qu(r,Ln._jsonSchema))return new Ln(e,n||null,new rr(pn.fromString(r.referencePath)))}}Ln._jsonSchemaVersion="firestore/documentReference/1.0",Ln._jsonSchema={type:Vn("string",Ln._jsonSchemaVersion),referencePath:Vn("string")};class Ta extends Dl{constructor(e,r,n){super(e,r,hy(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ln(this.firestore,null,new rr(e))}withConverter(e){return new Ta(this.firestore,e,this._path)}}function sI(t,e,...r){if(t=di(t),e2("collection","path",e),t instanceof dp){const n=pn.fromString(e,...r);return uv(n),new Ta(t,null,n)}{if(!(t instanceof Ln||t instanceof Ta))throw new qt(dt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pn.fromString(e,...r));return uv(n),new Ta(t.firestore,null,n)}}function y5(t,e,...r){if(t=di(t),arguments.length===1&&(e=sy.newId()),e2("doc","path",e),t instanceof dp){const n=pn.fromString(e,...r);return cv(n),new Ln(t,null,new rr(n))}{if(!(t instanceof Ln||t instanceof Ta))throw new qt(dt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pn.fromString(e,...r));return cv(n),new Ln(t.firestore,t instanceof Ta?t.converter:null,new rr(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xv="AsyncQueue";class Zv{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new G2(this,"async_queue_retry"),this._c=()=>{const n=Qp();n&&Gt(Xv,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Qp();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Qp();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Ms;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Nc(e))throw e;Gt(Xv,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Bs("INTERNAL UNHANDLED ERROR: ",e0(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=Ay.createAndSchedule(this,e,r,n,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&hr(47125,{Pc:e0(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function e0(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class rd extends dp{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new Zv,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Zv(e),this._firestoreClient=void 0,await e}}}function aI(t,e){const r=typeof t=="object"?t:c1(),n=typeof t=="string"?t:kh,i=Ym(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=NP("firestore");o&&oI(i,...o)}return i}function Ty(t){if(t._terminated)throw new qt(dt.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||lI(t),t._firestoreClient}function lI(t){const e=t._freezeSettings(),r=function(i,o,s,l){return new kC(i,o,s,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,f5(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new eI(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new wo(hi.fromBase64String(e))}catch(r){throw new qt(dt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new wo(hi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:wo._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Qu(e,wo._jsonSchema))return wo.fromBase64String(e.bytes)}}wo._jsonSchemaVersion="firestore/bytes/1.0",wo._jsonSchema={type:Vn("string",wo._jsonSchemaVersion),bytes:Vn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new qt(dt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ui(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new qt(dt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new qt(dt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Or(this._lat,e._lat)||Or(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:as._jsonSchemaVersion}}static fromJSON(e){if(Qu(e,as._jsonSchema))return new as(e.latitude,e.longitude)}}as._jsonSchemaVersion="firestore/geoPoint/1.0",as._jsonSchema={type:Vn("string",as._jsonSchemaVersion),latitude:Vn("number"),longitude:Vn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ls._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Qu(e,ls._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new ls(e.vectorValues);throw new qt(dt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ls._jsonSchemaVersion="firestore/vectorValue/1.0",ls._jsonSchema={type:Vn("string",ls._jsonSchemaVersion),vectorValues:Vn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI=/^__.*__$/;class uI{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new za(e,this.data,this.fieldMask,r,this.fieldTransforms):new Xu(e,this.data,r,this.fieldTransforms)}}class g5{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new za(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function v5(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw hr(40011,{Ac:t})}}class Ny{constructor(e,r,n,i,o,s){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ny({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return jh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(v5(this.Ac)&&cI.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class dI{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||lp(e)}Cc(e,r,n,i=!1){return new Ny({Ac:e,methodName:r,Dc:n,path:ui.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ly(t){const e=t._freezeSettings(),r=lp(t._databaseId);return new dI(t._databaseId,!!e.ignoreUndefinedProperties,r)}function hI(t,e,r,n,i,o={}){const s=t.Cc(o.merge||o.mergeFields?2:0,e,r,i);Ry("Data must be an object, but it was:",s,n);const l=b5(n,s);let c,u;if(o.merge)c=new so(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){const h=[];for(const m of o.mergeFields){const g=bm(e,m,r);if(!s.contains(g))throw new qt(dt.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);S5(h,g)||h.push(g)}c=new so(h),u=s.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,u=s.fieldTransforms;return new uI(new Yi(l),c,u)}class pp extends ky{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof pp}}function pI(t,e,r,n){const i=t.Cc(1,e,r);Ry("Data must be an object, but it was:",i,n);const o=[],s=Yi.empty();qa(n,(c,u)=>{const h=Dy(e,c,r);u=di(u);const m=i.yc(h);if(u instanceof pp)o.push(h);else{const g=nd(u,m);g!=null&&(o.push(h),s.set(h,g))}});const l=new so(o);return new g5(s,l,i.fieldTransforms)}function fI(t,e,r,n,i,o){const s=t.Cc(1,e,r),l=[bm(e,n,r)],c=[i];if(o.length%2!=0)throw new qt(dt.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)l.push(bm(e,o[g])),c.push(o[g+1]);const u=[],h=Yi.empty();for(let g=l.length-1;g>=0;--g)if(!S5(u,l[g])){const f=l[g];let w=c[g];w=di(w);const x=s.yc(f);if(w instanceof pp)u.push(f);else{const S=nd(w,x);S!=null&&(u.push(f),h.set(f,S))}}const m=new so(u);return new g5(h,m,s.fieldTransforms)}function mI(t,e,r,n=!1){return nd(r,t.Cc(n?4:3,e))}function nd(t,e){if(_5(t=di(t)))return Ry("Unsupported field value:",e,t),b5(t,e);if(t instanceof ky)return function(n,i){if(!v5(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const o=[];let s=0;for(const l of n){let c=nd(l,i.wc(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=di(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return e3(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=fn.fromDate(n);return{timestampValue:Mh(i.serializer,o)}}if(n instanceof fn){const o=new fn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Mh(i.serializer,o)}}if(n instanceof as)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof wo)return{bytesValue:D2(i.serializer,n._byteString)};if(n instanceof Ln){const o=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(o))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:yy(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof ls)return function(s,l){return{mapValue:{fields:{[c2]:{stringValue:u2},[Nh]:{arrayValue:{values:s.toArray().map(u=>{if(typeof u!="number")throw l.Sc("VectorValues must only contain numeric values.");return py(l.serializer,u)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${Zh(n)}`)}(t,e)}function b5(t,e){const r={};return n2(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qa(t,(n,i)=>{const o=nd(i,e.mc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function _5(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof fn||t instanceof as||t instanceof wo||t instanceof Ln||t instanceof ky||t instanceof ls)}function Ry(t,e,r){if(!_5(r)||!t2(r)){const n=Zh(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function bm(t,e,r){if((e=di(e))instanceof hp)return e._internalPath;if(typeof e=="string")return Dy(t,e);throw jh("Field path arguments must be of type string or ",t,!1,void 0,r)}const yI=new RegExp("[~\\*/\\[\\]]");function Dy(t,e,r){if(e.search(yI)>=0)throw jh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new hp(...e.split("."))._internalPath}catch{throw jh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function jh(t,e,r,n,i){const o=n&&!n.isEmpty(),s=i!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${n}`),s&&(c+=` in document ${i}`),c+=")"),new qt(dt.INVALID_ARGUMENT,l+t+c)}function S5(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P5{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ln(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new gI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(My("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class gI extends P5{data(){return super.data()}}function My(t,e){return typeof e=="string"?Dy(t,e):e instanceof hp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new qt(dt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fy{}class w5 extends Fy{}function bI(t,e,...r){let n=[];e instanceof Fy&&n.push(e),n=n.concat(r),function(o){const s=o.filter(c=>c instanceof By).length,l=o.filter(c=>c instanceof Oy).length;if(s>1||s>0&&l>0)throw new qt(dt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class Oy extends w5{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Oy(e,r,n)}_apply(e){const r=this._parse(e);return x5(e._query,r),new Dl(e.firestore,e.converter,lm(e._query,r))}_parse(e){const r=Ly(e.firestore);return function(o,s,l,c,u,h,m){let g;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new qt(dt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){r0(m,h);const w=[];for(const x of m)w.push(t0(c,o,x));g={arrayValue:{values:w}}}else g=t0(c,o,m)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||r0(m,h),g=mI(l,s,m,h==="in"||h==="not-in");return jn.create(u,h,g)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class By extends Fy{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new By(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Oo.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,o){let s=i;const l=o.getFlattenedFilters();for(const c of l)x5(s,c),s=lm(s,c)}(e._query,r),new Dl(e.firestore,e.converter,lm(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class jy extends w5{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new jy(e,r)}_apply(e){const r=function(i,o,s){if(i.startAt!==null)throw new qt(dt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new qt(dt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Fu(o,s)}(e._query,this._field,this._direction);return new Dl(e.firestore,e.converter,function(i,o){const s=i.explicitOrderBy.concat([o]);return new Lc(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function _I(t,e="asc"){const r=e,n=My("orderBy",t);return jy._create(n,r)}function t0(t,e,r){if(typeof(r=di(r))=="string"){if(r==="")throw new qt(dt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!v2(e)&&r.indexOf("/")!==-1)throw new qt(dt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(pn.fromString(r));if(!rr.isDocumentKey(n))throw new qt(dt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return vv(t,new rr(n))}if(r instanceof Ln)return vv(t,r._key);throw new qt(dt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Zh(r)}.`)}function r0(t,e){if(!Array.isArray(t)||t.length===0)throw new qt(dt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function x5(t,e){const r=function(i,o){for(const s of i)for(const l of s.getFlattenedFilters())if(o.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new qt(dt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new qt(dt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class SI{convertValue(e,r="none"){switch(Da(e)){case 0:return null;case 1:return e.booleanValue;case 2:return En(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Ra(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw hr(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return qa(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){const r=e.fields?.[Nh].arrayValue?.values?.map(n=>En(n.doubleValue));return new ls(r)}convertGeoPoint(e){return new as(En(e.latitude),En(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=rp(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Ru(e));default:return null}}convertTimestamp(e){const r=La(e);return new fn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=pn.fromString(e);Zr(V2(n),9688,{name:e});const i=new Du(n.get(1),n.get(3)),o=new rr(n.popFirst(5));return i.isEqual(r)||Bs(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PI(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class uu{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Sl extends P5{constructor(e,r,n,i,o,s){super(e,r,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new lh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(My("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new qt(dt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Sl._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Sl._jsonSchemaVersion="firestore/documentSnapshot/1.0",Sl._jsonSchema={type:Vn("string",Sl._jsonSchemaVersion),bundleSource:Vn("string","DocumentSnapshot"),bundleName:Vn("string"),bundle:Vn("string")};class lh extends Sl{data(e={}){return super.data(e)}}class gc{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new uu(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new lh(this._firestore,this._userDataWriter,n.key,n,new uu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new qt(dt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(l=>{const c=new lh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new uu(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>o||l.type!==3).map(l=>{const c=new lh(i._firestore,i._userDataWriter,l.doc.key,l.doc,new uu(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return l.type!==0&&(u=s.indexOf(l.doc.key),s=s.delete(l.doc.key)),l.type!==1&&(s=s.add(l.doc),h=s.indexOf(l.doc.key)),{type:wI(l.type),doc:c,oldIndex:u,newIndex:h}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new qt(dt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=gc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=sy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function wI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return hr(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xI(t){t=js(t,Ln);const e=js(t.firestore,rd);return nI(Ty(e),t._key).then(r=>II(e,t,r))}gc._jsonSchemaVersion="firestore/querySnapshot/1.0",gc._jsonSchema={type:Vn("string",gc._jsonSchemaVersion),bundleSource:Vn("string","QuerySnapshot"),bundleName:Vn("string"),bundle:Vn("string")};class A5 extends SI{constructor(e){super(),this.firestore=e}convertBytes(e){return new wo(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Ln(this.firestore,null,r)}}function AI(t){t=js(t,Dl);const e=js(t.firestore,rd),r=Ty(e),n=new A5(e);return vI(t._query),iI(r,t._query).then(i=>new gc(e,n,t,i))}function CI(t,e,r){t=js(t,Ln);const n=js(t.firestore,rd),i=PI(t.converter,e);return I5(n,[hI(Ly(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,os.none())])}function C5(t,e,r,...n){t=js(t,Ln);const i=js(t.firestore,rd),o=Ly(i);let s;return s=typeof(e=di(e))=="string"||e instanceof hp?fI(o,"updateDoc",t._key,e,r,n):pI(o,"updateDoc",t._key,e),I5(i,[s.toMutation(t._key,os.exists(!0))])}function I5(t,e){return function(n,i){const o=new Ms;return n.asyncQueue.enqueueAndForget(async()=>H4(await rI(n),i,o)),o.promise}(Ty(t),e)}function II(t,e,r){const n=r.docs.get(e._key),i=new A5(t);return new Sl(t,i,e._key,n,new uu(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Tc=i})($c),bc(new Il("firestore",(n,{instanceIdentifier:i,options:o})=>{const s=n.getProvider("app").getImmediate(),l=new rd(new hC(n.getProvider("auth-internal")),new mC(s,n.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new qt(dt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Du(u.options.projectId,h)}(s,i),s);return o={useFetchStreams:r,...o},l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),Ia(ov,sv,e),Ia(ov,sv,"esm2020")})();let $I="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const $5=l1(JSON.parse(PP($I))),dl=sC($5),Vh=new ts,_m=aI($5);Vh.addScope("profile");Vh.addScope("email");class du extends Error{}du.prototype.name="InvalidTokenError";function EI(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function TI(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return EI(e)}catch{return atob(e)}}function kI(t,e){if(typeof t!="string")throw new du("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new du(`Invalid token specified: missing part #${r+1}`);let i;try{i=TI(n)}catch(o){throw new du(`Invalid token specified: invalid base64 for part #${r+1} (${o.message})`)}try{return JSON.parse(i)}catch(o){throw new du(`Invalid token specified: invalid json for part #${r+1} (${o.message})`)}}const NI={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},LI=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:NI.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},RI=t=>kI(t),DI=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[MI,FI]=Hu({}),OI=async()=>{const e=await Fi({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);FI(n)}return 1},BI=async t=>{let e=MI?.[992002];e&&(e.params={tkn:t})},[Zl,wi]=Hu({user:null,loading:!0,error:null,authMethod:null}),[E5,n0]=Ce(null);Wx(dl,t=>{t?wi({user:t,loading:!1,error:null,authMethod:"firebase"}):E5()||wi({user:null,loading:!1,error:null,authMethod:null})});PA(dl).then(t=>{t&&wi({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),wi({loading:!1,error:t.message})});const lr={get state(){return Zl},async getUserProfile(t){try{const e=y5(_m,"users",t),r=await xI(e);if(r.exists()){wi("profile",r.data());let n={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},i=r.data(),o={};return Object.keys(n).map(s=>{let l=n?.[s];i.hasOwnProperty(s)||(o[s]=l)}),Object.keys(o).length>0&&C5(e,o),r.data()}else{let n=lr?.state?.user,i={uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date,stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};return await CI(e,i),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},getBusinessId:()=>lr.state?.profile?.businessId,hasPermission:t=>{const e=lr.state?.profile;return e?.isAdmin?!0:e?e?.[t]===!0:!1},async signInWithGoogle(){try{wi("loading",!0),wi("error",null);try{const t=await fA(dl,Vh);wi({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{lr.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await _A(dl,Vh);else throw t}}catch(t){console.error("Sign-in error:",t),wi({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await Fi({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),i=new Date(n+6e4*60*24*365),o="hrm_tkn_acc";document.cookie=`${o}=${r.data}; expires=${i}; path=/;g_state = {"i_l":1,"i_p":${i}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${i};`,await OI(),BI(r.data)}},async signInWithGoogleCloud(t){try{wi("loading",!0),wi("error",null);const e=RI(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};n0(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};wi({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const i=ts.credential(t);await Ux(dl,i)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),wi({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{wi("loading",!0),(Zl.authMethod==="firebase"||dl.currentUser)&&await Yx(dl),Zl.authMethod==="google-cloud"&&(DI(),n0(null)),wi({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),wi({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!Zl.user||!!E5()},get currentUser(){return Zl.user},get authMethod(){return Zl.authMethod}},jI=async()=>({}),VI=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let hl=VI();const Sm={getMode(){return hl},setMode(t){hl=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return hl==="fake"},isRealMode(){return hl==="real"},isHybridMode(){return hl==="hybrid"}},Ki=async(t,e,r=!0)=>{if(hl==="fake")return e();if(hl==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},i0={async getAll(t,e){const r=await Fi({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:lr.getBusinessId(),":search0":"produ"}});return Wf(r)},async getById(t){return Ki(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>Oi.products.getById(t))},async create(t){return Ki(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>Oi.products.create(t))},async update(t,e){return Ki(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>Oi.products.update(t,e))},async delete(t){return Ki(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>Oi.products.delete(t))}},Ti={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:lr.getBusinessId()};return t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await Fi({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:lr.getBusinessId()};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await Fi({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getConsigee(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await Fi({query:"getScanConsigneeYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getShipper(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await Fi({query:"getScanShipperYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getInvoice(t,e){if(!(t&&t?.trim()))return[];let r={businessId:lr.getBusinessId()};return t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await Fi({query:"getScanYabaSalesOrders",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async addInventory(t){let r={query:"addYabaInventory",params:{businessId:lr.getBusinessId()},form:t};return await Fi(r)},async updInventory(t){return lr.getBusinessId(),await jI()},async addInvoice(t){let r={query:"addYabaSalesOrders",params:{businessId:lr.getBusinessId()},form:t};return await Fi(r)},async getHBLS(t,e){if(!(t&&t?.trim()))return[];let r={businessId:lr.getBusinessId()};return e?.search,e?.guia&&e.guia!=="all"&&(r.guia=e.guia),t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await Fi({query:"getScanYabaHbls",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND guia = guia",params:r})}},Vy={async getAll(t){return Ti.getInventory("ref")},async getById(t){return Ki(async()=>{throw console.log("Getting movement by ID via real API:",t),new Error("Real API not implemented yet")},()=>Oi.movements.getById(t))},async create(t){return Ki(async()=>{throw console.log("Creating movement via real API:",t),new Error("Real API not implemented yet")},()=>Oi.movements.create(t))},async update(t,e){return Ki(async()=>{throw console.log("Updating movement via real API:",t,e),new Error("Real API not implemented yet")},()=>Oi.movements.update(t,e))},async createBulk(t){return Ki(async()=>{throw console.log("Creating bulk movements via real API:",t),new Error("Real API not implemented yet")},()=>Oi.movements.createBulk(t))},async getStockLevels(t){return await Fi({query:"calculateInventoryStock",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:t})},async calcStockLevels(){return[]}},qh={async getAlls(t,e){if(console.log("getAlls",t),!(t&&t?.trim()))return[];let r={businessId:"hcPiDPfZFS8ymqoh"};return e?.search,t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await Fi({query:"getAllAccountsByUserId",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND guia = guia",params:r})},async getAll(t){return Ki(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>Oi.accounts.getAll(t))},async getById(t){return Ki(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>Oi.accounts.getById(t))},async create(t){console.log({query:"addAccounts",params:{businessId:"hcPiDPfZFS8ymqoh"},form:t})},async update(t,e){let n={query:"updateAccounts",params:{businessId:"hcPiDPfZFS8ymqoh",accountId:t},data2update:e};console.log(n);const i=await Fi(n);return console.log(i),i}},o0={async getNextEntryNumber(){return Ki(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>Oi.utils.getNextEntryNumber())},async getNextProductCode(t){return Ki(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>Oi.utils.getNextProductCode(t))},async healthCheck(){return Ki(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>Oi.utils.healthCheck())},async getStats(){return Ki(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>Oi.utils.getStats())}},qI=()=>{Sm.setMode("real"),console.log(" HRM Finance initialized in REAL API mode for production")};qI();var zI=he("<p>"),UI=he('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div></div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div></div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div></div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div></div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div></div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div></div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google  Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const HI=()=>{Cn(()=>{LI(S=>{lr.signInWithGoogleP(S)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},i={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},o={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},s={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},l={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},c={"font-size":"3rem","margin-bottom":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},h={color:"#718096","line-height":"1.6"},m={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},g={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},f={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},w={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},x=()=>{lr.signInWithGoogle()};return(()=>{var S=UI(),C=S.firstChild,j=C.firstChild,oe=j.firstChild,te=oe.nextSibling,Z=te.nextSibling,re=Z.firstChild,E=re.firstChild;E.firstChild;var $=E.nextSibling,T=j.nextSibling,B=T.firstChild,_=B.firstChild,P=_.nextSibling,b=P.nextSibling,H=B.nextSibling,K=H.firstChild,R=K.nextSibling,k=R.nextSibling,W=H.nextSibling,z=W.firstChild,U=z.nextSibling,le=U.nextSibling,L=W.nextSibling,M=L.firstChild,G=M.nextSibling,I=G.nextSibling,F=L.nextSibling,X=F.firstChild,Y=X.nextSibling,Q=Y.nextSibling,J=F.nextSibling,V=J.firstChild,ne=V.nextSibling,ee=ne.nextSibling,ce=T.nextSibling,se=ce.firstChild,q=se.nextSibling;return y(S,t),y(C,e),y(j,r),y(oe,n),y(te,i),y(Z,o),E.addEventListener("mouseleave",ue=>{ue.currentTarget.style.background="white",ue.currentTarget.style.color="#4285f4"}),E.addEventListener("mouseenter",ue=>{ue.currentTarget.style.background="#4285f4",ue.currentTarget.style.color="white"}),E.$$click=x,y(E,m),a(E,D(Ge,{get when(){return lr.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),y($,w),a(j,D(Ge,{get when(){return lr.state.error},get children(){var ue=zI();return y(ue,g),a(ue,()=>lr.state.error),ue}}),null),y(T,s),y(ce,f),q.style.setProperty("margin-top","0.5rem"),q.style.setProperty("font-size","0.75rem"),we(ue=>{var ye=lr.state.loading,de=l,ge=c,xe=u,pe=h,_e=l,Re=c,Ee=u,Te=h,Le=l,Ie=c,De=u,Ye=h,Be=l,We=c,Ke=u,st=h,nt=l,He=c,mt=u,ut=h,at=l,It=c,Xe=u,kt=h;return ye!==ue.e&&(E.disabled=ue.e=ye),ue.t=y(B,de,ue.t),ue.a=y(_,ge,ue.a),ue.o=y(P,xe,ue.o),ue.i=y(b,pe,ue.i),ue.n=y(H,_e,ue.n),ue.s=y(K,Re,ue.s),ue.h=y(R,Ee,ue.h),ue.r=y(k,Te,ue.r),ue.d=y(W,Le,ue.d),ue.l=y(z,Ie,ue.l),ue.u=y(U,De,ue.u),ue.c=y(le,Ye,ue.c),ue.w=y(L,Be,ue.w),ue.m=y(M,We,ue.m),ue.f=y(G,Ke,ue.f),ue.y=y(I,st,ue.y),ue.g=y(F,nt,ue.g),ue.p=y(X,He,ue.p),ue.b=y(Y,mt,ue.b),ue.T=y(Q,ut,ue.T),ue.A=y(J,at,ue.A),ue.O=y(V,It,ue.O),ue.I=y(ne,Xe,ue.I),ue.S=y(ee,kt,ue.S),ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),S})()};pr(["click"]);var GI=he("<div><div>");const WI=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),Ei(async()=>{lr.state?.user?.uid&&lr.getUserProfile(lr.state?.user?.uid)}),Cn(()=>{}),D(Ge,{get when(){return!lr.state.loading},get fallback(){return(()=>{var i=GI(),o=i.firstChild;return y(i,e),y(o,r),i})()},get children(){return D(Ge,{get when(){return lr.isAuthenticated},get fallback(){return D(HI,{})},get children(){return t.children}})}})};var YI=he("<button>");const ht=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},i={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...i[t.variant||"primary"]}};return(()=>{var r=YI();return hs(r,"click",t.onClick,!0),a(r,()=>t.children),we(n=>{var i=e(),o=t.disabled,s=t.type||"button",l=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=y(r,i,n.e),o!==n.t&&(r.disabled=n.t=o),s!==n.a&&Qt(r,"type",n.a=s),l!==n.o&&Vm(r,n.o=l),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};pr(["click"]);var KI=he("<div><div><div><h2></h2><button></button></div><div>");const qn=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},i={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},o={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},s={padding:"1.5rem"},l=c=>{c.target===c.currentTarget&&t.onClose()};return D(Ge,{get when(){return t.isOpen},get children(){var c=KI(),u=c.firstChild,h=u.firstChild,m=h.firstChild,g=m.nextSibling,f=h.nextSibling;return c.$$click=l,y(h,n),y(m,i),a(m,()=>t.title),g.addEventListener("mouseleave",w=>w.target.style.background="none"),g.addEventListener("mouseenter",w=>w.target.style.background="var(--background-color)"),hs(g,"click",t.onClose,!0),y(g,o),y(f,s),a(f,()=>t.children),we(w=>{var x=e,S=r;return w.e=y(c,x,w.e),w.t=y(u,S,w.t),w},{e:void 0,t:void 0}),c}})};pr(["click"]);var s0=he("<div>"),JI=he("<h3>"),QI=he("<p>");const Dt=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default",margin:"9px"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var o=s0();return hs(o,"click",t.onClick,!0),a(o,(()=>{var s=$e(()=>!!(t.title||t.subtitle));return()=>s()&&(()=>{var l=s0();return y(l,r),a(l,(()=>{var c=$e(()=>!!t.title);return()=>c()&&(()=>{var u=JI();return y(u,n),a(u,()=>t.title),u})()})(),null),a(l,(()=>{var c=$e(()=>!!t.subtitle);return()=>c()&&(()=>{var u=QI();return y(u,i),a(u,()=>t.subtitle),u})()})(),null),l})()})(),null),a(o,()=>t.children,null),we(s=>{var l=e,c=`card ${t.className||""}`;return s.e=y(o,l,s.e),c!==s.t&&Vm(o,s.t=c),s},{e:void 0,t:void 0}),o})()};pr(["click"]);var XI=he("<div><label></label><input>"),ZI=he("<span>*");const Ar=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"},[i,o]=Ce("");Ei(()=>{t?.value!==void 0&&o(t.value.toString())});const s=c=>{(c.key==="Enter"||c.key==="Escape"||c.key==="Tab")&&t.onChange&&_l(i())&&t.onChange(i())},l=()=>{_l(i())&&t.onChange(i())};return(()=>{var c=XI(),u=c.firstChild,h=u.nextSibling;return y(c,n),y(u,e),a(u,()=>t.label,null),a(u,(()=>{var m=$e(()=>!!t.required);return()=>m()&&(()=>{var g=ZI();return g.style.setProperty("color","var(--primary-color)"),g})()})(),null),h.addEventListener("blur",m=>{l(),m.target.style.borderColor="var(--border-color)"}),h.addEventListener("focus",m=>{m.target.style.borderColor="var(--primary-color)"}),h.$$keydown=s,h.$$input=m=>o(m.target.value),y(h,r),we(m=>{var g=t.type||"text",f=t.placeholder,w=t.required,x=t.disabled;return g!==m.e&&Qt(h,"type",m.e=g),f!==m.t&&Qt(h,"placeholder",m.t=f),w!==m.a&&(h.required=m.a=w),x!==m.o&&(h.disabled=m.o=x),m},{e:void 0,t:void 0,a:void 0,o:void 0}),we(()=>h.value=i()),c})()};pr(["input","keydown"]);const e$={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",invoices:"invoices",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",store:"Store",orderId:"Order ID",tax:"Tax",paymentMethods:"Payment Methods",cash:"Cash",creditCard:"Credit Card",shipping:"Shipping",air:"Air",sea:"Sea",thankYouBusiness:"Thank you for your business!",thankForChoosingUs:"Thank you for choosing us!",taxExemptNote:"Tax exempted on cash payment.",youSaved:"You saved",generatedOn:"Generated on",printSavePDF:"Print / Save as PDF",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of",print:"Print",export:"Export",pending:"Pending",completed:"Completed",customer:"Customer",location:"Location",reservations:"Reservations",backToDashboard:"Back to Dashboard",lbs:"pounds"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",summaryFor:"SUMMARY FOR",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",bulkMovementReport:"Bulk Movement Report",totalQuantity:"Total Quantity",estimatedValue:"Estimated Value",viewHistoricalReports:"View Historical Reports",noBulkReportsFound:"No bulk movement reports found",bulkReportsAppearHere:"Bulk movement reports will appear here after you create bulk movements",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information",searchProductsImages:"Search products to view images...",searchForProducts:"Search for Products",startTypingToSearch:"Start typing to search and view product images",tryDifferentSearch:"Try a different search term"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},invoices:{title:"Invoice Dashboard",invoice:"Invoice",invoices:"Invoices",invoiceNumber:"Invoice Number",invoiceDetails:"Invoice Details",customerInformation:"Customer Information",customerName:"Customer Name",legalName:"Legal Name",contactInformation:"Contact Information",idPassport:"ID/Passport",phoneNumber:"Phone Number",altPhone:"Alt Phone",address:"Address",between:"Between",and:"and",products:"Products",reservations:"Reservations",unitPrice:"Unit Price",total:"Total",subtotal:"Subtotal",totalRevenue:"Total Revenue",totalProducts:"Total Products",totalReservations:"Total Reservations",aranceles:"Aranceles (Customs)",uniqueCustomers:"Unique Customers",averageInvoice:"Average Invoice",completed:"Completed",pending:"Pending",storesActive:"Stores Active",topProducts:"Top Products",mostSoldProducts:"Most sold products by quantity",reservationsByType:"Reservations by Type",distributionOfCategories:"Distribution of reservation categories",recentInvoices:"Recent Invoices",showingInvoices:"Showing {{count}} invoices",date:"Date",customer:"Customer",store:"Store",actions:"Actions",view:"View",status:"Status",printInvoice:"Print Invoice",exportPdf:"Export PDF",backToDashboard:"Back to Dashboard",fromInvoices:"From {{count}} invoices",value:"value",activeCustomers:"Active customers",perInvoiceValue:"Per invoice value",locations:"Locations",mostRecentActivity:"Most recent activity",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",clearFilters:"Clear Filters",search:"Search",searchPlaceholder:"Search by invoice #, customer, store...",customsFees:"Total customs fees",salesType:"SALES",packagesOrder:"Packages Order",businessId:"Business ID",orderKey:"Order Key",reservationType:"Reservation Type",arancel:"Arancel",key:"Key",noInvoicesFound:"No invoices found",loadingInvoices:"Loading invoices...",errorLoadingInvoices:"Error loading invoices",refreshData:"Refresh Data",currentStockValue:"Current Stock Value",filterByStore:"Filter by store",filterByDate:"Filter by date range",totalCustomsFees:"Total customs fees",averageValue:"Average value",senderInformation:"Sender Information",receiptInformation:"Receipt Information",productsSubtotal:"Products Subtotal",reservationsSubtotal:"Reservations Subtotal",code:"Code",description:"Description",qty:"Qty",type:"Type",id:"ID",passport:"Passport",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",latestBillingActivity:"Latest billing activity",paid:"Paid"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry",referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrs",next:"Siguiente",previous:"Anterior",yes:"S",no:"No",loading:"Cargando...",error:"Error",success:"xito",warning:"Advertencia",info:"Informacin",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripcin",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Ingls",spanish:"Espaol",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clsico",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",name:"Nombre",code:"Cdigo",category:"Categora",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",invoices:"facturas",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Nmero de Referencia",referenceNumberPlaceholder:"Ingrese nmero de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por pgina",first:"Primera",last:"ltima",store:"Tienda",orderId:"ID de Orden",tax:"Impuesto",paymentMethods:"Mtodos de Pago",cash:"Efectivo",creditCard:"Tarjeta de Crdito",shipping:"Envo",air:"Areo",sea:"Martimo",thankYouBusiness:"Gracias por su negocio!",thankForChoosingUs:"Gracias por elejirnos!",taxExemptNote:"Impuesto exento en pago en efectivo.",youSaved:"Usted ahorr",generatedOn:"Generado el",printSavePDF:"Imprimir / Guardar como PDF",pageOfPages:"Pgina {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Pgina",of:"de",lbs:"libras"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidacin Bancaria",reports:"Reportes",settings:"Configuracin"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rpidas",employeeCount:"Nmero de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Prdida Neta",monthlyPayroll:"Nmina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"ltima actualizacin hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"ltimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 da",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 das"},accounts:{title:"Plan de Cuentas",accountNumber:"Nmero de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categora",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Informacin de Cuenta",accountPurpose:"Propsito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creacin",lastModified:"ltima Modificacin",noDescription:"No se proporcion descripcin.",totalCount:"Conteo total",basicDetails:"Detalles bsicos",currentBalance:"Saldo actual",classification:"Clasificacin",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestin de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicacin",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artculo",activeProducts:"Productos Activos",lowStockAlert:"Artculos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicacin",productName:"Nombre del Producto",productCode:"Cdigo del Producto",sku:"SKU",category:"Categoria",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mnimo de Stock",maxStockLevel:"Nivel Mximo de Stock",locationName:"Nombre de Ubicacin",locationType:"Tipo de Ubicacin",locationCode:"Cdigo de Ubicacin",movementType:"Tipo de Movimiento",referenceNumber:"Nmero de Referencia",invoiceNumber:"Nmero de Factura",fromLocation:"Desde Ubicacin",toLocation:"Hacia Ubicacin",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicacin",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicacin",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por ltima vez",warehouseType:"Almacn",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atencin",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"ltimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Fsico",physicalInventoryCount:"Conteo Fsico de Inventario",setupPhysicalCount:"Configurar Conteo Fsico de Inventario",setupDescription:"Configure los ajustes de su conteo fsico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluir {{count}} productos de {{location}} en la categora {{category}}.",startCounting:"Iniciar Conteo Fsico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variacin",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuacin y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",perfectCount:"Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo fsico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo fsico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicacin",allCategories:"Todas las Categoras",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artculos fsicamente presentes en esta ubicacin",'Escribir el conteo real en la columna "Conteo Fsico"',"Dejar en blanco si el artculo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando est completo"],unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artculos Contados",summaryFor:"RESUMEN PARA",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminucin de Stock",purchaseReceive:"Compra/Recepcin",saleIssue:"Venta/Emisin",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicacin, referencia, notas, factura...",allProducts:"Todos los Productos",bulkMovementReport:"Reporte de Movimiento en Lote",totalQuantity:"Cantidad Total",estimatedValue:"Valor Estimado",viewHistoricalReports:"Ver Reportes Histricos",noBulkReportsFound:"No se encontraron reportes de movimientos en lote",bulkReportsAppearHere:"Los reportes de movimientos en lote aparecern aqu despus de crear movimientos en lote",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa ms tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clsico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artculos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artculos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} ms",latestInventoryActivities:"ltimas actividades de inventario",min:"Mn",max:"Mx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su bsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su bsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicacin, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa ms tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",store:"Tienda",supplier:"Proveedor",warehouse:"Almacn",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Informacin del Movimiento",locationInformation:"Informacin de Ubicacin",searchProductsImages:"Buscar productos para ver imgenes...",searchForProducts:"Buscar Productos",startTypingToSearch:"Comienza a escribir para buscar y ver imgenes de productos",tryDifferentSearch:"Prueba con un trmino de bsqueda diferente"},employees:{title:"Gestin de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Informacin Personal",employmentInfo:"Informacin Laboral",payrollInfo:"Informacin de Nmina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratacin",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nmina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la direccin de correo electrnico",enterPhone:"Ingrese el nmero de telfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniera",product:"Producto",design:"Diseo",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analtica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Perodo",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Est Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripcin de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidacin Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depsitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automtica",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliacin",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depsitos en Trnsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliacin",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliacin",bankAccountInfo:"Informacin de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"ltima conciliacin",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Perodo seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparacin",reconciliationRate:"Tasa de Conciliacin",completionStatus:"Estado de finalizacin",recentReconciliationSessions:"Sesiones de Conciliacin Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliacin recientes.",startFirstReconciliation:"Iniciar Primera Conciliacin",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripcin son requeridas",importedTransaction:"Transaccin importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aqu",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripcin y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripcin",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Dbito",creditColumn:"Columna de Crdito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas ms",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparacin de Conciliacin",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atencin",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuacin para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Seleccin"},journal:{title:"Asientos Contables",entryNumber:"Nmero de Asiento",entryDate:"Fecha del Asiento",debit:"Dbito",credit:"Crdito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Dbitos Totales",totalCredits:"Crditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Direccin de correo invlida",invalidNumber:"Nmero invlido",invalidDate:"Fecha invlida",selectOption:"Por favor seleccione una opcin",enterValue:"Por favor ingrese un valor",confirmDelete:"Est seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El nmero de cuenta ya existe",referenceNumberRequired:"El nmero de referencia es requerido",locationRequired:"La ubicacin es requerida",fromLocationRequired:"La ubicacin de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artculo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artculo {{index}}"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicacin",inventoryDetail:"Detalles del Artculo de Inventario",quickAdd:"Agregar Rpido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicacin",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar nmero de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Informacin General",stockInformation:"Informacin de Stock",locationInformation:"Informacin de Ubicacin",movementInformation:"Informacin de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicacin",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicacin..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catlogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catlogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrnicos",supplies:"Suministros",lighting:"Iluminacin"},invoices:{title:"Panel de Facturas",invoice:"Factura",invoices:"Facturas",invoiceNumber:"Nmero de Factura",invoiceDetails:"Detalles de Factura",customerInformation:"Informacin del Cliente",customerName:"Nombre del Cliente",legalName:"Nombre Legal",contactInformation:"Informacin de Contacto",idPassport:"ID/Pasaporte",phoneNumber:"Nmero de Telfono",altPhone:"Telfono Alt.",address:"Direccin",between:"Entre",and:"y",products:"Productos",reservations:"Reservaciones",unitPrice:"Precio Unitario",total:"Total",subtotal:"Subtotal",category:"Categoria",totalRevenue:"Ingresos Totales",totalProducts:"Total de Productos",totalReservations:"Total de Reservaciones",aranceles:"Aranceles (Aduanas)",uniqueCustomers:"Clientes nicos",averageInvoice:"Factura Promedio",completed:"Completada",pending:"Pendiente",storesActive:"Tiendas Activas",topProducts:"Productos Principales",mostSoldProducts:"Productos ms vendidos por cantidad",reservationsByType:"Reservaciones por Tipo",distributionOfCategories:"Distribucin de categoras de reservaciones",recentInvoices:"Facturas Recientes",showingInvoices:"Mostrando {{count}} facturas",date:"Fecha",customer:"Cliente",store:"Tienda",actions:"Acciones",view:"Ver",status:"Estado",printInvoice:"Imprimir Factura",exportPdf:"Exportar PDF",backToDashboard:"Volver al Panel",fromInvoices:"De {{count}} facturas",value:"valor",activeCustomers:"Clientes activos",perInvoiceValue:"Valor por factura",locations:"Ubicaciones",mostRecentActivity:"Actividad ms reciente",storeLocation:"Ubicacin de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",clearFilters:"Limpiar Filtros",search:"Buscar",searchPlaceholder:"Buscar por # factura, cliente, tienda...",customsFees:"Aranceles totales",salesType:"VENTAS",packagesOrder:"Orden de Paquetes",businessId:"ID de Negocio",orderKey:"Clave de Orden",reservationType:"Tipo de Reservacin",arancel:"Arancel",key:"Clave",noInvoicesFound:"No se encontraron facturas",loadingInvoices:"Cargando facturas...",errorLoadingInvoices:"Error al cargar facturas",refreshData:"Actualizar Datos",currentStockValue:"Valor de Stock Actual",filterByStore:"Filtrar por tienda",filterByDate:"Filtrar por rango de fechas",totalCustomsFees:"Aranceles totales",averageValue:"Valor promedio",senderInformation:"Informacin del Remitente",receiptInformation:"Informacin del Destinatario",productsSubtotal:"Subtotal de Productos",reservationsSubtotal:"Subtotal de Reservaciones",code:"Cdigo",description:"Descripcin",qty:"Cant.",type:"Tipo",id:"ID",passport:"Pasaporte"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"Por qu veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadsticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestin de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestin de Facturas",productManagement:"Acceso a Gestin de Productos"}}}},t$=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[Zp,r$]=Ce(t$()),Zt=()=>({t:(n,i,o)=>{const s=Zp(),l=n.split(".");let c=e$[s];for(const h of l)if(c&&typeof c=="object"&&h in c)c=c[h];else return i||n;let u=typeof c=="string"?c:i||n;return o&&typeof u=="string"&&Object.keys(o).forEach(h=>{const m=o[h],g=`{{${h}}}`;u=u.replace(new RegExp(g,"g"),String(m))}),u},language:()=>Zp(),setLanguage:n=>{r$(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)},currentLanguage:Zp});var n$=he("<div><label></label><select><option value>"),i$=he("<span>*"),o$=he("<option>");const An=t=>{const{t:e}=Zt(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},i={"margin-bottom":"1rem"};return(()=>{var o=n$(),s=o.firstChild,l=s.nextSibling,c=l.firstChild;return y(o,i),y(s,r),a(s,()=>t.label,null),a(s,(()=>{var u=$e(()=>!!t.required);return()=>u()&&(()=>{var h=i$();return h.style.setProperty("color","var(--primary-color)"),h})()})(),null),l.addEventListener("blur",u=>u.target.style.borderColor="var(--border-color)"),l.addEventListener("focus",u=>u.target.style.borderColor="var(--primary-color)"),l.addEventListener("change",u=>t.onChange(u.target.value)),y(l,n),a(c,()=>e("forms.selectOption")),a(l,()=>t.options.map(u=>(()=>{var h=o$();return a(h,()=>u.label),we(()=>h.value=u.value),h})()),null),we(u=>{var h=t.required,m=t.disabled;return h!==u.e&&(l.required=u.e=h),m!==u.t&&(l.disabled=u.t=m),u},{e:void 0,t:void 0}),we(()=>l.value=t.value),o})()};var s$=he("<main><div>"),a$=he("<header><h1>");const lo=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},i={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var o=s$(),s=o.firstChild;return y(o,e),y(s,r),a(s,(()=>{var l=$e(()=>!!t.title);return()=>l()&&(()=>{var c=a$(),u=c.firstChild;return y(c,n),y(u,i),a(u,()=>t.title),c})()})(),null),a(s,()=>t.children,null),o})()};var l$=he("<div><span></span><select><option value=en> </option><option value=es> ");const c$=()=>{const{t,language:e,setLanguage:r}=Zt(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},i={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},o={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},s=l=>{const c=l.target;r(c.value)};return(()=>{var l=l$(),c=l.firstChild,u=c.nextSibling,h=u.firstChild;h.firstChild;var m=h.nextSibling;return m.firstChild,y(l,n),y(c,o),u.addEventListener("change",s),y(u,i),a(h,()=>t("common.english"),null),a(m,()=>t("common.spanish"),null),we(()=>u.value=e()),l})()};var a0=he('<img alt="User avatar">'),u$=he("<div class=user-info-desktop><span>"),d$=he("<button class=sign-out-desktop>Sign Out"),h$=he("<div><div><span></span></div><button>Sign Out"),p$=he(`<nav><div><div class=desktop-nav></div><div><button class=mobile-menu-button><svg width=24 height=24 viewBox="0 0 24 24"fill=currentColor><path></path></svg></button></div></div><div class=mobile-nav></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        .desktop-nav a:hover:not(.nav-active),
        .nav-group button:hover {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        .mobile-nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }

        /* Create invisible bridge to prevent gap issues */
        .nav-group::before {
          content: '';
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          height: 0.5rem;
          z-index: 9;
        }
        
        @media (max-width: 768px) {
          .desktop-nav {
            display: none !important;
          }
          
          .mobile-menu-button {
            display: block !important;
          }
          
          .user-info-desktop,
          .sign-out-desktop {
            display: none !important;
          }
          
          nav > div:first-child {
            padding: 1rem;
          }
        }
        
        @media (min-width: 769px) {
          .mobile-nav {
            display: none !important;
          }
        }
      `),f$=he("<div class=nav-group><button> <span></span></button><div>"),m$=he("<div>"),y$=he("<div><div><span> </span><span>");const g$=()=>{const{t}=Zt(),[e,r]=Ce(!1),[n,i]=Ce(null),[o,s]=Ce(null),l={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},c={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto",position:"relative"},u={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none"},h={display:"flex",gap:"1rem","align-items":"center",flex:"1","margin-left":"2rem"},m={display:"none",position:"absolute",top:"100%",left:"0",right:"0",background:"var(--surface-color)","border-top":"1px solid var(--border-color)","box-shadow":"var(--shadow-md)","max-height":"70vh","overflow-y":"auto"},g={position:"relative",display:"flex","align-items":"center"},f={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"transparent",border:"none",color:"var(--text-secondary)","font-weight":"500","font-size":"0.875rem",cursor:"pointer","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease","white-space":"nowrap"},w={position:"absolute",top:"100%",left:"0",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","min-width":"200px","margin-top":"0.25rem","z-index":"10",display:"none","padding-top":"0.25rem"},x={"border-bottom":"1px solid var(--border-color)"},S={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",cursor:"pointer","font-weight":"600",color:"var(--text-primary)"},C={display:"block","text-decoration":"none",color:"var(--text-secondary)",padding:"0.75rem 1rem","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},j={...C,padding:"0.75rem 1.5rem","border-bottom":"1px solid var(--border-light)"},oe={display:"none",background:"transparent",border:"none",padding:"0.5rem",cursor:"pointer",color:"var(--text-primary)"},te={display:"flex","align-items":"center",gap:"1rem"},Z={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},re={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},E={...C,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent","border-radius":"var(--border-radius-sm)"},$=()=>{lr.signOut()},T=R=>{const k=lr.state?.profile;return k?k[R]===!0||k.isAdmin===!0:!1},B=()=>{r(!e())},_=R=>{i(n()===R?null:R)},P=R=>{const k=o();k&&(clearTimeout(k),s(null)),i(R)},b=()=>{const R=setTimeout(()=>{i(null)},300);s(R)},H=[{name:"Finance",icon:"",items:[{path:"/accounts",label:t("navigation.accounts"),permission:"AccountAccess",icon:""},{path:"/entry-books",label:t("navigation.entryBooks"),permission:"JournalAccess",icon:""},{path:"/balance-sheet",label:t("navigation.balanceSheet"),permission:"AccountAccess",icon:""},{path:"/bank-consolidations",label:t("navigation.consolidate"),permission:"BankingAccess",icon:""}]},{name:"Operations",icon:"",items:[{path:"/inventory",label:t("navigation.inventory"),permission:"InventoryAccess",icon:""},{path:"/invoices",label:t("invoices.invoices"),permission:"invoiceAccess",icon:""},{path:"/hbl",label:t("navigation.hbl"),permission:"HBLAccess",icon:""}]},{name:"Management",icon:"",items:[{path:"/employees",label:t("navigation.employees"),permission:"EmployeeAccess",icon:""},{path:"/admin/users",label:"Admin",permission:"isAdmin",icon:"",adminOnly:!0}]}],K=()=>H.map(R=>({...R,items:R.items.filter(k=>k.adminOnly?lr.state?.profile?.isAdmin:T(k.permission))})).filter(R=>R.items.length>0);return(()=>{var R=p$(),k=R.firstChild,W=k.firstChild,z=W.nextSibling,U=z.firstChild,le=U.firstChild,L=le.firstChild,M=k.nextSibling;return a(k,D(oc,{href:"/",style:u,children:"HRM Finance"}),W),y(W,h),a(W,D(oc,{href:"/",style:C,activeClass:"nav-active",get children(){return[" ",$e(()=>t("navigation.dashboard"))]}}),null),a(W,D(zt,{get each(){return K()},children:G=>(()=>{var I=f$(),F=I.firstChild,X=F.firstChild,Y=X.nextSibling,Q=F.nextSibling;return I.addEventListener("mouseleave",b),I.addEventListener("mouseenter",()=>P(G.name)),a(F,()=>G.icon,X),a(F,()=>G.name,Y),Y.style.setProperty("font-size","0.75rem"),Q.addEventListener("mouseleave",b),Q.addEventListener("mouseenter",()=>P(G.name)),a(Q,D(zt,{get each(){return G.items},children:J=>D(oc,{get href(){return J.path},style:C,activeClass:"nav-active",onClick:()=>i(null),get children(){return[$e(()=>J.icon)," ",$e(()=>J.label)]}})})),we(J=>{var V=g,ne=f,ee={...w,display:n()===G.name?"block":"none"};return J.e=y(I,V,J.e),J.t=y(F,ne,J.t),J.a=y(Q,ee,J.a),J},{e:void 0,t:void 0,a:void 0}),I})()}),null),y(z,te),a(z,D(c$,{}),U),a(z,D(Ge,{get when(){return lr.currentUser},get children(){return[(()=>{var G=u$(),I=G.firstChild;return a(G,D(Ge,{get when(){return lr.currentUser?.photoURL},get children(){var F=a0();return we(X=>{var Y=lr.currentUser.photoURL,Q=re;return Y!==X.e&&Qt(F,"src",X.e=Y),X.t=y(F,Q,X.t),X},{e:void 0,t:void 0}),F}}),I),a(I,()=>lr.currentUser?.displayName||lr.currentUser?.email),we(F=>y(G,Z,F)),G})(),(()=>{var G=d$();return G.addEventListener("mouseleave",I=>{I.currentTarget.style.background="transparent",I.currentTarget.style.color="var(--text-secondary)"}),G.addEventListener("mouseenter",I=>{I.currentTarget.style.background="var(--background-color)",I.currentTarget.style.color="var(--text-primary)"}),G.$$click=$,we(I=>y(G,E,I)),G})()]}}),U),U.$$click=B,y(U,oe),a(M,D(oc,{href:"/",style:j,activeClass:"nav-active",onClick:()=>r(!1),get children(){return[" ",$e(()=>t("navigation.dashboard"))]}}),null),a(M,D(zt,{get each(){return K()},children:G=>(()=>{var I=y$(),F=I.firstChild,X=F.firstChild,Y=X.firstChild,Q=X.nextSibling;return y(I,x),F.$$click=()=>_(G.name),y(F,S),a(X,()=>G.icon,Y),a(X,()=>G.name,null),Q.style.setProperty("transition","transform 0.2s"),a(I,D(Ge,{get when(){return n()===G.name},get children(){var J=m$();return J.style.setProperty("background","var(--background-color)"),a(J,D(zt,{get each(){return G.items},children:V=>D(oc,{get href(){return V.path},get style(){return{...j,"padding-left":"3rem"}},activeClass:"nav-active",onClick:()=>r(!1),get children(){return[$e(()=>V.icon)," ",$e(()=>V.label)]}})})),J}}),null),we(J=>(J=n()===G.name?"rotate(180deg)":"none")!=null?Q.style.setProperty("transform",J):Q.style.removeProperty("transform")),I})()}),null),a(M,D(Ge,{get when(){return lr.currentUser},get children(){var G=h$(),I=G.firstChild,F=I.firstChild,X=I.nextSibling;return G.style.setProperty("padding","1rem"),G.style.setProperty("border-top","2px solid var(--border-color)"),a(I,D(Ge,{get when(){return lr.currentUser?.photoURL},get children(){var Y=a0();return we(Q=>{var J=lr.currentUser.photoURL,V=re;return J!==Q.e&&Qt(Y,"src",Q.e=J),Q.t=y(Y,V,Q.t),Q},{e:void 0,t:void 0}),Y}}),F),a(F,()=>lr.currentUser?.displayName||lr.currentUser?.email),X.$$click=()=>{$(),r(!1)},we(Y=>{var Q={...Z,"margin-bottom":"1rem"},J={...E,width:"100%"};return Y.e=y(I,Q,Y.e),Y.t=y(X,J,Y.t),Y},{e:void 0,t:void 0}),G}}),null),we(G=>{var I=l,F=c,X=e()?"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z":"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",Y={...m,display:e()?"block":"none"};return G.e=y(R,I,G.e),G.t=y(k,F,G.t),X!==G.a&&Qt(L,"d",G.a=X),G.o=y(M,Y,G.o),G},{e:void 0,t:void 0,a:void 0,o:void 0}),R})()};pr(["click"]);var v$=he("<div><div><div></div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><p>"),l0=he("<br>"),b$=he("<strong>");const _$=t=>{const{t:e}=Zt(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},i={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},o={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},s={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},l={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},c={color:"#4a5568","font-size":"1rem","line-height":"1.6"},u={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},h={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},m={...h,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},g={...h,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},f={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},w={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},x={color:"#48bb78","font-size":"1.25rem"};return D(lo,{get title(){return e("unauthorized.title")},get children(){var S=v$(),C=S.firstChild,j=C.firstChild,oe=j.nextSibling,te=oe.nextSibling,Z=te.firstChild,re=te.nextSibling,E=re.firstChild,$=E.firstChild;$.nextSibling;var T=re.nextSibling,B=T.firstChild,_=T.nextSibling,P=_.firstChild,b=P.nextSibling,H=b.firstChild,K=H.nextSibling,R=b.nextSibling,k=R.firstChild,W=k.nextSibling,z=R.nextSibling,U=z.firstChild,le=U.nextSibling,L=_.nextSibling,M=L.firstChild;return y(S,r),y(C,n),y(j,i),y(oe,o),a(oe,()=>e("unauthorized.accessDenied")),y(te,s),a(te,()=>e("unauthorized.noPermission"),Z),a(te,(()=>{var G=$e(()=>!!t.featureName);return()=>G()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),Z),y(re,l),y(E,c),a($,()=>e("unauthorized.whySeeing")),a(E,()=>e("unauthorized.explanation"),null),a(E,(()=>{var G=$e(()=>!!t.requiredPermission);return()=>G()&&[l0(),l0(),(()=>{var I=b$();return a(I,()=>e("unauthorized.requiredPermission")),I})()," ",$e(()=>t.requiredPermission)]})(),null),y(T,u),a(T,D(oc,{href:"/",style:m,get children(){return e("unauthorized.goToDashboard")}}),B),B.$$click=()=>window.history.back(),a(B,()=>e("unauthorized.goBack")),y(_,f),P.style.setProperty("margin-bottom","1rem"),P.style.setProperty("color","#2d3748"),a(P,()=>e("unauthorized.featuresCanAccess")),a(K,()=>e("unauthorized.dashboardAccess")),a(W,()=>e("unauthorized.profileAccess")),a(le,()=>e("unauthorized.roleBasedAccess")),L.style.setProperty("margin-top","3rem"),L.style.setProperty("padding","1.5rem"),L.style.setProperty("background","#edf2f7"),L.style.setProperty("border-radius","0.5rem"),M.style.setProperty("color","#4a5568"),M.style.setProperty("font-size","0.875rem"),a(M,()=>e("unauthorized.needAccess")),we(G=>{var I=g,F=w,X=x,Y=w,Q=x,J=w,V=x;return G.e=y(B,I,G.e),G.t=y(b,F,G.t),G.a=y(H,X,G.a),G.o=y(R,Y,G.o),G.i=y(k,Q,G.i),G.n=y(z,J,G.n),G.s=y(U,V,G.s),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),S}})};pr(["click"]);const Eo=t=>{const{t:e}=Zt(),r=()=>{if(!t.permission)return!0;const i=lr.state?.profile;if(!i)return!1;if(i.isAdmin)return!0;switch(t.permission){case"AccountAccess":return i.AccountAccess===!0;case"InventoryAccess":return i.InventoryAccess===!0;case"EmployeeAccess":return i.EmployeeAccess===!0;case"BankingAccess":return i.BankingAccess===!0;case"JournalAccess":return i.JournalAccess===!0;case"AdminAccess":return i.isAdmin===!0;default:return i[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return D(Ge,{get when(){return r()},get fallback(){return t.fallback||D(_$,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var S$=he('<button title="Open Dev Tools">'),P$=he("<span>(<!>)"),w$=he("<div><span></span><span>"),c0=he("<div>"),x$=he("<div>Database reset only available in fake mode"),A$=he("<div><div>Loading..."),C$=he("<div><div><h3> Dev Tools</h3><button></button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button> Refresh Stats</button><button> Health Check</button></div><div><button> Reset DB</button></div></div><div><div>Info</div><div> <strong>Fake Server:</strong> Uses local mock data<br> <strong>Real API:</strong> Connects to actual backend<br> <strong>Hybrid:</strong> Real API with fake fallback<br> Settings are saved in localStorage"),I$=he("<div>Loading..."),$$=he("<div><span>:</span><span>");const E$=()=>{const[t,e]=Ce(!1),[r,n]=Ce(Sm.getMode()),[i,o]=Ce({}),[s,l]=Ce(null),[c,u]=Ce(!1);Cn(async()=>{await h(),await m()});const h=async()=>{try{const E=await o0.getStats();o(E)}catch(E){console.error("Failed to load stats:",E)}},m=async()=>{try{const E=await o0.healthCheck();l(E)}catch(E){console.error("Health check failed:",E),l({status:"error",error:E.message})}},g=async E=>{u(!0);try{Sm.setMode(E),n(E),await h(),await m()}catch($){console.error("Failed to change API mode:",$)}finally{u(!1)}},f=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){u(!0);try{const E=await Oi.utils.resetDatabase();alert(E.message),await h()}catch(E){console.error("Failed to reset database:",E),alert("Failed to reset database")}finally{u(!1)}}},w={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},x={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},S={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},C={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},j={...C,background:"#007acc","border-color":"#007acc"},oe={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},te={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},Z={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},re=E=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:E==="healthy"?"#00ff00":E==="error"?"#ff0000":"#ffff00"});return(()=>{var E=c0();return a(E,D(Ge,{get when(){return!t()},get children(){var $=S$();return $.$$click=()=>e(!0),y($,S),$}}),null),a(E,D(Ge,{get when(){return t()},get children(){var $=C$(),T=$.firstChild,B=T.firstChild,_=B.nextSibling,P=T.nextSibling,b=P.firstChild,H=b.nextSibling,K=H.firstChild,R=K.nextSibling,k=R.nextSibling,W=H.nextSibling,z=W.firstChild,U=z.nextSibling,le=P.nextSibling,L=le.firstChild,M=le.nextSibling,G=M.firstChild,I=M.nextSibling,F=I.firstChild,X=F.nextSibling,Y=X.firstChild,Q=Y.nextSibling,J=X.nextSibling,V=J.firstChild,ne=I.nextSibling,ee=ne.firstChild,ce=ee.nextSibling;return y($,x),T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),T.style.setProperty("margin-bottom","16px"),B.style.setProperty("margin","0"),B.style.setProperty("color","#007acc"),B.style.setProperty("font-size","16px"),_.$$click=()=>e(!1),K.$$click=()=>g("fake"),R.$$click=()=>g("real"),k.$$click=()=>g("hybrid"),W.style.setProperty("font-size","11px"),W.style.setProperty("color","#888"),W.style.setProperty("margin-top","4px"),a(U,r),a(W,()=>r()==="fake"&&" (Using fake server)",null),a(W,()=>r()==="real"&&" (Using real API)",null),a(W,()=>r()==="hybrid"&&" (Real API with fallback)",null),a(le,D(Ge,{get when(){return s()},get fallback(){return(()=>{var se=I$();return se.style.setProperty("font-size","12px"),se})()},get children(){return[(()=>{var se=w$(),q=se.firstChild,ue=q.nextSibling;return se.style.setProperty("display","flex"),se.style.setProperty("align-items","center"),se.style.setProperty("font-size","12px"),a(ue,()=>s()?.status||"Unknown"),a(se,D(Ge,{get when(){return s()?.timestamp},get children(){var ye=P$(),de=ye.firstChild,ge=de.nextSibling;return ge.nextSibling,ye.style.setProperty("margin-left","8px"),ye.style.setProperty("color","#888"),a(ye,()=>new Date(s().timestamp).toLocaleTimeString(),ge),ye}}),null),we(ye=>y(q,re(s()?.status||"unknown"),ye)),se})(),D(Ge,{get when(){return s()?.error},get children(){var se=c0();return se.style.setProperty("font-size","11px"),se.style.setProperty("color","#ff6666"),se.style.setProperty("margin-top","4px"),a(se,()=>s().error),se}})]}}),null),a(M,D(zt,{get each(){return Object.entries(i())},children:([se,q])=>(()=>{var ue=$$(),ye=ue.firstChild,de=ye.firstChild,ge=ye.nextSibling;return y(ue,Z),ye.style.setProperty("text-transform","capitalize"),a(ye,se,de),ge.style.setProperty("color","#00ff00"),a(ge,q),ue})()}),null),Y.$$click=h,Q.$$click=m,J.style.setProperty("margin-top","8px"),V.$$click=f,a(I,D(Ge,{get when(){return r()!=="fake"},get children(){var se=x$();return se.style.setProperty("font-size","11px"),se.style.setProperty("color","#888"),se.style.setProperty("margin-top","4px"),se}}),null),ce.style.setProperty("font-size","11px"),ce.style.setProperty("color","#888"),ce.style.setProperty("line-height","1.4"),a($,D(Ge,{get when(){return c()},get children(){var se=A$(),q=se.firstChild;return se.style.setProperty("position","absolute"),se.style.setProperty("top","0"),se.style.setProperty("left","0"),se.style.setProperty("right","0"),se.style.setProperty("bottom","0"),se.style.setProperty("background","rgba(0,0,0,0.7)"),se.style.setProperty("display","flex"),se.style.setProperty("align-items","center"),se.style.setProperty("justify-content","center"),se.style.setProperty("border-radius","8px"),q.style.setProperty("color","#fff"),q.style.setProperty("font-size","14px"),se}}),null),we(se=>{var q={...C,padding:"4px 8px"},ue=oe,ye=te,de=r()==="fake"?j:C,ge=c(),xe=r()==="real"?j:C,pe=c(),_e=r()==="hybrid"?j:C,Re=c(),Ee=oe,Te=te,Le=oe,Ie=te,De=oe,Ye=te,Be=C,We=c(),Ke=C,st=c(),nt={...C,background:"#cc4400","border-color":"#cc4400"},He=c()||r()!=="fake",mt=te;return se.e=y(_,q,se.e),se.t=y(P,ue,se.t),se.a=y(b,ye,se.a),se.o=y(K,de,se.o),ge!==se.i&&(K.disabled=se.i=ge),se.n=y(R,xe,se.n),pe!==se.s&&(R.disabled=se.s=pe),se.h=y(k,_e,se.h),Re!==se.r&&(k.disabled=se.r=Re),se.d=y(le,Ee,se.d),se.l=y(L,Te,se.l),se.u=y(M,Le,se.u),se.c=y(G,Ie,se.c),se.w=y(I,De,se.w),se.m=y(F,Ye,se.m),se.f=y(Y,Be,se.f),We!==se.y&&(Y.disabled=se.y=We),se.g=y(Q,Ke,se.g),st!==se.p&&(Q.disabled=se.p=st),se.b=y(V,nt,se.b),He!==se.T&&(V.disabled=se.T=He),se.A=y(ee,mt,se.A),se},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),$}}),null),we($=>y(E,w,$)),E})()};pr(["click"]);const T$=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",accountType:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",accountType:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",accountType:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",accountType:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",accountType:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",accountType:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",accountType:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",accountType:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",accountType:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",accountType:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",accountType:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",accountType:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",accountType:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",accountType:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",accountType:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",accountType:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",accountType:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",accountType:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",accountType:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],k$=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[Qo,Kc]=Ce(T$),[ef,N$]=Ce(k$),$r={get accounts(){return Qo()},get transactions(){return ef()},parseAccount(t){return{id:t?.code||t.id,accountNumber:t?.code||t.accountNumber,name:t.name,type:t.type,accountType:t.accountType,category:t.category||t.type,description:t.description,isActive:!0,accountId:t?.accountId}},updAccount(t){Kc(t.map($r.parseAccount))},fetchAllAccount(t){const e={...t,id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return Kc([...Qo(),e]),e},async addAccount(t){const e={...t,accountId:Yh(),id:Date.now().toString(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};let r=await qh.create(e);return console.log(r),Kc([...Qo(),e]),e},async updateAccountServer(t,e){let r=await qh.update(t,e);$r.updateAccount(t,e),console.log(r,t,e)},updateAccount(t,e){Kc(Qo().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){Kc(Qo().filter(e=>e.id!==t))},getAccountById(t){return Qo().find(e=>e.id===t)},getAccountsByType(t){return Qo().filter(e=>e.type===t)},getAccountTransactions(t){return ef().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};N$([...ef(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return Qo().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return Qo().filter(e=>e.parentAccountId===t)},getParentAccounts(){return Qo().filter(t=>!t.parentAccountId)},getAccountHierarchy(){return this.getParentAccounts().map(e=>({...e,subAccounts:this.getSubAccounts(e.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const i=this.getAccountById(n.parentAccountId);if(i)r.unshift(i),n=i;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((i,o)=>i+this.getTotalBalanceWithSubAccounts(o.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var ha=he("<div>"),Jc=he("<div> ");const L$=()=>{const{t}=Zt(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},i=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),o=$r.getTotalByType("Asset"),s=$r.getTotalByType("Liability"),l=$r.getTotalByType("Equity"),c=$r.getTotalByType("Revenue"),u=$r.getTotalByType("Expense"),h=$r.getAccountsByType("Asset").length,m=$r.getAccountsByType("Liability").length,g=$r.getAccountsByType("Equity").length,f=$r.getAccountsByType("Revenue").length,w=$r.getAccountsByType("Expense").length;return(()=>{var x=ha();return y(x,e),a(x,D(Dt,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var S=ha();return a(S,()=>i(o)),we(C=>y(S,r,C)),S})(),(()=>{var S=Jc(),C=S.firstChild;return a(S,h,C),a(S,()=>t("navigation.accounts"),null),we(j=>y(S,n,j)),S})()]}}),null),a(x,D(Dt,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var S=ha();return a(S,()=>i(s)),we(C=>y(S,r,C)),S})(),(()=>{var S=Jc(),C=S.firstChild;return a(S,m,C),a(S,()=>t("navigation.accounts"),null),we(j=>y(S,n,j)),S})()]}}),null),a(x,D(Dt,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var S=ha();return a(S,()=>i(l)),we(C=>y(S,r,C)),S})(),(()=>{var S=Jc(),C=S.firstChild;return a(S,g,C),a(S,()=>t("navigation.accounts"),null),we(j=>y(S,n,j)),S})()]}}),null),a(x,D(Dt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var S=ha();return a(S,()=>i(c)),we(C=>y(S,r,C)),S})(),(()=>{var S=Jc(),C=S.firstChild;return a(S,f,C),a(S,()=>t("navigation.accounts"),null),we(j=>y(S,n,j)),S})()]}}),null),a(x,D(Dt,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var S=ha();return a(S,()=>i(u)),we(C=>y(S,r,C)),S})(),(()=>{var S=Jc(),C=S.firstChild;return a(S,w,C),a(S,()=>t("navigation.accounts"),null),we(j=>y(S,n,j)),S})()]}}),null),a(x,D(Dt,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var S=ha();return a(S,()=>i(c-u)),we(C=>y(S,{...r,color:c-u>=0?"#4caf50":"#f44336"},C)),S})(),(()=>{var S=ha();return a(S,()=>c-u>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),we(C=>y(S,n,C)),S})()]}}),null),x})()};var R$=he("<div><div></div><div>"),D$=he("<h3>"),Qc=he("<div>");const M$=t=>{const{t:e}=Zt();Um();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},i={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},s={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},l={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},u=g=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[g]||{bg:"#f5f5f5",color:"#666"},h=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g),m=u(t.account.accountType);return D(Dt,{get children(){return[(()=>{var g=R$(),f=g.firstChild,w=f.nextSibling;return y(g,n),y(f,i),a(f,()=>t.account.accountNumber),a(w,()=>e(`accounts.types.${t.account.accountType.toLowerCase()}`)),we(x=>y(w,{...o,background:m.bg,color:m.color},x)),g})(),(()=>{var g=D$();return g.style.setProperty("margin","0 0 0.5rem 0"),g.style.setProperty("font-size","1.1rem"),a(g,()=>t.account.name),g})(),(()=>{var g=Qc();return y(g,l),a(g,()=>t.account.category),g})(),(()=>{var g=Qc();return y(g,s),a(g,()=>h(t.account.balance)),g})(),(()=>{var g=Qc();return y(g,c),a(g,()=>t.account.description),g})(),$e(()=>$e(()=>!t.account.isActive)()&&(()=>{var g=Qc();return g.style.setProperty("margin-top","0.5rem"),g.style.setProperty("padding","0.25rem 0.75rem"),g.style.setProperty("border-radius","9999px"),g.style.setProperty("font-size","0.75rem"),g.style.setProperty("font-weight","500"),g.style.setProperty("background","#ffebee"),g.style.setProperty("color","#d32f2f"),g.style.setProperty("text-align","center"),a(g,()=>e("common.inactive")),g})()),(()=>{var g=Qc();return y(g,r),a(g,D(ht,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[$e(()=>e("common.view"))," ",$e(()=>e("accounts.accountDetails"))]}})),g})()]}})};var F$=he("<div><div></div><div>"),O$=he("<div><div><div><div></div><h3>"),B$=he("<div>"),j$=he("<button>"),V$=he("<div><h4> (<!>)"),q$=he("<div><div><div></div><div>  </div></div><div>");const z$=t=>{const{t:e}=Zt(),r=Um(),[n,i]=Ce(!0),o={"margin-bottom":"1rem"},s={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},l={display:"flex","align-items":"center",gap:"1rem"},c={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},u={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},h={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},m={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},g={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},f={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},w={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},x={flex:"1"},S={"font-weight":"500","margin-bottom":"0.25rem"},C={"font-size":"0.875rem",color:"var(--text-muted)"},j={"font-weight":"600",color:"var(--primary-color)"},oe={display:"flex",gap:"0.5rem"},te=B=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[B]||{bg:"#f5f5f5",color:"#666"},Z=B=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(B),re=B=>{t.onViewDetails?t.onViewDetails(B):r(`/accounts/${B.id}`)},E=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},$=t.account.balance+t.account.subAccounts.reduce((B,_)=>B+_.balance,0),T=te(t.account.accountType);return D(Dt,{className:"account-hierarchy-card",style:o,get children(){return[(()=>{var B=O$(),_=B.firstChild,P=_.firstChild,b=P.firstChild,H=b.nextSibling;return y(B,s),y(_,l),a(_,(()=>{var K=$e(()=>t.account.subAccounts.length>0);return()=>K()&&(()=>{var R=j$();return R.addEventListener("mouseleave",k=>k.target.style.background="none"),R.addEventListener("mouseenter",k=>k.target.style.background="var(--background-color)"),R.$$click=()=>i(!n()),y(R,c),a(R,()=>n()?"":""),R})()})(),P),P.$$click=()=>re(t.account),P.style.setProperty("cursor","pointer"),y(b,u),a(b,()=>t.account.accountNumber),y(H,h),a(H,()=>t.account.name),a(B,D(Ge,{get when(){return t?.account?.accountType},get children(){var K=F$(),R=K.firstChild,k=R.nextSibling;return K.style.setProperty("text-align","right"),y(R,m),a(R,()=>Z($||0)),a(k,()=>e(`accounts.types.${t?.account?.accountType?.toLowerCase()}`)),we(W=>y(k,{...g,background:T.bg,color:T.color},W)),K}}),null),B})(),(()=>{var B=B$();return y(B,oe),a(B,D(ht,{variant:"secondary",size:"sm",onClick:()=>re(t.account),get children(){return[$e(()=>e("common.view"))," ",$e(()=>e("accounts.accountDetails"))]}}),null),a(B,D(ht,{variant:"outline",size:"sm",onClick:E,get children(){return[$e(()=>e("common.add"))," ",$e(()=>e("accounts.subAccounts"))]}}),null),B})(),$e(()=>$e(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var B=V$(),_=B.firstChild,P=_.firstChild,b=P.nextSibling;return b.nextSibling,y(B,f),_.style.setProperty("margin","0 0 1rem 0"),_.style.setProperty("font-size","1rem"),_.style.setProperty("color","var(--text-muted)"),a(_,()=>e("accounts.subAccounts"),P),a(_,()=>t.account.subAccounts.length,b),a(B,()=>t.account.subAccounts.map(H=>(()=>{var K=q$(),R=K.firstChild,k=R.firstChild,W=k.nextSibling,z=W.firstChild,U=R.nextSibling;return K.addEventListener("mouseleave",le=>{le.currentTarget.style.background="var(--background-color)",le.currentTarget.style.transform="translateY(0)"}),K.addEventListener("mouseenter",le=>{le.currentTarget.style.background="var(--surface-color)",le.currentTarget.style.transform="translateY(-1px)"}),K.$$click=()=>re(H),y(K,w),y(R,x),y(k,S),a(k,()=>H.name),y(W,C),a(W,()=>H.accountNumber,z),a(W,()=>H.description,null),y(U,j),a(U,()=>Z(H.balance)),K})()),null),B})())]}})};pr(["click"]);var U$=he("<form><div>");const H$=t=>{const{t:e}=Zt(),[r,n]=Ce({accountNumber:"",name:"",accountType:"",category:"",type:"",classification:"",description:"",balance:"0",isActive:"true"}),i=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],o=()=>{const h=r().accountType;return h?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[h]||[]:[]},s=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],l={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c=h=>{h.preventDefault();const m=r();if(!m.accountNumber||!m.name||!m.accountType||!m.category){alert(e("forms.requiredField"));return}const g=$r.accounts.find(x=>x.accountNumber===m.accountNumber),f=i.find(x=>x.value===m.accountType);if(g){alert(e("forms.duplicateAccountNumber"));return}const w={accountNumber:m.accountNumber,name:m.name,accountType:"",classification:f?.classification,type:f?.type,category:m.category,description:m.description,balance:parseFloat(m.balance)||0,isActive:m.isActive==="true"};$r.addAccount(w),n({accountNumber:"",name:"",accountType:"",type:"",category:"",description:"",classification:"",balance:"0",isActive:"true"}),t.onClose()},u=(h,m)=>{n(g=>{const f={...g,[h]:m};return h==="type"&&(f.category=""),f})};return D(qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var h=U$(),m=h.firstChild;return h.addEventListener("submit",c),a(h,D(Ar,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:g=>u("accountNumber",g),get placeholder(){return e("accounts.accountNumber")},required:!0}),m),a(h,D(Ar,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:g=>u("name",g),get placeholder(){return e("accounts.accountName")},required:!0}),m),a(h,D(An,{get label(){return e("accounts.accountType")},get value(){return r().accountType},onChange:g=>u("accountType",g),options:i,required:!0}),m),a(h,D(An,{get label(){return e("accounts.category")},get value(){return r().category},onChange:g=>u("category",g),get options(){return o()},required:!0}),m),a(h,D(Ar,{get label(){return e("common.description")},get value(){return r().description},onChange:g=>u("description",g),get placeholder(){return e("common.description")}}),m),a(h,D(Ar,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:g=>u("balance",g),get placeholder(){return e("accounts.balance")}}),m),a(h,D(An,{get label(){return e("common.status")},get value(){return r().isActive},onChange:g=>u("isActive",g),options:s,required:!0}),m),y(m,l),a(m,D(ht,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(m,D(ht,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),h}})};var G$=he("<form><div>"),W$=he("<div><div></div><div> - </div><div>  ");const Y$=t=>{const{t:e}=Zt(),[r,n]=Ce({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"});e("accounts.types.asset"),e("accounts.types.liability"),e("accounts.types.equity"),e("accounts.types.revenue"),e("accounts.types.expense");const i=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},s={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},l={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},c={"font-weight":"600",color:"var(--text-primary)"},u={"font-size":"0.875rem",color:"var(--text-secondary)"},h=w=>{w.preventDefault();const x=r();if(console.log(x),!x.accountNumber||!x.name||!t.parentAccount){alert(e("forms.requiredField"));return}const S=$r.accounts.find(j=>j.accountNumber===x.accountNumber);if(console.log(S),S){alert(e("forms.duplicateAccountNumber"));return}const C={accountNumber:x.accountNumber,name:x.name,description:x.description,accountType:t.parentAccount.accountType,category:t.parentAccount.category,classification:t.parentAccount?.classification,type:t.parentAccount?.type,isActive:x.isActive==="true",parentAccountId:t.parentAccount.id};$r.addAccount(C),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},m=(w,x)=>{n(S=>({...S,[w]:x}))},g=()=>{if(!t.parentAccount)return"";const w=t.parentAccount.accountNumber,S=$r.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(w)+S).toString()},f=()=>r().accountNumber===""&&t.parentAccount?g():r().accountNumber;return D(qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[$e(()=>$e(()=>!!t.parentAccount)()&&(()=>{var w=W$(),x=w.firstChild,S=x.nextSibling,C=S.firstChild,j=S.nextSibling,oe=j.firstChild;return y(w,s),y(x,l),a(x,()=>e("accounts.parentAccount")),y(S,c),a(S,()=>t.parentAccount.accountNumber,C),a(S,()=>t.parentAccount.name,null),y(j,u),a(j,()=>e(`accounts.types.${t.parentAccount?.accountType?.toLowerCase()}`),oe),a(j,()=>t.parentAccount.category,null),w})()),(()=>{var w=G$(),x=w.firstChild;return w.addEventListener("submit",h),a(w,D(Ar,{get label(){return e("accounts.accountNumber")},get value(){return f()},onChange:S=>m("accountNumber",S),get placeholder(){return`${e("common.suggested")}: ${g()}`},required:!0}),x),a(w,D(Ar,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:S=>m("name",S),get placeholder(){return e("accounts.accountName")},required:!0}),x),a(w,D(Ar,{get label(){return e("common.description")},get value(){return r().description},onChange:S=>m("description",S),get placeholder(){return e("common.description")}}),x),a(w,D(Ar,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:S=>m("balance",S),get placeholder(){return e("accounts.balance")}}),x),a(w,D(An,{get label(){return e("common.status")},get value(){return r().isActive},onChange:S=>m("isActive",S),options:i,required:!0}),x),y(x,o),a(x,D(ht,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(x,D(ht,{variant:"primary",type:"submit",get children(){return[$e(()=>e("common.add"))," ",$e(()=>e("accounts.subAccounts"))]}}),null),w})()]}})};var K$=he("<form><div>"),J$=he("<div>");const Q$=t=>{const{t:e}=Zt(),[r,n]=Ce({accountNumber:"",name:"",type:"",accountType:"",category:"",description:"",isActive:"true"}),[i,o]=Ce(null);Ei(()=>{t.account&&(console.log(t.account),n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,accountType:t.account.accountType,category:t.account.category,description:t.account.description,isActive:t.account.isActive.toString()}),o(null))});const s=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],l=()=>{const f=r().accountType;return f?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[f]||[]:[]},c=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h=f=>{if(f.preventDefault(),o(null),!t.account)return;const w=r();if(!w.accountNumber||!w.name||!w.type||!w.category){o(e("forms.requiredField"));return}if($r.accounts.find(j=>j.accountNumber===w.accountNumber&&j.id!==t.account.id)){o(e("forms.duplicateAccountNumber"));return}const S={accountNumber:w.accountNumber,name:w.name,type:w.type,accountType:w.accountType,category:w.category,description:w.description,isActive:w.isActive==="true"};console.log({data:w,updatedAccount:S});let C=wP(Object.keys(t.account),S,t.account,{accountId:1,id:1});try{$r.updateAccountServer(t.account?.accountId,C.data),t.onClose()}catch(j){o(j instanceof Error?j.message:e("forms.saveError"))}},m=()=>{if(!t.account)return;const f=$r.canDeleteAccount(t.account.id);if(!f.canDelete){o(f.reason||e("forms.deleteError"));return}const w=e("forms.confirmDelete");if(confirm(w))try{$r.deleteAccount(t.account.id),t.onClose()}catch(x){o(x instanceof Error?x.message:e("forms.deleteError"))}},g=(f,w)=>{n(x=>{const S={...x,[f]:w};return f==="type"&&(S.category=""),S}),i()&&o(null)};return t.account?D(qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var f=K$(),w=f.firstChild;return f.addEventListener("submit",h),a(f,D(Ar,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:x=>g("accountNumber",x),get placeholder(){return e("accounts.accountNumber")},required:!0}),w),a(f,D(Ar,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:x=>g("name",x),get placeholder(){return e("accounts.accountName")},required:!0}),w),a(f,D(An,{get label(){return e("accounts.accountType")},get value(){return r().accountType},onChange:x=>g("accountType",x),options:s,required:!0}),w),a(f,D(An,{get label(){return e("accounts.category")},get value(){return r().category},onChange:x=>g("category",x),get options(){return l()},required:!0}),w),a(f,D(Ar,{get label(){return e("common.description")},get value(){return r().description},onChange:x=>g("description",x),get placeholder(){return e("common.description")}}),w),a(f,D(An,{get label(){return e("common.status")},get value(){return r().isActive},onChange:x=>g("isActive",x),options:c,required:!0}),w),a(f,(()=>{var x=$e(()=>!!i());return()=>x()&&(()=>{var S=J$();return S.style.setProperty("padding","1rem"),S.style.setProperty("border-radius","var(--border-radius-sm)"),S.style.setProperty("margin-top","1rem"),S.style.setProperty("background","#f8d7da"),S.style.setProperty("color","#721c24"),S.style.setProperty("border","1px solid #f5c6cb"),a(S,i),S})()})(),w),y(w,u),a(w,D(ht,{variant:"outline",type:"button",onClick:m,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),a(w,D(ht,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(w,D(ht,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),f}}):null};var X$=he("<div><div></div><div></div><div></div><div>"),Dd=he("<div>"),Z$=he("<div><div></div><div>"),eE=he("<div><button></button><button> (<!>)"),tE=he("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),rE=he("<div><div><div></div><div>  </div></div><div>");const nE=t=>{const{t:e}=Zt(),[r,n]=Ce("details"),[i,o]=Ce(!1),s=Lt(()=>t.account?$r.getAccountById(t.account.id)||t.account:null),l={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},c={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},u={"font-weight":"600",color:"var(--text-primary)"},h={"text-align":"center","margin-bottom":"2rem"},m={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},g={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},f={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},w={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},x=T=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:T?"var(--primary-color)":"var(--text-muted)","border-bottom":T?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),S={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},C={flex:"1"},j={"font-size":"0.875rem",color:"var(--text-muted)"},oe={"font-weight":"500","margin-bottom":"0.25rem"},te=T=>({"font-weight":"600",color:T==="debit"?"#4caf50":"#f44336"}),Z={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},re=T=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[T]||{bg:"#f5f5f5",color:"#666"},E=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),$=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return D(qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[$e(()=>$e(()=>!s())()?(()=>{var T=X$(),B=T.firstChild,_=B.nextSibling,P=_.nextSibling,b=P.nextSibling;return T.style.setProperty("text-align","center"),T.style.setProperty("padding","3rem"),T.style.setProperty("color","var(--text-muted)"),B.style.setProperty("font-size","1.5rem"),B.style.setProperty("margin-bottom","1rem"),_.style.setProperty("font-size","1.1rem"),_.style.setProperty("margin-bottom","0.5rem"),a(_,()=>e("common.error")),P.style.setProperty("font-size","0.875rem"),a(P,()=>e("common.noDataFound")),b.style.setProperty("margin-top","2rem"),a(b,D(ht,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),T})():(()=>{const T=Lt(()=>re(s().accountType)),B=Lt(()=>$r.getAccountTransactions(s().id));return[(()=>{var _=Z$(),P=_.firstChild,b=P.nextSibling;return y(_,h),y(P,m),a(P,()=>s().name),y(b,g),a(b,()=>E(s().balance||0)),a(_,D(Ge,{get when(){return s().accountType},get children(){var H=Dd();return a(H,()=>e(`accounts.types.${s().accountType?.toLowerCase()}`)),we(K=>y(H,{...f,background:T().bg,color:T().color},K)),H}}),null),_})(),(()=>{var _=eE(),P=_.firstChild,b=P.nextSibling,H=b.firstChild,K=H.nextSibling;return K.nextSibling,y(_,w),P.$$click=()=>n("details"),a(P,()=>e("accounts.accountDetails")),b.$$click=()=>n("transactions"),a(b,()=>e("accounts.transactions"),H),a(b,()=>B().length,K),we(R=>{var k=x(r()==="details"),W=x(r()==="transactions");return R.e=y(P,k,R.e),R.t=y(b,W,R.t),R},{e:void 0,t:void 0}),_})(),$e(()=>$e(()=>r()==="details")()&&(()=>{var _=tE(),P=_.firstChild,b=P.firstChild,H=b.nextSibling,K=P.nextSibling,R=K.firstChild,k=R.nextSibling,W=K.nextSibling,z=W.firstChild,U=z.nextSibling,le=W.nextSibling,L=le.firstChild,M=L.nextSibling,G=le.nextSibling,I=G.firstChild,F=I.nextSibling,X=G.nextSibling,Y=X.firstChild,Q=Y.nextSibling;return a(b,()=>e("accounts.accountNumber")),a(H,()=>s().accountNumber),a(R,()=>e("accounts.category")),a(k,()=>s().category),a(z,()=>e("common.description")),a(U,()=>s().description),a(L,()=>e("common.status")),a(M,(()=>{var J=$e(()=>!!s().isActive);return()=>J()?e("common.active"):e("common.inactive")})()),a(I,()=>e("accounts.createdDate")),a(F,()=>$(s().createdDate)),a(Y,()=>e("accounts.lastModified")),a(Q,()=>$(s().lastModified)),we(J=>{var V=l,ne=c,ee=u,ce=l,se=c,q=u,ue=l,ye=c,de=u,ge=l,xe=c,pe=u,_e=l,Re=c,Ee=u,Te=l,Le=c,Ie=u;return J.e=y(P,V,J.e),J.t=y(b,ne,J.t),J.a=y(H,ee,J.a),J.o=y(K,ce,J.o),J.i=y(R,se,J.i),J.n=y(k,q,J.n),J.s=y(W,ue,J.s),J.h=y(z,ye,J.h),J.r=y(U,de,J.r),J.d=y(le,ge,J.d),J.l=y(L,xe,J.l),J.u=y(M,pe,J.u),J.c=y(G,_e,J.c),J.w=y(I,Re,J.w),J.m=y(F,Ee,J.m),J.f=y(X,Te,J.f),J.y=y(Y,Le,J.y),J.g=y(Q,Ie,J.g),J},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),_})()),$e(()=>$e(()=>r()==="transactions")()&&(()=>{var _=Dd();return a(_,(()=>{var P=$e(()=>B().length===0);return()=>P()?(()=>{var b=Dd();return b.style.setProperty("text-align","center"),b.style.setProperty("color","var(--text-muted)"),b.style.setProperty("padding","2rem"),a(b,()=>e("common.noDataFound")),b})():B().map(b=>(()=>{var H=rE(),K=H.firstChild,R=K.firstChild,k=R.nextSibling,W=k.firstChild,z=K.nextSibling;return y(H,S),y(K,C),y(R,oe),a(R,()=>b.description),y(k,j),a(k,()=>$(b.date),W),a(k,()=>b.reference,null),a(z,()=>b.type==="debit"?"+":"-",null),a(z,()=>E(b.type==="debit"?b.debitAmount:b.creditAmount),null),we(U=>y(z,te(b.type),U)),H})())})()),_})()),(()=>{var _=Dd();return y(_,Z),a(_,D(ht,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(_,D(ht,{variant:"primary",onClick:()=>o(!0),get children(){return e("accounts.editAccount")}}),null),_})()]})()),$e(()=>$e(()=>!!s())()&&D(Q$,{get isOpen(){return i()},onClose:()=>{o(!1)},get account(){return s()}}))]}})};pr(["click"]);var iE=he("<div><h2></h2><div><span>:</span><button></button><button>"),oE=he("<div><span>:"),u0=he("<div>"),sE=he("<button>");const aE=()=>{const{t}=Zt(),[e,r]=Ce(!1),[n,i]=Ce(!1),[o,s]=Ce(!1),[l,c]=Ce(null),[u,h]=Ce(null),[m,g]=Ce("All"),[f,w]=Ce("hierarchy"),x=T=>{c(T),s(!0)},S=T=>{h(T),i(!0)},C=()=>m()==="All"?f()==="hierarchy"?$r.getAccountHierarchy():$r.accounts:f()==="hierarchy"?$r.getAccountHierarchy().filter(T=>T.accountType===m()):$r.getAccountsByType(m()),j={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},oe={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},te=T=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:T?"var(--primary-color)":"var(--surface-color)",color:T?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),Z={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},re={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},E=T=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:T?"var(--primary-color)":"var(--surface-color)",color:T?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),$=async()=>{let T=await qh.getAlls("acc");$r.updAccount(Object.values(T))};return Cn(()=>{$()}),D(lo,{get title(){return t("accounts.title")},get children(){return[D(L$,{}),(()=>{var T=iE(),B=T.firstChild,_=B.nextSibling,P=_.firstChild,b=P.firstChild,H=P.nextSibling,K=H.nextSibling;return y(T,Z),B.style.setProperty("margin","0"),B.style.setProperty("font-size","1.5rem"),a(B,()=>t("accounts.title")),y(_,re),P.style.setProperty("font-weight","500"),P.style.setProperty("color","var(--text-muted)"),P.style.setProperty("font-size","0.875rem"),a(P,()=>t("common.view"),b),H.$$click=()=>w("hierarchy"),a(H,()=>t("accounts.accountHierarchy")),K.$$click=()=>{w("flat"),qh.getAlls("iDP")},a(K,()=>t("common.all")),a(T,D(ht,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),we(R=>{var k=E(f()==="hierarchy"),W=E(f()==="flat");return R.e=y(H,k,R.e),R.t=y(K,W,R.t),R},{e:void 0,t:void 0}),T})(),(()=>{var T=oE(),B=T.firstChild,_=B.firstChild;return y(T,oe),B.style.setProperty("font-weight","500"),B.style.setProperty("color","var(--text-muted)"),a(B,()=>t("common.filter"),_),a(T,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((P,b)=>{const K=["All","Asset","Liability","Equity","Revenue","Expense"][b];return(()=>{var R=sE();return R.$$click=()=>g(K),a(R,P),we(k=>y(R,te(m()===K),k)),R})()}),null),T})(),(()=>{var T=u0();return a(T,(()=>{var B=$e(()=>f()==="hierarchy");return()=>B()?C().map(_=>D(z$,{account:_,onAddSubAccount:S,onViewDetails:x})):C().map(_=>D(M$,{account:_,onViewDetails:x}))})()),we(B=>y(T,f()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:j,B)),T})(),$e(()=>$e(()=>C().length===0)()&&(()=>{var T=u0();return T.style.setProperty("text-align","center"),T.style.setProperty("color","var(--text-muted)"),T.style.setProperty("padding","3rem"),T.style.setProperty("font-size","1.1rem"),a(T,()=>t("common.noDataFound")),T})()),D(H$,{get isOpen(){return e()},onClose:()=>r(!1)}),D(Y$,{get isOpen(){return n()},onClose:()=>i(!1),get parentAccount(){return u()}}),D(nE,{get isOpen(){return o()},onClose:()=>s(!1),get account(){return l()}})]}})};pr(["click"]);var lE=he("<div><h2>"),ec=he("<div>"),cE=he("<div><div><div></div><h1></h1><div></div></div><div>"),uE=he("<div><button></button><button> (<!>)"),Md=he("<div><span></span><span>"),dE=he("<p>"),hE=he("<div><div></div><div>"),pE=he("<div><div><div></div><div>  </div></div><div>");const fE=()=>{const{t}=Zt(),e=QS(),r=Um(),[n,i]=Ce(null),[o,s]=Ce("overview");Cn(()=>{const b=$r.getAccountById(e.id);b?i(b):r("/accounts")});const l={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},u={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},h={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},m={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},g={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},f=b=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:b?"var(--primary-color)":"var(--text-muted)","border-bottom":b?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),w={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},x={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},S={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},C={"font-weight":"500",color:"var(--text-muted)"},j={"font-weight":"600",color:"var(--text-primary)"},oe={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},te={flex:"1"},Z={"font-weight":"500","margin-bottom":"0.25rem"},re={"font-size":"0.875rem",color:"var(--text-muted)"},E=b=>({"font-weight":"600",color:b==="debit"?"#4caf50":"#f44336"});if(!n())return D(lo,{get title(){return t("accounts.accountDetails")},get children(){var b=lE(),H=b.firstChild;return b.style.setProperty("text-align","center"),b.style.setProperty("padding","3rem"),a(H,()=>t("common.error")),a(b,D(ht,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[$e(()=>t("common.back"))," ",$e(()=>t("navigation.accounts"))]}}),null),b}});const $=b=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[b]||{bg:"#f5f5f5",color:"#666"},T=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(b),B=b=>new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),_=$(n().accountType),P=$r.getAccountTransactions(n().id);return D(lo,{get title(){return n().name},get children(){return[(()=>{var b=ec();return y(b,l),a(b,D(ht,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return[" ",$e(()=>t("common.back"))," ",$e(()=>t("navigation.accounts"))]}})),b})(),(()=>{var b=cE(),H=b.firstChild,K=H.firstChild,R=K.nextSibling,k=R.nextSibling,W=H.nextSibling;return y(b,c),y(K,u),a(K,()=>n().accountNumber),R.style.setProperty("margin","0.5rem 0"),R.style.setProperty("font-size","2rem"),a(R,()=>n().name),y(k,h),a(k,()=>T(n().balance)),a(W,()=>n().accountType),we(z=>y(W,{...m,background:_.bg,color:_.color},z)),b})(),(()=>{var b=uE(),H=b.firstChild,K=H.nextSibling,R=K.firstChild,k=R.nextSibling;return k.nextSibling,y(b,g),H.$$click=()=>s("overview"),a(H,()=>t("dashboard.overview")),K.$$click=()=>s("transactions"),a(K,()=>t("accounts.transactions"),R),a(K,()=>P.length,k),we(W=>{var z=f(o()==="overview"),U=f(o()==="transactions");return W.e=y(H,z,W.e),W.t=y(K,U,W.t),W},{e:void 0,t:void 0}),b})(),$e(()=>$e(()=>o()==="overview")()&&(()=>{var b=hE(),H=b.firstChild,K=H.nextSibling;return y(H,w),a(H,D(Dt,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var R=ec();return R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","600"),R.style.setProperty("color","var(--primary-color)"),a(R,()=>T(n().balance)),R}}),null),a(H,D(Dt,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var R=ec();return R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","600"),R.style.setProperty("color","var(--primary-color)"),a(R,()=>t(`accounts.types.${n().accountType?.toLowerCase()}`)),R}}),null),a(H,D(Dt,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var R=ec();return R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","600"),a(R,(()=>{var k=$e(()=>!!n().isActive);return()=>k()?t("common.active"):t("common.inactive")})()),we(k=>(k=n().isActive?"#4caf50":"#f44336")!=null?R.style.setProperty("color",k):R.style.removeProperty("color")),R}}),null),a(H,D(Dt,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var R=ec();return R.style.setProperty("font-size","1.5rem"),R.style.setProperty("font-weight","600"),R.style.setProperty("color","var(--primary-color)"),a(R,()=>P.length),R}}),null),y(K,x),a(K,D(Dt,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var R=Md(),k=R.firstChild,W=k.nextSibling;return a(k,()=>t("accounts.accountNumber")),a(W,()=>n().accountNumber),we(z=>{var U=S,le=C,L=j;return z.e=y(R,U,z.e),z.t=y(k,le,z.t),z.a=y(W,L,z.a),z},{e:void 0,t:void 0,a:void 0}),R})(),(()=>{var R=Md(),k=R.firstChild,W=k.nextSibling;return a(k,()=>t("accounts.category")),a(W,()=>n().category),we(z=>{var U=S,le=C,L=j;return z.e=y(R,U,z.e),z.t=y(k,le,z.t),z.a=y(W,L,z.a),z},{e:void 0,t:void 0,a:void 0}),R})(),(()=>{var R=Md(),k=R.firstChild,W=k.nextSibling;return a(k,()=>t("common.date")),a(W,()=>B(n().createdDate)),we(z=>{var U=S,le=C,L=j;return z.e=y(R,U,z.e),z.t=y(k,le,z.t),z.a=y(W,L,z.a),z},{e:void 0,t:void 0,a:void 0}),R})(),(()=>{var R=Md(),k=R.firstChild,W=k.nextSibling;return a(k,()=>t("common.date")),a(W,()=>B(n().lastModified)),we(z=>{var U=S,le=C,L=j;return z.e=y(R,U,z.e),z.t=y(k,le,z.t),z.a=y(W,L,z.a),z},{e:void 0,t:void 0,a:void 0}),R})()]}}),null),a(K,D(Dt,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var R=dE();return R.style.setProperty("margin","0"),R.style.setProperty("color","var(--text-secondary)"),a(R,()=>n().description||t("common.noDataFound")),R}}),null),b})()),$e(()=>$e(()=>o()==="transactions")()&&D(Dt,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return $e(()=>P.length===0)()?(()=>{var b=ec();return b.style.setProperty("text-align","center"),b.style.setProperty("color","var(--text-muted)"),b.style.setProperty("padding","2rem"),a(b,()=>t("common.noDataFound")),b})():P.map(b=>(()=>{var H=pE(),K=H.firstChild,R=K.firstChild,k=R.nextSibling,W=k.firstChild,z=K.nextSibling;return y(H,oe),y(K,te),y(R,Z),a(R,()=>b.description),y(k,re),a(k,()=>B(b.date),W),a(k,()=>b.reference,null),a(z,()=>b.type==="debit"?"+":"-",null),a(z,()=>T(b.type==="debit"?b.debitAmount:b.creditAmount),null),we(U=>y(z,E(b.type),U)),H})())}}))]}})};pr(["click"]);var mE=he("<div><div><h1></h1><p> </p></div><div><input type=date>"),Cs=he("<div><span></span><span>"),yE=he("<div><div></div><div>"),gE=he("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),vE=he("<div><div> (<!> = <!> + <!>)</div><div> = "),bE=he("<span>(<!>: <!>)");const _E=()=>{const{t}=Zt(),[e,r]=Ce(new Date().toISOString().split("T")[0]),[n,i]=Ce(0),[o,s]=Ce(0),[l,c]=Ce(0);Cn(()=>{u()});const u=()=>{const w=$r.getAccountsByType("Asset"),x=$r.getAccountsByType("Liability"),S=$r.getAccountsByType("Equity"),C=w.reduce((te,Z)=>te+Z.balance,0),j=x.reduce((te,Z)=>te+Z.balance,0),oe=S.reduce((te,Z)=>te+Z.balance,0);i(C),s(j),c(oe)},h=w=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(w),m={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},g={"margin-bottom":"2rem"},f={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return D(lo,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var w=mE(),x=w.firstChild,S=x.firstChild,C=S.nextSibling,j=C.firstChild,oe=x.nextSibling,te=oe.firstChild;return y(w,m),S.style.setProperty("margin","0"),a(S,()=>t("balanceSheet.title")),C.style.setProperty("margin","0.5rem 0 0 0"),C.style.setProperty("color","var(--text-muted)"),a(C,()=>t("balanceSheet.asOf"),j),a(C,()=>new Date(e()).toLocaleDateString(),null),oe.style.setProperty("display","flex"),oe.style.setProperty("gap","1rem"),te.addEventListener("change",Z=>r(Z.target.value)),te.style.setProperty("padding","0.5rem"),te.style.setProperty("border","1px solid var(--border-color)"),te.style.setProperty("border-radius","var(--border-radius-sm)"),a(oe,D(ht,{variant:"primary",onClick:u,get children(){return t("balanceSheet.generateReport")}}),null),we(()=>te.value=e()),w})(),(()=>{var w=yE(),x=w.firstChild,S=x.nextSibling;return w.style.setProperty("display","grid"),w.style.setProperty("grid-template-columns","1fr 1fr"),w.style.setProperty("gap","2rem"),a(x,D(Dt,{get title(){return t("balanceSheet.assets")},style:g,get children(){return[(()=>{var C=Cs(),j=C.firstChild,oe=j.nextSibling;return C.style.setProperty("display","flex"),C.style.setProperty("justify-content","space-between"),C.style.setProperty("align-items","center"),a(j,()=>t("balanceSheet.currentAssets")),a(oe,()=>h(n()*.6)),C})(),(()=>{var C=Cs(),j=C.firstChild,oe=j.nextSibling;return C.style.setProperty("display","flex"),C.style.setProperty("justify-content","space-between"),C.style.setProperty("align-items","center"),a(j,()=>t("balanceSheet.nonCurrentAssets")),a(oe,()=>h(n()*.4)),C})(),(()=>{var C=Cs(),j=C.firstChild,oe=j.nextSibling;return a(j,()=>t("balanceSheet.totalAssets")),a(oe,()=>h(n())),we(te=>y(C,{...f,display:"flex","justify-content":"space-between"},te)),C})()]}})),a(S,D(Dt,{get title(){return t("balanceSheet.liabilities")},style:g,get children(){return[(()=>{var C=Cs(),j=C.firstChild,oe=j.nextSibling;return C.style.setProperty("display","flex"),C.style.setProperty("justify-content","space-between"),C.style.setProperty("align-items","center"),a(j,()=>t("balanceSheet.currentLiabilities")),a(oe,()=>h(o()*.7)),C})(),(()=>{var C=Cs(),j=C.firstChild,oe=j.nextSibling;return C.style.setProperty("display","flex"),C.style.setProperty("justify-content","space-between"),C.style.setProperty("align-items","center"),a(j,()=>t("balanceSheet.nonCurrentLiabilities")),a(oe,()=>h(o()*.3)),C})(),(()=>{var C=Cs(),j=C.firstChild,oe=j.nextSibling;return a(j,()=>t("balanceSheet.totalLiabilities")),a(oe,()=>h(o())),we(te=>y(C,{...f,display:"flex","justify-content":"space-between"},te)),C})()]}}),null),a(S,D(Dt,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var C=Cs(),j=C.firstChild,oe=j.nextSibling;return C.style.setProperty("display","flex"),C.style.setProperty("justify-content","space-between"),C.style.setProperty("align-items","center"),a(j,()=>t("balanceSheet.commonStock")),a(oe,()=>h(l()*.8)),C})(),(()=>{var C=Cs(),j=C.firstChild,oe=j.nextSibling;return C.style.setProperty("display","flex"),C.style.setProperty("justify-content","space-between"),C.style.setProperty("align-items","center"),a(j,()=>t("balanceSheet.retainedEarnings")),a(oe,()=>h(l()*.2)),C})(),(()=>{var C=Cs(),j=C.firstChild,oe=j.nextSibling;return a(j,()=>t("balanceSheet.totalEquity")),a(oe,()=>h(l())),we(te=>y(C,{...f,display:"flex","justify-content":"space-between"},te)),C})()]}}),null),w})(),D(Dt,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var w=gE(),x=w.firstChild,S=x.firstChild,C=S.nextSibling,j=x.nextSibling,oe=j.firstChild,te=oe.nextSibling,Z=j.nextSibling,re=Z.firstChild,E=re.nextSibling;return w.style.setProperty("display","grid"),w.style.setProperty("grid-template-columns","repeat(3, 1fr)"),w.style.setProperty("gap","2rem"),x.style.setProperty("text-align","center"),S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("margin-bottom","0.5rem"),a(S,()=>t("balanceSheet.totalAssets")),C.style.setProperty("font-size","1.5rem"),C.style.setProperty("font-weight","bold"),C.style.setProperty("color","var(--primary-color)"),a(C,()=>h(n())),j.style.setProperty("text-align","center"),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),oe.style.setProperty("margin-bottom","0.5rem"),a(oe,()=>t("balanceSheet.totalLiabilities")),te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","bold"),te.style.setProperty("color","#f44336"),a(te,()=>h(o())),Z.style.setProperty("text-align","center"),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),re.style.setProperty("margin-bottom","0.5rem"),a(re,()=>t("balanceSheet.totalEquity")),E.style.setProperty("font-size","1.5rem"),E.style.setProperty("font-weight","bold"),E.style.setProperty("color","#4caf50"),a(E,()=>h(l())),w})(),(()=>{var w=vE(),x=w.firstChild,S=x.firstChild,C=S.nextSibling,j=C.nextSibling,oe=j.nextSibling,te=oe.nextSibling,Z=te.nextSibling;Z.nextSibling;var re=x.nextSibling,E=re.firstChild;return w.style.setProperty("margin-top","2rem"),w.style.setProperty("text-align","center"),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","var(--text-muted)"),x.style.setProperty("margin-bottom","0.5rem"),a(x,()=>t("common.total"),S),a(x,()=>t("balanceSheet.totalAssets"),C),a(x,()=>t("balanceSheet.totalLiabilities"),oe),a(x,()=>t("balanceSheet.totalEquity"),Z),re.style.setProperty("font-size","1.2rem"),re.style.setProperty("font-weight","bold"),a(re,()=>h(n()),E),a(re,()=>h(o()+l()),null),a(re,(()=>{var $=$e(()=>Math.abs(n()-(o()+l()))>.01);return()=>$()&&(()=>{var T=bE(),B=T.firstChild,_=B.nextSibling,P=_.nextSibling,b=P.nextSibling;return b.nextSibling,T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","#f44336"),T.style.setProperty("display","block"),a(T,()=>t("common.error"),_),a(T,()=>h(n()-(o()+l())),b),T})()})(),null),we($=>($=Math.abs(n()-(o()+l()))<.01?"#4caf50":"#f44336")!=null?re.style.setProperty("color",$):re.style.removeProperty("color")),w})()]}})]}})};pr(["click"]);const SE="modulepreload",PE=function(t){return"/"+t},d0={},Ji=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let s=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");i=s(r.map(u=>{if(u=PE(u),u in d0)return;d0[u]=!0;const h=u.endsWith(".css"),m=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${m}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":SE,h||(g.as="script"),g.crossOrigin="",g.href=u,c&&g.setAttribute("nonce",c),document.head.appendChild(g),h)return new Promise((f,w)=>{g.addEventListener("load",f),g.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(s){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s}return i.then(s=>{for(const l of s||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})},wE=[{id:"YY_8802",code:"YY_8802",name:"CENTER",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISSONNET",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",type:"store",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",type:"store",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",type:"store",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",type:"store",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",type:"store",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",type:"store",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_79",code:"YY_79",type:"warehouse",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",type:"store",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,type:"store",createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],xE=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],Fd=()=>{const t=new Map;return Hi().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=ct.getLocationById(e.locationId),i=t.get(r);i||(i={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,i)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(i.quantity+=e.quantity*1):e.movementType==="out"?i.quantity-=e.quantity*1:e.movementType==="adjustment"&&(i.quantity=e.quantity*1),new Date(e.createdDate)>new Date(i.lastMovementDate)&&(i.lastMovementDate=e.createdDate,i.lastMovementType=e.movementType),i.averageCost=e.unitCost*1,i.availableQuantity=i.quantity*1-i.reservedQuantity*1}),Array.from(t.values())},[il,tf]=Ce([]),[ol,h0]=Ce(wE),[Hi,Od]=Ce([]),[pa,Xc]=Ce([]),[Bd,rf]=Ce(xE),AE={TRANSFER:1,transfer:1},p0=173442384e4,ct={get products(){return il()},get locations(){return ol()},get movements(){return Hi()},get stockLevels(){return pa()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=i=>{let o=t;o[i]?.products&&o[i]?.products?.map(s=>{let l=SP(o[i]?.type),c=s?.price*1||s?.unitCost*1,u=s?.qty*1||s?.quantity*1;c=isNaN(c)?0:c,u=isNaN(u)?0:u;let h={id:o[i]?.ssg_inventory_key,productId:s?.product?.id,productName:s?.product?.label,productSku:s?.product?.code,locationId:o[i]?.store,locationName:o[i]?.store,location:o[i]?.store,movementType:l,quantity:u,unitCost:c,totalCost:c*1*u,minStock:10,referenceNumber:"PO-001",notes:o[i]?.description||o[i]?.notes,createdBy:"admin",createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(p0).toISOString(),invoiceId:o[i]?.invoice};if(r.push(h),AE[o[i].movementType]&&o[i]?.fromLocationId){let m=ct.getLocationById(o[i]?.fromLocationId);const g={id:o[i]?.ssg_inventory_key,productId:s?.product?.id,productName:s?.product?.label,productSku:s?.product?.code,locationId:o[i]?.fromLocationId,locationName:m?.name||"",movementType:"out",quantity:u*-1,unitCost:c,totalCost:c*-1*u,minStock:10,referenceNumber:o[i]?.referenceNumber,notes:`Transfer to ${o[i]?.locationName}`+(o[i].notes?` - ${o[i].notes}`:""),createdBy:o[i].createdBy,createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(p0).toISOString(),invoiceId:o[i]?.invoiceId,toLocationId:o[i]?.locationId,toLocationName:o[i]?.locationName};r.push(g)}})};return e.map(n),r},fecthInventory:async t=>{const e=await Ti.getInventory(t),r=ct.parseInventoryData(e);ct.updMovements(r)},getStockLevels:async t=>{const e=await Vy.getStockLevels(t);Xc(e)},fecthProduct:async t=>{const e=await Ti.getProducts(t),r=Object.keys(e),n=o=>{let s=e;return{id:o,name:s[o].name,businessId:s[o].businessId,sku:s[o].code,UPC:s[o].UPC,numCode:s[o].codeN,category:s[o].category,unitCost:s[o].unitCost||0,unitOfMeasure:s[o].unitOfMeasure||s[o].unit,minStockLevel:s[o].minStockLevel,maxStockLevel:s[o].maxStockLevel,isActive:s[o].isActive,productImageUrl:s[o].productImageUrl,description:s[o].description||"",createdDate:s[o].createdAt||new Date().toISOString(),lastModified:s[o].updatedAt||new Date().toISOString()}},i=r.map(n);return ct.updProduct(i),i},getProductById:t=>il().find(e=>e.id===t),updProduct:t=>{tf(t)},getProductsBySku:t=>il().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>il().filter(e=>e.category===t),getActiveProducts:()=>il().filter(t=>t.name),getLocationById:t=>ol().find(e=>e.id===t),getLocationsByType:t=>ol().filter(e=>e.type===t),getActiveLocations:()=>{let t=lr?.state?.profile?.stores;return ol().filter(e=>t?.[e?.id])},getMovementsByProduct:t=>Hi().filter(e=>e.productId===t),updMovements:t=>{Od([...t]),Xc(Fd())},getMovementsByLocation:t=>Hi()?.filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>Hi()?.filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>pa()?.filter(e=>e.productId===t),getStockByLocation:t=>pa()?.filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>pa()?.find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>pa()?.filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=Hi()?.filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return ol().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(il()||[])?.map(t=>{const e=pa()?.filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0)||0;return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),generateMovementInvoice:async(t,e,r,n="compact")=>{try{const{getUserLanguage:i}=await Ji(async()=>{const{getUserLanguage:h}=await import("./languageUtils-BVmHbHaj.js");return{getUserLanguage:h}},[]),o=r||i();let s;switch(n){case"compact":const{generateCompactModernInvoicePDF:h}=await Ji(async()=>{const{generateCompactModernInvoicePDF:f}=await import("./compactModernInvoicePdfGenerator-DJq4HuV0.js");return{generateCompactModernInvoicePDF:f}},[]);s=h;break;case"modern":const{generateModernMovementInvoicePDF:m}=await Ji(async()=>{const{generateModernMovementInvoicePDF:f}=await import("./modernMovementInvoicePdfGenerator-q3i-p4Yd.js");return{generateModernMovementInvoicePDF:f}},[]);s=m;break;case"classic":default:const{generateMovementInvoicePDF:g}=await Ji(async()=>{const{generateMovementInvoicePDF:f}=await import("./movementInvoicePdfGenerator-B22zpQ9I.js");return{generateMovementInvoicePDF:f}},[]);s=g;break}const l=Hi().filter(h=>h.invoiceId===t||h.id===t);if(l.length===0)throw new Error(`No movements found with ID: ${t}`);const c=l.reduce((h,m)=>{const g=m.invoiceId||m.id;return h[g]||(h[g]={invoiceId:g,movementType:m.movementType,referenceNumber:m.referenceNumber,createdBy:m.createdBy,createdDate:m.createdDate,locationName:m.locationName,fromLocationName:m.fromLocationName,toLocationName:m.toLocationName,notes:m.notes,items:[]}),h[g].items.push({productSku:m.productSku,productName:m.productName,quantity:m.quantity,unitCost:m.unitCost,totalCost:m.totalCost,receivedQuantity:m.movementType==="transfer"?null:void 0}),h},{}),u=[];for(const[h,m]of Object.entries(c)){const g=await s(m,e,o);u.push(g)}return u}catch(i){throw console.error("Error generating movement invoice:",i),i}},getMovementsByInvoiceId:t=>Hi().filter(e=>e.invoiceId===t),generateCompactMovementInvoice:async(t,e,r)=>ct.generateMovementInvoice(t,e,r,"compact"),generateModernMovementInvoice:async(t,e,r)=>ct.generateMovementInvoice(t,e,r,"modern"),generateClassicMovementInvoice:async(t,e,r)=>ct.generateMovementInvoice(t,e,r,"classic"),getMovementInvoiceData:t=>{const e=Hi().filter(i=>i.invoiceId===t||i.id===t);if(e.length===0)return null;const r=e[0],n=e.reduce((i,o)=>i+(o.totalCost||o.quantity*o.unitCost),0);return{invoiceId:r.invoiceId||r.id,movementType:r.movementType,referenceNumber:r.referenceNumber,createdBy:r.createdBy,createdDate:r.createdDate,locationName:r.locationName,fromLocationName:r.fromLocationName,toLocationName:r.toLocationName,notes:r.notes,totalValue:n,itemCount:e.length,items:e.map(i=>({productSku:i.productSku,productName:i.productName,quantity:i.quantity,unitCost:i.unitCost,totalCost:i.totalCost||i.quantity*i.unitCost}))}},addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};Od(r=>[...r,e]),Xc(Fd())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),i=ol().find(l=>l.id===t.locationId);if(!i)return{success:!1,errors:["Invalid location"]};let o;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(o=ol().find(l=>l.id===t.fromLocationId),!o)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((l,c)=>{const u=il().find(f=>f.id===l.productId);if(!u){e.push(`Item ${c+1}: Product not found`);return}if(l.quantity<=0){e.push(`Item ${c+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const f=pa().filter(w=>w.productId===l.productId&&w.locationId===t.locationId).reduce((w,x)=>w+x.quantity,0);if(l.quantity>f){e.push(`Item ${c+1}: Insufficient stock. Available: ${f}, Requested: ${l.quantity}`);return}}if(t.movementType==="transfer"){const f=pa().filter(w=>w.productId===l.productId&&w.locationId===t.fromLocationId).reduce((w,x)=>w+x.quantity,0);if(l.quantity>f){e.push(`Item ${c+1}: Insufficient stock at ${o?.name}. Available: ${f}, Requested: ${l.quantity}`);return}}const h=l.unitCost||u.unitCost,m=l.quantity*h,g={id:`mov-${Date.now()}-${c}`,productId:u.id,productName:u.name,productSku:u.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:l.quantity,unitCost:h,totalCost:m,minStock:10,referenceNumber:t.referenceNumber||"",notes:l.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:o?.name};if(r.push(g),t.movementType==="transfer"&&o){const f={id:`mov-${Date.now()}-${c}-out`,productId:u.id,productName:u.name,productSku:u.sku,locationId:t.fromLocationId,locationName:o.name,movementType:"out",quantity:l.quantity,unitCost:h,totalCost:m,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${i.name}`+(l.notes?` - ${l.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:i.name};r.push(f)}}),e.length>0)return{success:!1,errors:e};Od(l=>[...l,...r]),Xc(Fd()),console.log({bulkRequest:t});const s=await Ti.addInventory(t);return console.log({prodResults:s}),{success:!0,errors:[]}},getMovementsByInvoice:t=>Hi().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=Hi().filter(o=>o.invoiceId===t);if(e.length===0)return null;const r=e.reduce((o,s)=>o+s.totalCost,0),n=new Set(e.map(o=>o.productId)).size,i=e[0];return{invoiceId:t,referenceNumber:i.referenceNumber,movementType:i.movementType,location:i.locationName,fromLocation:i.fromLocationName,productCount:n,totalItems:e.reduce((o,s)=>o+s.quantity,0),totalValue:r,createdDate:i.createdDate,createdBy:i.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};tf(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};h0(r=>[...r,e])},updateProduct:(t,e)=>{tf(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{h0(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{Od(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),Xc(Fd())},get inventory(){return Bd()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return rf([...Bd(),e]),e},updateItem(t,e){rf(Bd().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){rf(Bd().filter(e=>e.id!==t))},getItemById(t){return Hi().find(e=>e.id===t)},getLowStockItems(){return Hi().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return Hi().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var f0=he("<div>"),CE=he("<div><div><input type=text autocomplete=off>"),IE=he("<button type=button>+"),$E=he("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>");const fp=t=>{const{t:e}=Zt(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),c=Lt(()=>t.value?ct.getProductById(t.value):null),u=Lt(()=>{const K=i().toLowerCase();return K?ct.getActiveProducts().filter(R=>R.name.toLowerCase().includes(K)||R.sku.toLowerCase().includes(K)||R?.UPC?.toLowerCase().includes(K)||R.category.toLowerCase().includes(K)):ct.getActiveProducts()}),h=()=>{n(!0),o(""),l(-1)},m=K=>{const R=K.target;o(R.value),n(!0),l(-1)},g=K=>{t.onChange(K),n(!1),o(""),l(-1)},f=K=>{const R=u();switch(K.key){case"ArrowDown":K.preventDefault(),l(k=>Math.min(k+1,R.length-1));break;case"ArrowUp":K.preventDefault(),l(k=>Math.max(k-1,-1));break;case"Enter":K.preventDefault(),s()>=0&&R[s()]&&g(R[s()]);break;case"Escape":n(!1),o(""),l(-1);break}},w=K=>{setTimeout(()=>{n(!1),o(""),l(-1)},150)},x=K=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(K),S=K=>ct.stockLevels.filter(R=>R.productId===K).reduce((R,k)=>R+k.quantity,0),C={position:"relative",width:"100%",...t.style},j={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},oe={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},te=K=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+K?"var(--primary-color)":"var(--border-color)",background:K?"var(--strip-color)":"transparent",color:K?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),Z={display:"flex","justify-content":"space-between","align-items":"center"},re={flex:"1"},E={"font-weight":"500","margin-bottom":"0.25rem"},$={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},T={"text-align":"right","font-size":"0.875rem"},B={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},_=()=>r()&&i()?i():c()?`${c().name} (${c().sku})`:"",P={display:"flex","align-items":"stretch",width:"100%"},b={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},H={...j,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var K=CE(),R=K.firstChild,k=R.firstChild;return y(R,P),k.addEventListener("blur",w),k.$$keydown=f,k.$$click=h,k.$$input=m,a(R,(()=>{var W=$e(()=>!!t.onAddNew);return()=>W()&&(()=>{var z=IE();return z.addEventListener("mouseleave",U=>{U.currentTarget.style.background="var(--surface-color)",U.currentTarget.style.color="var(--primary-color)"}),z.addEventListener("mouseenter",U=>{U.currentTarget.style.background="var(--primary-color)",U.currentTarget.style.color="white"}),hs(z,"click",t.onAddNew,!0),y(z,b),we(()=>Qt(z,"title",e("inventory.addProduct","Add new product"))),z})()})(),null),a(K,D(Ge,{get when(){return r()},get children(){var W=f0();return a(W,D(Ge,{get when(){return u().length>0},get fallback(){return(()=>{var z=f0();return y(z,B),a(z,(()=>{var U=$e(()=>!!i());return()=>U()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),z})()},get children(){return D(zt,{get each(){return u()},children:(z,U)=>{const le=S(z.id),L=le<=z.minStockLevel;return(()=>{var M=$E(),G=M.firstChild,I=G.firstChild,F=I.firstChild,X=F.nextSibling,Y=X.firstChild,Q=Y.firstChild,J=Y.nextSibling,V=J.nextSibling,ne=V.nextSibling,ee=ne.nextSibling,ce=I.nextSibling,se=ce.firstChild,q=se.firstChild,ue=se.nextSibling;return M.addEventListener("mouseenter",()=>l(U())),M.$$click=()=>g(z),y(G,Z),y(I,re),y(F,E),a(F,()=>z.name),y(X,$),a(Y,()=>e("inventory.sku","SKU"),Q),a(Y,()=>z.sku,null),a(V,()=>z.category),a(ee,()=>x(z.unitCost)),y(ce,T),se.style.setProperty("font-weight","600"),(L?"#f44336":"var(--text-primary)")!=null?se.style.setProperty("color",L?"#f44336":"var(--text-primary)"):se.style.removeProperty("color"),a(se,le,q),a(se,()=>z.unitOfMeasure,null),ue.style.setProperty("color","var(--text-muted)"),a(ue,()=>L?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),we(ye=>y(M,te(U()===s()),ye)),M})()}})}})),we(z=>y(W,oe,z)),W}}),null),we(W=>{var z=C,U=H,le=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),L=t.disabled,M=t.required;return W.e=y(K,z,W.e),W.t=y(k,U,W.t),le!==W.a&&Qt(k,"placeholder",W.a=le),L!==W.o&&(k.disabled=W.o=L),M!==W.i&&(k.required=W.i=M),W},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>k.value=_()),K})()};pr(["input","click","keydown"]);var m0=he("<div>"),EE=he("<div><div><input type=text autocomplete=off>"),TE=he("<button type=button>+"),kE=he("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const ju=t=>{const{t:e}=Zt(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),c=Lt(()=>t.value?ct.getLocationById(t.value):null),u=Lt(()=>{let K=ct.getActiveLocations();t.filterType&&(K=K.filter(k=>k.type===t.filterType));const R=i().toLowerCase();return R?K.filter(k=>k.name.toLowerCase().includes(R)||k?.code?.toLowerCase().includes(R)||k?.type?.toLowerCase().includes(R)||k?.address?.toLowerCase().includes(R)):K}),h=()=>{n(!0),o(""),l(-1)},m=K=>{const R=K.target;o(R.value),n(!0),l(-1)},g=K=>{t.onChange(K.id),n(!1),o(""),l(-1)},f=K=>{const R=u();switch(K.key){case"ArrowDown":K.preventDefault(),l(k=>Math.min(k+1,R.length-1));break;case"ArrowUp":K.preventDefault(),l(k=>Math.max(k-1,-1));break;case"Enter":K.preventDefault(),s()>=0&&R[s()]&&g(R[s()]);break;case"Escape":n(!1),o(""),l(-1);break}},w=K=>{setTimeout(()=>{n(!1),o(""),l(-1)},150)},x=K=>({warehouse:"",store:"",supplier:"",customer:""})[K]||"",S=K=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[K]||"#757575",C={position:"relative",width:"100%",...t.style},j={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},oe={display:"flex","align-items":"stretch",width:"100%"},te={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},Z={...j,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},re={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},E=K=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:K?"var(--strip-color)":"transparent",color:K?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),$={display:"flex","justify-content":"space-between","align-items":"center"},T={flex:"1"},B={"font-weight":"500","margin-bottom":"0.25rem"},_={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},P=K=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:S(K),color:"white","text-transform":"uppercase"}),b={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},H=()=>r()&&i()?i():c()?`${c().name} (${c().code})`:"";return(()=>{var K=EE(),R=K.firstChild,k=R.firstChild;return y(R,oe),k.addEventListener("blur",w),k.$$keydown=f,k.$$click=h,k.$$input=m,a(R,(()=>{var W=$e(()=>!!t.onAddNew);return()=>W()&&(()=>{var z=TE();return z.addEventListener("mouseleave",U=>{U.currentTarget.style.background="var(--surface-color)",U.currentTarget.style.color="var(--primary-color)"}),z.addEventListener("mouseenter",U=>{U.currentTarget.style.background="var(--primary-color)",U.currentTarget.style.color="white"}),hs(z,"click",t.onAddNew,!0),y(z,te),we(()=>Qt(z,"title",e("inventory.addLocation","Add new location"))),z})()})(),null),a(K,D(Ge,{get when(){return r()},get children(){var W=m0();return a(W,D(Ge,{get when(){return u().length>0},get fallback(){return(()=>{var z=m0();return y(z,b),a(z,(()=>{var U=$e(()=>!!i());return()=>U()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),z})()},get children(){return D(zt,{get each(){return u()},children:(z,U)=>(()=>{var le=kE(),L=le.firstChild,M=L.firstChild,G=M.firstChild,I=G.firstChild,F=G.nextSibling,X=F.firstChild,Y=X.firstChild,Q=X.nextSibling,J=F.nextSibling;return le.addEventListener("mouseenter",()=>l(U())),le.$$click=()=>g(z),y(L,$),y(M,T),y(G,B),a(G,()=>x(z.type),I),a(G,()=>z.name,null),y(F,_),a(X,()=>e("inventory.locationCode","Code"),Y),a(X,()=>z.code,null),a(Q,()=>z.type),J.style.setProperty("font-size","0.75rem"),J.style.setProperty("color","var(--text-muted)"),J.style.setProperty("margin-top","0.25rem"),a(J,()=>z.address),we(V=>{var ne=E(U()===s()),ee=P(z.type);return V.e=y(le,ne,V.e),V.t=y(Q,ee,V.t),V},{e:void 0,t:void 0}),le})()})}})),we(z=>y(W,re,z)),W}}),null),we(W=>{var z=C,U=Z,le=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),L=t.disabled,M=t.required;return W.e=y(K,z,W.e),W.t=y(k,U,W.t),le!==W.a&&Qt(k,"placeholder",W.a=le),L!==W.o&&(k.disabled=W.o=L),M!==W.i&&(k.required=W.i=M),W},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>k.value=H()),K})()};pr(["input","click","keydown"]);var NE=he("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),LE=he("<div>");const qy=t=>{const{t:e}=Zt(),[r,n]=Ce(""),[i,o]=Ce(""),[s,l]=Ce(""),[c,u]=Ce(""),[h,m]=Ce("pcs"),[g,f]=Ce(0),[w,x]=Ce(0),[S,C]=Ce(10),[j,oe]=Ce(100),[te,Z]=Ce(""),re=()=>{n(""),o(""),l(""),u(""),m("pcs"),f(0),x(0),C(10),oe(100),Z("")},E=R=>{if(R.preventDefault(),Z(""),!r().trim()){Z(e("forms.productNameRequired"));return}if(!i().trim()){Z(e("forms.skuRequired"));return}if(!c().trim()){Z(e("forms.categoryRequired"));return}if(g()<0){Z(e("forms.unitCostNotNegative"));return}if(w()<0){Z(e("forms.sellingPriceNotNegative"));return}if(S()<0){Z(e("forms.minStockNotNegative"));return}if(j()<=S()){Z(e("forms.maxStockGreaterThanMin"));return}if(ct.getProductsBySku(i()).length>0){Z(e("forms.skuAlreadyExists"));return}const W={name:r().trim(),sku:i().trim().toUpperCase(),description:s().trim(),category:c().trim(),unitOfMeasure:h(),unitCost:g(),sellingPrice:w(),minStockLevel:S(),maxStockLevel:j(),isActive:!0,businessId:"default-business"};ct.addProduct(W);const z=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(z),re(),t.onClose()},$=()=>{re(),t.onClose()},T={"margin-bottom":"1.5rem"},B={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},_={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},P={..._,cursor:"pointer"},b={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},H={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},K={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return D(qn,{get isOpen(){return t.isOpen},onClose:$,get title(){return e("inventory.addNewProduct")},get children(){var R=NE(),k=R.firstChild,W=k.firstChild,z=W.firstChild,U=W.nextSibling,le=k.nextSibling,L=le.firstChild,M=L.firstChild,G=M.firstChild,I=M.nextSibling,F=L.nextSibling,X=F.firstChild,Y=X.firstChild,Q=X.nextSibling,J=le.nextSibling,V=J.firstChild,ne=V.nextSibling,ee=J.nextSibling,ce=ee.firstChild,se=ce.firstChild,q=se.nextSibling,ue=q.firstChild,ye=ue.nextSibling,de=ye.nextSibling,ge=de.nextSibling,xe=ge.nextSibling,pe=xe.nextSibling,_e=pe.nextSibling,Re=_e.nextSibling,Ee=Re.nextSibling,Te=ce.nextSibling,Le=Te.firstChild,Ie=Le.nextSibling,De=ee.nextSibling,Ye=De.firstChild,Be=Ye.firstChild,We=Be.nextSibling,Ke=De.nextSibling,st=Ke.firstChild,nt=st.firstChild,He=nt.nextSibling,mt=st.nextSibling,ut=mt.firstChild,at=ut.nextSibling,It=Ke.nextSibling;return R.addEventListener("submit",E),a(W,()=>e("inventory.productName"),z),U.addEventListener("change",Xe=>n(Xe.target.value)),a(M,()=>e("inventory.sku"),G),I.addEventListener("change",Xe=>o(Xe.target.value)),a(X,()=>e("inventory.category"),Y),Q.addEventListener("change",Xe=>u(Xe.target.value)),a(V,()=>e("common.description")),ne.addEventListener("change",Xe=>l(Xe.target.value)),a(se,()=>e("inventory.unitOfMeasure")),q.addEventListener("change",Xe=>m(Xe.target.value)),a(ue,()=>e("inventory.pieces")),a(ye,()=>e("inventory.kilograms")),a(de,()=>e("inventory.pounds")),a(ge,()=>e("inventory.meters")),a(xe,()=>e("inventory.feet")),a(pe,()=>e("inventory.liters")),a(_e,()=>e("inventory.gallons")),a(Re,()=>e("inventory.boxes")),a(Ee,()=>e("inventory.packs")),a(Le,()=>e("inventory.unitCost")),Ie.addEventListener("change",Xe=>f(Number(Xe.target.value))),a(Be,()=>e("inventory.sellingPrice")),We.addEventListener("change",Xe=>x(Number(Xe.target.value))),a(nt,()=>e("inventory.minimumStockLevel")),He.addEventListener("change",Xe=>C(Number(Xe.target.value))),a(ut,()=>e("inventory.maximumStockLevel")),at.addEventListener("change",Xe=>oe(Number(Xe.target.value))),a(R,(()=>{var Xe=$e(()=>!!te());return()=>Xe()&&(()=>{var kt=LE();return y(kt,b),a(kt,te),kt})()})(),It),y(It,H),a(It,D(ht,{variant:"secondary",type:"button",onClick:$,get children(){return e("common.cancel")}}),null),a(It,D(ht,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),we(Xe=>{var kt=T,Tt=B,wt=_,Rt=e("inventory.enterProductName"),fr=K,ze=B,Ct=_,xt=e("inventory.enterSkuCode"),tt=B,bt=_,Mt=e("inventory.enterCategory"),Wt=T,Jt=B,lt={..._,"min-height":"80px",resize:"vertical"},gt=e("inventory.enterProductDescription"),$t=K,et=B,Vt=P,Ht=B,Xt=_,er=K,Kt=B,ir=_,vr=K,cr=B,br=_,Nt=B,Et=_;return Xe.e=y(k,kt,Xe.e),Xe.t=y(W,Tt,Xe.t),Xe.a=y(U,wt,Xe.a),Rt!==Xe.o&&Qt(U,"placeholder",Xe.o=Rt),Xe.i=y(le,fr,Xe.i),Xe.n=y(M,ze,Xe.n),Xe.s=y(I,Ct,Xe.s),xt!==Xe.h&&Qt(I,"placeholder",Xe.h=xt),Xe.r=y(X,tt,Xe.r),Xe.d=y(Q,bt,Xe.d),Mt!==Xe.l&&Qt(Q,"placeholder",Xe.l=Mt),Xe.u=y(J,Wt,Xe.u),Xe.c=y(V,Jt,Xe.c),Xe.w=y(ne,lt,Xe.w),gt!==Xe.m&&Qt(ne,"placeholder",Xe.m=gt),Xe.f=y(ee,$t,Xe.f),Xe.y=y(se,et,Xe.y),Xe.g=y(q,Vt,Xe.g),Xe.p=y(Le,Ht,Xe.p),Xe.b=y(Ie,Xt,Xe.b),Xe.T=y(De,er,Xe.T),Xe.A=y(Be,Kt,Xe.A),Xe.O=y(We,ir,Xe.O),Xe.I=y(Ke,vr,Xe.I),Xe.S=y(nt,cr,Xe.S),Xe.W=y(He,br,Xe.W),Xe.C=y(ut,Nt,Xe.C),Xe.B=y(at,Et,Xe.B),Xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),we(()=>U.value=r()),we(()=>I.value=i()),we(()=>Q.value=c()),we(()=>ne.value=s()),we(()=>q.value=h()),we(()=>Ie.value=g()),we(()=>We.value=w()),we(()=>He.value=S()),we(()=>at.value=j()),R}})};var RE=he('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),DE=he("<div><div>:</div><div><span></span><div><div></div><div>"),ME=he("<div>");const zy=t=>{const{t:e}=Zt(),[r,n]=Ce(""),[i,o]=Ce(""),[s,l]=Ce("warehouse"),[c,u]=Ce(""),[h,m]=Ce(""),g=()=>{n(""),o(""),l("warehouse"),u(""),m("")},f=()=>{if(r()){const _=s()==="warehouse"?"WH":s()==="store"?"ST":s()==="supplier"?"SUP":"CUST",P=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),b=String(Math.floor(Math.random()*1e3)).padStart(3,"0");o(`${_}-${P}-${b}`)}},w=_=>{if(_.preventDefault(),m(""),!r().trim()){m(e("forms.locationNameRequired"));return}if(!i().trim()){m(e("forms.locationCodeRequired"));return}if(!c().trim()){m(e("forms.addressRequired"));return}if(ct.locations.filter(K=>K.code.toLowerCase()===i().toLowerCase()).length>0){m(e("forms.locationCodeExists"));return}const b={name:r().trim(),code:i().trim().toUpperCase(),type:s(),address:c().trim(),isActive:!0};ct.addLocation(b);const H=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(H),g(),t.onClose()},x=()=>{g(),t.onClose()},S={"margin-bottom":"1.5rem"},C={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},j={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},oe={...j,cursor:"pointer"},te={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},Z={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},re={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},E={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},$={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},T=_=>({warehouse:"",store:"",supplier:"",customer:""})[_]||"",B=_=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[_]||"";return D(qn,{get isOpen(){return t.isOpen},onClose:x,get title(){return e("inventory.addNewLocation")},get children(){var _=RE(),P=_.firstChild,b=P.firstChild,H=b.firstChild,K=b.nextSibling,R=P.nextSibling,k=R.firstChild,W=k.firstChild,z=W.firstChild,U=z.nextSibling,le=W.nextSibling,L=le.nextSibling,M=k.nextSibling,G=M.firstChild,I=G.firstChild,F=G.nextSibling,X=F.firstChild,Y=X.firstChild,Q=X.nextSibling,J=Q.firstChild,V=Q.nextSibling,ne=V.firstChild,ee=V.nextSibling,ce=ee.firstChild,se=F.nextSibling,q=R.nextSibling,ue=q.firstChild,ye=ue.firstChild,de=ue.nextSibling,ge=q.nextSibling;return _.addEventListener("submit",w),a(b,()=>e("inventory.locationName"),H),K.addEventListener("change",xe=>n(xe.target.value)),y(R,re),a(W,()=>e("inventory.locationCode"),z),U.$$click=f,y(U,$),a(U,()=>e("common.generate")),le.addEventListener("change",xe=>o(xe.target.value)),a(L,()=>e("inventory.uniqueIdentifierHelp")),a(G,()=>e("inventory.locationType"),I),F.addEventListener("change",xe=>l(xe.target.value)),a(X,()=>T("warehouse"),Y),a(X,()=>e("inventory.warehouse"),null),a(Q,()=>T("store"),J),a(Q,()=>e("inventory.store"),null),a(V,()=>T("supplier"),ne),a(V,()=>e("inventory.supplier"),null),a(ee,()=>T("customer"),ce),a(ee,()=>e("inventory.customer"),null),a(se,()=>B(s())),a(ue,()=>e("common.address"),ye),de.addEventListener("change",xe=>u(xe.target.value)),a(_,(()=>{var xe=$e(()=>!!r());return()=>xe()&&(()=>{var pe=DE(),_e=pe.firstChild,Re=_e.firstChild,Ee=_e.nextSibling,Te=Ee.firstChild,Le=Te.nextSibling,Ie=Le.firstChild,De=Ie.nextSibling;return pe.style.setProperty("padding","1rem"),pe.style.setProperty("background","var(--background-color)"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("margin-bottom","1rem"),_e.style.setProperty("font-weight","500"),_e.style.setProperty("margin-bottom","0.5rem"),a(_e,()=>e("common.preview"),Re),Ee.style.setProperty("display","flex"),Ee.style.setProperty("align-items","center"),Ee.style.setProperty("gap","0.5rem"),Te.style.setProperty("font-size","1.2rem"),a(Te,()=>T(s())),Ie.style.setProperty("font-weight","600"),a(Ie,r),De.style.setProperty("font-size","0.875rem"),De.style.setProperty("color","var(--text-muted)"),a(De,(()=>{var Ye=$e(()=>!!i());return()=>Ye()&&`${i()}  `})(),null),a(De,s,null),pe})()})(),ge),a(_,(()=>{var xe=$e(()=>!!h());return()=>xe()&&(()=>{var pe=ME();return y(pe,te),a(pe,h),pe})()})(),ge),y(ge,Z),a(ge,D(ht,{variant:"secondary",type:"button",onClick:x,get children(){return e("common.cancel")}}),null),a(ge,D(ht,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),we(xe=>{var pe=S,_e=C,Re=j,Ee=e("inventory.enterLocationName"),Te=C,Le=j,Ie=e("inventory.enterUniqueCode"),De=E,Ye=C,Be=oe,We=E,Ke=S,st=C,nt={...j,"min-height":"100px",resize:"vertical"},He=e("inventory.enterCompleteAddress");return xe.e=y(P,pe,xe.e),xe.t=y(b,_e,xe.t),xe.a=y(K,Re,xe.a),Ee!==xe.o&&Qt(K,"placeholder",xe.o=Ee),xe.i=y(W,Te,xe.i),xe.n=y(le,Le,xe.n),Ie!==xe.s&&Qt(le,"placeholder",xe.s=Ie),xe.h=y(L,De,xe.h),xe.r=y(G,Ye,xe.r),xe.d=y(F,Be,xe.d),xe.l=y(se,We,xe.l),xe.u=y(q,Ke,xe.u),xe.c=y(ue,st,xe.c),xe.w=y(de,nt,xe.w),He!==xe.m&&Qt(de,"placeholder",xe.m=He),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),we(()=>K.value=r()),we(()=>le.value=i()),we(()=>F.value=s()),we(()=>de.value=c()),_}})};pr(["click"]);var FE=he("<form><div>"),y0=he("<div><label> *"),OE=he("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),BE=he("<div><label>"),jE=he("<div><label> *</label><input type=number min=0 step=1 required>"),VE=he("<div><label></label><input type=number min=0 step=0.01>"),qE=he("<div><label></label><input type=text>"),zE=he("<div><label></label><textarea>"),UE=he("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),HE=he("<div><div><span>:</span><span>"),GE=he("<div>");const WE=t=>{const{t:e}=Zt(),[r,n]=Ce({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[i,o]=Ce(""),[s,l]=Ce(""),[c,u]=Ce("in"),[h,m]=Ce(0),[g,f]=Ce(0),[w,x]=Ce(""),[S,C]=Ce(""),[j,oe]=Ce(""),[te,Z]=Ce(""),[re,E]=Ce(!1),[$,T]=Ce(!1),B=()=>t.mode==="movement",_=Lt(()=>i()?ct.getProductById(i()):null),P=Lt(()=>s()?ct.getLocationById(s()):null),b=Lt(()=>j()?ct.getLocationById(j()):null),H=Lt(()=>h()*g()),K=Lt(()=>!i()||!s()?0:ct.getStockByProductAndLocation(i(),s())?.quantity||0),R=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],k=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],W={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},z=()=>{o(""),l(""),u("in"),m(0),f(0),x(""),C(""),oe(""),Z("")},U=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},le=ee=>{if(ee.preventDefault(),B()){if(Z(""),!i()){Z(e("forms.selectProduct"));return}if(!s()){Z(e("forms.selectLocation"));return}if(h()<=0){Z(e("forms.quantityGreaterThanZero"));return}if(g()<0){Z(e("forms.unitCostNotNegative"));return}if(c()==="transfer"&&!j()){Z(e("forms.selectFromLocation"));return}if(c()==="transfer"&&j()===s()){Z(e("forms.sameLocationError"));return}if(c()==="out"&&h()>K()){Z(e("forms.insufficientStock",{currentStock:K()}));return}const ce=_(),se=P(),q={productId:ce.id,productName:ce.name,productSku:ce.sku,locationId:se.id,locationName:se.name,movementType:c(),quantity:h(),unitCost:g()||ce.unitCost,totalCost:H()||h()*ce.unitCost,referenceNumber:w()||`AUTO-${Date.now()}`,notes:S(),createdBy:"admin",fromLocationId:c()==="transfer"?j():void 0,fromLocationName:c()==="transfer"?b()?.name:void 0};ct.addInventoryMovement(q),z()}else{const ce=r();if(!ce.name||!ce.price||!ce.quantity||!ce.category||!ce.sku||!ce.supplier||!ce.minStock||!ce.location){alert(e("forms.fillAllRequired"));return}const se={name:ce.name,price:parseFloat(ce.price),quantity:parseInt(ce.quantity),category:ce.category,description:ce.description,sku:ce.sku,supplier:ce.supplier,minStock:parseInt(ce.minStock),location:ce.location};ct.addItem(se),U()}t.onClose()},L=(ee,ce)=>{n(se=>({...se,[ee]:ce}))},M=()=>{B()?z():U(),t.onClose()},G=ee=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ee),I={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},F={...I,cursor:"pointer"},X={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},Y={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},Q={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},J={"font-weight":"500",color:"var(--text-muted)"},V={"font-weight":"600",color:"var(--text-primary)"},ne=()=>B()?e("inventory.addMovement"):e("inventory.addNewItem");return D(qn,{get isOpen(){return t.isOpen},onClose:M,get title(){return ne()},get children(){return[(()=>{var ee=FE(),ce=ee.firstChild;return ee.addEventListener("submit",le),a(ee,(()=>{var se=$e(()=>!!B());return()=>se()?[(()=>{var q=y0(),ue=q.firstChild,ye=ue.firstChild;return q.style.setProperty("margin-bottom","1.5rem"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),a(ue,()=>e("inventory.product"),ye),a(q,D(fp,{get value(){return i()},onChange:de=>{o(de);const ge=ct.getProductById(de);ge&&f(ge.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>E(!0),required:!0}),null),q})(),(()=>{var q=OE(),ue=q.firstChild,ye=ue.firstChild,de=ue.nextSibling,ge=de.firstChild,xe=ge.nextSibling,pe=xe.nextSibling,_e=pe.nextSibling;return q.style.setProperty("margin-bottom","1.5rem"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),a(ue,()=>e("inventory.movementType"),ye),de.addEventListener("change",Re=>u(Re.target.value)),a(ge,()=>e("inventory.stockInPurchase")),a(xe,()=>e("inventory.stockOutSale")),a(pe,()=>e("inventory.transferBetween")),a(_e,()=>e("inventory.stockAdjustment")),we(Re=>y(de,F,Re)),we(()=>de.value=c()),q})(),$e(()=>$e(()=>c()==="transfer")()&&(()=>{var q=y0(),ue=q.firstChild,ye=ue.firstChild;return q.style.setProperty("margin-bottom","1.5rem"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),a(ue,()=>e("inventory.fromLocation"),ye),a(q,D(ju,{get value(){return j()},onChange:de=>oe(de),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>T(!0),required:!0}),null),q})()),(()=>{var q=BE(),ue=q.firstChild;return q.style.setProperty("margin-bottom","1.5rem"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),a(ue,(()=>{var ye=$e(()=>c()==="transfer");return()=>ye()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),a(q,D(ju,{get value(){return s()},onChange:ye=>l(ye),get placeholder(){return $e(()=>c()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>T(!0),required:!0}),null),q})(),$e(()=>$e(()=>!!(_()&&P()))()&&(()=>{var q=UE(),ue=q.firstChild,ye=ue.firstChild,de=ye.firstChild,ge=ye.nextSibling,xe=ge.firstChild,pe=ue.nextSibling,_e=pe.firstChild,Re=_e.firstChild,Ee=_e.nextSibling,Te=pe.nextSibling,Le=Te.firstChild,Ie=Le.firstChild,De=Le.nextSibling,Ye=De.firstChild;return a(ye,()=>e("inventory.currentStockAt",{location:P()?.name}),de),a(ge,K,xe),a(ge,()=>_()?.unitOfMeasure,null),a(_e,()=>e("inventory.productCost"),Re),a(Ee,()=>G(_()?.unitCost||0)),a(Le,()=>e("inventory.minStockLevel"),Ie),a(De,()=>_()?.minStockLevel,Ye),a(De,()=>_()?.unitOfMeasure,null),we(Be=>{var We=Y,Ke=Q,st=J,nt=V,He=Q,mt=J,ut=V,at=Q,It=J,Xe=V;return Be.e=y(q,We,Be.e),Be.t=y(ue,Ke,Be.t),Be.a=y(ye,st,Be.a),Be.o=y(ge,nt,Be.o),Be.i=y(pe,He,Be.i),Be.n=y(_e,mt,Be.n),Be.s=y(Ee,ut,Be.s),Be.h=y(Te,at,Be.h),Be.r=y(Le,It,Be.r),Be.d=y(De,Xe,Be.d),Be},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),q})()),(()=>{var q=jE(),ue=q.firstChild,ye=ue.firstChild,de=ue.nextSibling;return q.style.setProperty("margin-bottom","1.5rem"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),a(ue,()=>e("inventory.quantity"),ye),de.addEventListener("change",ge=>m(Number(ge.target.value))),we(ge=>y(de,I,ge)),we(()=>de.value=h()),q})(),(()=>{var q=VE(),ue=q.firstChild,ye=ue.nextSibling;return q.style.setProperty("margin-bottom","1.5rem"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),a(ue,()=>e("inventory.unitCost")),ye.addEventListener("change",de=>f(Number(de.target.value))),we(de=>{var ge=I,xe=e("inventory.willUseDefaultCost");return de.e=y(ye,ge,de.e),xe!==de.t&&Qt(ye,"placeholder",de.t=xe),de},{e:void 0,t:void 0}),we(()=>ye.value=g()),q})(),$e(()=>$e(()=>h()>0&&g()>0)()&&(()=>{var q=HE(),ue=q.firstChild,ye=ue.firstChild,de=ye.firstChild,ge=ye.nextSibling;return a(ye,()=>e("inventory.totalCost"),de),a(ge,()=>G(H())),we(xe=>{var pe=Y,_e=Q,Re=J,Ee={...V,"font-size":"1.2rem",color:"var(--primary-color)"};return xe.e=y(q,pe,xe.e),xe.t=y(ue,_e,xe.t),xe.a=y(ye,Re,xe.a),xe.o=y(ge,Ee,xe.o),xe},{e:void 0,t:void 0,a:void 0,o:void 0}),q})()),(()=>{var q=qE(),ue=q.firstChild,ye=ue.nextSibling;return q.style.setProperty("margin-bottom","1.5rem"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),a(ue,()=>e("common.referenceNumber")),ye.addEventListener("change",de=>x(de.target.value)),we(de=>{var ge=I,xe=e("common.referenceNumberPlaceholder");return de.e=y(ye,ge,de.e),xe!==de.t&&Qt(ye,"placeholder",de.t=xe),de},{e:void 0,t:void 0}),we(()=>ye.value=w()),q})(),(()=>{var q=zE(),ue=q.firstChild,ye=ue.nextSibling;return q.style.setProperty("margin-bottom","1.5rem"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),a(ue,()=>e("common.notes")),ye.addEventListener("change",de=>C(de.target.value)),we(de=>{var ge={...I,"min-height":"100px",resize:"vertical"},xe=e("inventory.additionalNotesPlaceholder");return de.e=y(ye,ge,de.e),xe!==de.t&&Qt(ye,"placeholder",de.t=xe),de},{e:void 0,t:void 0}),we(()=>ye.value=S()),q})(),$e(()=>$e(()=>!!te())()&&(()=>{var q=GE();return y(q,X),a(q,te),q})())]:[D(Ar,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:q=>L("name",q),get placeholder(){return e("inventory.enterItemName")},required:!0}),D(Ar,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:q=>L("sku",q),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),D(An,{get label(){return e("inventory.category")},get value(){return r().category},onChange:q=>L("category",q),options:R,required:!0}),D(Ar,{get label(){return e("common.description")},get value(){return r().description},onChange:q=>L("description",q),get placeholder(){return e("inventory.enterItemDescription")}}),D(Ar,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:q=>L("price",q),get placeholder(){return e("common.enterPrice")},required:!0}),D(Ar,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:q=>L("quantity",q),get placeholder(){return e("inventory.enterQuantity")},required:!0}),D(Ar,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:q=>L("minStock",q),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),D(Ar,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:q=>L("supplier",q),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),D(An,{get label(){return e("inventory.location")},get value(){return r().location},onChange:q=>L("location",q),options:k,required:!0})]})(),ce),y(ce,W),a(ce,D(ht,{variant:"secondary",type:"button",onClick:M,get children(){return e("common.cancel")}}),null),a(ce,D(ht,{variant:"primary",type:"submit",get children(){return $e(()=>!!B())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),ee})(),D(qy,{get isOpen(){return re()},onClose:()=>E(!1),onProductAdded:ee=>{o(ee),E(!1)}}),D(zy,{get isOpen(){return $()},onClose:()=>T(!1),onLocationAdded:ee=>{c()==="transfer"&&!j()?oe(ee):l(ee),T(!1)}})]}})};pr(["input","keydown"]);var YE=he("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),KE=he("<div><label> *"),JE=he("<div><div></div><div></div><div></div><div></div><div>"),nf=he("<div>"),QE=he("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),XE=he("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),ZE=he("<div> ");const eT=t=>{const{t:e}=Zt(),[r,n]=Ce(`INV-${Date.now()}`),[i,o]=Ce(""),[s,l]=Ce("in"),[c,u]=Ce(""),[h,m]=Ce(""),[g,f]=Ce(""),[w,x]=Ce([]),[S,C]=Ce([]),[j,oe]=Ce(!1),[te,Z]=Ce(!1),re=()=>{x(Y=>[...Y,{productId:"",quantity:0,unitCost:0,notes:""}])},E=Y=>{x(Q=>Q.filter((J,V)=>V!==Y))},$=(Y,Q,J)=>{x(V=>V.map((ne,ee)=>ee===Y?{...ne,[Q]:J}:ne))},T=()=>{n(`INV-${Date.now()}`),o(""),l("in"),u(""),m(""),f(""),x([]),C([])},B=async Y=>{Y.preventDefault(),C([]);const Q=[];if(i()||Q.push(e("forms.referenceNumberRequired")),c()||Q.push(e("forms.locationRequired")),s()==="transfer"&&!h()&&Q.push(e("forms.fromLocationRequired")),w().length===0&&Q.push(e("forms.atLeastOneProduct")),w().forEach((ne,ee)=>{ne.productId||Q.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:ee+1})),ne.quantity<=0&&Q.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:ee+1}))}),Q.length>0){C(Q);return}const J={ssg_inventory_key:Yh(),invoiceId:r(),referenceNumber:i(),movementType:s(),type:Gf(s()),locationId:c(),fromLocationId:s()==="transfer"?h():void 0,items:w(),products:w(),generalNotes:g(),description:g(),invoice:i(),store:c(),createdBy:"admin",createDate:new Date().toISOString()};console.log(J);const V=await ct.addBulkInventoryMovements(J);console.log(V),V.success?t.onMovementComplete?t.onMovementComplete(i()):(T(),t.onClose()):C(V.errors)},_=()=>{T(),t.onClose()},P=Lt(()=>w().reduce((Y,Q)=>{const J=ct.getProductById(Q.productId),V=Q.unitCost||J?.unitCost||0;return Y+Q.quantity*V},0)),b=Lt(()=>w().reduce((Y,Q)=>Y+Q.quantity,0)),H={"margin-bottom":"1.5rem"},K={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},R={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},k={...R,cursor:"pointer"},W={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},z={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},U={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},le={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},L={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},M={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},G={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},I=Y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Y),F=Y=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[Y]||Y,X=async Y=>{await ct.fecthInventory(Y),await ct.fecthProduct(Y)};return Cn(()=>{X("prod")}),D(qn,{get isOpen(){return t.isOpen},onClose:_,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var Y=YE(),Q=Y.firstChild,J=Q.firstChild,V=J.firstChild,ne=V.firstChild,ee=V.nextSibling,ce=J.nextSibling,se=ce.firstChild,q=se.firstChild,ue=se.nextSibling,ye=Q.nextSibling,de=ye.firstChild,ge=de.firstChild,xe=de.nextSibling,pe=xe.firstChild,_e=pe.nextSibling,Re=_e.nextSibling,Ee=Re.nextSibling,Te=ye.nextSibling,Le=Te.firstChild,Ie=Le.firstChild,De=Te.nextSibling,Ye=De.firstChild,Be=Ye.firstChild,We=De.nextSibling,Ke=We.firstChild,st=Ke.nextSibling,nt=We.nextSibling;return Y.addEventListener("submit",B),Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","1fr 1fr"),Q.style.setProperty("gap","1rem"),Q.style.setProperty("margin-bottom","1.5rem"),a(V,()=>e("common.invoiceDocumentId"),ne),ee.addEventListener("change",He=>n(He.target.value)),a(se,()=>e("common.referenceNumber"),q),ue.addEventListener("change",He=>o(He.target.value)),a(de,()=>e("inventory.movementType"),ge),xe.addEventListener("change",He=>l(He.target.value)),a(pe,()=>e("inventory.purchaseReceive")),a(_e,()=>e("inventory.saleIssue")),a(Re,()=>e("inventory.transfer")),a(Ee,()=>e("inventory.adjustment")),Te.style.setProperty("display","grid"),Te.style.setProperty("gap","1rem"),Te.style.setProperty("margin-bottom","1.5rem"),a(Te,(()=>{var He=$e(()=>s()==="transfer");return()=>He()&&(()=>{var mt=KE(),ut=mt.firstChild,at=ut.firstChild;return a(ut,()=>e("inventory.fromLocation"),at),a(mt,D(ju,{get value(){return h()},onChange:It=>m(It),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>Z(!0),required:!0}),null),we(It=>y(ut,K,It)),mt})()})(),Le),a(Ie,(()=>{var He=$e(()=>s()==="transfer");return()=>He()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),a(Le,D(ju,{get value(){return c()},onChange:He=>u(He),get placeholder(){return $e(()=>s()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>Z(!0),required:!0}),null),Ye.style.setProperty("display","flex"),Ye.style.setProperty("justify-content","space-between"),Ye.style.setProperty("align-items","center"),Ye.style.setProperty("margin-bottom","1rem"),Be.style.setProperty("margin","0"),Be.style.setProperty("font-size","1.1rem"),a(Be,()=>e("inventory.products")),a(Ye,D(ht,{variant:"outline",type:"button",onClick:re,get children(){return e("inventory.addProduct")}}),null),a(De,(()=>{var He=$e(()=>w().length>0);return()=>He()&&[(()=>{var mt=JE(),ut=mt.firstChild,at=ut.nextSibling,It=at.nextSibling,Xe=It.nextSibling;return y(mt,U),a(ut,()=>e("inventory.product")),a(at,()=>e("inventory.quantity")),a(It,()=>e("inventory.unitCost")),a(Xe,()=>e("common.notes")),mt})(),D(zt,{get each(){return w()},children:(mt,ut)=>[(()=>{var at=nf();return y(at,W),a(at,D(fp,{get value(){return mt.productId},onChange:It=>{$(ut(),"productId",It.id);let Xe={id:It.id,label:It.name,code:It.sku};$(ut(),"product",Xe);const kt=ct.getProductById(It.id);kt&&!mt.unitCost&&$(ut(),"unitCost",kt.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>oe(!0),required:!0})),at})(),(()=>{var at=QE(),It=at.firstChild,Xe=It.nextSibling,kt=Xe.nextSibling;return y(at,z),It.addEventListener("change",Tt=>$(ut(),"quantity",Number(Tt.target.value))),Xe.addEventListener("change",Tt=>$(ut(),"unitCost",Number(Tt.target.value))),kt.addEventListener("change",Tt=>$(ut(),"notes",Tt.target.value)),a(at,D(ht,{variant:"outline",size:"sm",type:"button",onClick:()=>E(ut()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),we(Tt=>{var wt=R,Rt=R,fr=e("common.auto"),ze=R,Ct=e("common.optionalNotes");return Tt.e=y(It,wt,Tt.e),Tt.t=y(Xe,Rt,Tt.t),fr!==Tt.a&&Qt(Xe,"placeholder",Tt.a=fr),Tt.o=y(kt,ze,Tt.o),Ct!==Tt.i&&Qt(kt,"placeholder",Tt.i=Ct),Tt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>It.value=mt.quantity),we(()=>Xe.value=mt.unitCost),we(()=>kt.value=mt.notes),at})()]})]})(),null),a(De,(()=>{var He=$e(()=>w().length===0);return()=>He()&&(()=>{var mt=nf();return mt.style.setProperty("text-align","center"),mt.style.setProperty("padding","2rem"),mt.style.setProperty("background","var(--background-color)"),mt.style.setProperty("border-radius","var(--border-radius-sm)"),mt.style.setProperty("border","1px solid var(--border-color)"),mt.style.setProperty("color","var(--text-muted)"),a(mt,()=>e("inventory.noProductsAdded")),mt})()})(),null),a(Y,(()=>{var He=$e(()=>w().length>0);return()=>He()&&(()=>{var mt=XE(),ut=mt.firstChild,at=ut.nextSibling,It=at.firstChild,Xe=It.firstChild,kt=It.nextSibling,Tt=at.nextSibling,wt=Tt.firstChild,Rt=wt.firstChild,fr=wt.nextSibling,ze=Tt.nextSibling,Ct=ze.firstChild,xt=Ct.firstChild,tt=Ct.nextSibling,bt=ze.nextSibling,Mt=bt.firstChild,Wt=Mt.firstChild,Jt=Mt.nextSibling;return y(mt,le),ut.style.setProperty("margin","0 0 1rem 0"),ut.style.setProperty("font-size","1rem"),a(ut,()=>e("common.summary")),a(It,()=>e("inventory.totalProducts"),Xe),kt.style.setProperty("font-weight","600"),a(kt,()=>w().length),a(wt,()=>e("inventory.totalItems"),Rt),fr.style.setProperty("font-weight","600"),a(fr,b),a(Ct,()=>e("inventory.totalValue"),xt),tt.style.setProperty("font-weight","600"),tt.style.setProperty("color","var(--primary-color)"),a(tt,()=>I(P())),a(Mt,()=>e("inventory.movementType"),Wt),Jt.style.setProperty("font-weight","600"),a(Jt,()=>F(s())),we(lt=>{var gt=L,$t=L,et=L,Vt=L;return lt.e=y(at,gt,lt.e),lt.t=y(Tt,$t,lt.t),lt.a=y(ze,et,lt.a),lt.o=y(bt,Vt,lt.o),lt},{e:void 0,t:void 0,a:void 0,o:void 0}),mt})()})(),We),a(Ke,()=>e("common.generalNotes")),st.addEventListener("change",He=>f(He.target.value)),a(Y,(()=>{var He=$e(()=>S().length>0);return()=>He()&&(()=>{var mt=nf();return y(mt,M),a(mt,D(zt,{get each(){return S()},children:ut=>(()=>{var at=ZE();return at.firstChild,a(at,ut,null),at})()})),mt})()})(),nt),y(nt,G),a(nt,D(ht,{variant:"secondary",type:"button",onClick:_,get children(){return e("common.cancel")}}),null),a(nt,D(ht,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),we(He=>{var mt=K,ut=R,at=K,It=R,Xe=e("common.referenceNumberPlaceholder"),kt=H,Tt=K,wt=k,Rt=s()==="transfer"?"1fr 1fr":"1fr",fr=K,ze=H,Ct=H,xt=K,tt={...R,"min-height":"80px",resize:"vertical"},bt=e("inventory.generalNotesPlaceholder");return He.e=y(V,mt,He.e),He.t=y(ee,ut,He.t),He.a=y(se,at,He.a),He.o=y(ue,It,He.o),Xe!==He.i&&Qt(ue,"placeholder",He.i=Xe),He.n=y(ye,kt,He.n),He.s=y(de,Tt,He.s),He.h=y(xe,wt,He.h),Rt!==He.r&&((He.r=Rt)!=null?Te.style.setProperty("grid-template-columns",Rt):Te.style.removeProperty("grid-template-columns")),He.d=y(Ie,fr,He.d),He.l=y(De,ze,He.l),He.u=y(We,Ct,He.u),He.c=y(Ke,xt,He.c),He.w=y(st,tt,He.w),bt!==He.m&&Qt(st,"placeholder",He.m=bt),He},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),we(()=>ee.value=r()),we(()=>ue.value=i()),we(()=>xe.value=s()),we(()=>st.value=g()),Y})(),D(qy,{get isOpen(){return j()},onClose:()=>oe(!1),onProductAdded:Y=>{oe(!1)}}),D(zy,{get isOpen(){return te()},onClose:()=>Z(!1),onLocationAdded:Y=>{s()==="transfer"&&!h()?m(Y):u(Y),Z(!1)}})]}})};var tT=he("<button>"),rT=he("<div><h3></h3><button> "),nT=he("<div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),of=he("<div><strong>:</strong> "),iT=he("<div>"),oT=he("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),sT=he("<div><div><h2></h2><div><select><option value=date></option><option value=quantity></option><option value=value></option></select></div></div><div>"),aT=he("<div><div><h3></h3><div></div></div><div><span></span><div>"),lT=he("<div><div><strong>:</strong> "),cT=he("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),uT=he("<div><button></button><button>"),dT=he("<tr><td></td><td></td><td></td><td></td><td></td><td>");const T5=t=>{const{t:e}=Zt(),[r,n]=Ce(null),[i,o]=Ce("date"),s=Lt(()=>{const g=t.movements||ct.movements,f=new Map;return g.forEach(w=>{const x=w.referenceNumber||w.ssg_inventory_key||w.invoiceId||"UNKNOWN";if(!f.has(x)){const j=ct.getLocationById(w.locationId);f.set(x,{referenceNumber:w.referenceNumber||"",invoiceId:w.invoiceId||"",ssg_inventory_key:w.ssg_inventory_key||"",movementType:w.movementType||"unknown",locationId:w.locationId||"",locationName:j?.name||"Unknown Location",totalItems:0,totalQuantity:0,createDate:w.createDate||new Date().toISOString(),description:w.description||"",generalNotes:w.generalNotes||"",movements:[],totalValue:0})}const S=f.get(x);S.movements.push(w),S.totalItems++,S.totalQuantity+=Math.abs(w.quantity||0);const C=ct.getProductById(w.productId);C&&C.unitCost&&(S.totalValue+=Math.abs(w.quantity||0)*C.unitCost)}),Array.from(f.values()).sort((w,x)=>{switch(i()){case"quantity":return x.totalQuantity-w.totalQuantity;case"value":return x.totalValue-w.totalValue;case"date":default:return new Date(x.createDate).getTime()-new Date(w.createDate).getTime()}})}),l=g=>new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),c=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g),u=g=>{switch(g.toLowerCase()){case"in":case"stock_in":return"#22c55e";case"out":case"stock_out":return"#ef4444";case"transfer":return"#3b82f6";case"adjustment":return"#f59e0b";default:return"#6b7280"}},h=g=>{switch(g.toLowerCase()){case"in":case"stock_in":return"";case"out":case"stock_out":return"";case"transfer":return"";case"adjustment":return"";default:return""}},m=g=>{const f=g||r();if(!f)return;const w=window.open("","_blank");if(!w)return;const x=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Bulk Movement Report - ${f.referenceNumber||f.invoiceId}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
          .group-info { background: #f8f9fa; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
          .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
          table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f2f2f2; font-weight: bold; }
          .summary { background: #e8f4fd; padding: 15px; margin-top: 20px; border-radius: 5px; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>BULK MOVEMENT REPORT</h1>
          <h2>${f.referenceNumber||f.invoiceId}</h2>
          <p>Generated: ${l(new Date().toISOString())}</p>
        </div>
        
        <div class="group-info">
          <div class="info-grid">
            <div>
              <strong>Reference Number:</strong> ${f.referenceNumber||"N/A"}<br>
              <strong>Invoice ID:</strong> ${f.invoiceId||"N/A"}<br>
              <strong>Movement Type:</strong> ${f.movementType.toUpperCase()}<br>
              <strong>Location:</strong> ${f.locationName}
            </div>
            <div>
              <strong>Date:</strong> ${l(f.createDate)}<br>
              <strong>Total Items:</strong> ${f.totalItems}<br>
              <strong>Total Quantity:</strong> ${f.totalQuantity}<br>
              <strong>Estimated Value:</strong> ${c(f.totalValue)}
            </div>
          </div>
          ${f.description?`<p><strong>Description:</strong> ${f.description}</p>`:""}
          ${f.generalNotes?`<p><strong>Notes:</strong> ${f.generalNotes}</p>`:""}
        </div>
        
        <table>
          <thead>
            <tr>
              <th>Product Code</th>
              <th>Product Name</th>
              <th>Quantity</th>
              <th>Unit Cost</th>
              <th>Total Value</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            ${f.movements.map(S=>{const C=ct.getProductById(S.productId),j=C?.unitCost||0,oe=Math.abs(S.quantity||0)*j;return`
                <tr>
                  <td>${C?.code||S.productId}</td>
                  <td>${C?.name||"Unknown Product"}</td>
                  <td>${S.quantity||0}</td>
                  <td>${c(j)}</td>
                  <td>${c(oe)}</td>
                  <td>${S.notes||"-"}</td>
                </tr>
              `}).join("")}
          </tbody>
        </table>
        
        <div class="summary">
          <h3>SUMMARY</h3>
          <p><strong>Total Products:</strong> ${f.totalItems}</p>
          <p><strong>Total Quantity Moved:</strong> ${f.totalQuantity}</p>
          <p><strong>Total Estimated Value:</strong> ${c(f.totalValue)}</p>
          <p><strong>Movement Impact:</strong> ${f.movementType==="in"?"Increased":f.movementType==="out"?"Decreased":"Adjusted"} inventory</p>
        </div>
      </body>
      </html>
    `;w.document.write(x),w.document.close(),w.print()};return(()=>{var g=sT(),f=g.firstChild,w=f.firstChild,x=w.nextSibling,S=x.firstChild,C=S.firstChild,j=C.nextSibling,oe=j.nextSibling,te=f.nextSibling;return g.style.setProperty("padding","1rem"),f.style.setProperty("display","flex"),f.style.setProperty("justify-content","space-between"),f.style.setProperty("align-items","center"),f.style.setProperty("margin-bottom","2rem"),a(w,()=>e("inventory.bulkMovementReport","Bulk Movement Report")),x.style.setProperty("display","flex"),x.style.setProperty("gap","1rem"),S.addEventListener("change",Z=>o(Z.currentTarget.value)),S.style.setProperty("padding","0.5rem"),a(C,()=>e("common.sortByDate","Sort by Date")),a(j,()=>e("common.sortByQuantity","Sort by Quantity")),a(oe,()=>e("common.sortByValue","Sort by Value")),a(x,D(Ge,{get when(){return t.onClose},get children(){var Z=tT();return hs(Z,"click",t.onClose,!0),Z.style.setProperty("padding","0.5rem 1rem"),Z.style.setProperty("background","#6c757d"),Z.style.setProperty("color","white"),Z.style.setProperty("border","none"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),Z.style.setProperty("cursor","pointer"),a(Z,()=>e("common.close","Close")),Z}}),null),te.style.setProperty("display","grid"),te.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(400px, 1fr))"),te.style.setProperty("gap","1rem"),te.style.setProperty("margin-bottom","2rem"),a(te,D(zt,{get each(){return s()},children:Z=>D(Dt,{get style(){return{cursor:"pointer",border:r()===Z?"2px solid var(--primary-color)":"1px solid #e9ecef",transition:"all 0.2s"}},onClick:()=>n(Z),get children(){return[(()=>{var re=aT(),E=re.firstChild,$=E.firstChild,T=$.nextSibling,B=E.nextSibling,_=B.firstChild,P=_.nextSibling;return re.style.setProperty("display","flex"),re.style.setProperty("justify-content","space-between"),re.style.setProperty("align-items","flex-start"),re.style.setProperty("margin-bottom","1rem"),$.style.setProperty("margin","0 0 0.5rem 0"),$.style.setProperty("font-size","1.1rem"),a($,()=>Z.referenceNumber||Z.invoiceId||"No Reference"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","#6c757d"),a(T,()=>l(Z.createDate)),B.style.setProperty("text-align","center"),_.style.setProperty("font-size","1.5rem"),a(_,()=>h(Z.movementType)),P.style.setProperty("font-size","0.75rem"),P.style.setProperty("font-weight","bold"),a(P,()=>Z.movementType.toUpperCase()),we(b=>(b=u(Z.movementType))!=null?P.style.setProperty("color",b):P.style.removeProperty("color")),re})(),(()=>{var re=lT(),E=re.firstChild,$=E.firstChild,T=$.firstChild;return $.nextSibling,re.style.setProperty("margin-bottom","1rem"),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("margin-bottom","0.25rem"),a($,()=>e("inventory.location","Location"),T),a(E,()=>Z.locationName,null),a(re,D(Ge,{get when(){return Z.description},get children(){var B=of(),_=B.firstChild,P=_.firstChild;return _.nextSibling,B.style.setProperty("font-size","0.875rem"),B.style.setProperty("margin-bottom","0.25rem"),a(_,()=>e("common.description","Description"),P),a(B,()=>Z.description,null),B}}),null),re})(),(()=>{var re=cT(),E=re.firstChild,$=E.firstChild,T=$.nextSibling,B=E.nextSibling,_=B.firstChild,P=_.nextSibling,b=B.nextSibling,H=b.firstChild,K=H.nextSibling;return re.style.setProperty("display","grid"),re.style.setProperty("grid-template-columns","repeat(3, 1fr)"),re.style.setProperty("gap","0.5rem"),re.style.setProperty("margin-bottom","1rem"),E.style.setProperty("text-align","center"),E.style.setProperty("padding","0.5rem"),E.style.setProperty("background","#f8f9fa"),E.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("font-weight","bold"),$.style.setProperty("color","#3b82f6"),a($,()=>Z.totalItems),T.style.setProperty("font-size","0.75rem"),T.style.setProperty("color","#6c757d"),a(T,()=>e("inventory.items","Items")),B.style.setProperty("text-align","center"),B.style.setProperty("padding","0.5rem"),B.style.setProperty("background","#f8f9fa"),B.style.setProperty("border-radius","var(--border-radius-sm)"),_.style.setProperty("font-weight","bold"),_.style.setProperty("color","#22c55e"),a(_,()=>Z.totalQuantity),P.style.setProperty("font-size","0.75rem"),P.style.setProperty("color","#6c757d"),a(P,()=>e("inventory.quantity","Quantity")),b.style.setProperty("text-align","center"),b.style.setProperty("padding","0.5rem"),b.style.setProperty("background","#f8f9fa"),b.style.setProperty("border-radius","var(--border-radius-sm)"),H.style.setProperty("font-weight","bold"),H.style.setProperty("color","#f59e0b"),a(H,()=>c(Z.totalValue)),K.style.setProperty("font-size","0.75rem"),K.style.setProperty("color","#6c757d"),a(K,()=>e("common.value","Value")),re})(),(()=>{var re=uT(),E=re.firstChild,$=E.nextSibling;return re.style.setProperty("display","flex"),re.style.setProperty("gap","0.5rem"),E.$$click=T=>{T.stopPropagation(),n(Z)},E.style.setProperty("flex","1"),E.style.setProperty("padding","0.5rem"),E.style.setProperty("background","var(--primary-color)"),E.style.setProperty("color","white"),E.style.setProperty("border","none"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("cursor","pointer"),E.style.setProperty("font-size","0.875rem"),a(E,()=>e("common.viewDetails","View Details")),$.$$click=T=>{T.stopPropagation(),m(Z)},$.style.setProperty("padding","0.5rem"),$.style.setProperty("background","#22c55e"),$.style.setProperty("color","white"),$.style.setProperty("border","none"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("cursor","pointer"),$.style.setProperty("font-size","0.875rem"),re})()]}})})),a(g,D(Ge,{get when(){return r()},get children(){return D(Dt,{get children(){return[(()=>{var Z=rT(),re=Z.firstChild,E=re.nextSibling;return E.firstChild,Z.style.setProperty("display","flex"),Z.style.setProperty("justify-content","space-between"),Z.style.setProperty("align-items","center"),Z.style.setProperty("margin-bottom","1rem"),a(re,()=>e("inventory.movementDetails","Movement Details")),E.$$click=()=>m(),E.style.setProperty("padding","0.5rem 1rem"),E.style.setProperty("background","#22c55e"),E.style.setProperty("color","white"),E.style.setProperty("border","none"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("cursor","pointer"),a(E,()=>e("common.print","Print Report"),null),Z})(),(()=>{var Z=nT(),re=Z.firstChild,E=re.firstChild,$=E.firstChild,T=$.firstChild;$.nextSibling;var B=E.nextSibling,_=B.firstChild,P=_.firstChild;_.nextSibling;var b=B.nextSibling,H=b.firstChild,K=H.firstChild;H.nextSibling;var R=b.nextSibling,k=R.firstChild,W=k.firstChild;k.nextSibling;var z=re.nextSibling,U=z.firstChild,le=U.firstChild,L=le.firstChild;le.nextSibling;var M=U.nextSibling,G=M.firstChild,I=G.firstChild;G.nextSibling;var F=M.nextSibling,X=F.firstChild,Y=X.firstChild;X.nextSibling;var Q=F.nextSibling,J=Q.firstChild,V=J.firstChild;return J.nextSibling,Z.style.setProperty("display","grid"),Z.style.setProperty("grid-template-columns","repeat(2, 1fr)"),Z.style.setProperty("gap","1rem"),Z.style.setProperty("margin-bottom","2rem"),Z.style.setProperty("padding","1rem"),Z.style.setProperty("background","#f8f9fa"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),a($,()=>e("inventory.referenceNumber","Reference"),T),a(E,()=>r()?.referenceNumber||"N/A",null),a(_,()=>e("inventory.invoiceId","Invoice ID"),P),a(B,()=>r()?.invoiceId||"N/A",null),a(H,()=>e("inventory.movementType","Type"),K),a(b,()=>r()?.movementType.toUpperCase(),null),a(k,()=>e("inventory.location","Location"),W),a(R,()=>r()?.locationName,null),a(le,()=>e("common.date","Date"),L),a(U,(()=>{var ne=$e(()=>!!r());return()=>ne()?l(r().createDate):""})(),null),a(G,()=>e("inventory.totalItems","Total Items"),I),a(M,()=>r()?.totalItems,null),a(X,()=>e("inventory.totalQuantity","Total Quantity"),Y),a(F,()=>r()?.totalQuantity,null),a(J,()=>e("common.estimatedValue","Estimated Value"),V),a(Q,(()=>{var ne=$e(()=>!!r());return()=>ne()?c(r().totalValue):""})(),null),Z})(),D(Ge,{get when(){return r()?.description||r()?.generalNotes},get children(){var Z=iT();return Z.style.setProperty("margin-bottom","2rem"),Z.style.setProperty("padding","1rem"),Z.style.setProperty("background","#e8f4fd"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),a(Z,D(Ge,{get when(){return r()?.description},get children(){var re=of(),E=re.firstChild,$=E.firstChild;return E.nextSibling,a(E,()=>e("common.description","Description"),$),a(re,()=>r()?.description,null),re}}),null),a(Z,D(Ge,{get when(){return r()?.generalNotes},get children(){var re=of(),E=re.firstChild,$=E.firstChild;return E.nextSibling,a(E,()=>e("common.notes","Notes"),$),a(re,()=>r()?.generalNotes,null),re}}),null),Z}}),(()=>{var Z=oT(),re=Z.firstChild,E=re.firstChild,$=E.firstChild,T=$.firstChild,B=T.nextSibling,_=B.nextSibling,P=_.nextSibling,b=P.nextSibling,H=b.nextSibling,K=E.nextSibling;return Z.style.setProperty("overflow-x","auto"),re.style.setProperty("width","100%"),re.style.setProperty("border-collapse","collapse"),$.style.setProperty("border-bottom","2px solid #dee2e6"),T.style.setProperty("padding","0.75rem"),T.style.setProperty("text-align","left"),a(T,()=>e("inventory.productCode","Code")),B.style.setProperty("padding","0.75rem"),B.style.setProperty("text-align","left"),a(B,()=>e("inventory.productName","Product")),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","center"),a(_,()=>e("inventory.quantity","Quantity")),P.style.setProperty("padding","0.75rem"),P.style.setProperty("text-align","right"),a(P,()=>e("inventory.unitCost","Unit Cost")),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","right"),a(b,()=>e("common.totalValue","Total Value")),H.style.setProperty("padding","0.75rem"),H.style.setProperty("text-align","left"),a(H,()=>e("common.notes","Notes")),a(K,D(zt,{get each(){return r()?.movements||[]},children:R=>{const k=ct.getProductById(R.productId),W=k?.unitCost||0,z=Math.abs(R.quantity||0)*W;return(()=>{var U=dT(),le=U.firstChild,L=le.nextSibling,M=L.nextSibling,G=M.nextSibling,I=G.nextSibling,F=I.nextSibling;return U.style.setProperty("border-bottom","1px solid #dee2e6"),le.style.setProperty("padding","0.75rem"),le.style.setProperty("font-family","monospace"),a(le,()=>k?.code||R.productId),L.style.setProperty("padding","0.75rem"),a(L,()=>k?.name||"Unknown Product"),M.style.setProperty("padding","0.75rem"),M.style.setProperty("text-align","center"),M.style.setProperty("font-weight","bold"),a(M,()=>R.quantity||0),G.style.setProperty("padding","0.75rem"),G.style.setProperty("text-align","right"),a(G,()=>c(W)),I.style.setProperty("padding","0.75rem"),I.style.setProperty("text-align","right"),I.style.setProperty("font-weight","bold"),a(I,()=>c(z)),F.style.setProperty("padding","0.75rem"),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","#6c757d"),a(F,()=>R.notes||"-"),we(X=>(X=(R.quantity||0)>=0?"#22c55e":"#ef4444")!=null?M.style.setProperty("color",X):M.style.removeProperty("color")),U})()}})),Z})()]}})}}),null),we(()=>S.value=i()),g})()};pr(["click"]);var hT=he("<div><div><div><h2>Bulk Movement Report - </h2><button></button></div><div>");const pT=t=>{const[e,r]=Ce(!0),[n,i]=Ce(!1),[o,s]=Ce([]),[l,c]=Ce(""),u=g=>{const f=ct.movements.filter(w=>w.referenceNumber===g||w.invoiceId===g||w.ssg_inventory_key===g);s(f),c(g),r(!1),i(!0)},h=()=>{r(!1),t.onClose()},m=()=>{i(!1),t.onClose()};return[D(Ge,{get when(){return e()},get children(){return D(eT,{get isOpen(){return $e(()=>!!t.isOpen)()&&e()},onClose:h,onMovementComplete:u})}}),D(Ge,{get when(){return n()},get children(){var g=hT(),f=g.firstChild,w=f.firstChild,x=w.firstChild;x.firstChild;var S=x.nextSibling,C=w.nextSibling;return g.style.setProperty("position","fixed"),g.style.setProperty("top","0"),g.style.setProperty("left","0"),g.style.setProperty("right","0"),g.style.setProperty("bottom","0"),g.style.setProperty("background","rgba(0, 0, 0, 0.5)"),g.style.setProperty("z-index","1000"),g.style.setProperty("display","flex"),g.style.setProperty("align-items","center"),g.style.setProperty("justify-content","center"),g.style.setProperty("padding","2rem"),f.style.setProperty("background","white"),f.style.setProperty("border-radius","var(--border-radius)"),f.style.setProperty("width","95%"),f.style.setProperty("max-width","1200px"),f.style.setProperty("max-height","90vh"),f.style.setProperty("overflow-y","auto"),f.style.setProperty("position","relative"),w.style.setProperty("padding","1rem 2rem"),w.style.setProperty("border-bottom","1px solid #e9ecef"),w.style.setProperty("display","flex"),w.style.setProperty("justify-content","space-between"),w.style.setProperty("align-items","center"),w.style.setProperty("background","#f8f9fa"),x.style.setProperty("margin","0"),a(x,l,null),S.$$click=m,S.style.setProperty("background","none"),S.style.setProperty("border","none"),S.style.setProperty("font-size","1.5rem"),S.style.setProperty("cursor","pointer"),S.style.setProperty("padding","0.5rem"),S.style.setProperty("line-height","1"),C.style.setProperty("padding","1rem"),a(C,D(T5,{get movements(){return o()},onClose:m})),g}})]};pr(["click"]);var fT=he("<div><div></div><div></div><div></div><div>"),mT=he("<div><strong>:</strong> "),yT=he("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),gT=he("<div>");const vT=t=>{const{t:e}=Zt(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={"text-align":"center","margin-bottom":"2rem"},s={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},l={color:"var(--text-muted)","font-size":"1rem"},c={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},u=(x,S)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:x>S?"#d4edda":"#f8d7da",color:x>S?"#155724":"#721c24"}),h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},m={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const g=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),f=x=>new Date(x).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),w=t.item.price*t.item.quantity;return D(qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var x=fT(),S=x.firstChild,C=S.nextSibling,j=C.nextSibling,oe=j.nextSibling;return y(x,o),y(S,s),a(S,()=>t.item.name),y(C,l),a(C,()=>t.item.category),y(j,c),a(j,()=>g(t.item.price)),a(oe,(()=>{var te=$e(()=>t.item.quantity>t.item.minStock);return()=>te()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),we(te=>y(oe,u(t.item.quantity,t.item.minStock),te)),x})(),(()=>{var x=mT(),S=x.firstChild,C=S.firstChild;return S.nextSibling,y(x,m),a(S,()=>e("common.description"),C),a(x,()=>t.item.description,null),x})(),(()=>{var x=yT(),S=x.firstChild,C=S.firstChild,j=C.nextSibling,oe=S.nextSibling,te=oe.firstChild,Z=te.nextSibling,re=Z.firstChild,E=oe.nextSibling,$=E.firstChild,T=$.nextSibling,B=T.firstChild,_=E.nextSibling,P=_.firstChild,b=P.nextSibling,H=_.nextSibling,K=H.firstChild,R=K.nextSibling,k=H.nextSibling,W=k.firstChild,z=W.nextSibling,U=k.nextSibling,le=U.firstChild,L=le.nextSibling;return a(C,()=>e("inventory.sku")),a(j,()=>t.item.sku),a(te,()=>e("inventory.quantity")),a(Z,()=>t.item.quantity,re),a(Z,()=>e("common.units"),null),a($,()=>e("inventory.minimumStock")),a(T,()=>t.item.minStock,B),a(T,()=>e("common.units"),null),a(P,()=>e("inventory.totalValue")),a(b,()=>g(w)),a(K,()=>e("inventory.supplier")),a(R,()=>t.item.supplier),a(W,()=>e("inventory.location")),a(z,()=>t.item.location),a(le,()=>e("common.lastUpdated")),a(L,()=>f(t.item.lastUpdated)),we(M=>{var G=r,I=n,F=i,X=r,Y=n,Q=i,J=r,V=n,ne=i,ee=r,ce=n,se=i,q=r,ue=n,ye=i,de=r,ge=n,xe=i,pe=r,_e=n,Re=i;return M.e=y(S,G,M.e),M.t=y(C,I,M.t),M.a=y(j,F,M.a),M.o=y(oe,X,M.o),M.i=y(te,Y,M.i),M.n=y(Z,Q,M.n),M.s=y(E,J,M.s),M.h=y($,V,M.h),M.r=y(T,ne,M.r),M.d=y(_,ee,M.d),M.l=y(P,ce,M.l),M.u=y(b,se,M.u),M.c=y(H,q,M.c),M.w=y(K,ue,M.w),M.m=y(R,ye,M.m),M.f=y(k,de,M.f),M.y=y(W,ge,M.y),M.g=y(z,xe,M.g),M.p=y(U,pe,M.p),M.b=y(le,_e,M.b),M.T=y(L,Re,M.T),M},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),x})(),(()=>{var x=gT();return y(x,h),a(x,D(ht,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(x,D(ht,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),x})()]}})};var bT=he("<div>"),_T=he("<button type=button>"),ST=he("<div> "),g0=he("<div>"),PT=he("<div><div><input type=text autocomplete=off>"),wT=he("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),xT=he("<span> ");const AT=t=>{const{t:e}=Zt(),[r,n]=Ce(""),[i,o]=Ce(!1),[s,l]=Ce(null),[c,u]=Ce([]),[h,m]=Ce(!1),[g,f]=Ce(-1),[w,x]=Ce(null),S=t.searchDelay||300;t.maxResults;const C=async G=>{if(!G.trim()||G.trim().length<3){u([]),t.onSearchResults?.([]);return}try{o(!0),l(null);try{console.log("apiResults",G),t.onSearchResults?.(G)}catch(I){console.warn("API search failed, using local fallback:",I),l("API search failed, showing local results")}}catch(I){const F=I instanceof Error?I.message:"Search failed";l(F),u([]),t.onSearchResults?.([])}finally{o(!1)}},j=G=>{const F=G.target.value;n(F),l(null),console.log(),t.showResults,w()&&clearTimeout(w());const X=setTimeout(()=>{C(F)},S);x(X)},oe=G=>{n(G.name),m(!1),f(-1),t.onInventorySelect?.(G)},te=G=>{if(!(!h()||c().length===0))switch(G.key){case"ArrowDown":G.preventDefault(),f(I=>Math.min(I+1,c().length-1));break;case"ArrowUp":G.preventDefault(),f(I=>Math.max(I-1,-1));break;case"Enter":G.preventDefault(),g()>=0&&c()[g()]&&oe(c()[g()]);break;case"Escape":m(!1),f(-1);break}},Z=()=>{t.showResults!==!1&&c().length>0&&m(!0)},re=()=>{setTimeout(()=>{m(!1),f(-1)},150)},E=()=>{n(""),u([]),l(null),m(!1),f(-1),t.onSearchResults?.([]),w()&&(clearTimeout(w()),x(null))},$=G=>ct.stockLevels.filter(I=>I.inventoryId===G).reduce((I,F)=>I+F.quantity,0),T=G=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(G),B={position:"relative",width:"100%",...t.style},_={position:"relative",display:"flex","align-items":"center"},P={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},b={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},H={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},K={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},R=G=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:G?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),k={display:"flex","justify-content":"space-between","align-items":"center"},W={flex:"1"},z={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},U={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},le={"text-align":"right","font-size":"0.875rem"},L={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},M={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var G=PT(),I=G.firstChild,F=I.firstChild;return F.addEventListener("blur",re),F.addEventListener("focus",Z),F.$$keydown=te,F.$$input=j,a(I,D(Ge,{get when(){return i()},get children(){var X=bT();return we(Y=>y(X,H,Y)),X}}),null),a(I,D(Ge,{get when(){return $e(()=>!!r())()&&!i()},get children(){var X=_T();return X.addEventListener("mouseleave",Y=>{Y.currentTarget.style.background="none",Y.currentTarget.style.color="var(--text-muted)"}),X.addEventListener("mouseenter",Y=>{Y.currentTarget.style.background="var(--border-color)",Y.currentTarget.style.color="var(--text-primary)"}),X.$$click=E,we(Y=>{var Q=b,J=e("common.clear","Clear search");return Y.e=y(X,Q,Y.e),J!==Y.t&&Qt(X,"title",Y.t=J),Y},{e:void 0,t:void 0}),X}}),null),a(G,D(Ge,{get when(){return h()&&t.showResults!==!1},get children(){var X=g0();return a(X,D(Ge,{get when(){return s()},get children(){var Y=ST();return Y.firstChild,y(Y,M),a(Y,s,null),Y}}),null),a(X,D(Ge,{get when(){return c().length>0},get fallback(){return $e(()=>!!(r()&&!i()))()&&(()=>{var Y=g0();return y(Y,L),a(Y,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),Y})()},get children(){return D(zt,{get each(){return c()},children:(Y,Q)=>{const J=$(Y.id),V=J<=Y.minStockLevel;return(()=>{var ne=wT(),ee=ne.firstChild,ce=ee.firstChild,se=ce.firstChild,q=se.nextSibling,ue=q.firstChild,ye=ue.firstChild,de=ue.nextSibling,ge=de.nextSibling,xe=ge.nextSibling,pe=xe.nextSibling,_e=ce.nextSibling,Re=_e.firstChild,Ee=Re.firstChild,Te=Re.nextSibling;return ne.addEventListener("mouseenter",()=>f(Q())),ne.$$click=()=>oe(Y),y(ee,k),y(ce,W),y(se,z),a(se,()=>Y.name),y(q,U),a(ue,()=>e("inventory.sku","SKU"),ye),a(ue,()=>Y.sku,null),a(ge,()=>Y.category),a(pe,()=>T(Y.unitCost)),y(_e,le),Re.style.setProperty("font-weight","600"),(V?"#f44336":"var(--text-primary)")!=null?Re.style.setProperty("color",V?"#f44336":"var(--text-primary)"):Re.style.removeProperty("color"),a(Re,J,Ee),a(Re,()=>Y.unitOfMeasure,null),Te.style.setProperty("color","var(--text-muted)"),a(Te,()=>V?(()=>{var Le=xT();return Le.firstChild,Le.style.setProperty("color","#f44336"),a(Le,()=>e("inventory.lowStock","Low Stock"),null),Le})():e("inventory.inStock","In Stock")),we(Le=>y(ne,R(Q()===g()),Le)),ne})()}})}}),null),we(Y=>y(X,K,Y)),X}}),null),we(X=>{var Y=B,Q=_,J=P,V=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),ne=t.disabled;return X.e=y(G,Y,X.e),X.t=y(I,Q,X.t),X.a=y(F,J,X.a),V!==X.o&&Qt(F,"placeholder",X.o=V),ne!==X.i&&(F.disabled=X.i=ne),X},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>F.value=r()),G})()};pr(["input","keydown","click"]);var CT=he("<div>"),sf=he("<div><span>:</span><span>"),IT=he("<div><button> "),$T=he("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const ET=t=>{const{t:e}=Zt(),r=f=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(f),n=f=>new Date(f).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=f=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[f]||{bg:"#f5f5f5",color:"#666"},o=f=>({in:"",out:"",transfer:"",adjustment:""})[f]||"",s=()=>t.movement,l={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},c={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},u={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},h={"margin-bottom":"1.5rem"},m={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},g=f=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:i(f).bg,color:i(f).color});return D(qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return D(Ge,{get when(){return s()},get fallback(){return(()=>{var f=CT();return a(f,()=>e("common.noDataFound")),f})()},children:f=>(()=>{var w=$T(),x=w.firstChild,S=x.firstChild,C=S.firstChild,j=C.nextSibling,oe=j.firstChild,te=S.nextSibling,Z=te.firstChild,re=x.nextSibling,E=re.firstChild,$=E.nextSibling,T=$.firstChild,B=T.firstChild,_=T.nextSibling,P=$.nextSibling,b=P.firstChild,H=b.firstChild,K=b.nextSibling,R=K.firstChild,k=P.nextSibling,W=k.firstChild,z=W.firstChild,U=W.nextSibling,le=k.nextSibling,L=le.firstChild,M=L.firstChild,G=M.nextSibling;G.nextSibling;var I=L.nextSibling,F=re.nextSibling,X=F.firstChild,Y=X.nextSibling,Q=Y.firstChild,J=Q.firstChild,V=Q.nextSibling,ne=F.nextSibling,ee=ne.firstChild,ce=ee.nextSibling,se=ce.firstChild,q=se.firstChild,ue=se.nextSibling,ye=ce.nextSibling,de=ye.firstChild,ge=de.firstChild,xe=de.nextSibling;return x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),x.style.setProperty("margin-bottom","1.5rem"),x.style.setProperty("padding-bottom","1rem"),x.style.setProperty("border-bottom","2px solid var(--border-color)"),C.style.setProperty("margin","0 0 0.5rem 0"),C.style.setProperty("font-size","1.25rem"),a(C,()=>f().productName),j.style.setProperty("font-size","0.875rem"),j.style.setProperty("color","var(--text-muted)"),a(j,()=>e("inventory.sku"),oe),a(j,()=>f().productSku,null),te.$$click=()=>ct.generateMovementInvoice(f().id,e),Z.style.setProperty("font-size","1.2rem"),a(Z,()=>o(f().movementType)),a(te,()=>f().movementType,null),a(E,()=>e("inventory.movementInformation")),a(T,()=>e("inventory.referenceNumber"),B),a(_,()=>f().referenceNumber),a(b,()=>e("common.quantity"),H),a(K,()=>f().quantity,R),a(K,()=>e("common.units"),null),a(W,()=>e("inventory.unitCost"),z),a(U,()=>r(f().unitCost)),a(L,()=>e("common.total"),M),a(L,()=>e("common.value"),G),a(I,()=>r(f().totalCost)),a(X,()=>e("inventory.locationInformation")),a(Q,()=>e("inventory.location"),J),a(V,()=>f().locationName),a(F,D(Ge,{get when(){return f().fromLocationName},get children(){var pe=sf(),_e=pe.firstChild,Re=_e.firstChild,Ee=_e.nextSibling;return a(_e,()=>e("common.from"),Re),a(Ee,()=>f().fromLocationName),we(Te=>{var Le=l,Ie=c,De=u;return Te.e=y(pe,Le,Te.e),Te.t=y(_e,Ie,Te.t),Te.a=y(Ee,De,Te.a),Te},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(F,D(Ge,{get when(){return f().invoiceId},get children(){var pe=sf(),_e=pe.firstChild,Re=_e.firstChild,Ee=_e.nextSibling;return a(_e,()=>e("common.invoice"),Re),a(Ee,()=>f().invoiceId),we(Te=>{var Le=l,Ie=c,De={...u,color:"var(--primary-color)"};return Te.e=y(pe,Le,Te.e),Te.t=y(_e,Ie,Te.t),Te.a=y(Ee,De,Te.a),Te},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(ee,()=>e("common.details")),a(se,()=>e("common.createdBy"),q),a(ue,()=>f().createdBy),a(de,()=>e("common.created"),ge),a(xe,()=>n(f().createdDate)),a(ne,D(Ge,{get when(){return f().notes},get children(){var pe=sf(),_e=pe.firstChild,Re=_e.firstChild,Ee=_e.nextSibling;return a(_e,()=>e("common.notes"),Re),a(Ee,()=>f().notes),we(Te=>{var Le={...l,"border-bottom":"none"},Ie=c,De={...u,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return Te.e=y(pe,Le,Te.e),Te.t=y(_e,Ie,Te.t),Te.a=y(Ee,De,Te.a),Te},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(w,D(Ge,{get when(){return t.onEdit},get children(){var pe=IT(),_e=pe.firstChild,Re=_e.firstChild;return pe.style.setProperty("display","flex"),pe.style.setProperty("justify-content","flex-end"),pe.style.setProperty("margin-top","1.5rem"),pe.style.setProperty("padding-top","1rem"),pe.style.setProperty("border-top","1px solid var(--border-color)"),_e.addEventListener("mouseleave",Ee=>{Ee.currentTarget.style.transform="translateY(0)",Ee.currentTarget.style.boxShadow="none"}),_e.addEventListener("mouseenter",Ee=>{Ee.currentTarget.style.transform="translateY(-1px)",Ee.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),_e.$$click=()=>t.onEdit?.(f()),_e.style.setProperty("padding","0.5rem 1.5rem"),_e.style.setProperty("border-radius","var(--border-radius-sm)"),_e.style.setProperty("border","1px solid var(--primary-color)"),_e.style.setProperty("background","var(--primary-color)"),_e.style.setProperty("color","white"),_e.style.setProperty("cursor","pointer"),_e.style.setProperty("font-weight","500"),_e.style.setProperty("transition","all 0.2s ease"),a(_e,()=>e("common.edit"),Re),a(_e,()=>e("inventory.movement"),null),pe}}),null),we(pe=>{var _e=g(f().movementType),Re=h,Ee=m,Te=l,Le=c,Ie=u,De=l,Ye=c,Be={...u,"font-size":"1.1rem",color:"var(--primary-color)"},We=l,Ke=c,st=u,nt=l,He=c,mt={...u,"font-size":"1.1rem",color:"var(--primary-color)"},ut=h,at=m,It=l,Xe=c,kt=u,Tt=h,wt=m,Rt=l,fr=c,ze=u,Ct=l,xt=c,tt=u;return pe.e=y(te,_e,pe.e),pe.t=y(re,Re,pe.t),pe.a=y(E,Ee,pe.a),pe.o=y($,Te,pe.o),pe.i=y(T,Le,pe.i),pe.n=y(_,Ie,pe.n),pe.s=y(P,De,pe.s),pe.h=y(b,Ye,pe.h),pe.r=y(K,Be,pe.r),pe.d=y(k,We,pe.d),pe.l=y(W,Ke,pe.l),pe.u=y(U,st,pe.u),pe.c=y(le,nt,pe.c),pe.w=y(L,He,pe.w),pe.m=y(I,mt,pe.m),pe.f=y(F,ut,pe.f),pe.y=y(X,at,pe.y),pe.g=y(Y,It,pe.g),pe.p=y(Q,Xe,pe.p),pe.b=y(V,kt,pe.b),pe.T=y(ne,Tt,pe.T),pe.A=y(ee,wt,pe.A),pe.O=y(ce,Rt,pe.O),pe.I=y(se,fr,pe.I),pe.S=y(ue,ze,pe.S),pe.W=y(ye,Ct,pe.W),pe.C=y(de,xt,pe.C),pe.B=y(xe,tt,pe.B),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),w})()})}})};pr(["click"]);var sl=he("<div>"),TT=he("<div><label></label><select><option value>"),kT=he("<div><div><span>:</span><span>$"),NT=he("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),v0=he("<option> (<!>)");const LT=t=>{const{t:e}=Zt(),[r,n]=Ce("in"),[i,o]=Ce(""),[s,l]=Ce(""),[c,u]=Ce(""),[h,m]=Ce(""),[g,f]=Ce(""),[w,x]=Ce(""),[S,C]=Ce(""),[j,oe]=Ce(!1),[te,Z]=Ce({});Ei(()=>{const H=t.movement;H&&t.isOpen&&(n(H.movementType),o(H.quantity.toString()),l(H.unitCost.toString()),u(H.referenceNumber),m(H.notes),x(H.locationId),f(H.fromLocationId||""),C(H.invoiceId||""),Z({}))});const re=()=>{const H={};return(!i()||parseFloat(i())<=0)&&(H.quantity=e("forms.requiredField")),(!s()||parseFloat(s())<0)&&(H.unitCost=e("forms.requiredField")),c().trim()||(H.referenceNumber=e("forms.requiredField")),w()||(H.locationId=e("forms.requiredField")),r()==="transfer"&&!g()&&(H.fromLocationId=e("forms.requiredField")),Z(H),Object.keys(H).length===0},E=async H=>{if(H.preventDefault(),!(!re()||!t.movement)){oe(!0);try{const K=t.movement,R=ct.getProductById(K.productId),k=ct.getLocationById(w()),W=g()?ct.getLocationById(g()):null;if(!R||!k)throw new Error("Product or location not found");const z={...K,movementType:r(),quantity:parseFloat(i()),unitCost:parseFloat(s()),totalCost:parseFloat(i())*parseFloat(s()),referenceNumber:c().trim(),notes:h().trim(),locationId:w(),locationName:k.name,fromLocationId:g()||void 0,fromLocationName:W?.name,invoiceId:S().trim()||void 0,lastModified:new Date().toISOString()};ct.updateMovement(K.id,z),t.onMovementUpdated?.(),t.onClose(),$()}catch(K){console.error("Error updating movement:",K),Z({submit:e("forms.saveError")})}finally{oe(!1)}}},$=()=>{n("in"),o(""),l(""),u(""),m(""),f(""),x(""),C(""),Z({})},T=()=>{$(),t.onClose()},B={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},_={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},P={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},b={"margin-bottom":"1rem"};return D(qn,{get isOpen(){return t.isOpen},onClose:T,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return D(Ge,{get when(){return t.movement},get fallback(){return(()=>{var H=sl();return a(H,()=>e("common.loading")),H})()},get children(){var H=NT(),K=H.firstChild,R=K.firstChild,k=R.nextSibling,W=k.firstChild,z=W.nextSibling,U=z.nextSibling,le=U.nextSibling,L=K.nextSibling,M=L.firstChild,G=M.nextSibling,I=G.firstChild,F=L.nextSibling,X=F.firstChild,Y=X.nextSibling,Q=F.nextSibling,J=Q.firstChild,V=J.nextSibling,ne=Q.nextSibling,ee=ne.firstChild,ce=ee.nextSibling,se=ne.nextSibling,q=se.firstChild,ue=q.firstChild,ye=ue.nextSibling;ye.nextSibling;var de=q.nextSibling,ge=se.nextSibling,xe=ge.firstChild,pe=xe.firstChild,_e=pe.nextSibling;_e.nextSibling;var Re=xe.nextSibling,Ee=ge.nextSibling,Te=Ee.firstChild,Le=Te.nextSibling;return H.addEventListener("submit",E),a(R,()=>e("inventory.movementType")),k.addEventListener("change",Ie=>n(Ie.target.value)),a(W,()=>e("inventory.stockIn")),a(z,()=>e("inventory.stockOut")),a(U,()=>e("inventory.transfer")),a(le,()=>e("inventory.adjustment")),a(M,(()=>{var Ie=$e(()=>r()==="transfer");return()=>Ie()?e("inventory.toLocation"):e("inventory.location")})()),G.addEventListener("change",Ie=>x(Ie.target.value)),a(I,()=>e("modals.selectLocation")),a(G,D(zt,{get each(){return ct.getActiveLocations()},children:Ie=>(()=>{var De=v0(),Ye=De.firstChild,Be=Ye.nextSibling;return Be.nextSibling,a(De,()=>Ie.name,Ye),a(De,()=>Ie.type,Be),we(()=>De.value=Ie.id),De})()}),null),a(L,D(Ge,{get when(){return te().locationId},get children(){var Ie=sl();return a(Ie,()=>te().locationId),we(De=>y(Ie,P,De)),Ie}}),null),a(H,D(Ge,{get when(){return r()==="transfer"},get children(){var Ie=TT(),De=Ie.firstChild,Ye=De.nextSibling,Be=Ye.firstChild;return a(De,()=>e("inventory.fromLocation")),Ye.addEventListener("change",We=>f(We.target.value)),a(Be,()=>e("modals.selectLocation")),a(Ye,D(zt,{get each(){return ct.getActiveLocations().filter(We=>We.id!==w())},children:We=>(()=>{var Ke=v0(),st=Ke.firstChild,nt=st.nextSibling;return nt.nextSibling,a(Ke,()=>We.name,st),a(Ke,()=>We.type,nt),we(()=>Ke.value=We.id),Ke})()}),null),a(Ie,D(Ge,{get when(){return te().fromLocationId},get children(){var We=sl();return a(We,()=>te().fromLocationId),we(Ke=>y(We,P,Ke)),We}}),null),we(We=>{var Ke=b,st=_,nt={...B,"border-color":te().fromLocationId?"#d32f2f":"var(--border-color)"},He=j();return We.e=y(Ie,Ke,We.e),We.t=y(De,st,We.t),We.a=y(Ye,nt,We.a),He!==We.o&&(Ye.disabled=We.o=He),We},{e:void 0,t:void 0,a:void 0,o:void 0}),we(()=>Ye.value=g()),Ie}}),F),a(X,()=>e("common.quantity")),Y.$$input=Ie=>o(Ie.target.value),a(F,D(Ge,{get when(){return te().quantity},get children(){var Ie=sl();return a(Ie,()=>te().quantity),we(De=>y(Ie,P,De)),Ie}}),null),a(J,()=>e("inventory.unitCost")),V.$$input=Ie=>l(Ie.target.value),a(Q,D(Ge,{get when(){return te().unitCost},get children(){var Ie=sl();return a(Ie,()=>te().unitCost),we(De=>y(Ie,P,De)),Ie}}),null),a(H,D(Ge,{get when(){return $e(()=>!!i())()&&s()},get children(){var Ie=kT(),De=Ie.firstChild,Ye=De.firstChild,Be=Ye.firstChild,We=Ye.nextSibling;return We.firstChild,De.style.setProperty("display","flex"),De.style.setProperty("justify-content","space-between"),Ye.style.setProperty("font-weight","500"),a(Ye,()=>e("common.total"),Be),We.style.setProperty("font-weight","600"),We.style.setProperty("color","var(--primary-color)"),a(We,()=>(parseFloat(i()||"0")*parseFloat(s()||"0")).toFixed(2),null),we(Ke=>y(Ie,{...b,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},Ke)),Ie}}),ne),a(ee,()=>e("inventory.referenceNumber")),ce.$$input=Ie=>u(Ie.target.value),a(ne,D(Ge,{get when(){return te().referenceNumber},get children(){var Ie=sl();return a(Ie,()=>te().referenceNumber),we(De=>y(Ie,P,De)),Ie}}),null),a(q,()=>e("inventory.invoiceNumber"),ue),a(q,()=>e("common.optional"),ye),de.$$input=Ie=>C(Ie.target.value),a(xe,()=>e("common.notes"),pe),a(xe,()=>e("common.optional"),_e),Re.$$input=Ie=>m(Ie.target.value),a(H,D(Ge,{get when(){return te().submit},get children(){var Ie=sl();return a(Ie,()=>te().submit),we(De=>y(Ie,{...P,"margin-bottom":"1rem"},De)),Ie}}),Ee),Ee.style.setProperty("display","flex"),Ee.style.setProperty("gap","1rem"),Ee.style.setProperty("justify-content","flex-end"),Te.$$click=T,Te.style.setProperty("padding","0.5rem 1rem"),Te.style.setProperty("border","1px solid var(--border-color)"),Te.style.setProperty("border-radius","var(--border-radius-sm)"),Te.style.setProperty("background","white"),Te.style.setProperty("cursor","pointer"),a(Te,()=>e("common.cancel")),Le.style.setProperty("padding","0.5rem 1rem"),Le.style.setProperty("border","none"),Le.style.setProperty("border-radius","var(--border-radius-sm)"),Le.style.setProperty("background","var(--primary-color)"),Le.style.setProperty("color","white"),Le.style.setProperty("cursor","pointer"),Le.style.setProperty("font-weight","500"),a(Le,(()=>{var Ie=$e(()=>!!j());return()=>Ie()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),we(Ie=>{var De=b,Ye=_,Be=B,We=j(),Ke=b,st=_,nt={...B,"border-color":te().locationId?"#d32f2f":"var(--border-color)"},He=j(),mt=b,ut=_,at={...B,"border-color":te().quantity?"#d32f2f":"var(--border-color)"},It=e("modals.enterQuantity"),Xe=j(),kt=b,Tt=_,wt={...B,"border-color":te().unitCost?"#d32f2f":"var(--border-color)"},Rt=e("modals.enterCost"),fr=j(),ze=b,Ct=_,xt={...B,"border-color":te().referenceNumber?"#d32f2f":"var(--border-color)"},tt=e("modals.enterReference"),bt=j(),Mt=b,Wt=_,Jt=B,lt=e("inventory.invoiceNumber"),gt=j(),$t=b,et=_,Vt={...B,resize:"vertical","min-height":"80px"},Ht=e("modals.addNotes"),Xt=j(),er=j(),Kt=j();return Ie.e=y(K,De,Ie.e),Ie.t=y(R,Ye,Ie.t),Ie.a=y(k,Be,Ie.a),We!==Ie.o&&(k.disabled=Ie.o=We),Ie.i=y(L,Ke,Ie.i),Ie.n=y(M,st,Ie.n),Ie.s=y(G,nt,Ie.s),He!==Ie.h&&(G.disabled=Ie.h=He),Ie.r=y(F,mt,Ie.r),Ie.d=y(X,ut,Ie.d),Ie.l=y(Y,at,Ie.l),It!==Ie.u&&Qt(Y,"placeholder",Ie.u=It),Xe!==Ie.c&&(Y.disabled=Ie.c=Xe),Ie.w=y(Q,kt,Ie.w),Ie.m=y(J,Tt,Ie.m),Ie.f=y(V,wt,Ie.f),Rt!==Ie.y&&Qt(V,"placeholder",Ie.y=Rt),fr!==Ie.g&&(V.disabled=Ie.g=fr),Ie.p=y(ne,ze,Ie.p),Ie.b=y(ee,Ct,Ie.b),Ie.T=y(ce,xt,Ie.T),tt!==Ie.A&&Qt(ce,"placeholder",Ie.A=tt),bt!==Ie.O&&(ce.disabled=Ie.O=bt),Ie.I=y(se,Mt,Ie.I),Ie.S=y(q,Wt,Ie.S),Ie.W=y(de,Jt,Ie.W),lt!==Ie.C&&Qt(de,"placeholder",Ie.C=lt),gt!==Ie.B&&(de.disabled=Ie.B=gt),Ie.v=y(ge,$t,Ie.v),Ie.k=y(xe,et,Ie.k),Ie.x=y(Re,Vt,Ie.x),Ht!==Ie.j&&Qt(Re,"placeholder",Ie.j=Ht),Xt!==Ie.q&&(Re.disabled=Ie.q=Xt),er!==Ie.z&&(Te.disabled=Ie.z=er),Kt!==Ie.P&&(Le.disabled=Ie.P=Kt),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),we(()=>k.value=r()),we(()=>G.value=w()),we(()=>Y.value=i()),we(()=>V.value=s()),we(()=>ce.value=c()),we(()=>de.value=S()),we(()=>Re.value=h()),H}})}})};pr(["input","click"]);var RT=he("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),DT=he("<div><h2>"),MT=he("<div><label>"),FT=he("<div><label></label><select><option value>"),OT=he("<option>"),BT=he("<div><div></div><div></div><div>"),jT=he("<div><div><div><div><span></span><h3></h3><span></span></div><div>  </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),VT=he("<span>"),qT=he("<span> <!>: "),b0=he("<div><span>:</span><span>"),zT=he("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),UT=he("<span>..."),HT=he("<button>");const GT=t=>{const{t:e}=Zt(),[r,n]=Ce(""),[i,o]=Ce(""),[s,l]=Ce("all"),[c,u]=Ce({start:"",end:""}),[h,m]=Ce(""),[g,f]=Ce(""),[w,x]=Ce(1),[S,C]=Ce(25),[j,oe]=Ce(null),[te,Z]=Ce(!1),[re,E]=Ce(!1),$=Lt(()=>{let de=ct.movements;if(t.filterBy==="product"&&t.filterId?de=de.filter(ge=>ge.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(de=de.filter(ge=>ge.locationId===t.filterId)),r()&&(de=de.filter(ge=>ge.productId===r())),i()&&(de=de.filter(ge=>ge.locationId===i())),s()!=="all"&&(de=de.filter(ge=>ge.movementType===s())),c().start&&(de=de.filter(ge=>ge.createdDate>=c().start)),c().end&&(de=de.filter(ge=>ge.createdDate<=c().end+"T23:59:59Z")),h()){const ge=h().toLowerCase();de=de.filter(xe=>xe.productName.toLowerCase().includes(ge)||xe.productSku.toLowerCase().includes(ge)||xe.locationName.toLowerCase().includes(ge)||xe.referenceNumber.toLowerCase().includes(ge)||xe.notes.toLowerCase().includes(ge)||xe.createdBy.toLowerCase().includes(ge)||xe.invoiceId&&xe.invoiceId.toLowerCase().includes(ge)||xe.fromLocationName&&xe.fromLocationName.toLowerCase().includes(ge)||xe.movementType.toLowerCase().includes(ge))}return de.sort((ge,xe)=>new Date(xe.createdDate).getTime()-new Date(ge.createdDate).getTime())});Ei(()=>{r(),i(),s(),c(),h(),x(1)});const T=Lt(()=>{const de=(w()-1)*S(),ge=de+S();return $().slice(de,ge)}),B=Lt(()=>Math.ceil($().length/S())),_=Lt(()=>{const de=$();return{total:de.length,stockIn:de.filter(ge=>ge.movementType==="in").length,stockOut:de.filter(ge=>ge.movementType==="out").length,transfers:de.filter(ge=>ge.movementType==="transfer").length,adjustments:de.filter(ge=>ge.movementType==="adjustment").length,totalValue:de.reduce((ge,xe)=>ge+xe.totalCost,0)}}),P={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},b={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},H={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},K={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},R={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},k={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},W={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},z={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},U={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},le={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function L(de){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[de]||{bg:"#f5f5f5",color:"#666"}}const M=de=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:L(de).bg,color:L(de).color}),G={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},I={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},F={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},X={"font-weight":"600",color:"var(--text-primary)"},Y={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},Q=de=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:de?"var(--primary-color)":"var(--surface-color)",color:de?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),J=de=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(de),V=de=>new Date(de).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ne=de=>({in:"",out:"",transfer:"",adjustment:""})[de]||"",ee=()=>{n(""),o(""),l("all"),u({start:"",end:""}),m(""),x(1)},ce=de=>{oe(de),Z(!0)},se=de=>{oe(de),Z(!1),E(!0)},q=()=>{E(!1),oe(null)},ue=async de=>{i()&&(de+=" "+i()),Gf(s())&&(de+=" "+Gf(s()));const ge=await Ti.getInventory(de),xe=ct.parseInventoryData(ge);ct.updMovements(xe)},ye=()=>{};return(()=>{var de=RT(),ge=de.firstChild,xe=ge.nextSibling,pe=xe.firstChild,_e=pe.firstChild,Re=_e.nextSibling,Ee=Re.firstChild,Te=Ee.nextSibling,Le=Te.nextSibling,Ie=Le.nextSibling,De=Ie.nextSibling,Ye=pe.nextSibling,Be=Ye.firstChild,We=Be.nextSibling,Ke=Ye.nextSibling,st=Ke.firstChild,nt=st.nextSibling,He=xe.nextSibling,mt=He.firstChild,ut=mt.firstChild,at=ut.nextSibling,It=mt.nextSibling,Xe=It.firstChild,kt=Xe.nextSibling,Tt=It.nextSibling,wt=Tt.firstChild,Rt=wt.nextSibling,fr=Tt.nextSibling,ze=fr.firstChild,Ct=ze.nextSibling,xt=fr.nextSibling,tt=xt.firstChild,bt=tt.nextSibling,Mt=xt.nextSibling,Wt=Mt.firstChild,Jt=Wt.nextSibling;return a(de,(()=>{var lt=$e(()=>!t.filterBy);return()=>lt()&&(()=>{var gt=DT(),$t=gt.firstChild;return y(gt,P),$t.style.setProperty("margin","0"),$t.style.setProperty("font-size","1.5rem"),a($t,()=>e("inventory.movements")),a(gt,D(ht,{variant:"outline",onClick:ee,get children(){return e("common.clearFilters")}}),null),gt})()})(),ge),a(de,D(AT,{filters:{selectedLocation:i,movementType:s},onSearchResults:lt=>{f(lt),ue(lt)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),ge),ge.style.setProperty("margin","20px"),y(xe,b),a(xe,(()=>{var lt=$e(()=>!t.filterBy);return()=>lt()&&[(()=>{var gt=MT(),$t=gt.firstChild;return $t.style.setProperty("display","block"),$t.style.setProperty("margin-bottom","0.5rem"),$t.style.setProperty("font-weight","500"),a($t,()=>e("inventory.product")),a(gt,D(fp,{onChange:et=>{console.log(et),n(et.id)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}}),null),gt})(),(()=>{var gt=FT(),$t=gt.firstChild,et=$t.nextSibling,Vt=et.firstChild;return $t.style.setProperty("display","block"),$t.style.setProperty("margin-bottom","0.5rem"),$t.style.setProperty("font-weight","500"),a($t,()=>e("inventory.location")),et.addEventListener("change",Ht=>o(Ht.target.value)),a(Vt,()=>e("inventory.allLocations")),a(et,D(zt,{get each(){return ct.locations},children:Ht=>(()=>{var Xt=OT();return a(Xt,()=>Ht.name),we(()=>Xt.value=Ht.id),Xt})()}),null),we(Ht=>y(et,H,Ht)),we(()=>et.value=i()),gt})()]})(),pe),_e.style.setProperty("display","block"),_e.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("font-weight","500"),a(_e,()=>e("inventory.movementType")),Re.addEventListener("change",lt=>{l(lt.target.value),ue(g())}),a(Ee,()=>e("inventory.allTypes")),a(Te,()=>e("inventory.stockIn")),a(Le,()=>e("inventory.stockOut")),a(Ie,()=>e("inventory.transfer")),a(De,()=>e("inventory.adjustment")),Be.style.setProperty("display","block"),Be.style.setProperty("margin-bottom","0.5rem"),Be.style.setProperty("font-weight","500"),a(Be,()=>e("common.startDate")),We.addEventListener("change",lt=>u(gt=>({...gt,start:lt.target.value}))),st.style.setProperty("display","block"),st.style.setProperty("margin-bottom","0.5rem"),st.style.setProperty("font-weight","500"),a(st,()=>e("common.endDate")),nt.addEventListener("change",lt=>u(gt=>({...gt,end:lt.target.value}))),y(He,R),a(ut,()=>_().total),a(at,()=>e("inventory.totalMovements")),a(Xe,()=>_().stockIn),a(kt,()=>e("inventory.stockIn")),a(wt,()=>_().stockOut),a(Rt,()=>e("inventory.stockOut")),a(ze,()=>_().transfers),a(Ct,()=>e("inventory.transfers")),a(tt,()=>_().adjustments),a(bt,()=>e("inventory.adjustments")),Wt.$$click=ye,a(Wt,()=>J(_().totalValue)),a(Jt,()=>e("inventory.totalValue")),a(de,(()=>{var lt=$e(()=>T().length===0);return()=>lt()?(()=>{var gt=BT(),$t=gt.firstChild,et=$t.nextSibling,Vt=et.nextSibling;return gt.style.setProperty("text-align","center"),gt.style.setProperty("padding","3rem"),gt.style.setProperty("color","var(--text-muted)"),gt.style.setProperty("background","var(--surface-color)"),gt.style.setProperty("border-radius","var(--border-radius)"),gt.style.setProperty("border","1px solid var(--border-color)"),$t.style.setProperty("font-size","1.5rem"),$t.style.setProperty("margin-bottom","1rem"),et.style.setProperty("font-size","1.1rem"),et.style.setProperty("margin-bottom","0.5rem"),a(et,()=>e("inventory.noMovementsFound")),Vt.style.setProperty("font-size","0.875rem"),a(Vt,()=>e("inventory.tryAdjustingFilters")),gt})():[D(zt,{get each(){return T()},children:gt=>(()=>{var $t=jT(),et=$t.firstChild,Vt=et.firstChild,Ht=Vt.firstChild,Xt=Ht.firstChild,er=Xt.nextSibling,Kt=er.nextSibling,ir=Ht.nextSibling,vr=ir.firstChild,cr=Vt.nextSibling,br=cr.firstChild,Nt=br.nextSibling,Et=Nt.firstChild,Cr=Et.nextSibling;Cr.nextSibling;var Tr=et.nextSibling,mr=Tr.firstChild,gr=mr.firstChild,Er=gr.firstChild,Wr=Er.firstChild,ur=Er.nextSibling,un=gr.nextSibling,yn=un.firstChild,zn=yn.firstChild,bn=yn.nextSibling,gn=mr.nextSibling,kr=gn.firstChild,Un=kr.firstChild,ei=Un.firstChild,pi=Un.nextSibling;return $t.addEventListener("mouseleave",tr=>{tr.currentTarget.style.transform="translateY(0)",tr.currentTarget.style.boxShadow="none"}),$t.addEventListener("mouseenter",tr=>{tr.currentTarget.style.transform="translateY(-2px)",tr.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),$t.$$click=()=>ce(gt),y(et,le),Ht.style.setProperty("display","flex"),Ht.style.setProperty("align-items","center"),Ht.style.setProperty("gap","0.5rem"),Ht.style.setProperty("margin-bottom","0.5rem"),Xt.style.setProperty("font-size","1.2rem"),a(Xt,()=>ne(gt.movementType)),er.style.setProperty("margin","0"),er.style.setProperty("font-size","1.1rem"),a(er,()=>gt.productName),a(Kt,()=>gt.movementType),a(Ht,(()=>{var tr=$e(()=>!!gt.invoiceId);return()=>tr()&&(()=>{var Nr=VT();return Nr.style.setProperty("padding","0.2rem 0.5rem"),Nr.style.setProperty("border-radius","var(--border-radius-sm)"),Nr.style.setProperty("font-size","0.7rem"),Nr.style.setProperty("font-weight","500"),Nr.style.setProperty("background","var(--primary-color)"),Nr.style.setProperty("color","white"),a(Nr,()=>e("inventory.bulk")),Nr})()})(),null),ir.style.setProperty("font-size","0.875rem"),ir.style.setProperty("color","var(--text-muted)"),a(ir,()=>gt.productSku,vr),a(ir,()=>V(gt.createdDate),null),a(ir,(()=>{var tr=$e(()=>!!gt.invoiceId);return()=>tr()&&(()=>{var Nr=qT(),Vr=Nr.firstChild,_n=Vr.nextSibling;return _n.nextSibling,Nr.style.setProperty("margin-left","0.5rem"),Nr.style.setProperty("font-weight","500"),a(Nr,()=>e("common.invoice"),_n),a(Nr,()=>gt.invoiceId,null),Nr})()})(),null),cr.style.setProperty("text-align","right"),br.style.setProperty("font-size","1.25rem"),br.style.setProperty("font-weight","700"),br.style.setProperty("color","var(--primary-color)"),a(br,()=>J(gt.totalCost)),Nt.style.setProperty("font-size","0.875rem"),Nt.style.setProperty("color","var(--text-muted)"),a(Nt,()=>gt.quantity,Et),a(Nt,()=>e("common.units"),Cr),a(Nt,()=>J(gt.unitCost),null),y(Tr,G),a(Er,()=>e("inventory.location"),Wr),a(ur,()=>gt.locationName),a(mr,(()=>{var tr=$e(()=>!!gt.fromLocationName);return()=>tr()&&(()=>{var Nr=b0(),Vr=Nr.firstChild,_n=Vr.firstChild,qr=Vr.nextSibling;return a(Vr,()=>e("common.from"),_n),a(qr,()=>gt.fromLocationName),we(Lr=>{var ti=I,ri=F,_t=X;return Lr.e=y(Nr,ti,Lr.e),Lr.t=y(Vr,ri,Lr.t),Lr.a=y(qr,_t,Lr.a),Lr},{e:void 0,t:void 0,a:void 0}),Nr})()})(),un),a(yn,()=>e("common.reference"),zn),a(bn,()=>gt.referenceNumber),a(Un,()=>e("common.createdBy"),ei),a(pi,()=>gt.createdBy),a(gn,(()=>{var tr=$e(()=>!!gt.notes);return()=>tr()&&(()=>{var Nr=b0(),Vr=Nr.firstChild,_n=Vr.firstChild,qr=Vr.nextSibling;return a(Vr,()=>e("common.notes"),_n),a(qr,()=>gt.notes),we(Lr=>{var ti={...I,"border-bottom":"none"},ri=F,_t={...X,"max-width":"200px","text-align":"right","font-style":"italic"};return Lr.e=y(Nr,ti,Lr.e),Lr.t=y(Vr,ri,Lr.t),Lr.a=y(qr,_t,Lr.a),Lr},{e:void 0,t:void 0,a:void 0}),Nr})()})(),null),we(tr=>{var Nr={...U,"border-left":gt.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},Vr=M(gt.movementType),_n=I,qr=F,Lr=X,ti=I,ri=F,_t=X,ar=I,vn=F,nn=X;return tr.e=y($t,Nr,tr.e),tr.t=y(Kt,Vr,tr.t),tr.a=y(gr,_n,tr.a),tr.o=y(Er,qr,tr.o),tr.i=y(ur,Lr,tr.i),tr.n=y(un,ti,tr.n),tr.s=y(yn,ri,tr.s),tr.h=y(bn,_t,tr.h),tr.r=y(kr,ar,tr.r),tr.d=y(Un,vn,tr.d),tr.l=y(pi,nn,tr.l),tr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),$t})()}),$e(()=>$e(()=>B()>1)()&&(()=>{var gt=zT(),$t=gt.firstChild,et=$t.firstChild,Vt=et.firstChild,Ht=et.nextSibling,Xt=Ht.nextSibling,er=$t.nextSibling,Kt=er.firstChild,ir=Kt.firstChild,vr=ir.firstChild,cr=ir.nextSibling,br=cr.nextSibling,Nt=br.firstChild;return y(gt,Y),$t.style.setProperty("display","flex"),$t.style.setProperty("align-items","center"),$t.style.setProperty("gap","0.5rem"),et.style.setProperty("font-size","0.875rem"),et.style.setProperty("color","var(--text-muted)"),a(et,()=>e("common.showPerPage","Show per page"),Vt),Ht.addEventListener("change",Et=>{C(Number(Et.target.value)),x(1)}),Ht.style.setProperty("padding","0.25rem 0.5rem"),Ht.style.setProperty("border","1px solid var(--border-color)"),Ht.style.setProperty("border-radius","var(--border-radius-sm)"),Ht.style.setProperty("background","var(--surface-color)"),Ht.style.setProperty("cursor","pointer"),Ht.style.setProperty("font-size","0.875rem"),Xt.style.setProperty("font-size","0.875rem"),Xt.style.setProperty("color","var(--text-muted)"),Xt.style.setProperty("margin-left","1rem"),a(Xt,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(w()-1)*S()+1,end:Math.min(w()*S(),$().length),total:$().length})),er.style.setProperty("display","flex"),er.style.setProperty("align-items","center"),er.style.setProperty("gap","0.5rem"),a(er,D(ht,{variant:"outline",size:"sm",onClick:()=>x(1),get disabled(){return w()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),Kt),a(er,D(ht,{variant:"outline",size:"sm",onClick:()=>x(Et=>Math.max(1,Et-1)),get disabled(){return w()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),Kt),a(er,()=>{const Et=[],Cr=B(),Tr=w();if(Cr<=7)for(let mr=1;mr<=Cr;mr++)Et.push(mr);else{Et.push(1),Tr>3&&Et.push("...");for(let mr=Math.max(2,Tr-1);mr<=Math.min(Cr-1,Tr+1);mr++)Et.includes(mr)||Et.push(mr);Tr<Cr-2&&Et.push("..."),Et.includes(Cr)||Et.push(Cr)}return D(zt,{each:Et,children:mr=>mr==="..."?(()=>{var gr=UT();return gr.style.setProperty("padding","0 0.5rem"),gr.style.setProperty("color","var(--text-muted)"),gr})():(()=>{var gr=HT();return gr.$$click=()=>x(mr),a(gr,mr),we(Er=>y(gr,Q(mr===w()),Er)),gr})()})},Kt),a(er,D(ht,{variant:"outline",size:"sm",onClick:()=>x(Et=>Math.min(B(),Et+1)),get disabled(){return w()===B()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),Kt),a(er,D(ht,{variant:"outline",size:"sm",onClick:()=>x(B()),get disabled(){return w()===B()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),Kt),Kt.style.setProperty("display","flex"),Kt.style.setProperty("align-items","center"),Kt.style.setProperty("gap","0.5rem"),Kt.style.setProperty("margin-left","1rem"),ir.style.setProperty("font-size","0.875rem"),ir.style.setProperty("color","var(--text-muted)"),a(ir,()=>e("common.page","Page"),vr),cr.addEventListener("change",Et=>{const Cr=Number(Et.target.value);Cr>=1&&Cr<=B()&&x(Cr)}),cr.style.setProperty("width","4rem"),cr.style.setProperty("padding","0.25rem 0.5rem"),cr.style.setProperty("border","1px solid var(--border-color)"),cr.style.setProperty("border-radius","var(--border-radius-sm)"),cr.style.setProperty("background","var(--surface-color)"),cr.style.setProperty("text-align","center"),cr.style.setProperty("font-size","0.875rem"),br.style.setProperty("font-size","0.875rem"),br.style.setProperty("color","var(--text-muted)"),a(br,()=>e("common.of","of"),Nt),a(br,B,null),we(()=>Qt(cr,"max",B())),we(()=>Ht.value=S()),we(()=>cr.value=w()),gt})())]})(),null),a(de,D(ET,{get isOpen(){return te()},onClose:()=>{Z(!1),oe(null)},get movement(){return j()},onEdit:se}),null),a(de,D(Ge,{get when(){return lr.hasPermission("read_write")},get children(){return D(LT,{get isOpen(){return re()},onClose:()=>{E(!1),oe(null)},get movement(){return j()},onMovementUpdated:q})}}),null),we(lt=>{var gt=H,$t=K,et=K,Vt=k,Ht=W,Xt=z,er=k,Kt={...W,color:"#2d7d32"},ir=z,vr=k,cr={...W,color:"#d32f2f"},br=z,Nt=k,Et={...W,color:"#1976d2"},Cr=z,Tr=k,mr={...W,color:"#f57c00"},gr=z,Er=k,Wr=W,ur=z;return lt.e=y(Re,gt,lt.e),lt.t=y(We,$t,lt.t),lt.a=y(nt,et,lt.a),lt.o=y(mt,Vt,lt.o),lt.i=y(ut,Ht,lt.i),lt.n=y(at,Xt,lt.n),lt.s=y(It,er,lt.s),lt.h=y(Xe,Kt,lt.h),lt.r=y(kt,ir,lt.r),lt.d=y(Tt,vr,lt.d),lt.l=y(wt,cr,lt.l),lt.u=y(Rt,br,lt.u),lt.c=y(fr,Nt,lt.c),lt.w=y(ze,Et,lt.w),lt.m=y(Ct,Cr,lt.m),lt.f=y(xt,Tr,lt.f),lt.y=y(tt,mr,lt.y),lt.g=y(bt,gr,lt.g),lt.p=y(Mt,Er,lt.p),lt.b=y(Wt,Wr,lt.b),lt.T=y(Jt,ur,lt.T),lt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),we(()=>Re.value=s()),we(()=>We.value=c().start),we(()=>nt.value=c().end),de})()};pr(["click"]);var WT=he("<div><p> "),YT=he("<div>"),KT=he("<div><div></div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),JT=he("<div><div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),QT=he("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),XT=he("<div><div></div><h3></h3><p>"),ZT=he("<div><div><h3> </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),ek=he("<div><div><div><h2> </h2><button>"),_0=he("<option>"),tk=he("<div>..."),rk=he("<tr><td><div></div><div>  </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),nk=he("<tr><td><div></div></td><td><div></div><div>  <!>  </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const ik=t=>{const{t:e}=Zt(),[r,n]=Ce([]),[i,o]=Ce(!1),[s,l]=Ce(!1),[c,u]=Ce("all"),[h,m]=Ce("all"),[g,f]=Ce("name"),[w,x]=Ce([]),[S,C]=Ce("setup"),j=async()=>{try{o(!0);const z=await Ti.getProducts("prod");if(!z||typeof z!="object"){console.warn("No API results, using local store"),n(ct.products);return}const U=Object.keys(z),le=M=>{let I=z[M];return{id:M,name:I.name||"Unknown Product",businessId:I.businessId||"",sku:I.code||I.sku||"",UPC:I.UPC||"",numCode:I.codeN||"",category:I.category||"General",unitCost:I.unitCost||0,unitOfMeasure:I.unitOfMeasure||"pcs",minStockLevel:I.minStockLevel||0,maxStockLevel:I.maxStockLevel||100,isActive:I.isActive!==!1,description:I.description||"",createdDate:I.createdAt||new Date().toISOString(),lastModified:I.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(I.sellingPrice||I.price||"0")}},L=U.map(le);n(L)}catch(z){console.error("Failed to load products from API:",z),n(ct.products)}finally{o(!1)}},oe=Lt(()=>[...new Set(r().map(U=>U.category).filter(U=>U))].sort()),te=Lt(()=>{let z=r().filter(U=>U.isActive);return h()!=="all"&&(z=z.filter(U=>U.category===h())),z.sort((U,le)=>{switch(g()){case"name":return U.name.localeCompare(le.name);case"sku":return U.sku.localeCompare(le.sku);case"category":return U.category.localeCompare(le.category)||U.name.localeCompare(le.name);default:return 0}}),z}),Z=Lt(()=>ct.getActiveLocations()),re=(z,U)=>U&&U!=="all"?ct.getStockByProductAndLocation(z,U)?.quantity||0:ct.getTotalStockByProduct(z),E=()=>{const z=te().map(U=>{const le=re(U.id,c()!=="all"?c():void 0);return{productId:U.id,systemQuantity:le,physicalCount:null,notes:"",variance:0,product:U}});x(z),C("counting")},$=(z,U)=>{x(le=>le.map(L=>{if(L.productId===z){const M=U,G=M!==null?M-L.systemQuantity:0;return{...L,physicalCount:M,variance:G}}return L}))},T=(z,U)=>{x(le=>le.map(L=>L.productId===z?{...L,notes:U}:L))},B=Lt(()=>{const z=w(),U=z.length,le=z.filter(I=>I.physicalCount!==null).length,L=z.filter(I=>I.variance!==0).length,M=z.filter(I=>I.variance>0).length,G=z.filter(I=>I.variance<0).length;return{totalProducts:U,countedProducts:le,remainingProducts:U-le,variances:L,positiveVariances:M,negativeVariances:G,isComplete:le===U}}),_=()=>{const z=w().filter(M=>M.physicalCount!==null&&M.variance!==0);if(z.length===0)return null;const U=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],le=z.map(M=>[`"${M.product.name}"`,`"${M.product.sku}"`,`"${M.product.category}"`,`"${H()}"`,M.systemQuantity,M.physicalCount,M.variance,M.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${M.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${K()}"`]);return[U.join(","),...le.map(M=>M.join(","))].join(`
`)},P=()=>{const z=_();if(!z){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const U=new Blob([z],{type:"text/csv;charset=utf-8;"}),le=document.createElement("a");if(le.download!==void 0){const L=URL.createObjectURL(U);le.setAttribute("href",L),le.setAttribute("download",`inventory-adjustments-${K().replace(/[/:,\s]/g,"-")}.csv`),le.style.visibility="hidden",document.body.appendChild(le),le.click(),document.body.removeChild(le)}},b=async(z=!0)=>{try{l(!0),console.log(w());const U=F=>{let X=ct.getProductById(F.productId),Y=ct.getStockByProductAndLocation(F.productId,c()),Q=parseFloat(Y?.averageCost+""),J=parseFloat(Y?.quantity+"");return{product:{id:F.productId,label:X?.name,code:X?.code},productId:F?.productId,reason:"Physical Count Adjustment",notes:F?.notes||"Physical inventory adjustment",quantity:F?.variance,unitCost:Q}},le=w().filter(F=>F.physicalCount!==null&&F.variance!==0).map(U);let L="ADJ_"+Eg();const M=new Date().toISOString(),G={ssg_inventory_key:Yh(),invoiceId:L,referenceNumber:Eg(),movementType:"adjustment",type:"adjustment",locationId:c(),items:le,products:le,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:L,store:c(),createdBy:"admin",createDate:M};console.log("Saving inventory bulkRequest:",G);const I=await Ti.addInventory(G);z&&le.length>0&&P(),console.log("Saving inventory adjustments:",le),await new Promise(F=>setTimeout(F,1e3)),t.onClose()}catch(U){console.error("Failed to save inventory adjustments:",U)}finally{l(!1)}},H=Lt(()=>c()==="all"?"All Locations":Z().find(U=>U.id===c())?.name||"Unknown Location"),K=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),R=async()=>{await ct.fecthInventory("prod"),await j()};Cn(async()=>{t.selectedLocationId&&u(t.selectedLocationId),R()});const k=()=>{const z=window.open("","_blank");if(!z){alert("Please allow pop-ups to print the counting sheet");return}const U=W();z.document.write(U),z.document.close(),z.onload=()=>{z.print(),z.onafterprint=()=>{z.close()}}},W=()=>{const z=te().map((U,le)=>{const L=re(U.id,c()!=="all"?c():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${le+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${U.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${U.name}</div>
            ${U.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${U.UPC}</div>`:""}
          </td>
         
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${U.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${L}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;"></td>
          <td style="border: 1px solid #000; padding: 8px;"></td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${H()}_${h()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${K()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in 0.8in 0.5in 0.8in;
            @top-center {
              content: "${H()} | ${h()==="all"?e("inventory.allCategories","All Categories"):h()} | Page " counter(page);
              font-size: 10px;
              font-weight: bold;
              border-bottom: 1px solid #ccc;
              padding-bottom: 5px;
            }
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
            position: relative;
          }
          .page-identifier {
            position: fixed;
            left: 5px;
            top: 50%;
            transform: rotate(-90deg) translateX(-50%);
            transform-origin: left center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          .page-identifier-right {
            position: fixed;
            right: 5px;
            top: 50%;
            transform: rotate(90deg) translateX(50%);
            transform-origin: right center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 22px;
            page-break-after: avoid;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
            background: #f8f8f8;
            padding: 10px;
            border: 2px solid #333;
            page-break-after: avoid;
          }
          .page-header {
            display: none;
            text-align: center;
            background: #e0e0e0;
            padding: 8px;
            border: 1px solid #333;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 11px;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
            /*page-break-before: auto;*/
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
            page-break-before: auto;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            body { margin: 0; }
            .page-identifier, .page-identifier-right { display: block; }
            .page-header { display: block; }
            tr { page-break-inside: avoid; }
            thead { display: table-header-group; }
            tfoot { display: table-footer-group; }
            .header-info { page-break-after: avoid; }
            h1 { page-break-after: avoid; }
            table { page-break-before: auto; }
            /*.summary-table { page-break-before: always; }*/
            .signature-section { page-break-before: avoid; }
            
            /* Repeat headers on each page */
            @page :first {
              @top-center { content: none; }
            }
            
            /* Force page headers to show on continuation pages */
            tbody::before {
              content: "";
              display: block;
              height: 0;
            }
          }
        </style>
      </head>
      <body>
        <!-- Page identifiers for multi-page documents -->
        <div class="page-identifier-right">
          ${H()} - ${h()==="all"?e("inventory.allCategories","All Categories"):h()} - ${K()} 
        </div>
       
        
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${H()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${h()==="all"?e("inventory.allCategories","All Categories"):h()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${K()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <!-- Page header for continuation pages (hidden on first page) -->
        <div class="page-header">
          ${H()} | ${h()==="all"?e("inventory.allCategories","All Categories"):h()} | ${K()} 
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 28%;">${e("common.notes","Notes")}</th>
            </tr>
            <!-- Repeat header info row for clarity -->
            <tr style="background-color: #f8f8f8; font-size: 10px;">
              <td colspan="8" style="text-align: center; padding: 4px; border: 1px solid #000; font-weight: bold;">
                 ${H()} |  ${h()==="all"?e("inventory.allCategories","All Categories"):h()} |  ${K()}
              </td>
            </tr>
          </thead>
          <tbody>
            ${z}
          </tbody>
        </table>
        
        <!-- Summary section with location/category context -->
        <div style="margin: 30px 0; padding: 15px; background: #f8f8f8;">
          <h3 style="text-align: center; margin: 0 0 15px 0; font-size: 16px;">
            ${e("inventory.summaryFor","SUMMARY FOR")}: ${H()} - ${h()==="all"?e("inventory.allCategories","All Categories"):h()}
          </h3>
          
          <table class="summary-table">
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.totalProductsListed","Total Products Listed")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
                ${te().length}
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.itemsCounted","Items Counted")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.discrepanciesFound","Discrepancies Found")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
          </table>
        </div>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return D(Ge,{get when(){return t.isOpen},get children(){var z=ek(),U=z.firstChild,le=U.firstChild,L=le.firstChild;L.firstChild;var M=L.nextSibling;return z.style.setProperty("position","fixed"),z.style.setProperty("top","0"),z.style.setProperty("left","0"),z.style.setProperty("right","0"),z.style.setProperty("bottom","0"),z.style.setProperty("background","rgba(0, 0, 0, 0.5)"),z.style.setProperty("z-index","1000"),z.style.setProperty("display","flex"),z.style.setProperty("align-items","center"),z.style.setProperty("justify-content","center"),U.style.setProperty("background","white"),U.style.setProperty("border-radius","var(--border-radius)"),U.style.setProperty("padding","2rem"),U.style.setProperty("width","95%"),U.style.setProperty("height","95%"),U.style.setProperty("max-width","1400px"),U.style.setProperty("overflow-y","auto"),U.style.setProperty("position","relative"),le.style.setProperty("display","flex"),le.style.setProperty("justify-content","space-between"),le.style.setProperty("align-items","center"),le.style.setProperty("margin-bottom","2rem"),le.style.setProperty("border-bottom","1px solid var(--border-color)"),le.style.setProperty("padding-bottom","1rem"),L.style.setProperty("margin","0"),L.style.setProperty("font-size","1.5rem"),a(L,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),hs(M,"click",t.onClose,!0),M.style.setProperty("background","none"),M.style.setProperty("border","none"),M.style.setProperty("font-size","1.5rem"),M.style.setProperty("cursor","pointer"),M.style.setProperty("padding","0.5rem"),a(U,D(Ge,{get when(){return S()==="setup"},get children(){var G=KT(),I=G.firstChild,F=I.nextSibling,X=F.nextSibling,Y=X.nextSibling,Q=Y.firstChild,J=Q.firstChild,V=J.firstChild,ne=J.nextSibling,ee=ne.firstChild,ce=Q.nextSibling,se=ce.firstChild,q=se.firstChild,ue=se.nextSibling,ye=ue.firstChild,de=ce.nextSibling,ge=de.firstChild,xe=ge.firstChild,pe=ge.nextSibling,_e=pe.firstChild,Re=_e.nextSibling,Ee=Re.nextSibling;return G.style.setProperty("text-align","center"),G.style.setProperty("padding","2rem"),G.style.setProperty("max-width","600px"),G.style.setProperty("margin","0 auto"),I.style.setProperty("font-size","3rem"),I.style.setProperty("margin-bottom","1rem"),F.style.setProperty("margin-bottom","1rem"),a(F,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),X.style.setProperty("margin-bottom","2rem"),X.style.setProperty("color","var(--text-muted)"),a(X,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),Y.style.setProperty("display","grid"),Y.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),Y.style.setProperty("gap","1rem"),Y.style.setProperty("margin-bottom","2rem"),Y.style.setProperty("padding","1rem"),Y.style.setProperty("background","var(--surface-color)"),Y.style.setProperty("border-radius","var(--border-radius)"),Y.style.setProperty("text-align","left"),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),a(J,()=>e("inventory.location","Location"),V),ne.addEventListener("change",Te=>u(Te.target.value)),ne.style.setProperty("width","100%"),ne.style.setProperty("padding","0.5rem"),ne.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),a(ee,()=>e("inventory.allLocations","All Locations")),a(ne,D(zt,{get each(){return Z()},children:Te=>(()=>{var Le=_0();return a(Le,()=>Te.name),we(()=>Le.value=Te.id),Le})()}),null),se.style.setProperty("display","block"),se.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("font-weight","500"),a(se,()=>e("inventory.category","Category"),q),ue.addEventListener("change",Te=>m(Te.target.value)),ue.style.setProperty("width","100%"),ue.style.setProperty("padding","0.5rem"),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),a(ye,()=>e("products.allCategories","All Categories")),a(ue,D(zt,{get each(){return oe()},children:Te=>(()=>{var Le=_0();return Le.value=Te,a(Le,Te),Le})()}),null),ge.style.setProperty("display","block"),ge.style.setProperty("margin-bottom","0.5rem"),ge.style.setProperty("font-weight","500"),a(ge,()=>e("inventory.sortBy","Sort By"),xe),pe.addEventListener("change",Te=>f(Te.target.value)),pe.style.setProperty("width","100%"),pe.style.setProperty("padding","0.5rem"),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),a(_e,()=>e("inventory.productName","Product Name")),a(Re,()=>e("inventory.sku","SKU")),a(Ee,()=>e("inventory.category","Category")),a(G,D(Ge,{get when(){return!i()},get fallback(){return(()=>{var Te=tk(),Le=Te.firstChild;return Te.style.setProperty("padding","2rem"),a(Te,()=>e("common.loading","Loading"),Le),Te})()},get children(){return[(()=>{var Te=WT(),Le=Te.firstChild;return Le.firstChild,Te.style.setProperty("padding","1rem"),Te.style.setProperty("background","#fff3cd"),Te.style.setProperty("border-radius","var(--border-radius-sm)"),Te.style.setProperty("margin-bottom","2rem"),Le.style.setProperty("margin","0"),Le.style.setProperty("color","#856404"),a(Le,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:te().length,location:H(),category:h()==="all"?e("inventory.allCategories","all categories"):h()}),null),Te})(),D(Ge,{get when(){return $e(()=>h()!=="all")()&&c()!=="all"},get children(){var Te=YT();return Te.style.setProperty("display","grid"),Te.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),Te.style.setProperty("gap","1rem"),Te.style.setProperty("margin-bottom","2rem"),Te.style.setProperty("padding","1rem"),Te.style.setProperty("background","var(--surface-color)"),Te.style.setProperty("border-radius","var(--border-radius)"),a(Te,D(Ge,{get when(){return lr.hasPermission("physicalInventoryCountingForm")},get children(){return D(ht,{variant:"primary",size:"large",onClick:E,get disabled(){return i()||te().length===0},get children(){return[" ",$e(()=>e("inventory.startCounting","Start Physical Count"))]}})}}),null),a(Te,D(ht,{variant:"primary",onClick:k,get disabled(){return i()},get children(){return[" ",$e(()=>e("common.print","Print"))]}}),null),Te}})]}}),null),we(()=>ne.value=c()),we(()=>ue.value=h()),we(()=>pe.value=g()),G}}),null),a(U,D(Ge,{get when(){return S()==="counting"},get children(){var G=JT(),I=G.firstChild,F=I.nextSibling,X=F.firstChild,Y=X.firstChild,Q=Y.nextSibling,J=X.nextSibling,V=J.firstChild,ne=V.nextSibling,ee=J.nextSibling,ce=ee.firstChild,se=ce.nextSibling,q=ee.nextSibling,ue=q.firstChild,ye=ue.firstChild,de=ue.nextSibling,ge=F.nextSibling,xe=ge.nextSibling,pe=xe.firstChild,_e=pe.firstChild,Re=_e.firstChild,Ee=Re.firstChild,Te=Ee.nextSibling,Le=Te.nextSibling,Ie=Le.nextSibling,De=Ie.nextSibling,Ye=De.nextSibling,Be=_e.nextSibling;return I.style.setProperty("display","grid"),I.style.setProperty("grid-template-columns","repeat(auto-fit)"),I.style.setProperty("gap","1rem"),I.style.setProperty("margin-bottom","2rem"),I.style.setProperty("padding","1rem"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius)"),a(I,H),F.style.setProperty("display","grid"),F.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),F.style.setProperty("gap","1rem"),F.style.setProperty("margin-bottom","2rem"),F.style.setProperty("padding","1rem"),F.style.setProperty("background","var(--surface-color)"),F.style.setProperty("border-radius","var(--border-radius)"),X.style.setProperty("text-align","center"),Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("font-weight","700"),Y.style.setProperty("color","var(--primary-color)"),a(Y,()=>B().countedProducts),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>e("inventory.counted","Counted")),J.style.setProperty("text-align","center"),V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","700"),V.style.setProperty("color","#ff9800"),a(V,()=>B().remainingProducts),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),a(ne,()=>e("inventory.remaining","Remaining")),ee.style.setProperty("text-align","center"),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","700"),ce.style.setProperty("color","#f44336"),a(ce,()=>B().variances),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("color","var(--text-muted)"),a(se,()=>e("inventory.variances","Variances")),q.style.setProperty("text-align","center"),ue.style.setProperty("font-size","1.5rem"),ue.style.setProperty("font-weight","700"),a(ue,()=>Math.round(B().countedProducts/B().totalProducts*100),ye),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),a(de,()=>e("inventory.complete","Complete")),ge.style.setProperty("display","flex"),ge.style.setProperty("gap","1rem"),ge.style.setProperty("margin-bottom","2rem"),ge.style.setProperty("justify-content","center"),a(ge,D(ht,{variant:"outline",onClick:()=>C("setup"),get children(){return[" ",$e(()=>e("common.back","Back to Setup"))]}}),null),a(ge,D(ht,{variant:"primary",onClick:()=>C("review"),get children(){return[" ",$e(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),xe.style.setProperty("border","1px solid var(--border-color)"),xe.style.setProperty("border-radius","var(--border-radius)"),xe.style.setProperty("overflow-x","auto"),pe.style.setProperty("width","100%"),pe.style.setProperty("border-collapse","collapse"),Re.style.setProperty("background","var(--surface-color)"),Ee.style.setProperty("padding","1rem"),Ee.style.setProperty("text-align","left"),Ee.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ee,()=>e("inventory.no","No")),Te.style.setProperty("padding","1rem"),Te.style.setProperty("text-align","left"),Te.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Te,()=>e("inventory.product","Product")),Le.style.setProperty("padding","1rem"),Le.style.setProperty("text-align","center"),Le.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Le,()=>e("inventory.systemQty","System Qty")),Ie.style.setProperty("padding","1rem"),Ie.style.setProperty("text-align","center"),Ie.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ie,()=>e("inventory.physicalCount","Physical Count")),De.style.setProperty("padding","1rem"),De.style.setProperty("text-align","center"),De.style.setProperty("border-bottom","1px solid var(--border-color)"),a(De,()=>e("inventory.variance","Variance")),Ye.style.setProperty("padding","1rem"),Ye.style.setProperty("text-align","left"),Ye.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ye,()=>e("common.notes","Notes")),a(Be,D(zt,{get each(){return w()},children:(We,Ke)=>D(ok,{get index(){return Ke()},updatePhysicalCount:$,entry:We,updateNotes:T})})),we(We=>(We=B().isComplete?"#4caf50":"#ff9800")!=null?ue.style.setProperty("color",We):ue.style.removeProperty("color")),G}}),null),a(U,D(Ge,{get when(){return S()==="review"},get children(){var G=ZT(),I=G.firstChild,F=I.firstChild;F.firstChild;var X=F.nextSibling,Y=I.nextSibling,Q=Y.firstChild,J=Q.firstChild,V=J.nextSibling,ne=Q.nextSibling,ee=ne.firstChild,ce=ee.nextSibling,se=ne.nextSibling,q=se.firstChild,ue=q.nextSibling,ye=Y.nextSibling;return I.style.setProperty("text-align","center"),I.style.setProperty("margin-bottom","2rem"),F.style.setProperty("margin-bottom","1rem"),a(F,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),X.style.setProperty("color","var(--text-muted)"),a(X,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),Y.style.setProperty("display","grid"),Y.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),Y.style.setProperty("gap","1rem"),Y.style.setProperty("margin-bottom","2rem"),Y.style.setProperty("padding","1rem"),Y.style.setProperty("background","var(--surface-color)"),Y.style.setProperty("border-radius","var(--border-radius)"),Q.style.setProperty("text-align","center"),J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","700"),J.style.setProperty("color","#4caf50"),a(J,()=>B().positiveVariances),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),a(V,()=>e("inventory.stockIncreases","Stock Increases")),ne.style.setProperty("text-align","center"),ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","700"),ee.style.setProperty("color","#f44336"),a(ee,()=>B().negativeVariances),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),a(ce,()=>e("inventory.stockDecreases","Stock Decreases")),se.style.setProperty("text-align","center"),q.style.setProperty("font-size","1.5rem"),q.style.setProperty("font-weight","700"),q.style.setProperty("color","var(--primary-color)"),a(q,()=>B().variances),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),a(ue,()=>e("inventory.totalAdjustments","Total Adjustments")),ye.style.setProperty("display","flex"),ye.style.setProperty("gap","1rem"),ye.style.setProperty("margin-bottom","2rem"),ye.style.setProperty("justify-content","center"),ye.style.setProperty("flex-wrap","wrap"),a(ye,D(ht,{variant:"outline",onClick:()=>C("counting"),get children(){return[" ",$e(()=>e("common.back","Back to Counting"))]}}),null),a(ye,D(ht,{variant:"outline",onClick:P,get disabled(){return B().variances===0},get children(){return[" ",$e(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),a(ye,D(ht,{variant:"primary",onClick:b,get disabled(){return s()||B().variances===0},get children(){return $e(()=>!!s())()?" "+e("common.saving","Saving")+"...":" "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),a(G,D(Ge,{get when(){return B().variances>0},get children(){var de=QT(),ge=de.firstChild,xe=ge.firstChild,pe=xe.firstChild,_e=pe.firstChild,Re=_e.nextSibling,Ee=Re.nextSibling,Te=Ee.nextSibling,Le=Te.nextSibling,Ie=xe.nextSibling;return de.style.setProperty("border","1px solid var(--border-color)"),de.style.setProperty("border-radius","var(--border-radius)"),de.style.setProperty("overflow-x","auto"),ge.style.setProperty("width","100%"),ge.style.setProperty("border-collapse","collapse"),pe.style.setProperty("background","var(--surface-color)"),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","left"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),a(_e,()=>e("inventory.product","Product")),Re.style.setProperty("padding","1rem"),Re.style.setProperty("text-align","center"),Re.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Re,()=>e("inventory.systemQty","System Qty")),Ee.style.setProperty("padding","1rem"),Ee.style.setProperty("text-align","center"),Ee.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ee,()=>e("inventory.physicalCount","Physical Count")),Te.style.setProperty("padding","1rem"),Te.style.setProperty("text-align","center"),Te.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Te,()=>e("inventory.adjustment","Adjustment")),Le.style.setProperty("padding","1rem"),Le.style.setProperty("text-align","left"),Le.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Le,()=>e("common.notes","Notes")),a(Ie,D(zt,{get each(){return w().filter(De=>De.variance!==0)},children:De=>(()=>{var Ye=rk(),Be=Ye.firstChild,We=Be.firstChild,Ke=We.nextSibling,st=Ke.firstChild,nt=Be.nextSibling,He=nt.firstChild,mt=nt.nextSibling,ut=mt.firstChild,at=mt.nextSibling,It=at.firstChild,Xe=at.nextSibling,kt=Xe.firstChild;return Ye.style.setProperty("border-bottom","1px solid var(--border-color)"),Be.style.setProperty("padding","1rem"),We.style.setProperty("font-weight","500"),a(We,()=>De.product.name),Ke.style.setProperty("font-size","0.875rem"),Ke.style.setProperty("color","var(--text-muted)"),a(Ke,()=>De.product.sku,st),a(Ke,()=>De.product.category,null),nt.style.setProperty("padding","1rem"),nt.style.setProperty("text-align","center"),He.style.setProperty("font-weight","600"),a(He,()=>De.systemQuantity),mt.style.setProperty("padding","1rem"),mt.style.setProperty("text-align","center"),ut.style.setProperty("font-weight","600"),a(ut,()=>De.physicalCount),at.style.setProperty("padding","1rem"),at.style.setProperty("text-align","center"),It.style.setProperty("font-weight","700"),a(It,()=>De.variance>0?"+":"",null),a(It,()=>De.variance,null),Xe.style.setProperty("padding","1rem"),kt.style.setProperty("font-size","0.875rem"),a(kt,()=>De.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),we(Tt=>{var wt=De.variance>0?"#d4edda":"#f8d7da",Rt=De.variance>0?"#4caf50":"#f44336";return wt!==Tt.e&&((Tt.e=wt)!=null?Ye.style.setProperty("background",wt):Ye.style.removeProperty("background")),Rt!==Tt.t&&((Tt.t=Rt)!=null?It.style.setProperty("color",Rt):It.style.removeProperty("color")),Tt},{e:void 0,t:void 0}),Ye})()})),de}}),null),a(G,D(Ge,{get when(){return B().variances===0},get children(){var de=XT(),ge=de.firstChild,xe=ge.nextSibling,pe=xe.nextSibling;return de.style.setProperty("text-align","center"),de.style.setProperty("padding","3rem"),de.style.setProperty("background","var(--surface-color)"),de.style.setProperty("border-radius","var(--border-radius)"),ge.style.setProperty("font-size","3rem"),ge.style.setProperty("margin-bottom","1rem"),xe.style.setProperty("margin-bottom","0.5rem"),a(xe,()=>e("inventory.perfectCount","Perfect Count!")),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),de}}),null),G}}),null),z}})},ok=t=>{const{t:e}=Zt(),[r,n]=Ce(""),[i,o]=Ce("");let{entry:s,updatePhysicalCount:l,updateNotes:c,index:u}=t;Cn(()=>{o(s?.notes),n(s?.physicalCount)});const h=()=>{let m=document.getElementById(`physicalCountInput_${u+2}`);if(console.log(_l(r()),!m),_l(r())&&!m){l(s?.productId,r()===""?null:parseFloat(r()));return}if(_l(r())&&m){m.focus(),l(s?.productId,r()===""?null:parseFloat(r()));return}};return(()=>{var m=nk(),g=m.firstChild,f=g.firstChild,w=g.nextSibling,x=w.firstChild,S=x.nextSibling,C=S.firstChild,j=C.nextSibling;j.nextSibling;var oe=w.nextSibling,te=oe.firstChild,Z=oe.nextSibling,re=Z.firstChild,E=Z.nextSibling,$=E.firstChild,T=E.nextSibling,B=T.firstChild;return m.style.setProperty("border-bottom","1px solid var(--border-color)"),g.style.setProperty("padding","1rem"),g.style.setProperty("text-align","center"),f.style.setProperty("font-weight","600"),a(f,u+1),w.style.setProperty("padding","1rem"),x.style.setProperty("font-weight","500"),a(x,()=>s?.product.name),S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","var(--text-muted)"),a(S,()=>s?.product.sku,C),a(S,()=>s?.product.category,j),a(S,()=>s?.product.unitOfMeasure,null),oe.style.setProperty("padding","1rem"),oe.style.setProperty("text-align","center"),te.style.setProperty("font-weight","600"),a(te,()=>s?.systemQuantity),Z.style.setProperty("padding","1rem"),Z.style.setProperty("text-align","center"),re.addEventListener("blur",()=>{h()}),re.$$keydown=_=>{_.keyCode===13&&h(),_.keyCode===27&&h(),_.keyCode},re.$$input=_=>{const P=_.target.value;n(P)},Qt(re,"id",`physicalCountInput_${u+1}`),Qt(re,"tabindex",u),re.style.setProperty("width","100px"),re.style.setProperty("padding","0.5rem"),re.style.setProperty("border","1px solid var(--border-color)"),re.style.setProperty("border-radius","var(--border-radius-sm)"),re.style.setProperty("text-align","center"),E.style.setProperty("padding","1rem"),E.style.setProperty("text-align","center"),$.style.setProperty("font-weight","600"),a($,()=>s?.variance>0?"+":"",null),a($,()=>s?.variance||"",null),T.style.setProperty("padding","1rem"),B.addEventListener("blur",_=>{c(s?.productId,i())}),B.$$keydown=_=>{_.keyCode===13&&c(s?.productId,i()),_.keyCode===27&&c(s?.productId,i()),_.keyCode===9&&c(s?.productId,i())},B.$$input=_=>{const P=_.target.value;o(P)},B.style.setProperty("width","200px"),B.style.setProperty("padding","0.5rem"),B.style.setProperty("border","1px solid var(--border-color)"),B.style.setProperty("border-radius","var(--border-radius-sm)"),we(_=>{var P=s?.physicalCount!==null?s?.variance!==0?"#fff3cd":"#d4edda":"transparent",b=s?.variance>0?"#4caf50":s?.variance<0?"#f44336":"var(--text-muted)",H=e("inventory.addNotes","Add notes...");return P!==_.e&&((_.e=P)!=null?m.style.setProperty("background",P):m.style.removeProperty("background")),b!==_.t&&((_.t=b)!=null?$.style.setProperty("color",b):$.style.removeProperty("color")),H!==_.a&&Qt(B,"placeholder",_.a=H),_},{e:void 0,t:void 0,a:void 0}),we(()=>re.value=r()||""),we(()=>B.value=i()||""),m})()};pr(["click","input","keydown"]);function sk(t,e=300,r=!1){let n,i;const o=()=>{n!==void 0&&(clearTimeout(n),n=void 0),i=void 0},s=()=>{n!==void 0&&i!==void 0&&(clearTimeout(n),n=void 0,t(...i),i=void 0)},l=(...c)=>{i=c,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...c),n=window.setTimeout(()=>{r||t(...c),n=void 0,i=void 0},e)};return kl(()=>{o()}),{debounced:l,cancel:o,flush:s}}function ak(t,e=300){const[r,n]=Ce(!1);let i;const o=async u=>{if(i&&i.abort(),!u.trim()){n(!1);return}i=new AbortController,n(!0);try{await t(u)}catch(h){h instanceof Error&&h.name!=="AbortError"&&console.error("Search error:",h)}finally{i.signal.aborted||n(!1)}},{debounced:s,cancel:l}=sk(o,e,!1),c=()=>{l(),i&&i.abort(),n(!1)};return kl(()=>{c()}),{search:s,isSearching:r,cancel:c}}var S0=he("<div>"),lk=he("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),ck=he("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),uk=he("<div><h4>"),dk=he("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),hk=he("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),P0=he("<div><h3>"),pk=he("<div><div><div><h2></h2><div>SKU: <!>  </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),fk=he("<span> "),mk=he("<span> "),yk=he("<div><div><span><span>  </span></span><span> </span></div><div>: <!>  <!>: "),gk=he("<div> "),vk=he("<div>Ref: "),bk=he("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),_k=he("<div><h4></h4><div></div><div>"),Sk=he("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!>  </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!>  Max: ");const Pk=t=>{const{t:e}=Zt(),[r,n]=Ce("details"),i=Lt(()=>{if(!t.product)return null;const T=ct.getTotalStockByProduct(t.product.id),B=ct.getStockByProduct(t.product.id),_=T<=t.product.minStockLevel,P=T===0,b=T>=t.product.maxStockLevel;return{total:T,byLocation:B,status:P?"out":_?"low":b?"over":"good",statusText:P?e("products.outOfStock","Out of Stock"):_?e("products.lowStock","Low Stock"):b?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),o=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),s=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),l=Lt(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),c=Lt(()=>t.product?ct.movements.filter(T=>T.productId===t.product.id).sort((T,B)=>new Date(B.createdDate).getTime()-new Date(T.createdDate).getTime()):[]),u=Lt(()=>{if(!t.product)return null;const T=c(),B=i(),_=new Date;_.setDate(_.getDate()-30);const P=T.filter(H=>new Date(H.createdDate)>=_),b=T.reduce((H,K)=>{const R=K.productId===t.product.id?K:null;return H+(R?R.quantity*R.unitCost:0)},0);return{recentMovements:T.length,movements30Days:P.length,totalValue:(B?.total||0)*t.product.unitCost,averageMovementValue:T.length>0?b/T.length:0,lastMovementDate:T.length>0?T[0].createdDate:null}}),h={"margin-bottom":"2rem"},m={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},g={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},f={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},w=T=>({in:"",out:"",transfer:"",adjustment:""})[T]||"";function x(T){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[T]||{bg:"#f5f5f5",color:"#666"}}const S=T=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:x(T).bg,color:x(T).color}),C=T=>{const B={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...B[T]||B.good}},j={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},oe={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},te={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},Z={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},re=T=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":T?"2px solid var(--primary-color)":"2px solid transparent",color:T?"var(--primary-color)":"var(--text-muted)","font-weight":T?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),E={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},$={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return D(qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return D(Ge,{get when(){return t.product},get fallback(){return(()=>{var T=S0();return T.style.setProperty("text-align","center"),T.style.setProperty("padding","2rem"),T.style.setProperty("color","var(--text-muted)"),a(T,()=>e("products.noProductSelected","No product selected")),T})()},children:T=>(()=>{var B=pk(),_=B.firstChild,P=_.firstChild,b=P.firstChild,H=b.nextSibling,K=H.firstChild,R=K.nextSibling;R.nextSibling;var k=P.nextSibling,W=_.nextSibling,z=W.firstChild,U=z.nextSibling,le=U.nextSibling,L=W.nextSibling;return a(B,()=>JSON.stringify(T),_),y(_,te),b.style.setProperty("margin","0"),b.style.setProperty("font-size","1.5rem"),b.style.setProperty("margin-bottom","0.25rem"),a(b,()=>T().name),H.style.setProperty("color","var(--text-muted)"),a(H,()=>T().sku,R),a(H,()=>T().category,null),a(k,()=>i()?.statusText),y(W,Z),z.$$click=()=>n("details"),a(z,()=>e("products.details","Details")),U.$$click=()=>n("movements"),a(U,()=>e("products.movements","Movements")),le.$$click=()=>n("analytics"),a(le,()=>e("products.analytics","Analytics")),a(B,D(Ge,{get when(){return r()==="details"},get children(){return[(()=>{var M=lk(),G=M.firstChild,I=G.nextSibling,F=I.firstChild,X=F.nextSibling,Y=I.nextSibling,Q=Y.firstChild,J=Q.nextSibling,V=Y.nextSibling,ne=V.firstChild,ee=ne.nextSibling;return G.style.setProperty("margin-bottom","1rem"),G.style.setProperty("font-size","1.1rem"),a(G,()=>e("products.basicInformation","Basic Information")),a(F,()=>e("products.description","Description")),a(X,()=>T().description||e("common.notAvailable","N/A")),a(Q,()=>e("products.unitOfMeasure","Unit of Measure")),a(J,()=>T().unitOfMeasure),a(ne,()=>e("products.status","Status")),a(ee,(()=>{var ce=$e(()=>!!T().isActive);return()=>ce()?(()=>{var se=fk();return se.firstChild,se.style.setProperty("color","#2e7d32"),a(se,()=>e("common.active","Active"),null),se})():(()=>{var se=mk();return se.firstChild,se.style.setProperty("color","#d32f2f"),a(se,()=>e("common.inactive","Inactive"),null),se})()})()),we(ce=>{var se=h,q=m,ue=g,ye=f,de=m,ge=g,xe=f,pe=m,_e=g,Re=f;return ce.e=y(M,se,ce.e),ce.t=y(I,q,ce.t),ce.a=y(F,ue,ce.a),ce.o=y(X,ye,ce.o),ce.i=y(Y,de,ce.i),ce.n=y(Q,ge,ce.n),ce.s=y(J,xe,ce.s),ce.h=y(V,pe,ce.h),ce.r=y(ne,_e,ce.r),ce.d=y(ee,Re,ce.d),ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),M})(),(()=>{var M=ck(),G=M.firstChild,I=G.nextSibling,F=I.firstChild,X=F.firstChild,Y=X.firstChild,Q=Y.nextSibling,J=X.nextSibling,V=J.firstChild,ne=V.nextSibling,ee=F.nextSibling,ce=ee.firstChild,se=ce.firstChild,q=se.nextSibling,ue=ce.nextSibling,ye=ue.firstChild,de=ye.nextSibling,ge=de.firstChild;return G.style.setProperty("margin-bottom","1rem"),G.style.setProperty("font-size","1.1rem"),a(G,()=>e("products.pricingInformation","Pricing Information")),a(Y,()=>e("products.unitCost","Unit Cost")),a(Q,()=>o(T().unitCost)),a(V,()=>e("products.sellingPrice","Selling Price")),a(ne,()=>o(T().sellingPrice)),a(se,()=>e("products.profit","Profit")),a(q,()=>o(T().sellingPrice-T().unitCost)),a(ye,()=>e("products.profitMargin","Profit Margin")),a(de,l,ge),we(xe=>{var pe=h,_e=j,Re=m,Ee=g,Te=f,Le=m,Ie=g,De=f,Ye=m,Be=g,We=f,Ke=m,st=g,nt=f;return xe.e=y(M,pe,xe.e),xe.t=y(I,_e,xe.t),xe.a=y(X,Re,xe.a),xe.o=y(Y,Ee,xe.o),xe.i=y(Q,Te,xe.i),xe.n=y(J,Le,xe.n),xe.s=y(V,Ie,xe.s),xe.h=y(ne,De,xe.h),xe.r=y(ce,Ye,xe.r),xe.d=y(se,Be,xe.d),xe.l=y(q,We,xe.l),xe.u=y(ue,Ke,xe.u),xe.c=y(ye,st,xe.c),xe.w=y(de,nt,xe.w),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),M})(),(()=>{var M=dk(),G=M.firstChild,I=G.nextSibling,F=I.firstChild,X=F.firstChild,Y=X.firstChild,Q=Y.nextSibling,J=Q.firstChild,V=X.nextSibling,ne=V.firstChild,ee=ne.nextSibling,ce=ee.firstChild,se=F.nextSibling,q=se.firstChild,ue=q.firstChild,ye=ue.nextSibling,de=ye.firstChild,ge=q.nextSibling,xe=ge.firstChild,pe=xe.nextSibling;return G.style.setProperty("margin-bottom","1rem"),G.style.setProperty("font-size","1.1rem"),a(G,()=>e("products.stockInformation","Stock Information")),a(Y,()=>e("products.totalStock","Total Stock")),a(Q,()=>i()?.total||0,J),a(Q,()=>T().unitOfMeasure,null),a(ne,()=>e("products.minStockLevel","Min Stock Level")),a(ee,()=>T().minStockLevel,ce),a(ee,()=>T().unitOfMeasure,null),a(ue,()=>e("products.maxStockLevel","Max Stock Level")),a(ye,()=>T().maxStockLevel,de),a(ye,()=>T().unitOfMeasure,null),a(xe,()=>e("products.stockValue","Stock Value")),a(pe,()=>o((i()?.total||0)*T().unitCost)),a(M,D(Ge,{get when(){return $e(()=>!!i()?.byLocation)()&&i().byLocation.length>0},get children(){var _e=uk(),Re=_e.firstChild;return _e.style.setProperty("margin-top","1.5rem"),Re.style.setProperty("margin-bottom","1rem"),Re.style.setProperty("font-size","1rem"),a(Re,()=>e("products.stockByLocation","Stock by Location")),a(_e,()=>i().byLocation.map(Ee=>(()=>{var Te=yk(),Le=Te.firstChild,Ie=Le.firstChild,De=Ie.firstChild;De.firstChild;var Ye=Ie.nextSibling,Be=Ye.firstChild,We=Le.nextSibling,Ke=We.firstChild,st=Ke.nextSibling,nt=st.nextSibling,He=nt.nextSibling;return He.nextSibling,y(Te,oe),Le.style.setProperty("display","flex"),Le.style.setProperty("justify-content","space-between"),Le.style.setProperty("align-items","center"),Ie.style.setProperty("font-weight","500"),Ie.style.setProperty("color","var(--primary-color)"),a(Ie,()=>Ee.locationId,De),De.style.setProperty("font-weight","500"),De.style.setProperty("color","var(--text-muted)"),a(De,()=>Ee.locationName,null),Ye.style.setProperty("font-weight","600"),a(Ye,()=>Ee.quantity,Be),a(Ye,()=>T().unitOfMeasure,null),We.style.setProperty("margin-top","0.5rem"),We.style.setProperty("font-size","0.875rem"),We.style.setProperty("color","var(--text-muted)"),a(We,()=>e("products.available","Available"),Ke),a(We,()=>Ee.availableQuantity,st),a(We,()=>e("products.reserved","Reserved"),He),a(We,()=>Ee.reservedQuantity,null),we(mt=>(mt=Ee.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?Ye.style.setProperty("color",mt):Ye.style.removeProperty("color")),Te})()),null),_e}}),null),we(_e=>{var Re=h,Ee=j,Te=m,Le=g,Ie=f,De=m,Ye=g,Be=f,We=m,Ke=g,st=f,nt=m,He=g,mt=f;return _e.e=y(M,Re,_e.e),_e.t=y(I,Ee,_e.t),_e.a=y(X,Te,_e.a),_e.o=y(Y,Le,_e.o),_e.i=y(Q,Ie,_e.i),_e.n=y(V,De,_e.n),_e.s=y(ne,Ye,_e.s),_e.h=y(ee,Be,_e.h),_e.r=y(q,We,_e.r),_e.d=y(ue,Ke,_e.d),_e.l=y(ye,st,_e.l),_e.u=y(ge,nt,_e.u),_e.c=y(xe,He,_e.c),_e.w=y(pe,mt,_e.w),_e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),M})(),(()=>{var M=hk(),G=M.firstChild,I=G.nextSibling,F=I.firstChild,X=F.nextSibling,Y=I.nextSibling,Q=Y.firstChild,J=Q.nextSibling;return G.style.setProperty("margin-bottom","1rem"),G.style.setProperty("font-size","1.1rem"),a(G,()=>e("products.timestamps","Timestamps")),a(F,()=>e("common.createdDate","Created Date")),a(X,()=>s(T().createdDate)),a(Q,()=>e("common.lastModified","Last Modified")),a(J,()=>s(T().lastModified)),we(V=>{var ne=h,ee=m,ce=g,se=f,q=m,ue=g,ye=f;return V.e=y(M,ne,V.e),V.t=y(I,ee,V.t),V.a=y(F,ce,V.a),V.o=y(X,se,V.o),V.i=y(Y,q,V.i),V.n=y(Q,ue,V.n),V.s=y(J,ye,V.s),V},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),M})()]}}),L),a(B,D(Ge,{get when(){return r()==="movements"},get children(){var M=P0(),G=M.firstChild;return G.style.setProperty("margin-bottom","1rem"),G.style.setProperty("font-size","1.1rem"),a(G,()=>e("products.recentMovements","Recent Movements")),a(M,D(Ge,{get when(){return c().length>0},get fallback(){return(()=>{var I=gk();return I.firstChild,I.style.setProperty("text-align","center"),I.style.setProperty("padding","2rem"),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("border","1px solid var(--border-color)"),a(I,()=>e("products.noMovements","No movements found for this product"),null),I})()},get children(){return D(zt,{get each(){return c()},children:I=>{const F=I.productId===T().id?I:null;if(!F)return null;let X=ct.getLocationById(I.locationId);return(()=>{var Y=bk(),Q=Y.firstChild,J=Q.firstChild,V=J.firstChild,ne=V.nextSibling,ee=ne.nextSibling,ce=J.nextSibling,se=ce.firstChild,q=Q.nextSibling,ue=q.firstChild,ye=ue.firstChild,de=ue.nextSibling;return y(Y,E),J.style.setProperty("font-weight","600"),J.style.setProperty("margin-bottom","0.25rem"),V.style.setProperty("font-size","1.2rem"),a(V,()=>w(I.movementType)),ne.style.setProperty("padding","0 6px"),a(ee,()=>I.movementType),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),a(ce,()=>` ${s(I?.createdDate)}  `,se),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("font-weight","600"),se.style.setProperty("color","var(--primary-color)"),a(se,()=>I?.locationId),a(ce,()=>`  ${X?.name}`,null),a(Q,D(Ge,{get when(){return I.referenceNumber},get children(){var ge=vk();return ge.firstChild,ge.style.setProperty("font-size","0.75rem"),ge.style.setProperty("color","var(--text-muted)"),ge.style.setProperty("margin-top","0.25rem"),a(ge,()=>I?.referenceNumber,null),ge}}),null),q.style.setProperty("text-align","right"),ue.style.setProperty("font-weight","600"),ue.style.setProperty("font-size","1rem"),a(ue,()=>I?.movementType==="in"?"+":"",ye),a(ue,()=>F.quantity,ye),a(ue,()=>T().unitOfMeasure,null),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),a(de,()=>o(F.unitCost)),we(ge=>{var xe=S(I.movementType),pe=I?.movementType==="in"?"#2e7d32":"#d32f2f";return ge.e=y(ee,xe,ge.e),pe!==ge.t&&((ge.t=pe)!=null?ue.style.setProperty("color",pe):ue.style.removeProperty("color")),ge},{e:void 0,t:void 0}),Y})()}})}}),null),we(I=>y(M,h,I)),M}}),L),a(B,D(Ge,{get when(){return r()==="analytics"},get children(){var M=P0(),G=M.firstChild;return G.style.setProperty("margin-bottom","1rem"),G.style.setProperty("font-size","1.1rem"),a(G,()=>e("products.analytics","Analytics")),a(M,D(Ge,{get when(){return u()},get fallback(){return(()=>{var I=S0();return I.style.setProperty("text-align","center"),I.style.setProperty("padding","2rem"),I.style.setProperty("color","var(--text-muted)"),a(I,()=>e("products.noAnalytics","No analytics data available")),I})()},children:I=>(()=>{var F=Sk(),X=F.firstChild,Y=X.firstChild,Q=Y.nextSibling,J=Q.nextSibling,V=X.nextSibling,ne=V.firstChild,ee=ne.nextSibling,ce=ee.nextSibling,se=V.nextSibling,q=se.firstChild,ue=q.nextSibling,ye=ue.nextSibling,de=ye.firstChild,ge=de.nextSibling;ge.nextSibling;var xe=se.nextSibling,pe=xe.firstChild,_e=pe.nextSibling,Re=_e.nextSibling,Ee=xe.nextSibling,Te=Ee.firstChild,Le=Te.nextSibling,Ie=Le.nextSibling,De=Ie.firstChild,Ye=De.nextSibling;return Ye.nextSibling,Y.style.setProperty("margin","0 0 0.5rem 0"),Y.style.setProperty("color","var(--primary-color)"),a(Y,()=>e("products.totalMovements","Total Movements")),Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),a(Q,()=>I().recentMovements),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),J.style.setProperty("margin-top","0.25rem"),a(J,()=>e("products.allTime","All time")),ne.style.setProperty("margin","0 0 0.5rem 0"),ne.style.setProperty("color","var(--primary-color)"),a(ne,()=>e("products.last30Days","Last 30 Days")),ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),a(ee,()=>I().movements30Days),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),ce.style.setProperty("margin-top","0.25rem"),a(ce,()=>e("products.movements","movements")),q.style.setProperty("margin","0 0 0.5rem 0"),q.style.setProperty("color","var(--primary-color)"),a(q,()=>e("products.currentValue","Current Stock Value")),ue.style.setProperty("font-size","1.5rem"),ue.style.setProperty("font-weight","600"),a(ue,()=>o(I().totalValue)),ye.style.setProperty("font-size","0.875rem"),ye.style.setProperty("color","var(--text-muted)"),ye.style.setProperty("margin-top","0.25rem"),a(ye,()=>i()?.total||0,de),a(ye,()=>T().unitOfMeasure,ge),a(ye,()=>o(T().unitCost),null),pe.style.setProperty("margin","0 0 0.5rem 0"),pe.style.setProperty("color","var(--primary-color)"),a(pe,()=>e("products.avgMovementValue","Avg Movement Value")),_e.style.setProperty("font-size","1.5rem"),_e.style.setProperty("font-weight","600"),a(_e,()=>o(I().averageMovementValue)),Re.style.setProperty("font-size","0.875rem"),Re.style.setProperty("color","var(--text-muted)"),Re.style.setProperty("margin-top","0.25rem"),a(Re,()=>e("products.perMovement","per movement")),a(F,D(Ge,{get when(){return I().lastMovementDate},get children(){var Be=_k(),We=Be.firstChild,Ke=We.nextSibling,st=Ke.nextSibling;return We.style.setProperty("margin","0 0 0.5rem 0"),We.style.setProperty("color","var(--primary-color)"),a(We,()=>e("products.lastMovement","Last Movement")),Ke.style.setProperty("font-size","1.25rem"),Ke.style.setProperty("font-weight","600"),a(Ke,()=>s(I().lastMovementDate)),st.style.setProperty("font-size","0.875rem"),st.style.setProperty("color","var(--text-muted)"),st.style.setProperty("margin-top","0.25rem"),a(st,()=>e("products.mostRecent","Most recent activity")),we(nt=>y(Be,$,nt)),Be}}),Ee),Te.style.setProperty("margin","0 0 0.5rem 0"),Te.style.setProperty("color","var(--primary-color)"),a(Te,()=>e("products.stockStatus","Stock Status")),Le.style.setProperty("font-size","1.25rem"),Le.style.setProperty("font-weight","600"),a(Le,()=>i()?.statusText),Ie.style.setProperty("font-size","0.875rem"),Ie.style.setProperty("color","var(--text-muted)"),Ie.style.setProperty("margin-top","0.25rem"),a(Ie,()=>T().minStockLevel,Ye),a(Ie,()=>T().maxStockLevel,null),we(Be=>{var We=j,Ke=$,st=$,nt=$,He=$,mt=$;return Be.e=y(F,We,Be.e),Be.t=y(X,Ke,Be.t),Be.a=y(V,st,Be.a),Be.o=y(se,nt,Be.o),Be.i=y(xe,He,Be.i),Be.n=y(Ee,mt,Be.n),Be},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),F})()}),null),we(I=>y(M,h,I)),M}}),L),L.style.setProperty("display","flex"),L.style.setProperty("gap","1rem"),L.style.setProperty("justify-content","flex-end"),L.style.setProperty("margin-top","2rem"),a(L,D(ht,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),a(L,D(Ge,{get when(){return t.onEdit},get children(){return D(ht,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),we(M=>{var G=C(i()?.status||"good"),I=re(r()==="details"),F=re(r()==="movements"),X=re(r()==="analytics");return M.e=y(k,G,M.e),M.t=y(z,I,M.t),M.a=y(U,F,M.a),M.o=y(le,X,M.o),M},{e:void 0,t:void 0,a:void 0,o:void 0}),B})()})}})};pr(["click"]);var wk=he("<div>"),xk=he("<button type=button>"),Ak=he("<div> "),w0=he("<div>"),Ck=he("<div><div><input type=text autocomplete=off>"),Ik=he("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div>"),$k=he("<span> ");const Ek=t=>{const{t:e}=Zt(),[r,n]=Ce(""),[i,o]=Ce(!1),[s,l]=Ce(null),[c,u]=Ce([]),[h,m]=Ce(!1),[g,f]=Ce(-1),[w,x]=Ce(null),S=t.searchDelay||300,C=t.maxResults||900,j=async I=>{if(!I.trim()||I.trim().length<3){u([]),t.onSearchResults?.([]);return}try{o(!0),l(null);try{const F=await Ti.getProducts(I),X=Object.keys(F),Y=J=>{let V=F;return{id:J,name:V[J].name,businessId:V[J].businessId,sku:V[J].code,UPC:V[J].UPC,numCode:V[J].codeN,category:V[J].category,unitCost:V[J].unitCost||0,unitOfMeasure:V[J].unitOfMeasure,minStockLevel:V[J].minStockLevel,maxStockLevel:V[J].maxStockLevel,isActive:V[J].isActive,description:V[J].description||"",createdDate:V[J].createdAt||new Date().toISOString(),lastModified:V[J].updatedAt||new Date().toISOString()}},Q=X.map(Y);u(Q),ct.updProduct(Q),t.onSearchResults?.(Q)}catch(F){console.warn("API search failed, using local fallback:",F),l("API search failed, showing local results");const X=ct.getActiveProducts().filter(Y=>Y.name.toLowerCase().includes(I.toLowerCase())||Y.sku.toLowerCase().includes(I.toLowerCase())||Y.category.toLowerCase().includes(I.toLowerCase())).slice(0,C);u(X),t.onSearchResults?.(X)}}catch(F){const X=F instanceof Error?F.message:"Search failed";l(X),u([]),t.onSearchResults?.([])}finally{o(!1)}},oe=I=>{const X=I.target.value;n(X),l(null),t.showResults!==!1&&m(!0),w()&&clearTimeout(w());const Y=setTimeout(()=>{j(X)},S);x(Y)},te=I=>{n(I.name),m(!1),f(-1),t.onProductSelect?.(I)},Z=I=>{if(!(!h()||c().length===0))switch(I.key){case"ArrowDown":I.preventDefault(),f(F=>Math.min(F+1,c().length-1));break;case"ArrowUp":I.preventDefault(),f(F=>Math.max(F-1,-1));break;case"Enter":I.preventDefault(),g()>=0&&c()[g()]&&te(c()[g()]);break;case"Escape":m(!1),f(-1);break}},re=()=>{t.showResults!==!1&&c().length>0&&m(!0)},E=()=>{setTimeout(()=>{m(!1),f(-1)},150)},$=()=>{n(""),u([]),l(null),m(!1),f(-1),t.onSearchResults?.([]),w()&&(clearTimeout(w()),x(null))},T=I=>ct.stockLevels.filter(F=>F.productId===I).reduce((F,X)=>F+X.quantity,0),B=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),_={position:"relative",width:"100%",...t.style},P={position:"relative",display:"flex","align-items":"center"},b={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},H={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},K={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},R={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},k=I=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:I?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),W={display:"flex","justify-content":"space-between","align-items":"center"},z={flex:"1"},U={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},le={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},L={"text-align":"right","font-size":"0.875rem"},M={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},G={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var I=Ck(),F=I.firstChild,X=F.firstChild;return X.addEventListener("blur",E),X.addEventListener("focus",re),X.$$keydown=Z,X.$$input=oe,a(F,D(Ge,{get when(){return i()},get children(){var Y=wk();return we(Q=>y(Y,K,Q)),Y}}),null),a(F,D(Ge,{get when(){return $e(()=>!!r())()&&!i()},get children(){var Y=xk();return Y.addEventListener("mouseleave",Q=>{Q.currentTarget.style.background="none",Q.currentTarget.style.color="var(--text-muted)"}),Y.addEventListener("mouseenter",Q=>{Q.currentTarget.style.background="var(--border-color)",Q.currentTarget.style.color="var(--text-primary)"}),Y.$$click=$,we(Q=>{var J=H,V=e("common.clear","Clear search");return Q.e=y(Y,J,Q.e),V!==Q.t&&Qt(Y,"title",Q.t=V),Q},{e:void 0,t:void 0}),Y}}),null),a(I,D(Ge,{get when(){return h()&&t.showResults!==!1},get children(){var Y=w0();return a(Y,D(Ge,{get when(){return s()},get children(){var Q=Ak();return Q.firstChild,y(Q,G),a(Q,s,null),Q}}),null),a(Y,D(Ge,{get when(){return c().length>0},get fallback(){return $e(()=>!!(r()&&!i()))()&&(()=>{var Q=w0();return y(Q,M),a(Q,()=>e("inventory.noProductsFound","No products found matching your search.")),Q})()},get children(){return D(zt,{get each(){return c()},children:(Q,J)=>{const V=T(Q.id),ne=V<=Q.minStockLevel;return(()=>{var ee=Ik(),ce=ee.firstChild,se=ce.firstChild,q=se.firstChild,ue=q.nextSibling,ye=ue.firstChild,de=ye.firstChild,ge=ye.nextSibling,xe=ge.nextSibling,pe=xe.nextSibling,_e=pe.nextSibling,Re=se.nextSibling,Ee=Re.firstChild,Te=Ee.firstChild,Le=Ee.nextSibling;return ee.addEventListener("mouseenter",()=>f(J())),ee.$$click=()=>te(Q),y(ce,W),y(se,z),y(q,U),a(q,()=>Q.name),y(ue,le),a(ye,()=>e("inventory.sku","SKU"),de),a(ye,()=>Q.sku,null),a(xe,()=>Q.category),a(_e,()=>B(Q.unitCost)),y(Re,L),Ee.style.setProperty("font-weight","600"),(ne?"#f44336":"var(--text-primary)")!=null?Ee.style.setProperty("color",ne?"#f44336":"var(--text-primary)"):Ee.style.removeProperty("color"),a(Ee,V,Te),a(Ee,()=>Q.unitOfMeasure,null),Le.style.setProperty("color","var(--text-muted)"),a(Le,()=>ne?(()=>{var Ie=$k();return Ie.firstChild,Ie.style.setProperty("color","#f44336"),a(Ie,()=>e("inventory.lowStock","Low Stock"),null),Ie})():e("inventory.inStock","In Stock")),we(Ie=>y(ee,k(J()===g()),Ie)),ee})()}})}}),null),we(Q=>y(Y,R,Q)),Y}}),null),we(Y=>{var Q=_,J=P,V=b,ne=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),ee=t.disabled;return Y.e=y(I,Q,Y.e),Y.t=y(F,J,Y.t),Y.a=y(X,V,Y.a),ne!==Y.o&&Qt(X,"placeholder",Y.o=ne),ee!==Y.i&&(X.disabled=Y.i=ee),Y},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>X.value=r()),I})()};pr(["input","keydown","click"]);var Tk=he("<div><div><h2></h2><div><div>"),kk=he("<div><span>"),Nk=he("<span> "),Lk=he("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div></div><div>  <!>: </div><div>: "),Rk=he("<div><div>:</div><div>"),Dk=he("<div>: "),Mk=he("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const k5=()=>{const{t}=Zt(),[e,r]=Ce(""),[n,i]=Ce(""),[o,s]=Ce([]),[l,c]=Ce(!1),[u,h]=Ce(null),[m,g]=Ce(!1),[f,w]=Ce(!1),[x,S]=Ce(!1),[C,j]=Ce(null),[oe,te]=Ce(!1),[Z,re]=Ce([]),[E,$]=Ce(!1),[T,B]=Ce(1),[_,P]=Ce(20);Cn(async()=>{await b()});const b=async()=>{try{c(!0),h(null);try{const I=await i0.getAll();s(I.map(F=>({id:F.id||`prod-${Date.now()}-${Math.random()}`,name:F.productName||F.name||"Unknown Product",sku:F.sku||F.productCode||"",description:F.description||"",category:F.category||"General",unitOfMeasure:F.unitOfMeasure||"pcs",unitCost:parseFloat(F.unitCost||F.cost||"0"),sellingPrice:parseFloat(F.sellingPrice||F.price||"0"),minStockLevel:parseInt(F.minStockLevel||"0"),maxStockLevel:parseInt(F.maxStockLevel||"100"),isActive:F.isActive!==!1,createdDate:F.createdDate||new Date().toISOString(),lastModified:F.lastModified||new Date().toISOString(),businessId:F.businessId||"YB100423253156428"})))}catch(I){console.warn("API failed, using local store:",I),s(ct.products)}}catch(I){h(I instanceof Error?I.message:"Failed to load products")}finally{c(!1)}},H=async()=>{try{c(!0),h(null);try{const I=await Ti.getProducts("prod"),F=Object.keys(I),X=Q=>{let V=I[Q];return{id:V.id,name:V.name,businessId:V.businessId,sku:V.code,numCode:V.codeN,category:V.category,unitCost:V.unitCost||0,unitOfMeasure:V.unitOfMeasure,minStockLevel:V.minStockLevel,maxStockLevel:V.maxStockLevel,isActive:V.isActive,description:V.description||"",createdDate:V.createdAt||new Date().toISOString(),lastModified:V.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(V.sellingPrice||V.price||"0")}},Y=F.map(X);s(Y)}catch(I){console.warn("API failed, using local store:",I),s(ct.products)}}catch(I){h(I instanceof Error?I.message:"Failed to load products")}finally{c(!1)}},{cancel:K}=ak(async I=>{if(!I.trim()){await b();return}try{h(null);const F=await i0.getAll(I);s(F.map(X=>({id:X.id||`prod-${Date.now()}-${Math.random()}`,name:X.productName||X.name||"Unknown Product",sku:X.sku||X.productCode||"",description:X.description||"",category:X.category||"General",unitOfMeasure:X.unitOfMeasure||"pcs",unitCost:parseFloat(X.unitCost||X.cost||"0"),sellingPrice:parseFloat(X.sellingPrice||X.price||"0"),minStockLevel:parseInt(X.minStockLevel||"0"),maxStockLevel:parseInt(X.maxStockLevel||"100"),isActive:X.isActive!==!1,createdDate:X.createdDate||new Date().toISOString(),lastModified:X.lastModified||new Date().toISOString(),businessId:X.businessId||"YB100423253156428"})))}catch(F){h(F instanceof Error?F.message:"Search failed");const X=ct.products.filter(Y=>Y.name.toLowerCase().includes(I.toLowerCase())||Y.sku.toLowerCase().includes(I.toLowerCase())||Y.category.toLowerCase().includes(I.toLowerCase()));s(X)}},300);kl(()=>{K()}),Lt(()=>{let I=o();return n()&&(I=I.filter(F=>F.category===n())),I}),Lt(()=>[...new Set(o().map(F=>F.category))].sort()),Lt(()=>{const I=o().filter(Y=>Y.isActive),F=o().length,X=o().filter(Y=>ct.getTotalStockByProduct(Y.id)===0);return{total:F,active:I.length,outOfStock:X.length}});const R=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),k={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},W={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},z=I=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:I?"#ffebee":"#e8f5e8",color:I?"#d32f2f":"#2d7d32"});Lt(()=>{const I=ct.products||[],F=ct.movements||[],X=ct.stockLevels||[],Y=ct.getLowStockProducts(),Q=I?.length||0,J=I?.filter(ee=>ee.isActive).length,V=X.reduce((ee,ce)=>ee*1+ce.quantity*1*ce.averageCost*1,0),ne=F?.filter(ee=>{const ce=new Date(ee.createdDate),se=new Date;return ce.getMonth()===se.getMonth()&&ce.getFullYear()===se.getFullYear()}).length;return{totalProducts:Q,activeProducts:J,lowStockProducts:Y.length,totalStockValue:V,totalMovementsThisMonth:ne,totalLocations:ct.locations.length,activeLocations:ct.getActiveLocations().length}});const U=Lt(()=>ct.products.map(I=>{const F=ct.getStockByProduct(I.id),X=ct.getTotalStockByProduct(I.id),Y=ct.getLastLocationByProduct(I.id);return{...I,totalStock:X,stockByLocation:F,lastLocation:Y,isLowStock:X<=I.minStockLevel}})),le=Lt(()=>Z().map(I=>{const F=ct.getStockByProduct(I.id),X=ct.getTotalStockByProduct(I.id),Y=ct.getLastLocationByProduct(I.id);return{...I,totalStock:X,stockByLocation:F,lastLocation:Y,isLowStock:X<=I.minStockLevel}})),L=Lt(()=>{const I=E()?le():U(),F=(T()-1)*_(),X=F+_();return I.slice(F,X)}),M=Lt(()=>{const I=E()?le():U();return Math.ceil(I.length/_())}),G=I=>{j(I),w(!0)};return D(lo,{get title(){return t("products.title","Products")},get children(){return[(()=>{var I=Tk(),F=I.firstChild,X=F.firstChild,Y=X.nextSibling,Q=Y.firstChild;return I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","flex-start"),I.style.setProperty("margin-bottom","1.5rem"),I.style.setProperty("flex-wrap","wrap"),I.style.setProperty("gap","1rem"),F.style.setProperty("flex","1"),F.style.setProperty("min-width","300px"),X.style.setProperty("margin","0 0 1rem 0"),X.style.setProperty("font-size","1.5rem"),a(X,()=>t("inventory.products")),Y.style.setProperty("display","flex"),Y.style.setProperty("gap","1rem"),Y.style.setProperty("align-items","center"),Y.style.setProperty("flex-wrap","wrap"),Q.style.setProperty("flex","1"),Q.style.setProperty("min-width","250px"),a(Q,D(Ek,{onSearchResults:J=>{re(J),$(J.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),a(Y,D(ht,{variant:"outline",onClick:()=>{H(),$(!1)},get children(){return[" ",$e(()=>t("common.showAll","Show All"))]}}),null),a(I,D(Ge,{get when(){return lr.hasPermission("read_write")},get children(){return D(ht,{variant:"primary",onClick:()=>te(!0),get children(){return[" ",$e(()=>t("inventory.addProduct"))]}})}}),null),I})(),(()=>{var I=kk(),F=I.firstChild;return I.style.setProperty("margin-bottom","1rem"),I.style.setProperty("font-size","0.875rem"),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),a(F,(()=>{var X=$e(()=>!!E());return()=>X()?`${t("inventory.searchResults","Search Results")}: ${le().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${U().length} ${t("common.products","products")}`})()),a(I,(()=>{var X=$e(()=>!!E());return()=>X()&&(()=>{var Y=Nk();return Y.firstChild,Y.style.setProperty("color","var(--primary-color)"),a(Y,()=>t("inventory.filtered","Filtered view"),null),Y})()})(),null),I})(),D(zt,{get each(){return L()},children:I=>(()=>{var F=Lk(),X=F.firstChild,Y=X.firstChild,Q=Y.firstChild,J=Q.firstChild,V=J.nextSibling,ne=Q.nextSibling,ee=ne.nextSibling,ce=ee.firstChild,se=Y.nextSibling,q=se.firstChild,ue=q.nextSibling,ye=ue.firstChild,de=ye.nextSibling;de.nextSibling;var ge=ue.nextSibling,xe=ge.firstChild;return F.$$click=()=>G(I),F.addEventListener("mouseleave",pe=>{pe.currentTarget.style.transform="translateY(0)",pe.currentTarget.style.boxShadow="none"}),F.addEventListener("mouseenter",pe=>{pe.currentTarget.style.transform="translateY(-2px)",pe.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),y(F,k),y(X,W),Q.style.setProperty("display","flex"),Q.style.setProperty("align-items","center"),Q.style.setProperty("gap","0.5rem"),Q.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("margin","0"),J.style.setProperty("font-size","1.1rem"),a(J,()=>I.name),a(V,(()=>{var pe=$e(()=>!!I.isLowStock);return()=>pe()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),a(ne,()=>I.sku,null),a(ne,()=>I.UPC?"  "+I.UPC:"",null),a(ne,()=>I.category?"  "+I.category:"",null),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),a(ee,()=>t("inventory.lastSeen"),ce),a(ee,()=>I.lastLocation?.name||t("inventory.noMovements"),null),se.style.setProperty("text-align","right"),q.style.setProperty("font-size","1.25rem"),q.style.setProperty("font-weight","700"),q.style.setProperty("color","var(--primary-color)"),a(q,()=>I.totalStock),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),a(ue,()=>I.unitOfMeasure,ye),a(ue,()=>t("inventory.min"),de),a(ue,()=>I.minStockLevel,null),ge.style.setProperty("font-size","0.875rem"),ge.style.setProperty("color","var(--text-muted)"),a(ge,()=>t("inventory.cost"),xe),a(ge,()=>R(I.unitCost),null),a(F,(()=>{var pe=$e(()=>I?.stockByLocation?.length>0);return()=>pe()&&(()=>{var _e=Rk(),Re=_e.firstChild,Ee=Re.firstChild,Te=Re.nextSibling;return _e.style.setProperty("margin-top","1rem"),Re.style.setProperty("font-weight","500"),Re.style.setProperty("margin-bottom","0.5rem"),Re.style.setProperty("font-size","0.875rem"),a(Re,()=>t("inventory.stockByLocation"),Ee),Te.style.setProperty("display","flex"),Te.style.setProperty("flex-wrap","wrap"),Te.style.setProperty("gap","0.5rem"),a(Te,D(zt,{get each(){return I.stockByLocation},children:Le=>{const Ie=ct.getLocationById(Le.locationId);return(()=>{var De=Dk(),Ye=De.firstChild;return De.style.setProperty("padding","0.25rem 0.5rem"),De.style.setProperty("background","var(--background-color)"),De.style.setProperty("border-radius","var(--border-radius-sm)"),De.style.setProperty("font-size","0.75rem"),De.style.setProperty("border","1px solid var(--border-color)"),a(De,()=>Ie?.name,Ye),a(De,()=>Le.quantity,null),De})()}})),_e})()})(),null),we(pe=>y(V,z(I.isLowStock),pe)),F})()}),$e(()=>$e(()=>M()>1)()&&(()=>{var I=Mk(),F=I.firstChild,X=F.firstChild,Y=X.firstChild,Q=X.nextSibling,J=F.nextSibling,V=J.firstChild,ne=V.firstChild,ee=ne.nextSibling,ce=ee.nextSibling,se=ce.firstChild,q=J.nextSibling;return I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),I.style.setProperty("margin-top","2rem"),I.style.setProperty("padding","1rem"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius)"),I.style.setProperty("border","1px solid var(--border-color)"),F.style.setProperty("display","flex"),F.style.setProperty("align-items","center"),F.style.setProperty("gap","0.5rem"),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),a(X,()=>t("common.showPerPage","Show per page"),Y),Q.addEventListener("change",ue=>{P(parseInt(ue.target.value)),B(1)}),Q.style.setProperty("padding","0.25rem 0.5rem"),Q.style.setProperty("border","1px solid var(--border-color)"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),Q.style.setProperty("background","var(--background-color)"),Q.style.setProperty("cursor","pointer"),J.style.setProperty("display","flex"),J.style.setProperty("align-items","center"),J.style.setProperty("gap","0.5rem"),a(J,D(ht,{variant:"outline",size:"sm",onClick:()=>B(1),get disabled(){return T()===1},get children(){return t("common.first","First")}}),V),a(J,D(ht,{variant:"outline",size:"sm",onClick:()=>B(ue=>Math.max(1,ue-1)),get disabled(){return T()===1},get children(){return t("common.previous","Previous")}}),V),V.style.setProperty("display","flex"),V.style.setProperty("align-items","center"),V.style.setProperty("gap","0.25rem"),ne.style.setProperty("font-size","0.875rem"),a(ne,()=>t("common.page","Page")),ee.addEventListener("change",ue=>{const ye=parseInt(ue.target.value);ye>=1&&ye<=M()&&B(ye)}),ee.style.setProperty("width","60px"),ee.style.setProperty("padding","0.25rem 0.5rem"),ee.style.setProperty("border","1px solid var(--border-color)"),ee.style.setProperty("border-radius","var(--border-radius-sm)"),ee.style.setProperty("text-align","center"),ee.style.setProperty("font-size","0.875rem"),ce.style.setProperty("font-size","0.875rem"),a(ce,()=>t("common.of","of"),se),a(ce,M,null),a(J,D(ht,{variant:"outline",size:"sm",onClick:()=>B(ue=>Math.min(M(),ue+1)),get disabled(){return T()===M()},get children(){return t("common.next","Next")}}),null),a(J,D(ht,{variant:"outline",size:"sm",onClick:()=>B(M()),get disabled(){return T()===M()},get children(){return t("common.last","Last")}}),null),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","var(--text-muted)"),a(q,()=>{const ue=E()?le():U(),ye=(T()-1)*_()+1,de=Math.min(T()*_(),ue.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:ye,end:de,total:ue.length})}),we(()=>Qt(ee,"max",M())),we(()=>Q.value=_()),we(()=>ee.value=T()),I})()),D(qy,{get isOpen(){return m()},onClose:()=>g(!1),onProductAdded:()=>{b()}}),D(Pk,{get isOpen(){return f()},onClose:()=>{w(!1),j(null)},get product(){return C()},onEdit:()=>{w(!1),S(!0)}})]}})};pr(["click"]);var Fk=he("<div><div></div><div>"),Ok=he("<div><div><img></div><div>X</div><div><div><h2></h2><div></div></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),Bk=he("<div>"),jk=he("<div><div></div><h3></h3><p>"),Vk=he("<div><div>"),qk=he("<div>"),zk=he("<div><div><img loading=lazy></div><div><div></div><div>  </div><div></div><div>",!0,!1,!1);const Uk=t=>{const{t:e}=Zt(),[r,n]=Ce(null),[i,o]=Ce([]),[s,l]=Ce(!1),c=k=>{n(k),t.onProductSelect?.(k)},u=()=>{n(null),t.onProductSelect?.(null),o([]),l(!1)},h=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k),m=()=>"YABABYSSolution",g=()=>"https://qvamarkets.s3.us-east-2.amazonaws.com/V2_images/7258/",f=k=>{if(k.productImageUrl)return g()+m()+"/"+k?.productImageUrl;const W={Electronics:"https://via.placeholder.com/400x300/4F46E5/FFFFFF?text=Electronics",Furniture:"https://via.placeholder.com/400x300/059669/FFFFFF?text=Furniture",Food:"https://via.placeholder.com/400x300/DC2626/FFFFFF?text=Food",Clothing:"https://via.placeholder.com/400x300/7C3AED/FFFFFF?text=Clothing",Tools:"https://via.placeholder.com/400x300/EA580C/FFFFFF?text=Tools",General:"https://via.placeholder.com/400x300/6B7280/FFFFFF?text=Product"};return W[k.category]||W.General},w={padding:"2rem"},x={"max-width":"600px",margin:"0 auto 2rem",position:"relative"},S={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},C={background:"var(--surface-color)","border-radius":"var(--border-radius)",overflow:"hidden","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.3s ease"},j={position:"relative",width:"100%",height:"200px",overflow:"hidden",background:"#f5f5f5"},oe={width:"100%",height:"100%","object-fit":"cover",transition:"transform 0.3s ease"},te={padding:"1rem"},Z={"font-size":"1rem","font-weight":"600","margin-bottom":"0.5rem",color:"var(--text-primary)",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},re={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.25rem"},E={"font-size":"1.25rem","font-weight":"700",color:"var(--primary-color)","margin-top":"0.5rem"},$={display:"flex",gap:"2rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"2rem","box-shadow":"var(--shadow-md)","margin-bottom":"2rem",position:"relative"},T={width:"400px",height:"300px","border-radius":"var(--border-radius)",overflow:"hidden",background:"#f5f5f5"},B={flex:"1",display:"flex","flex-direction":"column",gap:"1rem"},_={display:"flex","justify-content":"space-between","padding-bottom":"0.5rem","border-bottom":"1px solid var(--border-light)"},P={"font-weight":"500",color:"var(--text-muted)"},b={"font-weight":"600",color:"var(--text-primary)"},H=k=>({display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600",background:"#d4edda",color:"#155724"}),K={"text-align":"center",padding:"4rem 2rem",color:"var(--text-muted)"},R={"font-size":"3rem","margin-bottom":"1rem",opacity:"0.5"};return(()=>{var k=Vk(),W=k.firstChild;return y(k,w),a(W,D(fp,{onChange:z=>{console.log(z);let U=z;l(!0),c(U)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}})),a(k,D(Ge,{get when(){return r()&&t.showDetails!==!1},get children(){var z=Ok(),U=z.firstChild,le=U.firstChild,L=U.nextSibling,M=L.nextSibling,G=M.firstChild,I=G.firstChild,F=I.nextSibling,X=G.nextSibling,Y=X.firstChild,Q=Y.nextSibling,J=X.nextSibling,V=J.firstChild,ne=V.nextSibling,ee=J.nextSibling,ce=ee.firstChild,se=ce.nextSibling,q=ee.nextSibling,ue=q.firstChild,ye=ue.nextSibling,de=q.nextSibling,ge=de.firstChild,xe=ge.nextSibling;return y(z,$),y(U,T),le.style.setProperty("width","100%"),le.style.setProperty("height","100%"),le.style.setProperty("object-fit","contain"),le.style.setProperty("aspect-ratio","1 / 1"),L.$$click=()=>{u()},L.style.setProperty("position","absolute"),L.style.setProperty("top","0.5rem"),L.style.setProperty("right","0.5rem"),L.style.setProperty("color","#3d3d3d"),L.style.setProperty("border-radius","50%"),L.style.setProperty("width","2rem"),L.style.setProperty("height","2rem"),L.style.setProperty("display","flex"),L.style.setProperty("align-items","center"),L.style.setProperty("justify-content","center"),L.style.setProperty("font-size","1.25rem"),L.style.setProperty("box-shadow","var(--shadow-sm)"),L.style.setProperty("cursor","pointer"),y(M,B),I.style.setProperty("margin","0 0 0.5rem 0"),I.style.setProperty("font-size","1.5rem"),a(I,()=>r().name),a(F,()=>e("products.inStock","In Stock")),a(Y,()=>e("products.sku","SKU")),a(Q,()=>r().sku),a(V,()=>e("inventory.category","Category")),a(ne,()=>r().category),a(ce,()=>e("inventory.unitOfMeasure","Unit")),a(se,()=>r().unitOfMeasure),a(ue,()=>e("inventory.unitCost","Cost")),a(ye,()=>h(r().unitCost)),a(ge,()=>e("inventory.UPC","UPC")),a(xe,()=>r().UPC),a(M,D(Ge,{get when(){return r().description},get children(){var pe=Fk(),_e=pe.firstChild,Re=_e.nextSibling;return pe.style.setProperty("margin-top","1rem"),a(_e,()=>e("common.description","Description")),Re.style.setProperty("margin-top","0.5rem"),Re.style.setProperty("color","var(--text-primary)"),a(Re,()=>r().description),we(Ee=>y(_e,P,Ee)),pe}}),null),we(pe=>{var _e=f(r()),Re=r().name,Ee=H(),Te=_,Le=P,Ie=b,De=_,Ye=P,Be=b,We=_,Ke=P,st=b,nt=_,He=P,mt=b,ut=_,at=P,It=b;return _e!==pe.e&&Qt(le,"src",pe.e=_e),Re!==pe.t&&Qt(le,"alt",pe.t=Re),pe.a=y(F,Ee,pe.a),pe.o=y(X,Te,pe.o),pe.i=y(Y,Le,pe.i),pe.n=y(Q,Ie,pe.n),pe.s=y(J,De,pe.s),pe.h=y(V,Ye,pe.h),pe.r=y(ne,Be,pe.r),pe.d=y(ee,We,pe.d),pe.l=y(ce,Ke,pe.l),pe.u=y(se,st,pe.u),pe.c=y(q,nt,pe.c),pe.w=y(ue,He,pe.w),pe.m=y(ye,mt,pe.m),pe.f=y(de,ut,pe.f),pe.y=y(ge,at,pe.y),pe.g=y(xe,It,pe.g),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),z}}),null),a(k,D(Ge,{get when(){return i().length>0},get children(){var z=Bk();return y(z,S),a(z,D(zt,{get each(){return i()},children:U=>(()=>{var le=zk(),L=le.firstChild,M=L.firstChild,G=L.nextSibling,I=G.firstChild,F=I.nextSibling,X=F.firstChild,Y=F.nextSibling,Q=Y.nextSibling;return le.addEventListener("mouseleave",J=>{J.currentTarget.style.transform="translateY(0)",J.currentTarget.style.boxShadow="var(--shadow-sm)";const V=J.currentTarget.querySelector("img");V&&(V.style.transform="scale(1)")}),le.addEventListener("mouseenter",J=>{J.currentTarget.style.transform="translateY(-4px)",J.currentTarget.style.boxShadow="var(--shadow-lg)";const V=J.currentTarget.querySelector("img");V&&(V.style.transform="scale(1.05)")}),le.$$click=()=>c(U),y(le,C),a(L,D(Ge,{get when(){return U===r()},get children(){var J=qk();return J.style.setProperty("position","absolute"),J.style.setProperty("top","0.5rem"),J.style.setProperty("right","0.5rem"),J.style.setProperty("background","var(--primary-color)"),J.style.setProperty("color","white"),J.style.setProperty("border-radius","50%"),J.style.setProperty("width","2rem"),J.style.setProperty("height","2rem"),J.style.setProperty("display","flex"),J.style.setProperty("align-items","center"),J.style.setProperty("justify-content","center"),J.style.setProperty("font-size","1.25rem"),J}}),null),y(G,te),a(I,()=>U.name),a(F,()=>U.sku,X),a(F,()=>U.category,null),a(Y,()=>U.unitOfMeasure),y(Q,E),a(Q,()=>h(U.sellingPrice)),we(J=>{var V=j,ne=f(U),ee=U.name,ce=oe,se=Z,q=U.name,ue=re,ye=re;return J.e=y(L,V,J.e),ne!==J.t&&Qt(M,"src",J.t=ne),ee!==J.a&&Qt(M,"alt",J.a=ee),J.o=y(M,ce,J.o),J.i=y(I,se,J.i),q!==J.n&&Qt(I,"title",J.n=q),J.s=y(F,ue,J.s),J.h=y(Y,ye,J.h),J},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),le})()})),z}}),null),a(k,D(Ge,{get when(){return!r()},get children(){var z=jk(),U=z.firstChild,le=U.nextSibling,L=le.nextSibling;return y(U,R),le.style.setProperty("margin-bottom","0.5rem"),a(le,()=>e("inventory.noProductsFound","No Products Found")),a(L,()=>e("inventory.tryDifferentSearch","Try a different search term")),we(M=>y(z,K,M)),z}}),null),we(z=>y(W,x,z)),k})()};pr(["click"]);var Hk=he("<div><div></div><div></div><div>"),x0=he("<div>"),Gk=he("<div><div><div><h2> - </h2><button></button></div><div>"),Wk=he("<div><div><div><div><h3></h3><span></span></div><div></div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const Yk=t=>{const{t:e}=Zt(),[r,n]=Ce(""),[i,o]=Ce(!1),s=Lt(()=>{const w=ct.movements,x=new Map;return w.forEach(S=>{const C=S.referenceNumber||S.invoiceId||S.ssg_inventory_key||"UNKNOWN";x.has(C)||x.set(C,{referenceNumber:C,movements:[],totalItems:0,totalValue:0,createdDate:S.createdDate,movementType:S.movementType});const j=x.get(C);j.movements.push(S),j.totalItems+=S.quantity,j.totalValue+=S.totalCost,new Date(S.createdDate)<new Date(j.createdDate)&&(j.createdDate=S.createdDate)}),Array.from(x.values()).filter(S=>S.movements.length>1).sort((S,C)=>new Date(C.createdDate).getTime()-new Date(S.createdDate).getTime())}),l=Lt(()=>{const w=s().find(x=>x.referenceNumber===r());return w?w.movements:[]}),c=w=>{n(w),o(!0)},u=()=>{o(!1),n("")},h=w=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(w),m=w=>new Date(w).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),g=w=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[w]||w,f=w=>({in:"#4caf50",out:"#f44336",transfer:"#2196f3",adjustment:"#ff9800"})[w]||"#666";return[D(qn,{get isOpen(){return $e(()=>!!t.isOpen)()&&!i()},get onClose(){return t.onClose},get title(){return e("inventory.viewHistoricalReports")},size:"large",get children(){var w=x0();return w.style.setProperty("max-height","70vh"),w.style.setProperty("overflow-y","auto"),a(w,D(Ge,{get when(){return s().length===0},get children(){var x=Hk(),S=x.firstChild,C=S.nextSibling,j=C.nextSibling;return x.style.setProperty("text-align","center"),x.style.setProperty("padding","3rem"),x.style.setProperty("color","var(--text-muted)"),S.style.setProperty("font-size","2rem"),S.style.setProperty("margin-bottom","1rem"),C.style.setProperty("font-size","1.1rem"),C.style.setProperty("margin-bottom","0.5rem"),a(C,()=>e("inventory.noBulkReportsFound","No bulk movement reports found")),j.style.setProperty("font-size","0.9rem"),a(j,()=>e("inventory.bulkReportsAppearHere","Bulk movement reports will appear here after you create bulk movements")),x}}),null),a(w,D(Ge,{get when(){return s().length>0},get children(){var x=x0();return x.style.setProperty("display","grid"),x.style.setProperty("gap","1rem"),a(x,D(zt,{get each(){return s()},children:S=>(()=>{var C=Wk(),j=C.firstChild,oe=j.firstChild,te=oe.firstChild,Z=te.firstChild,re=Z.nextSibling,E=te.nextSibling,$=j.nextSibling,T=$.firstChild,B=T.firstChild,_=B.nextSibling,P=T.nextSibling,b=P.firstChild,H=b.nextSibling,K=P.nextSibling,R=K.firstChild,k=R.nextSibling;return C.style.setProperty("padding","1.5rem"),C.style.setProperty("border","1px solid var(--border-color)"),C.style.setProperty("border-radius","var(--border-radius)"),C.style.setProperty("background","var(--surface-color)"),C.style.setProperty("transition","all 0.2s ease"),j.style.setProperty("display","flex"),j.style.setProperty("justify-content","space-between"),j.style.setProperty("align-items","flex-start"),j.style.setProperty("margin-bottom","1rem"),oe.style.setProperty("flex","1"),te.style.setProperty("display","flex"),te.style.setProperty("align-items","center"),te.style.setProperty("gap","1rem"),te.style.setProperty("margin-bottom","0.5rem"),Z.style.setProperty("margin","0"),Z.style.setProperty("font-size","1.1rem"),Z.style.setProperty("color","var(--text-primary)"),a(Z,()=>S.referenceNumber),re.style.setProperty("padding","0.25rem 0.75rem"),re.style.setProperty("border-radius","1rem"),re.style.setProperty("font-size","0.75rem"),re.style.setProperty("font-weight","500"),a(re,()=>g(S.movementType)),E.style.setProperty("color","var(--text-muted)"),E.style.setProperty("font-size","0.875rem"),a(E,()=>m(S.createdDate)),a(j,D(ht,{variant:"outline",size:"sm",onClick:()=>c(S.referenceNumber),get children(){return e("common.view")}}),null),$.style.setProperty("display","grid"),$.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),$.style.setProperty("gap","1rem"),$.style.setProperty("margin-bottom","1rem"),B.style.setProperty("font-size","0.75rem"),B.style.setProperty("font-weight","500"),B.style.setProperty("text-transform","uppercase"),B.style.setProperty("color","var(--text-muted)"),B.style.setProperty("margin-bottom","0.25rem"),a(B,()=>e("inventory.totalProducts")),_.style.setProperty("font-size","1.25rem"),_.style.setProperty("font-weight","600"),_.style.setProperty("color","var(--primary-color)"),a(_,()=>S.movements.length),b.style.setProperty("font-size","0.75rem"),b.style.setProperty("font-weight","500"),b.style.setProperty("text-transform","uppercase"),b.style.setProperty("color","var(--text-muted)"),b.style.setProperty("margin-bottom","0.25rem"),a(b,()=>e("inventory.totalItems")),H.style.setProperty("font-size","1.25rem"),H.style.setProperty("font-weight","600"),H.style.setProperty("color","var(--primary-color)"),a(H,()=>S.totalItems),R.style.setProperty("font-size","0.75rem"),R.style.setProperty("font-weight","500"),R.style.setProperty("text-transform","uppercase"),R.style.setProperty("color","var(--text-muted)"),R.style.setProperty("margin-bottom","0.25rem"),a(R,()=>e("inventory.estimatedValue")),k.style.setProperty("font-size","1.25rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),a(k,()=>h(S.totalValue)),we(W=>{var z=f(S.movementType)+"20",U=f(S.movementType);return z!==W.e&&((W.e=z)!=null?re.style.setProperty("background",z):re.style.removeProperty("background")),U!==W.t&&((W.t=U)!=null?re.style.setProperty("color",U):re.style.removeProperty("color")),W},{e:void 0,t:void 0}),C})()})),x}}),null),w}}),D(Ge,{get when(){return i()},get children(){var w=Gk(),x=w.firstChild,S=x.firstChild,C=S.firstChild,j=C.firstChild,oe=C.nextSibling,te=S.nextSibling;return w.style.setProperty("position","fixed"),w.style.setProperty("top","0"),w.style.setProperty("left","0"),w.style.setProperty("right","0"),w.style.setProperty("bottom","0"),w.style.setProperty("background","rgba(0, 0, 0, 0.5)"),w.style.setProperty("z-index","1000"),w.style.setProperty("display","flex"),w.style.setProperty("align-items","center"),w.style.setProperty("justify-content","center"),w.style.setProperty("padding","2rem"),x.style.setProperty("background","white"),x.style.setProperty("border-radius","var(--border-radius)"),x.style.setProperty("width","95%"),x.style.setProperty("max-width","1200px"),x.style.setProperty("max-height","90vh"),x.style.setProperty("overflow-y","auto"),x.style.setProperty("position","relative"),S.style.setProperty("padding","1rem 2rem"),S.style.setProperty("border-bottom","1px solid #e9ecef"),S.style.setProperty("display","flex"),S.style.setProperty("justify-content","space-between"),S.style.setProperty("align-items","center"),S.style.setProperty("background","#f8f9fa"),C.style.setProperty("margin","0"),a(C,()=>e("inventory.bulkMovementReport"),j),a(C,r,null),oe.$$click=u,oe.style.setProperty("background","none"),oe.style.setProperty("border","none"),oe.style.setProperty("font-size","1.5rem"),oe.style.setProperty("cursor","pointer"),oe.style.setProperty("padding","0.5rem"),oe.style.setProperty("line-height","1"),te.style.setProperty("padding","1rem"),a(te,D(T5,{get movements(){return l()},onClose:u})),w}})]};pr(["click"]);var Kk=he("<div><h1></h1><div>"),Mi=he("<div>"),Jk=he("<div><h3></h3><div>"),Qk=he("<div>: <!> "),Xk=he("<div><button></button><button></button><button></button><button>"),Zk=he("<div><div>"),eN=he("<div><span> (<!>)</span><span> / <!> "),tN=he("<div><div><h2></h2></div><div>"),rN=he("<div><div><div><span></span><h3></h3></div><div>  </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),nN=he("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),iN=he("<span> LOW");const oN=()=>{const{t}=Zt(),[e,r]=Ce(!1),[n,i]=Ce(!1),[o,s]=Ce(!1),[l,c]=Ce(null),[u,h]=Ce("overview"),[m,g]=Ce("new"),[f,w]=Ce([]),[x,S]=Ce(!1),[C,j]=Ce(!1),[oe,te]=Ce(!1),[Z,re]=Ce(!1),[E,$]=Ce(1),T=Y=>{c(Y),s(!0)},B=Lt(()=>{const Y=ct.products||[],Q=ct.movements||[],J=ct.stockLevels||[],V=ct.getLowStockProducts(),ne=Y?.length||0,ee=Y?.filter(q=>q.isActive).length,ce=J.reduce((q,ue)=>q*1+ue.quantity*1*ue.averageCost*1,0),se=Q?.filter(q=>{const ue=new Date(q.createdDate),ye=new Date;return ue.getMonth()===ye.getMonth()&&ue.getFullYear()===ye.getFullYear()}).length;return{totalProducts:ne,activeProducts:ee,lowStockProducts:V.length,totalStockValue:ce,totalMovementsThisMonth:se,totalLocations:ct.locations.length,activeLocations:ct.getActiveLocations().length}});Lt(()=>ct.products.map(Y=>{const Q=ct.getStockByProduct(Y.id),J=ct.getTotalStockByProduct(Y.id),V=ct.getLastLocationByProduct(Y.id);return{...Y,totalStock:J,stockByLocation:Q,lastLocation:V,isLowStock:J<=Y.minStockLevel}})),Lt(()=>{x(),$(1)});const _=(Y,Q)=>Y<=Q?t("inventory.lowStockAlert"):Y<=Q*2?t("inventory.normalStock"):t("inventory.inStock"),P=Y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Y),b=Y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Y),H=Y=>{switch(Y){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return Y}},K={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},R={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},k=Y=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:Y>50?"#d4edda":Y>20?"#fff3cd":"#f8d7da",color:Y>50?"#155724":Y>20?"#856404":"#721c24"}),W={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},z={color:"var(--text-muted)","font-size":"0.875rem"},U={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},le={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},L={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},M=Y=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:Y?"var(--primary-color)":"var(--text-muted)","border-bottom":Y?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),G={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},I={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},F=Lt(()=>{const Y=ct.movements;return{total:Y.length,stockIn:Y.filter(Q=>Q.movementType==="in").length,stockOut:Y.filter(Q=>Q.movementType==="out").length,transfers:Y.filter(Q=>Q.movementType==="transfer").length,adjustments:Y.filter(Q=>Q.movementType==="adjustment").length,totalValue:Y.reduce((Q,J)=>Q+J.totalCost,0)}}),X=async()=>{let Y=lr.state?.profile?.businessId;setTimeout(async()=>{await ct.getStockLevels("YY_")},2300),Vy.calcStockLevels(),await ct.fecthProduct(Y),await ct.fecthInventory(Y)};return Cn(()=>{X()}),D(lo,{get title(){return t("inventory.title")},get children(){return[(()=>{var Y=Kk(),Q=Y.firstChild,J=Q.nextSibling;return y(Y,le),Q.style.setProperty("margin","0"),Q.style.setProperty("font-size","1.75rem"),J.style.setProperty("display","flex"),J.style.setProperty("align-items","center"),J.style.setProperty("gap","1rem"),a(J,(()=>{var V=$e(()=>m()==="new");return()=>V()&&D(ht,{variant:"outline",onClick:()=>te(!0),get children(){return[" ",$e(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),a(J,D(Ge,{get when(){return lr.hasPermission("read_write")},get children(){return[D(ht,{variant:"outline",onClick:()=>re(!0),get children(){return[" ",$e(()=>t("inventory.viewHistoricalReports"))]}}),D(ht,{variant:"primary",onClick:()=>i(!0),get children(){return $e(()=>m()==="new")()?t("inventory.addMovement"):t("common.add")}})]}}),null),Y})(),D(Uk,{}),D(Ge,{get when(){return lr.hasPermission("inventoryDownsection")},get children(){return $e(()=>m()==="legacy")()?[(()=>{var Y=Mi();return a(Y,D(Dt,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var Q=Mi();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),a(Q,()=>ct.inventory.length),Q}}),null),a(Y,D(Dt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var Q=Mi();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),a(Q,()=>ct.getLowStockItems().length),Q}}),null),a(Y,D(Dt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var Q=Mi();return Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","var(--primary-color)"),a(Q,()=>P(ct.getTotalValue())),Q}}),null),we(Q=>y(Y,U,Q)),Y})(),(()=>{var Y=Mi();return y(Y,K),a(Y,D(zt,{get each(){return ct.inventory},children:Q=>{const J=_(Q.quantity,Q.minStock),V=Q.quantity<=Q.minStock?8:Q.quantity<=Q.minStock*2?35:75;return D(Dt,{onClick:()=>T(Q),get children(){return[(()=>{var ne=Jk(),ee=ne.firstChild,ce=ee.nextSibling;return y(ne,R),ee.style.setProperty("margin","0"),ee.style.setProperty("font-size","1.1rem"),a(ee,()=>Q.name),a(ce,J),we(se=>y(ce,k(V),se)),ne})(),(()=>{var ne=Mi();return y(ne,W),a(ne,()=>P(Q.price)),ne})(),(()=>{var ne=Qk(),ee=ne.firstChild,ce=ee.nextSibling;return ce.nextSibling,y(ne,z),a(ne,()=>t("inventory.quantity"),ee),a(ne,()=>Q.quantity,ce),a(ne,()=>t("common.units"),null),ne})()]}})}})),Y})()]:[(()=>{var Y=Xk(),Q=Y.firstChild,J=Q.nextSibling,V=J.nextSibling,ne=V.nextSibling;return y(Y,L),Q.$$click=()=>h("overview"),a(Q,()=>t("inventory.overview")),J.$$click=()=>h("products"),a(J,()=>t("inventory.products")),V.$$click=()=>h("movements"),a(V,()=>t("inventory.movements")),ne.$$click=()=>h("locations"),a(ne,()=>t("inventory.locations")),we(ee=>{var ce=M(u()==="overview"),se=M(u()==="products"),q=M(u()==="movements"),ue=M(u()==="locations");return ee.e=y(Q,ce,ee.e),ee.t=y(J,se,ee.t),ee.a=y(V,q,ee.a),ee.o=y(ne,ue,ee.o),ee},{e:void 0,t:void 0,a:void 0,o:void 0}),Y})(),$e(()=>$e(()=>u()==="overview")()&&(()=>{var Y=Zk(),Q=Y.firstChild;return a(Q,D(Dt,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var J=Mi();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),a(J,()=>B().activeProducts),J}}),null),a(Q,D(Dt,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var J=Mi();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","#d32f2f"),a(J,()=>B().lowStockProducts),J}}),null),a(Q,D(Dt,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var J=Mi();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),a(J,()=>b(F().totalValue)),J}}),null),a(Q,D(Dt,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var J=Mi();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),a(J,()=>B().totalMovementsThisMonth),J}}),null),a(Q,D(Dt,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var J=Mi();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),a(J,()=>B().activeLocations),J}}),null),a(Y,(()=>{var J=$e(()=>B().lowStockProducts>0);return()=>J()&&D(Dt,{get title(){return` ${t("inventory.lowStockAlert")}`},get subtitle(){return`${B().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var V=Mi();return V.style.setProperty("margin-top","1rem"),a(V,D(zt,{get each(){return ct.getLowStockProducts().slice(0,9)},children:ne=>(()=>{var ee=eN(),ce=ee.firstChild,se=ce.firstChild,q=se.nextSibling;q.nextSibling;var ue=ce.nextSibling,ye=ue.firstChild,de=ye.nextSibling;return de.nextSibling,ee.style.setProperty("display","flex"),ee.style.setProperty("justify-content","space-between"),ee.style.setProperty("margin-bottom","0.5rem"),ee.style.setProperty("font-size","0.875rem"),a(ce,()=>ne.name,se),a(ce,()=>ne?.sku,q),ue.style.setProperty("color","#d32f2f"),ue.style.setProperty("font-weight","600"),a(ue,()=>ne.currentStock,ye),a(ue,()=>ne.minStockLevel,de),a(ue,()=>t("inventory.min"),null),ee})()}),null),a(V,(()=>{var ne=$e(()=>ct.getLowStockProducts().length>5);return()=>ne()&&(()=>{var ee=Mi();return ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),ee.style.setProperty("font-style","italic"),a(ee,()=>t("common.andMore",{count:ct.getLowStockProducts().length-9})),ee})()})(),null),V}})})(),null),we(J=>y(Q,U,J)),Y})()),$e(()=>$e(()=>u()==="products")()&&D(k5,{})),$e(()=>$e(()=>u()==="movements")()&&D(GT,{})),$e(()=>$e(()=>u()==="locations")()&&(()=>{var Y=tN(),Q=Y.firstChild,J=Q.firstChild,V=Q.nextSibling;return Q.style.setProperty("display","flex"),Q.style.setProperty("justify-content","space-between"),Q.style.setProperty("align-items","center"),Q.style.setProperty("margin-bottom","1.5rem"),J.style.setProperty("margin","0"),J.style.setProperty("font-size","1.5rem"),a(J,()=>t("inventory.locations")),a(Q,D(Ge,{get when(){return lr.hasPermission("read_write")},get children(){return D(ht,{variant:"primary",onClick:()=>j(!0),get children(){return[" ",$e(()=>t("inventory.addLocation"))]}})}}),null),y(V,G),a(V,D(zt,{get each(){return ct.getActiveLocations()},children:ne=>{const ee=ct.getStockByLocation(ne.id),ce=ee?.length,se=ee?.reduce((ue,ye)=>ue*1+ye.quantity*1,0),q=ee?.reduce((ue,ye)=>(ct?.getProductById(ye.productId),ue+(ye?.averageCost||0)),0);return(()=>{var ue=rN(),ye=ue.firstChild,de=ye.firstChild,ge=de.firstChild,xe=ge.nextSibling,pe=de.nextSibling,_e=pe.firstChild,Re=pe.nextSibling,Ee=ye.nextSibling,Te=Ee.firstChild,Le=Te.firstChild,Ie=Le.firstChild,De=Le.nextSibling,Ye=Te.nextSibling,Be=Ye.firstChild,We=Be.firstChild,Ke=Be.nextSibling,st=Ye.nextSibling,nt=st.firstChild,He=nt.firstChild,mt=nt.nextSibling,ut=Ee.nextSibling,at=ut.firstChild,It=at.firstChild;return ye.style.setProperty("margin-bottom","1rem"),ye.style.setProperty("padding-bottom","1rem"),ye.style.setProperty("border-bottom","1px solid var(--border-color)"),de.style.setProperty("display","flex"),de.style.setProperty("align-items","center"),de.style.setProperty("gap","0.5rem"),de.style.setProperty("margin-bottom","0.5rem"),ge.style.setProperty("font-size","1.2rem"),a(ge,()=>ne.type==="warehouse"?"":ne.type==="store"?"":ne.type==="supplier"?"":""),xe.style.setProperty("margin","0"),xe.style.setProperty("font-size","1.1rem"),a(xe,()=>ne.name),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>ne.code,_e),a(pe,()=>H(ne.type),null),Re.style.setProperty("font-size","0.75rem"),Re.style.setProperty("color","var(--text-muted)"),Re.style.setProperty("margin-top","0.25rem"),a(Re,()=>ne.address),Ee.style.setProperty("margin-bottom","1rem"),Te.style.setProperty("display","flex"),Te.style.setProperty("justify-content","space-between"),Te.style.setProperty("margin-bottom","0.5rem"),Le.style.setProperty("font-size","0.875rem"),Le.style.setProperty("font-weight","500"),a(Le,()=>t("inventory.products"),Ie),De.style.setProperty("font-weight","600"),a(De,ce),Ye.style.setProperty("display","flex"),Ye.style.setProperty("justify-content","space-between"),Ye.style.setProperty("margin-bottom","0.5rem"),Be.style.setProperty("font-size","0.875rem"),Be.style.setProperty("font-weight","500"),a(Be,()=>t("inventory.totalItems"),We),Ke.style.setProperty("font-weight","600"),Ke.style.setProperty("color","var(--primary-color)"),a(Ke,se),st.style.setProperty("display","flex"),st.style.setProperty("justify-content","space-between"),st.style.setProperty("margin-bottom","1rem"),nt.style.setProperty("font-size","0.875rem"),nt.style.setProperty("font-weight","500"),a(nt,()=>t("inventory.totalValue"),He),mt.style.setProperty("font-weight","600"),mt.style.setProperty("color","var(--primary-color)"),a(mt,()=>b(q)),at.style.setProperty("font-weight","600"),at.style.setProperty("margin-bottom","0.75rem"),at.style.setProperty("font-size","0.875rem"),at.style.setProperty("color","var(--text-primary)"),at.style.setProperty("border-bottom","1px solid var(--border-color)"),at.style.setProperty("padding-bottom","0.5rem"),a(at,()=>t("inventory.productDetails"),It),a(ut,(()=>{var Xe=$e(()=>ee?.length===0);return()=>Xe()?(()=>{var kt=Mi();return kt.style.setProperty("text-align","center"),kt.style.setProperty("color","var(--text-muted)"),kt.style.setProperty("font-style","italic"),kt.style.setProperty("padding","1rem"),a(kt,()=>t("inventory.noProducts")),kt})():(()=>{var kt=Mi();return kt.style.setProperty("max-height","200px"),kt.style.setProperty("overflow-y","auto"),kt.style.setProperty("border","1px solid var(--border-color)"),kt.style.setProperty("border-radius","var(--border-radius-sm)"),a(kt,D(zt,{each:ee,children:Tt=>{const wt=ct.getProductById(Tt.productId);if(!wt)return null;const Rt=Tt.quantity<=wt.minStockLevel,fr=Tt.averageCost;return Tt.quantity?(()=>{var ze=nN(),Ct=ze.firstChild,xt=Ct.firstChild,tt=xt.firstChild,bt=tt.nextSibling,Mt=xt.nextSibling,Wt=Mt.firstChild,Jt=Wt.firstChild,lt=Wt.nextSibling,gt=lt.nextSibling;return gt.firstChild,ze.style.setProperty("padding","0.75rem"),ze.style.setProperty("border-bottom","1px solid var(--border-color)"),(Rt?"#fff5f5":"transparent")!=null?ze.style.setProperty("background",Rt?"#fff5f5":"transparent"):ze.style.removeProperty("background"),ze.style.setProperty("transition","background-color 0.2s ease"),Ct.style.setProperty("display","flex"),Ct.style.setProperty("justify-content","space-between"),Ct.style.setProperty("align-items","flex-start"),Ct.style.setProperty("margin-bottom","0.25rem"),xt.style.setProperty("flex","1"),tt.style.setProperty("font-weight","500"),tt.style.setProperty("font-size","0.875rem"),(Rt?"#d32f2f":"var(--text-primary)")!=null?tt.style.setProperty("color",Rt?"#d32f2f":"var(--text-primary)"):tt.style.removeProperty("color"),a(tt,()=>wt.name,null),a(tt,Rt&&(()=>{var $t=iN();return $t.style.setProperty("margin-left","0.5rem"),$t.style.setProperty("font-size","0.7rem"),$t.style.setProperty("color","#d32f2f"),$t})(),null),bt.style.setProperty("font-size","0.75rem"),bt.style.setProperty("color","var(--text-muted)"),bt.style.setProperty("margin-top","0.1rem"),a(bt,()=>wt.sku,null),a(bt,()=>wt.UPC?"  "+wt.UPC:"",null),a(bt,()=>wt.category?"  "+wt.category:"",null),Mt.style.setProperty("text-align","right"),Wt.style.setProperty("font-weight","600"),Wt.style.setProperty("font-size","0.875rem"),(Rt?"#d32f2f":"var(--primary-color)")!=null?Wt.style.setProperty("color",Rt?"#d32f2f":"var(--primary-color)"):Wt.style.removeProperty("color"),a(Wt,()=>Tt.quantity,Jt),a(Wt,()=>wt.unitOfMeasure,null),lt.style.setProperty("font-size","0.75rem"),lt.style.setProperty("color","var(--text-muted)"),a(lt,()=>b(fr)),gt.style.setProperty("font-size","0.7rem"),gt.style.setProperty("color","var(--text-muted)"),gt.style.setProperty("margin-top","0.1rem"),a(gt,()=>wt.minStockLevel,null),ze})():null}})),kt})()})(),null),we(Xe=>y(ue,{...I,"min-height":"400px"},Xe)),ue})()}})),Y})())]}}),D(Ge,{get when(){return lr.hasPermission("read_write")},get children(){return[D(WE,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return m()==="new"?"movement":"legacy"}}),D(pT,{get isOpen(){return n()},onClose:()=>i(!1)}),D(vT,{get isOpen(){return o()},onClose:()=>s(!1),get item(){return l()}}),D(zy,{get isOpen(){return C()},onClose:()=>j(!1),onLocationAdded:()=>{j(!1)}})]}}),D(ik,{get isOpen(){return oe()},onClose:()=>te(!1)}),D(Yk,{get isOpen(){return Z()},onClose:()=>re(!1)})]}})};pr(["click"]);const sN=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[Zc,af]=Ce(sN),N5={get employees(){return Zc()},addEmployee(t){const e={...t,id:Date.now().toString()};return af([...Zc(),e]),e},updateEmployee(t,e){af(Zc().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){af(Zc().filter(e=>e.id!==t))},getEmployeeById(t){return Zc().find(e=>e.id===t)}};var aN=he("<form><div>");const lN=t=>{const{t:e}=Zt(),[r,n]=Ce({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),i=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},s=c=>{c.preventDefault();const u=r();if(!u.name||!u.position||!u.salary||!u.email||!u.department||!u.startDate){alert(e("forms.requiredField"));return}const h={name:u.name,position:u.position,salary:parseFloat(u.salary),email:u.email,phone:u.phone,department:u.department,startDate:u.startDate};N5.addEmployee(h),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},l=(c,u)=>{n(h=>({...h,[c]:u}))};return D(qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var c=aN(),u=c.firstChild;return c.addEventListener("submit",s),a(c,D(Ar,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:h=>l("name",h),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),u),a(c,D(Ar,{get label(){return e("employees.position")},get value(){return r().position},onChange:h=>l("position",h),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),u),a(c,D(An,{get label(){return e("employees.department")},get value(){return r().department},onChange:h=>l("department",h),options:i,required:!0}),u),a(c,D(Ar,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:h=>l("email",h),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),u),a(c,D(Ar,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:h=>l("phone",h),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),u),a(c,D(Ar,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:h=>l("salary",h),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),u),a(c,D(Ar,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:h=>l("startDate",h),required:!0}),u),y(u,o),a(u,D(ht,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(u,D(ht,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),c}})};var cN=he("<div><div></div><div></div><div>"),uN=he("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),dN=he("<div>");const hN=t=>{const{t:e}=Zt(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},s={"text-align":"center","margin-bottom":"2rem"},l={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const h=f=>f.split(" ").map(w=>w[0]).join("").toUpperCase(),m=f=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(f),g=f=>new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return D(qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var f=cN(),w=f.firstChild,x=w.nextSibling,S=x.nextSibling;return y(f,s),y(w,o),a(w,()=>h(t.employee.name)),y(x,l),a(x,()=>t.employee.name),y(S,c),a(S,()=>t.employee.position),f})(),(()=>{var f=uN(),w=f.firstChild,x=w.firstChild,S=x.nextSibling,C=w.nextSibling,j=C.firstChild,oe=j.nextSibling,te=C.nextSibling,Z=te.firstChild,re=Z.nextSibling,E=te.nextSibling,$=E.firstChild,T=$.nextSibling,B=E.nextSibling,_=B.firstChild,P=_.nextSibling,b=B.nextSibling,H=b.firstChild,K=H.nextSibling;return a(x,()=>e("employees.employeeId")),a(S,()=>t.employee.id),a(j,()=>e("employees.department")),a(oe,()=>t.employee.department),a(Z,()=>e("employees.email")),a(re,()=>t.employee.email),a($,()=>e("employees.phone")),a(T,()=>t.employee.phone),a(_,()=>e("employees.salary")),a(P,()=>m(t.employee.salary)),a(H,()=>e("employees.hireDate")),a(K,()=>g(t.employee.startDate)),we(R=>{var k=r,W=n,z=i,U=r,le=n,L=i,M=r,G=n,I=i,F=r,X=n,Y=i,Q=r,J=n,V=i,ne=r,ee=n,ce=i;return R.e=y(w,k,R.e),R.t=y(x,W,R.t),R.a=y(S,z,R.a),R.o=y(C,U,R.o),R.i=y(j,le,R.i),R.n=y(oe,L,R.n),R.s=y(te,M,R.s),R.h=y(Z,G,R.h),R.r=y(re,I,R.r),R.d=y(E,F,R.d),R.l=y($,X,R.l),R.u=y(T,Y,R.u),R.c=y(B,Q,R.c),R.w=y(_,J,R.w),R.m=y(P,V,R.m),R.f=y(b,ne,R.f),R.y=y(H,ee,R.y),R.g=y(K,ce,R.g),R},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),f})(),(()=>{var f=dN();return y(f,u),a(f,D(ht,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(f,D(ht,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),f})()]}})};var A0=he("<div>"),pN=he("<div><div></div><div><div></div><div></div><div>/year");const fN=()=>{const{t}=Zt(),[e,r]=Ce(!1),[n,i]=Ce(!1),[o,s]=Ce(null),l=x=>{s(x),i(!0)},c={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},u={display:"flex","align-items":"center",gap:"1rem"},h={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},m={flex:"1"},g={"font-weight":"600","margin-bottom":"0.25rem"},f={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},w={color:"var(--primary-color)","font-weight":"500"};return D(lo,{get title(){return t("employees.title")},get children(){return[(()=>{var x=A0();return x.style.setProperty("margin-bottom","2rem"),a(x,D(ht,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),x})(),(()=>{var x=A0();return y(x,c),a(x,()=>N5.employees.map(S=>{const C=oe=>oe.split(" ").map(te=>te[0]).join("").toUpperCase(),j=oe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(oe);return D(Dt,{onClick:()=>l(S),get children(){var oe=pN(),te=oe.firstChild,Z=te.nextSibling,re=Z.firstChild,E=re.nextSibling,$=E.nextSibling,T=$.firstChild;return y(oe,u),y(te,h),a(te,()=>C(S.name)),y(Z,m),y(re,g),a(re,()=>S.name),y(E,f),a(E,()=>S.position),y($,w),a($,()=>j(S.salary),T),oe}})})),x})(),D(lN,{get isOpen(){return e()},onClose:()=>r(!1)}),D(hN,{get isOpen(){return n()},onClose:()=>i(!1),get employee(){return o()}})]}})},mN=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],yN=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],gN=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],vN=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[jd,C0]=Ce(mN),[fa,lf]=Ce(yN),[eu,I0]=Ce(gN),[Vd,$0]=Ce(vN),Wn={get bankAccounts(){return jd()},addBankAccount(t){const e={...t,id:Date.now().toString()};return C0([...jd(),e]),e},updateBankAccount(t,e){C0(jd().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return jd().find(e=>e.id===t)},get bankStatements(){return fa()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return lf([...fa(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return lf([...fa(),...e]),e},updateBankStatement(t,e){lf(fa().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return fa().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):fa()).filter(r=>!r.isReconciled)},get entryBookRecords(){return eu()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return I0([...eu(),e]),e},updateEntryBookRecord(t,e){I0(eu().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return eu().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):eu()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=fa().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=fa().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const i=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,o=new Date(e.date),s=new Date(n.date),c=Math.abs((o.getTime()-s.getTime())/(1e3*60*60*24))<=3,u=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return i&&(c||u)}).sort((n,i)=>{const o=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(i.date===e.date?2:0)+(i.reference===e.reference?1:0)-o}):[]},get reconciliationSessions(){return Vd()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(u=>u.date>=e&&u.date<=r),i=this.getEntryBookRecordsByAccount(t).filter(u=>u.date>=e&&u.date<=r),o=n.filter(u=>u.isReconciled).length,s=this.getBankAccountById(t)?.lastReconciledBalance||0,l=this.getBankAccountById(t)?.currentBalance||0,c={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:s,endingBalance:l,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:i.length,reconciledTransactions:o,unreconciledTransactions:n.length-o,discrepancyAmount:0,createdAt:new Date().toISOString()};return $0([...Vd(),c]),c},updateReconciliationSession(t,e){$0(Vd().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return Vd().filter(e=>e.bankAccountId===t)}};var cf=he("<div>"),bN=he("<div><strong>:</strong> <!> - "),_N=he("<div><div><div></div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),SN=he("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),tc=he("<option>"),PN=he("<div><table><thead><tr></tr></thead><tbody>"),wN=he("<th>"),xN=he("<tr>"),AN=he("<td>");const CN=t=>{const{t:e}=Zt(),[r,n]=Ce(!1),[i,o]=Ce(!1),[s,l]=Ce(null),[c,u]=Ce([]),[h,m]=Ce({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),g={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},f={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},w={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},x={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},S={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},C={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},j={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},oe=P=>{P.preventDefault(),n(!0)},te=P=>{P.preventDefault(),n(!1)},Z=P=>{P.preventDefault(),n(!1);const b=P.dataTransfer?.files;b&&b.length>0&&E(b[0])},re=P=>{const b=P.target;b.files&&b.files.length>0&&E(b.files[0])},E=P=>{if(!P.name.toLowerCase().endsWith(".csv")){l({success:!1,message:e("banking.pleaseUploadCSV")});return}o(!0);const b=new FileReader;b.onload=H=>{try{const R=(H.target?.result).split(`
`).filter(U=>U.trim());if(R.length<2){l({success:!1,message:e("banking.csvRequiresHeaderAndData")}),o(!1);return}const k=R[0].split(",").map(U=>U.trim().replace(/[\"\']/g,"")),W=R.slice(1).map(U=>{const le=U.split(",").map(M=>M.trim().replace(/[\"\']/g,"")),L={};return k.forEach((M,G)=>{L[M]=le[G]||""}),L});u(W),l({success:!0,message:e("banking.successfullyParsed").replace("{count}",W.length.toString()),count:W.length});const z={...h()};k.forEach(U=>{const le=U.toLowerCase();le.includes("date")&&(z.date=U),(le.includes("description")||le.includes("memo"))&&(z.description=U),(le.includes("reference")||le.includes("check")||le.includes("ref"))&&(z.reference=U),(le.includes("debit")||le.includes("deposit"))&&(z.debit=U),(le.includes("credit")||le.includes("withdrawal")||le.includes("amount"))&&(z.debit?z.credit=U:z.debit=U),le.includes("balance")&&(z.balance=U)}),m(z)}catch{l({success:!1,message:e("banking.errorParsingCSV")})}o(!1)},b.readAsText(P)},$=(P,b)=>{m(H=>({...H,[P]:b}))},T=()=>c().length===0?[]:Object.keys(c()[0]),B=()=>{if(!t.bankAccount||c().length===0)return;const P=h();if(!P.date||!P.description){l({success:!1,message:e("banking.dateDescriptionRequired")});return}o(!0);try{const b=c().map(K=>{const R=U=>U&&parseFloat(U.replace(/[^0-9.-]/g,""))||0,k=U=>{const le=new Date(U);if(isNaN(le.getTime())){const L=U.split("/");if(L.length===3)return new Date(parseInt(L[2]),parseInt(L[0])-1,parseInt(L[1])).toISOString().split("T")[0]}return le.toISOString().split("T")[0]};let W=0,z=0;if(P.debit&&P.credit)W=R(K[P.debit]),z=R(K[P.credit]);else if(P.debit){const U=R(K[P.debit]);U>0?W=U:z=Math.abs(U)}return{accountId:t.bankAccount.accountId,date:k(K[P.date]),description:K[P.description]||e("banking.importedTransaction"),reference:K[P.reference]||"",debitAmount:W,creditAmount:z,balance:P.balance?R(K[P.balance]):0,isReconciled:!1}}),H=Wn.addBankStatementsFromCSV(b);l({success:!0,message:e("banking.successfullyImported").replace("{count}",H.length.toString()),count:H.length}),u([]),m({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{l({success:!1,message:e("banking.errorImportingTransactions")})}o(!1)},_=()=>{u([]),l(null),m({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return D(qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[$e(()=>$e(()=>!!t.bankAccount)()&&(()=>{var P=bN(),b=P.firstChild,H=b.firstChild,K=b.nextSibling,R=K.nextSibling;return R.nextSibling,P.style.setProperty("margin-bottom","1.5rem"),P.style.setProperty("padding","1rem"),P.style.setProperty("background","var(--background-color)"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("border","1px solid var(--border-color)"),a(b,()=>e("banking.bankAccount"),H),a(P,()=>t.bankAccount.bankName,R),a(P,()=>t.bankAccount.accountNumber,null),P})()),$e(()=>$e(()=>c().length===0)()?(()=>{var P=_N(),b=P.firstChild,H=b.firstChild,K=H.nextSibling,R=K.nextSibling,k=b.nextSibling;return b.$$click=()=>document.getElementById("csvFileInput")?.click(),b.addEventListener("drop",Z),b.addEventListener("dragleave",te),b.addEventListener("dragover",oe),H.style.setProperty("font-size","2rem"),H.style.setProperty("margin-bottom","1rem"),K.style.setProperty("font-weight","500"),K.style.setProperty("margin-bottom","0.5rem"),a(K,(()=>{var W=$e(()=>!!r());return()=>W()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("color","var(--text-muted)"),a(R,()=>e("banking.supportedFormat")),k.addEventListener("change",re),k.style.setProperty("display","none"),we(W=>y(b,g,W)),P})():(()=>{var P=SN(),b=P.firstChild,H=b.nextSibling,K=H.firstChild,R=K.firstChild,k=R.firstChild,W=R.nextSibling,z=W.firstChild,U=K.nextSibling,le=U.firstChild,L=le.firstChild,M=le.nextSibling,G=M.firstChild,I=U.nextSibling,F=I.firstChild,X=F.nextSibling,Y=X.firstChild,Q=I.nextSibling,J=Q.firstChild,V=J.firstChild,ne=J.nextSibling,ee=ne.firstChild,ce=Q.nextSibling,se=ce.firstChild,q=se.nextSibling,ue=q.firstChild,ye=ce.nextSibling,de=ye.firstChild,ge=de.nextSibling,xe=ge.firstChild;return b.style.setProperty("margin","0 0 1rem 0"),a(b,()=>e("banking.mapCSVColumns")),y(H,f),R.style.setProperty("display","block"),R.style.setProperty("margin-bottom","0.5rem"),R.style.setProperty("font-weight","500"),a(R,()=>e("banking.dateColumn"),k),W.addEventListener("change",pe=>$("date",pe.target.value)),a(z,()=>e("banking.selectColumn")),a(W,()=>T().map(pe=>(()=>{var _e=tc();return _e.value=pe,a(_e,pe),_e})()),null),le.style.setProperty("display","block"),le.style.setProperty("margin-bottom","0.5rem"),le.style.setProperty("font-weight","500"),a(le,()=>e("banking.descriptionColumn"),L),M.addEventListener("change",pe=>$("description",pe.target.value)),a(G,()=>e("banking.selectColumn")),a(M,()=>T().map(pe=>(()=>{var _e=tc();return _e.value=pe,a(_e,pe),_e})()),null),F.style.setProperty("display","block"),F.style.setProperty("margin-bottom","0.5rem"),F.style.setProperty("font-weight","500"),a(F,()=>e("banking.referenceColumn")),X.addEventListener("change",pe=>$("reference",pe.target.value)),a(Y,()=>e("banking.selectColumn")),a(X,()=>T().map(pe=>(()=>{var _e=tc();return _e.value=pe,a(_e,pe),_e})()),null),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),a(J,()=>e("banking.amountDebitColumn"),V),ne.addEventListener("change",pe=>$("debit",pe.target.value)),a(ee,()=>e("banking.selectColumn")),a(ne,()=>T().map(pe=>(()=>{var _e=tc();return _e.value=pe,a(_e,pe),_e})()),null),se.style.setProperty("display","block"),se.style.setProperty("margin-bottom","0.5rem"),se.style.setProperty("font-weight","500"),a(se,()=>e("banking.creditColumn")),q.addEventListener("change",pe=>$("credit",pe.target.value)),a(ue,()=>e("banking.selectColumn")),a(q,()=>T().map(pe=>(()=>{var _e=tc();return _e.value=pe,a(_e,pe),_e})()),null),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("banking.balanceColumn")),ge.addEventListener("change",pe=>$("balance",pe.target.value)),a(xe,()=>e("banking.selectColumn")),a(ge,()=>T().map(pe=>(()=>{var _e=tc();return _e.value=pe,a(_e,pe),_e})()),null),a(P,(()=>{var pe=$e(()=>c().length>0);return()=>pe()&&(()=>{var _e=PN(),Re=_e.firstChild,Ee=Re.firstChild,Te=Ee.firstChild,Le=Ee.nextSibling;return y(_e,x),Te.style.setProperty("background-color","var(--background-color)"),a(Te,()=>T().slice(0,6).map(Ie=>(()=>{var De=wN();return a(De,Ie),we(Ye=>y(De,C,Ye)),De})())),a(Le,()=>c().slice(0,3).map(Ie=>(()=>{var De=xN();return a(De,()=>T().slice(0,6).map(Ye=>(()=>{var Be=AN();return a(Be,()=>Ie[Ye]),we(We=>y(Be,C,We)),Be})())),De})())),a(_e,(()=>{var Ie=$e(()=>c().length>3);return()=>Ie()&&(()=>{var De=cf();return De.style.setProperty("padding","0.5rem"),De.style.setProperty("text-align","center"),De.style.setProperty("color","var(--text-muted)"),a(De,()=>e("banking.andMoreRows").replace("{count}",(c().length-3).toString())),De})()})(),null),we(Ie=>y(Re,S,Ie)),_e})()})(),null),we(pe=>{var _e=w,Re=w,Ee=w,Te=w,Le=w,Ie=w;return pe.e=y(W,_e,pe.e),pe.t=y(M,Re,pe.t),pe.a=y(X,Ee,pe.a),pe.o=y(ne,Te,pe.o),pe.i=y(q,Le,pe.i),pe.n=y(ge,Ie,pe.n),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),we(()=>W.value=h().date),we(()=>M.value=h().description),we(()=>X.value=h().reference),we(()=>ne.value=h().debit),we(()=>q.value=h().credit),we(()=>ge.value=h().balance),P})()),$e(()=>$e(()=>!!s())()&&(()=>{var P=cf();return P.style.setProperty("padding","1rem"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("margin-top","1rem"),a(P,()=>s().message),we(b=>{var H=s().success?"#d4edda":"#f8d7da",K=s().success?"#155724":"#721c24",R=`1px solid ${s().success?"#c3e6cb":"#f5c6cb"}`;return H!==b.e&&((b.e=H)!=null?P.style.setProperty("background",H):P.style.removeProperty("background")),K!==b.t&&((b.t=K)!=null?P.style.setProperty("color",K):P.style.removeProperty("color")),R!==b.a&&((b.a=R)!=null?P.style.setProperty("border",R):P.style.removeProperty("border")),b},{e:void 0,t:void 0,a:void 0}),P})()),(()=>{var P=cf();return y(P,j),a(P,D(ht,{variant:"secondary",onClick:()=>{_(),t.onClose()},get children(){return e("common.cancel")}}),null),a(P,(()=>{var b=$e(()=>c().length>0);return()=>b()&&D(ht,{variant:"outline",onClick:_,get children(){return e("common.reset")}})})(),null),a(P,(()=>{var b=$e(()=>c().length>0);return()=>b()&&D(ht,{variant:"primary",onClick:B,get disabled(){return i()||!h().date||!h().description},get children(){return $e(()=>!!i())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",c().length.toString())}})})(),null),P})()]}})};pr(["click"]);var E0=he("<span>"),qd=he("<div>"),T0=he("<div> "),IN=he("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),$N=he("<div><div><div></div><div>  </div></div><div><div>"),uf=he("<span> "),EN=he("<span>(<!>)"),TN=he("<div><strong>:</strong> "),k0=he("<div><div><div></div><div>  </div></div><div>"),kN=he("<div><div>:</div><div></div><div>");const NN=t=>{const{t:e}=Zt(),[r,n]=Ce([]),[i,o]=Ce([]),[s,l]=Ce(null),[c,u]=Ce([]),[h,m]=Ce("unreconciled");Ei(()=>{const R=Wn.getBankAccountById(t.bankAccountId);if(R){const k=Wn.getBankStatementsByAccount(R.accountId).filter(z=>z.date>=t.selectedPeriod.start&&z.date<=t.selectedPeriod.end),W=Wn.getEntryBookRecordsByAccount(R.accountId).filter(z=>z.date>=t.selectedPeriod.start&&z.date<=t.selectedPeriod.end);n(k),o(W)}});const g=()=>{const R=r();switch(h()){case"reconciled":return R.filter(k=>k.isReconciled);case"unreconciled":return R.filter(k=>!k.isReconciled);default:return R}},f=()=>{const R=i();switch(h()){case"reconciled":return R.filter(k=>k.isReconciled);case"unreconciled":return R.filter(k=>!k.isReconciled);default:return R}},w=R=>{if(l(R),R.isReconciled)u([]);else{const k=Wn.findPotentialMatches(R.id);u(k)}},x=R=>{const k=s();if(k){Wn.reconcileTransaction(k.id,R.id);const W=Wn.getBankAccountById(t.bankAccountId);if(W){const z=Wn.getBankStatementsByAccount(W.accountId).filter(le=>le.date>=t.selectedPeriod.start&&le.date<=t.selectedPeriod.end),U=Wn.getEntryBookRecordsByAccount(W.accountId).filter(le=>le.date>=t.selectedPeriod.start&&le.date<=t.selectedPeriod.end);n(z),o(U)}l(null),u([])}},S=R=>{Wn.unreconciledTransaction(R.id);const k=Wn.getBankAccountById(t.bankAccountId);if(k){const W=Wn.getBankStatementsByAccount(k.accountId).filter(U=>U.date>=t.selectedPeriod.start&&U.date<=t.selectedPeriod.end),z=Wn.getEntryBookRecordsByAccount(k.accountId).filter(U=>U.date>=t.selectedPeriod.start&&U.date<=t.selectedPeriod.end);n(W),o(z)}},C={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},j={height:"600px","overflow-y":"auto"},oe={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},te=R=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:R?"var(--primary-color)":"var(--surface-color)",color:R?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),Z=(R,k)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:R?"var(--primary-color)":k?"#e8f5e8":"var(--surface-color)",color:R?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${R?"var(--primary-color)":k?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),re={flex:"1"},E={"font-weight":"500","margin-bottom":"0.25rem"},$={"font-size":"0.875rem",opacity:"0.8"},T=R=>({"font-weight":"600",color:R?"#4caf50":"#f44336"}),B={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},_=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),P=R=>new Date(R).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),b=R=>{if(!s())return null;const k=s();return(Math.abs(k.debitAmount-R.debitAmount)<.01||Math.abs(k.creditAmount-R.creditAmount)<.01)&&k.date===R.date?(()=>{var U=E0();return a(U,()=>e("banking.exactMatch")),we(le=>y(U,{...B,background:"#d4edda",color:"#155724"},le)),U})():c().includes(R)?(()=>{var U=E0();return a(U,()=>e("banking.possibleMatch")),we(le=>y(U,{...B,background:"#fff3cd",color:"#856404"},le)),U})():null},K=(()=>{const R=r(),k=i(),W=R.filter(U=>U.isReconciled).length,z=k.filter(U=>U.isReconciled).length;return{totalStatements:R.length,totalRecords:k.length,reconciledStatements:W,reconciledRecords:z,unreconciledStatements:R.length-W,unreconciledRecords:k.length-z}})();return(()=>{var R=IN(),k=R.firstChild,W=k.firstChild,z=W.nextSibling,U=z.firstChild,le=U.nextSibling,L=le.nextSibling,M=k.nextSibling,G=M.nextSibling,I=G.firstChild,F=I.firstChild,X=F.nextSibling,Y=I.nextSibling,Q=Y.firstChild,J=Q.nextSibling;return y(k,oe),W.style.setProperty("margin","0"),W.style.setProperty("font-size","1.25rem"),a(W,()=>e("banking.reconciliationComparison")),z.style.setProperty("display","flex"),z.style.setProperty("gap","0.5rem"),U.$$click=()=>m("all"),a(U,()=>e("common.all")),le.$$click=()=>m("unreconciled"),a(le,()=>e("banking.unreconciled")),L.$$click=()=>m("reconciled"),a(L,()=>e("banking.reconciled")),M.style.setProperty("display","grid"),M.style.setProperty("grid-template-columns","repeat(4, 1fr)"),M.style.setProperty("gap","1rem"),M.style.setProperty("margin-bottom","2rem"),a(M,D(Dt,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var V=qd();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","var(--primary-color)"),a(V,()=>K.totalStatements),V})(),(()=>{var V=T0(),ne=V.firstChild;return V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),a(V,()=>K.reconciledStatements,ne),a(V,()=>e("banking.reconciled"),null),V})()]}}),null),a(M,D(Dt,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var V=qd();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","var(--primary-color)"),a(V,()=>K.totalRecords),V})(),(()=>{var V=T0(),ne=V.firstChild;return V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),a(V,()=>K.reconciledRecords,ne),a(V,()=>e("banking.reconciled"),null),V})()]}}),null),a(M,D(Dt,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var V=qd();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","#f44336"),a(V,()=>K.unreconciledStatements),V}}),null),a(M,D(Dt,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var V=qd();return V.style.setProperty("font-size","1.5rem"),V.style.setProperty("font-weight","600"),V.style.setProperty("color","#f44336"),a(V,()=>K.unreconciledRecords),V}}),null),y(G,C),F.style.setProperty("margin","0 0 1rem 0"),a(F,()=>e("banking.bankStatements")),a(X,()=>g().map(V=>(()=>{var ne=$N(),ee=ne.firstChild,ce=ee.firstChild,se=ce.nextSibling,q=se.firstChild,ue=ee.nextSibling,ye=ue.firstChild;return ne.$$click=()=>w(V),a(ce,()=>V.description),a(se,()=>P(V.date),q),a(se,()=>V.reference,null),a(se,(()=>{var de=$e(()=>!!V.isReconciled);return()=>de()&&(()=>{var ge=uf();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),a(ge,()=>e("banking.reconciled"),null),ge})()})(),null),a(ye,()=>V.debitAmount>0?"+":"-",null),a(ye,()=>_(V.debitAmount||V.creditAmount),null),a(ue,(()=>{var de=$e(()=>!!V.isReconciled);return()=>de()&&D(ht,{variant:"outline",size:"sm",onClick:ge=>{ge.stopPropagation(),S(V)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),we(de=>{var ge=Z(s()?.id===V.id,V.isReconciled),xe=re,pe=E,_e=$,Re=T(V.debitAmount>0);return de.e=y(ne,ge,de.e),de.t=y(ee,xe,de.t),de.a=y(ce,pe,de.a),de.o=y(se,_e,de.o),de.i=y(ye,Re,de.i),de},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ne})())),Q.style.setProperty("margin","0 0 1rem 0"),a(Q,()=>e("banking.entryBookRecords"),null),a(Q,(()=>{var V=$e(()=>!!(s()&&!s().isReconciled));return()=>V()&&(()=>{var ne=EN(),ee=ne.firstChild,ce=ee.nextSibling;return ce.nextSibling,ne.style.setProperty("font-weight","400"),ne.style.setProperty("color","var(--text-muted)"),ne.style.setProperty("margin-left","0.5rem"),a(ne,()=>e("banking.clickToReconcile"),ce),ne})()})(),null),a(J,(()=>{var V=$e(()=>!!(s()&&!s().isReconciled));return()=>V()?[$e(()=>$e(()=>c().length>0)()&&(()=>{var ne=TN(),ee=ne.firstChild,ce=ee.firstChild;return ee.nextSibling,ne.style.setProperty("margin-bottom","1rem"),ne.style.setProperty("padding","0.75rem"),ne.style.setProperty("background","#fff3cd"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),a(ee,()=>e("banking.potentialMatchesFound"),ce),a(ne,()=>e("banking.clickRecordToReconcile"),null),ne})()),$e(()=>f().map(ne=>(c().includes(ne),(()=>{var ee=k0(),ce=ee.firstChild,se=ce.firstChild,q=se.nextSibling,ue=q.firstChild,ye=ce.nextSibling;return ee.$$click=()=>{ne.isReconciled||x(ne)},a(se,()=>ne.description,null),a(se,()=>b(ne),null),a(q,()=>P(ne.date),ue),a(q,()=>ne.reference,null),a(q,(()=>{var de=$e(()=>!!ne.isReconciled);return()=>de()&&(()=>{var ge=uf();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),a(ge,()=>e("banking.reconciled"),null),ge})()})(),null),a(ye,()=>ne.debitAmount>0?"+":"-",null),a(ye,()=>_(ne.debitAmount||ne.creditAmount),null),we(de=>{var ge={...Z(!1,ne.isReconciled),opacity:ne.isReconciled?.6:1,cursor:ne.isReconciled?"not-allowed":"pointer"},xe=re,pe=E,_e=$,Re=T(ne.debitAmount>0);return de.e=y(ee,ge,de.e),de.t=y(ce,xe,de.t),de.a=y(se,pe,de.a),de.o=y(q,_e,de.o),de.i=y(ye,Re,de.i),de},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ee})())))]:f().map(ne=>(()=>{var ee=k0(),ce=ee.firstChild,se=ce.firstChild,q=se.nextSibling,ue=q.firstChild,ye=ce.nextSibling;return a(se,()=>ne.description),a(q,()=>P(ne.date),ue),a(q,()=>ne.reference,null),a(q,(()=>{var de=$e(()=>!!ne.isReconciled);return()=>de()&&(()=>{var ge=uf();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),a(ge,()=>e("banking.reconciled"),null),ge})()})(),null),a(ye,()=>ne.debitAmount>0?"+":"-",null),a(ye,()=>_(ne.debitAmount||ne.creditAmount),null),we(de=>{var ge=Z(!1,ne.isReconciled),xe=re,pe=E,_e=$,Re=T(ne.debitAmount>0);return de.e=y(ee,ge,de.e),de.t=y(ce,xe,de.t),de.a=y(se,pe,de.a),de.o=y(q,_e,de.o),de.i=y(ye,Re,de.i),de},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ee})())})()),a(R,(()=>{var V=$e(()=>!!(s()&&!s().isReconciled));return()=>V()&&(()=>{var ne=kN(),ee=ne.firstChild,ce=ee.firstChild,se=ee.nextSibling,q=se.nextSibling;return ne.style.setProperty("position","fixed"),ne.style.setProperty("bottom","2rem"),ne.style.setProperty("right","2rem"),ne.style.setProperty("background","var(--surface-color)"),ne.style.setProperty("padding","1rem"),ne.style.setProperty("border-radius","var(--border-radius)"),ne.style.setProperty("box-shadow","var(--shadow-lg)"),ne.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("max-width","300px"),ee.style.setProperty("font-weight","500"),ee.style.setProperty("margin-bottom","0.5rem"),a(ee,()=>e("banking.selected"),ce),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("margin-bottom","0.5rem"),a(se,()=>s().description),q.style.setProperty("font-weight","600"),q.style.setProperty("color","var(--primary-color)"),a(q,()=>_(s().debitAmount||s().creditAmount)),a(ne,D(ht,{variant:"secondary",size:"sm",onClick:()=>{l(null),u([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),ne})()})(),null),we(V=>{var ne=te(h()==="all"),ee=te(h()==="unreconciled"),ce=te(h()==="reconciled"),se=j,q=j;return V.e=y(U,ne,V.e),V.t=y(le,ee,V.t),V.a=y(L,ce,V.a),V.o=y(X,se,V.o),V.i=y(J,q,V.i),V},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),R})()};pr(["click"]);var LN=he("<div><div><h2></h2><p></p></div><div>"),RN=he("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),DN=he("<div><button></button><button>"),MN=he("<div><br>"),tu=he("<div>"),FN=he("<div><div></div><div>  </div><div>"),ON=he("<div>: "),BN=he("<div> <!>  <!> "),jN=he("<div>%"),VN=he("<div> of <!> transactions");const qN=()=>{const{t}=Zt(),[e,r]=Ce(null),[n,i]=Ce({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[o,s]=Ce(!1),[l,c]=Ce("overview");Ei(()=>{!e()&&Wn.bankAccounts.length>0&&r(Wn.bankAccounts[0])});const u={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},h={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},m={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},g=oe=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:oe?"var(--primary-color)":"var(--text-muted)","border-bottom":oe?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),f={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},w=oe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(oe),x=oe=>new Date(oe).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),S=()=>Wn.bankAccounts.map(oe=>({value:oe.id,label:`${oe.bankName} - ${oe.accountNumber} (${oe.accountType})`})),j=(()=>{if(!e())return null;const oe=Wn.getBankStatementsByAccount(e().accountId).filter(re=>re.date>=n().start&&re.date<=n().end),te=Wn.getEntryBookRecordsByAccount(e().accountId).filter(re=>re.date>=n().start&&re.date<=n().end),Z=oe.filter(re=>re.isReconciled).length;return te.filter(re=>re.isReconciled).length,{totalBankTransactions:oe.length,totalEntryBookRecords:te.length,reconciledTransactions:Z,unreconciledTransactions:oe.length-Z,reconciliationRate:oe.length>0?Z/oe.length*100:0}})();return D(lo,{get title(){return t("banking.title")},get children(){return[(()=>{var oe=LN(),te=oe.firstChild,Z=te.firstChild,re=Z.nextSibling,E=te.nextSibling;return y(oe,u),Z.style.setProperty("margin","0 0 0.5rem 0"),Z.style.setProperty("font-size","1.5rem"),a(Z,()=>t("banking.reconciliation")),re.style.setProperty("margin","0"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>t("banking.compareStatements")),E.style.setProperty("display","flex"),E.style.setProperty("gap","1rem"),a(E,D(ht,{variant:"secondary",onClick:()=>s(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),a(E,D(ht,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),oe})(),(()=>{var oe=RN(),te=oe.firstChild,Z=te.firstChild,re=te.nextSibling,E=re.firstChild,$=E.nextSibling,T=re.nextSibling,B=T.firstChild,_=B.nextSibling;return y(oe,h),te.style.setProperty("flex","1"),Z.style.setProperty("display","block"),Z.style.setProperty("margin-bottom","0.5rem"),Z.style.setProperty("font-weight","500"),a(Z,()=>t("banking.bankAccount")),a(te,D(An,{label:"",get value(){return e()?.id||""},onChange:P=>{const b=Wn.getBankAccountById(P);r(b||null)},get options(){return S()}}),null),E.style.setProperty("display","block"),E.style.setProperty("margin-bottom","0.5rem"),E.style.setProperty("font-weight","500"),a(E,()=>t("entryBooks.startDate")),$.addEventListener("change",P=>i(b=>({...b,start:P.target.value}))),$.style.setProperty("padding","0.75rem"),$.style.setProperty("border","1px solid var(--border-color)"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("font-family","inherit"),B.style.setProperty("display","block"),B.style.setProperty("margin-bottom","0.5rem"),B.style.setProperty("font-weight","500"),a(B,()=>t("entryBooks.endDate")),_.addEventListener("change",P=>i(b=>({...b,end:P.target.value}))),_.style.setProperty("padding","0.75rem"),_.style.setProperty("border","1px solid var(--border-color)"),_.style.setProperty("border-radius","var(--border-radius-sm)"),_.style.setProperty("font-family","inherit"),we(()=>$.value=n().start),we(()=>_.value=n().end),oe})(),(()=>{var oe=DN(),te=oe.firstChild,Z=te.nextSibling;return y(oe,m),te.$$click=()=>c("overview"),a(te,()=>t("common.overview")),Z.$$click=()=>c("reconciliation"),a(Z,()=>t("banking.reconciliation")),we(re=>{var E=g(l()==="overview"),$=g(l()==="reconciliation");return re.e=y(te,E,re.e),re.t=y(Z,$,re.t),re},{e:void 0,t:void 0}),oe})(),$e(()=>$e(()=>l()==="overview")()&&(()=>{var oe=tu();return a(oe,(()=>{var te=$e(()=>!!e());return()=>te()&&(()=>{var Z=tu();return y(Z,f),a(Z,D(Dt,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var re=FN(),E=re.firstChild,$=E.nextSibling,T=$.firstChild,B=$.nextSibling;return re.style.setProperty("margin-bottom","1rem"),E.style.setProperty("font-weight","600"),E.style.setProperty("margin-bottom","0.5rem"),a(E,()=>e().bankName),$.style.setProperty("color","var(--text-muted)"),$.style.setProperty("margin-bottom","0.5rem"),a($,()=>e().accountNumber,T),a($,()=>e().accountType,null),B.style.setProperty("font-size","1.25rem"),B.style.setProperty("font-weight","600"),B.style.setProperty("color","var(--primary-color)"),a(B,()=>w(e().currentBalance)),re})(),$e(()=>$e(()=>!!e().lastReconciledDate)()&&(()=>{var re=ON(),E=re.firstChild;return re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>t("banking.lastReconciled"),E),a(re,()=>x(e().lastReconciledDate),null),re})())]}}),null),a(Z,j&&[D(Dt,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var re=tu();return re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("color","var(--primary-color)"),re.style.setProperty("margin-bottom","0.5rem"),a(re,()=>j.totalBankTransactions),re})(),(()=>{var re=BN(),E=re.firstChild,$=E.nextSibling,T=$.nextSibling,B=T.nextSibling;return B.nextSibling,re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>j.reconciledTransactions,E),a(re,()=>t("banking.reconciled"),$),a(re,()=>j.unreconciledTransactions,B),a(re,()=>t("banking.pending"),null),re})()]}}),D(Dt,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var re=tu();return re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("color","var(--primary-color)"),re.style.setProperty("margin-bottom","0.5rem"),a(re,()=>j.totalEntryBookRecords),re})(),(()=>{var re=tu();return re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>t("banking.bookEntriesForComparison")),re})()]}}),D(Dt,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var re=jN(),E=re.firstChild;return re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("margin-bottom","0.5rem"),a(re,()=>Math.round(j.reconciliationRate),E),we($=>($=j.reconciliationRate>80?"#4caf50":j.reconciliationRate>50?"#ff9800":"#f44336")!=null?re.style.setProperty("color",$):re.style.removeProperty("color")),re})(),(()=>{var re=VN(),E=re.firstChild,$=E.nextSibling;return $.nextSibling,re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>j.reconciledTransactions,E),a(re,()=>j.totalBankTransactions,$),re})()]}})],null),Z})()})(),null),a(oe,D(Dt,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var te=MN(),Z=te.firstChild;return te.style.setProperty("text-align","center"),te.style.setProperty("color","var(--text-muted)"),te.style.setProperty("padding","2rem"),a(te,()=>t("banking.noRecentSessions"),Z),a(te,D(ht,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>c("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),te}}),null),oe})()),$e(()=>$e(()=>!!(l()==="reconciliation"&&e()))()&&D(NN,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),D(CN,{get isOpen(){return o()},onClose:()=>s(!1),get bankAccount(){return e()}})]}})};pr(["click"]);pr(["input","click"]);var zN=he("<h2>Upload Bank Statement CSV"),UN=he("<input type=file accept=.csv>"),HN=he("<h3>Filters"),GN=he('<div><input type=text placeholder="Search transactions..."><input type=date placeholder="Start Date"><input type=date placeholder="End Date"><button>Download Detailed Report'),WN=he("<div><button>Summary</button><button>Deposits</button><button>Payments</button><button>Timeline"),YN=he("<h3>Total Deposits"),zd=he("<p>"),N0=he("<p> transactions"),KN=he("<h3>Total Payments"),JN=he("<h3>Net Cash Flow"),QN=he("<h3>Check Payments"),XN=he("<p> checks"),ru=he("<div>"),ZN=he("<h3>Accounts & Payment Methods Used"),e6=he("<h3>Monthly Cash Flow Trend"),t6=he("<div><table><thead><tr><th>Month</th><th>Deposits</th><th>Payments</th><th>Net</th></tr></thead><tbody>"),r6=he("<h2>Deposits by Type"),n6=he("<h2>Top Depositors"),i6=he("<div><table><thead><tr><th>Depositor</th><th>Total Amount</th><th>Count</th><th>Actions</th></tr></thead><tbody>"),o6=he("<h2>Payments by Category"),s6=he("<h2>Top Payees"),a6=he("<div><table><thead><tr><th>Payee</th><th>Category</th><th>Total Amount</th><th>Count</th></tr></thead><tbody>"),l6=he("<h2>Transaction Timeline"),c6=he("<div><h1>Detailed Bank Statement Analyzer"),u6=he("<span>"),d6=he("<tr><td></td><td></td><td></td><td>"),L0=he("<div><h4></h4><p></p><p> transactions"),h6=he("<tr><td></td><td></td><td></td><td><details><summary>View</summary><div>"),p6=he("<div> - "),f6=he("<tr><td></td><td><span></span></td><td></td><td>"),m6=he("<div><div><div></div><div>  </div></div><div><div>");const y6=()=>{const[t,e]=Ce(""),[r,n]=Ce("summary"),[i,o]=Ce(""),[s,l]=Ce({start:"",end:""}),[c,u]=Hu({list:[]}),h={Utilities:["AT&T","METRO BY T-MOBILE","COMCAST","STREAM ENERGY","NETFLIX","SPECTRUM"],checks:["CHECK"],JPM:["JPM","POVBR"],Transportation:["DRIVE AWAY","TRANPORT","QUICKQUACK","EXXON","SHELL","CHEVRON","UBER","LYFT","U-HAUL","UHAL","LOVE'S"],Lodging:["HOLIDAY INN","MARRIOTT","HILTON","AIRBNB","HOTEL","MOTEL"],"Food & Dining":["GOLDEN CORRAL","MOCTEZUMA","CHINA STAR","RESTAURANT","CAFE","STARBUCKS","BUFFET","GRILL","MARKET","SEAFOOD"],Shopping:["BURLINGTON","WALMART","TARGET","AMAZON","ROSS","KROGER","PUBLIC","AMZN","AMZ"],Financial:["AMERICANFIRSTFIN","LOAN","CREDIT"],Insurance:["INSURANCE","GEICO","STATE FARM"],Rent:["SHAFAII INVESTME"],Medical:["PHARMACY","CVS","WALGREENS","HOSPITAL","CLINIC"],Entertainment:["CINEMA","THEATER","CONCERT"],"Other Services":["BARBER","SALON","SPA","GYM"],Return:["RETURN ITEM "]},m=te=>{const Z=te.toUpperCase();for(const[re,E]of Object.entries(h))for(const $ of E)if(Z.includes($.toUpperCase()))return re;return"Other"},g=te=>{const Z=te.match(/Zelle payment from ([^0-9]+)/i);if(Z)return Z[1].trim().replace(/[A-Z0-9]{10,}$/,"").trim();if(te.includes("CHECK"))return"Check Payment";const re=te.match(/^([^0-9]+)/);return re?re[1].trim():te.substring(0,30)},f=te=>{const Z=te.trim().split(`
`),re=[];console.log(Z);for(let E=1;E<Z.length;E++){const $=Z[E].split(",");if(console.log($),$.length>=3){const T=parseFloat($[2]);let B={postingDate:$[0],description:$[1],amount:T};re.push(B)}}return console.log({transactions:re}),u("list",re),re};Lt(()=>t()?f(t()):[]);const w=Lt(()=>{let te=c?.list;if((s().start||s().end)&&(te=te.filter(Z=>{const re=new Date(Z.postingDate),E=s().start?new Date(s().start):new Date("2024-01-01"),$=s().end?new Date(s().end):new Date("2024-12-31");return re>=E&&re<=$})),i()){const Z=i().toLowerCase();te=te.filter(re=>re.description.toLowerCase().includes(Z)||Math.abs(re.amount).toString().includes(Z))}return te}),x=Lt(()=>{const te={deposits:{total:0,count:0,byType:new Map,byPayee:new Map},payments:{total:0,count:0,byType:new Map,byPayee:new Map},checks:{total:0,count:0,transactions:[]},transfers:{total:0,count:0,transactions:[]},dailyBalances:new Map,accountsAffected:new Set};return w().forEach(Z=>{const re=g(Z.description);if(console.log({transaction:Z}),te.dailyBalances.set(Z.postingDate,Z.amount),(Z.description.includes("ZELLE")||Z.description.includes("QUICKPAY"))&&te.accountsAffected.add("Zelle Account"),Z.description.includes("ACH")&&te.accountsAffected.add("ACH Network"),Z?.description.includes("DEBIT_CARD")&&te.accountsAffected.add("Debit Card"),Z?.description.includes("CHECK")&&te.accountsAffected.add("Checking Account"),Z?.description.includes("TRANSFER")&&te.accountsAffected.add("Savings Account"),Z.amount>0){te.deposits.total+=Z.amount,te.deposits.count++,te.deposits.byType.has(Z.description)||te.deposits.byType.set(Z.description,{total:0,count:0,transactions:[]});const E=te.deposits.byType.get(Z.description);E.total+=Z.amount,E.count++,E.transactions.push(Z),te.deposits.byPayee.has(re)||te.deposits.byPayee.set(re,{name:re,totalAmount:0,transactionCount:0,transactions:[]});const $=te.deposits.byPayee.get(re);$.totalAmount+=Z.amount,$.transactionCount++,$.transactions.push(Z)}if(Z.amount<0){te.payments.total+=Math.abs(Z.amount),te.payments.count++,te.payments.byType.has(Z.description)||te.payments.byType.set(Z.description,{total:0,count:0,transactions:[]});const E=te.payments.byType.get(Z.description);E.total+=Math.abs(Z.amount),E.count++,E.transactions.push(Z);const $=m(Z.description);te.payments.byPayee.has(re)||te.payments.byPayee.set(re,{name:re,totalAmount:0,transactionCount:0,transactions:[],category:$});const T=te.payments.byPayee.get(re);T.totalAmount+=Math.abs(Z.amount),T.transactionCount++,T.transactions.push(Z)}(Z.type==="CHECK_PAID"||Z.checkNumber)&&(te.checks.total+=Math.abs(Z.amount),te.checks.count++,te.checks.transactions.push(Z)),(Z.description.includes("TRANSFER")||Z.description==="ACCT_XFER")&&(te.transfers.total+=Math.abs(Z.amount),te.transfers.count++,te.transfers.transactions.push(Z))}),console.log(te),te}),S=Lt(()=>{const te=new Map;return w().forEach(Z=>{const re=Z.postingDate.substring(0,7);te.has(re)||te.set(re,{deposits:0,payments:0,net:0});const E=te.get(re);Z.amount>0?E.deposits+=Z.amount:E.payments+=Math.abs(Z.amount),E.net=E.deposits-E.payments}),Array.from(te.entries()).sort((Z,re)=>Z[0].localeCompare(re[0]))}),C=te=>{const re=te.target.files?.[0];if(re){const E=new FileReader;E.onload=$=>{console.log($.target?.result),f($.target?.result)},E.readAsText(re)}},j=()=>{const te=x();let Z=`# DETAILED BANK STATEMENT ANALYSIS
`;Z+=`Generated: ${new Date().toLocaleDateString()}

`,Z+=`## EXECUTIVE SUMMARY

`,Z+=`- **Total Deposits:** $${te.deposits.total.toFixed(2)} (${te.deposits.count} transactions)
`,Z+=`- **Total Payments:** $${te.payments.total.toFixed(2)} (${te.payments.count} transactions)
`,Z+=`- **Net Cash Flow:** $${(te.deposits.total-te.payments.total).toFixed(2)}
`,Z+=`- **Check Payments:** $${te.checks.total.toFixed(2)} (${te.checks.count} checks)
`,Z+=`- **Transfers:** $${te.transfers.total.toFixed(2)} (${te.transfers.count} transfers)

`,Z+=`## ACCOUNTS AFFECTED

`,te.accountsAffected.forEach(P=>{Z+=`- ${P}
`}),Z+=`
`,Z+=`## DEPOSITS DETAIL

`,Z+=`### By Type
`,te.deposits.byType.forEach((P,b)=>{Z+=`- **${b}**: $${P.total.toFixed(2)} (${P.count} transactions)
`}),Z+=`
### Top Depositors
`,Array.from(te.deposits.byPayee.entries()).sort((P,b)=>b[1].totalAmount-P[1].totalAmount).slice(0,20).forEach(([P,b])=>{Z+=`- **${P}**: $${b.totalAmount.toFixed(2)} (${b.transactionCount} transactions)
`}),Z+=`
## PAYMENTS DETAIL

`,Z+=`### By Type
`,te.payments.byType.forEach((P,b)=>{Z+=`- **${b}**: $${P.total.toFixed(2)} (${P.count} transactions)
`}),Z+=`
### By Category
`;const E=new Map;te.payments.byPayee.forEach(P=>{const b=P.category||"Other";E.set(b,(E.get(b)||0)+P.totalAmount)}),Array.from(E.entries()).sort((P,b)=>b[1]-P[1]).forEach(([P,b])=>{Z+=`- **${P}**: $${b.toFixed(2)}
`}),Z+=`
### Top Payees
`,Array.from(te.payments.byPayee.entries()).sort((P,b)=>b[1].totalAmount-P[1].totalAmount).slice(0,20).forEach(([P,b])=>{Z+=`- **${P}** (${b.category}): $${b.totalAmount.toFixed(2)} (${b.transactionCount} transactions)
`}),Z+=`
## MONTHLY CASH FLOW TREND

`,S().forEach(([P,b])=>{Z+=`- **${P}**: Deposits: $${b.deposits.toFixed(2)} | Payments: $${b.payments.toFixed(2)} | Net: $${b.net.toFixed(2)}
`}),te.checks.transactions.length>0&&(Z+=`
## CHECK PAYMENTS DETAIL

`,te.checks.transactions.forEach(P=>{Z+=`- Check #${P.checkNumber||"N/A"} - ${P.postingDate} - $${Math.abs(P.amount).toFixed(2)}
`}));const T=new Blob([Z],{type:"text/markdown"}),B=URL.createObjectURL(T),_=document.createElement("a");_.href=B,_.download=`detailed_bank_analysis_${new Date().toISOString().split("T")[0]}.md`,_.click(),URL.revokeObjectURL(B)},oe=te=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(te);return(()=>{var te=c6(),Z=te.firstChild;return te.style.setProperty("padding","2rem"),Z.style.setProperty("margin-bottom","2rem"),a(te,D(Dt,{style:{"margin-bottom":"2rem"},get children(){return[zN(),(()=>{var re=UN();return re.addEventListener("change",C),re.style.setProperty("margin-top","1rem"),re})()]}}),null),a(te,D(Ge,{get when(){return c?.list},get children(){return[D(Dt,{style:{"margin-bottom":"2rem"},get children(){return[HN(),(()=>{var re=GN(),E=re.firstChild,$=E.nextSibling,T=$.nextSibling,B=T.nextSibling;return re.style.setProperty("display","flex"),re.style.setProperty("gap","1rem"),re.style.setProperty("margin-top","1rem"),re.style.setProperty("flex-wrap","wrap"),E.$$input=_=>o(_.currentTarget.value),E.style.setProperty("flex","1"),E.style.setProperty("min-width","200px"),E.style.setProperty("padding","0.5rem"),$.$$input=_=>l({...s(),start:_.currentTarget.value}),T.$$input=_=>l({...s(),end:_.currentTarget.value}),B.$$click=j,B.style.setProperty("padding","0.5rem 1rem"),B.style.setProperty("background","var(--primary-color)"),B.style.setProperty("color","white"),B.style.setProperty("border","none"),B.style.setProperty("border-radius","var(--border-radius-sm)"),B.style.setProperty("cursor","pointer"),we(()=>E.value=i()),we(()=>$.value=s().start),we(()=>T.value=s().end),re})()]}}),(()=>{var re=WN(),E=re.firstChild,$=E.nextSibling,T=$.nextSibling,B=T.nextSibling;return re.style.setProperty("display","flex"),re.style.setProperty("gap","1rem"),re.style.setProperty("margin-bottom","2rem"),E.$$click=()=>n("summary"),E.style.setProperty("padding","0.5rem 1rem"),E.style.setProperty("border","none"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("cursor","pointer"),$.$$click=()=>n("deposits"),$.style.setProperty("padding","0.5rem 1rem"),$.style.setProperty("border","none"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("cursor","pointer"),T.$$click=()=>n("payments"),T.style.setProperty("padding","0.5rem 1rem"),T.style.setProperty("border","none"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("cursor","pointer"),B.$$click=()=>n("timeline"),B.style.setProperty("padding","0.5rem 1rem"),B.style.setProperty("border","none"),B.style.setProperty("border-radius","var(--border-radius-sm)"),B.style.setProperty("cursor","pointer"),we(_=>{var P=r()==="summary"?"var(--primary-color)":"#e9ecef",b=r()==="summary"?"white":"black",H=r()==="deposits"?"var(--primary-color)":"#e9ecef",K=r()==="deposits"?"white":"black",R=r()==="payments"?"var(--primary-color)":"#e9ecef",k=r()==="payments"?"white":"black",W=r()==="timeline"?"var(--primary-color)":"#e9ecef",z=r()==="timeline"?"white":"black";return P!==_.e&&((_.e=P)!=null?E.style.setProperty("background",P):E.style.removeProperty("background")),b!==_.t&&((_.t=b)!=null?E.style.setProperty("color",b):E.style.removeProperty("color")),H!==_.a&&((_.a=H)!=null?$.style.setProperty("background",H):$.style.removeProperty("background")),K!==_.o&&((_.o=K)!=null?$.style.setProperty("color",K):$.style.removeProperty("color")),R!==_.i&&((_.i=R)!=null?T.style.setProperty("background",R):T.style.removeProperty("background")),k!==_.n&&((_.n=k)!=null?T.style.setProperty("color",k):T.style.removeProperty("color")),W!==_.s&&((_.s=W)!=null?B.style.setProperty("background",W):B.style.removeProperty("background")),z!==_.h&&((_.h=z)!=null?B.style.setProperty("color",z):B.style.removeProperty("color")),_},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),re})(),D(Ge,{get when(){return r()==="summary"},get children(){return[(()=>{var re=ru();return re.style.setProperty("display","grid"),re.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),re.style.setProperty("gap","1rem"),re.style.setProperty("margin-bottom","2rem"),a(re,D(Dt,{get children(){return[YN(),(()=>{var E=zd();return E.style.setProperty("font-size","2rem"),E.style.setProperty("font-weight","bold"),E.style.setProperty("color","#22c55e"),a(E,()=>oe(x().deposits.total)),E})(),(()=>{var E=N0(),$=E.firstChild;return E.style.setProperty("color","#6c757d"),a(E,()=>x().deposits.count,$),E})()]}}),null),a(re,D(Dt,{get children(){return[KN(),(()=>{var E=zd();return E.style.setProperty("font-size","2rem"),E.style.setProperty("font-weight","bold"),E.style.setProperty("color","#ef4444"),a(E,()=>oe(x().payments.total)),E})(),(()=>{var E=N0(),$=E.firstChild;return E.style.setProperty("color","#6c757d"),a(E,()=>x().payments.count,$),E})()]}}),null),a(re,D(Dt,{get children(){return[JN(),(()=>{var E=zd();return E.style.setProperty("font-size","2rem"),E.style.setProperty("font-weight","bold"),a(E,()=>oe(x().deposits.total-x().payments.total)),we($=>($=x().deposits.total-x().payments.total>=0?"#22c55e":"#ef4444")!=null?E.style.setProperty("color",$):E.style.removeProperty("color")),E})()]}}),null),a(re,D(Dt,{get children(){return[QN(),(()=>{var E=zd();return E.style.setProperty("font-size","2rem"),E.style.setProperty("font-weight","bold"),E.style.setProperty("color","#3b82f6"),a(E,()=>oe(x().checks.total)),E})(),(()=>{var E=XN(),$=E.firstChild;return E.style.setProperty("color","#6c757d"),a(E,()=>x().checks.count,$),E})()]}}),null),re})(),D(Dt,{style:{"margin-bottom":"2rem"},get children(){return[ZN(),(()=>{var re=ru();return re.style.setProperty("display","flex"),re.style.setProperty("flex-wrap","wrap"),re.style.setProperty("gap","0.5rem"),re.style.setProperty("margin-top","1rem"),a(re,D(zt,{get each(){return Array.from(x().accountsAffected)},children:E=>(()=>{var $=u6();return $.style.setProperty("padding","0.25rem 0.75rem"),$.style.setProperty("background","#e9ecef"),$.style.setProperty("border-radius","9999px"),$.style.setProperty("font-size","0.875rem"),a($,E),$})()})),re})()]}}),D(Dt,{get children(){return[e6(),(()=>{var re=t6(),E=re.firstChild,$=E.firstChild,T=$.firstChild,B=T.firstChild,_=B.nextSibling,P=_.nextSibling,b=P.nextSibling,H=$.nextSibling;return re.style.setProperty("overflow-x","auto"),E.style.setProperty("width","100%"),E.style.setProperty("border-collapse","collapse"),E.style.setProperty("margin-top","1rem"),T.style.setProperty("border-bottom","2px solid #dee2e6"),B.style.setProperty("padding","0.75rem"),B.style.setProperty("text-align","left"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","right"),P.style.setProperty("padding","0.75rem"),P.style.setProperty("text-align","right"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","right"),a(H,D(zt,{get each(){return S()},children:([K,R])=>(()=>{var k=d6(),W=k.firstChild,z=W.nextSibling,U=z.nextSibling,le=U.nextSibling;return k.style.setProperty("border-bottom","1px solid #dee2e6"),W.style.setProperty("padding","0.75rem"),a(W,K),z.style.setProperty("padding","0.75rem"),z.style.setProperty("text-align","right"),z.style.setProperty("color","#22c55e"),a(z,()=>oe(isNaN(R.deposits)?0:R.deposits)),U.style.setProperty("padding","0.75rem"),U.style.setProperty("text-align","right"),U.style.setProperty("color","#ef4444"),a(U,()=>oe(isNaN(R.payments)?0:R.payments)),le.style.setProperty("padding","0.75rem"),le.style.setProperty("text-align","right"),le.style.setProperty("font-weight","bold"),a(le,()=>oe(R.net)),we(L=>(L=R.net>=0?"#22c55e":"#ef4444")!=null?le.style.setProperty("color",L):le.style.removeProperty("color")),k})()})),re})()]}})]}}),D(Ge,{get when(){return r()==="deposits"},get children(){return[D(Dt,{style:{"margin-bottom":"2rem"},get children(){return[r6(),(()=>{var re=ru();return re.style.setProperty("display","grid"),re.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),re.style.setProperty("gap","1rem"),re.style.setProperty("margin-top","1rem"),a(re,D(zt,{get each(){return Array.from(x().deposits.byType.entries())},children:([E,$])=>(()=>{var T=L0(),B=T.firstChild,_=B.nextSibling,P=_.nextSibling,b=P.firstChild;return T.style.setProperty("padding","1rem"),T.style.setProperty("background","#f8f9fa"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("border","1px solid #e9ecef"),a(B,E),_.style.setProperty("font-size","1.5rem"),_.style.setProperty("font-weight","bold"),_.style.setProperty("color","#22c55e"),a(_,()=>oe($.total)),P.style.setProperty("color","#6c757d"),a(P,()=>$.count,b),T})()})),re})()]}}),D(Dt,{get children(){return[n6(),(()=>{var re=i6(),E=re.firstChild,$=E.firstChild,T=$.firstChild,B=T.firstChild,_=B.nextSibling,P=_.nextSibling,b=P.nextSibling,H=$.nextSibling;return re.style.setProperty("overflow-x","auto"),E.style.setProperty("width","100%"),E.style.setProperty("border-collapse","collapse"),E.style.setProperty("margin-top","1rem"),T.style.setProperty("border-bottom","2px solid #dee2e6"),B.style.setProperty("padding","0.75rem"),B.style.setProperty("text-align","left"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","right"),P.style.setProperty("padding","0.75rem"),P.style.setProperty("text-align","center"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","center"),a(H,D(zt,{get each(){return Array.from(x().deposits.byPayee.entries()).sort((K,R)=>R[1].totalAmount-K[1].totalAmount).slice(0,20)},children:([K,R])=>(()=>{var k=h6(),W=k.firstChild,z=W.nextSibling,U=z.nextSibling,le=U.nextSibling,L=le.firstChild,M=L.firstChild,G=M.nextSibling;return k.style.setProperty("border-bottom","1px solid #dee2e6"),W.style.setProperty("padding","0.75rem"),a(W,K),z.style.setProperty("padding","0.75rem"),z.style.setProperty("text-align","right"),z.style.setProperty("color","#22c55e"),z.style.setProperty("font-weight","bold"),a(z,()=>oe(R.totalAmount)),U.style.setProperty("padding","0.75rem"),U.style.setProperty("text-align","center"),a(U,()=>R.transactionCount),le.style.setProperty("padding","0.75rem"),le.style.setProperty("text-align","center"),M.style.setProperty("cursor","pointer"),G.style.setProperty("margin-top","0.5rem"),G.style.setProperty("font-size","0.875rem"),a(G,D(zt,{get each(){return R.transactions.slice(0,5)},children:I=>(()=>{var F=p6(),X=F.firstChild;return F.style.setProperty("padding","0.25rem"),a(F,()=>I.postingDate,X),a(F,()=>oe(I.amount),null),F})()})),k})()})),re})()]}})]}}),D(Ge,{get when(){return r()==="payments"},get children(){return[D(Dt,{style:{"margin-bottom":"2rem"},get children(){return[o6(),(()=>{var re=ru();return re.style.setProperty("display","grid"),re.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),re.style.setProperty("gap","1rem"),re.style.setProperty("margin-top","1rem"),a(re,()=>{const E=new Map;return x().payments.byPayee.forEach($=>{const T=$.category||"Other";E.has(T)||E.set(T,{total:0,count:0});const B=E.get(T);B.total+=$.totalAmount,B.count+=$.transactionCount}),Array.from(E.entries()).sort(($,T)=>T[1].total-$[1].total).map(([$,T])=>(()=>{var B=L0(),_=B.firstChild,P=_.nextSibling,b=P.nextSibling,H=b.firstChild;return B.style.setProperty("padding","1rem"),B.style.setProperty("background","#f8f9fa"),B.style.setProperty("border-radius","var(--border-radius-sm)"),B.style.setProperty("border","1px solid #e9ecef"),a(_,$),P.style.setProperty("font-size","1.5rem"),P.style.setProperty("font-weight","bold"),P.style.setProperty("color","#ef4444"),a(P,()=>oe(T.total)),b.style.setProperty("color","#6c757d"),a(b,()=>T.count,H),B})())}),re})()]}}),D(Dt,{get children(){return[s6(),(()=>{var re=a6(),E=re.firstChild,$=E.firstChild,T=$.firstChild,B=T.firstChild,_=B.nextSibling,P=_.nextSibling,b=P.nextSibling,H=$.nextSibling;return re.style.setProperty("overflow-x","auto"),E.style.setProperty("width","100%"),E.style.setProperty("border-collapse","collapse"),E.style.setProperty("margin-top","1rem"),T.style.setProperty("border-bottom","2px solid #dee2e6"),B.style.setProperty("padding","0.75rem"),B.style.setProperty("text-align","left"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","left"),P.style.setProperty("padding","0.75rem"),P.style.setProperty("text-align","right"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","center"),a(H,D(zt,{get each(){return Array.from(x().payments.byPayee.entries()).sort((K,R)=>R[1].totalAmount-K[1].totalAmount).slice(0,130)},children:([K,R])=>(()=>{var k=f6(),W=k.firstChild,z=W.nextSibling,U=z.firstChild,le=z.nextSibling,L=le.nextSibling;return k.style.setProperty("border-bottom","1px solid #dee2e6"),W.style.setProperty("padding","0.75rem"),a(W,K),z.style.setProperty("padding","0.75rem"),U.style.setProperty("padding","0.25rem 0.5rem"),U.style.setProperty("background","#e9ecef"),U.style.setProperty("border-radius","4px"),U.style.setProperty("font-size","0.875rem"),a(U,()=>R.category),le.style.setProperty("padding","0.75rem"),le.style.setProperty("text-align","right"),le.style.setProperty("color","#ef4444"),le.style.setProperty("font-weight","bold"),a(le,()=>oe(R.totalAmount)),L.style.setProperty("padding","0.75rem"),L.style.setProperty("text-align","center"),a(L,()=>R.transactionCount),k})()})),re})()]}})]}}),D(Ge,{get when(){return r()==="timeline"},get children(){return D(Dt,{get children(){return[l6(),(()=>{var re=ru();return re.style.setProperty("max-height","600px"),re.style.setProperty("overflow-y","auto"),re.style.setProperty("margin-top","1rem"),a(re,D(zt,{get each(){return w().slice(0,100)},children:E=>(()=>{var $=m6(),T=$.firstChild,B=T.firstChild,_=B.nextSibling,P=_.firstChild,b=T.nextSibling,H=b.firstChild;return $.style.setProperty("padding","1rem"),$.style.setProperty("border-bottom","1px solid #e9ecef"),$.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),T.style.setProperty("flex","1"),B.style.setProperty("font-weight","bold"),a(B,()=>E.description),_.style.setProperty("font-size","0.875rem"),_.style.setProperty("color","#6c757d"),a(_,()=>E.postingDate,P),a(_,()=>E.type,null),a(_,()=>E.checkNumber&&`  Check #${E.checkNumber}`,null),b.style.setProperty("text-align","right"),H.style.setProperty("font-weight","bold"),H.style.setProperty("font-size","1.1rem"),a(H,()=>oe(Math.abs(E.amount)),null),a(H,()=>E.amount>=0?" ":" ",null),we(K=>(K=E.amount>=0?"#22c55e":"#ef4444")!=null?H.style.setProperty("color",K):H.style.removeProperty("color")),$})()})),re})()]}})}})]}}),null),te})()};pr(["input","click"]);var g6=he("<div><div></div><div>"),df=he("<div>"),v6=he("<div>  <!>  <!> "),b6=he("<div><div><div></div><div></div></div><div><div></div><div>"),_6=he("<div><div>:"),S6=he("<div> <!>: <!> <!>, <!> "),P6=he("<div><div><div></div><div></div></div><div>"),R0=he("<div> "),w6=he("<div> ");const x6=t=>{const{t:e}=Zt(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},o={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},s={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},l={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},u={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},h={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},m={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},g=C=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[C],f=C=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(C),w=C=>new Date(C).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),x=g(t.entry.status),S=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return D(Dt,{get children(){return[(()=>{var C=g6(),j=C.firstChild,oe=j.nextSibling;return y(C,r),y(j,n),a(j,()=>t.entry.entryNumber),a(oe,()=>e(`journal.${t.entry.status}`,t.entry.status)),we(te=>y(oe,{...i,background:x.bg,color:x.color},te)),C})(),(()=>{var C=df();return y(C,o),a(C,()=>t.entry.description),C})(),(()=>{var C=v6(),j=C.firstChild,oe=j.nextSibling,te=oe.nextSibling,Z=te.nextSibling;return Z.nextSibling,y(C,s),a(C,()=>w(t.entry.date),j),a(C,()=>t.entry.reference||e("journal.noReference","No reference"),oe),a(C,()=>e("journal.createdBy","By"),Z),a(C,()=>t.entry.createdBy,null),C})(),(()=>{var C=b6(),j=C.firstChild,oe=j.firstChild,te=oe.nextSibling,Z=j.nextSibling,re=Z.firstChild,E=re.nextSibling;return y(C,l),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),a(oe,()=>e("journal.totalAmount","Total Amount")),y(te,c),a(te,()=>f(t.entry.totalDebit)),Z.style.setProperty("text-align","right"),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>e("journal.lines","Lines")),E.style.setProperty("font-weight","600"),a(E,()=>t.entry.lines.length),C})(),$e(()=>!S&&(()=>{var C=S6(),j=C.firstChild,oe=j.nextSibling,te=oe.nextSibling,Z=te.nextSibling,re=Z.nextSibling,E=re.nextSibling,$=E.nextSibling,T=$.nextSibling;return T.nextSibling,C.style.setProperty("padding","0.5rem"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("background","#f8d7da"),C.style.setProperty("color","#721c24"),C.style.setProperty("font-size","0.875rem"),C.style.setProperty("margin-bottom","1rem"),a(C,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),oe),a(C,()=>e("journal.debit"),Z),a(C,()=>f(t.entry.totalDebit),E),a(C,()=>e("journal.credit"),T),a(C,()=>f(t.entry.totalCredit),null),C})()),(()=>{var C=_6(),j=C.firstChild,oe=j.firstChild;return y(C,u),j.style.setProperty("font-weight","500"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-size","0.875rem"),a(j,()=>e("journal.accountLines","Account Lines"),oe),a(C,()=>t.entry.lines.slice(0,3).map(te=>(()=>{var Z=P6(),re=Z.firstChild,E=re.firstChild,$=E.nextSibling,T=re.nextSibling;return y(Z,h),re.style.setProperty("flex","1"),E.style.setProperty("font-weight","500"),a(E,()=>te.accountName),$.style.setProperty("font-size","0.75rem"),$.style.setProperty("color","var(--text-muted)"),a($,()=>te.description||e("journal.noDescription","No description")),T.style.setProperty("text-align","right"),a(T,(()=>{var B=$e(()=>te.debitAmount>0);return()=>B()&&(()=>{var _=R0(),P=_.firstChild;return _.style.setProperty("color","#4caf50"),_.style.setProperty("font-weight","500"),a(_,()=>e("journal.debitShort","Dr."),P),a(_,()=>f(te.debitAmount),null),_})()})(),null),a(T,(()=>{var B=$e(()=>te.creditAmount>0);return()=>B()&&(()=>{var _=R0(),P=_.firstChild;return _.style.setProperty("color","#f44336"),_.style.setProperty("font-weight","500"),a(_,()=>e("journal.creditShort","Cr."),P),a(_,()=>f(te.creditAmount),null),_})()})(),null),a(T,(()=>{var B=$e(()=>!!te.reconciled);return()=>B()&&(()=>{var _=w6();return _.firstChild,_.style.setProperty("font-size","0.75rem"),_.style.setProperty("color","#4caf50"),a(_,()=>e("banking.reconciled","Reconciled"),null),_})()})(),null),Z})()),null),a(C,(()=>{var te=$e(()=>t.entry.lines.length>3);return()=>te()&&(()=>{var Z=df();return Z.style.setProperty("text-align","center"),Z.style.setProperty("color","var(--text-muted)"),Z.style.setProperty("font-size","0.875rem"),a(Z,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),Z})()})(),null),C})(),(()=>{var C=df();return y(C,m),a(C,D(ht,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),C})()]}})},A6=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[oo,hf]=Ce(A6),D0=()=>oo().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=oo().find(n=>n.lines.some(i=>i.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),Do={get journalEntries(){return oo()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return hf([...oo(),e]),e},updateJournalEntry(t,e){hf(oo().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=oo().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");hf(oo().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=oo().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),D0()},getJournalEntryById(t){return oo().find(e=>e.id===t)},getJournalEntriesByStatus(t){return oo().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return oo().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return oo().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=oo().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,i)=>{const o=parseInt(i.entryNumber.split("-").pop()||"0");return o>n?o:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((i,o)=>i+(o.debitAmount||0),0),n=t.lines.reduce((i,o)=>i+(o.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((i,o)=>{i.accountId||e.push(`Line ${o+1}: Account is required`),i.debitAmount===0&&i.creditAmount===0&&e.push(`Line ${o+1}: Either debit or credit amount must be provided`),i.debitAmount>0&&i.creditAmount>0&&e.push(`Line ${o+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return D0()}};var C6=he("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),pf=he("<div>");const L5=t=>{const{t:e}=Zt(),[r,n]=Ce({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),[i,o]=Ce([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[s,l]=Ce(null);Ei(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),o(t.editEntry.lines.map((te,Z)=>({...te,tempId:`line_${Date.now()}_${Z}`})));else{const te=Do.getNextEntryNumber();n({entryNumber:te,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}l(null)}});const c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},u={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},h={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},m=()=>$r.accounts.map(te=>({value:te.id,label:`${te.accountNumber} - ${te.name}`})),g=(te,Z)=>{n(re=>({...re,[te]:Z}))},f=(te,Z,re)=>{o(E=>E.map($=>{if($.tempId===te){const T={...$,[Z]:re};if(Z==="accountId"&&typeof re=="string"){const B=$r.getAccountById(re);B&&(T.accountName=B.name)}return T}return $}))},w=()=>{o(te=>[...te,{tempId:`line_${Date.now()}_${te.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},x=te=>{i().length>2&&o(Z=>Z.filter(re=>re.tempId!==te))},S=()=>{const te=i().reduce((re,E)=>re+(E.debitAmount||0),0),Z=i().reduce((re,E)=>re+(E.creditAmount||0),0);return{totalDebit:te,totalCredit:Z,isBalanced:Math.abs(te-Z)<.01}},C=te=>{te.preventDefault(),l(null);const Z=r(),re=i(),{totalDebit:E,totalCredit:$,isBalanced:T}=S();if(!Z.description){l(e("forms.descriptionRequired","Description is required"));return}if(re.length<2){l(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!T){l(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${E.toFixed(2)}`).replace("${credit}",`$${$.toFixed(2)}`));return}for(let _=0;_<re.length;_++){const P=re[_];if(!P.accountId){l(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(_+1).toString()));return}if(P.debitAmount===0&&P.creditAmount===0){l(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(_+1).toString()));return}if((P.debitAmount||0)>0&&(P.creditAmount||0)>0){l(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(_+1).toString()));return}}const B={entryNumber:Z.entryNumber,date:Z.date,description:Z.description,reference:Z.reference,status:"draft",createdBy:Z.createdBy,createdAt:new Date().toISOString(),totalDebit:E,totalCredit:$,lines:re.map((_,P)=>{const{tempId:b,...H}=_;return{id:`jel_${Date.now()}_${P}`,...H}})};try{t.editEntry?Do.updateJournalEntry(t.editEntry.id,B):Do.addJournalEntry(B),n({entryNumber:Do.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(_){l(_ instanceof Error?_.message:e("forms.errorOccurred","An error occurred"))}},j=te=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(te),oe=S();return D(qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return $e(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var te=C6(),Z=te.firstChild,re=Z.nextSibling,E=re.firstChild,$=E.firstChild,T=E.nextSibling,B=T.firstChild,_=B.firstChild,P=_.firstChild,b=_.nextSibling,H=b.firstChild,K=b.nextSibling,R=K.firstChild,k=K.nextSibling,W=k.firstChild,z=k.nextSibling,U=z.firstChild,le=T.nextSibling,L=le.firstChild,M=L.firstChild,G=M.firstChild,I=L.nextSibling,F=I.firstChild,X=F.firstChild,Y=I.nextSibling,Q=re.nextSibling;return te.addEventListener("submit",C),Z.style.setProperty("display","grid"),Z.style.setProperty("grid-template-columns","1fr 1fr"),Z.style.setProperty("gap","1rem"),a(Z,D(Ar,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:J=>g("entryNumber",J),get disabled(){return!!t.editEntry},required:!0}),null),a(Z,D(Ar,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:J=>g("date",J),required:!0}),null),a(te,D(Ar,{get label(){return e("common.description")},get value(){return r().description},onChange:J=>g("description",J),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),re),a(te,D(Ar,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:J=>g("reference",J),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),re),re.style.setProperty("margin-top","2rem"),E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),E.style.setProperty("margin-bottom","1rem"),$.style.setProperty("margin","0"),a($,()=>e("journal.entryLines","Journal Entry Lines")),a(E,D(ht,{type:"button",variant:"secondary",size:"sm",onClick:w,get children(){return e("journal.addLine","Add Line")}}),null),T.style.setProperty("margin-bottom","1rem"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),B.style.setProperty("display","grid"),B.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),B.style.setProperty("gap","1rem"),a(P,()=>e("journal.account")),a(H,()=>e("common.description")),a(R,()=>e("journal.debit")),a(W,()=>e("journal.credit")),a(U,()=>e("common.actions")),a(re,D(_S,{get each(){return i()},get fallback(){return(()=>{var J=pf();return a(J,()=>e("journal.noLines","No lines")),J})()},children:(J,V)=>{const ne=J();return(()=>{var ee=pf();return y(ee,u),a(ee,D(An,{label:"",get value(){return ne.accountId||""},onChange:ce=>f(ne.tempId,"accountId",ce),get options(){return m()}}),null),a(ee,D(Ar,{label:"",get value(){return ne.description||""},onChange:ce=>f(ne.tempId,"description",ce),get placeholder(){return e("journal.lineDescription","Line description")}}),null),a(ee,D(Ar,{label:"",type:"number",get value(){return ne.debitAmount?.toString()||"0"},onChange:ce=>{f(ne.tempId,"debitAmount",parseFloat(ce)||0),parseFloat(ce)>0&&f(ne.tempId,"creditAmount",0)},placeholder:"0.00"}),null),a(ee,D(Ar,{label:"",type:"number",get value(){return ne.creditAmount?.toString()||"0"},onChange:ce=>{f(ne.tempId,"creditAmount",parseFloat(ce)||0),parseFloat(ce)>0&&f(ne.tempId,"debitAmount",0)},placeholder:"0.00"}),null),a(ee,D(ht,{type:"button",variant:"outline",size:"sm",onClick:()=>x(ne.tempId),get disabled(){return i().length<=2},get children(){return e("common.remove")}}),null),ee})()}}),le),y(le,h),a(M,()=>e("journal.totalDebit","Total Debit"),G),a(M,()=>j(oe.totalDebit),null),a(F,()=>e("journal.totalCredit","Total Credit"),X),a(F,()=>j(oe.totalCredit),null),Y.style.setProperty("font-weight","600"),a(Y,(()=>{var J=$e(()=>!!oe.isBalanced);return()=>J()?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`})()),a(te,(()=>{var J=$e(()=>!!s());return()=>J()&&(()=>{var V=pf();return V.style.setProperty("padding","1rem"),V.style.setProperty("border-radius","var(--border-radius-sm)"),V.style.setProperty("margin-top","1rem"),V.style.setProperty("background","#f8d7da"),V.style.setProperty("color","#721c24"),V.style.setProperty("border","1px solid #f5c6cb"),a(V,s),V})()})(),Q),y(Q,c),a(Q,D(ht,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(Q,D(ht,{variant:"primary",type:"submit",get disabled(){return!oe.isBalanced},get children(){return $e(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),we(J=>(J=oe.isBalanced?"#4caf50":"#f44336")!=null?Y.style.setProperty("color",J):Y.style.removeProperty("color")),te}})},I6={"Sale Amount":{en:"Sale Amount",es:"Monto de Venta"},"Payment Amount":{en:"Payment Amount",es:"Monto del Pago"},"Expense Amount":{en:"Expense Amount",es:"Monto del Gasto"},"Rent Amount":{en:"Rent Amount",es:"Monto del Alquiler"},"Salary Amount":{en:"Salary Amount",es:"Monto del Salario"},"Utility Amount":{en:"Utility Amount",es:"Monto de Servicios"},"Inventory Cost":{en:"Inventory Cost",es:"Costo del Inventario"},"Investment Amount":{en:"Investment Amount",es:"Monto de Inversin"},"Depreciation Amount":{en:"Depreciation Amount",es:"Monto de Depreciacin"},"Interest Amount":{en:"Interest Amount",es:"Monto de Inters"},"Principal Amount":{en:"Principal Amount",es:"Monto Principal"},"Total Payment":{en:"Total Payment",es:"Pago Total"},Amount:{en:"Amount",es:"Monto"},Monto:{en:"Amount",es:"Monto"}},$6={"Cash Sale":{en:"Cash Sale",es:"Venta en Efectivo"},"Credit Sale":{en:"Credit Sale",es:"Venta a Crdito"},"Customer Payment Received":{en:"Customer Payment Received",es:"Pago Recibido del Cliente"},"Office Expenses":{en:"Office Expenses",es:"Gastos de Oficina"},"Rent Payment":{en:"Rent Payment",es:"Pago de Alquiler"},"Salary Payment":{en:"Salary Payment",es:"Pago de Salario"},"Utility Payment":{en:"Utility Payment",es:"Pago de Servicios"},"Inventory Purchase":{en:"Inventory Purchase",es:"Compra de Inventario"},"Supplier Payment":{en:"Supplier Payment",es:"Pago a Proveedor"},"Capital Investment":{en:"Capital Investment",es:"Inversin de Capital"},"Depreciation Expense":{en:"Depreciation Expense",es:"Gasto de Depreciacin"},"Loan Payment":{en:"Loan Payment",es:"Pago de Prstamo"}},E6={"Record a cash sale transaction":{en:"Record a cash sale transaction",es:"Registrar una transaccin de venta en efectivo"},"Record a sale on credit (accounts receivable)":{en:"Record a sale on credit (accounts receivable)",es:"Registrar una venta a crdito (cuentas por cobrar)"},"Record payment received from customer":{en:"Record payment received from customer",es:"Registrar pago recibido del cliente"},"Record office supplies and expenses":{en:"Record office supplies and expenses",es:"Registrar suministros y gastos de oficina"},"Record monthly rent payment":{en:"Record monthly rent payment",es:"Registrar pago mensual de alquiler"},"Record employee salary payment":{en:"Record employee salary payment",es:"Registrar pago de salario de empleado"},"Record utility bills payment":{en:"Record utility bills payment",es:"Registrar pago de servicios pblicos"},"Record inventory purchase on credit":{en:"Record inventory purchase on credit",es:"Registrar compra de inventario a crdito"},"Record payment to supplier":{en:"Record payment to supplier",es:"Registrar pago a proveedor"},"Record owner capital investment":{en:"Record owner capital investment",es:"Registrar inversin de capital del propietario"},"Record monthly depreciation of assets":{en:"Record monthly depreciation of assets",es:"Registrar depreciacin mensual de activos"},"Record loan principal and interest payment":{en:"Record loan principal and interest payment",es:"Registrar pago de capital e intereses del prstamo"}},T6={"Cash received from sale":{en:"Cash received from sale",es:"Efectivo recibido de venta"},"Sales revenue":{en:"Sales revenue",es:"Ingresos por ventas"},"Credit sale to customer":{en:"Credit sale to customer",es:"Venta a crdito al cliente"},"Payment received from customer":{en:"Payment received from customer",es:"Pago recibido del cliente"},"Payment applied to receivable":{en:"Payment applied to receivable",es:"Pago aplicado a cuenta por cobrar"},"Office supplies and expenses":{en:"Office supplies and expenses",es:"Suministros y gastos de oficina"},"Payment for office expenses":{en:"Payment for office expenses",es:"Pago por gastos de oficina"},"Monthly rent payment":{en:"Monthly rent payment",es:"Pago mensual de alquiler"},"Rent payment":{en:"Rent payment",es:"Pago de alquiler"},"Employee salary":{en:"Employee salary",es:"Salario de empleado"},"Salary payment":{en:"Salary payment",es:"Pago de salario"},"Utility bills payment":{en:"Utility bills payment",es:"Pago de servicios pblicos"},"Utility payment":{en:"Utility payment",es:"Pago de servicios"},"Inventory purchase":{en:"Inventory purchase",es:"Compra de inventario"},"Amount owed to supplier":{en:"Amount owed to supplier",es:"Monto adeudado al proveedor"},"Payment to supplier":{en:"Payment to supplier",es:"Pago al proveedor"},"Capital investment received":{en:"Capital investment received",es:"Inversin de capital recibida"},"Capital investment":{en:"Capital investment",es:"Inversin de capital"},"Monthly depreciation expense":{en:"Monthly depreciation expense",es:"Gasto mensual de depreciacin"},"Accumulated depreciation":{en:"Accumulated depreciation",es:"Depreciacin acumulada"},"Interest expense":{en:"Interest expense",es:"Gasto por intereses"},"Principal payment":{en:"Principal payment",es:"Pago de capital"},"Total loan payment":{en:"Total loan payment",es:"Pago total del prstamo"}},k6=t=>I6[t]?.["es"]||t,N6=t=>$6[t]?.["es"]||t,L6=t=>E6[t]?.["es"]||t,R6=t=>T6[t]?.["es"]||t,D6=[{id:"cash_sale",name:"Cash Sale",description:"Record a cash sale transaction",category:"revenue",lines:[{id:"cs1",accountId:"1001",accountName:"Petty Cash",description:"Cash received from sale",type:"debit",isAmountField:!0,amountFieldName:"Sale Amount"},{id:"cs2",accountId:"10",accountName:"Sales Revenue",description:"Sales revenue",type:"credit",isAmountField:!0,amountFieldName:"Sale Amount"}]},{id:"credit_sale",name:"Credit Sale",description:"Record a sale on credit (accounts receivable)",category:"revenue",lines:[{id:"crs1",accountId:"2001",accountName:"Trade Receivables",description:"Credit sale to customer",type:"debit",isAmountField:!0,amountFieldName:"Sale Amount"},{id:"crs2",accountId:"10",accountName:"Sales Revenue",description:"Sales revenue",type:"credit",isAmountField:!0,amountFieldName:"Sale Amount"}]},{id:"customer_payment",name:"Customer Payment Received",description:"Record payment received from customer",category:"assets",lines:[{id:"cp1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment received from customer",type:"debit",isAmountField:!0,amountFieldName:"Payment Amount"},{id:"cp2",accountId:"2001",accountName:"Trade Receivables",description:"Payment applied to receivable",type:"credit",isAmountField:!0,amountFieldName:"Payment Amount"}]},{id:"office_expenses",name:"Office Expenses",description:"Record office supplies and expenses",category:"expenses",lines:[{id:"oe1",accountId:"5200",accountName:"Office Expenses",description:"Office supplies and expenses",type:"debit",isAmountField:!0,amountFieldName:"Expense Amount"},{id:"oe2",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment for office expenses",type:"credit",isAmountField:!0,amountFieldName:"Expense Amount"}]},{id:"rent_payment",name:"Rent Payment",description:"Record monthly rent payment",category:"expenses",lines:[{id:"rp1",accountId:"5200",accountName:"Rent Expense",description:"Monthly rent payment",type:"debit",isAmountField:!0,amountFieldName:"Rent Amount"},{id:"rp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",type:"credit",isAmountField:!0,amountFieldName:"Rent Amount"}]},{id:"salary_payment",name:"Salary Payment",description:"Record employee salary payment",category:"expenses",lines:[{id:"sp1",accountId:"13",accountName:"Salaries Expense",description:"Employee salary",type:"debit",isAmountField:!0,amountFieldName:"Salary Amount"},{id:"sp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",type:"credit",isAmountField:!0,amountFieldName:"Salary Amount"}]},{id:"utility_payment",name:"Utility Payment",description:"Record utility bills payment",category:"expenses",lines:[{id:"up1",accountId:"14",accountName:"Operating Expenses",description:"Utility bills payment",type:"debit",isAmountField:!0,amountFieldName:"Utility Amount"},{id:"up2",accountId:"1002",accountName:"Bank - Checking Account",description:"Utility payment",type:"credit",isAmountField:!0,amountFieldName:"Utility Amount"}]},{id:"inventory_purchase",name:"Inventory Purchase",description:"Record inventory purchase on credit",category:"assets",lines:[{id:"ip1",accountId:"3",accountName:"Inventory",description:"Inventory purchase",type:"debit",isAmountField:!0,amountFieldName:"Inventory Cost"},{id:"ip2",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",type:"credit",isAmountField:!0,amountFieldName:"Inventory Cost"}]},{id:"supplier_payment",name:"Supplier Payment",description:"Record payment to supplier",category:"liabilities",lines:[{id:"spp1",accountId:"5",accountName:"Accounts Payable",description:"Payment to supplier",type:"debit",isAmountField:!0,amountFieldName:"Payment Amount"},{id:"spp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to supplier",type:"credit",isAmountField:!0,amountFieldName:"Payment Amount"}]},{id:"capital_investment",name:"Capital Investment",description:"Record owner capital investment",category:"equity",lines:[{id:"ci1",accountId:"1002",accountName:"Bank - Checking Account",description:"Capital investment received",type:"debit",isAmountField:!0,amountFieldName:"Investment Amount"},{id:"ci2",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",type:"credit",isAmountField:!0,amountFieldName:"Investment Amount"}]},{id:"depreciation",name:"Depreciation Expense",description:"Record monthly depreciation of assets",category:"expenses",lines:[{id:"dep1",accountId:"14",accountName:"Operating Expenses",description:"Monthly depreciation expense",type:"debit",isAmountField:!0,amountFieldName:"Depreciation Amount"},{id:"dep2",accountId:"15",accountName:"Accumulated Depreciation",description:"Accumulated depreciation",type:"credit",isAmountField:!0,amountFieldName:"Depreciation Amount"}]},{id:"loan_payment",name:"Loan Payment",description:"Record loan principal and interest payment",category:"liabilities",lines:[{id:"lp1",accountId:"14",accountName:"Operating Expenses",description:"Interest expense",type:"debit",isAmountField:!0,amountFieldName:"Interest Amount"},{id:"lp2",accountId:"6",accountName:"Loans Payable",description:"Principal payment",type:"debit",isAmountField:!0,amountFieldName:"Principal Amount"},{id:"lp3",accountId:"1002",accountName:"Bank - Checking Account",description:"Total loan payment",type:"credit",isAmountField:!0,amountFieldName:"Total Payment"}]}],R5="journal_custom_templates",M6=()=>{try{const t=localStorage.getItem(R5);if(t)return JSON.parse(t)}catch(t){console.warn("Failed to load custom templates:",t)}return[]},ff=t=>{try{localStorage.setItem(R5,JSON.stringify(t))}catch(e){console.warn("Failed to save custom templates:",e)}},F6=()=>{const t=M6();return[...D6,...t]},[mf,yf]=Ce(F6()),xi={get templates(){return mf()},getTemplatesByCategory(t){return mf().filter(e=>e.category===t)},getTemplateById(t){return mf().find(e=>e.id===t)},addTemplate(t){const e={...t,id:`custom_${Date.now()}`};return yf(r=>{const n=[...r,e],i=n.filter(o=>o.id.startsWith("custom_"));return ff(i),n}),e},updateTemplate(t,e){yf(r=>{const n=r.map(o=>o.id===t?{...o,...e}:o),i=n.filter(o=>o.id.startsWith("custom_"));return ff(i),n})},deleteTemplate(t){if(t.startsWith("custom_"))yf(e=>{const r=e.filter(i=>i.id!==t),n=r.filter(i=>i.id.startsWith("custom_"));return ff(n),r});else throw new Error("Cannot delete default templates")},getAllCategories(){return["revenue","expenses","assets","liabilities","equity"]},getCategoryDisplayName(t){const e="es",r={revenue:{en:"Revenue & Sales",es:"Ingresos y Ventas"},expenses:{en:"Expenses & Costs",es:"Gastos y Costos"},assets:{en:"Assets & Receipts",es:"Activos y Recibos"},liabilities:{en:"Liabilities & Payments",es:"Pasivos y Pagos"},equity:{en:"Equity & Capital",es:"Patrimonio y Capital"}};return r[t][e]||r[t].en},getTranslatedFieldName:k6,getTranslatedTemplateName:N6,getTranslatedTemplateDesc:L6,getTranslatedLineDesc:R6};var M0=he("<div>"),O6=he("<div><h4></h4><div><div><strong>: </strong><span>|</span><strong>: </strong></div><div>"),B6=he("<form><div></div><div>"),j6=he("<div><div><div></div><div></div><div></div></div><div></div><div><div> ");const V6=t=>{const{t:e}=Zt(),[r,n]=Ce(""),[i,o]=Hu({form:{}}),[s,l]=Ce(""),[c,u]=Ce(""),[h,m]=Ce({}),[g,f]=Ce({date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),[w,x]=Ce(null);Ei(()=>{t.isOpen&&(n(""),o("form",null),l(null),u(""),f({date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),x(null))}),Ei(()=>{});const S={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},C={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-top":"1rem"},j={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},oe=H=>{if(n(H),H){const K=xi.getTemplateById(H);o("form",Hm(K)||null),l(K?.lines),K&&!g().description&&f(R=>({...R,description:K.description})),K&&K.lines.forEach((R,k)=>{R.fixedAmount||(o("form","lines",k,"fixedAmount",0),m(W=>({...W,[R.id]:0})))})}},te=()=>xi.getAllCategories().map(H=>({value:H,label:xi.getCategoryDisplayName(H)})),Z=()=>{const H=c();return H?xi.getTemplatesByCategory(H).map(K=>({value:K.id,label:xi.getTranslatedTemplateName(K.name)})):[]},re=(H,K)=>{f(R=>({...R,[H]:K}))},E=H=>h()?.[H]||0,$=(H,K)=>{const R=i.form;!R||!R.lines.find(W=>W.id===H)||(m(W=>({...W,[H]:K})),R.lines.findIndex(W=>W.id===H))},T=()=>{const H=i.form;if(!H)return{totalDebit:0,totalCredit:0,isBalanced:!1};let K=0,R=0;return H?.lines?.forEach(k=>{const W=h()?.[k.id]||k.fixedAmount||0;k.type==="debit"?K+=W:R+=W}),{totalDebit:K,totalCredit:R,isBalanced:Math.abs(K-R)<.01}},B=()=>{const H=i.form;if(!H)return[];const K=new Map;return H?.lines?.forEach(R=>{R.isAmountField&&R.amountFieldName&&K.set(R.amountFieldName,R.id)}),Array.from(K.entries()).map(([R,k])=>({fieldName:R,lineId:k}))},_=H=>{H.preventDefault(),x(null);const K=i.form;if(!K){x(e("journal.templateRequired","Please select a template"));return}const R=g(),{totalDebit:k,totalCredit:W,isBalanced:z}=T();if(!R.description){x(e("forms.descriptionRequired","Description is required"));return}if(!z){x(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${k.toFixed(2)}`).replace("${credit}",`$${W.toFixed(2)}`));return}for(const le of K.lines){const L=h()?.[le.id]||0;if(le.isAmountField&&L<=0){x(e("journal.amountRequired","Amount is required for {field}").replace("{field}",le.amountFieldName||"line"));return}}const U={entryNumber:Do.getNextEntryNumber(),date:R.date,description:R.description,reference:R.reference,status:"draft",createdBy:R.createdBy,createdAt:new Date().toISOString(),totalDebit:k,totalCredit:W,lines:K.lines.map((le,L)=>{const M=h()?.[le.id]||0;return{id:`jel_${Date.now()}_${L}`,accountId:le.accountId,accountName:le.accountName,description:le.description,debitAmount:le.type==="debit"?M:0,creditAmount:le.type==="credit"?M:0}})};try{Do.addJournalEntry(U),t.onClose()}catch(le){x(le instanceof Error?le.message:e("forms.errorOccurred","An error occurred"))}},P=H=>{const K="es-ES";return new Intl.NumberFormat(K,{style:"currency",currency:"USD"}).format(H)};B();const b=()=>i?.form?.lines||[];return D(qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.quickEntry","Quick Journal Entry")},get children(){var H=B6(),K=H.firstChild,R=K.nextSibling;return H.addEventListener("submit",_),K.style.setProperty("display","grid"),K.style.setProperty("grid-template-columns","1fr 1fr"),K.style.setProperty("gap","1rem"),K.style.setProperty("margin-bottom","1rem"),a(K,D(An,{get label(){return e("journal.selectCategory","Select Category")},get value(){return c()},onChange:k=>{u(k),oe("")},get options(){return[{value:"",label:e("journal.chooseCategory","Choose a category...")},...te()]},required:!0}),null),a(K,D(An,{get label(){return e("journal.selectTemplate","Select Template")},get value(){return r()},onChange:oe,get options(){return[{value:"",label:e("journal.chooseTemplate","Choose a template...")},...Z()]},get disabled(){return!c()},required:!0}),null),a(H,D(Ge,{get when(){return i.form},get children(){return[(()=>{var k=M0();return k.style.setProperty("display","grid"),k.style.setProperty("grid-template-columns","1fr 1fr"),k.style.setProperty("gap","1rem"),a(k,D(Ar,{get label(){return e("common.date")},type:"date",get value(){return g().date},onChange:W=>re("date",W),required:!0}),null),a(k,D(Ar,{get label(){return e("journal.reference")},get value(){return g().reference},onChange:W=>re("reference",W),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),null),k})(),D(Ar,{get label(){return e("common.description")},get value(){return g().description},onChange:k=>re("description",k),get placeholder(){return i?.form?.description||e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),(()=>{var k=O6(),W=k.firstChild,z=W.nextSibling,U=z.firstChild,le=U.firstChild,L=le.firstChild,M=le.nextSibling,G=M.nextSibling,I=G.firstChild,F=U.nextSibling;return y(k,C),W.style.setProperty("margin","0 0 1rem 0"),W.style.setProperty("color","var(--text-primary)"),a(W,()=>e("journal.entryPreview","Entry Preview")),a(k,D(zt,{get each(){return b()},children:X=>(()=>{var Y=j6(),Q=Y.firstChild,J=Q.firstChild,V=J.nextSibling,ne=V.nextSibling,ee=Q.nextSibling,ce=ee.nextSibling,se=ce.firstChild,q=se.firstChild;return J.style.setProperty("font-weight","500"),a(J,()=>X.accountName),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),a(V,()=>xi.getTranslatedLineDesc(X.description)),ne.style.setProperty("font-size","0.75rem"),ne.style.setProperty("margin-top","0.25rem"),ne.style.setProperty("font-weight","500"),a(ne,(()=>{var ue=$e(()=>X.type==="debit");return()=>ue()?e("journal.debit"):e("journal.credit")})()),a(ee,D(Ar,{label:"",type:"number",get value(){return E(X.id).toString()},onChange:ue=>$(X.id,parseFloat(ue)||0),placeholder:"0.00",step:"0.01",min:"0",style:{"font-size":"0.875rem"}})),ce.style.setProperty("text-align","right"),se.style.setProperty("font-weight","600"),a(se,()=>X.type==="debit"?"DR":"CR",q),a(se,()=>P(E(X.id)),null),we(ue=>{var ye={...j,display:"grid","grid-template-columns":"2fr 1fr 1fr",gap:"1rem","align-items":"center"},de=X.type==="debit"?"#d32f2f":"#2e7d32",ge=X.type==="debit"?"#d32f2f":"#2e7d32";return ue.e=y(Y,ye,ue.e),de!==ue.t&&((ue.t=de)!=null?ne.style.setProperty("color",de):ne.style.removeProperty("color")),ge!==ue.a&&((ue.a=ge)!=null?se.style.setProperty("color",ge):se.style.removeProperty("color")),ue},{e:void 0,t:void 0,a:void 0}),Y})()}),z),z.style.setProperty("margin-top","1rem"),z.style.setProperty("padding-top","1rem"),z.style.setProperty("border-top","2px solid var(--border-color)"),z.style.setProperty("display","flex"),z.style.setProperty("justify-content","space-between"),z.style.setProperty("align-items","center"),a(le,()=>e("journal.totalDebit"),L),a(le,()=>P(T().totalDebit),null),M.style.setProperty("margin","0 1rem"),M.style.setProperty("color","var(--text-muted)"),a(G,()=>e("journal.totalCredit"),I),a(G,()=>P(T().totalCredit),null),F.style.setProperty("font-weight","600"),a(F,(()=>{var X=$e(()=>!!T().isBalanced);return()=>X()?` ${e("journal.balanced","Balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`})()),we(X=>(X=T().isBalanced?"#4caf50":"#f44336")!=null?F.style.setProperty("color",X):F.style.removeProperty("color")),k})()]}}),R),a(H,(()=>{var k=$e(()=>!!w());return()=>k()&&(()=>{var W=M0();return W.style.setProperty("padding","1rem"),W.style.setProperty("border-radius","var(--border-radius-sm)"),W.style.setProperty("margin-top","1rem"),W.style.setProperty("background","#f8d7da"),W.style.setProperty("color","#721c24"),W.style.setProperty("border","1px solid #f5c6cb"),a(W,w),W})()})(),R),y(R,S),a(R,D(ht,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(R,D(ht,{variant:"primary",type:"submit",get disabled(){return!i.form||!T().isBalanced},get children(){return e("journal.createQuickEntry","Create Quick Entry")}}),null),H}})};var q6=he("<div><h3></h3><div>"),z6=he("<div><div></div><div><div><h4></h4></div><div><div><div></div><div></div><div></div><div></div><div></div><div>"),U6=he("<div><p></p><p>"),F0=he("<div><div></div><div>"),H6=he("<h4>"),G6=he("<span>"),gf=he("<div>");const W6=t=>{const{t:e}=Zt(),[r,n]=Ce(""),[i,o]=Ce(!1),[s,l]=Ce(!1),[c,u]=Ce({name:"",description:"",category:"expenses"}),[h,m]=Ce([{accountId:"",accountName:"",description:"",type:"debit",isAmountField:!0,amountFieldName:e("common.amount","Amount")},{accountId:"",accountName:"",description:"",type:"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}]),[g,f]=Ce(null);Ei(()=>{t.isOpen&&(n(""),o(!1),l(!1),f(null),Z())});const w={display:"flex",gap:"1.5rem",height:"500px"},x={width:"300px","border-right":"1px solid var(--border-color)","padding-right":"1.5rem","overflow-y":"auto"},S={flex:"1","overflow-y":"auto"},C={padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},j={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr 80px",gap:"0.5rem","align-items":"end","margin-bottom":"0.75rem",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)"},oe=()=>$r.accounts.map(k=>({value:k.id,label:`${k.accountNumber} - ${k.name}`})),te=()=>xi.getAllCategories().map(k=>({value:k,label:xi.getCategoryDisplayName(k)})),Z=()=>{u({name:"",description:"",category:"expenses"}),m([{accountId:"",accountName:"",description:"",type:"debit",isAmountField:!0,amountFieldName:e("common.amount","Amount")},{accountId:"",accountName:"",description:"",type:"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}])},re=k=>{const W=xi.getTemplateById(k);W&&(u({name:W.name,description:W.description,category:W.category}),m(W.lines.map(z=>({accountId:z.accountId,accountName:z.accountName,description:z.description,type:z.type,isAmountField:z.isAmountField,amountFieldName:z.amountFieldName,fixedAmount:z.fixedAmount}))))},E=k=>{n(k),o(!1),l(!1),re(k)},$=()=>{n(""),o(!1),l(!0),Z()},T=()=>{r()&&r().startsWith("custom_")&&o(!0)},B=()=>{const k=r();if(k&&k.startsWith("custom_")&&confirm(e("journal.confirmDeleteTemplate","Are you sure you want to delete this template?")))try{xi.deleteTemplate(k),n(""),Z()}catch(W){f(W instanceof Error?W.message:e("journal.errorDeletingTemplate","Error deleting template"))}},_=(k,W)=>{u(z=>({...z,[k]:W}))},P=(k,W,z)=>{m(U=>U.map((le,L)=>{if(L===k){const M={...le,[W]:z};if(W==="accountId"&&typeof z=="string"){const G=$r.getAccountById(z);G&&(M.accountName=G.name)}return M}return le}))},b=()=>{m(k=>[...k,{accountId:"",accountName:"",description:"",type:k.length%2===0?"debit":"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}])},H=k=>{h().length>2&&m(W=>W.filter((z,U)=>U!==k))},K=()=>{f(null);const k=c(),W=h();if(!k.name.trim()){f(e("journal.templateNameRequired","Template name is required"));return}if(!k.description.trim()){f(e("journal.templateDescriptionRequired","Template description is required"));return}if(W.length<2){f(e("journal.minTwoLinesRequired","At least 2 lines are required"));return}for(let U=0;U<W.length;U++){const le=W[U];if(!le.accountId){f(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(U+1).toString()));return}if(!le.description){f(e("journal.lineDescriptionRequired","Line {lineNumber}: Description is required").replace("{lineNumber}",(U+1).toString()));return}if(le.isAmountField&&!le.amountFieldName){f(e("journal.amountFieldNameRequired","Line {lineNumber}: Amount field name is required").replace("{lineNumber}",(U+1).toString()));return}}const z={name:k.name,description:k.description,category:k.category,lines:W.map((U,le)=>({id:`line_${Date.now()}_${le}`,...U}))};try{if(i()&&r())xi.updateTemplate(r(),z);else{const U=xi.addTemplate(z);n(U.id)}o(!1),l(!1)}catch(U){f(U instanceof Error?U.message:e("journal.errorSavingTemplate","Error saving template"))}},R=()=>{const k=xi.templates,W={};return k.forEach(z=>{W[z.category]||(W[z.category]=[]),W[z.category].push(z)}),W};return D(qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.manageTemplates","Manage Journal Templates")},size:"large",get children(){var k=F0(),W=k.firstChild,z=W.nextSibling;return y(k,w),y(W,x),a(W,D(ht,{variant:"primary",onClick:$,style:{width:"100%","margin-bottom":"1rem"},get children(){return["+ ",$e(()=>e("journal.addNewTemplate","Add New Template"))]}}),null),a(W,D(zt,{get each(){return Object.entries(R())},children:([U,le])=>[(()=>{var L=H6();return L.style.setProperty("margin","1rem 0 0.5rem 0"),L.style.setProperty("font-size","0.875rem"),L.style.setProperty("color","var(--text-muted)"),L.style.setProperty("text-transform","uppercase"),a(L,()=>xi.getCategoryDisplayName(U)),L})(),D(zt,{each:le,children:L=>(()=>{var M=F0(),G=M.firstChild,I=G.nextSibling;return M.$$click=()=>E(L.id),G.style.setProperty("font-weight","500"),a(G,()=>xi.getTranslatedTemplateName(L.name)),I.style.setProperty("font-size","0.75rem"),I.style.setProperty("opacity","0.8"),I.style.setProperty("margin-top","0.25rem"),a(I,()=>xi.getTranslatedTemplateDesc(L.description)),a(M,(()=>{var F=$e(()=>!!L.id.startsWith("custom_"));return()=>F()&&(()=>{var X=G6();return X.style.setProperty("font-size","0.625rem"),X.style.setProperty("background","rgba(255,255,255,0.2)"),X.style.setProperty("padding","0.125rem 0.5rem"),X.style.setProperty("border-radius","10px"),X.style.setProperty("margin-top","0.25rem"),X.style.setProperty("display","inline-block"),a(X,()=>e("journal.custom","Custom")),X})()})(),null),we(F=>y(M,{...C,background:r()===L.id?"var(--primary-color)":"var(--surface-color)",color:r()===L.id?"white":"inherit"},F)),M})()})]}),null),y(z,S),a(z,D(Ge,{get when(){return r()||s()},get children(){return[(()=>{var U=q6(),le=U.firstChild,L=le.nextSibling;return U.style.setProperty("display","flex"),U.style.setProperty("justify-content","space-between"),U.style.setProperty("align-items","center"),U.style.setProperty("margin-bottom","1rem"),le.style.setProperty("margin","0"),a(le,(()=>{var M=$e(()=>!!s());return()=>M()?e("journal.newTemplate","New Template"):$e(()=>!!i())()?e("journal.editTemplate","Edit Template"):e("journal.templateDetails","Template Details")})()),L.style.setProperty("display","flex"),L.style.setProperty("gap","0.5rem"),a(L,D(Ge,{get when(){return $e(()=>!!(r()&&r().startsWith("custom_")))()&&!i()},get children(){return[D(ht,{variant:"outline",size:"sm",onClick:T,get children(){return e("common.edit")}}),D(ht,{variant:"outline",size:"sm",onClick:B,style:{color:"var(--danger-color)"},get children(){return e("common.delete")}})]}}),null),a(L,D(Ge,{get when(){return i()||s()},get children(){return[D(ht,{variant:"secondary",size:"sm",onClick:()=>{o(!1),l(!1),r()&&re(r())},get children(){return e("common.cancel")}}),D(ht,{variant:"primary",size:"sm",onClick:K,get children(){return e("common.save")}})]}}),null),U})(),(()=>{var U=z6(),le=U.firstChild,L=le.nextSibling,M=L.firstChild,G=M.firstChild,I=M.nextSibling,F=I.firstChild,X=F.firstChild,Y=X.nextSibling,Q=Y.nextSibling,J=Q.nextSibling,V=J.nextSibling,ne=V.nextSibling;return U.style.setProperty("background","var(--background-color)"),U.style.setProperty("padding","1rem"),U.style.setProperty("border-radius","var(--border-radius-sm)"),le.style.setProperty("display","grid"),le.style.setProperty("grid-template-columns","2fr 1fr"),le.style.setProperty("gap","1rem"),le.style.setProperty("margin-bottom","1rem"),a(le,D(Ar,{get label(){return e("journal.templateName","Template Name")},get value(){return c().name},onChange:ee=>_("name",ee),get disabled(){return $e(()=>!i())()&&!s()},get placeholder(){return e("journal.enterTemplateName","Enter template name")}}),null),a(le,D(An,{get label(){return e("journal.category","Category")},get value(){return c().category},onChange:ee=>_("category",ee),get options(){return te()},get disabled(){return $e(()=>!i())()&&!s()}}),null),a(U,D(Ar,{get label(){return e("common.description")},get value(){return c().description},onChange:ee=>_("description",ee),get disabled(){return $e(()=>!i())()&&!s()},get placeholder(){return e("journal.enterTemplateDescription","Enter template description")}}),L),L.style.setProperty("margin-top","2rem"),M.style.setProperty("display","flex"),M.style.setProperty("justify-content","space-between"),M.style.setProperty("align-items","center"),M.style.setProperty("margin-bottom","1rem"),G.style.setProperty("margin","0"),a(G,()=>e("journal.templateLines","Template Lines")),a(M,D(Ge,{get when(){return i()||s()},get children(){return D(ht,{variant:"secondary",size:"sm",onClick:b,get children(){return["+ ",$e(()=>e("journal.addLine"))]}})}}),null),I.style.setProperty("margin-bottom","0.5rem"),I.style.setProperty("font-size","0.75rem"),I.style.setProperty("color","var(--text-muted)"),F.style.setProperty("display","grid"),F.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr 80px"),F.style.setProperty("gap","0.5rem"),a(X,()=>e("journal.account")),a(Y,()=>e("common.description")),a(Q,()=>e("journal.type","Type")),a(J,()=>e("journal.amountType","Amount Type")),a(V,()=>e("journal.fieldName","Field Name")),a(ne,()=>e("common.actions")),a(L,D(zt,{get each(){return h()},get fallback(){return(()=>{var ee=gf();return a(ee,()=>e("journal.noTemplateLines","No template lines")),ee})()},children:(ee,ce)=>{const se=ee,q=ce();return(()=>{var ue=gf();return y(ue,j),a(ue,D(An,{label:"",get value(){return se.accountId||""},onChange:ye=>P(q,"accountId",ye),get options(){return[{value:"",label:e("journal.selectAccount","Select account...")},...oe()]},get disabled(){return $e(()=>!i())()&&!s()}}),null),a(ue,D(Ar,{label:"",get value(){return se.description||""},onChange:ye=>P(q,"description",ye),get placeholder(){return e("journal.lineDescription")},get disabled(){return $e(()=>!i())()&&!s()}}),null),a(ue,D(An,{label:"",get value(){return se.type},onChange:ye=>P(q,"type",ye),get options(){return[{value:"debit",label:e("journal.debit")},{value:"credit",label:e("journal.credit")}]},get disabled(){return $e(()=>!i())()&&!s()}}),null),a(ue,D(An,{label:"",get value(){return se.isAmountField?"variable":"fixed"},onChange:ye=>{P(q,"isAmountField",ye==="variable"),ye==="fixed"&&P(q,"fixedAmount",0)},get options(){return[{value:"variable",label:e("journal.variable","Variable")},{value:"fixed",label:e("journal.fixed","Fixed")}]},get disabled(){return $e(()=>!i())()&&!s()}}),null),a(ue,D(Ge,{get when(){return se.isAmountField},get fallback(){return D(Ar,{label:"",type:"number",get value(){return se.fixedAmount?.toString()||"0"},onChange:ye=>P(q,"fixedAmount",parseFloat(ye)||0),placeholder:"0.00",get disabled(){return $e(()=>!i())()&&!s()}})},get children(){return D(Ar,{label:"",get value(){return se.amountFieldName||""},onChange:ye=>P(q,"amountFieldName",ye),get placeholder(){return e("journal.fieldNamePlaceholder","e.g., Monto")},get disabled(){return $e(()=>!i())()&&!s()}})}}),null),a(ue,D(Ge,{get when(){return i()||s()},get children(){return D(ht,{variant:"outline",size:"sm",onClick:()=>H(q),get disabled(){return h().length<=2},style:{color:"var(--danger-color)"},get children(){return e("common.remove")}})}}),null),ue})()}}),null),U})(),$e(()=>$e(()=>!!g())()&&(()=>{var U=gf();return U.style.setProperty("padding","1rem"),U.style.setProperty("border-radius","var(--border-radius-sm)"),U.style.setProperty("margin-top","1rem"),U.style.setProperty("background","#f8d7da"),U.style.setProperty("color","#721c24"),U.style.setProperty("border","1px solid #f5c6cb"),a(U,g),U})())]}}),null),a(z,D(Ge,{get when(){return $e(()=>!r())()&&!s()},get children(){var U=U6(),le=U.firstChild,L=le.nextSibling;return U.style.setProperty("text-align","center"),U.style.setProperty("padding","3rem"),U.style.setProperty("color","var(--text-muted)"),a(le,()=>e("journal.selectTemplateToView","Select a template from the list to view details")),a(L,()=>e("journal.orCreateNew","or create a new custom template")),U}}),null),k}})};pr(["click"]);var Y6=he("<div><div></div><div></div><div></div><div>"),K6=he("<div><div></div><div></div><div></div><div></div><div>"),J6=he("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),vf=he("<div>"),Q6=he("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),bf=he("<div><span></span><span>"),Ud=he("<div><strong>:</strong> "),X6=he("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong> </strong></div><div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div></div><div><div><strong>:</strong> </div><div><strong>:</strong> "),Z6=he("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),eL=he("<div><span> "),tL=he("<span>(<!>)"),rL=he("<div><div>:"),nL=he("<div><div> <!>:</div><div>"),iL=he("<div><div><div><span></span><h3></h3></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),oL=he("<div><h4> <!> (<!>)"),sL=he("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> "),aL=he("<div> "),lL=he("<div><h4> <!> (<!>)"),cL=he("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div> "),uL=he("<div><div> </div><div> ");const dL=t=>{const{t:e}=Zt(),[r,n]=Ce("details"),[i,o]=Ce(!1),s=Lt(()=>t.entryId?Do.getJournalEntryById(t.entryId):null),l={"text-align":"center","margin-bottom":"2rem",position:"relative"},c={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},u={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},h={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},m={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},g={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},f={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},w={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},x={"font-weight":"600",color:"var(--text-primary)"},S={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},C=b=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:b?"var(--primary-color)":"var(--text-muted)","border-bottom":b?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),j={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},oe={...j,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},te={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},Z={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},re=b=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[b],E=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(b),$=b=>new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),T=b=>new Date(b).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),B=()=>{s()?.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||o(!0)},_=()=>{if(s()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{Do.postJournalEntry(s().id)}catch(b){alert(b instanceof Error?b.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},P=()=>{s()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&Do.voidJournalEntry(s().id)};return[D(qn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return $e(()=>!s())()?(()=>{var b=Y6(),H=b.firstChild,K=H.nextSibling,R=K.nextSibling,k=R.nextSibling;return b.style.setProperty("text-align","center"),b.style.setProperty("padding","3rem"),b.style.setProperty("color","var(--text-muted)"),H.style.setProperty("font-size","1.5rem"),H.style.setProperty("margin-bottom","1rem"),K.style.setProperty("font-size","1.1rem"),K.style.setProperty("margin-bottom","0.5rem"),a(K,()=>e("journal.entryNotFound","Entry Not Found")),R.style.setProperty("font-size","0.875rem"),a(R,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),k.style.setProperty("margin-top","2rem"),a(k,D(ht,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),b})():(()=>{const b=s(),H=re(b.status),K=Math.abs(b.totalDebit-b.totalCredit)<.01;return[(()=>{var R=K6(),k=R.firstChild,W=k.nextSibling,z=W.nextSibling,U=z.nextSibling,le=U.nextSibling;return y(R,l),a(k,D(ht,{variant:"outline",size:"sm",onClick:B,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),a(k,(()=>{var L=$e(()=>b.status==="draft");return()=>L()&&D(ht,{variant:"primary",size:"sm",onClick:_,disabled:!K,get title(){return K?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),a(k,(()=>{var L=$e(()=>b.status==="posted");return()=>L()&&D(ht,{variant:"outline",size:"sm",onClick:P,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),y(W,u),a(W,()=>b.entryNumber),y(z,h),a(z,()=>b.description),y(U,m),a(U,()=>E(b.totalDebit)),a(le,()=>e(`journal.${b.status}`,b.status)),we(L=>{var M=c,G={...g,background:H.bg,color:H.color};return L.e=y(k,M,L.e),L.t=y(le,G,L.t),L},{e:void 0,t:void 0}),R})(),(()=>{var R=J6(),k=R.firstChild,W=k.nextSibling,z=W.firstChild,U=z.nextSibling;U.nextSibling;var le=W.nextSibling,L=le.firstChild,M=L.nextSibling,G=M.nextSibling,I=G.nextSibling;return I.nextSibling,y(R,S),k.$$click=()=>n("details"),a(k,()=>e("common.details")),W.$$click=()=>n("lines"),a(W,()=>e("journal.journalLines","Journal Lines"),z),a(W,()=>b.lines.length,U),le.$$click=()=>n("reconciliation"),a(le,()=>e("banking.reconciliation","Reconciliation"),L),a(le,()=>b.lines.filter(F=>F.reconciled).length,M),a(le,()=>b.lines.length,I),we(F=>{var X=C(r()==="details"),Y=C(r()==="lines"),Q=C(r()==="reconciliation");return F.e=y(k,X,F.e),F.t=y(W,Y,F.t),F.a=y(le,Q,F.a),F},{e:void 0,t:void 0,a:void 0}),R})(),$e(()=>$e(()=>r()==="details")()&&(()=>{var R=Q6(),k=R.firstChild,W=k.firstChild,z=W.nextSibling,U=k.nextSibling,le=U.firstChild,L=le.nextSibling,M=U.nextSibling,G=M.firstChild,I=G.nextSibling,F=M.nextSibling,X=F.firstChild,Y=X.nextSibling,Q=F.nextSibling,J=Q.firstChild,V=J.nextSibling,ne=Q.nextSibling,ee=ne.firstChild,ce=ee.nextSibling,se=ne.nextSibling,q=se.firstChild,ue=q.nextSibling,ye=se.nextSibling,de=ye.firstChild,ge=de.firstChild,xe=ge.nextSibling,pe=de.nextSibling;return a(W,()=>e("common.date")),a(z,()=>$(b.date)),a(le,()=>e("journal.reference")),a(L,()=>b.reference||e("common.notAvailable","N/A")),a(G,()=>e("journal.totalDebit")),a(I,()=>E(b.totalDebit)),a(X,()=>e("journal.totalCredit")),a(Y,()=>E(b.totalCredit)),a(J,()=>e("journal.balanceStatus","Balance Status")),a(V,()=>K?`${e("journal.balanced")} `:`${e("journal.unbalanced","Unbalanced")} (${E(Math.abs(b.totalDebit-b.totalCredit))} ${e("journal.difference","difference")})`),a(ee,()=>e("journal.createdBy")),a(ce,()=>b.createdBy),a(q,()=>e("journal.createdAt","Created At")),a(ue,()=>T(b.createdAt)),a(R,(()=>{var _e=$e(()=>!!b.postedAt);return()=>_e()&&(()=>{var Re=bf(),Ee=Re.firstChild,Te=Ee.nextSibling;return a(Ee,()=>e("journal.postedAt","Posted At")),a(Te,()=>T(b.postedAt)),we(Le=>{var Ie=f,De=w,Ye=x;return Le.e=y(Re,Ie,Le.e),Le.t=y(Ee,De,Le.t),Le.a=y(Te,Ye,Le.a),Le},{e:void 0,t:void 0,a:void 0}),Re})()})(),ye),ye.style.setProperty("margin-top","2rem"),ye.style.setProperty("padding-top","1rem"),ye.style.setProperty("border-top","2px solid var(--border-color)"),de.style.setProperty("display","flex"),de.style.setProperty("justify-content","space-between"),de.style.setProperty("align-items","center"),de.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("margin","0"),ge.style.setProperty("font-size","1rem"),a(ge,()=>e("journal.quickActions","Quick Actions")),xe.style.setProperty("display","flex"),xe.style.setProperty("gap","0.5rem"),a(xe,D(ht,{variant:"primary",size:"sm",onClick:B,get children(){return[" ",$e(()=>e("journal.editEntry"))]}}),null),a(xe,(()=>{var _e=$e(()=>b.status==="draft");return()=>_e()&&D(ht,{variant:"outline",size:"sm",onClick:_,disabled:!K,style:{"border-color":K?"#4caf50":"#f44336",color:K?"#4caf50":"#f44336"},get children(){return K?` ${e("journal.postEntry","Post Entry")}`:` ${e("journal.fixBalance","Fix Balance")}`}})})(),null),a(xe,(()=>{var _e=$e(()=>b.status==="posted");return()=>_e()&&D(ht,{variant:"outline",size:"sm",onClick:P,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return[" ",$e(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),pe.style.setProperty("padding","1rem"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("font-size","0.875rem"),a(pe,(()=>{var _e=$e(()=>b.status==="draft");return()=>_e()&&(()=>{var Re=Ud(),Ee=Re.firstChild,Te=Ee.firstChild;return Ee.nextSibling,a(Ee,()=>e("journal.draftEntry","Draft Entry"),Te),a(Re,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),a(Re,()=>!K&&`  ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),Re})()})(),null),a(pe,(()=>{var _e=$e(()=>b.status==="posted");return()=>_e()&&(()=>{var Re=Ud(),Ee=Re.firstChild,Te=Ee.firstChild;return Ee.nextSibling,a(Ee,()=>e("journal.postedEntry","Posted Entry"),Te),a(Re,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),Re})()})(),null),a(pe,(()=>{var _e=$e(()=>b.status==="void");return()=>_e()&&(()=>{var Re=Ud(),Ee=Re.firstChild,Te=Ee.firstChild;return Ee.nextSibling,a(Ee,()=>e("journal.voidEntry"),Te),a(Re,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),Re})()})(),null),we(_e=>{var Re=f,Ee=w,Te=x,Le=f,Ie=w,De=x,Ye=f,Be=w,We=x,Ke=f,st=w,nt=x,He=f,mt=w,ut={...x,color:K?"#4caf50":"#f44336"},at=f,It=w,Xe=x,kt=f,Tt=w,wt=x,Rt=b.status==="draft"?"#fff3cd":b.status==="posted"?"#d4edda":"#f8d7da";return _e.e=y(k,Re,_e.e),_e.t=y(W,Ee,_e.t),_e.a=y(z,Te,_e.a),_e.o=y(U,Le,_e.o),_e.i=y(le,Ie,_e.i),_e.n=y(L,De,_e.n),_e.s=y(M,Ye,_e.s),_e.h=y(G,Be,_e.h),_e.r=y(I,We,_e.r),_e.d=y(F,Ke,_e.d),_e.l=y(X,st,_e.l),_e.u=y(Y,nt,_e.u),_e.c=y(Q,He,_e.c),_e.w=y(J,mt,_e.w),_e.m=y(V,ut,_e.m),_e.f=y(ne,at,_e.f),_e.y=y(ee,It,_e.y),_e.g=y(ce,Xe,_e.g),_e.p=y(se,kt,_e.p),_e.b=y(q,Tt,_e.b),_e.T=y(ue,wt,_e.T),Rt!==_e.A&&((_e.A=Rt)!=null?pe.style.setProperty("background",Rt):pe.style.removeProperty("background")),_e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),R})()),$e(()=>$e(()=>r()==="lines")()&&(()=>{var R=X6(),k=R.firstChild,W=k.firstChild,z=W.nextSibling,U=z.nextSibling,le=U.nextSibling,L=le.nextSibling,M=k.nextSibling,G=M.firstChild,I=G.firstChild,F=I.firstChild;I.nextSibling;var X=G.nextSibling,Y=X.firstChild,Q=Y.firstChild;Y.nextSibling;var J=X.nextSibling,V=M.nextSibling,ne=V.firstChild,ee=ne.firstChild;ee.firstChild;var ce=ne.nextSibling,se=ce.firstChild,q=se.firstChild,ue=q.firstChild,ye=ue.firstChild;ue.nextSibling;var de=q.nextSibling,ge=de.firstChild,xe=ge.firstChild;ge.nextSibling;var pe=de.nextSibling,_e=pe.firstChild,Re=_e.firstChild;_e.nextSibling;var Ee=se.nextSibling,Te=Ee.firstChild,Le=Te.firstChild,Ie=Le.firstChild;Le.nextSibling;var De=Te.nextSibling,Ye=De.firstChild,Be=Ye.firstChild;return Ye.nextSibling,a(W,()=>e("journal.account")),a(z,()=>e("common.description")),a(U,()=>e("journal.debit")),a(le,()=>e("journal.credit")),a(L,()=>e("banking.reconciliation")),a(R,D(zt,{get each(){return b.lines},children:We=>(()=>{var Ke=Z6(),st=Ke.firstChild,nt=st.firstChild,He=nt.nextSibling,mt=st.nextSibling,ut=mt.nextSibling,at=ut.nextSibling,It=at.nextSibling;return nt.style.setProperty("font-weight","500"),a(nt,()=>We.accountName),He.style.setProperty("font-size","0.75rem"),He.style.setProperty("color","var(--text-muted)"),a(He,()=>$r.getAccountById(We.accountId)?.accountNumber||We.accountId),mt.style.setProperty("font-size","0.875rem"),a(mt,()=>We.description||"-"),ut.style.setProperty("font-weight","600"),a(ut,(()=>{var Xe=$e(()=>We.debitAmount>0);return()=>Xe()?E(We.debitAmount):"-"})()),at.style.setProperty("font-weight","600"),a(at,(()=>{var Xe=$e(()=>We.creditAmount>0);return()=>Xe()?E(We.creditAmount):"-"})()),a(It,(()=>{var Xe=$e(()=>!!We.reconciled);return()=>Xe()?(()=>{var kt=eL(),Tt=kt.firstChild;return Tt.firstChild,kt.style.setProperty("display","flex"),kt.style.setProperty("align-items","center"),kt.style.setProperty("gap","0.5rem"),kt.style.setProperty("color","#4caf50"),kt.style.setProperty("font-size","0.875rem"),Tt.style.setProperty("font-weight","600"),a(Tt,()=>e("banking.reconciled"),null),a(kt,(()=>{var wt=$e(()=>!!We.reconciledWith);return()=>wt()&&(()=>{var Rt=tL(),fr=Rt.firstChild,ze=fr.nextSibling;return ze.nextSibling,Rt.style.setProperty("font-size","0.75rem"),Rt.style.setProperty("color","var(--text-muted)"),Rt.style.setProperty("font-style","italic"),a(Rt,()=>We.reconciledWith,ze),Rt})()})(),null),kt})():(()=>{var kt=vf();return kt.style.setProperty("color","var(--text-muted)"),kt.style.setProperty("font-size","0.875rem"),a(kt,()=>e("banking.notReconciled","Not Reconciled")),kt})()})()),we(Xe=>{var kt=j,Tt=We.debitAmount>0?"#4caf50":"var(--text-muted)",wt=We.creditAmount>0?"#f44336":"var(--text-muted)";return Xe.e=y(Ke,kt,Xe.e),Tt!==Xe.t&&((Xe.t=Tt)!=null?ut.style.setProperty("color",Tt):ut.style.removeProperty("color")),wt!==Xe.a&&((Xe.a=wt)!=null?at.style.setProperty("color",wt):at.style.removeProperty("color")),Xe},{e:void 0,t:void 0,a:void 0}),Ke})()}),M),y(M,te),a(I,()=>e("journal.totalDebit"),F),a(G,()=>E(b.totalDebit),null),a(Y,()=>e("journal.totalCredit"),Q),a(X,()=>E(b.totalCredit),null),(K?"#4caf50":"#f44336")!=null?J.style.setProperty("color",K?"#4caf50":"#f44336"):J.style.removeProperty("color"),J.style.setProperty("font-weight","600"),a(J,()=>K?` ${e("journal.balanced")}`:` ${e("journal.notBalanced","Not Balanced")}`),V.style.setProperty("margin-top","1rem"),V.style.setProperty("padding","1rem"),V.style.setProperty("border-radius","var(--border-radius-sm)"),V.style.setProperty("font-size","0.875rem"),ne.style.setProperty("margin-bottom","0.5rem"),a(ee,()=>e("journal.reconciliationSummary","Reconciliation Summary"),null),ce.style.setProperty("display","grid"),ce.style.setProperty("grid-template-columns","1fr 1fr"),ce.style.setProperty("gap","1rem"),q.style.setProperty("margin-bottom","0.25rem"),a(ue,()=>e("journal.totalLines","Total Lines"),ye),a(q,()=>b.lines.length,null),de.style.setProperty("margin-bottom","0.25rem"),de.style.setProperty("color","#4caf50"),a(ge,()=>e("journal.reconciled","Reconciled"),xe),a(de,()=>b.lines.filter(We=>We.reconciled).length,null),pe.style.setProperty("color","#f44336"),a(_e,()=>e("journal.unreconciled","Unreconciled"),Re),a(pe,()=>b.lines.filter(We=>!We.reconciled).length,null),Te.style.setProperty("margin-bottom","0.25rem"),a(Le,()=>e("journal.bankAccounts","Bank Accounts"),Ie),a(Te,()=>b.lines.filter(We=>["1001","1002","1003"].includes(We.accountId)).length,null),De.style.setProperty("margin-bottom","0.25rem"),De.style.setProperty("color","#4caf50"),a(Ye,()=>e("journal.bankReconciled","Bank Reconciled"),Be),a(De,()=>b.lines.filter(We=>["1001","1002","1003"].includes(We.accountId)&&We.reconciled).length,null),a(Ee,(()=>{var We=$e(()=>b.lines.filter(Ke=>["1001","1002","1003"].includes(Ke.accountId)&&!Ke.reconciled).length>0);return()=>We()&&(()=>{var Ke=Ud(),st=Ke.firstChild,nt=st.firstChild;return st.nextSibling,Ke.style.setProperty("color","#f44336"),a(st,()=>e("journal.bankPending","Bank Pending"),nt),a(Ke,()=>b.lines.filter(He=>["1001","1002","1003"].includes(He.accountId)&&!He.reconciled).length,null),Ke})()})(),null),a(V,(()=>{var We=$e(()=>b.lines.filter(Ke=>Ke.reconciled).length>0);return()=>We()&&(()=>{var Ke=rL(),st=Ke.firstChild,nt=st.firstChild;return Ke.style.setProperty("margin-top","0.75rem"),Ke.style.setProperty("padding-top","0.75rem"),Ke.style.setProperty("border-top","1px solid var(--border-color)"),st.style.setProperty("margin-bottom","0.5rem"),st.style.setProperty("font-weight","500"),a(st,()=>e("journal.reconciledLines","Reconciled Lines"),nt),a(Ke,()=>b.lines.filter(He=>He.reconciled).map(He=>(()=>{var mt=bf(),ut=mt.firstChild,at=ut.nextSibling;return mt.style.setProperty("display","flex"),mt.style.setProperty("justify-content","space-between"),mt.style.setProperty("margin-bottom","0.25rem"),mt.style.setProperty("font-size","0.8rem"),a(ut,()=>He.accountName),at.style.setProperty("color","var(--text-muted)"),a(at,(()=>{var It=$e(()=>!!He.reconciledWith);return()=>It()?` ${He.reconciledWith}`:e("journal.manual","Manual")})()),mt})()),null),Ke})()})(),null),a(V,(()=>{var We=$e(()=>b.lines.filter(Ke=>!Ke.reconciled&&["1001","1002","1003"].includes(Ke.accountId)).length>0);return()=>We()&&(()=>{var Ke=nL(),st=Ke.firstChild,nt=st.firstChild,He=nt.nextSibling;He.nextSibling;var mt=st.nextSibling;return Ke.style.setProperty("margin-top","0.75rem"),Ke.style.setProperty("padding-top","0.75rem"),Ke.style.setProperty("border-top","1px solid var(--border-color)"),st.style.setProperty("margin-bottom","0.5rem"),st.style.setProperty("font-weight","500"),st.style.setProperty("color","#f44336"),a(st,()=>e("journal.pendingBankReconciliation","Pending Bank Reconciliation"),He),a(Ke,()=>b.lines.filter(ut=>!ut.reconciled&&["1001","1002","1003"].includes(ut.accountId)).map(ut=>(()=>{var at=bf(),It=at.firstChild,Xe=It.nextSibling;return at.style.setProperty("display","flex"),at.style.setProperty("justify-content","space-between"),at.style.setProperty("margin-bottom","0.25rem"),at.style.setProperty("font-size","0.8rem"),at.style.setProperty("color","#f44336"),a(It,()=>ut.accountName),a(Xe,()=>E(ut.debitAmount||ut.creditAmount)),at})()),mt),mt.style.setProperty("margin-top","0.5rem"),mt.style.setProperty("font-size","0.75rem"),mt.style.setProperty("color","var(--text-muted)"),mt.style.setProperty("font-style","italic"),a(mt,()=>e("journal.visitBankConsolidations","Visit Bank Consolidations to reconcile these transactions")),Ke})()})(),null),we(We=>{var Ke=oe,st=b.lines.some(nt=>nt.reconciled)?"#e8f5e8":"#fff3cd";return We.e=y(k,Ke,We.e),st!==We.t&&((We.t=st)!=null?V.style.setProperty("background",st):V.style.removeProperty("background")),We},{e:void 0,t:void 0}),R})()),$e(()=>$e(()=>r()==="reconciliation")()&&(()=>{var R=iL(),k=R.firstChild,W=k.firstChild,z=W.firstChild,U=z.nextSibling,le=W.nextSibling,L=le.firstChild,M=L.firstChild,G=M.nextSibling,I=L.nextSibling,F=I.firstChild,X=F.nextSibling,Y=I.nextSibling,Q=Y.firstChild,J=Q.nextSibling;return k.style.setProperty("margin-bottom","1.5rem"),k.style.setProperty("padding","1rem"),k.style.setProperty("border-radius","var(--border-radius)"),k.style.setProperty("border","1px solid var(--border-color)"),W.style.setProperty("display","flex"),W.style.setProperty("align-items","center"),W.style.setProperty("gap","0.5rem"),W.style.setProperty("margin-bottom","1rem"),z.style.setProperty("font-size","1.5rem"),a(z,(()=>{var V=$e(()=>!!b.lines.every(ne=>ne.reconciled));return()=>V()?"":b.lines.some(ne=>ne.reconciled)?"":""})()),U.style.setProperty("margin","0"),U.style.setProperty("font-size","1.2rem"),a(U,(()=>{var V=$e(()=>!!b.lines.every(ne=>ne.reconciled));return()=>V()?e("journal.fullyReconciled","Fully Reconciled"):$e(()=>!!b.lines.some(ne=>ne.reconciled))()?e("journal.partiallyReconciled","Partially Reconciled"):e("journal.unreconciled","Unreconciled")})()),le.style.setProperty("display","grid"),le.style.setProperty("grid-template-columns","1fr 1fr 1fr"),le.style.setProperty("gap","1rem"),L.style.setProperty("text-align","center"),M.style.setProperty("font-size","2rem"),M.style.setProperty("font-weight","700"),M.style.setProperty("color","var(--primary-color)"),a(M,()=>b.lines.length),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>e("journal.totalLines","Total Lines")),I.style.setProperty("text-align","center"),F.style.setProperty("font-size","2rem"),F.style.setProperty("font-weight","700"),F.style.setProperty("color","#4caf50"),a(F,()=>b.lines.filter(V=>V.reconciled).length),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),a(X,()=>e("journal.reconciled","Reconciled")),Y.style.setProperty("text-align","center"),Q.style.setProperty("font-size","2rem"),Q.style.setProperty("font-weight","700"),Q.style.setProperty("color","#f44336"),a(Q,()=>b.lines.filter(V=>!V.reconciled).length),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),a(J,()=>e("journal.pending","Pending")),a(R,(()=>{var V=$e(()=>b.lines.filter(ne=>ne.reconciled).length>0);return()=>V()&&(()=>{var ne=oL(),ee=ne.firstChild,ce=ee.firstChild,se=ce.nextSibling,q=se.nextSibling,ue=q.nextSibling;return ue.nextSibling,ne.style.setProperty("margin-bottom","1.5rem"),ee.style.setProperty("margin","0 0 1rem 0"),ee.style.setProperty("font-size","1.1rem"),ee.style.setProperty("color","#4caf50"),ee.style.setProperty("display","flex"),ee.style.setProperty("align-items","center"),ee.style.setProperty("gap","0.5rem"),a(ee,()=>e("journal.reconciledLines","Reconciled Lines"),se),a(ee,()=>b.lines.filter(ye=>ye.reconciled).length,ue),a(ne,()=>b.lines.filter(ye=>ye.reconciled).map(ye=>(()=>{var de=sL(),ge=de.firstChild,xe=ge.firstChild,pe=xe.nextSibling,_e=ge.nextSibling,Re=_e.nextSibling,Ee=Re.nextSibling,Te=Ee.nextSibling,Le=Te.firstChild;return Le.firstChild,de.style.setProperty("display","grid"),de.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),de.style.setProperty("gap","1rem"),de.style.setProperty("padding","0.75rem"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("background","#f0f9f0"),de.style.setProperty("border-radius","var(--border-radius-sm)"),de.style.setProperty("align-items","center"),de.style.setProperty("font-size","0.875rem"),xe.style.setProperty("font-weight","500"),a(xe,()=>ye.accountName),pe.style.setProperty("font-size","0.75rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>$r.getAccountById(ye.accountId)?.accountNumber),_e.style.setProperty("color","var(--text-muted)"),a(_e,()=>ye.description||e("journal.noDescription","No description")),Re.style.setProperty("font-weight","600"),a(Re,(()=>{var Ie=$e(()=>ye.debitAmount>0);return()=>Ie()?E(ye.debitAmount):"-"})()),Ee.style.setProperty("font-weight","600"),a(Ee,(()=>{var Ie=$e(()=>ye.creditAmount>0);return()=>Ie()?E(ye.creditAmount):"-"})()),Te.style.setProperty("color","#4caf50"),Le.style.setProperty("font-weight","500"),a(Le,()=>e("journal.matched","Matched"),null),a(Te,(()=>{var Ie=$e(()=>!!ye.reconciledWith);return()=>Ie()&&(()=>{var De=aL();return De.firstChild,De.style.setProperty("font-size","0.75rem"),De.style.setProperty("font-style","italic"),a(De,()=>ye.reconciledWith,null),De})()})(),null),we(Ie=>{var De=ye.debitAmount>0?"#4caf50":"var(--text-muted)",Ye=ye.creditAmount>0?"#f44336":"var(--text-muted)";return De!==Ie.e&&((Ie.e=De)!=null?Re.style.setProperty("color",De):Re.style.removeProperty("color")),Ye!==Ie.t&&((Ie.t=Ye)!=null?Ee.style.setProperty("color",Ye):Ee.style.removeProperty("color")),Ie},{e:void 0,t:void 0}),de})()),null),ne})()})(),null),a(R,(()=>{var V=$e(()=>b.lines.filter(ne=>!ne.reconciled).length>0);return()=>V()&&(()=>{var ne=lL(),ee=ne.firstChild,ce=ee.firstChild,se=ce.nextSibling,q=se.nextSibling,ue=q.nextSibling;return ue.nextSibling,ne.style.setProperty("margin-bottom","1.5rem"),ee.style.setProperty("margin","0 0 1rem 0"),ee.style.setProperty("font-size","1.1rem"),ee.style.setProperty("color","#f44336"),ee.style.setProperty("display","flex"),ee.style.setProperty("align-items","center"),ee.style.setProperty("gap","0.5rem"),a(ee,()=>e("journal.unreconciledLines","Unreconciled Lines"),se),a(ee,()=>b.lines.filter(ye=>!ye.reconciled).length,ue),a(ne,()=>b.lines.filter(ye=>!ye.reconciled).map(ye=>(()=>{var de=cL(),ge=de.firstChild,xe=ge.firstChild,pe=xe.nextSibling,_e=ge.nextSibling,Re=_e.nextSibling,Ee=Re.nextSibling,Te=Ee.nextSibling,Le=Te.firstChild;return Le.firstChild,de.style.setProperty("display","grid"),de.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),de.style.setProperty("gap","1rem"),de.style.setProperty("padding","0.75rem"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("background","#fff9f0"),de.style.setProperty("border-radius","var(--border-radius-sm)"),de.style.setProperty("align-items","center"),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("border","1px solid #ffe0b3"),xe.style.setProperty("font-weight","500"),a(xe,()=>ye.accountName),pe.style.setProperty("font-size","0.75rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>$r.getAccountById(ye.accountId)?.accountNumber),_e.style.setProperty("color","var(--text-muted)"),a(_e,()=>ye.description||e("journal.noDescription","No description")),Re.style.setProperty("font-weight","600"),a(Re,(()=>{var Ie=$e(()=>ye.debitAmount>0);return()=>Ie()?E(ye.debitAmount):"-"})()),Ee.style.setProperty("font-weight","600"),a(Ee,(()=>{var Ie=$e(()=>ye.creditAmount>0);return()=>Ie()?E(ye.creditAmount):"-"})()),Te.style.setProperty("color","#f44336"),Le.style.setProperty("font-weight","500"),a(Le,()=>e("journal.pending","Pending"),null),a(Te,(()=>{var Ie=$e(()=>!!["1001","1002","1003"].includes(ye.accountId));return()=>Ie()&&(()=>{var De=vf();return De.style.setProperty("font-size","0.75rem"),De.style.setProperty("font-style","italic"),a(De,()=>e("journal.bankAccount","Bank account")),De})()})(),null),we(Ie=>{var De=ye.debitAmount>0?"#4caf50":"var(--text-muted)",Ye=ye.creditAmount>0?"#f44336":"var(--text-muted)";return De!==Ie.e&&((Ie.e=De)!=null?Re.style.setProperty("color",De):Re.style.removeProperty("color")),Ye!==Ie.t&&((Ie.t=Ye)!=null?Ee.style.setProperty("color",Ye):Ee.style.removeProperty("color")),Ie},{e:void 0,t:void 0}),de})()),null),a(ne,(()=>{var ye=$e(()=>b.lines.filter(de=>!de.reconciled&&["1001","1002","1003"].includes(de.accountId)).length>0);return()=>ye()&&(()=>{var de=uL(),ge=de.firstChild;ge.firstChild;var xe=ge.nextSibling,pe=xe.firstChild;return de.style.setProperty("padding","0.75rem"),de.style.setProperty("background","#ffebee"),de.style.setProperty("border-radius","var(--border-radius-sm)"),de.style.setProperty("margin-top","1rem"),de.style.setProperty("border","1px solid #ffcdd2"),ge.style.setProperty("font-weight","500"),ge.style.setProperty("margin-bottom","0.5rem"),ge.style.setProperty("color","#f44336"),a(ge,()=>e("journal.reconciliationTip","Reconciliation Tip"),null),xe.style.setProperty("font-size","0.875rem"),xe.style.setProperty("color","var(--text-muted)"),a(xe,()=>e("journal.unreconciledBankTransactions","This entry has unreconciled bank account transactions."),pe),a(xe,()=>e("journal.visitBankConsolidations","Visit Bank Consolidations to reconcile these transactions"),null),de})()})(),null),ne})()})(),null),we(V=>(V=b.lines.every(ne=>ne.reconciled)?"#e8f5e8":b.lines.some(ne=>ne.reconciled)?"#fff3cd":"#ffebee")!=null?k.style.setProperty("background",V):k.style.removeProperty("background")),R})()),(()=>{var R=vf();return y(R,Z),a(R,D(ht,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(R,D(ht,{variant:"primary",onClick:B,get children(){return e("journal.editEntry")}}),null),a(R,(()=>{var k=$e(()=>b.status==="draft");return()=>k()&&D(ht,{variant:"outline",onClick:_,disabled:!K,style:{"border-color":"#4caf50",color:K?"#4caf50":"var(--text-muted)"},get children(){return K?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),a(R,(()=>{var k=$e(()=>b.status==="posted");return()=>k()&&D(ht,{variant:"outline",onClick:P,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),R})()]})()}}),$e(()=>$e(()=>!!s())()&&D(L5,{get isOpen(){return i()},onClose:()=>{o(!1)},get editEntry(){return s()}}))]};pr(["click"]);var hL=he("<div><div><h2></h2><p></p></div><div>"),Is=he("<div>"),pL=he("<div> <!>  <!> "),fL=he("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),mL=he("<div><span>:</span><span> "),Hd=he("<span>: "),yL=he("<div><br>");const gL=()=>{const{t}=Zt(),[e,r]=Ce(!1),[n,i]=Ce(!1),[o,s]=Ce(!1),[l,c]=Ce(null),[u,h]=Ce(!1),[m,g]=Ce(null),[f,w]=Ce("all"),[x,S]=Ce("all"),[C,j]=Ce(""),[oe,te]=Ce(""),[Z,re]=Ce("date"),[E,$]=Ce("desc"),T={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},B={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},_={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},P={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},b=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],H=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...$r.accounts.map(I=>({value:I.id,label:`${I.accountNumber} - ${I.name}`}))],K=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],R=()=>{let I=Do.journalEntries;return f()!=="all"&&(I=I.filter(F=>F.status===f())),x()!=="all"&&(I=I.filter(F=>F.lines.some(X=>X.accountId===x()))),C()&&(I=I.filter(F=>F.date>=C())),oe()&&(I=I.filter(F=>F.date<=oe())),I=[...I].sort((F,X)=>{let Y=0;switch(Z()){case"date":Y=new Date(F.date).getTime()-new Date(X.date).getTime();break;case"entryNumber":Y=F.entryNumber.localeCompare(X.entryNumber);break;case"amount":Y=F.totalDebit-X.totalDebit;break}return E()==="asc"?Y:-Y}),I},k=()=>{const I=Do.journalEntries,F=I.filter(ne=>ne.status==="draft"),X=I.filter(ne=>ne.status==="posted"),Y=I.filter(ne=>ne.status==="void"),Q=X.reduce((ne,ee)=>ne+ee.totalDebit,0),J=X.reduce((ne,ee)=>ne+ee.totalCredit,0),V=I.filter(ne=>ne.lines.some(ee=>["1001","1002","1003"].includes(ee.accountId)&&!ee.reconciled)).length;return{totalEntries:I.length,draftEntries:F.length,postedEntries:X.length,voidEntries:Y.length,totalDebit:Q,totalCredit:J,unreconciledEntries:V}},W=I=>{g(I.id),h(!0)},z=()=>{c(null),r(!0)},U=()=>{i(!0)},le=()=>{r(!1),c(null)},L=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),M=k(),G=R();return D(lo,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var I=hL(),F=I.firstChild,X=F.firstChild,Y=X.nextSibling,Q=F.nextSibling;return y(I,T),X.style.setProperty("margin","0 0 0.5rem 0"),X.style.setProperty("font-size","1.5rem"),a(X,()=>t("journal.title")),Y.style.setProperty("margin","0"),Y.style.setProperty("color","var(--text-muted)"),a(Y,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),Q.style.setProperty("display","flex"),Q.style.setProperty("gap","1rem"),a(Q,D(ht,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),a(Q,D(ht,{variant:"outline",onClick:U,style:{background:"#4caf50",color:"white","border-color":"#4caf50"},get children(){return[" ",$e(()=>t("journal.quickEntry","Quick Entry"))]}}),null),a(Q,D(ht,{variant:"outline",onClick:()=>s(!0),get title(){return t("journal.manageTemplates","Manage Templates")},get children(){return[" ",$e(()=>t("journal.templates","Templates"))]}}),null),a(Q,D(ht,{variant:"primary",onClick:z,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),I})(),(()=>{var I=Is();return y(I,_),a(I,D(Dt,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var F=Is();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","var(--primary-color)"),F.style.setProperty("margin-bottom","0.5rem"),a(F,()=>M.totalEntries),F})(),(()=>{var F=pL(),X=F.firstChild,Y=X.nextSibling,Q=Y.nextSibling,J=Q.nextSibling;return J.nextSibling,F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),a(F,()=>M.postedEntries,X),a(F,()=>t("journal.posted").toLowerCase(),Y),a(F,()=>M.draftEntries,J),a(F,()=>t("journal.draft").toLowerCase(),null),a(F,(()=>{var V=$e(()=>M.voidEntries>0);return()=>V()&&`  ${M.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),F})()]}}),null),a(I,D(Dt,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var F=Is();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","#4caf50"),F.style.setProperty("margin-bottom","0.5rem"),a(F,()=>L(M.totalDebit)),F})(),(()=>{var F=Is();return F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),a(F,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",M.postedEntries.toString())),F})()]}}),null),a(I,D(Dt,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var F=Is();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","#f44336"),F.style.setProperty("margin-bottom","0.5rem"),a(F,()=>L(M.totalCredit)),F})(),(()=>{var F=Is();return F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),a(F,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",M.postedEntries.toString())),F})()]}}),null),a(I,D(Dt,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var F=Is();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("margin-bottom","0.5rem"),a(F,()=>M.unreconciledEntries),we(X=>(X=M.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?F.style.setProperty("color",X):F.style.removeProperty("color")),F})(),(()=>{var F=Is();return F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),a(F,(()=>{var X=$e(()=>M.unreconciledEntries>0);return()=>X()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),F})()]}}),null),I})(),(()=>{var I=fL(),F=I.firstChild,X=F.firstChild,Y=F.nextSibling,Q=Y.firstChild,J=Y.nextSibling,V=J.firstChild,ne=J.nextSibling,ee=ne.firstChild,ce=ee.nextSibling,se=ne.nextSibling,q=se.firstChild,ue=q.nextSibling,ye=se.nextSibling,de=ye.firstChild,ge=ye.nextSibling;return y(I,B),F.style.setProperty("min-width","150px"),X.style.setProperty("display","block"),X.style.setProperty("margin-bottom","0.5rem"),X.style.setProperty("font-weight","500"),X.style.setProperty("font-size","0.875rem"),a(X,()=>t("common.status")),a(F,D(An,{label:"",get value(){return f()},onChange:w,get options(){return b()}}),null),Y.style.setProperty("min-width","200px"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("font-weight","500"),Q.style.setProperty("font-size","0.875rem"),a(Q,()=>t("journal.account")),a(Y,D(An,{label:"",get value(){return x()},onChange:S,get options(){return H()}}),null),J.style.setProperty("min-width","120px"),V.style.setProperty("display","block"),V.style.setProperty("margin-bottom","0.5rem"),V.style.setProperty("font-weight","500"),V.style.setProperty("font-size","0.875rem"),a(V,()=>t("entryBooks.sortBy","Sort By")),a(J,D(An,{label:"",get value(){return Z()},onChange:re,get options(){return K()}}),null),ne.style.setProperty("min-width","130px"),ee.style.setProperty("display","block"),ee.style.setProperty("margin-bottom","0.5rem"),ee.style.setProperty("font-weight","500"),ee.style.setProperty("font-size","0.875rem"),a(ee,()=>t("entryBooks.fromDate","From Date")),ce.addEventListener("change",xe=>j(xe.target.value)),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("font-family","inherit"),ce.style.setProperty("width","100%"),se.style.setProperty("min-width","130px"),q.style.setProperty("display","block"),q.style.setProperty("margin-bottom","0.5rem"),q.style.setProperty("font-weight","500"),q.style.setProperty("font-size","0.875rem"),a(q,()=>t("entryBooks.toDate","To Date")),ue.addEventListener("change",xe=>te(xe.target.value)),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("font-family","inherit"),ue.style.setProperty("width","100%"),ye.style.setProperty("min-width","100px"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),de.style.setProperty("font-size","0.875rem"),a(de,()=>t("entryBooks.order","Order")),a(ye,D(An,{label:"",get value(){return E()},onChange:$,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),ge.style.setProperty("display","flex"),ge.style.setProperty("align-items","end"),ge.style.setProperty("gap","0.5rem"),a(ge,D(ht,{variant:"outline",size:"sm",onClick:()=>{w("all"),S("all"),j(""),te(""),re("date"),$("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),we(()=>ce.value=C()),we(()=>ue.value=oe()),I})(),$e(()=>$e(()=>!!(f()!=="all"||x()!=="all"||C()||oe()))()&&(()=>{var I=mL(),F=I.firstChild,X=F.firstChild,Y=F.nextSibling,Q=Y.firstChild;return I.style.setProperty("display","flex"),I.style.setProperty("gap","0.5rem"),I.style.setProperty("align-items","center"),I.style.setProperty("margin-bottom","1rem"),I.style.setProperty("padding","0.75rem"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("border","1px solid var(--border-color)"),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("font-weight","500"),a(F,()=>t("entryBooks.activeFilters","Active filters"),X),a(I,(()=>{var J=$e(()=>f()!=="all");return()=>J()&&(()=>{var V=Hd(),ne=V.firstChild;return V.style.setProperty("padding","0.25rem 0.5rem"),V.style.setProperty("background","var(--primary-color)"),V.style.setProperty("color","white"),V.style.setProperty("border-radius","12px"),V.style.setProperty("font-size","0.75rem"),a(V,()=>t("common.status"),ne),a(V,f,null),V})()})(),Y),a(I,(()=>{var J=$e(()=>x()!=="all");return()=>J()&&(()=>{var V=Hd(),ne=V.firstChild;return V.style.setProperty("padding","0.25rem 0.5rem"),V.style.setProperty("background","var(--primary-color)"),V.style.setProperty("color","white"),V.style.setProperty("border-radius","12px"),V.style.setProperty("font-size","0.75rem"),a(V,()=>t("journal.account"),ne),a(V,()=>$r.getAccountById(x())?.name||t("common.unknown","Unknown"),null),V})()})(),Y),a(I,(()=>{var J=$e(()=>!!C());return()=>J()&&(()=>{var V=Hd(),ne=V.firstChild;return V.style.setProperty("padding","0.25rem 0.5rem"),V.style.setProperty("background","var(--primary-color)"),V.style.setProperty("color","white"),V.style.setProperty("border-radius","12px"),V.style.setProperty("font-size","0.75rem"),a(V,()=>t("entryBooks.from","From"),ne),a(V,C,null),V})()})(),Y),a(I,(()=>{var J=$e(()=>!!oe());return()=>J()&&(()=>{var V=Hd(),ne=V.firstChild;return V.style.setProperty("padding","0.25rem 0.5rem"),V.style.setProperty("background","var(--primary-color)"),V.style.setProperty("color","white"),V.style.setProperty("border-radius","12px"),V.style.setProperty("font-size","0.75rem"),a(V,()=>t("entryBooks.to","To"),ne),a(V,oe,null),V})()})(),Y),Y.style.setProperty("margin-left","auto"),Y.style.setProperty("font-size","0.875rem"),Y.style.setProperty("color","var(--text-muted)"),a(Y,()=>G.length,Q),a(Y,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",G.length.toString()),null),I})()),$e(()=>$e(()=>G.length===0)()?D(Dt,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var I=yL(),F=I.firstChild;return I.style.setProperty("text-align","center"),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("padding","2rem"),a(I,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),F),a(I,D(ht,{variant:"primary",style:{"margin-top":"1rem"},onClick:z,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),I}}):(()=>{var I=Is();return y(I,P),a(I,D(zt,{each:G,children:F=>D(x6,{entry:F,onViewDetails:W})})),I})()),D(L5,{get isOpen(){return e()},onClose:le,get editEntry(){return l()}}),D(V6,{get isOpen(){return n()},onClose:()=>i(!1)}),D(W6,{get isOpen(){return o()},onClose:()=>s(!1)}),D(dL,{get isOpen(){return u()},onClose:()=>{h(!1),g(null)},get entryId(){return m()}})]}})};function rn(t){"@babel/helpers - typeof";return rn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rn(t)}var Ii=Uint8Array,ao=Uint16Array,Uy=Int32Array,mp=new Ii([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),yp=new Ii([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Pm=new Ii([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),D5=function(t,e){for(var r=new ao(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new Uy(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)i[o]=o-r[n]<<5|n;return{b:r,r:i}},M5=D5(mp,2),F5=M5.b,wm=M5.r;F5[28]=258,wm[258]=28;var O5=D5(yp,0),vL=O5.b,O0=O5.r,xm=new ao(32768);for(var mn=0;mn<32768;++mn){var ma=(mn&43690)>>1|(mn&21845)<<1;ma=(ma&52428)>>2|(ma&13107)<<2,ma=(ma&61680)>>4|(ma&3855)<<4,xm[mn]=((ma&65280)>>8|(ma&255)<<8)>>1}var cs=function(t,e,r){for(var n=t.length,i=0,o=new ao(e);i<n;++i)t[i]&&++o[t[i]-1];var s=new ao(e);for(i=1;i<e;++i)s[i]=s[i-1]+o[i-1]<<1;var l;if(r){l=new ao(1<<e);var c=15-e;for(i=0;i<n;++i)if(t[i])for(var u=i<<4|t[i],h=e-t[i],m=s[t[i]-1]++<<h,g=m|(1<<h)-1;m<=g;++m)l[xm[m]>>c]=u}else for(l=new ao(n),i=0;i<n;++i)t[i]&&(l[i]=xm[s[t[i]-1]++]>>15-t[i]);return l},Oa=new Ii(288);for(var mn=0;mn<144;++mn)Oa[mn]=8;for(var mn=144;mn<256;++mn)Oa[mn]=9;for(var mn=256;mn<280;++mn)Oa[mn]=7;for(var mn=280;mn<288;++mn)Oa[mn]=8;var Vu=new Ii(32);for(var mn=0;mn<32;++mn)Vu[mn]=5;var bL=cs(Oa,9,0),_L=cs(Oa,9,1),SL=cs(Vu,5,0),PL=cs(Vu,5,1),_f=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},To=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Sf=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Hy=function(t){return(t+7)/8|0},B5=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new Ii(t.subarray(e,r))},wL=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Lo=function(t,e,r){var n=new Error(e||wL[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,Lo),!r)throw n;return n},xL=function(t,e,r,n){var i=t.length,o=0;if(!i||e.f&&!e.l)return r||new Ii(0);var s=!r,l=s||e.i!=2,c=e.i;s&&(r=new Ii(i*3));var u=function(V){var ne=r.length;if(V>ne){var ee=new Ii(Math.max(ne*2,V));ee.set(r),r=ee}},h=e.f||0,m=e.p||0,g=e.b||0,f=e.l,w=e.d,x=e.m,S=e.n,C=i*8;do{if(!f){h=To(t,m,1);var j=To(t,m+1,3);if(m+=3,j)if(j==1)f=_L,w=PL,x=9,S=5;else if(j==2){var re=To(t,m,31)+257,E=To(t,m+10,15)+4,$=re+To(t,m+5,31)+1;m+=14;for(var T=new Ii($),B=new Ii(19),_=0;_<E;++_)B[Pm[_]]=To(t,m+_*3,7);m+=E*3;for(var P=_f(B),b=(1<<P)-1,H=cs(B,P,1),_=0;_<$;){var K=H[To(t,m,b)];m+=K&15;var oe=K>>4;if(oe<16)T[_++]=oe;else{var R=0,k=0;for(oe==16?(k=3+To(t,m,3),m+=2,R=T[_-1]):oe==17?(k=3+To(t,m,7),m+=3):oe==18&&(k=11+To(t,m,127),m+=7);k--;)T[_++]=R}}var W=T.subarray(0,re),z=T.subarray(re);x=_f(W),S=_f(z),f=cs(W,x,1),w=cs(z,S,1)}else Lo(1);else{var oe=Hy(m)+4,te=t[oe-4]|t[oe-3]<<8,Z=oe+te;if(Z>i){c&&Lo(0);break}l&&u(g+te),r.set(t.subarray(oe,Z),g),e.b=g+=te,e.p=m=Z*8,e.f=h;continue}if(m>C){c&&Lo(0);break}}l&&u(g+131072);for(var U=(1<<x)-1,le=(1<<S)-1,L=m;;L=m){var R=f[Sf(t,m)&U],M=R>>4;if(m+=R&15,m>C){c&&Lo(0);break}if(R||Lo(2),M<256)r[g++]=M;else if(M==256){L=m,f=null;break}else{var G=M-254;if(M>264){var _=M-257,I=mp[_];G=To(t,m,(1<<I)-1)+F5[_],m+=I}var F=w[Sf(t,m)&le],X=F>>4;F||Lo(3),m+=F&15;var z=vL[X];if(X>3){var I=yp[X];z+=Sf(t,m)&(1<<I)-1,m+=I}if(m>C){c&&Lo(0);break}l&&u(g+131072);var Y=g+G;if(g<z){var Q=o-z,J=Math.min(z,Y);for(Q+g<0&&Lo(3);g<J;++g)r[g]=n[Q+g]}for(;g<Y;++g)r[g]=r[g-z]}}e.l=f,e.p=L,e.b=g,e.f=h,f&&(h=1,e.m=x,e.d=w,e.n=S)}while(!h);return g!=r.length&&s?B5(r,0,g):r.subarray(0,g)},$s=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},nu=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},Pf=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,o=r.slice();if(!i)return{t:V5,l:0};if(i==1){var s=new Ii(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(Z,re){return Z.f-re.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,h=1,m=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};h!=i-1;)l=r[r[u].f<r[m].f?u++:m++],c=r[u!=h&&r[u].f<r[m].f?u++:m++],r[h++]={s:-1,f:l.f+c.f,l,r:c};for(var g=o[0].s,n=1;n<i;++n)o[n].s>g&&(g=o[n].s);var f=new ao(g+1),w=Am(r[h-1],f,0);if(w>e){var n=0,x=0,S=w-e,C=1<<S;for(o.sort(function(re,E){return f[E.s]-f[re.s]||re.f-E.f});n<i;++n){var j=o[n].s;if(f[j]>e)x+=C-(1<<w-f[j]),f[j]=e;else break}for(x>>=S;x>0;){var oe=o[n].s;f[oe]<e?x-=1<<e-f[oe]++-1:++n}for(;n>=0&&x;--n){var te=o[n].s;f[te]==e&&(--f[te],++x)}w=e}return{t:new Ii(f),l:w}},Am=function(t,e,r){return t.s==-1?Math.max(Am(t.l,e,r+1),Am(t.r,e,r+1)):e[t.s]=r},B0=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new ao(++e),n=0,i=t[0],o=1,s=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==i&&l!=e)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=t[l]}return{c:r.subarray(0,n),n:e}},iu=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},j5=function(t,e,r){var n=r.length,i=Hy(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var o=0;o<n;++o)t[i+o+4]=r[o];return(i+4+n)*8},j0=function(t,e,r,n,i,o,s,l,c,u,h){$s(e,h++,r),++i[256];for(var m=Pf(i,15),g=m.t,f=m.l,w=Pf(o,15),x=w.t,S=w.l,C=B0(g),j=C.c,oe=C.n,te=B0(x),Z=te.c,re=te.n,E=new ao(19),$=0;$<j.length;++$)++E[j[$]&31];for(var $=0;$<Z.length;++$)++E[Z[$]&31];for(var T=Pf(E,7),B=T.t,_=T.l,P=19;P>4&&!B[Pm[P-1]];--P);var b=u+5<<3,H=iu(i,Oa)+iu(o,Vu)+s,K=iu(i,g)+iu(o,x)+s+14+3*P+iu(E,B)+2*E[16]+3*E[17]+7*E[18];if(c>=0&&b<=H&&b<=K)return j5(e,h,t.subarray(c,c+u));var R,k,W,z;if($s(e,h,1+(K<H)),h+=2,K<H){R=cs(g,f,0),k=g,W=cs(x,S,0),z=x;var U=cs(B,_,0);$s(e,h,oe-257),$s(e,h+5,re-1),$s(e,h+10,P-4),h+=14;for(var $=0;$<P;++$)$s(e,h+3*$,B[Pm[$]]);h+=3*P;for(var le=[j,Z],L=0;L<2;++L)for(var M=le[L],$=0;$<M.length;++$){var G=M[$]&31;$s(e,h,U[G]),h+=B[G],G>15&&($s(e,h,M[$]>>5&127),h+=M[$]>>12)}}else R=bL,k=Oa,W=SL,z=Vu;for(var $=0;$<l;++$){var I=n[$];if(I>255){var G=I>>18&31;nu(e,h,R[G+257]),h+=k[G+257],G>7&&($s(e,h,I>>23&31),h+=mp[G]);var F=I&31;nu(e,h,W[F]),h+=z[F],F>3&&(nu(e,h,I>>5&8191),h+=yp[F])}else nu(e,h,R[I]),h+=k[I]}return nu(e,h,R[256]),h+k[256]},AL=new Uy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),V5=new Ii(0),CL=function(t,e,r,n,i,o){var s=o.z||t.length,l=new Ii(n+s+5*(1+Math.ceil(s/7e3))+i),c=l.subarray(n,l.length-i),u=o.l,h=(o.r||0)&7;if(e){h&&(c[0]=o.r>>3);for(var m=AL[e-1],g=m>>13,f=m&8191,w=(1<<r)-1,x=o.p||new ao(32768),S=o.h||new ao(w+1),C=Math.ceil(r/3),j=2*C,oe=function(ce){return(t[ce]^t[ce+1]<<C^t[ce+2]<<j)&w},te=new Uy(25e3),Z=new ao(288),re=new ao(32),E=0,$=0,T=o.i||0,B=0,_=o.w||0,P=0;T+2<s;++T){var b=oe(T),H=T&32767,K=S[b];if(x[H]=K,S[b]=H,_<=T){var R=s-T;if((E>7e3||B>24576)&&(R>423||!u)){h=j0(t,c,0,te,Z,re,$,B,P,T-P,h),B=E=$=0,P=T;for(var k=0;k<286;++k)Z[k]=0;for(var k=0;k<30;++k)re[k]=0}var W=2,z=0,U=f,le=H-K&32767;if(R>2&&b==oe(T-le))for(var L=Math.min(g,R)-1,M=Math.min(32767,T),G=Math.min(258,R);le<=M&&--U&&H!=K;){if(t[T+W]==t[T+W-le]){for(var I=0;I<G&&t[T+I]==t[T+I-le];++I);if(I>W){if(W=I,z=le,I>L)break;for(var F=Math.min(le,I-2),X=0,k=0;k<F;++k){var Y=T-le+k&32767,Q=x[Y],J=Y-Q&32767;J>X&&(X=J,K=Y)}}}H=K,K=x[H],le+=H-K&32767}if(z){te[B++]=268435456|wm[W]<<18|O0[z];var V=wm[W]&31,ne=O0[z]&31;$+=mp[V]+yp[ne],++Z[257+V],++re[ne],_=T+W,++E}else te[B++]=t[T],++Z[t[T]]}}for(T=Math.max(T,_);T<s;++T)te[B++]=t[T],++Z[t[T]];h=j0(t,c,u,te,Z,re,$,B,P,T-P,h),u||(o.r=h&7|c[h/8|0]<<3,h-=7,o.h=S,o.p=x,o.i=T,o.w=_)}else{for(var T=o.w||0;T<s+u;T+=65535){var ee=T+65535;ee>=s&&(c[h/8|0]=u,ee=s),h=j5(c,h+1,t.subarray(T,ee))}o.i=s}return B5(l,0,n+Hy(h)+i)},q5=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,o=r.length|0,s=0;s!=o;){for(var l=Math.min(s+2655,o);s<l;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},IL=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),s=new Ii(o.length+t.length);s.set(o),s.set(t,o.length),t=s,i.w=o.length}return CL(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},z5=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},$L=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=q5();i.p(e.dictionary),z5(t,2,i.d())}},EL=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Lo(6,"invalid zlib data"),(t[1]>>5&1)==1&&Lo(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Cm(t,e){e||(e={});var r=q5();r.p(t);var n=IL(t,e,e.dictionary?6:2,4);return $L(n,e),z5(n,n.length-4,r.d()),n}function TL(t,e){return xL(t.subarray(EL(t),-4),{i:2},e,e)}var kL=typeof TextDecoder<"u"&&new TextDecoder,NL=0;try{kL.decode(V5,{stream:!0}),NL=1}catch{}var dr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function wf(){dr.console&&typeof dr.console.log=="function"&&dr.console.log.apply(dr.console,arguments)}var ln={log:wf,warn:function(t){dr.console&&(typeof dr.console.warn=="function"?dr.console.warn.apply(dr.console,arguments):wf.call(null,arguments))},error:function(t){dr.console&&(typeof dr.console.error=="function"?dr.console.error.apply(dr.console,arguments):wf(t))}};function xf(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){cl(n.response,e,r)},n.onerror=function(){ln.error("could not download file")},n.send()}function V0(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Gd(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var _u,Im,cl=dr.saveAs||((typeof window>"u"?"undefined":rn(window))!=="object"||window!==dr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=dr.URL||dr.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?V0(i.href)?xf(t,e,r):Gd(i,i.target="_blank"):Gd(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){Gd(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(V0(t))xf(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){Gd(n)})}else navigator.msSaveOrOpenBlob(function(i,o){return o===void 0?o={autoBom:!1}:rn(o)!=="object"&&(ln.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return xf(t,e,r);var i=t.type==="application/octet-stream",o=/constructor/i.test(dr.HTMLElement)||dr.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&o)&&(typeof FileReader>"u"?"undefined":rn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var h=l.result;h=s?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=h:location=h,n=null},l.readAsDataURL(t)}else{var c=dr.URL||dr.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function U5(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,o=r[n].process,s=i.exec(t);s&&(e=o(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Af(t,e){var r=t[0],n=t[1],i=t[2],o=t[3];r=bi(r,n,i,o,e[0],7,-680876936),o=bi(o,r,n,i,e[1],12,-389564586),i=bi(i,o,r,n,e[2],17,606105819),n=bi(n,i,o,r,e[3],22,-1044525330),r=bi(r,n,i,o,e[4],7,-176418897),o=bi(o,r,n,i,e[5],12,1200080426),i=bi(i,o,r,n,e[6],17,-1473231341),n=bi(n,i,o,r,e[7],22,-45705983),r=bi(r,n,i,o,e[8],7,1770035416),o=bi(o,r,n,i,e[9],12,-1958414417),i=bi(i,o,r,n,e[10],17,-42063),n=bi(n,i,o,r,e[11],22,-1990404162),r=bi(r,n,i,o,e[12],7,1804603682),o=bi(o,r,n,i,e[13],12,-40341101),i=bi(i,o,r,n,e[14],17,-1502002290),r=_i(r,n=bi(n,i,o,r,e[15],22,1236535329),i,o,e[1],5,-165796510),o=_i(o,r,n,i,e[6],9,-1069501632),i=_i(i,o,r,n,e[11],14,643717713),n=_i(n,i,o,r,e[0],20,-373897302),r=_i(r,n,i,o,e[5],5,-701558691),o=_i(o,r,n,i,e[10],9,38016083),i=_i(i,o,r,n,e[15],14,-660478335),n=_i(n,i,o,r,e[4],20,-405537848),r=_i(r,n,i,o,e[9],5,568446438),o=_i(o,r,n,i,e[14],9,-1019803690),i=_i(i,o,r,n,e[3],14,-187363961),n=_i(n,i,o,r,e[8],20,1163531501),r=_i(r,n,i,o,e[13],5,-1444681467),o=_i(o,r,n,i,e[2],9,-51403784),i=_i(i,o,r,n,e[7],14,1735328473),r=Si(r,n=_i(n,i,o,r,e[12],20,-1926607734),i,o,e[5],4,-378558),o=Si(o,r,n,i,e[8],11,-2022574463),i=Si(i,o,r,n,e[11],16,1839030562),n=Si(n,i,o,r,e[14],23,-35309556),r=Si(r,n,i,o,e[1],4,-1530992060),o=Si(o,r,n,i,e[4],11,1272893353),i=Si(i,o,r,n,e[7],16,-155497632),n=Si(n,i,o,r,e[10],23,-1094730640),r=Si(r,n,i,o,e[13],4,681279174),o=Si(o,r,n,i,e[0],11,-358537222),i=Si(i,o,r,n,e[3],16,-722521979),n=Si(n,i,o,r,e[6],23,76029189),r=Si(r,n,i,o,e[9],4,-640364487),o=Si(o,r,n,i,e[12],11,-421815835),i=Si(i,o,r,n,e[15],16,530742520),r=Pi(r,n=Si(n,i,o,r,e[2],23,-995338651),i,o,e[0],6,-198630844),o=Pi(o,r,n,i,e[7],10,1126891415),i=Pi(i,o,r,n,e[14],15,-1416354905),n=Pi(n,i,o,r,e[5],21,-57434055),r=Pi(r,n,i,o,e[12],6,1700485571),o=Pi(o,r,n,i,e[3],10,-1894986606),i=Pi(i,o,r,n,e[10],15,-1051523),n=Pi(n,i,o,r,e[1],21,-2054922799),r=Pi(r,n,i,o,e[8],6,1873313359),o=Pi(o,r,n,i,e[15],10,-30611744),i=Pi(i,o,r,n,e[6],15,-1560198380),n=Pi(n,i,o,r,e[13],21,1309151649),r=Pi(r,n,i,o,e[4],6,-145523070),o=Pi(o,r,n,i,e[11],10,-1120210379),i=Pi(i,o,r,n,e[2],15,718787259),n=Pi(n,i,o,r,e[9],21,-343485551),t[0]=wa(r,t[0]),t[1]=wa(n,t[1]),t[2]=wa(i,t[2]),t[3]=wa(o,t[3])}function gp(t,e,r,n,i,o){return e=wa(wa(e,t),wa(n,o)),wa(e<<i|e>>>32-i,r)}function bi(t,e,r,n,i,o,s){return gp(e&r|~e&n,t,e,i,o,s)}function _i(t,e,r,n,i,o,s){return gp(e&n|r&~n,t,e,i,o,s)}function Si(t,e,r,n,i,o,s){return gp(e^r^n,t,e,i,o,s)}function Pi(t,e,r,n,i,o,s){return gp(r^(e|~n),t,e,i,o,s)}function H5(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)Af(n,LL(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(Af(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,Af(n,i),n}function LL(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}_u=dr.atob.bind(dr),Im=dr.btoa.bind(dr);var q0="0123456789abcdef".split("");function RL(t){for(var e="",r=0;r<4;r++)e+=q0[t>>8*r+4&15]+q0[t>>8*r&15];return e}function DL(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function $m(t){return H5(t).map(DL).join("")}var ML=function(t){for(var e=0;e<t.length;e++)t[e]=RL(t[e]);return t.join("")}(H5("hello"))!="5d41402abc4b2a76b9719d911017c592";function wa(t,e){if(ML){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Em(t,e){var r,n,i,o;if(t!==r){for(var s=(i=t,o=1+(256/t.length>>0),new Array(o+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var h=l[c];u=(u+h+s.charCodeAt(c))%256,l[c]=l[u],l[u]=h}r=t,n=l}else l=n;var m=e.length,g=0,f=0,w="";for(c=0;c<m;c++)f=(f+(h=l[g=(g+1)%256]))%256,l[g]=l[f],l[f]=h,s=l[(l[g]+l[f])%256],w+=String.fromCharCode(e.charCodeAt(c)^s);return w}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var z0={print:4,modify:8,copy:16,"annot-forms":32};function uc(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(l){if(z0.perm!==void 0)throw new Error("Invalid permission: "+l);i+=z0[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var o=(e+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,s),this.P=-(1+(255^i)),this.encryptionKey=$m(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Em(this.encryptionKey,this.padding)}function dc(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?e+="#"+("0"+i.toString(16)).slice(-2):e+=t[n]}return e}function U0(t){if(rn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var o=Math.random().toString(35);return e[r][o]=[n,!!i],o},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var o in e[r]){var s=e[r][o];try{s[0].apply(t,n)}catch(l){dr.console&&ln.error("jsPDF PubSub Error",l.message,l)}s[1]&&i.push(o)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function qu(t){if(!(this instanceof qu))return new qu(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function G5(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function Sa(t,e,r,n,i){if(!(this instanceof Sa))return new Sa(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,G5.call(this,n,i)}function gl(t,e,r,n,i){if(!(this instanceof gl))return new gl(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,G5.call(this,n,i)}function sr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],o=arguments[3],s=[],l=1,c=16,u="S",h=null;rn(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,o=t.compress||t.compressPdf||o,(h=t.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),s=t.filters||(o===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var m=t.putOnlyUsedFonts||!1,g={},f={internal:{},__private__:{}};f.__private__.PubSub=U0;var w="1.3",x=f.__private__.getPdfVersion=function(){return w};f.__private__.setPdfVersion=function(A){w=A};var S={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return S};var C=f.__private__.getPageFormat=function(A){return S[A]};i=i||"a4";var j={COMPAT:"compat",ADVANCED:"advanced"},oe=j.COMPAT;function te(){this.saveGraphicsState(),q(new tt(Be,0,0,-Be,0,gi()*Be).toString()+" cm"),this.setFontSize(this.getFontSize()/Be),u="n",oe=j.ADVANCED}function Z(){this.restoreGraphicsState(),u="S",oe=j.COMPAT}var re=f.__private__.combineFontStyleAndFontWeight=function(A,fe){if(A=="bold"&&fe=="normal"||A=="bold"&&fe==400||A=="normal"&&fe=="italic"||A=="bold"&&fe=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return fe&&(A=fe==400||fe==="normal"?A==="italic"?"italic":"normal":fe!=700&&fe!=="bold"||A!=="normal"?(fe==700?"bold":fe)+""+A:"bold"),A};f.advancedAPI=function(A){var fe=oe===j.COMPAT;return fe&&te.call(this),typeof A!="function"||(A(this),fe&&Z.call(this)),this},f.compatAPI=function(A){var fe=oe===j.ADVANCED;return fe&&Z.call(this),typeof A!="function"||(A(this),fe&&te.call(this)),this},f.isAdvancedAPI=function(){return oe===j.ADVANCED};var E,$=function(A){if(oe!==j.ADVANCED)throw new Error(A+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},T=f.roundToPrecision=f.__private__.roundToPrecision=function(A,fe){var Ne=e||fe;if(isNaN(A)||isNaN(Ne))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return A.toFixed(Ne).replace(/0+$/,"")};E=f.hpf=f.__private__.hpf=typeof c=="number"?function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return T(A,c)}:c==="smart"?function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return T(A,A>-1&&A<1?16:5)}:function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return T(A,16)};var B=f.f2=f.__private__.f2=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.f2");return T(A,2)},_=f.__private__.f3=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.f3");return T(A,3)},P=f.scale=f.__private__.scale=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.scale");return oe===j.COMPAT?A*Be:oe===j.ADVANCED?A:void 0},b=function(A){return oe===j.COMPAT?gi()-A:oe===j.ADVANCED?A:void 0},H=function(A){return P(b(A))};f.__private__.setPrecision=f.setPrecision=function(A){typeof parseInt(A,10)=="number"&&(e=parseInt(A,10))};var K,R="00000000000000000000000000000000",k=f.__private__.getFileId=function(){return R},W=f.__private__.setFileId=function(A){return R=A!==void 0&&/^[a-fA-F0-9]{32}$/.test(A)?A.toUpperCase():R.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(Rr=new uc(h.userPermissions,h.userPassword,h.ownerPassword,R)),R};f.setFileId=function(A){return W(A),this},f.getFileId=function(){return k()};var z=f.__private__.convertDateToPDFDate=function(A){var fe=A.getTimezoneOffset(),Ne=fe<0?"+":"-",Me=Math.floor(Math.abs(fe/60)),qe=Math.abs(fe%60),it=[Ne,G(Me),"'",G(qe),"'"].join("");return["D:",A.getFullYear(),G(A.getMonth()+1),G(A.getDate()),G(A.getHours()),G(A.getMinutes()),G(A.getSeconds()),it].join("")},U=f.__private__.convertPDFDateToDate=function(A){var fe=parseInt(A.substr(2,4),10),Ne=parseInt(A.substr(6,2),10)-1,Me=parseInt(A.substr(8,2),10),qe=parseInt(A.substr(10,2),10),it=parseInt(A.substr(12,2),10),Pt=parseInt(A.substr(14,2),10);return new Date(fe,Ne,Me,qe,it,Pt,0)},le=f.__private__.setCreationDate=function(A){var fe;if(A===void 0&&(A=new Date),A instanceof Date)fe=z(A);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(A))throw new Error("Invalid argument passed to jsPDF.setCreationDate");fe=A}return K=fe},L=f.__private__.getCreationDate=function(A){var fe=K;return A==="jsDate"&&(fe=U(K)),fe};f.setCreationDate=function(A){return le(A),this},f.getCreationDate=function(A){return L(A)};var M,G=f.__private__.padd2=function(A){return("0"+parseInt(A)).slice(-2)},I=f.__private__.padd2Hex=function(A){return("00"+(A=A.toString())).substr(A.length)},F=0,X=[],Y=[],Q=0,J=[],V=[],ne=!1,ee=Y,ce=function(){F=0,Q=0,Y=[],X=[],J=[],et=lt(),Vt=lt()};f.__private__.setCustomOutputDestination=function(A){ne=!0,ee=A};var se=function(A){ne||(ee=A)};f.__private__.resetCustomOutputDestination=function(){ne=!1,ee=Y};var q=f.__private__.out=function(A){return A=A.toString(),Q+=A.length+1,ee.push(A),ee},ue=f.__private__.write=function(A){return q(arguments.length===1?A.toString():Array.prototype.join.call(arguments," "))},ye=f.__private__.getArrayBuffer=function(A){for(var fe=A.length,Ne=new ArrayBuffer(fe),Me=new Uint8Array(Ne);fe--;)Me[fe]=A.charCodeAt(fe);return Ne},de=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return de};var ge=t.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(A){return ge=oe===j.ADVANCED?A/Be:A,this};var xe,pe=f.__private__.getFontSize=f.getFontSize=function(){return oe===j.COMPAT?ge:ge*Be},_e=t.R2L||!1;f.__private__.setR2L=f.setR2L=function(A){return _e=A,this},f.__private__.getR2L=f.getR2L=function(){return _e};var Re,Ee=f.__private__.setZoomMode=function(A){var fe=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(A))xe=A;else if(isNaN(A)){if(fe.indexOf(A)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+A+'" is not recognized.');xe=A}else xe=parseInt(A,10)};f.__private__.getZoomMode=function(){return xe};var Te,Le=f.__private__.setPageMode=function(A){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(A)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+A+'" is not recognized.');Re=A};f.__private__.getPageMode=function(){return Re};var Ie=f.__private__.setLayoutMode=function(A){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(A)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+A+'" is not recognized.');Te=A};f.__private__.getLayoutMode=function(){return Te},f.__private__.setDisplayMode=f.setDisplayMode=function(A,fe,Ne){return Ee(A),Ie(fe),Le(Ne),this};var De={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(A){if(Object.keys(De).indexOf(A)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return De[A]},f.__private__.getDocumentProperties=function(){return De},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(A){for(var fe in De)De.hasOwnProperty(fe)&&A[fe]&&(De[fe]=A[fe]);return this},f.__private__.setDocumentProperty=function(A,fe){if(Object.keys(De).indexOf(A)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return De[A]=fe};var Ye,Be,We,Ke,st,nt={},He={},mt=[],ut={},at={},It={},Xe={},kt=null,Tt=0,wt=[],Rt=new U0(f),fr=t.hotfixes||[],ze={},Ct={},xt=[],tt=function A(fe,Ne,Me,qe,it,Pt){if(!(this instanceof A))return new A(fe,Ne,Me,qe,it,Pt);isNaN(fe)&&(fe=1),isNaN(Ne)&&(Ne=0),isNaN(Me)&&(Me=0),isNaN(qe)&&(qe=1),isNaN(it)&&(it=0),isNaN(Pt)&&(Pt=0),this._matrix=[fe,Ne,Me,qe,it,Pt]};Object.defineProperty(tt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(A){this._matrix[0]=A}}),Object.defineProperty(tt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(A){this._matrix[1]=A}}),Object.defineProperty(tt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(A){this._matrix[2]=A}}),Object.defineProperty(tt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(A){this._matrix[3]=A}}),Object.defineProperty(tt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(A){this._matrix[4]=A}}),Object.defineProperty(tt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(A){this._matrix[5]=A}}),Object.defineProperty(tt.prototype,"a",{get:function(){return this._matrix[0]},set:function(A){this._matrix[0]=A}}),Object.defineProperty(tt.prototype,"b",{get:function(){return this._matrix[1]},set:function(A){this._matrix[1]=A}}),Object.defineProperty(tt.prototype,"c",{get:function(){return this._matrix[2]},set:function(A){this._matrix[2]=A}}),Object.defineProperty(tt.prototype,"d",{get:function(){return this._matrix[3]},set:function(A){this._matrix[3]=A}}),Object.defineProperty(tt.prototype,"e",{get:function(){return this._matrix[4]},set:function(A){this._matrix[4]=A}}),Object.defineProperty(tt.prototype,"f",{get:function(){return this._matrix[5]},set:function(A){this._matrix[5]=A}}),Object.defineProperty(tt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(tt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(tt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(tt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),tt.prototype.join=function(A){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(E).join(A)},tt.prototype.multiply=function(A){var fe=A.sx*this.sx+A.shy*this.shx,Ne=A.sx*this.shy+A.shy*this.sy,Me=A.shx*this.sx+A.sy*this.shx,qe=A.shx*this.shy+A.sy*this.sy,it=A.tx*this.sx+A.ty*this.shx+this.tx,Pt=A.tx*this.shy+A.ty*this.sy+this.ty;return new tt(fe,Ne,Me,qe,it,Pt)},tt.prototype.decompose=function(){var A=this.sx,fe=this.shy,Ne=this.shx,Me=this.sy,qe=this.tx,it=this.ty,Pt=Math.sqrt(A*A+fe*fe),Ot=(A/=Pt)*Ne+(fe/=Pt)*Me;Ne-=A*Ot,Me-=fe*Ot;var p=Math.sqrt(Ne*Ne+Me*Me);return Ot/=p,A*(Me/=p)<fe*(Ne/=p)&&(A=-A,fe=-fe,Ot=-Ot,Pt=-Pt),{scale:new tt(Pt,0,0,p,0,0),translate:new tt(1,0,0,1,qe,it),rotate:new tt(A,fe,-fe,A,0,0),skew:new tt(1,0,Ot,1,0,0)}},tt.prototype.toString=function(A){return this.join(" ")},tt.prototype.inversed=function(){var A=this.sx,fe=this.shy,Ne=this.shx,Me=this.sy,qe=this.tx,it=this.ty,Pt=1/(A*Me-fe*Ne),Ot=Me*Pt,p=-fe*Pt,O=-Ne*Pt,ae=A*Pt;return new tt(Ot,p,O,ae,-Ot*qe-O*it,-p*qe-ae*it)},tt.prototype.applyToPoint=function(A){var fe=A.x*this.sx+A.y*this.shx+this.tx,Ne=A.x*this.shy+A.y*this.sy+this.ty;return new gs(fe,Ne)},tt.prototype.applyToRectangle=function(A){var fe=this.applyToPoint(A),Ne=this.applyToPoint(new gs(A.x+A.w,A.y+A.h));return new Js(fe.x,fe.y,Ne.x-fe.x,Ne.y-fe.y)},tt.prototype.clone=function(){var A=this.sx,fe=this.shy,Ne=this.shx,Me=this.sy,qe=this.tx,it=this.ty;return new tt(A,fe,Ne,Me,qe,it)},f.Matrix=tt;var bt=f.matrixMult=function(A,fe){return fe.multiply(A)},Mt=new tt(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Mt;var Wt=function(A,fe){if(!at[A]){var Ne=(fe instanceof Sa?"Sh":"P")+(Object.keys(ut).length+1).toString(10);fe.id=Ne,at[A]=Ne,ut[Ne]=fe,Rt.publish("addPattern",fe)}};f.ShadingPattern=Sa,f.TilingPattern=gl,f.addShadingPattern=function(A,fe){return $("addShadingPattern()"),Wt(A,fe),this},f.beginTilingPattern=function(A){$("beginTilingPattern()"),Qs(A.boundingBox[0],A.boundingBox[1],A.boundingBox[2]-A.boundingBox[0],A.boundingBox[3]-A.boundingBox[1],A.matrix)},f.endTilingPattern=function(A,fe){$("endTilingPattern()"),fe.stream=V[M].join(`
`),Wt(A,fe),Rt.publish("endTilingPattern",fe),xt.pop().restore()};var Jt=f.__private__.newObject=function(){var A=lt();return gt(A,!0),A},lt=f.__private__.newObjectDeferred=function(){return F++,X[F]=function(){return Q},F},gt=function(A,fe){return fe=typeof fe=="boolean"&&fe,X[A]=Q,fe&&q(A+" 0 obj"),A},$t=f.__private__.newAdditionalObject=function(){var A={objId:lt(),content:""};return J.push(A),A},et=lt(),Vt=lt(),Ht=f.__private__.decodeColorString=function(A){var fe=A.split(" ");if(fe.length!==2||fe[1]!=="g"&&fe[1]!=="G")fe.length===5&&(fe[4]==="k"||fe[4]==="K")&&(fe=[(1-fe[0])*(1-fe[3]),(1-fe[1])*(1-fe[3]),(1-fe[2])*(1-fe[3]),"r"]);else{var Ne=parseFloat(fe[0]);fe=[Ne,Ne,Ne,"r"]}for(var Me="#",qe=0;qe<3;qe++)Me+=("0"+Math.floor(255*parseFloat(fe[qe])).toString(16)).slice(-2);return Me},Xt=f.__private__.encodeColorString=function(A){var fe;typeof A=="string"&&(A={ch1:A});var Ne=A.ch1,Me=A.ch2,qe=A.ch3,it=A.ch4,Pt=A.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ne=="string"&&Ne.charAt(0)!=="#"){var Ot=new U5(Ne);if(Ot.ok)Ne=Ot.toHex();else if(!/^\d*\.?\d*$/.test(Ne))throw new Error('Invalid color "'+Ne+'" passed to jsPDF.encodeColorString.')}if(typeof Ne=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ne)&&(Ne="#"+Ne[1]+Ne[1]+Ne[2]+Ne[2]+Ne[3]+Ne[3]),typeof Ne=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ne)){var p=parseInt(Ne.substr(1),16);Ne=p>>16&255,Me=p>>8&255,qe=255&p}if(Me===void 0||it===void 0&&Ne===Me&&Me===qe)if(typeof Ne=="string")fe=Ne+" "+Pt[0];else switch(A.precision){case 2:fe=B(Ne/255)+" "+Pt[0];break;case 3:default:fe=_(Ne/255)+" "+Pt[0]}else if(it===void 0||rn(it)==="object"){if(it&&!isNaN(it.a)&&it.a===0)return fe=["1.","1.","1.",Pt[1]].join(" ");if(typeof Ne=="string")fe=[Ne,Me,qe,Pt[1]].join(" ");else switch(A.precision){case 2:fe=[B(Ne/255),B(Me/255),B(qe/255),Pt[1]].join(" ");break;default:case 3:fe=[_(Ne/255),_(Me/255),_(qe/255),Pt[1]].join(" ")}}else if(typeof Ne=="string")fe=[Ne,Me,qe,it,Pt[2]].join(" ");else switch(A.precision){case 2:fe=[B(Ne),B(Me),B(qe),B(it),Pt[2]].join(" ");break;case 3:default:fe=[_(Ne),_(Me),_(qe),_(it),Pt[2]].join(" ")}return fe},er=f.__private__.getFilters=function(){return s},Kt=f.__private__.putStream=function(A){var fe=(A=A||{}).data||"",Ne=A.filters||er(),Me=A.alreadyAppliedFilters||[],qe=A.addLength1||!1,it=fe.length,Pt=A.objectId,Ot=function(Sr){return Sr};if(h!==null&&Pt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(Ot=Rr.encryptor(Pt,0));var p={};Ne===!0&&(Ne=["FlateEncode"]);var O=A.additionalKeyValues||[],ae=(p=sr.API.processDataByFilters!==void 0?sr.API.processDataByFilters(fe,Ne):{data:fe,reverseChain:[]}).reverseChain+(Array.isArray(Me)?Me.join(" "):Me.toString());if(p.data.length!==0&&(O.push({key:"Length",value:p.data.length}),qe===!0&&O.push({key:"Length1",value:it})),ae.length!=0)if(ae.split("/").length-1==1)O.push({key:"Filter",value:ae});else{O.push({key:"Filter",value:"["+ae+"]"});for(var Se=0;Se<O.length;Se+=1)if(O[Se].key==="DecodeParms"){for(var Ve=[],Ze=0;Ze<p.reverseChain.split("/").length-1;Ze+=1)Ve.push("null");Ve.push(O[Se].value),O[Se].value="["+Ve.join(" ")+"]"}}q("<<");for(var At=0;At<O.length;At++)q("/"+O[At].key+" "+O[At].value);q(">>"),p.data.length!==0&&(q("stream"),q(Ot(p.data)),q("endstream"))},ir=f.__private__.putPage=function(A){var fe=A.number,Ne=A.data,Me=A.objId,qe=A.contentsObjId;gt(Me,!0),q("<</Type /Page"),q("/Parent "+A.rootDictionaryObjId+" 0 R"),q("/Resources "+A.resourceDictionaryObjId+" 0 R"),q("/MediaBox ["+parseFloat(E(A.mediaBox.bottomLeftX))+" "+parseFloat(E(A.mediaBox.bottomLeftY))+" "+E(A.mediaBox.topRightX)+" "+E(A.mediaBox.topRightY)+"]"),A.cropBox!==null&&q("/CropBox ["+E(A.cropBox.bottomLeftX)+" "+E(A.cropBox.bottomLeftY)+" "+E(A.cropBox.topRightX)+" "+E(A.cropBox.topRightY)+"]"),A.bleedBox!==null&&q("/BleedBox ["+E(A.bleedBox.bottomLeftX)+" "+E(A.bleedBox.bottomLeftY)+" "+E(A.bleedBox.topRightX)+" "+E(A.bleedBox.topRightY)+"]"),A.trimBox!==null&&q("/TrimBox ["+E(A.trimBox.bottomLeftX)+" "+E(A.trimBox.bottomLeftY)+" "+E(A.trimBox.topRightX)+" "+E(A.trimBox.topRightY)+"]"),A.artBox!==null&&q("/ArtBox ["+E(A.artBox.bottomLeftX)+" "+E(A.artBox.bottomLeftY)+" "+E(A.artBox.topRightX)+" "+E(A.artBox.topRightY)+"]"),typeof A.userUnit=="number"&&A.userUnit!==1&&q("/UserUnit "+A.userUnit),Rt.publish("putPage",{objId:Me,pageContext:wt[fe],pageNumber:fe,page:Ne}),q("/Contents "+qe+" 0 R"),q(">>"),q("endobj");var it=Ne.join(`
`);return oe===j.ADVANCED&&(it+=`
Q`),gt(qe,!0),Kt({data:it,filters:er(),objectId:qe}),q("endobj"),Me},vr=f.__private__.putPages=function(){var A,fe,Ne=[];for(A=1;A<=Tt;A++)wt[A].objId=lt(),wt[A].contentsObjId=lt();for(A=1;A<=Tt;A++)Ne.push(ir({number:A,data:V[A],objId:wt[A].objId,contentsObjId:wt[A].contentsObjId,mediaBox:wt[A].mediaBox,cropBox:wt[A].cropBox,bleedBox:wt[A].bleedBox,trimBox:wt[A].trimBox,artBox:wt[A].artBox,userUnit:wt[A].userUnit,rootDictionaryObjId:et,resourceDictionaryObjId:Vt}));gt(et,!0),q("<</Type /Pages");var Me="/Kids [";for(fe=0;fe<Tt;fe++)Me+=Ne[fe]+" 0 R ";q(Me+"]"),q("/Count "+Tt),q(">>"),q("endobj"),Rt.publish("postPutPages")},cr=function(A){Rt.publish("putFont",{font:A,out:q,newObject:Jt,putStream:Kt}),A.isAlreadyPutted!==!0&&(A.objectNumber=Jt(),q("<<"),q("/Type /Font"),q("/BaseFont /"+dc(A.postScriptName)),q("/Subtype /Type1"),typeof A.encoding=="string"&&q("/Encoding /"+A.encoding),q("/FirstChar 32"),q("/LastChar 255"),q(">>"),q("endobj"))},br=function(){for(var A in nt)nt.hasOwnProperty(A)&&(m===!1||m===!0&&g.hasOwnProperty(A))&&cr(nt[A])},Nt=function(A){A.objectNumber=Jt();var fe=[];fe.push({key:"Type",value:"/XObject"}),fe.push({key:"Subtype",value:"/Form"}),fe.push({key:"BBox",value:"["+[E(A.x),E(A.y),E(A.x+A.width),E(A.y+A.height)].join(" ")+"]"}),fe.push({key:"Matrix",value:"["+A.matrix.toString()+"]"});var Ne=A.pages[1].join(`
`);Kt({data:Ne,additionalKeyValues:fe,objectId:A.objectNumber}),q("endobj")},Et=function(){for(var A in ze)ze.hasOwnProperty(A)&&Nt(ze[A])},Cr=function(A,fe){var Ne,Me=[],qe=1/(fe-1);for(Ne=0;Ne<1;Ne+=qe)Me.push(Ne);if(Me.push(1),A[0].offset!=0){var it={offset:0,color:A[0].color};A.unshift(it)}if(A[A.length-1].offset!=1){var Pt={offset:1,color:A[A.length-1].color};A.push(Pt)}for(var Ot="",p=0,O=0;O<Me.length;O++){for(Ne=Me[O];Ne>A[p+1].offset;)p++;var ae=A[p].offset,Se=(Ne-ae)/(A[p+1].offset-ae),Ve=A[p].color,Ze=A[p+1].color;Ot+=I(Math.round((1-Se)*Ve[0]+Se*Ze[0]).toString(16))+I(Math.round((1-Se)*Ve[1]+Se*Ze[1]).toString(16))+I(Math.round((1-Se)*Ve[2]+Se*Ze[2]).toString(16))}return Ot.trim()},Tr=function(A,fe){fe||(fe=21);var Ne=Jt(),Me=Cr(A.colors,fe),qe=[];qe.push({key:"FunctionType",value:"0"}),qe.push({key:"Domain",value:"[0.0 1.0]"}),qe.push({key:"Size",value:"["+fe+"]"}),qe.push({key:"BitsPerSample",value:"8"}),qe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Kt({data:Me,additionalKeyValues:qe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ne}),q("endobj"),A.objectNumber=Jt(),q("<< /ShadingType "+A.type),q("/ColorSpace /DeviceRGB");var it="/Coords ["+E(parseFloat(A.coords[0]))+" "+E(parseFloat(A.coords[1]))+" ";A.type===2?it+=E(parseFloat(A.coords[2]))+" "+E(parseFloat(A.coords[3])):it+=E(parseFloat(A.coords[2]))+" "+E(parseFloat(A.coords[3]))+" "+E(parseFloat(A.coords[4]))+" "+E(parseFloat(A.coords[5])),q(it+="]"),A.matrix&&q("/Matrix ["+A.matrix.toString()+"]"),q("/Function "+Ne+" 0 R"),q("/Extend [true true]"),q(">>"),q("endobj")},mr=function(A,fe){var Ne=lt(),Me=Jt();fe.push({resourcesOid:Ne,objectOid:Me}),A.objectNumber=Me;var qe=[];qe.push({key:"Type",value:"/Pattern"}),qe.push({key:"PatternType",value:"1"}),qe.push({key:"PaintType",value:"1"}),qe.push({key:"TilingType",value:"1"}),qe.push({key:"BBox",value:"["+A.boundingBox.map(E).join(" ")+"]"}),qe.push({key:"XStep",value:E(A.xStep)}),qe.push({key:"YStep",value:E(A.yStep)}),qe.push({key:"Resources",value:Ne+" 0 R"}),A.matrix&&qe.push({key:"Matrix",value:"["+A.matrix.toString()+"]"}),Kt({data:A.stream,additionalKeyValues:qe,objectId:A.objectNumber}),q("endobj")},gr=function(A){var fe;for(fe in ut)ut.hasOwnProperty(fe)&&(ut[fe]instanceof Sa?Tr(ut[fe]):ut[fe]instanceof gl&&mr(ut[fe],A))},Er=function(A){for(var fe in A.objectNumber=Jt(),q("<<"),A)switch(fe){case"opacity":q("/ca "+B(A[fe]));break;case"stroke-opacity":q("/CA "+B(A[fe]))}q(">>"),q("endobj")},Wr=function(){var A;for(A in It)It.hasOwnProperty(A)&&Er(It[A])},ur=function(){for(var A in q("/XObject <<"),ze)ze.hasOwnProperty(A)&&ze[A].objectNumber>=0&&q("/"+A+" "+ze[A].objectNumber+" 0 R");Rt.publish("putXobjectDict"),q(">>")},un=function(){Rr.oid=Jt(),q("<<"),q("/Filter /Standard"),q("/V "+Rr.v),q("/R "+Rr.r),q("/U <"+Rr.toHexString(Rr.U)+">"),q("/O <"+Rr.toHexString(Rr.O)+">"),q("/P "+Rr.P),q(">>"),q("endobj")},yn=function(){for(var A in q("/Font <<"),nt)nt.hasOwnProperty(A)&&(m===!1||m===!0&&g.hasOwnProperty(A))&&q("/"+A+" "+nt[A].objectNumber+" 0 R");q(">>")},zn=function(){if(Object.keys(ut).length>0){for(var A in q("/Shading <<"),ut)ut.hasOwnProperty(A)&&ut[A]instanceof Sa&&ut[A].objectNumber>=0&&q("/"+A+" "+ut[A].objectNumber+" 0 R");Rt.publish("putShadingPatternDict"),q(">>")}},bn=function(A){if(Object.keys(ut).length>0){for(var fe in q("/Pattern <<"),ut)ut.hasOwnProperty(fe)&&ut[fe]instanceof f.TilingPattern&&ut[fe].objectNumber>=0&&ut[fe].objectNumber<A&&q("/"+fe+" "+ut[fe].objectNumber+" 0 R");Rt.publish("putTilingPatternDict"),q(">>")}},gn=function(){if(Object.keys(It).length>0){var A;for(A in q("/ExtGState <<"),It)It.hasOwnProperty(A)&&It[A].objectNumber>=0&&q("/"+A+" "+It[A].objectNumber+" 0 R");Rt.publish("putGStateDict"),q(">>")}},kr=function(A){gt(A.resourcesOid,!0),q("<<"),q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),yn(),zn(),bn(A.objectOid),gn(),ur(),q(">>"),q("endobj")},Un=function(){var A=[];br(),Wr(),Et(),gr(A),Rt.publish("putResources"),A.forEach(kr),kr({resourcesOid:Vt,objectOid:Number.MAX_SAFE_INTEGER}),Rt.publish("postPutResources")},ei=function(){Rt.publish("putAdditionalObjects");for(var A=0;A<J.length;A++){var fe=J[A];gt(fe.objId,!0),q(fe.content),q("endobj")}Rt.publish("postPutAdditionalObjects")},pi=function(A){He[A.fontName]=He[A.fontName]||{},He[A.fontName][A.fontStyle]=A.id},tr=function(A,fe,Ne,Me,qe){var it={id:"F"+(Object.keys(nt).length+1).toString(10),postScriptName:A,fontName:fe,fontStyle:Ne,encoding:Me,isStandardFont:qe||!1,metadata:{}};return Rt.publish("addFont",{font:it,instance:this}),nt[it.id]=it,pi(it),it.id},Nr=function(A){for(var fe=0,Ne=de.length;fe<Ne;fe++){var Me=tr.call(this,A[fe][0],A[fe][1],A[fe][2],de[fe][3],!0);m===!1&&(g[Me]=!0);var qe=A[fe][0].split("-");pi({id:Me,fontName:qe[0],fontStyle:qe[1]||""})}Rt.publish("addFonts",{fonts:nt,dictionary:He})},Vr=function(A){return A.foo=function(){try{return A.apply(this,arguments)}catch(Me){var fe=Me.stack||"";~fe.indexOf(" at ")&&(fe=fe.split(" at ")[1]);var Ne="Error in function "+fe.split(`
`)[0].split("<")[0]+": "+Me.message;if(!dr.console)throw new Error(Ne);dr.console.error(Ne,Me),dr.alert&&alert(Ne)}},A.foo.bar=A,A.foo},_n=function(A,fe){var Ne,Me,qe,it,Pt,Ot,p,O,ae;if(qe=(fe=fe||{}).sourceEncoding||"Unicode",Pt=fe.outputEncoding,(fe.autoencode||Pt)&&nt[Ye].metadata&&nt[Ye].metadata[qe]&&nt[Ye].metadata[qe].encoding&&(it=nt[Ye].metadata[qe].encoding,!Pt&&nt[Ye].encoding&&(Pt=nt[Ye].encoding),!Pt&&it.codePages&&(Pt=it.codePages[0]),typeof Pt=="string"&&(Pt=it[Pt]),Pt)){for(p=!1,Ot=[],Ne=0,Me=A.length;Ne<Me;Ne++)(O=Pt[A.charCodeAt(Ne)])?Ot.push(String.fromCharCode(O)):Ot.push(A[Ne]),Ot[Ne].charCodeAt(0)>>8&&(p=!0);A=Ot.join("")}for(Ne=A.length;p===void 0&&Ne!==0;)A.charCodeAt(Ne-1)>>8&&(p=!0),Ne--;if(!p)return A;for(Ot=fe.noBOM?[]:[254,255],Ne=0,Me=A.length;Ne<Me;Ne++){if((ae=(O=A.charCodeAt(Ne))>>8)>>8)throw new Error("Character at position "+Ne+" of string '"+A+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Ot.push(ae),Ot.push(O-(ae<<8))}return String.fromCharCode.apply(void 0,Ot)},qr=f.__private__.pdfEscape=f.pdfEscape=function(A,fe){return _n(A,fe).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Lr=f.__private__.beginPage=function(A){V[++Tt]=[],wt[Tt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(A[0]),topRightY:Number(A[1])}},_t(Tt),se(V[M])},ti=function(A,fe){var Ne,Me,qe;switch(r=fe||r,typeof A=="string"&&(Ne=C(A.toLowerCase()),Array.isArray(Ne)&&(Me=Ne[0],qe=Ne[1])),Array.isArray(A)&&(Me=A[0]*Be,qe=A[1]*Be),isNaN(Me)&&(Me=i[0],qe=i[1]),(Me>14400||qe>14400)&&(ln.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Me=Math.min(14400,Me),qe=Math.min(14400,qe)),i=[Me,qe],r.substr(0,1)){case"l":qe>Me&&(i=[qe,Me]);break;case"p":Me>qe&&(i=[qe,Me])}Lr(i),Wa(Ga),q(oi),Ja!==0&&q(Ja+" J"),Ks!==0&&q(Ks+" j"),Rt.publish("addPage",{pageNumber:Tt})},ri=function(A){A>0&&A<=Tt&&(V.splice(A,1),wt.splice(A,1),Tt--,M>Tt&&(M=Tt),this.setPage(M))},_t=function(A){A>0&&A<=Tt&&(M=A)},ar=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return V.length-1},vn=function(A,fe,Ne){var Me,qe=void 0;return Ne=Ne||{},A=A!==void 0?A:nt[Ye].fontName,fe=fe!==void 0?fe:nt[Ye].fontStyle,Me=A.toLowerCase(),He[Me]!==void 0&&He[Me][fe]!==void 0?qe=He[Me][fe]:He[A]!==void 0&&He[A][fe]!==void 0?qe=He[A][fe]:Ne.disableWarning===!1&&ln.warn("Unable to look up font label for font '"+A+"', '"+fe+"'. Refer to getFontList() for available fonts."),qe||Ne.noFallback||(qe=He.times[fe])==null&&(qe=He.times.normal),qe},nn=f.__private__.putInfo=function(){var A=Jt(),fe=function(Me){return Me};for(var Ne in h!==null&&(fe=Rr.encryptor(A,0)),q("<<"),q("/Producer ("+qr(fe("jsPDF "+sr.version))+")"),De)De.hasOwnProperty(Ne)&&De[Ne]&&q("/"+Ne.substr(0,1).toUpperCase()+Ne.substr(1)+" ("+qr(fe(De[Ne]))+")");q("/CreationDate ("+qr(fe(K))+")"),q(">>"),q("endobj")},Gr=f.__private__.putCatalog=function(A){var fe=(A=A||{}).rootDictionaryObjId||et;switch(Jt(),q("<<"),q("/Type /Catalog"),q("/Pages "+fe+" 0 R"),xe||(xe="fullwidth"),xe){case"fullwidth":q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":q("/OpenAction [3 0 R /Fit]");break;case"original":q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ne=""+xe;Ne.substr(Ne.length-1)==="%"&&(xe=parseInt(xe)/100),typeof xe=="number"&&q("/OpenAction [3 0 R /XYZ null null "+B(xe)+"]")}switch(Te||(Te="continuous"),Te){case"continuous":q("/PageLayout /OneColumn");break;case"single":q("/PageLayout /SinglePage");break;case"two":case"twoleft":q("/PageLayout /TwoColumnLeft");break;case"tworight":q("/PageLayout /TwoColumnRight")}Re&&q("/PageMode /"+Re),Rt.publish("putCatalog"),q(">>"),q("endobj")},Jn=f.__private__.putTrailer=function(){q("trailer"),q("<<"),q("/Size "+(F+1)),q("/Root "+F+" 0 R"),q("/Info "+(F-1)+" 0 R"),h!==null&&q("/Encrypt "+Rr.oid+" 0 R"),q("/ID [ <"+R+"> <"+R+"> ]"),q(">>")},ni=f.__private__.putHeader=function(){q("%PDF-"+w),q("%")},co=f.__private__.putXRef=function(){var A="0000000000";q("xref"),q("0 "+(F+1)),q("0000000000 65535 f ");for(var fe=1;fe<=F;fe++)typeof X[fe]=="function"?q((A+X[fe]()).slice(-10)+" 00000 n "):X[fe]!==void 0?q((A+X[fe]).slice(-10)+" 00000 n "):q("0000000000 00000 n ")},Pn=f.__private__.buildDocument=function(){ce(),se(Y),Rt.publish("buildDocument"),ni(),vr(),ei(),Un(),h!==null&&un(),nn(),Gr();var A=Q;return co(),Jn(),q("startxref"),q(""+A),q("%%EOF"),se(V[M]),Y.join(`
`)},Bi=f.__private__.getBlob=function(A){return new Blob([ye(A)],{type:"application/pdf"})},fi=f.output=f.__private__.output=Vr(function(A,fe){switch(typeof(fe=fe||{})=="string"?fe={filename:fe}:fe.filename=fe.filename||"generated.pdf",A){case void 0:return Pn();case"save":f.save(fe.filename);break;case"arraybuffer":return ye(Pn());case"blob":return Bi(Pn());case"bloburi":case"bloburl":if(dr.URL!==void 0&&typeof dr.URL.createObjectURL=="function")return dr.URL&&dr.URL.createObjectURL(Bi(Pn()))||void 0;ln.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ne="",Me=Pn();try{Ne=Im(Me)}catch{Ne=Im(unescape(encodeURIComponent(Me)))}return"data:application/pdf;filename="+fe.filename+";base64,"+Ne;case"pdfobjectnewwindow":if(Object.prototype.toString.call(dr)==="[object Window]"){var qe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",it=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';fe.pdfObjectUrl&&(qe=fe.pdfObjectUrl,it="");var Pt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+qe+'"'+it+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(fe)+");<\/script></body></html>",Ot=dr.open();return Ot!==null&&Ot.document.write(Pt),Ot}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(dr)==="[object Window]"){var p='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(fe.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+fe.filename+'" width="500px" height="400px" /></body></html>',O=dr.open();if(O!==null){O.document.write(p);var ae=this;O.document.documentElement.querySelector("#pdfViewer").onload=function(){O.document.title=fe.filename,O.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ae.output("bloburl"))}}return O}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(dr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Se='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",fe)+'"></iframe></body></html>',Ve=dr.open();if(Ve!==null&&(Ve.document.write(Se),Ve.document.title=fe.filename),Ve||typeof safari>"u")return Ve;break;case"datauri":case"dataurl":return dr.document.location.href=this.output("datauristring",fe);default:return null}}),Rn=function(A){return Array.isArray(fr)===!0&&fr.indexOf(A)>-1};switch(n){case"pt":Be=1;break;case"mm":Be=72/25.4;break;case"cm":Be=72/2.54;break;case"in":Be=72;break;case"px":Be=Rn("px_scaling")==1?.75:96/72;break;case"pc":case"em":Be=12;break;case"ex":Be=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Be=n}var Rr=null;le(),W();var mi=function(A){return h!==null?Rr.encryptor(A,0):function(fe){return fe}},yi=f.__private__.getPageInfo=f.getPageInfo=function(A){if(isNaN(A)||A%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:wt[A].objId,pageNumber:A,pageContext:wt[A]}},nr=f.__private__.getPageInfoByObjId=function(A){if(isNaN(A)||A%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var fe in wt)if(wt[fe].objId===A)break;return yi(fe)},uo=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:wt[M].objId,pageNumber:M,pageContext:wt[M]}};f.addPage=function(){return ti.apply(this,arguments),this},f.setPage=function(){return _t.apply(this,arguments),se.call(this,V[M]),this},f.insertPage=function(A){return this.addPage(),this.movePage(M,A),this},f.movePage=function(A,fe){var Ne,Me;if(A>fe){Ne=V[A],Me=wt[A];for(var qe=A;qe>fe;qe--)V[qe]=V[qe-1],wt[qe]=wt[qe-1];V[fe]=Ne,wt[fe]=Me,this.setPage(fe)}else if(A<fe){Ne=V[A],Me=wt[A];for(var it=A;it<fe;it++)V[it]=V[it+1],wt[it]=wt[it+1];V[fe]=Ne,wt[fe]=Me,this.setPage(fe)}return this},f.deletePage=function(){return ri.apply(this,arguments),this},f.__private__.text=f.text=function(A,fe,Ne,Me,qe){var it,Pt,Ot,p,O,ae,Se,Ve,Ze,At=(Me=Me||{}).scope||this;if(typeof A=="number"&&typeof fe=="number"&&(typeof Ne=="string"||Array.isArray(Ne))){var Sr=Ne;Ne=fe,fe=A,A=Sr}if(arguments[3]instanceof tt?($("The transform parameter of text() with a Matrix value"),Ze=qe):(Ot=arguments[4],p=arguments[5],rn(Se=arguments[3])==="object"&&Se!==null||(typeof Ot=="string"&&(p=Ot,Ot=null),typeof Se=="string"&&(p=Se,Se=null),typeof Se=="number"&&(Ot=Se,Se=null),Me={flags:Se,angle:Ot,align:p})),isNaN(fe)||isNaN(Ne)||A==null)throw new Error("Invalid arguments passed to jsPDF.text");if(A.length===0)return At;var Dr="",Pr=!1,Xr=typeof Me.lineHeightFactor=="number"?Me.lineHeightFactor:Qr,sn=At.internal.scaleFactor;function Co(dn){return dn=dn.split("	").join(Array(Me.TabLen||9).join(" ")),qr(dn,Se)}function si(dn){for(var hn,$n=dn.concat(),Gn=[],Ps=$n.length;Ps--;)typeof(hn=$n.shift())=="string"?Gn.push(hn):Array.isArray(dn)&&(hn.length===1||hn[1]===void 0&&hn[2]===void 0)?Gn.push(hn[0]):Gn.push([hn[0],hn[1],hn[2]]);return Gn}function Yo(dn,hn){var $n;if(typeof dn=="string")$n=hn(dn)[0];else if(Array.isArray(dn)){for(var Gn,Ps,qc=dn.concat(),Wl=[],ld=qc.length;ld--;)typeof(Gn=qc.shift())=="string"?Wl.push(hn(Gn)[0]):Array.isArray(Gn)&&typeof Gn[0]=="string"&&(Ps=hn(Gn[0],Gn[1],Gn[2]),Wl.push([Ps[0],Ps[1],Ps[2]]));$n=Wl}return $n}var Ko=!1,Dc=!0;if(typeof A=="string")Ko=!0;else if(Array.isArray(A)){var Mc=A.concat();Pt=[];for(var Bl,ai=Mc.length;ai--;)(typeof(Bl=Mc.shift())!="string"||Array.isArray(Bl)&&typeof Bl[0]!="string")&&(Dc=!1);Ko=Dc}if(Ko===!1)throw new Error('Type of text must be string or Array. "'+A+'" is not recognized.');typeof A=="string"&&(A=A.match(/[\r?\n]/)?A.split(/\r\n|\r|\n/g):[A]);var jl=ge/At.internal.scaleFactor,Vl=jl*(Xr-1);switch(Me.baseline){case"bottom":Ne-=Vl;break;case"top":Ne+=jl-Vl;break;case"hanging":Ne+=jl-2*Vl;break;case"middle":Ne+=jl/2-Vl}if((ae=Me.maxWidth||0)>0&&(typeof A=="string"?A=At.splitTextToSize(A,ae):Object.prototype.toString.call(A)==="[object Array]"&&(A=A.reduce(function(dn,hn){return dn.concat(At.splitTextToSize(hn,ae))},[]))),it={text:A,x:fe,y:Ne,options:Me,mutex:{pdfEscape:qr,activeFontKey:Ye,fonts:nt,activeFontSize:ge}},Rt.publish("preProcessText",it),A=it.text,Ot=(Me=it.options).angle,!(Ze instanceof tt)&&Ot&&typeof Ot=="number"){Ot*=Math.PI/180,Me.rotationDirection===0&&(Ot=-Ot),oe===j.ADVANCED&&(Ot=-Ot);var ql=Math.cos(Ot),Fc=Math.sin(Ot);Ze=new tt(ql,Fc,-Fc,ql,0,0)}else Ot&&Ot instanceof tt&&(Ze=Ot);oe!==j.ADVANCED||Ze||(Ze=Mt),(O=Me.charSpace||ys)!==void 0&&(Dr+=E(P(O))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ve=Me.horizontalScale)!==void 0&&(Dr+=E(100*Ve)+` Tz
`),Me.lang;var Vi=-1,bp=Me.renderingMode!==void 0?Me.renderingMode:Me.stroke,Oc=At.internal.getCurrentPageInfo().pageContext;switch(bp){case 0:case!1:case"fill":Vi=0;break;case 1:case!0:case"stroke":Vi=1;break;case 2:case"fillThenStroke":Vi=2;break;case 3:case"invisible":Vi=3;break;case 4:case"fillAndAddForClipping":Vi=4;break;case 5:case"strokeAndAddPathForClipping":Vi=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Vi=6;break;case 7:case"addToPathForClipping":Vi=7}var id=Oc.usedRenderingMode!==void 0?Oc.usedRenderingMode:-1;Vi!==-1?Dr+=Vi+` Tr
`:id!==-1&&(Dr+=`0 Tr
`),Vi!==-1&&(Oc.usedRenderingMode=Vi),p=Me.align||"left";var ho,zl=ge*Xr,od=At.internal.pageSize.getWidth(),sd=nt[Ye];O=Me.charSpace||ys,ae=Me.maxWidth||0,Se=Object.assign({autoencode:!0,noBOM:!0},Me.flags);var ea=[],Qa=function(dn){return At.getStringUnitWidth(dn,{font:sd,charSpace:O,fontSize:ge,doKerning:!1})*ge/sn};if(Object.prototype.toString.call(A)==="[object Array]"){var qi;Pt=si(A),p!=="left"&&(ho=Pt.map(Qa));var Li,ta=0;if(p==="right"){fe-=ho[0],A=[],ai=Pt.length;for(var bs=0;bs<ai;bs++)bs===0?(Li=to(fe),qi=Hn(Ne)):(Li=P(ta-ho[bs]),qi=-zl),A.push([Pt[bs],Li,qi]),ta=ho[bs]}else if(p==="center"){fe-=ho[0]/2,A=[],ai=Pt.length;for(var _s=0;_s<ai;_s++)_s===0?(Li=to(fe),qi=Hn(Ne)):(Li=P((ta-ho[_s])/2),qi=-zl),A.push([Pt[_s],Li,qi]),ta=ho[_s]}else if(p==="left"){A=[],ai=Pt.length;for(var Ul=0;Ul<ai;Ul++)A.push(Pt[Ul])}else if(p==="justify"&&sd.encoding==="Identity-H"){A=[],ai=Pt.length,ae=ae!==0?ae:od;for(var Ss=0,In=0;In<ai;In++)if(qi=In===0?Hn(Ne):-zl,Li=In===0?to(fe):Ss,In<ai-1){var Bc=P((ae-ho[In])/(Pt[In].split(" ").length-1)),Ri=Pt[In].split(" ");A.push([Ri[0]+" ",Li,qi]),Ss=0;for(var po=1;po<Ri.length;po++){var Hl=(Qa(Ri[po-1]+" "+Ri[po])-Qa(Ri[po]))*sn+Bc;po==Ri.length-1?A.push([Ri[po],Hl,0]):A.push([Ri[po]+" ",Hl,0]),Ss-=Hl}}else A.push([Pt[In],Li,qi]);A.push(["",Ss,0])}else{if(p!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(A=[],ai=Pt.length,ae=ae!==0?ae:od,In=0;In<ai;In++)qi=In===0?Hn(Ne):-zl,Li=In===0?to(fe):0,In<ai-1?ea.push(E(P((ae-ho[In])/(Pt[In].split(" ").length-1)))):ea.push(0),A.push([Pt[In],Li,qi])}}var ad=typeof Me.R2L=="boolean"?Me.R2L:_e;ad===!0&&(A=Yo(A,function(dn,hn,$n){return[dn.split("").reverse().join(""),hn,$n]})),it={text:A,x:fe,y:Ne,options:Me,mutex:{pdfEscape:qr,activeFontKey:Ye,fonts:nt,activeFontSize:ge}},Rt.publish("postProcessText",it),A=it.text,Pr=it.mutex.isHex||!1;var jc=nt[Ye].encoding;jc!=="WinAnsiEncoding"&&jc!=="StandardEncoding"||(A=Yo(A,function(dn,hn,$n){return[Co(dn),hn,$n]})),Pt=si(A),A=[];for(var Xa,Za,ra,el=0,Gl=1,tl=Array.isArray(Pt[0])?Gl:el,na="",Vc=function(dn,hn,$n){var Gn="";return $n instanceof tt?($n=typeof Me.angle=="number"?bt($n,new tt(1,0,0,1,dn,hn)):bt(new tt(1,0,0,1,dn,hn),$n),oe===j.ADVANCED&&($n=bt(new tt(1,0,0,-1,0,0),$n)),Gn=$n.join(" ")+` Tm
`):Gn=E(dn)+" "+E(hn)+` Td
`,Gn},fo=0;fo<Pt.length;fo++){switch(na="",tl){case Gl:ra=(Pr?"<":"(")+Pt[fo][0]+(Pr?">":")"),Xa=parseFloat(Pt[fo][1]),Za=parseFloat(Pt[fo][2]);break;case el:ra=(Pr?"<":"(")+Pt[fo]+(Pr?">":")"),Xa=to(fe),Za=Hn(Ne)}ea!==void 0&&ea[fo]!==void 0&&(na=ea[fo]+` Tw
`),fo===0?A.push(na+Vc(Xa,Za,Ze)+ra):tl===el?A.push(na+ra):tl===Gl&&A.push(na+Vc(Xa,Za,Ze)+ra)}A=tl===el?A.join(` Tj
T* `):A.join(` Tj
`),A+=` Tj
`;var mo=`BT
/`;return mo+=Ye+" "+ge+` Tf
`,mo+=E(ge*Xr)+` TL
`,mo+=xo+`
`,mo+=Dr,mo+=A,q(mo+="ET"),g[Ye]=!0,At};var Ua=f.__private__.clip=f.clip=function(A){return q(A==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return Ua("evenodd")},f.__private__.discardPath=f.discardPath=function(){return q("n"),this};var ji=f.__private__.isValidStyle=function(A){var fe=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(A)!==-1&&(fe=!0),fe};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(A){return ji(A)&&(u=A),this};var Vo=f.__private__.getStyle=f.getStyle=function(A){var fe=u;switch(A){case"D":case"S":fe="S";break;case"F":fe="f";break;case"FD":case"DF":fe="B";break;case"f":case"f*":case"B":case"B*":fe=A}return fe},ii=f.close=function(){return q("h"),this};f.stroke=function(){return q("S"),this},f.fill=function(A){return qo("f",A),this},f.fillEvenOdd=function(A){return qo("f*",A),this},f.fillStroke=function(A){return qo("B",A),this},f.fillStrokeEvenOdd=function(A){return qo("B*",A),this};var qo=function(A,fe){rn(fe)==="object"?Uo(fe,A):q(A)},fs=function(A){A===null||oe===j.ADVANCED&&A===void 0||(A=Vo(A),q(A))};function zo(A,fe,Ne,Me,qe){var it=new gl(fe||this.boundingBox,Ne||this.xStep,Me||this.yStep,this.gState,qe||this.matrix);it.stream=this.stream;var Pt=A+"$$"+this.cloneIndex+++"$$";return Wt(Pt,it),it}var Uo=function(A,fe){var Ne=at[A.key],Me=ut[Ne];if(Me instanceof Sa)q("q"),q(Us(fe)),Me.gState&&f.setGState(Me.gState),q(A.matrix.toString()+" cm"),q("/"+Ne+" sh"),q("Q");else if(Me instanceof gl){var qe=new tt(1,0,0,-1,0,gi());A.matrix&&(qe=qe.multiply(A.matrix||Mt),Ne=zo.call(Me,A.key,A.boundingBox,A.xStep,A.yStep,qe).id),q("q"),q("/Pattern cs"),q("/"+Ne+" scn"),Me.gState&&f.setGState(Me.gState),q(fe),q("Q")}},Us=function(A){switch(A){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Zi=f.moveTo=function(A,fe){return q(E(P(A))+" "+E(H(fe))+" m"),this},Ni=f.lineTo=function(A,fe){return q(E(P(A))+" "+E(H(fe))+" l"),this},eo=f.curveTo=function(A,fe,Ne,Me,qe,it){return q([E(P(A)),E(H(fe)),E(P(Ne)),E(H(Me)),E(P(qe)),E(H(it)),"c"].join(" ")),this};f.__private__.line=f.line=function(A,fe,Ne,Me,qe){if(isNaN(A)||isNaN(fe)||isNaN(Ne)||isNaN(Me)||!ji(qe))throw new Error("Invalid arguments passed to jsPDF.line");return oe===j.COMPAT?this.lines([[Ne-A,Me-fe]],A,fe,[1,1],qe||"S"):this.lines([[Ne-A,Me-fe]],A,fe,[1,1]).stroke()},f.__private__.lines=f.lines=function(A,fe,Ne,Me,qe,it){var Pt,Ot,p,O,ae,Se,Ve,Ze,At,Sr,Dr,Pr;if(typeof A=="number"&&(Pr=Ne,Ne=fe,fe=A,A=Pr),Me=Me||[1,1],it=it||!1,isNaN(fe)||isNaN(Ne)||!Array.isArray(A)||!Array.isArray(Me)||!ji(qe)||typeof it!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Zi(fe,Ne),Pt=Me[0],Ot=Me[1],O=A.length,Sr=fe,Dr=Ne,p=0;p<O;p++)(ae=A[p]).length===2?(Sr=ae[0]*Pt+Sr,Dr=ae[1]*Ot+Dr,Ni(Sr,Dr)):(Se=ae[0]*Pt+Sr,Ve=ae[1]*Ot+Dr,Ze=ae[2]*Pt+Sr,At=ae[3]*Ot+Dr,Sr=ae[4]*Pt+Sr,Dr=ae[5]*Ot+Dr,eo(Se,Ve,Ze,At,Sr,Dr));return it&&ii(),fs(qe),this},f.path=function(A){for(var fe=0;fe<A.length;fe++){var Ne=A[fe],Me=Ne.c;switch(Ne.op){case"m":Zi(Me[0],Me[1]);break;case"l":Ni(Me[0],Me[1]);break;case"c":eo.apply(this,Me);break;case"h":ii()}}return this},f.__private__.rect=f.rect=function(A,fe,Ne,Me,qe){if(isNaN(A)||isNaN(fe)||isNaN(Ne)||isNaN(Me)||!ji(qe))throw new Error("Invalid arguments passed to jsPDF.rect");return oe===j.COMPAT&&(Me=-Me),q([E(P(A)),E(H(fe)),E(P(Ne)),E(P(Me)),"re"].join(" ")),fs(qe),this},f.__private__.triangle=f.triangle=function(A,fe,Ne,Me,qe,it,Pt){if(isNaN(A)||isNaN(fe)||isNaN(Ne)||isNaN(Me)||isNaN(qe)||isNaN(it)||!ji(Pt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ne-A,Me-fe],[qe-Ne,it-Me],[A-qe,fe-it]],A,fe,[1,1],Pt,!0),this},f.__private__.roundedRect=f.roundedRect=function(A,fe,Ne,Me,qe,it,Pt){if(isNaN(A)||isNaN(fe)||isNaN(Ne)||isNaN(Me)||isNaN(qe)||isNaN(it)||!ji(Pt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ot=4/3*(Math.SQRT2-1);return qe=Math.min(qe,.5*Ne),it=Math.min(it,.5*Me),this.lines([[Ne-2*qe,0],[qe*Ot,0,qe,it-it*Ot,qe,it],[0,Me-2*it],[0,it*Ot,-qe*Ot,it,-qe,it],[2*qe-Ne,0],[-qe*Ot,0,-qe,-it*Ot,-qe,-it],[0,2*it-Me],[0,-it*Ot,qe*Ot,-it,qe,-it]],A+qe,fe,[1,1],Pt,!0),this},f.__private__.ellipse=f.ellipse=function(A,fe,Ne,Me,qe){if(isNaN(A)||isNaN(fe)||isNaN(Ne)||isNaN(Me)||!ji(qe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var it=4/3*(Math.SQRT2-1)*Ne,Pt=4/3*(Math.SQRT2-1)*Me;return Zi(A+Ne,fe),eo(A+Ne,fe-Pt,A+it,fe-Me,A,fe-Me),eo(A-it,fe-Me,A-Ne,fe-Pt,A-Ne,fe),eo(A-Ne,fe+Pt,A-it,fe+Me,A,fe+Me),eo(A+it,fe+Me,A+Ne,fe+Pt,A+Ne,fe),fs(qe),this},f.__private__.circle=f.circle=function(A,fe,Ne,Me){if(isNaN(A)||isNaN(fe)||isNaN(Ne)||!ji(Me))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(A,fe,Ne,Ne,Me)},f.setFont=function(A,fe,Ne){return Ne&&(fe=re(fe,Ne)),Ye=vn(A,fe,{disableWarning:!1}),this};var Ha=f.__private__.getFont=f.getFont=function(){return nt[vn.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var A,fe,Ne={};for(A in He)if(He.hasOwnProperty(A))for(fe in Ne[A]=[],He[A])He[A].hasOwnProperty(fe)&&Ne[A].push(fe);return Ne},f.addFont=function(A,fe,Ne,Me,qe){var it=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&it.indexOf(arguments[3])!==-1?qe=arguments[3]:arguments[3]&&it.indexOf(arguments[3])==-1&&(Ne=re(Ne,Me)),qe=qe||"Identity-H",tr.call(this,A,fe,Ne,qe)};var Qr,Ga=t.lineWidth||.200025,Hs=f.__private__.getLineWidth=f.getLineWidth=function(){return Ga},Wa=f.__private__.setLineWidth=f.setLineWidth=function(A){return Ga=A,q(E(P(A))+" w"),this};f.__private__.setLineDash=sr.API.setLineDash=sr.API.setLineDashPattern=function(A,fe){if(A=A||[],fe=fe||0,isNaN(fe)||!Array.isArray(A))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return A=A.map(function(Ne){return E(P(Ne))}).join(" "),fe=E(P(fe)),q("["+A+"] "+fe+" d"),this};var Ya=f.__private__.getLineHeight=f.getLineHeight=function(){return ge*Qr};f.__private__.getLineHeight=f.getLineHeight=function(){return ge*Qr};var Ka=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(A){return typeof(A=A||1.15)=="number"&&(Qr=A),this},ms=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Qr};Ka(t.lineHeight);var to=f.__private__.getHorizontalCoordinate=function(A){return P(A)},Hn=f.__private__.getVerticalCoordinate=function(A){return oe===j.ADVANCED?A:wt[M].mediaBox.topRightY-wt[M].mediaBox.bottomLeftY-P(A)},Fl=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(A){return E(to(A))},Ho=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(A){return E(Hn(A))},oi=t.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return Ht(oi)},f.__private__.setStrokeColor=f.setDrawColor=function(A,fe,Ne,Me){return oi=Xt({ch1:A,ch2:fe,ch3:Ne,ch4:Me,pdfColorType:"draw",precision:2}),q(oi),this};var Gs=t.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return Ht(Gs)},f.__private__.setFillColor=f.setFillColor=function(A,fe,Ne,Me){return Gs=Xt({ch1:A,ch2:fe,ch3:Ne,ch4:Me,pdfColorType:"fill",precision:2}),q(Gs),this};var xo=t.textColor||"0 g",Ws=f.__private__.getTextColor=f.getTextColor=function(){return Ht(xo)};f.__private__.setTextColor=f.setTextColor=function(A,fe,Ne,Me){return xo=Xt({ch1:A,ch2:fe,ch3:Ne,ch4:Me,pdfColorType:"text",precision:3}),this};var ys=t.charSpace,Ys=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(ys||0)};f.__private__.setCharSpace=f.setCharSpace=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ys=A,this};var Ja=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(A){var fe=f.CapJoinStyles[A];if(fe===void 0)throw new Error("Line cap style of '"+A+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ja=fe,q(fe+" J"),this};var Ks=0;f.__private__.setLineJoin=f.setLineJoin=function(A){var fe=f.CapJoinStyles[A];if(fe===void 0)throw new Error("Line join style of '"+A+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ks=fe,q(fe+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(A){if(A=A||0,isNaN(A))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return q(E(P(A))+" M"),this},f.GState=qu,f.setGState=function(A){(A=typeof A=="string"?It[Xe[A]]:Go(null,A)).equals(kt)||(q("/"+A.id+" gs"),kt=A)};var Go=function(A,fe){if(!A||!Xe[A]){var Ne=!1;for(var Me in It)if(It.hasOwnProperty(Me)&&It[Me].equals(fe)){Ne=!0;break}if(Ne)fe=It[Me];else{var qe="GS"+(Object.keys(It).length+1).toString(10);It[qe]=fe,fe.id=qe}return A&&(Xe[A]=fe.id),Rt.publish("addGState",fe),fe}};f.addGState=function(A,fe){return Go(A,fe),this},f.saveGraphicsState=function(){return q("q"),mt.push({key:Ye,size:ge,color:xo}),this},f.restoreGraphicsState=function(){q("Q");var A=mt.pop();return Ye=A.key,ge=A.size,xo=A.color,kt=null,this},f.setCurrentTransformationMatrix=function(A){return q(A.toString()+" cm"),this},f.comment=function(A){return q("#"+A),this};var gs=function(A,fe){var Ne=A||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ne},set:function(it){isNaN(it)||(Ne=parseFloat(it))}});var Me=fe||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Me},set:function(it){isNaN(it)||(Me=parseFloat(it))}});var qe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return qe},set:function(it){qe=it.toString()}}),this},Js=function(A,fe,Ne,Me){gs.call(this,A,fe),this.type="rect";var qe=Ne||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return qe},set:function(Pt){isNaN(Pt)||(qe=parseFloat(Pt))}});var it=Me||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return it},set:function(Pt){isNaN(Pt)||(it=parseFloat(Pt))}}),this},vs=function(){this.page=Tt,this.currentPage=M,this.pages=V.slice(0),this.pagesContext=wt.slice(0),this.x=We,this.y=Ke,this.matrix=st,this.width=Wo(M),this.height=gi(M),this.outputDestination=ee,this.id="",this.objectNumber=-1};vs.prototype.restore=function(){Tt=this.page,M=this.currentPage,wt=this.pagesContext,V=this.pages,We=this.x,Ke=this.y,st=this.matrix,Xs(M,this.width),Zs(M,this.height),ee=this.outputDestination};var Qs=function(A,fe,Ne,Me,qe){xt.push(new vs),Tt=M=0,V=[],We=A,Ke=fe,st=qe,Lr([Ne,Me])},Ol=function(A){if(Ct[A])xt.pop().restore();else{var fe=new vs,Ne="Xo"+(Object.keys(ze).length+1).toString(10);fe.id=Ne,Ct[A]=Ne,ze[Ne]=fe,Rt.publish("addFormObject",fe),xt.pop().restore()}};for(var Ao in f.beginFormObject=function(A,fe,Ne,Me,qe){return Qs(A,fe,Ne,Me,qe),this},f.endFormObject=function(A){return Ol(A),this},f.doFormObject=function(A,fe){var Ne=ze[Ct[A]];return q("q"),q(fe.toString()+" cm"),q("/"+Ne.id+" Do"),q("Q"),this},f.getFormObject=function(A){var fe=ze[Ct[A]];return{x:fe.x,y:fe.y,width:fe.width,height:fe.height,matrix:fe.matrix}},f.save=function(A,fe){return A=A||"generated.pdf",(fe=fe||{}).returnPromise=fe.returnPromise||!1,fe.returnPromise===!1?(cl(Bi(Pn()),A),typeof cl.unload=="function"&&dr.setTimeout&&setTimeout(cl.unload,911),this):new Promise(function(Ne,Me){try{var qe=cl(Bi(Pn()),A);typeof cl.unload=="function"&&dr.setTimeout&&setTimeout(cl.unload,911),Ne(qe)}catch(it){Me(it.message)}})},sr.API)sr.API.hasOwnProperty(Ao)&&(Ao==="events"&&sr.API.events.length?function(A,fe){var Ne,Me,qe;for(qe=fe.length-1;qe!==-1;qe--)Ne=fe[qe][0],Me=fe[qe][1],A.subscribe.apply(A,[Ne].concat(typeof Me=="function"?[Me]:Me))}(Rt,sr.API.events):f[Ao]=sr.API[Ao]);var Wo=f.getPageWidth=function(A){return(wt[A=A||M].mediaBox.topRightX-wt[A].mediaBox.bottomLeftX)/Be},Xs=f.setPageWidth=function(A,fe){wt[A].mediaBox.topRightX=fe*Be+wt[A].mediaBox.bottomLeftX},gi=f.getPageHeight=function(A){return(wt[A=A||M].mediaBox.topRightY-wt[A].mediaBox.bottomLeftY)/Be},Zs=f.setPageHeight=function(A,fe){wt[A].mediaBox.topRightY=fe*Be+wt[A].mediaBox.bottomLeftY};return f.internal={pdfEscape:qr,getStyle:Vo,getFont:Ha,getFontSize:pe,getCharSpace:Ys,getTextColor:Ws,getLineHeight:Ya,getLineHeightFactor:ms,getLineWidth:Hs,write:ue,getHorizontalCoordinate:to,getVerticalCoordinate:Hn,getCoordinateString:Fl,getVerticalCoordinateString:Ho,collections:{},newObject:Jt,newAdditionalObject:$t,newObjectDeferred:lt,newObjectDeferredBegin:gt,getFilters:er,putStream:Kt,events:Rt,scaleFactor:Be,pageSize:{getWidth:function(){return Wo(M)},setWidth:function(A){Xs(M,A)},getHeight:function(){return gi(M)},setHeight:function(A){Zs(M,A)}},encryptionOptions:h,encryption:Rr,getEncryptor:mi,output:fi,getNumberOfPages:ar,pages:V,out:q,f2:B,f3:_,getPageInfo:yi,getPageInfoByObjId:nr,getCurrentPageInfo:uo,getPDFVersion:x,Point:gs,Rectangle:Js,Matrix:tt,hasHotfix:Rn},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return Wo(M)},set:function(A){Xs(M,A)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return gi(M)},set:function(A){Zs(M,A)},enumerable:!0,configurable:!0}),Nr.call(f,de),Ye="F1",ti(i,r),Rt.publish("initialized"),f}uc.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},uc.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},uc.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},uc.prototype.processOwnerPassword=function(t,e){return Em($m(e).substr(0,5),t)},uc.prototype.encryptor=function(t,e){var r=$m(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return Em(r,n)}},qu.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||rn(t)!==rn(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},sr.API={events:[]},sr.version="3.0.1";var xn=sr.API,Gy=1,Ml=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},rc=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},wr=function(t){return t.toFixed(2)},ya=function(t){return t.toFixed(5)};xn.__acroform__={};var Xi=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},H0=function(t){return t*Gy},Zo=function(t){var e=new Y5,r=Yt.internal.getHeight(t)||0,n=Yt.internal.getWidth(t)||0;return e.BBox=[0,0,Number(wr(n)),Number(wr(r))],e},FL=xn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},OL=xn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},BL=xn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(t&1<<e)==0?0:1},Tn=xn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return BL(t,e-1)},kn=xn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return FL(t,e-1)},Nn=xn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return OL(t,e-1)},jL=xn.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],o=t[1],s=t[2],l=t[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(o+l)||0,c.upperRight_X=r(i+s)||0,c.upperRight_Y=n(o)||0,[Number(wr(c.lowerLeft_X)),Number(wr(c.lowerLeft_Y)),Number(wr(c.upperRight_X)),Number(wr(c.upperRight_Y))]},VL=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=Tm(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+wr(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=Zo(t);return o.scope=t.scope,o.stream=e.join(`
`),o}},Tm=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(_){return _.split(`
`)}):i.map(function(_){return[_]});var o=r,s=Yt.internal.getHeight(t)||0;s=s<0?-s:s;var l=Yt.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(_,P,b){if(_+1<i.length){var H=P+" "+i[_+1][0];return Wd(H,t,b).width<=l-4}return!1};o++;e:for(;o>0;){e="",o--;var u,h,m=Wd("3",t,o).height,g=t.multiline?s-o:(s-m)/2,f=g+=2,w=0,x=0,S=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+Wd(e,t,o=12).width+", FieldWidth:"+l+`
`;break}for(var C="",j=0,oe=0;oe<i.length;oe++)if(i.hasOwnProperty(oe)){var te=!1;if(i[oe].length!==1&&S!==i[oe].length-1){if((m+2)*(j+2)+2>s)continue e;C+=i[oe][S],te=!0,x=oe,oe--}else{C=(C+=i[oe][S]+" ").substr(C.length-1)==" "?C.substr(0,C.length-1):C;var Z=parseInt(oe),re=c(Z,C,o),E=oe>=i.length-1;if(re&&!E){C+=" ",S=0;continue}if(re||E){if(E)x=Z;else if(t.multiline&&(m+2)*(j+2)+2>s)continue e}else{if(!t.multiline||(m+2)*(j+2)+2>s)continue e;x=Z}}for(var $="",T=w;T<=x;T++){var B=i[T];if(t.multiline){if(T===x){$+=B[S]+" ",S=(S+1)%B.length;continue}if(T===w){$+=B[B.length-1]+" ";continue}}$+=B[0]+" "}switch($=$.substr($.length-1)==" "?$.substr(0,$.length-1):$,h=Wd($,t,o).width,t.textAlign){case"right":u=l-h-2;break;case"center":u=(l-h)/2;break;case"left":default:u=2}e+=wr(u)+" "+wr(f)+` Td
`,e+="("+Ml($)+`) Tj
`,e+=-wr(u)+` 0 Td
`,f=-(o+2),h=0,w=te?x:x+1,j++,C=""}break}return n.text=e,n.fontSize=o,n},Wd=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},qL={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},zL=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},UL=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var n=r,i=t[r];e.internal.newObjectDeferredBegin(i.objId,!0),rn(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete t[n]}},HL=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Bo.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(qL)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Gy=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new K5,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];o.objId=void 0,o.hasAnnotation&&zL(o,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var o=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var l=n[s],c=[],u=l.Rect;if(l.Rect&&(l.Rect=jL(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Yt.createDefaultAppearanceStream(l),rn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var h=VL(l);c.push({key:"AP",value:"<</N "+h+">>"}),i.internal.acroformPlugin.xForms.push(h)}if(l.appearanceStreamContent){var m="";for(var g in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(g)){var f=l.appearanceStreamContent[g];if(m+="/"+g+" ",m+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var s in f)if(f.hasOwnProperty(s)){var w=f[s];typeof w=="function"&&(w=w.call(i,l)),m+="/"+s+" "+w+" ",i.internal.acroformPlugin.xForms.indexOf(w)>=0||i.internal.acroformPlugin.xForms.push(w)}}else typeof(w=f)=="function"&&(w=w.call(i,l)),m+="/"+s+" "+w,i.internal.acroformPlugin.xForms.indexOf(w)>=0||i.internal.acroformPlugin.xForms.push(w);m+=">>"}c.push({key:"AP",value:`<<
`+m+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}o&&UL(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},W5=xn.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(s){return s};if(Array.isArray(t)){for(var i="[",o=0;o<t.length;o++)switch(o!==0&&(i+=" "),rn(t[o])){case"boolean":case"number":case"object":i+=t[o].toString();break;case"string":t[o].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+Ml(n(t[o].toString()))+")"):i+=t[o].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Cf=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),t="("+Ml(n(t))+")"},rs=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};rs.prototype.toString=function(){return this.objId+" 0 R"},rs.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},rs.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:W5(i,this.objId,this.scope)}):i instanceof rs?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var Y5=function(){rs.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Xi(Y5,rs);var K5=function(){rs.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Ml(r(t))+")"}},set:function(r){t=r}})};Xi(K5,rs);var Bo=function t(){rs.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(C){if(isNaN(C))throw new Error('Invalid value "'+C+'" for attribute F supplied.');e=C}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Tn(e,3)},set:function(C){C?this.F=kn(e,3):this.F=Nn(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(C){if(isNaN(C))throw new Error('Invalid value "'+C+'" for attribute Ff supplied.');r=C}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(C){n=C!==void 0?C:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(C){n[0]=C}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(C){n[1]=C}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(C){n[2]=C}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(C){n[3]=C}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(C){switch(C){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=C;break;default:throw new Error('Invalid value "'+C+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof zh)return;o="FieldObject"+t.FieldNum++}var C=function(j){return j};return this.scope&&(C=this.scope.internal.getEncryptor(this.objId)),"("+Ml(C(o))+")"},set:function(C){o=C.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(C){o=C}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(C){s=C}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(C){l=C}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(C){c=C}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/Gy:u},set:function(C){u=C}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function(C){h=C}});var m="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!m||this instanceof zh||this instanceof ka))return Cf(m,this.objId,this.scope)},set:function(C){C=C.toString(),m=C}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof Yn?g:Cf(g,this.objId,this.scope)},set:function(C){C=C.toString(),g=this instanceof Yn?C:C.substr(0,1)==="("?rc(C.substr(1,C.length-2)):rc(C)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Yn?rc(g.substr(1,g.length-1)):g},set:function(C){C=C.toString(),g=this instanceof Yn?"/"+C:C}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(C){this.V=C}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Yn?f:Cf(f,this.objId,this.scope)},set:function(C){C=C.toString(),f=this instanceof Yn?C:C.substr(0,1)==="("?rc(C.substr(1,C.length-2)):rc(C)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Yn?rc(f.substr(1,f.length-1)):f},set:function(C){C=C.toString(),f=this instanceof Yn?"/"+C:C}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var w,x=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return x},set:function(C){C=!!C,x=C}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(w)return w},set:function(C){w=C}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,1)},set:function(C){C?this.Ff=kn(this.Ff,1):this.Ff=Nn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,2)},set:function(C){C?this.Ff=kn(this.Ff,2):this.Ff=Nn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,3)},set:function(C){C?this.Ff=kn(this.Ff,3):this.Ff=Nn(this.Ff,3)}});var S=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(S!==null)return S},set:function(C){if([0,1,2].indexOf(C)===-1)throw new Error('Invalid value "'+C+'" for attribute Q supplied.');S=C}}),Object.defineProperty(this,"textAlign",{get:function(){var C;switch(S){case 0:default:C="left";break;case 1:C="center";break;case 2:C="right"}return C},configurable:!0,enumerable:!0,set:function(C){switch(C){case"right":case 2:S=2;break;case"center":case 1:S=1;break;case"left":case 0:default:S=0}}})};Xi(Bo,rs);var Pl=function(){Bo.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return W5(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(o,s,l){l||(l=1);for(var c,u=[];c=s.exec(o);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,18)},set:function(r){r?this.Ff=kn(this.Ff,18):this.Ff=Nn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=kn(this.Ff,19):this.Ff=Nn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,20)},set:function(r){r?(this.Ff=kn(this.Ff,20),e.sort()):this.Ff=Nn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,22)},set:function(r){r?this.Ff=kn(this.Ff,22):this.Ff=Nn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,23)},set:function(r){r?this.Ff=kn(this.Ff,23):this.Ff=Nn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,27)},set:function(r){r?this.Ff=kn(this.Ff,27):this.Ff=Nn(this.Ff,27)}}),this.hasAppearanceStream=!1};Xi(Pl,Bo);var wl=function(){Pl.call(this),this.fontName="helvetica",this.combo=!1};Xi(wl,Pl);var xl=function(){wl.call(this),this.combo=!0};Xi(xl,wl);var Su=function(){xl.call(this),this.edit=!0};Xi(Su,xl);var Yn=function(){Bo.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,15)},set:function(r){r?this.Ff=kn(this.Ff,15):this.Ff=Nn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,16)},set:function(r){r?this.Ff=kn(this.Ff,16):this.Ff=Nn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,17)},set:function(r){r?this.Ff=kn(this.Ff,17):this.Ff=Nn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,26)},set:function(r){r?this.Ff=kn(this.Ff,26):this.Ff=Nn(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+Ml(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){rn(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Xi(Yn,Bo);var Pu=function(){Yn.call(this),this.pushButton=!0};Xi(Pu,Yn);var Al=function(){Yn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Xi(Al,Yn);var zh=function(){var t,e;Bo.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var o,s=[];for(o in s.push("<<"),n)s.push("/"+o+" ("+Ml(i(n[o]))+")");return s.push(">>"),s.join(`
`)},set:function(i){rn(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Yt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Xi(zh,Bo),Al.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Al.prototype.createOption=function(t){var e=new zh;return e.Parent=this,e.optionName=t,this.Kids.push(e),GL.call(this.scope,e),e};var wu=function(){Yn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Yt.CheckBox.createAppearanceStream()};Xi(wu,Yn);var ka=function(){Bo.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,13)},set:function(e){e?this.Ff=kn(this.Ff,13):this.Ff=Nn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,21)},set:function(e){e?this.Ff=kn(this.Ff,21):this.Ff=Nn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,23)},set:function(e){e?this.Ff=kn(this.Ff,23):this.Ff=Nn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,24)},set:function(e){e?this.Ff=kn(this.Ff,24):this.Ff=Nn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,25)},set:function(e){e?this.Ff=kn(this.Ff,25):this.Ff=Nn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,26)},set:function(e){e?this.Ff=kn(this.Ff,26):this.Ff=Nn(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Xi(ka,Bo);var xu=function(){ka.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,14)},set:function(t){t?this.Ff=kn(this.Ff,14):this.Ff=Nn(this.Ff,14)}}),this.password=!0};Xi(xu,ka);var Yt={CheckBox:{createAppearanceStream:function(){return{N:{On:Yt.CheckBox.YesNormal},D:{On:Yt.CheckBox.YesPushDown,Off:Yt.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=Zo(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),o=Tm(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+wr(Yt.internal.getWidth(t))+" "+wr(Yt.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+wr(o.fontSize)+" Tf "+i),r.push("BT"),r.push(o.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=Zo(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],o=Yt.internal.getHeight(t),s=Yt.internal.getWidth(t),l=Tm(t,t.caption);return i.push("1 g"),i.push("0 0 "+wr(s)+" "+wr(o)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+wr(s-1)+" "+wr(o-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+wr(l.fontSize)+" Tf "+n),i.push(l.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=Zo(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+wr(Yt.internal.getWidth(t))+" "+wr(Yt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Yt.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Yt.RadioButton.Circle.YesNormal,e.D[t]=Yt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=Zo(t);e.scope=t.scope;var r=[],n=Yt.internal.getWidth(t)<=Yt.internal.getHeight(t)?Yt.internal.getWidth(t)/4:Yt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Yt.internal.Bezier_C,o=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+ya(Yt.internal.getWidth(t)/2)+" "+ya(Yt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Zo(t);e.scope=t.scope;var r=[],n=Yt.internal.getWidth(t)<=Yt.internal.getHeight(t)?Yt.internal.getWidth(t)/4:Yt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*Yt.internal.Bezier_C).toFixed(5)),s=Number((n*Yt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ya(Yt.internal.getWidth(t)/2)+" "+ya(Yt.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+ya(Yt.internal.getWidth(t)/2)+" "+ya(Yt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=Zo(t);e.scope=t.scope;var r=[],n=Yt.internal.getWidth(t)<=Yt.internal.getHeight(t)?Yt.internal.getWidth(t)/4:Yt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*Yt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ya(Yt.internal.getWidth(t)/2)+" "+ya(Yt.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Yt.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Yt.RadioButton.Cross.YesNormal,e.D[t]=Yt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=Zo(t);e.scope=t.scope;var r=[],n=Yt.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+wr(Yt.internal.getWidth(t)-2)+" "+wr(Yt.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(wr(n.x1.x)+" "+wr(n.x1.y)+" m"),r.push(wr(n.x2.x)+" "+wr(n.x2.y)+" l"),r.push(wr(n.x4.x)+" "+wr(n.x4.y)+" m"),r.push(wr(n.x3.x)+" "+wr(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=Zo(t);e.scope=t.scope;var r=Yt.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+wr(Yt.internal.getWidth(t))+" "+wr(Yt.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+wr(Yt.internal.getWidth(t)-2)+" "+wr(Yt.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(wr(r.x1.x)+" "+wr(r.x1.y)+" m"),n.push(wr(r.x2.x)+" "+wr(r.x2.y)+" l"),n.push(wr(r.x4.x)+" "+wr(r.x4.y)+" m"),n.push(wr(r.x3.x)+" "+wr(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=Zo(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+wr(Yt.internal.getWidth(t))+" "+wr(Yt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};Yt.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Yt.internal.getWidth(t),r=Yt.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},Yt.internal.getWidth=function(t){var e=0;return rn(t)==="object"&&(e=H0(t.Rect[2])),e},Yt.internal.getHeight=function(t){var e=0;return rn(t)==="object"&&(e=H0(t.Rect[3])),e};var GL=xn.addField=function(t){if(HL(this,t),!(t instanceof Bo))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};xn.AcroFormChoiceField=Pl,xn.AcroFormListBox=wl,xn.AcroFormComboBox=xl,xn.AcroFormEditBox=Su,xn.AcroFormButton=Yn,xn.AcroFormPushButton=Pu,xn.AcroFormRadioButton=Al,xn.AcroFormCheckBox=wu,xn.AcroFormTextField=ka,xn.AcroFormPasswordField=xu,xn.AcroFormAppearance=Yt,xn.AcroForm={ChoiceField:Pl,ListBox:wl,ComboBox:xl,EditBox:Su,Button:Yn,PushButton:Pu,RadioButton:Al,CheckBox:wu,TextField:ka,PasswordField:xu,Appearance:Yt},sr.AcroForm={ChoiceField:Pl,ListBox:wl,ComboBox:xl,EditBox:Su,Button:Yn,PushButton:Pu,RadioButton:Al,CheckBox:wu,TextField:ka,PasswordField:xu,Appearance:Yt};var WL=sr.AcroForm;function J5(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(_,P){var b,H,K,R,k,W=e;if((P=P||e)==="RGBA"||_.data!==void 0&&_.data instanceof Uint8ClampedArray&&"height"in _&&"width"in _)return"RGBA";if(re(_))for(k in r)for(K=r[k],b=0;b<K.length;b+=1){for(R=!0,H=0;H<K[b].length;H+=1)if(K[b][H]!==void 0&&K[b][H]!==_[H]){R=!1;break}if(R===!0){W=k;break}}else for(k in r)for(K=r[k],b=0;b<K.length;b+=1){for(R=!0,H=0;H<K[b].length;H+=1)if(K[b][H]!==void 0&&K[b][H]!==_.charCodeAt(H)){R=!1;break}if(R===!0){W=k;break}}return W===e&&P!==e&&(W=P),W},i=function _(P){for(var b=this.internal.write,H=this.internal.putStream,K=(0,this.internal.getFilters)();K.indexOf("FlateEncode")!==-1;)K.splice(K.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var R=[];if(R.push({key:"Type",value:"/XObject"}),R.push({key:"Subtype",value:"/Image"}),R.push({key:"Width",value:P.width}),R.push({key:"Height",value:P.height}),P.colorSpace===S.INDEXED?R.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(R.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===S.DEVICE_CMYK&&R.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),R.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&R.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)){for(var k="",W=0,z=P.transparency.length;W<z;W++)k+=P.transparency[W]+" "+P.transparency[W]+" ";R.push({key:"Mask",value:"["+k+"]"})}P.sMask!==void 0&&R.push({key:"SMask",value:P.objectId+1+" 0 R"});var U=P.filter!==void 0?["/"+P.filter]:void 0;if(H({data:P.data,additionalKeyValues:R,alreadyAppliedFilters:U,objectId:P.objectId}),b("endobj"),"sMask"in P&&P.sMask!==void 0){var le="/Predictor "+P.predictor+" /Colors 1 /BitsPerComponent "+P.bitsPerComponent+" /Columns "+P.width,L={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:P.bitsPerComponent,decodeParameters:le,data:P.sMask};"filter"in P&&(L.filter=P.filter),_.call(this,L)}if(P.colorSpace===S.INDEXED){var M=this.internal.newObject();H({data:$(new Uint8Array(P.palette)),objectId:M}),b("endobj")}},o=function(){var _=this.internal.collections.addImage_images;for(var P in _)i.call(this,_[P])},s=function(){var _,P=this.internal.collections.addImage_images,b=this.internal.write;for(var H in P)b("/I"+(_=P[H]).index,_.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",s))},c=function(){var _=this.internal.collections.addImage_images;return l.call(this),_},u=function(){return Object.keys(this.internal.collections.addImage_images).length},h=function(_){return typeof t["process"+_.toUpperCase()]=="function"},m=function(_){return rn(_)==="object"&&_.nodeType===1},g=function(_,P){if(_.nodeName==="IMG"&&_.hasAttribute("src")){var b=""+_.getAttribute("src");if(b.indexOf("data:image/")===0)return _u(unescape(b).split("base64,").pop());var H=t.loadFile(b,!0);if(H!==void 0)return H}if(_.nodeName==="CANVAS"){if(_.width===0||_.height===0)throw new Error("Given canvas must have data. Canvas width: "+_.width+", height: "+_.height);var K;switch(P){case"PNG":K="image/png";break;case"WEBP":K="image/webp";break;case"JPEG":case"JPG":default:K="image/jpeg"}return _u(_.toDataURL(K,1).split("base64,").pop())}},f=function(_){var P=this.internal.collections.addImage_images;if(P){for(var b in P)if(_===P[b].alias)return P[b]}},w=function(_,P,b){return _||P||(_=-96,P=-96),_<0&&(_=-1*b.width*72/_/this.internal.scaleFactor),P<0&&(P=-1*b.height*72/P/this.internal.scaleFactor),_===0&&(_=P*b.width/b.height),P===0&&(P=_*b.height/b.width),[_,P]},x=function(_,P,b,H,K,R){var k=w.call(this,b,H,K),W=this.internal.getCoordinateString,z=this.internal.getVerticalCoordinateString,U=c.call(this);if(b=k[0],H=k[1],U[K.index]=K,R){R*=Math.PI/180;var le=Math.cos(R),L=Math.sin(R),M=function(I){return I.toFixed(4)},G=[M(le),M(L),M(-1*L),M(le),0,0,"cm"]}this.internal.write("q"),R?(this.internal.write([1,"0","0",1,W(_),z(P+H),"cm"].join(" ")),this.internal.write(G.join(" ")),this.internal.write([W(b),"0","0",W(H),"0","0","cm"].join(" "))):this.internal.write([W(b),"0","0",W(H),W(_),z(P+H),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+K.index+" Do"),this.internal.write("Q")},S=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var C=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},j=t.__addimage__.sHashCode=function(_){var P,b,H=0;if(typeof _=="string")for(b=_.length,P=0;P<b;P++)H=(H<<5)-H+_.charCodeAt(P),H|=0;else if(re(_))for(b=_.byteLength/2,P=0;P<b;P++)H=(H<<5)-H+_[P],H|=0;return H},oe=t.__addimage__.validateStringAsBase64=function(_){(_=_||"").toString().trim();var P=!0;return _.length===0&&(P=!1),_.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(_.substr(0,_.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(_.substr(-2))===!1&&(P=!1),P},te=t.__addimage__.extractImageFromDataUrl=function(_){if(_==null||!(_=_.trim()).startsWith("data:"))return null;var P=_.indexOf(",");return P<0?null:_.substring(0,P).trim().endsWith("base64")?_.substring(P+1):null},Z=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(_){return Z()&&_ instanceof ArrayBuffer};var re=t.__addimage__.isArrayBufferView=function(_){return Z()&&typeof Uint32Array<"u"&&(_ instanceof Int8Array||_ instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&_ instanceof Uint8ClampedArray||_ instanceof Int16Array||_ instanceof Uint16Array||_ instanceof Int32Array||_ instanceof Uint32Array||_ instanceof Float32Array||_ instanceof Float64Array)},E=t.__addimage__.binaryStringToUint8Array=function(_){for(var P=_.length,b=new Uint8Array(P),H=0;H<P;H++)b[H]=_.charCodeAt(H);return b},$=t.__addimage__.arrayBufferToBinaryString=function(_){for(var P="",b=re(_)?_:new Uint8Array(_),H=0;H<b.length;H+=8192)P+=String.fromCharCode.apply(null,b.subarray(H,H+8192));return P};t.addImage=function(){var _,P,b,H,K,R,k,W,z;if(typeof arguments[1]=="number"?(P=e,b=arguments[1],H=arguments[2],K=arguments[3],R=arguments[4],k=arguments[5],W=arguments[6],z=arguments[7]):(P=arguments[1],b=arguments[2],H=arguments[3],K=arguments[4],R=arguments[5],k=arguments[6],W=arguments[7],z=arguments[8]),rn(_=arguments[0])==="object"&&!m(_)&&"imageData"in _){var U=_;_=U.imageData,P=U.format||P||e,b=U.x||b||0,H=U.y||H||0,K=U.w||U.width||K,R=U.h||U.height||R,k=U.alias||k,W=U.compression||W,z=U.rotation||U.angle||z}var le=this.internal.getFilters();if(W===void 0&&le.indexOf("FlateEncode")!==-1&&(W="SLOW"),isNaN(b)||isNaN(H))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var L=T.call(this,_,P,k,W);return x.call(this,b,H,K,R,L,z),this};var T=function(_,P,b,H){var K,R,k;if(typeof _=="string"&&n(_)===e){_=unescape(_);var W=B(_,!1);(W!==""||(W=t.loadFile(_,!0))!==void 0)&&(_=W)}if(m(_)&&(_=g(_,P)),P=n(_,P),!h(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((k=b)==null||k.length===0)&&(b=function(z){return typeof z=="string"||re(z)?j(z):re(z.data)?j(z.data):null}(_)),(K=f.call(this,b))||(Z()&&(_ instanceof Uint8Array||P==="RGBA"||(R=_,_=E(_))),K=this["process"+P.toUpperCase()](_,u.call(this),b,function(z){return z&&typeof z=="string"&&(z=z.toUpperCase()),z in t.image_compression?z:C.NONE}(H),R)),!K)throw new Error("An unknown error occurred whilst processing the image.");return K},B=t.__addimage__.convertBase64ToBinaryString=function(_,P){P=typeof P!="boolean"||P;var b,H="";if(typeof _=="string"){var K;b=(K=te(_))!==null&&K!==void 0?K:_;try{H=_u(b)}catch(R){if(P)throw oe(b)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+R.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return H};t.getImageProperties=function(_){var P,b,H="";if(m(_)&&(_=g(_)),typeof _=="string"&&n(_)===e&&((H=B(_,!1))===""&&(H=t.loadFile(_)||""),_=H),b=n(_),!h(b))throw new Error("addImage does not support files of type '"+b+"', please ensure that a plugin for '"+b+"' support is added.");if(!Z()||_ instanceof Uint8Array||(_=E(_)),!(P=this["process"+b.toUpperCase()](_)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=b,P}})(sr.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};sr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,o,s=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,h=!1,m=0;m<u.length&&!h;m++)switch((n=u[m]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var g=0;g<u.length;g++){n=u[g];var f=this.internal.pdfEscape,w=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var x=this.internal.newAdditionalObject(),S=this.internal.newAdditionalObject(),C=this.internal.getEncryptor(x.objId),j=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+f(C(n.contents))+")",o+=" /Popup "+S.objId+" 0 R",o+=" /P "+c.objId+" 0 R",o+=" /T ("+f(C(j))+") >>",x.content=o;var oe=x.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+oe,n.open&&(o+=" /Open true"),o+=" >>",S.content=o,this.internal.write(x.objId,"0 R",S.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+l(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var te=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+f(w(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+te+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(n.options.name){var Z=this.annotations._nameMap[n.options.name];n.options.pageNumber=Z.page,n.options.top=Z.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+f(w(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var re=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+re+" "+n.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,o,s){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+i),h:u(n+o)},options:s,type:"link"})},t.textWithLink=function(r,n,i,o){var s,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){l=o.maxWidth;var h=this.splitTextToSize(r,l).length;s=Math.ceil(u*h)}else l=c,s=u;return this.text(r,n,i,o),i+=.2*u,o.align==="center"&&(n-=c/2),o.align==="right"&&(n-=c),this.link(n,i-u,l,s,o),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(sr.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var o=t.__arabicParser__.isInArabicSubstitutionA=function(x){return e[x.charCodeAt(0)]!==void 0},s=t.__arabicParser__.isArabicLetter=function(x){return typeof x=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(x)},l=t.__arabicParser__.isArabicEndLetter=function(x){return s(x)&&o(x)&&e[x.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(x){return s(x)&&i.indexOf(x.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(x){return s(x)&&o(x)&&e[x.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(x){return s(x)&&o(x)&&e[x.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(x){return s(x)&&o(x)&&e[x.charCodeAt(0)].length>=3};var h=t.__arabicParser__.arabicLetterHasMedialForm=function(x){return s(x)&&o(x)&&e[x.charCodeAt(0)].length==4},m=t.__arabicParser__.resolveLigatures=function(x){var S=0,C=r,j="",oe=0;for(S=0;S<x.length;S+=1)C[x.charCodeAt(S)]!==void 0?(oe++,typeof(C=C[x.charCodeAt(S)])=="number"&&(j+=String.fromCharCode(C),C=r,oe=0),S===x.length-1&&(C=r,j+=x.charAt(S-(oe-1)),S-=oe-1,oe=0)):(C=r,j+=x.charAt(S-oe),S-=oe,oe=0);return j};t.__arabicParser__.isArabicDiacritic=function(x){return x!==void 0&&n[x.charCodeAt(0)]!==void 0};var g=t.__arabicParser__.getCorrectForm=function(x,S,C){return s(x)?o(x)===!1?-1:!u(x)||!s(S)&&!s(C)||!s(C)&&l(S)||l(x)&&!s(S)||l(x)&&c(S)||l(x)&&l(S)?0:h(x)&&s(S)&&!l(S)&&s(C)&&u(C)?3:l(x)||!s(C)?1:2:-1},f=function(x){var S=0,C=0,j=0,oe="",te="",Z="",re=(x=x||"").split("\\s+"),E=[];for(S=0;S<re.length;S+=1){for(E.push(""),C=0;C<re[S].length;C+=1)oe=re[S][C],te=re[S][C-1],Z=re[S][C+1],s(oe)?(j=g(oe,te,Z),E[S]+=j!==-1?String.fromCharCode(e[oe.charCodeAt(0)][j]):oe):E[S]+=oe;E[S]=m(E[S])}return E.join(" ")},w=t.__arabicParser__.processArabic=t.processArabic=function(){var x,S=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,C=[];if(Array.isArray(S)){var j=0;for(C=[],j=0;j<S.length;j+=1)Array.isArray(S[j])?C.push([f(S[j][0]),S[j][1],S[j][2]]):C.push([f(S[j])]);x=C}else x=f(S);return typeof arguments[0]=="string"?x:(arguments[0].text=x,arguments[0])};t.events.push(["preProcessText",w])}(sr.API),sr.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(l){o=l}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(l){s=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(sr.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(x){c=x}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(x){u=x}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(x){h=x}});var m=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return m},set:function(x){m=x}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(x){g=x}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(x){f=x}});var w=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return w},set:function(x){w=x}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var h=(u=u||{}).fontSize||this.getFontSize(),m=u.font||this.getFont(),g=u.scaleFactor||this.internal.scaleFactor,f=0,w=0,x=0,S=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var C=u.maxWidth;C>0?typeof c=="string"?c=this.splitTextToSize(c,C):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(oe,te){return oe.concat(S.splitTextToSize(te,C))},[])):c=Array.isArray(c)?c:[c];for(var j=0;j<c.length;j++)f<(x=this.getStringUnitWidth(c[j],{font:m})*h)&&(f=x);return f!==0&&(w=c.length),{w:f/=g,h:Math.max((w*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/g,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var c;c=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,m=this.internal.__cell__.margins||e,g=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+m.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=m.top,f&&g&&(this.printHeaderRow(c.lineNumber,!0),c.y+=g[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-h,c.y+h,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+h,{align:"center",baseline:"top",maxWidth:c.width-h-h}):this.text(c.text,c.x+h,c.y+h,{align:"left",baseline:"top",maxWidth:c.width-h-h})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,h,m,g){if(n.call(this),!h)throw new Error("No data for PDF table.");var f,w,x,S,C=[],j=[],oe=[],te={},Z={},re=[],E=[],$=(g=g||{}).autoSize||!1,T=g.printHeaders!==!1,B=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,_=g.margins||Object.assign({width:this.getPageWidth()},e),P=typeof g.padding=="number"?g.padding:3,b=g.headerBackgroundColor||"#c8c8c8",H=g.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=T,this.internal.__cell__.margins=_,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=b,this.internal.__cell__.headerTextColor=H,this.setFontSize(B),m==null)j=C=Object.keys(h[0]),oe=C.map(function(){return"left"});else if(Array.isArray(m)&&rn(m[0])==="object")for(C=m.map(function(U){return U.name}),j=m.map(function(U){return U.prompt||U.name||""}),oe=m.map(function(U){return U.align||"left"}),f=0;f<m.length;f+=1)Z[m[f].name]=m[f].width*(19.049976/25.4);else Array.isArray(m)&&typeof m[0]=="string"&&(j=C=m,oe=C.map(function(){return"left"}));if($||Array.isArray(m)&&typeof m[0]=="string")for(f=0;f<C.length;f+=1){for(te[S=C[f]]=h.map(function(U){return U[S]}),this.setFont(void 0,"bold"),re.push(this.getTextDimensions(j[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),w=te[S],this.setFont(void 0,"normal"),x=0;x<w.length;x+=1)re.push(this.getTextDimensions(w[x],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Z[S]=Math.max.apply(null,re)+P+P,re=[]}if(T){var K={};for(f=0;f<C.length;f+=1)K[C[f]]={},K[C[f]].text=j[f],K[C[f]].align=oe[f];var R=l.call(this,K,Z);E=C.map(function(U){return new o(c,u,Z[U],R,K[U].text,void 0,K[U].align)}),this.setTableHeaderRow(E),this.printHeaderRow(1,!1)}var k=m.reduce(function(U,le){return U[le.name]=le.align,U},{});for(f=0;f<h.length;f+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:f,data:h[f]},this);var W=l.call(this,h[f],Z);for(x=0;x<C.length;x+=1){var z=h[f][C[x]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:f,col:x,data:z},this),s.call(this,new o(c,u,Z[C[x]],W,z,f+2,k[C[x]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var h=this.internal.__cell__.padding,m=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(c).map(function(f){var w=c[f];return this.splitTextToSize(w.hasOwnProperty("text")?w.text:w,u[f]-h-h)},this).map(function(f){return this.getLineHeightFactor()*f.length*m/g+h+h},this).reduce(function(f,w){return Math.max(f,w)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var m=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(m[0],m[1],m[2],m[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){h=this.internal.__cell__.tableHeaderRow[f].clone(),u&&(h.y=this.internal.__cell__.margins.top||0,g.push(h)),h.lineNumber=c;var w=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,h),this.setTextColor(w)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),r=!1}}(sr.API);var Q5={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},X5=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],km=J5(X5),Z5=[100,200,300,400,500,600,700,800,900],YL=J5(Z5);function Nm(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(o){return Q5[o=o||"normal"]?o:"normal"}(t.style),n=function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}}(t.weight),i=function(o){return typeof km[o=o||"normal"]=="number"?o:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function G0(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var KL={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},W0={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Y0(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function JL(t,e,r){for(var n=(r=r||{}).defaultFontFamily||"times",i=Object.assign({},KL,r.genericFontFamilies||{}),o=null,s=null,l=0;l<e.length;++l)if(i[(o=Nm(e[l])).family]&&(o.family=i[o.family]),t.hasOwnProperty(o.family)){s=t[o.family];break}if(!(s=s||t[n]))throw new Error("Could not find a font-family for the rule '"+Y0(o)+"' and default family '"+n+"'.");if(s=function(c,u){if(u[c])return u[c];var h=km[c],m=h<=km.normal?-1:1,g=G0(u,X5,h,m);if(!g)throw new Error("Could not find a matching font-stretch value for "+c);return g}(o.stretch,s),s=function(c,u){if(u[c])return u[c];for(var h=Q5[c],m=0;m<h.length;++m)if(u[h[m]])return u[h[m]];throw new Error("Could not find a matching font-style for "+c)}(o.style,s),!(s=function(c,u){if(u[c])return u[c];if(c===400&&u[500])return u[500];if(c===500&&u[400])return u[400];var h=YL[c],m=G0(u,Z5,h,c<400?-1:1);if(!m)throw new Error("Could not find a matching font-weight for value "+c);return m}(o.weight,s)))throw new Error("Failed to resolve a font for the rule '"+Y0(o)+"'.");return s}function K0(t){return t.trimLeft()}function QL(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function XL(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Yd,J0,Q0,If=["times"];(function(t){var e,r,n,i,o,s,l,c,u,h=function(L){return L=L||{},this.isStrokeTransparent=L.isStrokeTransparent||!1,this.strokeOpacity=L.strokeOpacity||1,this.strokeStyle=L.strokeStyle||"#000000",this.fillStyle=L.fillStyle||"#000000",this.isFillTransparent=L.isFillTransparent||!1,this.fillOpacity=L.fillOpacity||1,this.font=L.font||"10px sans-serif",this.textBaseline=L.textBaseline||"alphabetic",this.textAlign=L.textAlign||"left",this.lineWidth=L.lineWidth||1,this.lineJoin=L.lineJoin||"miter",this.lineCap=L.lineCap||"butt",this.path=L.path||[],this.transform=L.transform!==void 0?L.transform.clone():new c,this.globalCompositeOperation=L.globalCompositeOperation||"normal",this.globalAlpha=L.globalAlpha||1,this.clip_path=L.clip_path||[],this.currentPoint=L.currentPoint||new s,this.miterLimit=L.miterLimit||10,this.lastPoint=L.lastPoint||new s,this.lineDashOffset=L.lineDashOffset||0,this.lineDash=L.lineDash||[],this.margin=L.margin||[0,0,0,0],this.prevPageLastElemOffset=L.prevPageLastElemOffset||0,this.ignoreClearRect=typeof L.ignoreClearRect!="boolean"||L.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new m(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,s=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new h}]);var m=function(L){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var M=L;Object.defineProperty(this,"pdf",{get:function(){return M}});var G=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return G},set:function(se){G=!!se}});var I=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return I},set:function(se){I=!!se}});var F=0;Object.defineProperty(this,"posX",{get:function(){return F},set:function(se){isNaN(se)||(F=se)}});var X=0;Object.defineProperty(this,"posY",{get:function(){return X},set:function(se){isNaN(se)||(X=se)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(se){var q;typeof se=="number"?q=[se,se,se,se]:((q=new Array(4))[0]=se[0],q[1]=se.length>=2?se[1]:q[0],q[2]=se.length>=3?se[2]:q[0],q[3]=se.length>=4?se[3]:q[1]),u.margin=q}});var Y=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Y},set:function(se){Y=se}});var Q=0;Object.defineProperty(this,"lastBreak",{get:function(){return Q},set:function(se){Q=se}});var J=[];Object.defineProperty(this,"pageBreaks",{get:function(){return J},set:function(se){J=se}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(se){se instanceof h&&(u=se)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(se){u.path=se}});var V=[];Object.defineProperty(this,"ctxStack",{get:function(){return V},set:function(se){V=se}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(se){var q;q=g(se),this.ctx.fillStyle=q.style,this.ctx.isFillTransparent=q.a===0,this.ctx.fillOpacity=q.a,this.pdf.setFillColor(q.r,q.g,q.b,{a:q.a}),this.pdf.setTextColor(q.r,q.g,q.b,{a:q.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(se){var q=g(se);this.ctx.strokeStyle=q.style,this.ctx.isStrokeTransparent=q.a===0,this.ctx.strokeOpacity=q.a,q.a===0?this.pdf.setDrawColor(255,255,255):(q.a,this.pdf.setDrawColor(q.r,q.g,q.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(se){["butt","round","square"].indexOf(se)!==-1&&(this.ctx.lineCap=se,this.pdf.setLineCap(se))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(se){isNaN(se)||(this.ctx.lineWidth=se,this.pdf.setLineWidth(se))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(se){["bevel","round","miter"].indexOf(se)!==-1&&(this.ctx.lineJoin=se,this.pdf.setLineJoin(se))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(se){isNaN(se)||(this.ctx.miterLimit=se,this.pdf.setMiterLimit(se))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(se){this.ctx.textBaseline=se}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(se){["right","end","center","left","start"].indexOf(se)!==-1&&(this.ctx.textAlign=se)}});var ne=null;function ee(se,q){if(ne===null){var ue=function(ye){var de=[];return Object.keys(ye).forEach(function(ge){ye[ge].forEach(function(xe){var pe=null;switch(xe){case"bold":pe={family:ge,weight:"bold"};break;case"italic":pe={family:ge,style:"italic"};break;case"bolditalic":pe={family:ge,weight:"bold",style:"italic"};break;case"":case"normal":pe={family:ge}}pe!==null&&(pe.ref={name:ge,style:xe},de.push(pe))})}),de}(se.getFontList());ne=function(ye){for(var de={},ge=0;ge<ye.length;++ge){var xe=Nm(ye[ge]),pe=xe.family,_e=xe.stretch,Re=xe.style,Ee=xe.weight;de[pe]=de[pe]||{},de[pe][_e]=de[pe][_e]||{},de[pe][_e][Re]=de[pe][_e][Re]||{},de[pe][_e][Re][Ee]=xe}return de}(ue.concat(q))}return ne}var ce=null;Object.defineProperty(this,"fontFaces",{get:function(){return ce},set:function(se){ne=null,ce=se}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(se){var q;if(this.ctx.font=se,(q=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(se))!==null){var ue=q[1];q[2];var ye=q[3],de=q[4];q[5];var ge=q[6],xe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(de)[2];de=Math.floor(xe==="px"?parseFloat(de)*this.pdf.internal.scaleFactor:xe==="em"?parseFloat(de)*this.pdf.getFontSize():parseFloat(de)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(de);var pe=function(De){var Ye,Be,We=[],Ke=De.trim();if(Ke==="")return If;if(Ke in W0)return[W0[Ke]];for(;Ke!=="";){switch(Be=null,Ye=(Ke=K0(Ke)).charAt(0)){case'"':case"'":Be=QL(Ke.substring(1),Ye);break;default:Be=XL(Ke)}if(Be===null||(We.push(Be[0]),(Ke=K0(Be[1]))!==""&&Ke.charAt(0)!==","))return If;Ke=Ke.replace(/^,/,"")}return We}(ge);if(this.fontFaces){var _e=JL(ee(this.pdf,this.fontFaces),pe.map(function(De){return{family:De,stretch:"normal",weight:ye,style:ue}}));this.pdf.setFont(_e.ref.name,_e.ref.style)}else{var Re="";(ye==="bold"||parseInt(ye,10)>=700||ue==="bold")&&(Re="bold"),ue==="italic"&&(Re+="italic"),Re.length===0&&(Re="normal");for(var Ee="",Te={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Le=0;Le<pe.length;Le++){if(this.pdf.internal.getFont(pe[Le],Re,{noFallback:!0,disableWarning:!0})!==void 0){Ee=pe[Le];break}if(Re==="bolditalic"&&this.pdf.internal.getFont(pe[Le],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ee=pe[Le],Re="bold";else if(this.pdf.internal.getFont(pe[Le],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ee=pe[Le],Re="normal";break}}if(Ee===""){for(var Ie=0;Ie<pe.length;Ie++)if(Te[pe[Ie]]){Ee=Te[pe[Ie]];break}}Ee=Ee===""?"Times":Ee,this.pdf.setFont(Ee,Re)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(se){this.ctx.globalCompositeOperation=se}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(se){this.ctx.globalAlpha=se}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(se){this.ctx.lineDashOffset=se,le.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(se){this.ctx.lineDash=se,le.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(se){this.ctx.ignoreClearRect=!!se}})};m.prototype.setLineDash=function(L){this.lineDash=L},m.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},m.prototype.fill=function(){te.call(this,"fill",!1)},m.prototype.stroke=function(){te.call(this,"stroke",!1)},m.prototype.beginPath=function(){this.path=[{type:"begin"}]},m.prototype.moveTo=function(L,M){if(isNaN(L)||isNaN(M))throw ln.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var G=this.ctx.transform.applyToPoint(new s(L,M));this.path.push({type:"mt",x:G.x,y:G.y}),this.ctx.lastPoint=new s(L,M)},m.prototype.closePath=function(){var L=new s(0,0),M=0;for(M=this.path.length-1;M!==-1;M--)if(this.path[M].type==="begin"&&rn(this.path[M+1])==="object"&&typeof this.path[M+1].x=="number"){L=new s(this.path[M+1].x,this.path[M+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(L.x,L.y)},m.prototype.lineTo=function(L,M){if(isNaN(L)||isNaN(M))throw ln.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var G=this.ctx.transform.applyToPoint(new s(L,M));this.path.push({type:"lt",x:G.x,y:G.y}),this.ctx.lastPoint=new s(G.x,G.y)},m.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),te.call(this,null,!0)},m.prototype.quadraticCurveTo=function(L,M,G,I){if(isNaN(G)||isNaN(I)||isNaN(L)||isNaN(M))throw ln.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var F=this.ctx.transform.applyToPoint(new s(G,I)),X=this.ctx.transform.applyToPoint(new s(L,M));this.path.push({type:"qct",x1:X.x,y1:X.y,x:F.x,y:F.y}),this.ctx.lastPoint=new s(F.x,F.y)},m.prototype.bezierCurveTo=function(L,M,G,I,F,X){if(isNaN(F)||isNaN(X)||isNaN(L)||isNaN(M)||isNaN(G)||isNaN(I))throw ln.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Y=this.ctx.transform.applyToPoint(new s(F,X)),Q=this.ctx.transform.applyToPoint(new s(L,M)),J=this.ctx.transform.applyToPoint(new s(G,I));this.path.push({type:"bct",x1:Q.x,y1:Q.y,x2:J.x,y2:J.y,x:Y.x,y:Y.y}),this.ctx.lastPoint=new s(Y.x,Y.y)},m.prototype.arc=function(L,M,G,I,F,X){if(isNaN(L)||isNaN(M)||isNaN(G)||isNaN(I)||isNaN(F))throw ln.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(X=!!X,!this.ctx.transform.isIdentity){var Y=this.ctx.transform.applyToPoint(new s(L,M));L=Y.x,M=Y.y;var Q=this.ctx.transform.applyToPoint(new s(0,G)),J=this.ctx.transform.applyToPoint(new s(0,0));G=Math.sqrt(Math.pow(Q.x-J.x,2)+Math.pow(Q.y-J.y,2))}Math.abs(F-I)>=2*Math.PI&&(I=0,F=2*Math.PI),this.path.push({type:"arc",x:L,y:M,radius:G,startAngle:I,endAngle:F,counterclockwise:X})},m.prototype.arcTo=function(L,M,G,I,F){throw new Error("arcTo not implemented.")},m.prototype.rect=function(L,M,G,I){if(isNaN(L)||isNaN(M)||isNaN(G)||isNaN(I))throw ln.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(L,M),this.lineTo(L+G,M),this.lineTo(L+G,M+I),this.lineTo(L,M+I),this.lineTo(L,M),this.lineTo(L+G,M),this.lineTo(L,M)},m.prototype.fillRect=function(L,M,G,I){if(isNaN(L)||isNaN(M)||isNaN(G)||isNaN(I))throw ln.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var F={};this.lineCap!=="butt"&&(F.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(F.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(L,M,G,I),this.fill(),F.hasOwnProperty("lineCap")&&(this.lineCap=F.lineCap),F.hasOwnProperty("lineJoin")&&(this.lineJoin=F.lineJoin)}},m.prototype.strokeRect=function(L,M,G,I){if(isNaN(L)||isNaN(M)||isNaN(G)||isNaN(I))throw ln.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");w.call(this)||(this.beginPath(),this.rect(L,M,G,I),this.stroke())},m.prototype.clearRect=function(L,M,G,I){if(isNaN(L)||isNaN(M)||isNaN(G)||isNaN(I))throw ln.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(L,M,G,I))},m.prototype.save=function(L){L=typeof L!="boolean"||L;for(var M=this.pdf.internal.getCurrentPageInfo().pageNumber,G=0;G<this.pdf.internal.getNumberOfPages();G++)this.pdf.setPage(G+1),this.pdf.internal.out("q");if(this.pdf.setPage(M),L){this.ctx.fontSize=this.pdf.internal.getFontSize();var I=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=I}},m.prototype.restore=function(L){L=typeof L!="boolean"||L;for(var M=this.pdf.internal.getCurrentPageInfo().pageNumber,G=0;G<this.pdf.internal.getNumberOfPages();G++)this.pdf.setPage(G+1),this.pdf.internal.out("Q");this.pdf.setPage(M),L&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},m.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(L){var M,G,I,F;if(L.isCanvasGradient===!0&&(L=L.getColor()),!L)return{r:0,g:0,b:0,a:0,style:L};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(L))M=0,G=0,I=0,F=0;else{var X=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(L);if(X!==null)M=parseInt(X[1]),G=parseInt(X[2]),I=parseInt(X[3]),F=1;else if((X=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(L))!==null)M=parseInt(X[1]),G=parseInt(X[2]),I=parseInt(X[3]),F=parseFloat(X[4]);else{if(F=1,typeof L=="string"&&L.charAt(0)!=="#"){var Y=new U5(L);L=Y.ok?Y.toHex():"#000000"}L.length===4?(M=L.substring(1,2),M+=M,G=L.substring(2,3),G+=G,I=L.substring(3,4),I+=I):(M=L.substring(1,3),G=L.substring(3,5),I=L.substring(5,7)),M=parseInt(M,16),G=parseInt(G,16),I=parseInt(I,16)}}return{r:M,g:G,b:I,a:F,style:L}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},w=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};m.prototype.fillText=function(L,M,G,I){if(isNaN(M)||isNaN(G)||typeof L!="string")throw ln.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(I=isNaN(I)?void 0:I,!f.call(this)){var F=W(this.ctx.transform.rotation),X=this.ctx.transform.scaleX;P.call(this,{text:L,x:M,y:G,scale:X,angle:F,align:this.textAlign,maxWidth:I})}},m.prototype.strokeText=function(L,M,G,I){if(isNaN(M)||isNaN(G)||typeof L!="string")throw ln.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!w.call(this)){I=isNaN(I)?void 0:I;var F=W(this.ctx.transform.rotation),X=this.ctx.transform.scaleX;P.call(this,{text:L,x:M,y:G,scale:X,renderingMode:"stroke",angle:F,align:this.textAlign,maxWidth:I})}},m.prototype.measureText=function(L){if(typeof L!="string")throw ln.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var M=this.pdf,G=this.pdf.internal.scaleFactor,I=M.internal.getFontSize(),F=M.getStringUnitWidth(L)*I/M.internal.scaleFactor,X=function(Y){var Q=(Y=Y||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Q}}),this};return new X({width:F*=Math.round(96*G/72*1e4)/1e4})},m.prototype.scale=function(L,M){if(isNaN(L)||isNaN(M))throw ln.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var G=new c(L,0,0,M,0,0);this.ctx.transform=this.ctx.transform.multiply(G)},m.prototype.rotate=function(L){if(isNaN(L))throw ln.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var M=new c(Math.cos(L),Math.sin(L),-Math.sin(L),Math.cos(L),0,0);this.ctx.transform=this.ctx.transform.multiply(M)},m.prototype.translate=function(L,M){if(isNaN(L)||isNaN(M))throw ln.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var G=new c(1,0,0,1,L,M);this.ctx.transform=this.ctx.transform.multiply(G)},m.prototype.transform=function(L,M,G,I,F,X){if(isNaN(L)||isNaN(M)||isNaN(G)||isNaN(I)||isNaN(F)||isNaN(X))throw ln.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Y=new c(L,M,G,I,F,X);this.ctx.transform=this.ctx.transform.multiply(Y)},m.prototype.setTransform=function(L,M,G,I,F,X){L=isNaN(L)?1:L,M=isNaN(M)?0:M,G=isNaN(G)?0:G,I=isNaN(I)?1:I,F=isNaN(F)?0:F,X=isNaN(X)?0:X,this.ctx.transform=new c(L,M,G,I,F,X)};var x=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};m.prototype.drawImage=function(L,M,G,I,F,X,Y,Q,J){var V=this.pdf.getImageProperties(L),ne=1,ee=1,ce=1,se=1;I!==void 0&&Q!==void 0&&(ce=Q/I,se=J/F,ne=V.width/I*Q/I,ee=V.height/F*J/F),X===void 0&&(X=M,Y=G,M=0,G=0),I!==void 0&&Q===void 0&&(Q=I,J=F),I===void 0&&Q===void 0&&(Q=V.width,J=V.height);for(var q,ue=this.ctx.transform.decompose(),ye=W(ue.rotate.shx),de=new c,ge=(de=(de=(de=de.multiply(ue.translate)).multiply(ue.skew)).multiply(ue.scale)).applyToRectangle(new l(X-M*ce,Y-G*se,I*ne,F*ee)),xe=S.call(this,ge),pe=[],_e=0;_e<xe.length;_e+=1)pe.indexOf(xe[_e])===-1&&pe.push(xe[_e]);if(oe(pe),this.autoPaging)for(var Re=pe[0],Ee=pe[pe.length-1],Te=Re;Te<Ee+1;Te++){this.pdf.setPage(Te);var Le=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ie=Te===1?this.posY+this.margin[0]:this.margin[0],De=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ye=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Be=Te===1?0:De+(Te-2)*Ye;if(this.ctx.clip_path.length!==0){var We=this.path;q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(q,this.posX+this.margin[3],-Be+Ie+this.ctx.prevPageLastElemOffset),Z.call(this,"fill",!0),this.path=We}var Ke=JSON.parse(JSON.stringify(ge));Ke=j([Ke],this.posX+this.margin[3],-Be+Ie+this.ctx.prevPageLastElemOffset)[0];var st=(Te>Re||Te<Ee)&&x.call(this);st&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Le,Ye,null).clip().discardPath()),this.pdf.addImage(L,"JPEG",Ke.x,Ke.y,Ke.w,Ke.h,null,null,ye),st&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(L,"JPEG",ge.x,ge.y,ge.w,ge.h,null,null,ye)};var S=function(L,M,G){var I=[];M=M||this.pdf.internal.pageSize.width,G=G||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var F=this.posY+this.ctx.prevPageLastElemOffset;switch(L.type){default:case"mt":case"lt":I.push(Math.floor((L.y+F)/G)+1);break;case"arc":I.push(Math.floor((L.y+F-L.radius)/G)+1),I.push(Math.floor((L.y+F+L.radius)/G)+1);break;case"qct":var X=z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,L.x1,L.y1,L.x,L.y);I.push(Math.floor((X.y+F)/G)+1),I.push(Math.floor((X.y+X.h+F)/G)+1);break;case"bct":var Y=U(this.ctx.lastPoint.x,this.ctx.lastPoint.y,L.x1,L.y1,L.x2,L.y2,L.x,L.y);I.push(Math.floor((Y.y+F)/G)+1),I.push(Math.floor((Y.y+Y.h+F)/G)+1);break;case"rect":I.push(Math.floor((L.y+F)/G)+1),I.push(Math.floor((L.y+L.h+F)/G)+1)}for(var Q=0;Q<I.length;Q+=1)for(;this.pdf.internal.getNumberOfPages()<I[Q];)C.call(this);return I},C=function(){var L=this.fillStyle,M=this.strokeStyle,G=this.font,I=this.lineCap,F=this.lineWidth,X=this.lineJoin;this.pdf.addPage(),this.fillStyle=L,this.strokeStyle=M,this.font=G,this.lineCap=I,this.lineWidth=F,this.lineJoin=X},j=function(L,M,G){for(var I=0;I<L.length;I++)switch(L[I].type){case"bct":L[I].x2+=M,L[I].y2+=G;case"qct":L[I].x1+=M,L[I].y1+=G;case"mt":case"lt":case"arc":default:L[I].x+=M,L[I].y+=G}return L},oe=function(L){return L.sort(function(M,G){return M-G})},te=function(L,M){for(var G,I,F=this.fillStyle,X=this.strokeStyle,Y=this.lineCap,Q=this.lineWidth,J=Math.abs(Q*this.ctx.transform.scaleX),V=this.lineJoin,ne=JSON.parse(JSON.stringify(this.path)),ee=JSON.parse(JSON.stringify(this.path)),ce=[],se=0;se<ee.length;se++)if(ee[se].x!==void 0)for(var q=S.call(this,ee[se]),ue=0;ue<q.length;ue+=1)ce.indexOf(q[ue])===-1&&ce.push(q[ue]);for(var ye=0;ye<ce.length;ye++)for(;this.pdf.internal.getNumberOfPages()<ce[ye];)C.call(this);if(oe(ce),this.autoPaging)for(var de=ce[0],ge=ce[ce.length-1],xe=de;xe<ge+1;xe++){this.pdf.setPage(xe),this.fillStyle=F,this.strokeStyle=X,this.lineCap=Y,this.lineWidth=J,this.lineJoin=V;var pe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],_e=xe===1?this.posY+this.margin[0]:this.margin[0],Re=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ee=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Te=xe===1?0:Re+(xe-2)*Ee;if(this.ctx.clip_path.length!==0){var Le=this.path;G=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(G,this.posX+this.margin[3],-Te+_e+this.ctx.prevPageLastElemOffset),Z.call(this,L,!0),this.path=Le}if(I=JSON.parse(JSON.stringify(ne)),this.path=j(I,this.posX+this.margin[3],-Te+_e+this.ctx.prevPageLastElemOffset),M===!1||xe===0){var Ie=(xe>de||xe<ge)&&x.call(this);Ie&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],pe,Ee,null).clip().discardPath()),Z.call(this,L,M),Ie&&this.pdf.restoreGraphicsState()}this.lineWidth=Q}else this.lineWidth=J,Z.call(this,L,M),this.lineWidth=Q;this.path=ne},Z=function(L,M){if((L!=="stroke"||M||!w.call(this))&&(L==="stroke"||M||!f.call(this))){for(var G,I,F=[],X=this.path,Y=0;Y<X.length;Y++){var Q=X[Y];switch(Q.type){case"begin":F.push({begin:!0});break;case"close":F.push({close:!0});break;case"mt":F.push({start:Q,deltas:[],abs:[]});break;case"lt":var J=F.length;if(X[Y-1]&&!isNaN(X[Y-1].x)&&(G=[Q.x-X[Y-1].x,Q.y-X[Y-1].y],J>0)){for(;J>=0;J--)if(F[J-1].close!==!0&&F[J-1].begin!==!0){F[J-1].deltas.push(G),F[J-1].abs.push(Q);break}}break;case"bct":G=[Q.x1-X[Y-1].x,Q.y1-X[Y-1].y,Q.x2-X[Y-1].x,Q.y2-X[Y-1].y,Q.x-X[Y-1].x,Q.y-X[Y-1].y],F[F.length-1].deltas.push(G);break;case"qct":var V=X[Y-1].x+2/3*(Q.x1-X[Y-1].x),ne=X[Y-1].y+2/3*(Q.y1-X[Y-1].y),ee=Q.x+2/3*(Q.x1-Q.x),ce=Q.y+2/3*(Q.y1-Q.y),se=Q.x,q=Q.y;G=[V-X[Y-1].x,ne-X[Y-1].y,ee-X[Y-1].x,ce-X[Y-1].y,se-X[Y-1].x,q-X[Y-1].y],F[F.length-1].deltas.push(G);break;case"arc":F.push({deltas:[],abs:[],arc:!0}),Array.isArray(F[F.length-1].abs)&&F[F.length-1].abs.push(Q)}}I=M?null:L==="stroke"?"stroke":"fill";for(var ue=!1,ye=0;ye<F.length;ye++)if(F[ye].arc)for(var de=F[ye].abs,ge=0;ge<de.length;ge++){var xe=de[ge];xe.type==="arc"?$.call(this,xe.x,xe.y,xe.radius,xe.startAngle,xe.endAngle,xe.counterclockwise,void 0,M,!ue):b.call(this,xe.x,xe.y),ue=!0}else if(F[ye].close===!0)this.pdf.internal.out("h"),ue=!1;else if(F[ye].begin!==!0){var pe=F[ye].start.x,_e=F[ye].start.y;H.call(this,F[ye].deltas,pe,_e),ue=!0}I&&T.call(this,I),M&&B.call(this)}},re=function(L){var M=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,G=M*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return L-G;case"top":return L+M-G;case"hanging":return L+M-2*G;case"middle":return L+M/2-G;case"ideographic":return L;case"alphabetic":default:return L}},E=function(L){return L+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};m.prototype.createLinearGradient=function(){var L=function(){};return L.colorStops=[],L.addColorStop=function(M,G){this.colorStops.push([M,G])},L.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},L.isCanvasGradient=!0,L},m.prototype.createPattern=function(){return this.createLinearGradient()},m.prototype.createRadialGradient=function(){return this.createLinearGradient()};var $=function(L,M,G,I,F,X,Y,Q,J){for(var V=R.call(this,G,I,F,X),ne=0;ne<V.length;ne++){var ee=V[ne];ne===0&&(J?_.call(this,ee.x1+L,ee.y1+M):b.call(this,ee.x1+L,ee.y1+M)),K.call(this,L,M,ee.x2,ee.y2,ee.x3,ee.y3,ee.x4,ee.y4)}Q?B.call(this):T.call(this,Y)},T=function(L){switch(L){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},_=function(L,M){this.pdf.internal.out(r(L)+" "+n(M)+" m")},P=function(L){var M;switch(L.align){case"right":case"end":M="right";break;case"center":M="center";break;case"left":case"start":default:M="left"}var G=this.pdf.getTextDimensions(L.text),I=re.call(this,L.y),F=E.call(this,I)-G.h,X=this.ctx.transform.applyToPoint(new s(L.x,I)),Y=this.ctx.transform.decompose(),Q=new c;Q=(Q=(Q=Q.multiply(Y.translate)).multiply(Y.skew)).multiply(Y.scale);for(var J,V,ne,ee=this.ctx.transform.applyToRectangle(new l(L.x,I,G.w,G.h)),ce=Q.applyToRectangle(new l(L.x,F,G.w,G.h)),se=S.call(this,ce),q=[],ue=0;ue<se.length;ue+=1)q.indexOf(se[ue])===-1&&q.push(se[ue]);if(oe(q),this.autoPaging)for(var ye=q[0],de=q[q.length-1],ge=ye;ge<de+1;ge++){this.pdf.setPage(ge);var xe=ge===1?this.posY+this.margin[0]:this.margin[0],pe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_e=this.pdf.internal.pageSize.height-this.margin[2],Re=_e-this.margin[0],Ee=this.pdf.internal.pageSize.width-this.margin[1],Te=Ee-this.margin[3],Le=ge===1?0:pe+(ge-2)*Re;if(this.ctx.clip_path.length!==0){var Ie=this.path;J=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(J,this.posX+this.margin[3],-1*Le+xe),Z.call(this,"fill",!0),this.path=Ie}var De=j([JSON.parse(JSON.stringify(ce))],this.posX+this.margin[3],-Le+xe+this.ctx.prevPageLastElemOffset)[0];L.scale>=.01&&(V=this.pdf.internal.getFontSize(),this.pdf.setFontSize(V*L.scale),ne=this.lineWidth,this.lineWidth=ne*L.scale);var Ye=this.autoPaging!=="text";if(Ye||De.y+De.h<=_e){if(Ye||De.y>=xe&&De.x<=Ee){var Be=Ye?L.text:this.pdf.splitTextToSize(L.text,L.maxWidth||Ee-De.x)[0],We=j([JSON.parse(JSON.stringify(ee))],this.posX+this.margin[3],-Le+xe+this.ctx.prevPageLastElemOffset)[0],Ke=Ye&&(ge>ye||ge<de)&&x.call(this);Ke&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Te,Re,null).clip().discardPath()),this.pdf.text(Be,We.x,We.y,{angle:L.angle,align:M,renderingMode:L.renderingMode}),Ke&&this.pdf.restoreGraphicsState()}}else De.y<_e&&(this.ctx.prevPageLastElemOffset+=_e-De.y);L.scale>=.01&&(this.pdf.setFontSize(V),this.lineWidth=ne)}else L.scale>=.01&&(V=this.pdf.internal.getFontSize(),this.pdf.setFontSize(V*L.scale),ne=this.lineWidth,this.lineWidth=ne*L.scale),this.pdf.text(L.text,X.x+this.posX,X.y+this.posY,{angle:L.angle,align:M,renderingMode:L.renderingMode,maxWidth:L.maxWidth}),L.scale>=.01&&(this.pdf.setFontSize(V),this.lineWidth=ne)},b=function(L,M,G,I){G=G||0,I=I||0,this.pdf.internal.out(r(L+G)+" "+n(M+I)+" l")},H=function(L,M,G){return this.pdf.lines(L,M,G,null,null)},K=function(L,M,G,I,F,X,Y,Q){this.pdf.internal.out([e(i(G+L)),e(o(I+M)),e(i(F+L)),e(o(X+M)),e(i(Y+L)),e(o(Q+M)),"c"].join(" "))},R=function(L,M,G,I){for(var F=2*Math.PI,X=Math.PI/2;M>G;)M-=F;var Y=Math.abs(G-M);Y<F&&I&&(Y=F-Y);for(var Q=[],J=I?-1:1,V=M;Y>1e-5;){var ne=V+J*Math.min(Y,X);Q.push(k.call(this,L,V,ne)),Y-=Math.abs(ne-V),V=ne}return Q},k=function(L,M,G){var I=(G-M)/2,F=L*Math.cos(I),X=L*Math.sin(I),Y=F,Q=-X,J=Y*Y+Q*Q,V=J+Y*F+Q*X,ne=4/3*(Math.sqrt(2*J*V)-V)/(Y*X-Q*F),ee=Y-ne*Q,ce=Q+ne*Y,se=ee,q=-ce,ue=I+M,ye=Math.cos(ue),de=Math.sin(ue);return{x1:L*Math.cos(M),y1:L*Math.sin(M),x2:ee*ye-ce*de,y2:ee*de+ce*ye,x3:se*ye-q*de,y3:se*de+q*ye,x4:L*Math.cos(G),y4:L*Math.sin(G)}},W=function(L){return 180*L/Math.PI},z=function(L,M,G,I,F,X){var Y=L+.5*(G-L),Q=M+.5*(I-M),J=F+.5*(G-F),V=X+.5*(I-X),ne=Math.min(L,F,Y,J),ee=Math.max(L,F,Y,J),ce=Math.min(M,X,Q,V),se=Math.max(M,X,Q,V);return new l(ne,ce,ee-ne,se-ce)},U=function(L,M,G,I,F,X,Y,Q){var J,V,ne,ee,ce,se,q,ue,ye,de,ge,xe,pe,_e,Re=G-L,Ee=I-M,Te=F-G,Le=X-I,Ie=Y-F,De=Q-X;for(V=0;V<41;V++)ye=(q=(ne=L+(J=V/40)*Re)+J*((ce=G+J*Te)-ne))+J*(ce+J*(F+J*Ie-ce)-q),de=(ue=(ee=M+J*Ee)+J*((se=I+J*Le)-ee))+J*(se+J*(X+J*De-se)-ue),V==0?(ge=ye,xe=de,pe=ye,_e=de):(ge=Math.min(ge,ye),xe=Math.min(xe,de),pe=Math.max(pe,ye),_e=Math.max(_e,de));return new l(Math.round(ge),Math.round(xe),Math.round(pe-ge),Math.round(_e-xe))},le=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var L,M,G=(L=this.ctx.lineDash,M=this.ctx.lineDashOffset,JSON.stringify({lineDash:L,lineDashOffset:M}));this.prevLineDash!==G&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=G)}}})(sr.API),function(t){var e=function(o){var s,l,c,u,h,m,g,f,w,x;for(l=[],c=0,u=(o+=s="\0\0\0\0".slice(o.length%4||4)).length;u>c;c+=4)(h=(o.charCodeAt(c)<<24)+(o.charCodeAt(c+1)<<16)+(o.charCodeAt(c+2)<<8)+o.charCodeAt(c+3))!==0?(m=(h=((h=((h=((h=(h-(x=h%85))/85)-(w=h%85))/85)-(f=h%85))/85)-(g=h%85))/85)%85,l.push(m+33,g+33,f+33,w+33,x+33)):l.push(122);return function(S,C){for(var j=C;j>0;j--)S.pop()}(l,s.length),String.fromCharCode.apply(String,l)+"~>"},r=function(o){var s,l,c,u,h,m=String,g="length",f=255,w="charCodeAt",x="slice",S="replace";for(o[x](-2),o=o[x](0,-2)[S](/\s/g,"")[S]("z","!!!!!"),c=[],u=0,h=(o+=s="uuuuu"[x](o[g]%5||5))[g];h>u;u+=5)l=52200625*(o[w](u)-33)+614125*(o[w](u+1)-33)+7225*(o[w](u+2)-33)+85*(o[w](u+3)-33)+(o[w](u+4)-33),c.push(f&l>>24,f&l>>16,f&l>>8,f&l);return function(C,j){for(var oe=j;oe>0;oe--)C.pop()}(c,s[g]),m.fromCharCode.apply(m,c)},n=function(o){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),s.test(o)===!1)return"";for(var l="",c=0;c<o.length;c+=2)l+=String.fromCharCode("0x"+(o[c]+o[c+1]));return l},i=function(o){for(var s=new Uint8Array(o.length),l=o.length;l--;)s[l]=o.charCodeAt(l);return o=(s=Cm(s)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};t.processDataByFilters=function(o,s){var l=0,c=o||"",u=[];for(typeof(s=s||[])=="string"&&(s=[s]),l=0;l<s.length;l+=1)switch(s[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(h){return("0"+h.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[l]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}}(sr.API),function(t){t.loadFile=function(e,r,n){return function(i,o,s){o=o!==!1,s=typeof s=="function"?s:function(){};var l=void 0;try{l=function(c,u,h){var m=new XMLHttpRequest,g=0,f=function(w){var x=w.length,S=[],C=String.fromCharCode;for(g=0;g<x;g+=1)S.push(C(255&w.charCodeAt(g)));return S.join("")};if(m.open("GET",c,!u),m.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(m.onload=function(){m.status===200?h(f(this.responseText)):h(void 0)}),m.send(null),u&&m.status===200)return f(m.responseText)}(i,o,s)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(sr.API),function(t){function e(){return(dr.html2canvas?Promise.resolve(dr.html2canvas):Ji(()=>import("./html2canvas.esm-BfxBtG_O.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function r(){return(dr.DOMPurify?Promise.resolve(dr.DOMPurify):Ji(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var l=rn(s);return l==="undefined"?"undefined":l==="string"||s instanceof String?"string":l==="number"||s instanceof Number?"number":l==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":l==="object"?"object":"unknown"},i=function(s,l){var c=document.createElement(s);for(var u in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[u]=l.style[u];return c},o=function s(l){var c=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),u=s.convert(Promise.resolve(),c);return u=(u=u.setProgress(1,s,1,[s])).set(l)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(s,l){return s.__proto__=l||o.prototype,s},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(s,l){return this.then(function(){switch(l=l||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(r).then(function(c){return this.set({src:i("div",{innerHTML:s,dompurify:c})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},o.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(u,h){for(var m=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),g=u.firstChild;g;g=g.nextSibling)h!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||m.appendChild(c(g,h));return u.nodeType===1&&(u.nodeName==="CANVAS"?(m.width=u.width,m.height=u.height,m.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(m.value=u.value),m.addEventListener("load",function(){m.scrollTop=u.scrollTop,m.scrollLeft=u.scrollLeft},!0)),m}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(l){var c=this.opt.jsPDF,u=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var g=0;g<u.length;++g){var f=u[g],w=f.src.find(function(x){return x.format==="truetype"});w&&c.addFont(w.url,f.ref.name,f.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,c.context2d.save(!0),l(this.prop.container,m)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(s,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(s,l):this.outputPdf(s,l)},o.prototype.outputPdf=function(s,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,l)})},o.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},o.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(s){if(n(s)!=="object")return this;var l=Object.keys(s||{}).map(function(c){if(c in o.template.prop)return function(){this.prop[c]=s[c]};switch(c){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[c]=s[c]}}},this);return this.then(function(){return this.thenList(l)})},o.prototype.get=function(s,l){return this.then(function(){var c=s in o.template.prop?this.prop[s]:this.opt[s];return l?l(c):c})},o.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},o.prototype.setPageSize=function(s){function l(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(s=s||sr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:l(s.inner.width,s.k),height:l(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},o.prototype.setProgress=function(s,l,c,u){return s!=null&&(this.progress.val=s),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(s,l,c,u){return this.setProgress(s?this.progress.val+s:null,l||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(s,l){var c=this;return this.thenCore(s,l,function(u,h){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(m){return c.updateProgress(null,u),m}).then(u,h).then(function(m){return c.updateProgress(1),m})})},o.prototype.thenCore=function(s,l,c){c=c||Promise.prototype.then,s&&(s=s.bind(this)),l&&(l=l.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),h=c.call(u,s,l);return o.convert(h,this.__proto__)},o.prototype.thenExternal=function(s,l){return Promise.prototype.then.call(this,s,l)},o.prototype.thenList=function(s){var l=this;return s.forEach(function(c){l=l.thenCore(c)}),l},o.prototype.catch=function(s){s&&(s=s.bind(this));var l=Promise.prototype.catch.call(this,s);return o.convert(l,this)},o.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},o.prototype.error=function(s){return this.then(function(){throw new Error(s)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,sr.getPageSize=function(s,l,c){if(rn(s)==="object"){var u=s;s=u.orientation,l=u.unit||l,c=u.format||c}l=l||"mm",c=c||"a4",s=(""+(s||"P")).toLowerCase();var h,m=(""+c).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+l}var f,w=0,x=0;if(g.hasOwnProperty(m))w=g[m][1]/h,x=g[m][0]/h;else try{w=c[1],x=c[0]}catch{throw new Error("Invalid format: "+c)}if(s==="p"||s==="portrait")s="p",x>w&&(f=x,x=w,w=f);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",w>x&&(f=x,x=w,w=f)}return{width:x,height:w,unit:l,k:h,orientation:s}},t.html=function(s,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(Nm):null;var c=new o(l);return l.worker?c:c.from(s).doCallback()}}(sr.API),sr.API.addJS=function(t){return Q0=t,this.internal.events.subscribe("postPutResources",function(){Yd=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Yd+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),J0=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Q0+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Yd!==void 0&&J0!==void 0&&this.internal.out("/Names <</JavaScript "+Yd+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),o=0;o<i.length;o++){var s=i[o],l=n.exec(s);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,h=[];for(o=0;o<u;o++){var m=r.internal.newObject();h.push(m);var g=r.internal.getPageInfo(o+1);r.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var f=r.internal.newObject();for(r.internal.write("<< /Names [ "),o=0;o<h.length;o++)r.internal.write("(page_"+(o+1)+")"+h[o]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+f+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,o){var s={title:i,options:o,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var s=n.children[o];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var l=this.count=this.count_r({count:0},s);if(l>0&&this.line("/Count "+l),s.options&&s.options.pageNumber){var c=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var o=0;o<i.children.length;o++)n.count++,this.count_r(n,i.children[o]);return n.count}}])}(sr.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,o,s,l){var c,u=this.decode.DCT_DECODE,h=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(m){for(var g,f=256*m.charCodeAt(4)+m.charCodeAt(5),w=m.length,x={width:0,height:0,numcomponents:1},S=4;S<w;S+=2){if(S+=f,e.indexOf(m.charCodeAt(S+1))!==-1){g=256*m.charCodeAt(S+5)+m.charCodeAt(S+6),x={width:256*m.charCodeAt(S+7)+m.charCodeAt(S+8),height:g,numcomponents:m.charCodeAt(S+9)};break}f=256*m.charCodeAt(S+2)+m.charCodeAt(S+3)}return x}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}h={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:i}}return h}}(sr.API);var nc,Kd,X0,Z0,eb,ZL=function(){var t,e,r;function n(o){var s,l,c,u,h,m,g,f,w,x,S,C,j,oe;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},m=null;;){switch(s=this.readUInt32(),w=function(){var te,Z;for(Z=[],te=0;te<4;++te)Z.push(String.fromCharCode(this.data[this.pos++]));return Z}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":m&&this.animation.frames.push(m),this.pos+=4,m={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},h=this.readUInt16(),u=this.readUInt16()||100,m.delay=1e3*h/u,m.disposeOp=this.data[this.pos++],m.blendOp=this.data[this.pos++],m.data=[];break;case"IDAT":case"fdAT":for(w==="fdAT"&&(this.pos+=4,s-=4),o=m?.data||this.imgData,C=0;0<=s?C<s:C>s;0<=s?++C:--C)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((x=c-this.transparency.indexed.length)>0)for(j=0;0<=x?j<x:j>x;0<=x?++j:--j)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":g=(S=this.read(s)).indexOf(0),f=String.fromCharCode.apply(String,S.slice(0,g)),this.text[f]=String.fromCharCode.apply(String,S.slice(g+1));break;case"IEND":return m&&this.animation.frames.push(m),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(oe=this.colorType)===4||oe===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(o){var s,l;for(l=[],s=0;0<=o?s<o:s>o;0<=o?++s:--s)l.push(this.data[this.pos++]);return l},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(o){var s=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*s),c=0,u=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function h(m,g,f,w){var x,S,C,j,oe,te,Z,re,E,$,T,B,_,P,b,H,K,R,k,W,z,U=Math.ceil((u.width-m)/f),le=Math.ceil((u.height-g)/w),L=u.width==U&&u.height==le;for(P=s*U,B=L?l:new Uint8Array(P*le),te=o.length,_=0,S=0;_<le&&c<te;){switch(o[c++]){case 0:for(j=K=0;K<P;j=K+=1)B[S++]=o[c++];break;case 1:for(j=R=0;R<P;j=R+=1)x=o[c++],oe=j<s?0:B[S-s],B[S++]=(x+oe)%256;break;case 2:for(j=k=0;k<P;j=k+=1)x=o[c++],C=(j-j%s)/s,b=_&&B[(_-1)*P+C*s+j%s],B[S++]=(b+x)%256;break;case 3:for(j=W=0;W<P;j=W+=1)x=o[c++],C=(j-j%s)/s,oe=j<s?0:B[S-s],b=_&&B[(_-1)*P+C*s+j%s],B[S++]=(x+Math.floor((oe+b)/2))%256;break;case 4:for(j=z=0;z<P;j=z+=1)x=o[c++],C=(j-j%s)/s,oe=j<s?0:B[S-s],_===0?b=H=0:(b=B[(_-1)*P+C*s+j%s],H=C&&B[(_-1)*P+(C-1)*s+j%s]),Z=oe+b-H,re=Math.abs(Z-oe),$=Math.abs(Z-b),T=Math.abs(Z-H),E=re<=$&&re<=T?oe:$<=T?b:H,B[S++]=(x+E)%256;break;default:throw new Error("Invalid filter algorithm: "+o[c-1])}if(!L){var M=((g+_*w)*u.width+m)*s,G=_*P;for(j=0;j<U;j+=1){for(var I=0;I<s;I+=1)l[M++]=B[G++];M+=(f-1)*s}}_++}}return o=TL(o),u.interlaceMethod==1?(h(0,0,8,8),h(4,0,8,8),h(0,4,4,8),h(2,0,4,4),h(0,2,2,4),h(1,0,2,2),h(0,1,1,2)):h(0,0,1,1),l},n.prototype.decodePalette=function(){var o,s,l,c,u,h,m,g,f;for(l=this.palette,h=this.transparency.indexed||[],u=new Uint8Array((h.length||0)+l.length),c=0,o=0,s=m=0,g=l.length;m<g;s=m+=3)u[c++]=l[s],u[c++]=l[s+1],u[c++]=l[s+2],u[c++]=(f=h[o++])!=null?f:255;return u},n.prototype.copyToImageData=function(o,s){var l,c,u,h,m,g,f,w,x,S,C;if(c=this.colors,x=null,l=this.hasAlphaChannel,this.palette.length&&(x=(C=this._decodedPalette)!=null?C:this._decodedPalette=this.decodePalette(),c=4,l=!0),w=(u=o.data||o).length,m=x||s,h=g=0,c===1)for(;h<w;)f=x?4*s[h/4]:g,S=m[f++],u[h++]=S,u[h++]=S,u[h++]=S,u[h++]=l?m[f++]:255,g=f;else for(;h<w;)f=x?4*s[h/4]:g,u[h++]=m[f++],u[h++]=m[f++],u[h++]=m[f++],u[h++]=l?m[f++]:255,g=f},n.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var i=function(){if(Object.prototype.toString.call(dr)==="[object Window]"){try{e=dr.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return i(),t=function(o){var s;if(i()===!0)return r.width=o.width,r.height=o.height,r.clearRect(0,0,o.width,o.height),r.putImageData(o,0,0),(s=new Image).src=e.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(o){var s,l,c,u,h,m,g,f;if(this.animation){for(f=[],l=h=0,m=(g=this.animation.frames).length;h<m;l=++h)s=g[l],c=o.createImageData(s.width,s.height),u=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(c,u),s.imageData=c,f.push(s.image=t(c));return f}},n.prototype.renderFrame=function(o,s){var l,c,u;return l=(c=this.animation.frames)[s],u=c[s-1],s===0&&o.clearRect(0,0,this.width,this.height),u?.disposeOp===1?o.clearRect(u.xOffset,u.yOffset,u.width,u.height):u?.disposeOp===2&&o.putImageData(u.imageData,u.xOffset,u.yOffset),l.blendOp===0&&o.clearRect(l.xOffset,l.yOffset,l.width,l.height),o.drawImage(l.image,l.xOffset,l.yOffset)},n.prototype.animate=function(o){var s,l,c,u,h,m,g=this;return l=0,m=this.animation,u=m.numFrames,c=m.frames,h=m.numPlays,(s=function(){var f,w;if(f=l++%u,w=c[f],g.renderFrame(o,f),u>1&&l/u<h)return g.animation._timeout=setTimeout(s,w.delay)})()},n.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},n.prototype.render=function(o){var s,l;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,s=o.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(l=s.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),s.putImageData(l,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function eR(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],o=i>>7,s=1<<(7&i)+1;t[e++],t[e++];var l=null,c=null;o&&(l=e,c=s,e+=3*s);var u=!0,h=[],m=0,g=null,f=0,w=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,w=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var x=t[e++];m=t[e++]|t[e++]<<8,g=t[e++],(1&x)==0&&(g=null),f=x>>2&7,e++;break;case 254:for(;;){if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var S=t[e++]|t[e++]<<8,C=t[e++]|t[e++]<<8,j=t[e++]|t[e++]<<8,oe=t[e++]|t[e++]<<8,te=t[e++],Z=te>>6&1,re=1<<(7&te)+1,E=l,$=c,T=!1;te>>7&&(T=!0,E=e,$=re,e+=3*re);var B=e;for(e++;;){var _;if(!((_=t[e++])>=0))throw Error("Invalid block size");if(_===0)break;e+=_}h.push({x:S,y:C,width:j,height:oe,has_local_palette:T,palette_offset:E,palette_size:$,data_offset:B,data_length:e-B,transparent_index:g,interlaced:!!Z,delay:m,disposal:f});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return w},this.frameInfo=function(P){if(P<0||P>=h.length)throw new Error("Frame index out of range.");return h[P]},this.decodeAndBlitFrameBGRA=function(P,b){var H=this.frameInfo(P),K=H.width*H.height,R=new Uint8Array(K);tb(t,H.data_offset,R,K);var k=H.palette_offset,W=H.transparent_index;W===null&&(W=256);var z=H.width,U=r-z,le=z,L=4*(H.y*r+H.x),M=4*((H.y+H.height)*r+H.x),G=L,I=4*U;H.interlaced===!0&&(I+=4*r*7);for(var F=8,X=0,Y=R.length;X<Y;++X){var Q=R[X];if(le===0&&(le=z,(G+=I)>=M&&(I=4*U+4*r*(F-1),G=L+(z+U)*(F<<1),F>>=1)),Q===W)G+=4;else{var J=t[k+3*Q],V=t[k+3*Q+1],ne=t[k+3*Q+2];b[G++]=ne,b[G++]=V,b[G++]=J,b[G++]=255}--le}},this.decodeAndBlitFrameRGBA=function(P,b){var H=this.frameInfo(P),K=H.width*H.height,R=new Uint8Array(K);tb(t,H.data_offset,R,K);var k=H.palette_offset,W=H.transparent_index;W===null&&(W=256);var z=H.width,U=r-z,le=z,L=4*(H.y*r+H.x),M=4*((H.y+H.height)*r+H.x),G=L,I=4*U;H.interlaced===!0&&(I+=4*r*7);for(var F=8,X=0,Y=R.length;X<Y;++X){var Q=R[X];if(le===0&&(le=z,(G+=I)>=M&&(I=4*U+4*r*(F-1),G=L+(z+U)*(F<<1),F>>=1)),Q===W)G+=4;else{var J=t[k+3*Q],V=t[k+3*Q+1],ne=t[k+3*Q+2];b[G++]=J,b[G++]=V,b[G++]=ne,b[G++]=255}--le}}}function tb(t,e,r,n){for(var i=t[e++],o=1<<i,s=o+1,l=s+1,c=i+1,u=(1<<c)-1,h=0,m=0,g=0,f=t[e++],w=new Int32Array(4096),x=null;;){for(;h<16&&f!==0;)m|=t[e++]<<h,h+=8,f===1?f=t[e++]:--f;if(h<c)break;var S=m&u;if(m>>=c,h-=c,S!==o){if(S===s)break;for(var C=S<l?S:x,j=0,oe=C;oe>o;)oe=w[oe]>>8,++j;var te=oe;if(g+j+(C!==S?1:0)>n)return void ln.log("Warning, gif stream longer than expected.");r[g++]=te;var Z=g+=j;for(C!==S&&(r[g++]=te),oe=C;j--;)oe=w[oe],r[--Z]=255&oe,oe>>=8;x!==null&&l<4096&&(w[l++]=x<<8|te,l>=u+1&&c<12&&(++c,u=u<<1|1)),x=S}else l=s+1,u=(1<<(c=i+1))-1,x=null}return g!==n&&ln.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function $f(t){var e,r,n,i,o,s=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),h=new Array(64),m=new Array(65535),g=new Array(65535),f=new Array(64),w=new Array(64),x=[],S=0,C=7,j=new Array(64),oe=new Array(64),te=new Array(64),Z=new Array(256),re=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],$=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],b=[0,1,2,3,4,5,6,7,8,9,10,11],H=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],K=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function R(L,M){for(var G=0,I=0,F=new Array,X=1;X<=16;X++){for(var Y=1;Y<=L[X];Y++)F[M[I]]=[],F[M[I]][0]=G,F[M[I]][1]=X,I++,G++;G*=2}return F}function k(L){for(var M=L[0],G=L[1]-1;G>=0;)M&1<<G&&(S|=1<<C),G--,--C<0&&(S==255?(W(255),W(0)):W(S),C=7,S=0)}function W(L){x.push(L)}function z(L){W(L>>8&255),W(255&L)}function U(L,M,G,I,F){for(var X,Y=F[0],Q=F[240],J=function(de,ge){var xe,pe,_e,Re,Ee,Te,Le,Ie,De,Ye,Be=0;for(De=0;De<8;++De){xe=de[Be],pe=de[Be+1],_e=de[Be+2],Re=de[Be+3],Ee=de[Be+4],Te=de[Be+5],Le=de[Be+6];var We=xe+(Ie=de[Be+7]),Ke=xe-Ie,st=pe+Le,nt=pe-Le,He=_e+Te,mt=_e-Te,ut=Re+Ee,at=Re-Ee,It=We+ut,Xe=We-ut,kt=st+He,Tt=st-He;de[Be]=It+kt,de[Be+4]=It-kt;var wt=.707106781*(Tt+Xe);de[Be+2]=Xe+wt,de[Be+6]=Xe-wt;var Rt=.382683433*((It=at+mt)-(Tt=nt+Ke)),fr=.5411961*It+Rt,ze=1.306562965*Tt+Rt,Ct=.707106781*(kt=mt+nt),xt=Ke+Ct,tt=Ke-Ct;de[Be+5]=tt+fr,de[Be+3]=tt-fr,de[Be+1]=xt+ze,de[Be+7]=xt-ze,Be+=8}for(Be=0,De=0;De<8;++De){xe=de[Be],pe=de[Be+8],_e=de[Be+16],Re=de[Be+24],Ee=de[Be+32],Te=de[Be+40],Le=de[Be+48];var bt=xe+(Ie=de[Be+56]),Mt=xe-Ie,Wt=pe+Le,Jt=pe-Le,lt=_e+Te,gt=_e-Te,$t=Re+Ee,et=Re-Ee,Vt=bt+$t,Ht=bt-$t,Xt=Wt+lt,er=Wt-lt;de[Be]=Vt+Xt,de[Be+32]=Vt-Xt;var Kt=.707106781*(er+Ht);de[Be+16]=Ht+Kt,de[Be+48]=Ht-Kt;var ir=.382683433*((Vt=et+gt)-(er=Jt+Mt)),vr=.5411961*Vt+ir,cr=1.306562965*er+ir,br=.707106781*(Xt=gt+Jt),Nt=Mt+br,Et=Mt-br;de[Be+40]=Et+vr,de[Be+24]=Et-vr,de[Be+8]=Nt+cr,de[Be+56]=Nt-cr,Be++}for(De=0;De<64;++De)Ye=de[De]*ge[De],f[De]=Ye>0?Ye+.5|0:Ye-.5|0;return f}(L,M),V=0;V<64;++V)w[E[V]]=J[V];var ne=w[0]-G;G=w[0],ne==0?k(I[0]):(k(I[g[X=32767+ne]]),k(m[X]));for(var ee=63;ee>0&&w[ee]==0;)ee--;if(ee==0)return k(Y),G;for(var ce,se=1;se<=ee;){for(var q=se;w[se]==0&&se<=ee;)++se;var ue=se-q;if(ue>=16){ce=ue>>4;for(var ye=1;ye<=ce;++ye)k(Q);ue&=15}X=32767+w[se],k(F[(ue<<4)+g[X]]),k(m[X]),se++}return ee!=63&&k(Y),G}function le(L){L=Math.min(Math.max(L,1),100),o!=L&&(function(M){for(var G=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],I=0;I<64;I++){var F=s((G[I]*M+50)/100);F=Math.min(Math.max(F,1),255),l[E[I]]=F}for(var X=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Y=0;Y<64;Y++){var Q=s((X[Y]*M+50)/100);Q=Math.min(Math.max(Q,1),255),c[E[Y]]=Q}for(var J=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],V=0,ne=0;ne<8;ne++)for(var ee=0;ee<8;ee++)u[V]=1/(l[E[V]]*J[ne]*J[ee]*8),h[V]=1/(c[E[V]]*J[ne]*J[ee]*8),V++}(L<50?Math.floor(5e3/L):Math.floor(200-2*L)),o=L)}this.encode=function(L,M){M&&le(M),x=new Array,S=0,C=7,z(65496),z(65504),z(16),W(74),W(70),W(73),W(70),W(0),W(1),W(1),W(0),z(1),z(1),W(0),W(0),function(){z(65499),z(132),W(0);for(var pe=0;pe<64;pe++)W(l[pe]);W(1);for(var _e=0;_e<64;_e++)W(c[_e])}(),function(pe,_e){z(65472),z(17),W(8),z(_e),z(pe),W(3),W(1),W(17),W(0),W(2),W(17),W(1),W(3),W(17),W(1)}(L.width,L.height),function(){z(65476),z(418),W(0);for(var pe=0;pe<16;pe++)W($[pe+1]);for(var _e=0;_e<=11;_e++)W(T[_e]);W(16);for(var Re=0;Re<16;Re++)W(B[Re+1]);for(var Ee=0;Ee<=161;Ee++)W(_[Ee]);W(1);for(var Te=0;Te<16;Te++)W(P[Te+1]);for(var Le=0;Le<=11;Le++)W(b[Le]);W(17);for(var Ie=0;Ie<16;Ie++)W(H[Ie+1]);for(var De=0;De<=161;De++)W(K[De])}(),z(65498),z(12),W(3),W(1),W(0),W(2),W(17),W(3),W(17),W(0),W(63),W(0);var G=0,I=0,F=0;S=0,C=7,this.encode.displayName="_encode_";for(var X,Y,Q,J,V,ne,ee,ce,se,q=L.data,ue=L.width,ye=L.height,de=4*ue,ge=0;ge<ye;){for(X=0;X<de;){for(V=de*ge+X,ee=-1,ce=0,se=0;se<64;se++)ne=V+(ce=se>>3)*de+(ee=4*(7&se)),ge+ce>=ye&&(ne-=de*(ge+1+ce-ye)),X+ee>=de&&(ne-=X+ee-de+4),Y=q[ne++],Q=q[ne++],J=q[ne++],j[se]=(re[Y]+re[Q+256>>0]+re[J+512>>0]>>16)-128,oe[se]=(re[Y+768>>0]+re[Q+1024>>0]+re[J+1280>>0]>>16)-128,te[se]=(re[Y+1280>>0]+re[Q+1536>>0]+re[J+1792>>0]>>16)-128;G=U(j,u,G,e,n),I=U(oe,h,I,r,i),F=U(te,h,F,r,i),X+=32}ge+=8}if(C>=0){var xe=[];xe[1]=C+1,xe[0]=(1<<C+1)-1,k(xe)}return z(65497),new Uint8Array(x)},t=t||50,function(){for(var L=String.fromCharCode,M=0;M<256;M++)Z[M]=L(M)}(),e=R($,T),r=R(P,b),n=R(B,_),i=R(H,K),function(){for(var L=1,M=2,G=1;G<=15;G++){for(var I=L;I<M;I++)g[32767+I]=G,m[32767+I]=[],m[32767+I][1]=G,m[32767+I][0]=I;for(var F=-(M-1);F<=-L;F++)g[32767+F]=G,m[32767+F]=[],m[32767+F][1]=G,m[32767+F][0]=M-1+F;L<<=1,M<<=1}}(),function(){for(var L=0;L<256;L++)re[L]=19595*L,re[L+256>>0]=38470*L,re[L+512>>0]=7471*L+32768,re[L+768>>0]=-11059*L,re[L+1024>>0]=-21709*L,re[L+1280>>0]=32768*L+8421375,re[L+1536>>0]=-27439*L,re[L+1792>>0]=-5329*L}(),le(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ko(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function rb(t){function e($){if(!$)throw Error("assert :P")}function r($,T,B){for(var _=0;4>_;_++)if($[T+_]!=B.charCodeAt(_))return!0;return!1}function n($,T,B,_,P){for(var b=0;b<P;b++)$[T+b]=B[_+b]}function i($,T,B,_){for(var P=0;P<_;P++)$[T+P]=B}function o($){return new Int32Array($)}function s($,T){for(var B=[],_=0;_<$;_++)B.push(new T);return B}function l($,T){var B=[];return function _(P,b,H){for(var K=H[b],R=0;R<K&&(P.push(H.length>b+1?[]:new T),!(H.length<b+1));R++)_(P[R],b+1,H)}(B,0,$),B}var c=function(){var $=this;function T(d,v){for(var N=1<<v-1>>>0;d&N;)N>>>=1;return N?(d&N-1)+N:d}function B(d,v,N,ie,me){e(!(ie%N));do d[v+(ie-=N)]=me;while(0<ie)}function _(d,v,N,ie,me){if(e(2328>=me),512>=me)var ve=o(512);else if((ve=o(me))==null)return 0;return function(be,Pe,Ae,ke,Fe,Je){var Qe,Ue,yt=Pe,rt=1<<Ae,Oe=o(16),je=o(16);for(e(Fe!=0),e(ke!=null),e(be!=null),e(0<Ae),Ue=0;Ue<Fe;++Ue){if(15<ke[Ue])return 0;++Oe[ke[Ue]]}if(Oe[0]==Fe)return 0;for(je[1]=0,Qe=1;15>Qe;++Qe){if(Oe[Qe]>1<<Qe)return 0;je[Qe+1]=je[Qe]+Oe[Qe]}for(Ue=0;Ue<Fe;++Ue)Qe=ke[Ue],0<ke[Ue]&&(Je[je[Qe]++]=Ue);if(je[15]==1)return(ke=new P).g=0,ke.value=Je[0],B(be,yt,1,rt,ke),rt;var pt,St=-1,ft=rt-1,Ut=0,Ft=1,or=1,Bt=1<<Ae;for(Ue=0,Qe=1,Fe=2;Qe<=Ae;++Qe,Fe<<=1){if(Ft+=or<<=1,0>(or-=Oe[Qe]))return 0;for(;0<Oe[Qe];--Oe[Qe])(ke=new P).g=Qe,ke.value=Je[Ue++],B(be,yt+Ut,Fe,Bt,ke),Ut=T(Ut,Qe)}for(Qe=Ae+1,Fe=2;15>=Qe;++Qe,Fe<<=1){if(Ft+=or<<=1,0>(or-=Oe[Qe]))return 0;for(;0<Oe[Qe];--Oe[Qe]){if(ke=new P,(Ut&ft)!=St){for(yt+=Bt,pt=1<<(St=Qe)-Ae;15>St&&!(0>=(pt-=Oe[St]));)++St,pt<<=1;rt+=Bt=1<<(pt=St-Ae),be[Pe+(St=Ut&ft)].g=pt+Ae,be[Pe+St].value=yt-Pe-St}ke.g=Qe-Ae,ke.value=Je[Ue++],B(be,yt+(Ut>>Ae),Fe,Bt,ke),Ut=T(Ut,Qe)}}return Ft!=2*je[15]-1?0:rt}(d,v,N,ie,me,ve)}function P(){this.value=this.g=0}function b(){this.value=this.g=0}function H(){this.G=s(5,P),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(ai,b)}function K(d,v,N,ie){e(d!=null),e(v!=null),e(2147483648>ie),d.Ca=254,d.I=0,d.b=-8,d.Ka=0,d.oa=v,d.pa=N,d.Jd=v,d.Yc=N+ie,d.Zc=4<=ie?N+ie-4+1:N,X(d)}function R(d,v){for(var N=0;0<v--;)N|=Q(d,128)<<v;return N}function k(d,v){var N=R(d,v);return Y(d)?-N:N}function W(d,v,N,ie){var me,ve=0;for(e(d!=null),e(v!=null),e(4294967288>ie),d.Sb=ie,d.Ra=0,d.u=0,d.h=0,4<ie&&(ie=4),me=0;me<ie;++me)ve+=v[N+me]<<8*me;d.Ra=ve,d.bb=ie,d.oa=v,d.pa=N}function z(d){for(;8<=d.u&&d.bb<d.Sb;)d.Ra>>>=8,d.Ra+=d.oa[d.pa+d.bb]<<ql-8>>>0,++d.bb,d.u-=8;G(d)&&(d.h=1,d.u=0)}function U(d,v){if(e(0<=v),!d.h&&v<=Vl){var N=M(d)&jl[v];return d.u+=v,z(d),N}return d.h=1,d.u=0}function le(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function L(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function M(d){return d.Ra>>>(d.u&ql-1)>>>0}function G(d){return e(d.bb<=d.Sb),d.h||d.bb==d.Sb&&d.u>ql}function I(d,v){d.u=v,d.h=G(d)}function F(d){d.u>=Fc&&(e(d.u>=Fc),z(d))}function X(d){e(d!=null&&d.oa!=null),d.pa<d.Zc?(d.I=(d.oa[d.pa++]|d.I<<8)>>>0,d.b+=8):(e(d!=null&&d.oa!=null),d.pa<d.Yc?(d.b+=8,d.I=d.oa[d.pa++]|d.I<<8):d.Ka?d.b=0:(d.I<<=8,d.b+=8,d.Ka=1))}function Y(d){return R(d,1)}function Q(d,v){var N=d.Ca;0>d.b&&X(d);var ie=d.b,me=N*v>>>8,ve=(d.I>>>ie>me)+0;for(ve?(N-=me,d.I-=me+1<<ie>>>0):N=me+1,ie=N,me=0;256<=ie;)me+=8,ie>>=8;return ie=7^me+Vi[ie],d.b-=ie,d.Ca=(N<<ie)-1,ve}function J(d,v,N){d[v+0]=N>>24&255,d[v+1]=N>>16&255,d[v+2]=N>>8&255,d[v+3]=N>>0&255}function V(d,v){return d[v+0]<<0|d[v+1]<<8}function ne(d,v){return V(d,v)|d[v+2]<<16}function ee(d,v){return V(d,v)|V(d,v+2)<<16}function ce(d,v){var N=1<<v;return e(d!=null),e(0<v),d.X=o(N),d.X==null?0:(d.Mb=32-v,d.Xa=v,1)}function se(d,v){e(d!=null),e(v!=null),e(d.Xa==v.Xa),n(v.X,0,d.X,0,1<<v.Xa)}function q(){this.X=[],this.Xa=this.Mb=0}function ue(d,v,N,ie){e(N!=null),e(ie!=null);var me=N[0],ve=ie[0];return me==0&&(me=(d*ve+v/2)/v),ve==0&&(ve=(v*me+d/2)/d),0>=me||0>=ve?0:(N[0]=me,ie[0]=ve,1)}function ye(d,v){return d+(1<<v)-1>>>v}function de(d,v){return((4278255360&d)+(4278255360&v)>>>0&4278255360)+((16711935&d)+(16711935&v)>>>0&16711935)>>>0}function ge(d,v){$[v]=function(N,ie,me,ve,be,Pe,Ae){var ke;for(ke=0;ke<be;++ke){var Fe=$[d](Pe[Ae+ke-1],me,ve+ke);Pe[Ae+ke]=de(N[ie+ke],Fe)}}}function xe(){this.ud=this.hd=this.jd=0}function pe(d,v){return((4278124286&(d^v))>>>1)+(d&v)>>>0}function _e(d){return 0<=d&&256>d?d:0>d?0:255<d?255:void 0}function Re(d,v){return _e(d+(d-v+.5>>1))}function Ee(d,v,N){return Math.abs(v-N)-Math.abs(d-N)}function Te(d,v,N,ie,me,ve,be){for(ie=ve[be-1],N=0;N<me;++N)ve[be+N]=ie=de(d[v+N],ie)}function Le(d,v,N,ie,me){var ve;for(ve=0;ve<N;++ve){var be=d[v+ve],Pe=be>>8&255,Ae=16711935&(Ae=(Ae=16711935&be)+((Pe<<16)+Pe));ie[me+ve]=(4278255360&be)+Ae>>>0}}function Ie(d,v){v.jd=d>>0&255,v.hd=d>>8&255,v.ud=d>>16&255}function De(d,v,N,ie,me,ve){var be;for(be=0;be<ie;++be){var Pe=v[N+be],Ae=Pe>>>8,ke=Pe,Fe=255&(Fe=(Fe=Pe>>>16)+((d.jd<<24>>24)*(Ae<<24>>24)>>>5));ke=255&(ke=(ke=ke+((d.hd<<24>>24)*(Ae<<24>>24)>>>5))+((d.ud<<24>>24)*(Fe<<24>>24)>>>5)),me[ve+be]=(4278255360&Pe)+(Fe<<16)+ke}}function Ye(d,v,N,ie,me){$[v]=function(ve,be,Pe,Ae,ke,Fe,Je,Qe,Ue){for(Ae=Je;Ae<Qe;++Ae)for(Je=0;Je<Ue;++Je)ke[Fe++]=me(Pe[ie(ve[be++])])},$[d]=function(ve,be,Pe,Ae,ke,Fe,Je){var Qe=8>>ve.b,Ue=ve.Ea,yt=ve.K[0],rt=ve.w;if(8>Qe)for(ve=(1<<ve.b)-1,rt=(1<<Qe)-1;be<Pe;++be){var Oe,je=0;for(Oe=0;Oe<Ue;++Oe)Oe&ve||(je=ie(Ae[ke++])),Fe[Je++]=me(yt[je&rt]),je>>=Qe}else $["VP8LMapColor"+N](Ae,ke,yt,rt,Fe,Je,be,Pe,Ue)}}function Be(d,v,N,ie,me){for(N=v+N;v<N;){var ve=d[v++];ie[me++]=ve>>16&255,ie[me++]=ve>>8&255,ie[me++]=ve>>0&255}}function We(d,v,N,ie,me){for(N=v+N;v<N;){var ve=d[v++];ie[me++]=ve>>16&255,ie[me++]=ve>>8&255,ie[me++]=ve>>0&255,ie[me++]=ve>>24&255}}function Ke(d,v,N,ie,me){for(N=v+N;v<N;){var ve=(be=d[v++])>>16&240|be>>12&15,be=be>>0&240|be>>28&15;ie[me++]=ve,ie[me++]=be}}function st(d,v,N,ie,me){for(N=v+N;v<N;){var ve=(be=d[v++])>>16&248|be>>13&7,be=be>>5&224|be>>3&31;ie[me++]=ve,ie[me++]=be}}function nt(d,v,N,ie,me){for(N=v+N;v<N;){var ve=d[v++];ie[me++]=ve>>0&255,ie[me++]=ve>>8&255,ie[me++]=ve>>16&255}}function He(d,v,N,ie,me,ve){if(ve==0)for(N=v+N;v<N;)J(ie,((ve=d[v++])[0]>>24|ve[1]>>8&65280|ve[2]<<8&16711680|ve[3]<<24)>>>0),me+=32;else n(ie,me,d,v,N)}function mt(d,v){$[v][0]=$[d+"0"],$[v][1]=$[d+"1"],$[v][2]=$[d+"2"],$[v][3]=$[d+"3"],$[v][4]=$[d+"4"],$[v][5]=$[d+"5"],$[v][6]=$[d+"6"],$[v][7]=$[d+"7"],$[v][8]=$[d+"8"],$[v][9]=$[d+"9"],$[v][10]=$[d+"10"],$[v][11]=$[d+"11"],$[v][12]=$[d+"12"],$[v][13]=$[d+"13"],$[v][14]=$[d+"0"],$[v][15]=$[d+"0"]}function ut(d){return d==Pp||d==wp||d==fd||d==xp}function at(){this.eb=[],this.size=this.A=this.fb=0}function It(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Xe(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new at,this.f.kb=new It,this.sd=null}function kt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Tt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function wt(d){return alert("todo:WebPSamplerProcessPlane"),d.T}function Rt(d,v){var N=d.T,ie=v.ba.f.RGBA,me=ie.eb,ve=ie.fb+d.ka*ie.A,be=go[v.ba.S],Pe=d.y,Ae=d.O,ke=d.f,Fe=d.N,Je=d.ea,Qe=d.W,Ue=v.cc,yt=v.dc,rt=v.Mc,Oe=v.Nc,je=d.ka,pt=d.ka+d.T,St=d.U,ft=St+1>>1;for(je==0?be(Pe,Ae,null,null,ke,Fe,Je,Qe,ke,Fe,Je,Qe,me,ve,null,null,St):(be(v.ec,v.fc,Pe,Ae,Ue,yt,rt,Oe,ke,Fe,Je,Qe,me,ve-ie.A,me,ve,St),++N);je+2<pt;je+=2)Ue=ke,yt=Fe,rt=Je,Oe=Qe,Fe+=d.Rc,Qe+=d.Rc,ve+=2*ie.A,be(Pe,(Ae+=2*d.fa)-d.fa,Pe,Ae,Ue,yt,rt,Oe,ke,Fe,Je,Qe,me,ve-ie.A,me,ve,St);return Ae+=d.fa,d.j+pt<d.o?(n(v.ec,v.fc,Pe,Ae,St),n(v.cc,v.dc,ke,Fe,ft),n(v.Mc,v.Nc,Je,Qe,ft),N--):1&pt||be(Pe,Ae,null,null,ke,Fe,Je,Qe,ke,Fe,Je,Qe,me,ve+ie.A,null,null,St),N}function fr(d,v,N){var ie=d.F,me=[d.J];if(ie!=null){var ve=d.U,be=v.ba.S,Pe=be==pd||be==fd;v=v.ba.f.RGBA;var Ae=[0],ke=d.ka;Ae[0]=d.T,d.Kb&&(ke==0?--Ae[0]:(--ke,me[0]-=d.width),d.j+d.ka+d.T==d.o&&(Ae[0]=d.o-d.j-ke));var Fe=v.eb;ke=v.fb+ke*v.A,d=hn(ie,me[0],d.width,ve,Ae,Fe,ke+(Pe?0:3),v.A),e(N==Ae),d&&ut(be)&&mo(Fe,ke,Pe,ve,Ae,v.A)}return 0}function ze(d){var v=d.ma,N=v.ba.S,ie=11>N,me=N==dd||N==hd||N==pd||N==Sp||N==12||ut(N);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!Dc(v.Oa,d,me?11:12))return 0;if(me&&ut(N)&&Pt(),d.da)alert("todo:use_scaling");else{if(ie){if(v.Ib=wt,d.Kb){if(N=d.U+1>>1,v.memory=o(d.U+2*N),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+d.U,v.Mc=v.cc,v.Nc=v.dc+N,v.Ib=Rt,Pt()}}else alert("todo:EmitYUV");me&&(v.Jb=fr,ie&&qe())}if(ie&&!sg){for(d=0;256>d;++d)V_[d]=89858*(d-128)+yd>>md,U_[d]=-22014*(d-128)+yd,z_[d]=-45773*(d-128),q_[d]=113618*(d-128)+yd>>md;for(d=Uc;d<Ip;++d)v=76283*(d-16)+yd>>md,H_[d-Uc]=Xr(v,255),G_[d-Uc]=Xr(v+8>>4,15);sg=1}return 1}function Ct(d){var v=d.ma,N=d.U,ie=d.T;return e(!(1&d.ka)),0>=N||0>=ie?0:(N=v.Ib(d,v),v.Jb!=null&&v.Jb(d,v,N),v.Dc+=N,1)}function xt(d){d.ma.memory=null}function tt(d,v,N,ie){return U(d,8)!=47?0:(v[0]=U(d,14)+1,N[0]=U(d,14)+1,ie[0]=U(d,1),U(d,3)!=0?0:!d.h)}function bt(d,v){if(4>d)return d+1;var N=d-2>>1;return(2+(1&d)<<N)+U(v,N)+1}function Mt(d,v){return 120<v?v-120:1<=(N=((N=I_[v-1])>>4)*d+(8-(15&N)))?N:1;var N}function Wt(d,v,N){var ie=M(N),me=d[v+=255&ie].g-8;return 0<me&&(I(N,N.u+8),ie=M(N),v+=d[v].value,v+=ie&(1<<me)-1),I(N,N.u+d[v].g),d[v].value}function Jt(d,v,N){return N.g+=d.g,N.value+=d.value<<v>>>0,e(8>=N.g),d.g}function lt(d,v,N){var ie=d.xc;return e((v=ie==0?0:d.vc[d.md*(N>>ie)+(v>>ie)])<d.Wb),d.Ya[v]}function gt(d,v,N,ie){var me=d.ab,ve=d.c*v,be=d.C;v=be+v;var Pe=N,Ae=ie;for(ie=d.Ta,N=d.Ua;0<me--;){var ke=d.gc[me],Fe=be,Je=v,Qe=Pe,Ue=Ae,yt=(Ae=ie,Pe=N,ke.Ea);switch(e(Fe<Je),e(Je<=ke.nc),ke.hc){case 2:id(Qe,Ue,(Je-Fe)*yt,Ae,Pe);break;case 0:var rt=Fe,Oe=Je,je=Ae,pt=Pe,St=(Bt=ke).Ea;rt==0&&(bp(Qe,Ue,null,null,1,je,pt),Te(Qe,Ue+1,0,0,St-1,je,pt+1),Ue+=St,pt+=St,++rt);for(var ft=1<<Bt.b,Ut=ft-1,Ft=ye(St,Bt.b),or=Bt.K,Bt=Bt.w+(rt>>Bt.b)*Ft;rt<Oe;){var Yr=or,en=Bt,zr=1;for(Oc(Qe,Ue,je,pt-St,1,je,pt);zr<St;){var Mr=(zr&~Ut)+ft;Mr>St&&(Mr=St),(0,ea[Yr[en++]>>8&15])(Qe,Ue+ +zr,je,pt+zr-St,Mr-zr,je,pt+zr),zr=Mr}Ue+=St,pt+=St,++rt&Ut||(Bt+=Ft)}Je!=ke.nc&&n(Ae,Pe-yt,Ae,Pe+(Je-Fe-1)*yt,yt);break;case 1:for(yt=Qe,Oe=Ue,St=(Qe=ke.Ea)-(pt=Qe&~(je=(Ue=1<<ke.b)-1)),rt=ye(Qe,ke.b),ft=ke.K,ke=ke.w+(Fe>>ke.b)*rt;Fe<Je;){for(Ut=ft,Ft=ke,or=new xe,Bt=Oe+pt,Yr=Oe+Qe;Oe<Bt;)Ie(Ut[Ft++],or),Qa(or,yt,Oe,Ue,Ae,Pe),Oe+=Ue,Pe+=Ue;Oe<Yr&&(Ie(Ut[Ft++],or),Qa(or,yt,Oe,St,Ae,Pe),Oe+=St,Pe+=St),++Fe&je||(ke+=rt)}break;case 3:if(Qe==Ae&&Ue==Pe&&0<ke.b){for(Oe=Ae,Qe=yt=Pe+(Je-Fe)*yt-(pt=(Je-Fe)*ye(ke.Ea,ke.b)),Ue=Ae,je=Pe,rt=[],pt=(St=pt)-1;0<=pt;--pt)rt[pt]=Ue[je+pt];for(pt=St-1;0<=pt;--pt)Oe[Qe+pt]=rt[pt];ho(ke,Fe,Je,Ae,yt,Ae,Pe)}else ho(ke,Fe,Je,Qe,Ue,Ae,Pe)}Pe=ie,Ae=N}Ae!=N&&n(ie,N,Pe,Ae,ve)}function $t(d,v){var N=d.V,ie=d.Ba+d.c*d.C,me=v-d.C;if(e(v<=d.l.o),e(16>=me),0<me){var ve=d.l,be=d.Ta,Pe=d.Ua,Ae=ve.width;if(gt(d,me,N,ie),me=Pe=[Pe],e((N=d.C)<(ie=v)),e(ve.v<ve.va),ie>ve.o&&(ie=ve.o),N<ve.j){var ke=ve.j-N;N=ve.j,me[0]+=ke*Ae}if(N>=ie?N=0:(me[0]+=4*ve.v,ve.ka=N-ve.j,ve.U=ve.va-ve.v,ve.T=ie-N,N=1),N){if(Pe=Pe[0],11>(N=d.ca).S){var Fe=N.f.RGBA,Je=(ie=N.S,me=ve.U,ve=ve.T,ke=Fe.eb,Fe.A),Qe=ve;for(Fe=Fe.fb+d.Ma*Fe.A;0<Qe--;){var Ue=be,yt=Pe,rt=me,Oe=ke,je=Fe;switch(ie){case ud:qi(Ue,yt,rt,Oe,je);break;case dd:Li(Ue,yt,rt,Oe,je);break;case Pp:Li(Ue,yt,rt,Oe,je),mo(Oe,je,0,rt,1,0);break;case Qy:_s(Ue,yt,rt,Oe,je);break;case hd:He(Ue,yt,rt,Oe,je,1);break;case wp:He(Ue,yt,rt,Oe,je,1),mo(Oe,je,0,rt,1,0);break;case pd:He(Ue,yt,rt,Oe,je,0);break;case fd:He(Ue,yt,rt,Oe,je,0),mo(Oe,je,1,rt,1,0);break;case Sp:ta(Ue,yt,rt,Oe,je);break;case xp:ta(Ue,yt,rt,Oe,je),dn(Oe,je,rt,1,0);break;case Xy:bs(Ue,yt,rt,Oe,je);break;default:e(0)}Pe+=Ae,Fe+=Je}d.Ma+=ve}else alert("todo:EmitRescaledRowsYUVA");e(d.Ma<=N.height)}}d.C=v,e(d.C<=d.i)}function et(d){var v;if(0<d.ua)return 0;for(v=0;v<d.Wb;++v){var N=d.Ya[v].G,ie=d.Ya[v].H;if(0<N[1][ie[1]+0].g||0<N[2][ie[2]+0].g||0<N[3][ie[3]+0].g)return 0}return 1}function Vt(d,v,N,ie,me,ve){if(d.Z!=0){var be=d.qd,Pe=d.rd;for(e(oa[d.Z]!=null);v<N;++v)oa[d.Z](be,Pe,ie,me,ie,me,ve),be=ie,Pe=me,me+=ve;d.qd=be,d.rd=Pe}}function Ht(d,v){var N=d.l.ma,ie=N.Z==0||N.Z==1?d.l.j:d.C;if(ie=d.C<ie?ie:d.C,e(v<=d.l.o),v>ie){var me=d.l.width,ve=N.ca,be=N.tb+me*ie,Pe=d.V,Ae=d.Ba+d.c*ie,ke=d.gc;e(d.ab==1),e(ke[0].hc==3),od(ke[0],ie,v,Pe,Ae,ve,be),Vt(N,ie,v,ve,be,me)}d.C=d.Ma=v}function Xt(d,v,N,ie,me,ve,be){var Pe=d.$/ie,Ae=d.$%ie,ke=d.m,Fe=d.s,Je=N+d.$,Qe=Je;me=N+ie*me;var Ue=N+ie*ve,yt=280+Fe.ua,rt=d.Pb?Pe:16777216,Oe=0<Fe.ua?Fe.Wa:null,je=Fe.wc,pt=Je<Ue?lt(Fe,Ae,Pe):null;e(d.C<ve),e(Ue<=me);var St=!1;e:for(;;){for(;St||Je<Ue;){var ft=0;if(Pe>=rt){var Ut=Je-N;e((rt=d).Pb),rt.wd=rt.m,rt.xd=Ut,0<rt.s.ua&&se(rt.s.Wa,rt.s.vb),rt=Pe+E_}if(Ae&je||(pt=lt(Fe,Ae,Pe)),e(pt!=null),pt.Qb&&(v[Je]=pt.qb,St=!0),!St)if(F(ke),pt.jc){ft=ke,Ut=v;var Ft=Je,or=pt.pd[M(ft)&ai-1];e(pt.jc),256>or.g?(I(ft,ft.u+or.g),Ut[Ft]=or.value,ft=0):(I(ft,ft.u+or.g-256),e(256<=or.value),ft=or.value),ft==0&&(St=!0)}else ft=Wt(pt.G[0],pt.H[0],ke);if(ke.h)break;if(St||256>ft){if(!St)if(pt.nd)v[Je]=(pt.qb|ft<<8)>>>0;else{if(F(ke),St=Wt(pt.G[1],pt.H[1],ke),F(ke),Ut=Wt(pt.G[2],pt.H[2],ke),Ft=Wt(pt.G[3],pt.H[3],ke),ke.h)break;v[Je]=(Ft<<24|St<<16|ft<<8|Ut)>>>0}if(St=!1,++Je,++Ae>=ie&&(Ae=0,++Pe,be!=null&&Pe<=ve&&!(Pe%16)&&be(d,Pe),Oe!=null))for(;Qe<Je;)ft=v[Qe++],Oe.X[(506832829*ft&4294967295)>>>Oe.Mb]=ft}else if(280>ft){if(ft=bt(ft-256,ke),Ut=Wt(pt.G[4],pt.H[4],ke),F(ke),Ut=Mt(ie,Ut=bt(Ut,ke)),ke.h)break;if(Je-N<Ut||me-Je<ft)break e;for(Ft=0;Ft<ft;++Ft)v[Je+Ft]=v[Je+Ft-Ut];for(Je+=ft,Ae+=ft;Ae>=ie;)Ae-=ie,++Pe,be!=null&&Pe<=ve&&!(Pe%16)&&be(d,Pe);if(e(Je<=me),Ae&je&&(pt=lt(Fe,Ae,Pe)),Oe!=null)for(;Qe<Je;)ft=v[Qe++],Oe.X[(506832829*ft&4294967295)>>>Oe.Mb]=ft}else{if(!(ft<yt))break e;for(St=ft-280,e(Oe!=null);Qe<Je;)ft=v[Qe++],Oe.X[(506832829*ft&4294967295)>>>Oe.Mb]=ft;ft=Je,e(!(St>>>(Ut=Oe).Xa)),v[ft]=Ut.X[St],St=!0}St||e(ke.h==G(ke))}if(d.Pb&&ke.h&&Je<me)e(d.m.h),d.a=5,d.m=d.wd,d.$=d.xd,0<d.s.ua&&se(d.s.vb,d.s.Wa);else{if(ke.h)break e;be?.(d,Pe>ve?ve:Pe),d.a=0,d.$=Je-N}return 1}return d.a=3,0}function er(d){e(d!=null),d.vc=null,d.yc=null,d.Ya=null;var v=d.Wa;v!=null&&(v.X=null),d.vb=null,e(d!=null)}function Kt(){var d=new Ol;return d==null?null:(d.a=0,d.xb=tg,mt("Predictor","VP8LPredictors"),mt("Predictor","VP8LPredictors_C"),mt("PredictorAdd","VP8LPredictorsAdd"),mt("PredictorAdd","VP8LPredictorsAdd_C"),id=Le,Qa=De,qi=Be,Li=We,ta=Ke,bs=st,_s=nt,$.VP8LMapColor32b=zl,$.VP8LMapColor8b=sd,d)}function ir(d,v,N,ie,me){var ve=1,be=[d],Pe=[v],Ae=ie.m,ke=ie.s,Fe=null,Je=0;e:for(;;){if(N)for(;ve&&U(Ae,1);){var Qe=be,Ue=Pe,yt=ie,rt=1,Oe=yt.m,je=yt.gc[yt.ab],pt=U(Oe,2);if(yt.Oc&1<<pt)ve=0;else{switch(yt.Oc|=1<<pt,je.hc=pt,je.Ea=Qe[0],je.nc=Ue[0],je.K=[null],++yt.ab,e(4>=yt.ab),pt){case 0:case 1:je.b=U(Oe,3)+2,rt=ir(ye(je.Ea,je.b),ye(je.nc,je.b),0,yt,je.K),je.K=je.K[0];break;case 3:var St,ft=U(Oe,8)+1,Ut=16<ft?0:4<ft?1:2<ft?2:3;if(Qe[0]=ye(je.Ea,Ut),je.b=Ut,St=rt=ir(ft,1,0,yt,je.K)){var Ft,or=ft,Bt=je,Yr=1<<(8>>Bt.b),en=o(Yr);if(en==null)St=0;else{var zr=Bt.K[0],Mr=Bt.w;for(en[0]=Bt.K[0][0],Ft=1;Ft<1*or;++Ft)en[Ft]=de(zr[Mr+Ft],en[Ft-1]);for(;Ft<4*Yr;++Ft)en[Ft]=0;Bt.K[0]=null,Bt.K[0]=en,St=1}}rt=St;break;case 2:break;default:e(0)}ve=rt}}if(be=be[0],Pe=Pe[0],ve&&U(Ae,1)&&!(ve=1<=(Je=U(Ae,4))&&11>=Je)){ie.a=3;break e}var an;if(an=ve)t:{var on,Ir,Dn,zi=ie,Mn=be,Ui=Pe,tn=Je,no=N,io=zi.m,Qn=zi.s,li=[null],Di=1,vo=0,Jo=$_[tn];r:for(;;){if(no&&U(io,1)){var Xn=U(io,3)+2,xs=ye(Mn,Xn),rl=ye(Ui,Xn),Yl=xs*rl;if(!ir(xs,rl,0,zi,li))break r;for(li=li[0],Qn.xc=Xn,on=0;on<Yl;++on){var sa=li[on]>>8&65535;li[on]=sa,sa>=Di&&(Di=sa+1)}}if(io.h)break r;for(Ir=0;5>Ir;++Ir){var wn=Zy[Ir];!Ir&&0<tn&&(wn+=1<<tn),vo<wn&&(vo=wn)}var $p=s(Di*Jo,P),cg=Di,ug=s(cg,H);if(ug==null)var vd=null;else e(65536>=cg),vd=ug;var Hc=o(vo);if(vd==null||Hc==null||$p==null){zi.a=1;break r}var bd=$p;for(on=Dn=0;on<Di;++on){var $o=vd[on],Kl=$o.G,Jl=$o.H,dg=0,_d=1,hg=0;for(Ir=0;5>Ir;++Ir){wn=Zy[Ir],Kl[Ir]=bd,Jl[Ir]=Dn,!Ir&&0<tn&&(wn+=1<<tn);i:{var Sd,Ep=wn,Pd=zi,Gc=Hc,K_=bd,J_=Dn,Tp=0,aa=Pd.m,Q_=U(aa,1);if(i(Gc,0,0,Ep),Q_){var X_=U(aa,1)+1,Z_=U(aa,1),pg=U(aa,Z_==0?1:8);Gc[pg]=1,X_==2&&(Gc[pg=U(aa,8)]=1);var wd=1}else{var fg=o(19),mg=U(aa,4)+4;if(19<mg){Pd.a=3;var xd=0;break i}for(Sd=0;Sd<mg;++Sd)fg[C_[Sd]]=U(aa,3);var kp=void 0,Wc=void 0,yg=Pd,eS=fg,Ad=Ep,gg=Gc,Np=0,la=yg.m,vg=8,bg=s(128,P);n:for(;_(bg,0,7,eS,19);){if(U(la,1)){var tS=2+2*U(la,3);if((kp=2+U(la,tS))>Ad)break n}else kp=Ad;for(Wc=0;Wc<Ad&&kp--;){F(la);var _g=bg[0+(127&M(la))];I(la,la.u+_g.g);var Ql=_g.value;if(16>Ql)gg[Wc++]=Ql,Ql!=0&&(vg=Ql);else{var rS=Ql==16,Sg=Ql-16,nS=x_[Sg],Pg=U(la,w_[Sg])+nS;if(Wc+Pg>Ad)break n;for(var iS=rS?vg:0;0<Pg--;)gg[Wc++]=iS}}Np=1;break n}Np||(yg.a=3),wd=Np}(wd=wd&&!aa.h)&&(Tp=_(K_,J_,8,Gc,Ep)),wd&&Tp!=0?xd=Tp:(Pd.a=3,xd=0)}if(xd==0)break r;if(_d&&A_[Ir]==1&&(_d=bd[Dn].g==0),dg+=bd[Dn].g,Dn+=xd,3>=Ir){var Yc,Lp=Hc[0];for(Yc=1;Yc<wn;++Yc)Hc[Yc]>Lp&&(Lp=Hc[Yc]);hg+=Lp}}if($o.nd=_d,$o.Qb=0,_d&&($o.qb=(Kl[3][Jl[3]+0].value<<24|Kl[1][Jl[1]+0].value<<16|Kl[2][Jl[2]+0].value)>>>0,dg==0&&256>Kl[0][Jl[0]+0].value&&($o.Qb=1,$o.qb+=Kl[0][Jl[0]+0].value<<8)),$o.jc=!$o.Qb&&6>hg,$o.jc){var Cd,As=$o;for(Cd=0;Cd<ai;++Cd){var ca=Cd,ua=As.pd[ca],Id=As.G[0][As.H[0]+ca];256<=Id.value?(ua.g=Id.g+256,ua.value=Id.value):(ua.g=0,ua.value=0,ca>>=Jt(Id,8,ua),ca>>=Jt(As.G[1][As.H[1]+ca],16,ua),ca>>=Jt(As.G[2][As.H[2]+ca],0,ua),Jt(As.G[3][As.H[3]+ca],24,ua))}}}Qn.vc=li,Qn.Wb=Di,Qn.Ya=vd,Qn.yc=$p,an=1;break t}an=0}if(!(ve=an)){ie.a=3;break e}if(0<Je){if(ke.ua=1<<Je,!ce(ke.Wa,Je)){ie.a=1,ve=0;break e}}else ke.ua=0;var Rp=ie,wg=be,oS=Pe,Dp=Rp.s,Mp=Dp.xc;if(Rp.c=wg,Rp.i=oS,Dp.md=ye(wg,Mp),Dp.wc=Mp==0?-1:(1<<Mp)-1,N){ie.xb=M_;break e}if((Fe=o(be*Pe))==null){ie.a=1,ve=0;break e}ve=(ve=Xt(ie,Fe,0,be,Pe,Pe,null))&&!Ae.h;break e}return ve?(me!=null?me[0]=Fe:(e(Fe==null),e(N)),ie.$=0,N||er(ke)):er(ke),ve}function vr(d,v){var N=d.c*d.i,ie=N+v+16*v;return e(d.c<=v),d.V=o(ie),d.V==null?(d.Ta=null,d.Ua=0,d.a=1,0):(d.Ta=d.V,d.Ua=d.Ba+N+v,1)}function cr(d,v){var N=d.C,ie=v-N,me=d.V,ve=d.Ba+d.c*N;for(e(v<=d.l.o);0<ie;){var be=16<ie?16:ie,Pe=d.l.ma,Ae=d.l.width,ke=Ae*be,Fe=Pe.ca,Je=Pe.tb+Ae*N,Qe=d.Ta,Ue=d.Ua;gt(d,be,me,ve),$n(Qe,Ue,Fe,Je,ke),Vt(Pe,N,N+be,Fe,Je,Ae),ie-=be,me+=be*d.c,N+=be}e(N==v),d.C=d.Ma=v}function br(){this.ub=this.yd=this.td=this.Rb=0}function Nt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Et(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function Cr(){this.Yb=function(){var d=[];return function v(N,ie,me){for(var ve=me[ie],be=0;be<ve&&(N.push(me.length>ie+1?[]:0),!(me.length<ie+1));be++)v(N[be],ie+1,me)}(d,0,[3,11]),d}()}function Tr(){this.jb=o(3),this.Wc=l([4,8],Cr),this.Xc=l([4,17],Cr)}function mr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function gr(){this.ld=this.La=this.dd=this.tc=0}function Er(){this.Na=this.la=0}function Wr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ur(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function un(){this.uc=this.M=this.Nb=0,this.wa=Array(new gr),this.Y=0,this.ya=Array(new ur),this.aa=0,this.l=new bn}function yn(){this.y=o(16),this.f=o(8),this.ea=o(8)}function zn(){this.cb=this.a=0,this.sc="",this.m=new le,this.Od=new br,this.Kc=new Nt,this.ed=new mr,this.Qa=new Et,this.Ic=this.$c=this.Aa=0,this.D=new un,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,le),this.ia=0,this.pb=s(4,Wr),this.Pa=new Tr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new yn),this.Hd=0,this.rb=Array(new Er),this.sb=0,this.wa=Array(new gr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ur),this.L=this.aa=0,this.gd=l([4,2],gr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function bn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function gn(){var d=new zn;return d!=null&&(d.a=0,d.sc="OK",d.cb=0,d.Xb=0,zc||(zc=pi)),d}function kr(d,v,N){return d.a==0&&(d.a=v,d.sc=N,d.cb=0),0}function Un(d,v,N){return 3<=N&&d[v+0]==157&&d[v+1]==1&&d[v+2]==42}function ei(d,v){if(d==null)return 0;if(d.a=0,d.sc="OK",v==null)return kr(d,2,"null VP8Io passed to VP8GetHeaders()");var N=v.data,ie=v.w,me=v.ha;if(4>me)return kr(d,7,"Truncated header.");var ve=N[ie+0]|N[ie+1]<<8|N[ie+2]<<16,be=d.Od;if(be.Rb=!(1&ve),be.td=ve>>1&7,be.yd=ve>>4&1,be.ub=ve>>5,3<be.td)return kr(d,3,"Incorrect keyframe parameters.");if(!be.yd)return kr(d,4,"Frame not displayable.");ie+=3,me-=3;var Pe=d.Kc;if(be.Rb){if(7>me)return kr(d,7,"cannot parse picture header");if(!Un(N,ie,me))return kr(d,3,"Bad code word");Pe.c=16383&(N[ie+4]<<8|N[ie+3]),Pe.Td=N[ie+4]>>6,Pe.i=16383&(N[ie+6]<<8|N[ie+5]),Pe.Ud=N[ie+6]>>6,ie+=7,me-=7,d.za=Pe.c+15>>4,d.Ub=Pe.i+15>>4,v.width=Pe.c,v.height=Pe.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,i((ve=d.Pa).jb,0,255,ve.jb.length),e((ve=d.Qa)!=null),ve.Cb=0,ve.Bb=0,ve.Fb=1,i(ve.Zb,0,0,ve.Zb.length),i(ve.Lb,0,0,ve.Lb)}if(be.ub>me)return kr(d,7,"bad partition length");K(ve=d.m,N,ie,be.ub),ie+=be.ub,me-=be.ub,be.Rb&&(Pe.Ld=Y(ve),Pe.Kd=Y(ve)),Pe=d.Qa;var Ae,ke=d.Pa;if(e(ve!=null),e(Pe!=null),Pe.Cb=Y(ve),Pe.Cb){if(Pe.Bb=Y(ve),Y(ve)){for(Pe.Fb=Y(ve),Ae=0;4>Ae;++Ae)Pe.Zb[Ae]=Y(ve)?k(ve,7):0;for(Ae=0;4>Ae;++Ae)Pe.Lb[Ae]=Y(ve)?k(ve,6):0}if(Pe.Bb)for(Ae=0;3>Ae;++Ae)ke.jb[Ae]=Y(ve)?R(ve,8):255}else Pe.Bb=0;if(ve.Ka)return kr(d,3,"cannot parse segment header");if((Pe=d.ed).zd=Y(ve),Pe.Tb=R(ve,6),Pe.wb=R(ve,3),Pe.Pc=Y(ve),Pe.Pc&&Y(ve)){for(ke=0;4>ke;++ke)Y(ve)&&(Pe.vd[ke]=k(ve,6));for(ke=0;4>ke;++ke)Y(ve)&&(Pe.od[ke]=k(ve,6))}if(d.L=Pe.Tb==0?0:Pe.zd?1:2,ve.Ka)return kr(d,3,"cannot parse filter header");var Fe=me;if(me=Ae=ie,ie=Ae+Fe,Pe=Fe,d.Xb=(1<<R(d.m,2))-1,Fe<3*(ke=d.Xb))N=7;else{for(Ae+=3*ke,Pe-=3*ke,Fe=0;Fe<ke;++Fe){var Je=N[me+0]|N[me+1]<<8|N[me+2]<<16;Je>Pe&&(Je=Pe),K(d.Jc[+Fe],N,Ae,Je),Ae+=Je,Pe-=Je,me+=3}K(d.Jc[+ke],N,Ae,Pe),N=Ae<ie?0:5}if(N!=0)return kr(d,N,"cannot parse partitions");for(N=R(Ae=d.m,7),me=Y(Ae)?k(Ae,4):0,ie=Y(Ae)?k(Ae,4):0,Pe=Y(Ae)?k(Ae,4):0,ke=Y(Ae)?k(Ae,4):0,Ae=Y(Ae)?k(Ae,4):0,Fe=d.Qa,Je=0;4>Je;++Je){if(Fe.Cb){var Qe=Fe.Zb[Je];Fe.Fb||(Qe+=N)}else{if(0<Je){d.pb[Je]=d.pb[0];continue}Qe=N}var Ue=d.pb[Je];Ue.Sc[0]=Ap[Xr(Qe+me,127)],Ue.Sc[1]=Cp[Xr(Qe+0,127)],Ue.Eb[0]=2*Ap[Xr(Qe+ie,127)],Ue.Eb[1]=101581*Cp[Xr(Qe+Pe,127)]>>16,8>Ue.Eb[1]&&(Ue.Eb[1]=8),Ue.Qc[0]=Ap[Xr(Qe+ke,117)],Ue.Qc[1]=Cp[Xr(Qe+Ae,127)],Ue.lc=Qe+Ae}if(!be.Rb)return kr(d,4,"Not a key frame.");for(Y(ve),be=d.Pa,N=0;4>N;++N){for(me=0;8>me;++me)for(ie=0;3>ie;++ie)for(Pe=0;11>Pe;++Pe)ke=Q(ve,R_[N][me][ie][Pe])?R(ve,8):N_[N][me][ie][Pe],be.Wc[N][me].Yb[ie][Pe]=ke;for(me=0;17>me;++me)be.Xc[N][me]=be.Wc[N][D_[me]]}return d.kc=Y(ve),d.kc&&(d.Bd=R(ve,8)),d.cb=1}function pi(d,v,N,ie,me,ve,be){var Pe=v[me].Yb[N];for(N=0;16>me;++me){if(!Q(d,Pe[N+0]))return me;for(;!Q(d,Pe[N+1]);)if(Pe=v[++me].Yb[0],N=0,me==16)return 16;var Ae=v[me+1].Yb;if(Q(d,Pe[N+2])){var ke=d,Fe=0;if(Q(ke,(Qe=Pe)[(Je=N)+3]))if(Q(ke,Qe[Je+6])){for(Pe=0,Je=2*(Fe=Q(ke,Qe[Je+8]))+(Qe=Q(ke,Qe[Je+9+Fe])),Fe=0,Qe=T_[Je];Qe[Pe];++Pe)Fe+=Fe+Q(ke,Qe[Pe]);Fe+=3+(8<<Je)}else Q(ke,Qe[Je+7])?(Fe=7+2*Q(ke,165),Fe+=Q(ke,145)):Fe=5+Q(ke,159);else Fe=Q(ke,Qe[Je+4])?3+Q(ke,Qe[Je+5]):2;Pe=Ae[2]}else Fe=1,Pe=Ae[1];Ae=be+k_[me],0>(ke=d).b&&X(ke);var Je,Qe=ke.b,Ue=(Je=ke.Ca>>1)-(ke.I>>Qe)>>31;--ke.b,ke.Ca+=Ue,ke.Ca|=1,ke.I-=(Je+1&Ue)<<Qe,ve[Ae]=((Fe^Ue)-Ue)*ie[(0<me)+0]}return 16}function tr(d){var v=d.rb[d.sb-1];v.la=0,v.Na=0,i(d.zc,0,0,d.zc.length),d.ja=0}function Nr(d,v){if(d==null)return 0;if(v==null)return kr(d,2,"NULL VP8Io parameter in VP8Decode().");if(!d.cb&&!ei(d,v))return 0;if(e(d.cb),v.ac==null||v.ac(v)){v.ob&&(d.L=0);var N=gd[d.L];if(d.L==2?(d.yb=0,d.zb=0):(d.yb=v.v-N>>4,d.zb=v.j-N>>4,0>d.yb&&(d.yb=0),0>d.zb&&(d.zb=0)),d.Va=v.o+15+N>>4,d.Hb=v.va+15+N>>4,d.Hb>d.za&&(d.Hb=d.za),d.Va>d.Ub&&(d.Va=d.Ub),0<d.L){var ie=d.ed;for(N=0;4>N;++N){var me;if(d.Qa.Cb){var ve=d.Qa.Lb[N];d.Qa.Fb||(ve+=ie.Tb)}else ve=ie.Tb;for(me=0;1>=me;++me){var be=d.gd[N][me],Pe=ve;if(ie.Pc&&(Pe+=ie.vd[0],me&&(Pe+=ie.od[0])),0<(Pe=0>Pe?0:63<Pe?63:Pe)){var Ae=Pe;0<ie.wb&&(Ae=4<ie.wb?Ae>>2:Ae>>1)>9-ie.wb&&(Ae=9-ie.wb),1>Ae&&(Ae=1),be.dd=Ae,be.tc=2*Pe+Ae,be.ld=40<=Pe?2:15<=Pe?1:0}else be.tc=0;be.La=me}}}N=0}else kr(d,6,"Frame setup failed"),N=d.a;if(N=N==0){if(N){d.$c=0,0<d.Aa||(d.Ic=Y_);e:{N=d.Ic,ie=4*(Ae=d.za);var ke=32*Ae,Fe=Ae+1,Je=0<d.L?Ae*(0<d.Aa?2:1):0,Qe=(d.Aa==2?2:1)*Ae;if((be=ie+832+(me=3*(16*N+gd[d.L])/2*ke)+(ve=d.Fa!=null&&0<d.Fa.length?d.Kc.c*d.Kc.i:0))!=be)N=0;else{if(be>d.Vb){if(d.Vb=0,d.Ec=o(be),d.Fc=0,d.Ec==null){N=kr(d,1,"no memory during frame initialization.");break e}d.Vb=be}be=d.Ec,Pe=d.Fc,d.Ac=be,d.Bc=Pe,Pe+=ie,d.Gd=s(ke,yn),d.Hd=0,d.rb=s(Fe+1,Er),d.sb=1,d.wa=Je?s(Je,gr):null,d.Y=0,d.D.Nb=0,d.D.wa=d.wa,d.D.Y=d.Y,0<d.Aa&&(d.D.Y+=Ae),e(!0),d.oc=be,d.pc=Pe,Pe+=832,d.ya=s(Qe,ur),d.aa=0,d.D.ya=d.ya,d.D.aa=d.aa,d.Aa==2&&(d.D.aa+=Ae),d.R=16*Ae,d.B=8*Ae,Ae=(ke=gd[d.L])*d.R,ke=ke/2*d.B,d.sa=be,d.ta=Pe+Ae,d.qa=d.sa,d.ra=d.ta+16*N*d.R+ke,d.Ha=d.qa,d.Ia=d.ra+8*N*d.B+ke,d.$c=0,Pe+=me,d.mb=ve?be:null,d.nb=ve?Pe:null,e(Pe+ve<=d.Fc+d.Vb),tr(d),i(d.Ac,d.Bc,0,ie),N=1}}if(N){if(v.ka=0,v.y=d.sa,v.O=d.ta,v.f=d.qa,v.N=d.ra,v.ea=d.Ha,v.Vd=d.Ia,v.fa=d.R,v.Rc=d.B,v.F=null,v.J=0,!ld){for(N=-255;255>=N;++N)Gn[255+N]=0>N?-N:N;for(N=-1020;1020>=N;++N)Ps[1020+N]=-128>N?-128:127<N?127:N;for(N=-112;112>=N;++N)qc[112+N]=-16>N?-16:15<N?15:N;for(N=-255;510>=N;++N)Wl[255+N]=0>N?0:255<N?255:N;ld=1}Ul=nn,Ss=ri,Bc=_t,Ri=ar,po=vn,In=ti,Hl=Gs,ad=xo,jc=Ys,Xa=Ja,Za=Ws,ra=ys,el=Ks,Gl=Go,tl=ms,na=to,Vc=Hn,fo=Fl,Io[0]=ji,Io[1]=Jn,Io[2]=uo,Io[3]=Ua,Io[4]=Vo,Io[5]=qo,Io[6]=ii,Io[7]=fs,Io[8]=Uo,Io[9]=zo,ia[0]=Rn,ia[1]=co,ia[2]=Pn,ia[3]=Bi,ia[4]=Rr,ia[5]=mi,ia[6]=yi,ws[0]=eo,ws[1]=ni,ws[2]=Us,ws[3]=Zi,ws[4]=Qr,ws[5]=Ha,ws[6]=Ga,N=1}else N=0}N&&(N=function(Ue,yt){for(Ue.M=0;Ue.M<Ue.Va;++Ue.M){var rt,Oe=Ue.Jc[Ue.M&Ue.Xb],je=Ue.m,pt=Ue;for(rt=0;rt<pt.za;++rt){var St=je,ft=pt,Ut=ft.Ac,Ft=ft.Bc+4*rt,or=ft.zc,Bt=ft.ya[ft.aa+rt];if(ft.Qa.Bb?Bt.$b=Q(St,ft.Pa.jb[0])?2+Q(St,ft.Pa.jb[2]):Q(St,ft.Pa.jb[1]):Bt.$b=0,ft.kc&&(Bt.Ad=Q(St,ft.Bd)),Bt.Za=!Q(St,145)+0,Bt.Za){var Yr=Bt.Ob,en=0;for(ft=0;4>ft;++ft){var zr,Mr=or[0+ft];for(zr=0;4>zr;++zr){Mr=L_[Ut[Ft+zr]][Mr];for(var an=eg[Q(St,Mr[0])];0<an;)an=eg[2*an+Q(St,Mr[an])];Mr=-an,Ut[Ft+zr]=Mr}n(Yr,en,Ut,Ft,4),en+=4,or[0+ft]=Mr}}else Mr=Q(St,156)?Q(St,128)?1:3:Q(St,163)?2:0,Bt.Ob[0]=Mr,i(Ut,Ft,Mr,4),i(or,0,Mr,4);Bt.Dd=Q(St,142)?Q(St,114)?Q(St,183)?1:3:2:0}if(pt.m.Ka)return kr(Ue,7,"Premature end-of-partition0 encountered.");for(;Ue.ja<Ue.za;++Ue.ja){if(pt=Oe,St=(je=Ue).rb[je.sb-1],Ut=je.rb[je.sb+je.ja],rt=je.ya[je.aa+je.ja],Ft=je.kc?rt.Ad:0)St.la=Ut.la=0,rt.Za||(St.Na=Ut.Na=0),rt.Hc=0,rt.Gc=0,rt.ia=0;else{var on,Ir;if(St=Ut,Ut=pt,Ft=je.Pa.Xc,or=je.ya[je.aa+je.ja],Bt=je.pb[or.$b],ft=or.ad,Yr=0,en=je.rb[je.sb-1],Mr=zr=0,i(ft,Yr,0,384),or.Za)var Dn=0,zi=Ft[3];else{an=o(16);var Mn=St.Na+en.Na;if(Mn=zc(Ut,Ft[1],Mn,Bt.Eb,0,an,0),St.Na=en.Na=(0<Mn)+0,1<Mn)Ul(an,0,ft,Yr);else{var Ui=an[0]+3>>3;for(an=0;256>an;an+=16)ft[Yr+an]=Ui}Dn=1,zi=Ft[0]}var tn=15&St.la,no=15&en.la;for(an=0;4>an;++an){var io=1&no;for(Ui=Ir=0;4>Ui;++Ui)tn=tn>>1|(io=(Mn=zc(Ut,zi,Mn=io+(1&tn),Bt.Sc,Dn,ft,Yr))>Dn)<<7,Ir=Ir<<2|(3<Mn?3:1<Mn?2:ft[Yr+0]!=0),Yr+=16;tn>>=4,no=no>>1|io<<7,zr=(zr<<8|Ir)>>>0}for(zi=tn,Dn=no>>4,on=0;4>on;on+=2){for(Ir=0,tn=St.la>>4+on,no=en.la>>4+on,an=0;2>an;++an){for(io=1&no,Ui=0;2>Ui;++Ui)Mn=io+(1&tn),tn=tn>>1|(io=0<(Mn=zc(Ut,Ft[2],Mn,Bt.Qc,0,ft,Yr)))<<3,Ir=Ir<<2|(3<Mn?3:1<Mn?2:ft[Yr+0]!=0),Yr+=16;tn>>=2,no=no>>1|io<<5}Mr|=Ir<<4*on,zi|=tn<<4<<on,Dn|=(240&no)<<on}St.la=zi,en.la=Dn,or.Hc=zr,or.Gc=Mr,or.ia=43690&Mr?0:Bt.ia,Ft=!(zr|Mr)}if(0<je.L&&(je.wa[je.Y+je.ja]=je.gd[rt.$b][rt.Za],je.wa[je.Y+je.ja].La|=!Ft),pt.Ka)return kr(Ue,7,"Premature end-of-file encountered.")}if(tr(Ue),je=yt,pt=1,rt=(Oe=Ue).D,St=0<Oe.L&&Oe.M>=Oe.zb&&Oe.M<=Oe.Va,Oe.Aa==0)e:{if(rt.M=Oe.M,rt.uc=St,Yo(Oe,rt),pt=1,rt=(Ir=Oe.D).Nb,St=(Mr=gd[Oe.L])*Oe.R,Ut=Mr/2*Oe.B,an=16*rt*Oe.R,Ui=8*rt*Oe.B,Ft=Oe.sa,or=Oe.ta-St+an,Bt=Oe.qa,ft=Oe.ra-Ut+Ui,Yr=Oe.Ha,en=Oe.Ia-Ut+Ui,no=(tn=Ir.M)==0,zr=tn>=Oe.Va-1,Oe.Aa==2&&Yo(Oe,Ir),Ir.uc)for(io=(Mn=Oe).D.M,e(Mn.D.uc),Ir=Mn.yb;Ir<Mn.Hb;++Ir){Dn=Ir,zi=io;var Qn=(li=(wn=Mn).D).Nb;on=wn.R;var li=li.wa[li.Y+Dn],Di=wn.sa,vo=wn.ta+16*Qn*on+16*Dn,Jo=li.dd,Xn=li.tc;if(Xn!=0)if(e(3<=Xn),wn.L==1)0<Dn&&na(Di,vo,on,Xn+4),li.La&&fo(Di,vo,on,Xn),0<zi&&tl(Di,vo,on,Xn+4),li.La&&Vc(Di,vo,on,Xn);else{var xs=wn.B,rl=wn.qa,Yl=wn.ra+8*Qn*xs+8*Dn,sa=wn.Ha,wn=wn.Ia+8*Qn*xs+8*Dn;Qn=li.ld,0<Dn&&(ad(Di,vo,on,Xn+4,Jo,Qn),Xa(rl,Yl,sa,wn,xs,Xn+4,Jo,Qn)),li.La&&(ra(Di,vo,on,Xn,Jo,Qn),Gl(rl,Yl,sa,wn,xs,Xn,Jo,Qn)),0<zi&&(Hl(Di,vo,on,Xn+4,Jo,Qn),jc(rl,Yl,sa,wn,xs,Xn+4,Jo,Qn)),li.La&&(Za(Di,vo,on,Xn,Jo,Qn),el(rl,Yl,sa,wn,xs,Xn,Jo,Qn))}}if(Oe.ia&&alert("todo:DitherRow"),je.put!=null){if(Ir=16*tn,tn=16*(tn+1),no?(je.y=Oe.sa,je.O=Oe.ta+an,je.f=Oe.qa,je.N=Oe.ra+Ui,je.ea=Oe.Ha,je.W=Oe.Ia+Ui):(Ir-=Mr,je.y=Ft,je.O=or,je.f=Bt,je.N=ft,je.ea=Yr,je.W=en),zr||(tn-=Mr),tn>je.o&&(tn=je.o),je.F=null,je.J=null,Oe.Fa!=null&&0<Oe.Fa.length&&Ir<tn&&(je.J=Zs(Oe,je,Ir,tn-Ir),je.F=Oe.mb,je.F==null&&je.F.length==0)){pt=kr(Oe,3,"Could not decode alpha data.");break e}Ir<je.j&&(Mr=je.j-Ir,Ir=je.j,e(!(1&Mr)),je.O+=Oe.R*Mr,je.N+=Oe.B*(Mr>>1),je.W+=Oe.B*(Mr>>1),je.F!=null&&(je.J+=je.width*Mr)),Ir<tn&&(je.O+=je.v,je.N+=je.v>>1,je.W+=je.v>>1,je.F!=null&&(je.J+=je.v),je.ka=Ir-je.j,je.U=je.va-je.v,je.T=tn-Ir,pt=je.put(je))}rt+1!=Oe.Ic||zr||(n(Oe.sa,Oe.ta-St,Ft,or+16*Oe.R,St),n(Oe.qa,Oe.ra-Ut,Bt,ft+8*Oe.B,Ut),n(Oe.Ha,Oe.Ia-Ut,Yr,en+8*Oe.B,Ut))}if(!pt)return kr(Ue,6,"Output aborted.")}return 1}(d,v)),v.bc!=null&&v.bc(v),N&=1}return N?(d.cb=0,N):0}function Vr(d,v,N,ie,me){me=d[v+N+32*ie]+(me>>3),d[v+N+32*ie]=-256&me?0>me?0:255:me}function _n(d,v,N,ie,me,ve){Vr(d,v,0,N,ie+me),Vr(d,v,1,N,ie+ve),Vr(d,v,2,N,ie-ve),Vr(d,v,3,N,ie-me)}function qr(d){return(20091*d>>16)+d}function Lr(d,v,N,ie){var me,ve=0,be=o(16);for(me=0;4>me;++me){var Pe=d[v+0]+d[v+8],Ae=d[v+0]-d[v+8],ke=(35468*d[v+4]>>16)-qr(d[v+12]),Fe=qr(d[v+4])+(35468*d[v+12]>>16);be[ve+0]=Pe+Fe,be[ve+1]=Ae+ke,be[ve+2]=Ae-ke,be[ve+3]=Pe-Fe,ve+=4,v++}for(me=ve=0;4>me;++me)Pe=(d=be[ve+0]+4)+be[ve+8],Ae=d-be[ve+8],ke=(35468*be[ve+4]>>16)-qr(be[ve+12]),Vr(N,ie,0,0,Pe+(Fe=qr(be[ve+4])+(35468*be[ve+12]>>16))),Vr(N,ie,1,0,Ae+ke),Vr(N,ie,2,0,Ae-ke),Vr(N,ie,3,0,Pe-Fe),ve++,ie+=32}function ti(d,v,N,ie){var me=d[v+0]+4,ve=35468*d[v+4]>>16,be=qr(d[v+4]),Pe=35468*d[v+1]>>16;_n(N,ie,0,me+be,d=qr(d[v+1]),Pe),_n(N,ie,1,me+ve,d,Pe),_n(N,ie,2,me-ve,d,Pe),_n(N,ie,3,me-be,d,Pe)}function ri(d,v,N,ie,me){Lr(d,v,N,ie),me&&Lr(d,v+16,N,ie+4)}function _t(d,v,N,ie){Ss(d,v+0,N,ie,1),Ss(d,v+32,N,ie+128,1)}function ar(d,v,N,ie){var me;for(d=d[v+0]+4,me=0;4>me;++me)for(v=0;4>v;++v)Vr(N,ie,v,me,d)}function vn(d,v,N,ie){d[v+0]&&Ri(d,v+0,N,ie),d[v+16]&&Ri(d,v+16,N,ie+4),d[v+32]&&Ri(d,v+32,N,ie+128),d[v+48]&&Ri(d,v+48,N,ie+128+4)}function nn(d,v,N,ie){var me,ve=o(16);for(me=0;4>me;++me){var be=d[v+0+me]+d[v+12+me],Pe=d[v+4+me]+d[v+8+me],Ae=d[v+4+me]-d[v+8+me],ke=d[v+0+me]-d[v+12+me];ve[0+me]=be+Pe,ve[8+me]=be-Pe,ve[4+me]=ke+Ae,ve[12+me]=ke-Ae}for(me=0;4>me;++me)be=(d=ve[0+4*me]+3)+ve[3+4*me],Pe=ve[1+4*me]+ve[2+4*me],Ae=ve[1+4*me]-ve[2+4*me],ke=d-ve[3+4*me],N[ie+0]=be+Pe>>3,N[ie+16]=ke+Ae>>3,N[ie+32]=be-Pe>>3,N[ie+48]=ke-Ae>>3,ie+=64}function Gr(d,v,N){var ie,me=v-32,ve=ro,be=255-d[me-1];for(ie=0;ie<N;++ie){var Pe,Ae=ve,ke=be+d[v-1];for(Pe=0;Pe<N;++Pe)d[v+Pe]=Ae[ke+d[me+Pe]];v+=32}}function Jn(d,v){Gr(d,v,4)}function ni(d,v){Gr(d,v,8)}function co(d,v){Gr(d,v,16)}function Pn(d,v){var N;for(N=0;16>N;++N)n(d,v+32*N,d,v-32,16)}function Bi(d,v){var N;for(N=16;0<N;--N)i(d,v,d[v-1],16),v+=32}function fi(d,v,N){var ie;for(ie=0;16>ie;++ie)i(v,N+32*ie,d,16)}function Rn(d,v){var N,ie=16;for(N=0;16>N;++N)ie+=d[v-1+32*N]+d[v+N-32];fi(ie>>5,d,v)}function Rr(d,v){var N,ie=8;for(N=0;16>N;++N)ie+=d[v-1+32*N];fi(ie>>4,d,v)}function mi(d,v){var N,ie=8;for(N=0;16>N;++N)ie+=d[v+N-32];fi(ie>>4,d,v)}function yi(d,v){fi(128,d,v)}function nr(d,v,N){return d+2*v+N+2>>2}function uo(d,v){var N,ie=v-32;for(ie=new Uint8Array([nr(d[ie-1],d[ie+0],d[ie+1]),nr(d[ie+0],d[ie+1],d[ie+2]),nr(d[ie+1],d[ie+2],d[ie+3]),nr(d[ie+2],d[ie+3],d[ie+4])]),N=0;4>N;++N)n(d,v+32*N,ie,0,ie.length)}function Ua(d,v){var N=d[v-1],ie=d[v-1+32],me=d[v-1+64],ve=d[v-1+96];J(d,v+0,16843009*nr(d[v-1-32],N,ie)),J(d,v+32,16843009*nr(N,ie,me)),J(d,v+64,16843009*nr(ie,me,ve)),J(d,v+96,16843009*nr(me,ve,ve))}function ji(d,v){var N,ie=4;for(N=0;4>N;++N)ie+=d[v+N-32]+d[v-1+32*N];for(ie>>=3,N=0;4>N;++N)i(d,v+32*N,ie,4)}function Vo(d,v){var N=d[v-1+0],ie=d[v-1+32],me=d[v-1+64],ve=d[v-1-32],be=d[v+0-32],Pe=d[v+1-32],Ae=d[v+2-32],ke=d[v+3-32];d[v+0+96]=nr(ie,me,d[v-1+96]),d[v+1+96]=d[v+0+64]=nr(N,ie,me),d[v+2+96]=d[v+1+64]=d[v+0+32]=nr(ve,N,ie),d[v+3+96]=d[v+2+64]=d[v+1+32]=d[v+0+0]=nr(be,ve,N),d[v+3+64]=d[v+2+32]=d[v+1+0]=nr(Pe,be,ve),d[v+3+32]=d[v+2+0]=nr(Ae,Pe,be),d[v+3+0]=nr(ke,Ae,Pe)}function ii(d,v){var N=d[v+1-32],ie=d[v+2-32],me=d[v+3-32],ve=d[v+4-32],be=d[v+5-32],Pe=d[v+6-32],Ae=d[v+7-32];d[v+0+0]=nr(d[v+0-32],N,ie),d[v+1+0]=d[v+0+32]=nr(N,ie,me),d[v+2+0]=d[v+1+32]=d[v+0+64]=nr(ie,me,ve),d[v+3+0]=d[v+2+32]=d[v+1+64]=d[v+0+96]=nr(me,ve,be),d[v+3+32]=d[v+2+64]=d[v+1+96]=nr(ve,be,Pe),d[v+3+64]=d[v+2+96]=nr(be,Pe,Ae),d[v+3+96]=nr(Pe,Ae,Ae)}function qo(d,v){var N=d[v-1+0],ie=d[v-1+32],me=d[v-1+64],ve=d[v-1-32],be=d[v+0-32],Pe=d[v+1-32],Ae=d[v+2-32],ke=d[v+3-32];d[v+0+0]=d[v+1+64]=ve+be+1>>1,d[v+1+0]=d[v+2+64]=be+Pe+1>>1,d[v+2+0]=d[v+3+64]=Pe+Ae+1>>1,d[v+3+0]=Ae+ke+1>>1,d[v+0+96]=nr(me,ie,N),d[v+0+64]=nr(ie,N,ve),d[v+0+32]=d[v+1+96]=nr(N,ve,be),d[v+1+32]=d[v+2+96]=nr(ve,be,Pe),d[v+2+32]=d[v+3+96]=nr(be,Pe,Ae),d[v+3+32]=nr(Pe,Ae,ke)}function fs(d,v){var N=d[v+0-32],ie=d[v+1-32],me=d[v+2-32],ve=d[v+3-32],be=d[v+4-32],Pe=d[v+5-32],Ae=d[v+6-32],ke=d[v+7-32];d[v+0+0]=N+ie+1>>1,d[v+1+0]=d[v+0+64]=ie+me+1>>1,d[v+2+0]=d[v+1+64]=me+ve+1>>1,d[v+3+0]=d[v+2+64]=ve+be+1>>1,d[v+0+32]=nr(N,ie,me),d[v+1+32]=d[v+0+96]=nr(ie,me,ve),d[v+2+32]=d[v+1+96]=nr(me,ve,be),d[v+3+32]=d[v+2+96]=nr(ve,be,Pe),d[v+3+64]=nr(be,Pe,Ae),d[v+3+96]=nr(Pe,Ae,ke)}function zo(d,v){var N=d[v-1+0],ie=d[v-1+32],me=d[v-1+64],ve=d[v-1+96];d[v+0+0]=N+ie+1>>1,d[v+2+0]=d[v+0+32]=ie+me+1>>1,d[v+2+32]=d[v+0+64]=me+ve+1>>1,d[v+1+0]=nr(N,ie,me),d[v+3+0]=d[v+1+32]=nr(ie,me,ve),d[v+3+32]=d[v+1+64]=nr(me,ve,ve),d[v+3+64]=d[v+2+64]=d[v+0+96]=d[v+1+96]=d[v+2+96]=d[v+3+96]=ve}function Uo(d,v){var N=d[v-1+0],ie=d[v-1+32],me=d[v-1+64],ve=d[v-1+96],be=d[v-1-32],Pe=d[v+0-32],Ae=d[v+1-32],ke=d[v+2-32];d[v+0+0]=d[v+2+32]=N+be+1>>1,d[v+0+32]=d[v+2+64]=ie+N+1>>1,d[v+0+64]=d[v+2+96]=me+ie+1>>1,d[v+0+96]=ve+me+1>>1,d[v+3+0]=nr(Pe,Ae,ke),d[v+2+0]=nr(be,Pe,Ae),d[v+1+0]=d[v+3+32]=nr(N,be,Pe),d[v+1+32]=d[v+3+64]=nr(ie,N,be),d[v+1+64]=d[v+3+96]=nr(me,ie,N),d[v+1+96]=nr(ve,me,ie)}function Us(d,v){var N;for(N=0;8>N;++N)n(d,v+32*N,d,v-32,8)}function Zi(d,v){var N;for(N=0;8>N;++N)i(d,v,d[v-1],8),v+=32}function Ni(d,v,N){var ie;for(ie=0;8>ie;++ie)i(v,N+32*ie,d,8)}function eo(d,v){var N,ie=8;for(N=0;8>N;++N)ie+=d[v+N-32]+d[v-1+32*N];Ni(ie>>4,d,v)}function Ha(d,v){var N,ie=4;for(N=0;8>N;++N)ie+=d[v+N-32];Ni(ie>>3,d,v)}function Qr(d,v){var N,ie=4;for(N=0;8>N;++N)ie+=d[v-1+32*N];Ni(ie>>3,d,v)}function Ga(d,v){Ni(128,d,v)}function Hs(d,v,N){var ie=d[v-N],me=d[v+0],ve=3*(me-ie)+_p[1020+d[v-2*N]-d[v+N]],be=cd[112+(ve+4>>3)];d[v-N]=ro[255+ie+cd[112+(ve+3>>3)]],d[v+0]=ro[255+me-be]}function Wa(d,v,N,ie){var me=d[v+0],ve=d[v+N];return yo[255+d[v-2*N]-d[v-N]]>ie||yo[255+ve-me]>ie}function Ya(d,v,N,ie){return 4*yo[255+d[v-N]-d[v+0]]+yo[255+d[v-2*N]-d[v+N]]<=ie}function Ka(d,v,N,ie,me){var ve=d[v-3*N],be=d[v-2*N],Pe=d[v-N],Ae=d[v+0],ke=d[v+N],Fe=d[v+2*N],Je=d[v+3*N];return 4*yo[255+Pe-Ae]+yo[255+be-ke]>ie?0:yo[255+d[v-4*N]-ve]<=me&&yo[255+ve-be]<=me&&yo[255+be-Pe]<=me&&yo[255+Je-Fe]<=me&&yo[255+Fe-ke]<=me&&yo[255+ke-Ae]<=me}function ms(d,v,N,ie){var me=2*ie+1;for(ie=0;16>ie;++ie)Ya(d,v+ie,N,me)&&Hs(d,v+ie,N)}function to(d,v,N,ie){var me=2*ie+1;for(ie=0;16>ie;++ie)Ya(d,v+ie*N,1,me)&&Hs(d,v+ie*N,1)}function Hn(d,v,N,ie){var me;for(me=3;0<me;--me)ms(d,v+=4*N,N,ie)}function Fl(d,v,N,ie){var me;for(me=3;0<me;--me)to(d,v+=4,N,ie)}function Ho(d,v,N,ie,me,ve,be,Pe){for(ve=2*ve+1;0<me--;){if(Ka(d,v,N,ve,be))if(Wa(d,v,N,Pe))Hs(d,v,N);else{var Ae=d,ke=v,Fe=N,Je=Ae[ke-2*Fe],Qe=Ae[ke-Fe],Ue=Ae[ke+0],yt=Ae[ke+Fe],rt=Ae[ke+2*Fe],Oe=27*(pt=_p[1020+3*(Ue-Qe)+_p[1020+Je-yt]])+63>>7,je=18*pt+63>>7,pt=9*pt+63>>7;Ae[ke-3*Fe]=ro[255+Ae[ke-3*Fe]+pt],Ae[ke-2*Fe]=ro[255+Je+je],Ae[ke-Fe]=ro[255+Qe+Oe],Ae[ke+0]=ro[255+Ue-Oe],Ae[ke+Fe]=ro[255+yt-je],Ae[ke+2*Fe]=ro[255+rt-pt]}v+=ie}}function oi(d,v,N,ie,me,ve,be,Pe){for(ve=2*ve+1;0<me--;){if(Ka(d,v,N,ve,be))if(Wa(d,v,N,Pe))Hs(d,v,N);else{var Ae=d,ke=v,Fe=N,Je=Ae[ke-Fe],Qe=Ae[ke+0],Ue=Ae[ke+Fe],yt=cd[112+((rt=3*(Qe-Je))+4>>3)],rt=cd[112+(rt+3>>3)],Oe=yt+1>>1;Ae[ke-2*Fe]=ro[255+Ae[ke-2*Fe]+Oe],Ae[ke-Fe]=ro[255+Je+rt],Ae[ke+0]=ro[255+Qe-yt],Ae[ke+Fe]=ro[255+Ue-Oe]}v+=ie}}function Gs(d,v,N,ie,me,ve){Ho(d,v,N,1,16,ie,me,ve)}function xo(d,v,N,ie,me,ve){Ho(d,v,1,N,16,ie,me,ve)}function Ws(d,v,N,ie,me,ve){var be;for(be=3;0<be;--be)oi(d,v+=4*N,N,1,16,ie,me,ve)}function ys(d,v,N,ie,me,ve){var be;for(be=3;0<be;--be)oi(d,v+=4,1,N,16,ie,me,ve)}function Ys(d,v,N,ie,me,ve,be,Pe){Ho(d,v,me,1,8,ve,be,Pe),Ho(N,ie,me,1,8,ve,be,Pe)}function Ja(d,v,N,ie,me,ve,be,Pe){Ho(d,v,1,me,8,ve,be,Pe),Ho(N,ie,1,me,8,ve,be,Pe)}function Ks(d,v,N,ie,me,ve,be,Pe){oi(d,v+4*me,me,1,8,ve,be,Pe),oi(N,ie+4*me,me,1,8,ve,be,Pe)}function Go(d,v,N,ie,me,ve,be,Pe){oi(d,v+4,1,me,8,ve,be,Pe),oi(N,ie+4,1,me,8,ve,be,Pe)}function gs(){this.ba=new Xe,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Tt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Js(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function vs(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Qs(){this.ua=0,this.Wa=new q,this.vb=new q,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new H,this.yc=new P}function Ol(){this.xb=this.a=0,this.l=new bn,this.ca=new Xe,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new L,this.Pb=0,this.wd=new L,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Qs,this.ab=0,this.gc=s(4,vs),this.Oc=0}function Ao(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new bn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Wo(d,v,N,ie,me,ve,be){for(d=d==null?0:d[v+0],v=0;v<be;++v)me[ve+v]=d+N[ie+v]&255,d=me[ve+v]}function Xs(d,v,N,ie,me,ve,be){var Pe;if(d==null)Wo(null,null,N,ie,me,ve,be);else for(Pe=0;Pe<be;++Pe)me[ve+Pe]=d[v+Pe]+N[ie+Pe]&255}function gi(d,v,N,ie,me,ve,be){if(d==null)Wo(null,null,N,ie,me,ve,be);else{var Pe,Ae=d[v+0],ke=Ae,Fe=Ae;for(Pe=0;Pe<be;++Pe)ke=Fe+(Ae=d[v+Pe])-ke,Fe=N[ie+Pe]+(-256&ke?0>ke?0:255:ke)&255,ke=Ae,me[ve+Pe]=Fe}}function Zs(d,v,N,ie){var me=v.width,ve=v.o;if(e(d!=null&&v!=null),0>N||0>=ie||N+ie>ve)return null;if(!d.Cc){if(d.ga==null){var be;if(d.ga=new Ao,(be=d.ga==null)||(be=v.width*v.o,e(d.Gb.length==0),d.Gb=o(be),d.Uc=0,d.Gb==null?be=0:(d.mb=d.Gb,d.nb=d.Uc,d.rc=null,be=1),be=!be),!be){be=d.ga;var Pe=d.Fa,Ae=d.P,ke=d.qc,Fe=d.mb,Je=d.nb,Qe=Ae+1,Ue=ke-1,yt=be.l;if(e(Pe!=null&&Fe!=null&&v!=null),oa[0]=null,oa[1]=Wo,oa[2]=Xs,oa[3]=gi,be.ca=Fe,be.tb=Je,be.c=v.width,be.i=v.height,e(0<be.c&&0<be.i),1>=ke)v=0;else if(be.$a=Pe[Ae+0]>>0&3,be.Z=Pe[Ae+0]>>2&3,be.Lc=Pe[Ae+0]>>4&3,Ae=Pe[Ae+0]>>6&3,0>be.$a||1<be.$a||4<=be.Z||1<be.Lc||Ae)v=0;else if(yt.put=Ct,yt.ac=ze,yt.bc=xt,yt.ma=be,yt.width=v.width,yt.height=v.height,yt.Da=v.Da,yt.v=v.v,yt.va=v.va,yt.j=v.j,yt.o=v.o,be.$a)e:{e(be.$a==1),v=Kt();t:for(;;){if(v==null){v=0;break e}if(e(be!=null),be.mc=v,v.c=be.c,v.i=be.i,v.l=be.l,v.l.ma=be,v.l.width=be.c,v.l.height=be.i,v.a=0,W(v.m,Pe,Qe,Ue),!ir(be.c,be.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&et(v.s)?(be.ic=1,Pe=v.c*v.i,v.Ta=null,v.Ua=0,v.V=o(Pe),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(be.ic=0,v=vr(v,be.c)),!v))break t;v=1;break e}be.mc=null,v=0}else v=Ue>=be.c*be.i;be=!v}if(be)return null;d.ga.Lc!=1?d.Ga=0:ie=ve-N}e(d.ga!=null),e(N+ie<=ve);e:{if(v=(Pe=d.ga).c,ve=Pe.l.o,Pe.$a==0){if(Qe=d.rc,Ue=d.Vc,yt=d.Fa,Ae=d.P+1+N*v,ke=d.mb,Fe=d.nb+N*v,e(Ae<=d.P+d.qc),Pe.Z!=0)for(e(oa[Pe.Z]!=null),be=0;be<ie;++be)oa[Pe.Z](Qe,Ue,yt,Ae,ke,Fe,v),Qe=ke,Ue=Fe,Fe+=v,Ae+=v;else for(be=0;be<ie;++be)n(ke,Fe,yt,Ae,v),Qe=ke,Ue=Fe,Fe+=v,Ae+=v;d.rc=Qe,d.Vc=Ue}else{if(e(Pe.mc!=null),v=N+ie,e((be=Pe.mc)!=null),e(v<=be.i),be.C>=v)v=1;else if(Pe.ic||qe(),Pe.ic){Pe=be.V,Qe=be.Ba,Ue=be.c;var rt=be.i,Oe=(yt=1,Ae=be.$/Ue,ke=be.$%Ue,Fe=be.m,Je=be.s,be.$),je=Ue*rt,pt=Ue*v,St=Je.wc,ft=Oe<pt?lt(Je,ke,Ae):null;e(Oe<=je),e(v<=rt),e(et(Je));t:for(;;){for(;!Fe.h&&Oe<pt;){if(ke&St||(ft=lt(Je,ke,Ae)),e(ft!=null),F(Fe),256>(rt=Wt(ft.G[0],ft.H[0],Fe)))Pe[Qe+Oe]=rt,++Oe,++ke>=Ue&&(ke=0,++Ae<=v&&!(Ae%16)&&Ht(be,Ae));else{if(!(280>rt)){yt=0;break t}rt=bt(rt-256,Fe);var Ut,Ft=Wt(ft.G[4],ft.H[4],Fe);if(F(Fe),!(Oe>=(Ft=Mt(Ue,Ft=bt(Ft,Fe)))&&je-Oe>=rt)){yt=0;break t}for(Ut=0;Ut<rt;++Ut)Pe[Qe+Oe+Ut]=Pe[Qe+Oe+Ut-Ft];for(Oe+=rt,ke+=rt;ke>=Ue;)ke-=Ue,++Ae<=v&&!(Ae%16)&&Ht(be,Ae);Oe<pt&&ke&St&&(ft=lt(Je,ke,Ae))}e(Fe.h==G(Fe))}Ht(be,Ae>v?v:Ae);break t}!yt||Fe.h&&Oe<je?(yt=0,be.a=Fe.h?5:3):be.$=Oe,v=yt}else v=Xt(be,be.V,be.Ba,be.c,be.i,v,cr);if(!v){ie=0;break e}}N+ie>=ve&&(d.Cc=1),ie=1}if(!ie)return null;if(d.Cc&&((ie=d.ga)!=null&&(ie.mc=null),d.ga=null,0<d.Ga))return alert("todo:WebPDequantizeLevels"),null}return d.nb+N*me}function A(d,v,N,ie,me,ve){for(;0<me--;){var be,Pe=d,Ae=v+(N?1:0),ke=d,Fe=v+(N?0:3);for(be=0;be<ie;++be){var Je=ke[Fe+4*be];Je!=255&&(Je*=32897,Pe[Ae+4*be+0]=Pe[Ae+4*be+0]*Je>>23,Pe[Ae+4*be+1]=Pe[Ae+4*be+1]*Je>>23,Pe[Ae+4*be+2]=Pe[Ae+4*be+2]*Je>>23)}v+=ve}}function fe(d,v,N,ie,me){for(;0<ie--;){var ve;for(ve=0;ve<N;++ve){var be=d[v+2*ve+0],Pe=15&(ke=d[v+2*ve+1]),Ae=4369*Pe,ke=(240&ke|ke>>4)*Ae>>16;d[v+2*ve+0]=(240&be|be>>4)*Ae>>16&240|(15&be|be<<4)*Ae>>16>>4&15,d[v+2*ve+1]=240&ke|Pe}v+=me}}function Ne(d,v,N,ie,me,ve,be,Pe){var Ae,ke,Fe=255;for(ke=0;ke<me;++ke){for(Ae=0;Ae<ie;++Ae){var Je=d[v+Ae];ve[be+4*Ae]=Je,Fe&=Je}v+=N,be+=Pe}return Fe!=255}function Me(d,v,N,ie,me){var ve;for(ve=0;ve<me;++ve)N[ie+ve]=d[v+ve]>>8}function qe(){mo=A,dn=fe,hn=Ne,$n=Me}function it(d,v,N){$[d]=function(ie,me,ve,be,Pe,Ae,ke,Fe,Je,Qe,Ue,yt,rt,Oe,je,pt,St){var ft,Ut=St-1>>1,Ft=Pe[Ae+0]|ke[Fe+0]<<16,or=Je[Qe+0]|Ue[yt+0]<<16;e(ie!=null);var Bt=3*Ft+or+131074>>2;for(v(ie[me+0],255&Bt,Bt>>16,rt,Oe),ve!=null&&(Bt=3*or+Ft+131074>>2,v(ve[be+0],255&Bt,Bt>>16,je,pt)),ft=1;ft<=Ut;++ft){var Yr=Pe[Ae+ft]|ke[Fe+ft]<<16,en=Je[Qe+ft]|Ue[yt+ft]<<16,zr=Ft+Yr+or+en+524296,Mr=zr+2*(Yr+or)>>3;Bt=Mr+Ft>>1,Ft=(zr=zr+2*(Ft+en)>>3)+Yr>>1,v(ie[me+2*ft-1],255&Bt,Bt>>16,rt,Oe+(2*ft-1)*N),v(ie[me+2*ft-0],255&Ft,Ft>>16,rt,Oe+(2*ft-0)*N),ve!=null&&(Bt=zr+or>>1,Ft=Mr+en>>1,v(ve[be+2*ft-1],255&Bt,Bt>>16,je,pt+(2*ft-1)*N),v(ve[be+2*ft+0],255&Ft,Ft>>16,je,pt+(2*ft+0)*N)),Ft=Yr,or=en}1&St||(Bt=3*Ft+or+131074>>2,v(ie[me+St-1],255&Bt,Bt>>16,rt,Oe+(St-1)*N),ve!=null&&(Bt=3*or+Ft+131074>>2,v(ve[be+St-1],255&Bt,Bt>>16,je,pt+(St-1)*N)))}}function Pt(){go[ud]=F_,go[dd]=rg,go[Qy]=O_,go[hd]=ng,go[pd]=ig,go[Sp]=og,go[Xy]=B_,go[Pp]=rg,go[wp]=ng,go[fd]=ig,go[xp]=og}function Ot(d){return d&-16384?0>d?0:255:d>>j_}function p(d,v){return Ot((19077*d>>8)+(26149*v>>8)-14234)}function O(d,v,N){return Ot((19077*d>>8)-(6419*v>>8)-(13320*N>>8)+8708)}function ae(d,v){return Ot((19077*d>>8)+(33050*v>>8)-17685)}function Se(d,v,N,ie,me){ie[me+0]=p(d,N),ie[me+1]=O(d,v,N),ie[me+2]=ae(d,v)}function Ve(d,v,N,ie,me){ie[me+0]=ae(d,v),ie[me+1]=O(d,v,N),ie[me+2]=p(d,N)}function Ze(d,v,N,ie,me){var ve=O(d,v,N);v=ve<<3&224|ae(d,v)>>3,ie[me+0]=248&p(d,N)|ve>>5,ie[me+1]=v}function At(d,v,N,ie,me){var ve=240&ae(d,v)|15;ie[me+0]=240&p(d,N)|O(d,v,N)>>4,ie[me+1]=ve}function Sr(d,v,N,ie,me){ie[me+0]=255,Se(d,v,N,ie,me+1)}function Dr(d,v,N,ie,me){Ve(d,v,N,ie,me),ie[me+3]=255}function Pr(d,v,N,ie,me){Se(d,v,N,ie,me),ie[me+3]=255}function Xr(d,v){return 0>d?0:d>v?v:d}function sn(d,v,N){$[d]=function(ie,me,ve,be,Pe,Ae,ke,Fe,Je){for(var Qe=Fe+(-2&Je)*N;Fe!=Qe;)v(ie[me+0],ve[be+0],Pe[Ae+0],ke,Fe),v(ie[me+1],ve[be+0],Pe[Ae+0],ke,Fe+N),me+=2,++be,++Ae,Fe+=2*N;1&Je&&v(ie[me+0],ve[be+0],Pe[Ae+0],ke,Fe)}}function Co(d,v,N){return N==0?d==0?v==0?6:5:v==0?4:0:N}function si(d,v,N,ie,me){switch(d>>>30){case 3:Ss(v,N,ie,me,0);break;case 2:In(v,N,ie,me);break;case 1:Ri(v,N,ie,me)}}function Yo(d,v){var N,ie,me=v.M,ve=v.Nb,be=d.oc,Pe=d.pc+40,Ae=d.oc,ke=d.pc+584,Fe=d.oc,Je=d.pc+600;for(N=0;16>N;++N)be[Pe+32*N-1]=129;for(N=0;8>N;++N)Ae[ke+32*N-1]=129,Fe[Je+32*N-1]=129;for(0<me?be[Pe-1-32]=Ae[ke-1-32]=Fe[Je-1-32]=129:(i(be,Pe-32-1,127,21),i(Ae,ke-32-1,127,9),i(Fe,Je-32-1,127,9)),ie=0;ie<d.za;++ie){var Qe=v.ya[v.aa+ie];if(0<ie){for(N=-1;16>N;++N)n(be,Pe+32*N-4,be,Pe+32*N+12,4);for(N=-1;8>N;++N)n(Ae,ke+32*N-4,Ae,ke+32*N+4,4),n(Fe,Je+32*N-4,Fe,Je+32*N+4,4)}var Ue=d.Gd,yt=d.Hd+ie,rt=Qe.ad,Oe=Qe.Hc;if(0<me&&(n(be,Pe-32,Ue[yt].y,0,16),n(Ae,ke-32,Ue[yt].f,0,8),n(Fe,Je-32,Ue[yt].ea,0,8)),Qe.Za){var je=be,pt=Pe-32+16;for(0<me&&(ie>=d.za-1?i(je,pt,Ue[yt].y[15],4):n(je,pt,Ue[yt+1].y,0,4)),N=0;4>N;N++)je[pt+128+N]=je[pt+256+N]=je[pt+384+N]=je[pt+0+N];for(N=0;16>N;++N,Oe<<=2)je=be,pt=Pe+ag[N],Io[Qe.Ob[N]](je,pt),si(Oe,rt,16*+N,je,pt)}else if(je=Co(ie,me,Qe.Ob[0]),ia[je](be,Pe),Oe!=0)for(N=0;16>N;++N,Oe<<=2)si(Oe,rt,16*+N,be,Pe+ag[N]);for(N=Qe.Gc,je=Co(ie,me,Qe.Dd),ws[je](Ae,ke),ws[je](Fe,Je),Oe=rt,je=Ae,pt=ke,255&(Qe=N>>0)&&(170&Qe?Bc(Oe,256,je,pt):po(Oe,256,je,pt)),Qe=Fe,Oe=Je,255&(N>>=8)&&(170&N?Bc(rt,320,Qe,Oe):po(rt,320,Qe,Oe)),me<d.Ub-1&&(n(Ue[yt].y,0,be,Pe+480,16),n(Ue[yt].f,0,Ae,ke+224,8),n(Ue[yt].ea,0,Fe,Je+224,8)),N=8*ve*d.B,Ue=d.sa,yt=d.ta+16*ie+16*ve*d.R,rt=d.qa,Qe=d.ra+8*ie+N,Oe=d.Ha,je=d.Ia+8*ie+N,N=0;16>N;++N)n(Ue,yt+N*d.R,be,Pe+32*N,16);for(N=0;8>N;++N)n(rt,Qe+N*d.B,Ae,ke+32*N,8),n(Oe,je+N*d.B,Fe,Je+32*N,8)}}function Ko(d,v,N,ie,me,ve,be,Pe,Ae){var ke=[0],Fe=[0],Je=0,Qe=Ae!=null?Ae.kd:0,Ue=Ae??new Js;if(d==null||12>N)return 7;Ue.data=d,Ue.w=v,Ue.ha=N,v=[v],N=[N],Ue.gb=[Ue.gb];e:{var yt=v,rt=N,Oe=Ue.gb;if(e(d!=null),e(rt!=null),e(Oe!=null),Oe[0]=0,12<=rt[0]&&!r(d,yt[0],"RIFF")){if(r(d,yt[0]+8,"WEBP")){Oe=3;break e}var je=ee(d,yt[0]+4);if(12>je||4294967286<je){Oe=3;break e}if(Qe&&je>rt[0]-8){Oe=7;break e}Oe[0]=je,yt[0]+=12,rt[0]-=12}Oe=0}if(Oe!=0)return Oe;for(je=0<Ue.gb[0],N=N[0];;){e:{var pt=d;rt=v,Oe=N;var St=ke,ft=Fe,Ut=yt=[0];if((Bt=Je=[Je])[0]=0,8>Oe[0])Oe=7;else{if(!r(pt,rt[0],"VP8X")){if(ee(pt,rt[0]+4)!=10){Oe=3;break e}if(18>Oe[0]){Oe=7;break e}var Ft=ee(pt,rt[0]+8),or=1+ne(pt,rt[0]+12);if(2147483648<=or*(pt=1+ne(pt,rt[0]+15))){Oe=3;break e}Ut!=null&&(Ut[0]=Ft),St!=null&&(St[0]=or),ft!=null&&(ft[0]=pt),rt[0]+=18,Oe[0]-=18,Bt[0]=1}Oe=0}}if(Je=Je[0],yt=yt[0],Oe!=0)return Oe;if(rt=!!(2&yt),!je&&Je)return 3;if(ve!=null&&(ve[0]=!!(16&yt)),be!=null&&(be[0]=rt),Pe!=null&&(Pe[0]=0),be=ke[0],yt=Fe[0],Je&&rt&&Ae==null){Oe=0;break}if(4>N){Oe=7;break}if(je&&Je||!je&&!Je&&!r(d,v[0],"ALPH")){N=[N],Ue.na=[Ue.na],Ue.P=[Ue.P],Ue.Sa=[Ue.Sa];e:{Ft=d,Oe=v,je=N;var Bt=Ue.gb;St=Ue.na,ft=Ue.P,Ut=Ue.Sa,or=22,e(Ft!=null),e(je!=null),pt=Oe[0];var Yr=je[0];for(e(St!=null),e(Ut!=null),St[0]=null,ft[0]=null,Ut[0]=0;;){if(Oe[0]=pt,je[0]=Yr,8>Yr){Oe=7;break e}var en=ee(Ft,pt+4);if(4294967286<en){Oe=3;break e}var zr=8+en+1&-2;if(or+=zr,0<Bt&&or>Bt){Oe=3;break e}if(!r(Ft,pt,"VP8 ")||!r(Ft,pt,"VP8L")){Oe=0;break e}if(Yr[0]<zr){Oe=7;break e}r(Ft,pt,"ALPH")||(St[0]=Ft,ft[0]=pt+8,Ut[0]=en),pt+=zr,Yr-=zr}}if(N=N[0],Ue.na=Ue.na[0],Ue.P=Ue.P[0],Ue.Sa=Ue.Sa[0],Oe!=0)break}N=[N],Ue.Ja=[Ue.Ja],Ue.xa=[Ue.xa];e:if(Bt=d,Oe=v,je=N,St=Ue.gb[0],ft=Ue.Ja,Ut=Ue.xa,Ft=Oe[0],pt=!r(Bt,Ft,"VP8 "),or=!r(Bt,Ft,"VP8L"),e(Bt!=null),e(je!=null),e(ft!=null),e(Ut!=null),8>je[0])Oe=7;else{if(pt||or){if(Bt=ee(Bt,Ft+4),12<=St&&Bt>St-12){Oe=3;break e}if(Qe&&Bt>je[0]-8){Oe=7;break e}ft[0]=Bt,Oe[0]+=8,je[0]-=8,Ut[0]=or}else Ut[0]=5<=je[0]&&Bt[Ft+0]==47&&!(Bt[Ft+4]>>5),ft[0]=je[0];Oe=0}if(N=N[0],Ue.Ja=Ue.Ja[0],Ue.xa=Ue.xa[0],v=v[0],Oe!=0)break;if(4294967286<Ue.Ja)return 3;if(Pe==null||rt||(Pe[0]=Ue.xa?2:1),be=[be],yt=[yt],Ue.xa){if(5>N){Oe=7;break}Pe=be,Qe=yt,rt=ve,d==null||5>N?d=0:5<=N&&d[v+0]==47&&!(d[v+4]>>5)?(je=[0],Bt=[0],St=[0],W(ft=new L,d,v,N),tt(ft,je,Bt,St)?(Pe!=null&&(Pe[0]=je[0]),Qe!=null&&(Qe[0]=Bt[0]),rt!=null&&(rt[0]=St[0]),d=1):d=0):d=0}else{if(10>N){Oe=7;break}Pe=yt,d==null||10>N||!Un(d,v+3,N-3)?d=0:(Qe=d[v+0]|d[v+1]<<8|d[v+2]<<16,rt=16383&(d[v+7]<<8|d[v+6]),d=16383&(d[v+9]<<8|d[v+8]),1&Qe||3<(Qe>>1&7)||!(Qe>>4&1)||Qe>>5>=Ue.Ja||!rt||!d?d=0:(be&&(be[0]=rt),Pe&&(Pe[0]=d),d=1))}if(!d||(be=be[0],yt=yt[0],Je&&(ke[0]!=be||Fe[0]!=yt)))return 3;Ae!=null&&(Ae[0]=Ue,Ae.offset=v-Ae.w,e(4294967286>v-Ae.w),e(Ae.offset==Ae.ha-N));break}return Oe==0||Oe==7&&Je&&Ae==null?(ve!=null&&(ve[0]|=Ue.na!=null&&0<Ue.na.length),ie!=null&&(ie[0]=be),me!=null&&(me[0]=yt),0):Oe}function Dc(d,v,N){var ie=v.width,me=v.height,ve=0,be=0,Pe=ie,Ae=me;if(v.Da=d!=null&&0<d.Da,v.Da&&(Pe=d.cd,Ae=d.bd,ve=d.v,be=d.j,11>N||(ve&=-2,be&=-2),0>ve||0>be||0>=Pe||0>=Ae||ve+Pe>ie||be+Ae>me))return 0;if(v.v=ve,v.j=be,v.va=ve+Pe,v.o=be+Ae,v.U=Pe,v.T=Ae,v.da=d!=null&&0<d.da,v.da){if(!ue(Pe,Ae,N=[d.ib],ve=[d.hb]))return 0;v.ib=N[0],v.hb=ve[0]}return v.ob=d!=null&&d.ob,v.Kb=d==null||!d.Sd,v.da&&(v.ob=v.ib<3*ie/4&&v.hb<3*me/4,v.Kb=0),1}function Mc(d){if(d==null)return 2;if(11>d.S){var v=d.f.RGBA;v.fb+=(d.height-1)*v.A,v.A=-v.A}else v=d.f.kb,d=d.height,v.O+=(d-1)*v.fa,v.fa=-v.fa,v.N+=(d-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(d-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(d-1)*v.lb,v.lb=-v.lb);return 0}function Bl(d,v,N,ie){if(ie==null||0>=d||0>=v)return 2;if(N!=null){if(N.Da){var me=N.cd,ve=N.bd,be=-2&N.v,Pe=-2&N.j;if(0>be||0>Pe||0>=me||0>=ve||be+me>d||Pe+ve>v)return 2;d=me,v=ve}if(N.da){if(!ue(d,v,me=[N.ib],ve=[N.hb]))return 2;d=me[0],v=ve[0]}}ie.width=d,ie.height=v;e:{var Ae=ie.width,ke=ie.height;if(d=ie.S,0>=Ae||0>=ke||!(d>=ud&&13>d))d=2;else{if(0>=ie.Rd&&ie.sd==null){be=ve=me=v=0;var Fe=(Pe=Ae*lg[d])*ke;if(11>d||(ve=(ke+1)/2*(v=(Ae+1)/2),d==12&&(be=(me=Ae)*ke)),(ke=o(Fe+2*ve+be))==null){d=1;break e}ie.sd=ke,11>d?((Ae=ie.f.RGBA).eb=ke,Ae.fb=0,Ae.A=Pe,Ae.size=Fe):((Ae=ie.f.kb).y=ke,Ae.O=0,Ae.fa=Pe,Ae.Fd=Fe,Ae.f=ke,Ae.N=0+Fe,Ae.Ab=v,Ae.Cd=ve,Ae.ea=ke,Ae.W=0+Fe+ve,Ae.Db=v,Ae.Ed=ve,d==12&&(Ae.F=ke,Ae.J=0+Fe+2*ve),Ae.Tc=be,Ae.lb=me)}if(v=1,me=ie.S,ve=ie.width,be=ie.height,me>=ud&&13>me)if(11>me)d=ie.f.RGBA,v&=(Pe=Math.abs(d.A))*(be-1)+ve<=d.size,v&=Pe>=ve*lg[me],v&=d.eb!=null;else{d=ie.f.kb,Pe=(ve+1)/2,Fe=(be+1)/2,Ae=Math.abs(d.fa),ke=Math.abs(d.Ab);var Je=Math.abs(d.Db),Qe=Math.abs(d.lb),Ue=Qe*(be-1)+ve;v&=Ae*(be-1)+ve<=d.Fd,v&=ke*(Fe-1)+Pe<=d.Cd,v=(v&=Je*(Fe-1)+Pe<=d.Ed)&Ae>=ve&ke>=Pe&Je>=Pe,v&=d.y!=null,v&=d.f!=null,v&=d.ea!=null,me==12&&(v&=Qe>=ve,v&=Ue<=d.Tc,v&=d.F!=null)}else v=0;d=v?0:2}}return d!=0||N!=null&&N.fd&&(d=Mc(ie)),d}var ai=64,jl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Vl=24,ql=32,Fc=8,Vi=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ge("Predictor0","PredictorAdd0"),$.Predictor0=function(){return 4278190080},$.Predictor1=function(d){return d},$.Predictor2=function(d,v,N){return v[N+0]},$.Predictor3=function(d,v,N){return v[N+1]},$.Predictor4=function(d,v,N){return v[N-1]},$.Predictor5=function(d,v,N){return pe(pe(d,v[N+1]),v[N+0])},$.Predictor6=function(d,v,N){return pe(d,v[N-1])},$.Predictor7=function(d,v,N){return pe(d,v[N+0])},$.Predictor8=function(d,v,N){return pe(v[N-1],v[N+0])},$.Predictor9=function(d,v,N){return pe(v[N+0],v[N+1])},$.Predictor10=function(d,v,N){return pe(pe(d,v[N-1]),pe(v[N+0],v[N+1]))},$.Predictor11=function(d,v,N){var ie=v[N+0];return 0>=Ee(ie>>24&255,d>>24&255,(v=v[N-1])>>24&255)+Ee(ie>>16&255,d>>16&255,v>>16&255)+Ee(ie>>8&255,d>>8&255,v>>8&255)+Ee(255&ie,255&d,255&v)?ie:d},$.Predictor12=function(d,v,N){var ie=v[N+0];return(_e((d>>24&255)+(ie>>24&255)-((v=v[N-1])>>24&255))<<24|_e((d>>16&255)+(ie>>16&255)-(v>>16&255))<<16|_e((d>>8&255)+(ie>>8&255)-(v>>8&255))<<8|_e((255&d)+(255&ie)-(255&v)))>>>0},$.Predictor13=function(d,v,N){var ie=v[N-1];return(Re((d=pe(d,v[N+0]))>>24&255,ie>>24&255)<<24|Re(d>>16&255,ie>>16&255)<<16|Re(d>>8&255,ie>>8&255)<<8|Re(d>>0&255,ie>>0&255))>>>0};var bp=$.PredictorAdd0;$.PredictorAdd1=Te,ge("Predictor2","PredictorAdd2"),ge("Predictor3","PredictorAdd3"),ge("Predictor4","PredictorAdd4"),ge("Predictor5","PredictorAdd5"),ge("Predictor6","PredictorAdd6"),ge("Predictor7","PredictorAdd7"),ge("Predictor8","PredictorAdd8"),ge("Predictor9","PredictorAdd9"),ge("Predictor10","PredictorAdd10"),ge("Predictor11","PredictorAdd11"),ge("Predictor12","PredictorAdd12"),ge("Predictor13","PredictorAdd13");var Oc=$.PredictorAdd2;Ye("ColorIndexInverseTransform","MapARGB","32b",function(d){return d>>8&255},function(d){return d}),Ye("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(d){return d},function(d){return d>>8&255});var id,ho=$.ColorIndexInverseTransform,zl=$.MapARGB,od=$.VP8LColorIndexInverseTransformAlpha,sd=$.MapAlpha,ea=$.VP8LPredictorsAdd=[];ea.length=16,($.VP8LPredictors=[]).length=16,($.VP8LPredictorsAdd_C=[]).length=16,($.VP8LPredictors_C=[]).length=16;var Qa,qi,Li,ta,bs,_s,Ul,Ss,In,Bc,Ri,po,Hl,ad,jc,Xa,Za,ra,el,Gl,tl,na,Vc,fo,mo,dn,hn,$n,Gn=o(511),Ps=o(2041),qc=o(225),Wl=o(767),ld=0,_p=Ps,cd=qc,ro=Wl,yo=Gn,ud=0,dd=1,Qy=2,hd=3,pd=4,Sp=5,Xy=6,Pp=7,wp=8,fd=9,xp=10,w_=[2,3,7],x_=[3,3,11],Zy=[280,256,256,256,40],A_=[0,1,1,1,0],C_=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],I_=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],$_=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],E_=8,Ap=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Cp=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],zc=null,T_=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],k_=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],eg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],N_=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],L_=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],R_=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],D_=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ia=[],Io=[],ws=[],M_=1,tg=2,oa=[],go=[];it("UpsampleRgbLinePair",Se,3),it("UpsampleBgrLinePair",Ve,3),it("UpsampleRgbaLinePair",Pr,4),it("UpsampleBgraLinePair",Dr,4),it("UpsampleArgbLinePair",Sr,4),it("UpsampleRgba4444LinePair",At,2),it("UpsampleRgb565LinePair",Ze,2);var F_=$.UpsampleRgbLinePair,O_=$.UpsampleBgrLinePair,rg=$.UpsampleRgbaLinePair,ng=$.UpsampleBgraLinePair,ig=$.UpsampleArgbLinePair,og=$.UpsampleRgba4444LinePair,B_=$.UpsampleRgb565LinePair,md=16,yd=1<<md-1,Uc=-227,Ip=482,j_=6,sg=0,V_=o(256),q_=o(256),z_=o(256),U_=o(256),H_=o(Ip-Uc),G_=o(Ip-Uc);sn("YuvToRgbRow",Se,3),sn("YuvToBgrRow",Ve,3),sn("YuvToRgbaRow",Pr,4),sn("YuvToBgraRow",Dr,4),sn("YuvToArgbRow",Sr,4),sn("YuvToRgba4444Row",At,2),sn("YuvToRgb565Row",Ze,2);var ag=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],gd=[0,2,8],W_=[8,7,6,4,4,2,2,2,1,1,1,1],Y_=1;this.WebPDecodeRGBA=function(d,v,N,ie,me){var ve=dd,be=new gs,Pe=new Xe;be.ba=Pe,Pe.S=ve,Pe.width=[Pe.width],Pe.height=[Pe.height];var Ae=Pe.width,ke=Pe.height,Fe=new kt;if(Fe==null||d==null)var Je=2;else e(Fe!=null),Je=Ko(d,v,N,Fe.width,Fe.height,Fe.Pd,Fe.Qd,Fe.format,null);if(Je!=0?Ae=0:(Ae!=null&&(Ae[0]=Fe.width[0]),ke!=null&&(ke[0]=Fe.height[0]),Ae=1),Ae){Pe.width=Pe.width[0],Pe.height=Pe.height[0],ie!=null&&(ie[0]=Pe.width),me!=null&&(me[0]=Pe.height);e:{if(ie=new bn,(me=new Js).data=d,me.w=v,me.ha=N,me.kd=1,v=[0],e(me!=null),((d=Ko(me.data,me.w,me.ha,null,null,null,v,null,me))==0||d==7)&&v[0]&&(d=4),(v=d)==0){if(e(be!=null),ie.data=me.data,ie.w=me.w+me.offset,ie.ha=me.ha-me.offset,ie.put=Ct,ie.ac=ze,ie.bc=xt,ie.ma=be,me.xa){if((d=Kt())==null){be=1;break e}if(function(Qe,Ue){var yt=[0],rt=[0],Oe=[0];t:for(;;){if(Qe==null)return 0;if(Ue==null)return Qe.a=2,0;if(Qe.l=Ue,Qe.a=0,W(Qe.m,Ue.data,Ue.w,Ue.ha),!tt(Qe.m,yt,rt,Oe)){Qe.a=3;break t}if(Qe.xb=tg,Ue.width=yt[0],Ue.height=rt[0],!ir(yt[0],rt[0],1,Qe,null))break t;return 1}return e(Qe.a!=0),0}(d,ie)){if(ie=(v=Bl(ie.width,ie.height,be.Oa,be.ba))==0){t:{ie=d;r:for(;;){if(ie==null){ie=0;break t}if(e(ie.s.yc!=null),e(ie.s.Ya!=null),e(0<ie.s.Wb),e((N=ie.l)!=null),e((me=N.ma)!=null),ie.xb!=0){if(ie.ca=me.ba,ie.tb=me.tb,e(ie.ca!=null),!Dc(me.Oa,N,hd)){ie.a=2;break r}if(!vr(ie,N.width)||N.da)break r;if((N.da||ut(ie.ca.S))&&qe(),11>ie.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ie.ca.f.kb.F!=null&&qe()),ie.Pb&&0<ie.s.ua&&ie.s.vb.X==null&&!ce(ie.s.vb,ie.s.Wa.Xa)){ie.a=1;break r}ie.xb=0}if(!Xt(ie,ie.V,ie.Ba,ie.c,ie.i,N.o,$t))break r;me.Dc=ie.Ma,ie=1;break t}e(ie.a!=0),ie=0}ie=!ie}ie&&(v=d.a)}else v=d.a}else{if((d=new gn)==null){be=1;break e}if(d.Fa=me.na,d.P=me.P,d.qc=me.Sa,ei(d,ie)){if((v=Bl(ie.width,ie.height,be.Oa,be.ba))==0){if(d.Aa=0,N=be.Oa,e((me=d)!=null),N!=null){if(0<(Ae=0>(Ae=N.Md)?0:100<Ae?255:255*Ae/100)){for(ke=Fe=0;4>ke;++ke)12>(Je=me.pb[ke]).lc&&(Je.ia=Ae*W_[0>Je.lc?0:Je.lc]>>3),Fe|=Je.ia;Fe&&(alert("todo:VP8InitRandom"),me.ia=1)}me.Ga=N.Id,100<me.Ga?me.Ga=100:0>me.Ga&&(me.Ga=0)}Nr(d,ie)||(v=d.a)}}else v=d.a}v==0&&be.Oa!=null&&be.Oa.fd&&(v=Mc(be.ba))}be=v}ve=be!=0?null:11>ve?Pe.f.RGBA.eb:Pe.f.kb.y}else ve=null;return ve};var lg=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u($,T){for(var B="",_=0;_<4;_++)B+=String.fromCharCode($[T++]);return B}function h($,T){return($[T+0]<<0|$[T+1]<<8|$[T+2]<<16)>>>0}function m($,T){return($[T+0]<<0|$[T+1]<<8|$[T+2]<<16|$[T+3]<<24)>>>0}new c;var g=[0],f=[0],w=[],x=new c,S=t,C=function($,T){var B={},_=0,P=!1,b=0,H=0;if(B.frames=[],!function(M,G,I,F){for(var X=0;X<F;X++)if(M[G+X]!=I.charCodeAt(X))return!0;return!1}($,T,"RIFF",4)){for(m($,T+=4),T+=8;T<$.length;){var K=u($,T),R=m($,T+=4);T+=4;var k=R+(1&R);switch(K){case"VP8 ":case"VP8L":B.frames[_]===void 0&&(B.frames[_]={}),(U=B.frames[_]).src_off=P?H:T-8,U.src_size=b+R+8,_++,P&&(P=!1,b=0,H=0);break;case"VP8X":(U=B.header={}).feature_flags=$[T];var W=T+4;U.canvas_width=1+h($,W),W+=3,U.canvas_height=1+h($,W),W+=3;break;case"ALPH":P=!0,b=k+8,H=T-8;break;case"ANIM":(U=B.header).bgcolor=m($,T),W=T+4,U.loop_count=(le=$)[(L=W)+0]<<0|le[L+1]<<8,W+=2;break;case"ANMF":var z,U;(U=B.frames[_]={}).offset_x=2*h($,T),T+=3,U.offset_y=2*h($,T),T+=3,U.width=1+h($,T),T+=3,U.height=1+h($,T),T+=3,U.duration=h($,T),T+=3,z=$[T++],U.dispose=1&z,U.blend=z>>1&1}K!="ANMF"&&(T+=k)}var le,L;return B}}(S,0);C.response=S,C.rgbaoutput=!0,C.dataurl=!1;var j=C.header?C.header:null,oe=C.frames?C.frames:null;if(j){j.loop_counter=j.loop_count,g=[j.canvas_height],f=[j.canvas_width];for(var te=0;te<oe.length&&oe[te].blend!=0;te++);}var Z=oe[0],re=x.WebPDecodeRGBA(S,Z.src_off,Z.src_size,f,g);Z.rgba=re,Z.imgwidth=f[0],Z.imgheight=g[0];for(var E=0;E<f[0]*g[0]*4;E++)w[E]=re[E];return this.width=f,this.height=g,this.data=w,this}(function(t){var e=function(){return typeof Cm=="function"},r=function(g,f,w,x){var S=4,C=s;switch(x){case t.image_compression.FAST:S=1,C=o;break;case t.image_compression.MEDIUM:S=6,C=l;break;case t.image_compression.SLOW:S=9,C=c}g=n(g,f,w,C);var j=Cm(g,{level:S});return t.__addimage__.arrayBufferToBinaryString(j)},n=function(g,f,w,x){for(var S,C,j,oe=g.length/f,te=new Uint8Array(g.length+oe),Z=h(),re=0;re<oe;re+=1){if(j=re*f,S=g.subarray(j,j+f),x)te.set(x(S,w,C),j+re);else{for(var E,$=Z.length,T=[];E<$;E+=1)T[E]=Z[E](S,w,C);var B=m(T.concat());te.set(T[B],j+re)}C=S}return te},i=function(g){var f=Array.apply([],g);return f.unshift(0),f},o=function(g,f){var w,x=[],S=g.length;x[0]=1;for(var C=0;C<S;C+=1)w=g[C-f]||0,x[C+1]=g[C]-w+256&255;return x},s=function(g,f,w){var x,S=[],C=g.length;S[0]=2;for(var j=0;j<C;j+=1)x=w&&w[j]||0,S[j+1]=g[j]-x+256&255;return S},l=function(g,f,w){var x,S,C=[],j=g.length;C[0]=3;for(var oe=0;oe<j;oe+=1)x=g[oe-f]||0,S=w&&w[oe]||0,C[oe+1]=g[oe]+256-(x+S>>>1)&255;return C},c=function(g,f,w){var x,S,C,j,oe=[],te=g.length;oe[0]=4;for(var Z=0;Z<te;Z+=1)x=g[Z-f]||0,S=w&&w[Z]||0,C=w&&w[Z-f]||0,j=u(x,S,C),oe[Z+1]=g[Z]-j+256&255;return oe},u=function(g,f,w){if(g===f&&f===w)return g;var x=Math.abs(f-w),S=Math.abs(g-w),C=Math.abs(g+f-w-w);return x<=S&&x<=C?g:S<=C?f:w},h=function(){return[i,o,s,l,c]},m=function(g){var f=g.map(function(w){return w.reduce(function(x,S){return x+Math.abs(S)},0)});return f.indexOf(Math.min.apply(null,f))};t.processPNG=function(g,f,w,x){var S,C,j,oe,te,Z,re,E,$,T,B,_,P,b,H,K=this.decode.FLATE_DECODE,R="";if(this.__addimage__.isArrayBuffer(g)&&(g=new Uint8Array(g)),this.__addimage__.isArrayBufferView(g)){if(g=(j=new ZL(g)).imgData,C=j.bits,S=j.colorSpace,te=j.colors,[4,6].indexOf(j.colorType)!==-1){if(j.bits===8){$=(E=j.pixelBitlength==32?new Uint32Array(j.decodePixels().buffer):j.pixelBitlength==16?new Uint16Array(j.decodePixels().buffer):new Uint8Array(j.decodePixels().buffer)).length,B=new Uint8Array($*j.colors),T=new Uint8Array($);var k,W=j.pixelBitlength-j.bits;for(b=0,H=0;b<$;b++){for(P=E[b],k=0;k<W;)B[H++]=P>>>k&255,k+=j.bits;T[b]=P>>>k&255}}if(j.bits===16){$=(E=new Uint32Array(j.decodePixels().buffer)).length,B=new Uint8Array($*(32/j.pixelBitlength)*j.colors),T=new Uint8Array($*(32/j.pixelBitlength)),_=j.colors>1,b=0,H=0;for(var z=0;b<$;)P=E[b++],B[H++]=P>>>0&255,_&&(B[H++]=P>>>16&255,P=E[b++],B[H++]=P>>>0&255),T[z++]=P>>>16&255;C=8}x!==t.image_compression.NONE&&e()?(g=r(B,j.width*j.colors,j.colors,x),re=r(T,j.width,1,x)):(g=B,re=T,K=void 0)}if(j.colorType===3&&(S=this.color_spaces.INDEXED,Z=j.palette,j.transparency.indexed)){var U=j.transparency.indexed,le=0;for(b=0,$=U.length;b<$;++b)le+=U[b];if((le/=255)===$-1&&U.indexOf(0)!==-1)oe=[U.indexOf(0)];else if(le!==$){for(E=j.decodePixels(),T=new Uint8Array(E.length),b=0,$=E.length;b<$;b++)T[b]=U[E[b]];re=r(T,j.width,1)}}var L=function(M){var G;switch(M){case t.image_compression.FAST:G=11;break;case t.image_compression.MEDIUM:G=13;break;case t.image_compression.SLOW:G=14;break;default:G=12}return G}(x);return K===this.decode.FLATE_DECODE&&(R="/Predictor "+L+" "),R+="/Colors "+te+" /BitsPerComponent "+C+" /Columns "+j.width,(this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),(re&&this.__addimage__.isArrayBuffer(re)||this.__addimage__.isArrayBufferView(re))&&(re=this.__addimage__.arrayBufferToBinaryString(re)),{alias:w,data:g,index:f,filter:K,decodeParameters:R,transparency:oe,palette:Z,sMask:re,predictor:L,width:j.width,height:j.height,bitsPerComponent:C,colorSpace:S}}}})(sr.API),function(t){t.processGIF89A=function(e,r,n,i){var o=new eR(e),s=o.width,l=o.height,c=[];o.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:s,height:l},h=new $f(100).encode(u,100);return t.processJPEG.call(this,h,r,n,i)},t.processGIF87A=t.processGIF89A}(sr.API),ko.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ko.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){ln.log("bit decode error:"+r)}},ko.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[o>>7-l&1];this.data[s+4*l]=c.blue,this.data[s+4*l+1]=c.green,this.data[s+4*l+2]=c.red,this.data[s+4*l+3]=255}r!==0&&(this.pos+=4-r)}},ko.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,l=o>>4,c=15&o,u=this.palette[l];if(this.data[s]=u.blue,this.data[s+1]=u.green,this.data[s+2]=u.red,this.data[s+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[s+4]=u.blue,this.data[s+4+1]=u.green,this.data[s+4+2]=u.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},ko.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[o]=s.red,this.data[o+1]=s.green,this.data[o+2]=s.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}t!==0&&(this.pos+=4-t)}},ko.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&e)/e*255|0,l=(o>>5&e)/e*255|0,c=(o>>10&e)/e*255|0,u=o>>15?255:0,h=n*this.width*4+4*i;this.data[h]=c,this.data[h+1]=l,this.data[h+2]=s,this.data[h+3]=u}this.pos+=t}},ko.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&e)/e*255|0,c=(s>>5&r)/r*255|0,u=(s>>11)/e*255|0,h=i*this.width*4+4*o;this.data[h]=u,this.data[h+1]=c,this.data[h+2]=l,this.data[h+3]=255}this.pos+=t}},ko.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*r;this.data[s]=o,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},ko.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=o,this.data[l+1]=i,this.data[l+2]=n,this.data[l+3]=s}},ko.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,i){var o=new ko(e,!1),s=o.width,l=o.height,c={data:o.getData(),width:s,height:l},u=new $f(100).encode(c,100);return t.processJPEG.call(this,u,r,n,i)}}(sr.API),rb.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,i){var o=new rb(e),s=o.width,l=o.height,c={data:o.getData(),width:s,height:l},u=new $f(100).encode(c,100);return t.processJPEG.call(this,u,r,n,i)}}(sr.API),sr.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,o=new Uint8Array(i/4*3),s=new Uint8Array(i/4),l=0,c=0,u=0;u<i;u+=4){var h=n[u],m=n[u+1],g=n[u+2],f=n[u+3];o[l++]=h,o[l++]=m,o[l++]=g,s[c++]=f}var w=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:w,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},sr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},nc=sr.API,Kd=nc.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:i.metadata.Unicode.kerning,h=u.fof?u.fof:1,m=e.doKerning!==!1,g=0,f=t.length,w=0,x=l[0]||c,S=[];for(r=0;r<f;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?S.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/o)||0)/1e3):(g=m&&rn(u[n])==="object"&&!isNaN(parseInt(u[n][w],10))?u[n][w]/h:0,S.push((l[n]||x)/c+g)),w=n;return S},X0=nc.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return nc.processArabic&&(t=nc.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:Kd.apply(this,arguments).reduce(function(o,s){return o+s},0)},Z0=function(t,e,r,n){for(var i=[],o=0,s=t.length,l=0;o!==s&&l+e[o]<r;)l+=e[o],o++;i.push(t.slice(0,o));var c=o;for(l=0;o!==s;)l+e[o]>n&&(i.push(t.slice(c,o)),l=0,c=o),l+=e[o],o++;return c!==o&&i.push(t.slice(c,o)),i},eb=function(t,e,r){r||(r={});var n,i,o,s,l,c,u,h=[],m=[h],g=r.textIndent||0,f=0,w=0,x=t.split(" "),S=Kd.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?x[0].length+2:r.lineIndent||0){var C=Array(c).join(" "),j=[];x.map(function(te){(te=te.split(/\s*\n/)).length>1?j=j.concat(te.map(function(Z,re){return(re&&Z.length?`
`:"")+Z})):j.push(te[0])}),x=j,c=X0.apply(this,[C,r])}for(o=0,s=x.length;o<s;o++){var oe=0;if(n=x[o],c&&n[0]==`
`&&(n=n.substr(1),oe=1),g+f+(w=(i=Kd.apply(this,[n,r])).reduce(function(te,Z){return te+Z},0))>e||oe){if(w>e){for(l=Z0.apply(this,[n,i,e-(g+f),e]),h.push(l.shift()),h=[l.pop()];l.length;)m.push([l.shift()]);w=i.slice(n.length-(h[0]?h[0].length:0)).reduce(function(te,Z){return te+Z},0)}else h=[n];m.push(h),g=w+c,f=S}else h.push(n),g+=f+w,f=S}return u=c?function(te,Z){return(Z?C:"")+te.join(" ")}:function(te){return te.join(" ")},m.map(u)},nc.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),o=function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var m=this.internal.getFont(h.fontName,h.fontStyle);return m.metadata.Unicode?{widths:m.metadata.Unicode.widths||{0:1},kerning:m.metadata.Unicode.kerning||{}}:{font:m.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;o.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,o.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(eb.apply(this,[n[l],s,o]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},n={},i=0;i<e.length;i++)r[e[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=e[i];var o=function(m){return"0x"+parseInt(m,10).toString(16)},s=t.__fontmetrics__.compress=function(m){var g,f,w,x,S=["{"];for(var C in m){if(g=m[C],isNaN(parseInt(C,10))?f="'"+C+"'":(C=parseInt(C,10),f=(f=o(C).slice(2)).slice(0,-1)+n[f.slice(-1)]),typeof g=="number")g<0?(w=o(g).slice(3),x="-"):(w=o(g).slice(2),x=""),w=x+w.slice(0,-1)+n[w.slice(-1)];else{if(rn(g)!=="object")throw new Error("Don't know what to do with value type "+rn(g)+".");w=s(g)}S.push(f+w)}return S.push("}"),S.join("")},l=t.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,f,w,x,S={},C=1,j=S,oe=[],te="",Z="",re=m.length-1,E=1;E<re;E+=1)(x=m[E])=="'"?g?(w=g.join(""),g=void 0):g=[]:g?g.push(x):x=="{"?(oe.push([j,w]),j={},w=void 0):x=="}"?((f=oe.pop())[0][f[1]]=j,w=void 0,j=f[0]):x=="-"?C=-1:w===void 0?r.hasOwnProperty(x)?(te+=r[x],w=parseInt(te,16)*C,C=1,te=""):te+=x:r.hasOwnProperty(x)?(Z+=r[x],j[w]=parseInt(Z,16)*C,C=1,w=void 0,Z=""):Z+=x;return S},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(m){var g=m.font,f=h.Unicode[g.postScriptName];f&&(g.metadata.Unicode={},g.metadata.Unicode.widths=f.widths,g.metadata.Unicode.kerning=f.kerning);var w=u.Unicode[g.postScriptName];w&&(g.metadata.Unicode.encoding=w,g.encoding=w.codePages[0])}])}(sr.API),function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),o=0;o<n;o++)i[o]=r.charCodeAt(o);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,o=r.instance;if(!i.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=o.existsFileInVFS(i.postScriptName)===!1?o.loadFile(i.postScriptName):o.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(_u(l)),s.metadata=t.API.TTFFont.open(l),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])}(sr),function(t){function e(){return(dr.canvg?Promise.resolve(dr.canvg):Ji(()=>import("./index.es-DJl4I-8T.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}sr.API.addSvgAsImage=function(r,n,i,o,s,l,c,u){if(isNaN(n)||isNaN(i))throw ln.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(s))throw ln.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=o,h.height=s;var m=h.getContext("2d");m.fillStyle="#fff",m.fillRect(0,0,h.width,h.height);var g={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return e().then(function(w){return w.fromString(m,r,g)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(w){return w.render(g)}).then(function(){f.addImage(h.toDataURL("image/jpeg",1),n,i,o,s,c,u)})}}(),sr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},sr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(s),c=[],u=0,h=0,m=0;function g(w,x){var S,C=!1;for(S=0;S<w.length;S+=1)w[S]===x&&(C=!0);return C}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var f=l.length;for(m=0;m<f;m+=1)r[l[m]].value=r[l[m]].defaultValue,r[l[m]].explicitSet=!1}if(rn(t)==="object"){for(i in t)if(o=t[i],g(l,i)&&o!==void 0){if(r[i].type==="boolean"&&typeof o=="boolean")r[i].value=o;else if(r[i].type==="name"&&g(r[i].valueSet,o))r[i].value=o;else if(r[i].type==="integer"&&Number.isInteger(o))r[i].value=o;else if(r[i].type==="array"){for(u=0;u<o.length;u+=1)if(n=!0,o[u].length===1&&typeof o[u][0]=="number")c.push(String(o[u]-1));else if(o[u].length>1){for(h=0;h<o[u].length;h+=1)typeof o[u][h]!="number"&&(n=!1);n===!0&&c.push([o[u][0]-1,o[u][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var w,x=[];for(w in r)r[w].explicitSet===!0&&(r[w].type==="name"?x.push("/"+w+" /"+r[w].value):x.push("/"+w+" "+r[w].value));x.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+x.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=o.length+s.length+l.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+o+s+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(sr.API),function(t){var e=t.API,r=e.pdfEscape16=function(o,s){for(var l,c=s.metadata.Unicode.widths,u=["","0","00","000","0000"],h=[""],m=0,g=o.length;m<g;++m){if(l=s.metadata.characterToGlyph(o.charCodeAt(m)),s.metadata.glyIdsUsed.push(l),s.metadata.toUnicode[l]=o.charCodeAt(m),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(s.metadata.widthOfGlyph(l),10)])),l=="0")return h.join("");l=l.toString(16),h.push(u[4-l.length],l)}return h.join("")},n=function(o){var s,l,c,u,h,m,g;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],m=0,g=(l=Object.keys(o).sort(function(f,w){return f-w})).length;m<g;m++)s=l[m],c.length>=100&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),o[s]!==void 0&&o[s]!==null&&typeof o[s].toString=="function"&&(u=("0000"+o[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+u+">"));return c.length&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),h+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(s){var l=s.font,c=s.out,u=s.newObject,h=s.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var m=l.metadata.Unicode.widths,g=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),f="",w=0;w<g.length;w++)f+=String.fromCharCode(g[w]);var x=u();h({data:f,addLength1:!0,objectId:x}),c("endobj");var S=u();h({data:n(l.metadata.toUnicode),addLength1:!0,objectId:S}),c("endobj");var C=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+dc(l.fontName)),c("/FontFile2 "+x+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var j=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+dc(l.fontName)),c("/FontDescriptor "+C+" 0 R"),c("/W "+t.API.PDFObject.convert(m)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+S+" 0 R"),c("/BaseFont /"+dc(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+j+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(s){var l=s.font,c=s.out,u=s.newObject,h=s.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var m=l.metadata.rawData,g="",f=0;f<m.length;f++)g+=String.fromCharCode(m[f]);var w=u();h({data:g,addLength1:!0,objectId:w}),c("endobj");var x=u();h({data:n(l.metadata.toUnicode),addLength1:!0,objectId:x}),c("endobj");var S=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+w+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+dc(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var C=0;C<l.metadata.hmtx.widths.length;C++)l.metadata.hmtx.widths[C]=parseInt(l.metadata.hmtx.widths[C]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+x+" 0 R/BaseFont/"+dc(l.fontName)+"/FontDescriptor "+S+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(o)}]);var i=function(o){var s,l=o.text||"",c=o.x,u=o.y,h=o.options||{},m=o.mutex||{},g=m.pdfEscape,f=m.activeFontKey,w=m.fonts,x=f,S="",C=0,j="",oe=w[x].encoding;if(w[x].encoding!=="Identity-H")return{text:l,x:c,y:u,options:h,mutex:m};for(j=l,x=f,Array.isArray(l)&&(j=l[0]),C=0;C<j.length;C+=1)w[x].metadata.hasOwnProperty("cmap")&&(s=w[x].metadata.cmap.unicode.codeMap[j[C].charCodeAt(0)]),s||j[C].charCodeAt(0)<256&&w[x].metadata.hasOwnProperty("Unicode")?S+=j[C]:S+="";var te="";return parseInt(x.slice(1))<14||oe==="WinAnsiEncoding"?te=g(S,x).split("").map(function(Z){return Z.charCodeAt(0).toString(16)}).join(""):oe==="Identity-H"&&(te=r(S,w[x])),m.isHex=!0,{text:te,x:c,y:u,options:h,mutex:m}};e.events.push(["postProcessText",function(o){var s=o.text||"",l=[],c={text:s,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(s)){var u=0;for(u=0;u<s.length;u+=1)Array.isArray(s[u])&&s[u].length===3?l.push([i(Object.assign({},c,{text:s[u][0]})).text,s[u][1],s[u][2]]):l.push(i(Object.assign({},c,{text:s[u]})).text);o.text=l}else o.text=i(Object.assign({},c,{text:s})).text}])}(sr),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(sr.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,o,s,l,c,u,h,m=e,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],w={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},x={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},S=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],C=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),j=!1,oe=0;this.__bidiEngine__={};var te=function(_){var P=_.charCodeAt(),b=P>>8,H=x[b];return H!==void 0?m[256*H+(255&P)]:b===252||b===253?"AL":C.test(b)?"L":b===8?"R":"N"},Z=function(_){for(var P,b=0;b<_.length;b++){if((P=te(_.charAt(b)))==="L")return!1;if(P==="R")return!0}return!1},re=function(_,P,b,H){var K,R,k,W,z=P[H];switch(z){case"L":case"R":j=!1;break;case"N":case"AN":break;case"EN":j&&(z="AN");break;case"AL":j=!0,z="R";break;case"WS":z="N";break;case"CS":H<1||H+1>=P.length||(K=b[H-1])!=="EN"&&K!=="AN"||(R=P[H+1])!=="EN"&&R!=="AN"?z="N":j&&(R="AN"),z=R===K?R:"N";break;case"ES":z=(K=H>0?b[H-1]:"B")==="EN"&&H+1<P.length&&P[H+1]==="EN"?"EN":"N";break;case"ET":if(H>0&&b[H-1]==="EN"){z="EN";break}if(j){z="N";break}for(k=H+1,W=P.length;k<W&&P[k]==="ET";)k++;z=k<W&&P[k]==="EN"?"EN":"N";break;case"NSM":if(s&&!l){for(W=P.length,k=H+1;k<W&&P[k]==="NSM";)k++;if(k<W){var U=_[H],le=U>=1425&&U<=2303||U===64286;if(K=P[k],le&&(K==="R"||K==="AL")){z="R";break}}}z=H<1||(K=P[H-1])==="B"?"N":b[H-1];break;case"B":j=!1,i=!0,z=oe;break;case"S":o=!0,z="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":j=!1;break;case"BN":z="N"}return z},E=function(_,P,b){var H=_.split("");return b&&$(H,b,{hiLevel:oe}),H.reverse(),P&&P.reverse(),H.join("")},$=function(_,P,b){var H,K,R,k,W,z=-1,U=_.length,le=0,L=[],M=oe?f:g,G=[];for(j=!1,i=!1,o=!1,K=0;K<U;K++)G[K]=te(_[K]);for(R=0;R<U;R++){if(W=le,L[R]=re(_,G,L,R),H=240&(le=M[W][w[L[R]]]),le&=15,P[R]=k=M[le][5],H>0)if(H===16){for(K=z;K<R;K++)P[K]=1;z=-1}else z=-1;if(M[le][6])z===-1&&(z=R);else if(z>-1){for(K=z;K<R;K++)P[K]=k;z=-1}G[R]==="B"&&(P[R]=0),b.hiLevel|=k}o&&function(I,F,X){for(var Y=0;Y<X;Y++)if(I[Y]==="S"){F[Y]=oe;for(var Q=Y-1;Q>=0&&I[Q]==="WS";Q--)F[Q]=oe}}(G,P,U)},T=function(_,P,b,H,K){if(!(K.hiLevel<_)){if(_===1&&oe===1&&!i)return P.reverse(),void(b&&b.reverse());for(var R,k,W,z,U=P.length,le=0;le<U;){if(H[le]>=_){for(W=le+1;W<U&&H[W]>=_;)W++;for(z=le,k=W-1;z<k;z++,k--)R=P[z],P[z]=P[k],P[k]=R,b&&(R=b[z],b[z]=b[k],b[k]=R);le=W}le++}}},B=function(_,P,b){var H=_.split(""),K={hiLevel:oe};return b||(b=[]),$(H,b,K),function(R,k,W){if(W.hiLevel!==0&&h)for(var z,U=0;U<R.length;U++)k[U]===1&&(z=S.indexOf(R[U]))>=0&&(R[U]=S[z+1])}(H,b,K),T(2,H,P,b,K),T(1,H,P,b,K),H.join("")};return this.__bidiEngine__.doBidiReorder=function(_,P,b){if(function(K,R){if(R)for(var k=0;k<K.length;k++)R[k]=k;l===void 0&&(l=Z(K)),u===void 0&&(u=Z(K))}(_,P),s||!c||u)if(s&&c&&l^u)oe=l?1:0,_=E(_,P,b);else if(!s&&c&&u)oe=l?1:0,_=B(_,P,b),_=E(_,P);else if(!s||l||c||u){if(s&&!c&&l^u)_=E(_,P),l?(oe=0,_=B(_,P,b)):(oe=1,_=B(_,P,b),_=E(_,P));else if(s&&l&&!c&&u)oe=1,_=B(_,P,b),_=E(_,P);else if(!s&&!c&&l^u){var H=h;l?(oe=1,_=B(_,P,b),oe=0,h=!1,_=B(_,P,b),h=H):(oe=0,_=B(_,P,b),_=E(_,P),oe=1,h=!1,_=B(_,P,b),h=H,_=E(_,P))}}else oe=0,_=B(_,P,b);else oe=l?1:0,_=B(_,P,b);return _},this.__bidiEngine__.setOptions=function(_){_&&(s=_.isInputVisual,c=_.isOutputVisual,l=_.isInputRtl,u=_.isOutputRtl,h=_.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var o=n.options||{};n.mutex,o.lang;var s=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,r.setOptions(o),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(s=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?s.push([r.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):s.push([r.doBidiReorder(i[l])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(sr),sr.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Ba(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new mR(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new tR(this.contents),this.head=new nR(this),this.name=new lR(this),this.cmap=new e_(this),this.toUnicode={},this.hhea=new iR(this),this.maxp=new cR(this),this.hmtx=new uR(this),this.post=new sR(this),this.os2=new oR(this),this.loca=new fR(this),this.glyf=new dR(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var s,l,c,u;for(u=[],s=0,l=(c=this.bbox).length;s<l;s++)e=c[s],u.push(Math.round(e*this.scaleFactor));return u}.call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),(32768&(r=i>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,o,s,l;for(s=0,o=0,l=(e=""+e).length;0<=l?o<l:o>l;o=0<=l?++o:--o)i=e.charCodeAt(o),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var jo,Ba=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,o,s,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^o)+65536*(255^s)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*o+65536*s+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,o;for(o=[],n=0,i=e.length;n<i;n++)r=e[n],o.push(this.writeByte(r));return o},t}(),tR=function(){var t;function e(r){var n,i,o;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,o=this.tableCount;0<=o?i<o:i>o;i=0<=o?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,o,s,l,c,u,h,m,g,f,w,x;for(x in f=Object.keys(r).length,c=Math.log(2),m=16*Math.floor(Math.log(f)/c),s=Math.floor(m/c),h=16*f-m,(i=new Ba).writeInt(this.scalarType),i.writeShort(f),i.writeShort(m),i.writeShort(s),i.writeShort(h),o=16*f,u=i.pos+o,l=null,w=[],r)for(g=r[x],i.writeString(x),i.writeInt(t(g)),i.writeInt(u),i.writeInt(g.length),w=w.concat(g),x==="head"&&(l=u),u+=g.length;u%4;)w.push(0),u++;return i.write(w),n=2981146554-t(i.data),i.pos=l+8,i.writeUInt32(n),i.data},t=function(r){var n,i,o,s;for(r=t_.call(r);r.length%4;)r.push(0);for(o=new Ba(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=o.readUInt32();return 4294967295&i},e}(),rR={}.hasOwnProperty,ps=function(t,e){for(var r in e)rR.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};jo=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var nR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ps(e,jo),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var n;return(n=new Ba).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},e}(),nb=function(){function t(e,r){var n,i,o,s,l,c,u,h,m,g,f,w,x,S,C,j,oe;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),m=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(f=e.readUInt16(),g=f/2,e.pos+=6,o=function(){var te,Z;for(Z=[],c=te=0;0<=g?te<g:te>g;c=0<=g?++te:--te)Z.push(e.readUInt16());return Z}(),e.pos+=2,x=function(){var te,Z;for(Z=[],c=te=0;0<=g?te<g:te>g;c=0<=g?++te:--te)Z.push(e.readUInt16());return Z}(),u=function(){var te,Z;for(Z=[],c=te=0;0<=g?te<g:te>g;c=0<=g?++te:--te)Z.push(e.readUInt16());return Z}(),h=function(){var te,Z;for(Z=[],c=te=0;0<=g?te<g:te>g;c=0<=g?++te:--te)Z.push(e.readUInt16());return Z}(),i=(this.length-e.pos+this.offset)/2,l=function(){var te,Z;for(Z=[],c=te=0;0<=i?te<i:te>i;c=0<=i?++te:--te)Z.push(e.readUInt16());return Z}(),c=C=0,oe=o.length;C<oe;c=++C)for(S=o[c],n=j=w=x[c];w<=S?j<=S:j>=S;n=w<=S?++j:--j)h[c]===0?s=n+u[c]:(s=l[h[c]/2+(n-w)-(g-c)]||0)!==0&&(s+=u[c]),this.codeMap[n]=65535&s}e.pos=m}return t.encode=function(e,r){var n,i,o,s,l,c,u,h,m,g,f,w,x,S,C,j,oe,te,Z,re,E,$,T,B,_,P,b,H,K,R,k,W,z,U,le,L,M,G,I,F,X,Y,Q,J,V,ne;switch(H=new Ba,s=Object.keys(e).sort(function(ee,ce){return ee-ce}),r){case"macroman":for(x=0,S=function(){var ee=[];for(w=0;w<256;++w)ee.push(0);return ee}(),j={0:0},o={},K=0,z=s.length;K<z;K++)j[Q=e[i=s[K]]]==null&&(j[Q]=++x),o[i]={old:e[i],new:j[e[i]]},S[i]=j[e[i]];return H.writeUInt16(1),H.writeUInt16(0),H.writeUInt32(12),H.writeUInt16(0),H.writeUInt16(262),H.writeUInt16(0),H.write(S),{charMap:o,subtable:H.data,maxGlyphID:x+1};case"unicode":for(P=[],m=[],oe=0,j={},n={},C=u=null,R=0,U=s.length;R<U;R++)j[Z=e[i=s[R]]]==null&&(j[Z]=++oe),n[i]={old:Z,new:j[Z]},l=j[Z]-i,C!=null&&l===u||(C&&m.push(C),P.push(i),u=l),C=i;for(C&&m.push(C),m.push(65535),P.push(65535),B=2*(T=P.length),$=2*Math.pow(Math.log(T)/Math.LN2,2),g=Math.log($/2)/Math.LN2,E=2*T-$,c=[],re=[],f=[],w=k=0,le=P.length;k<le;w=++k){if(_=P[w],h=m[w],_===65535){c.push(0),re.push(0);break}if(_-(b=n[_].new)>=32768)for(c.push(0),re.push(2*(f.length+T-w)),i=W=_;_<=h?W<=h:W>=h;i=_<=h?++W:--W)f.push(n[i].new);else c.push(b-_),re.push(0)}for(H.writeUInt16(3),H.writeUInt16(1),H.writeUInt32(12),H.writeUInt16(4),H.writeUInt16(16+8*T+2*f.length),H.writeUInt16(0),H.writeUInt16(B),H.writeUInt16($),H.writeUInt16(g),H.writeUInt16(E),X=0,L=m.length;X<L;X++)i=m[X],H.writeUInt16(i);for(H.writeUInt16(0),Y=0,M=P.length;Y<M;Y++)i=P[Y],H.writeUInt16(i);for(J=0,G=c.length;J<G;J++)l=c[J],H.writeUInt16(l);for(V=0,I=re.length;V<I;V++)te=re[V],H.writeUInt16(te);for(ne=0,F=f.length;ne<F;ne++)x=f[ne],H.writeUInt16(x);return{charMap:n,subtable:H.data,maxGlyphID:oe+1}}},t}(),e_=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ps(e,jo),e.prototype.tag="cmap",e.prototype.parse=function(r){var n,i,o;for(r.pos=this.offset,this.version=r.readUInt16(),o=r.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=o?i<o:i>o;i=0<=o?++i:--i)n=new nb(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(r,n){var i,o;return n==null&&(n="macroman"),i=nb.encode(r,n),(o=new Ba).writeUInt16(0),o.writeUInt16(1),i.table=o.data.concat(i.subtable),i},e}(),iR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ps(e,jo),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e}(),oR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ps(e,jo),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(r.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(r.readInt());return i}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(r.readInt());return i}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e}(),sR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ps(e,jo),e.prototype.tag="post",e.prototype.parse=function(r){var n,i,o;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var s;for(i=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],o=[];r.pos<this.offset+this.length;)n=r.readByte(),o.push(this.names.push(r.readString(n)));return o;case 151552:return i=r.readUInt16(),this.offsets=r.read(i);case 196608:break;case 262144:return this.map=function(){var l,c,u;for(u=[],s=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;s=0<=c?++l:--l)u.push(r.readUInt32());return u}.call(this)}},e}(),aR=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},lR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ps(e,jo),e.prototype.tag="name",e.prototype.parse=function(r){var n,i,o,s,l,c,u,h,m,g,f;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),i=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)i.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(u={},s=m=0,g=i.length;m<g;s=++m)o=i[s],r.pos=o.offset,h=r.readString(o.length),l=new aR(h,o),u[f=o.nameID]==null&&(u[f]=[]),u[o.nameID].push(l);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},e}(),cR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ps(e,jo),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e}(),uR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ps(e,jo),e.prototype.tag="hmtx",e.prototype.parse=function(r){var n,i,o,s,l,c,u;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var h,m;for(m=[],n=h=0;0<=o?h<o:h>o;n=0<=o?++h:--h)m.push(r.readInt16());return m}(),this.widths=function(){var h,m,g,f;for(f=[],h=0,m=(g=this.metrics).length;h<m;h++)s=g[h],f.push(s.advance);return f}.call(this),i=this.widths[this.widths.length-1],u=[],n=l=0;0<=o?l<o:l>o;n=0<=o?++l:--l)u.push(this.widths.push(i));return u},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e}(),t_=[].slice,dR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ps(e,jo),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var n,i,o,s,l,c,u,h,m,g;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,i=s.indexOf(r),(o=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+i,l=(c=new Ba(n.read(o))).readShort(),h=c.readShort(),g=c.readShort(),u=c.readShort(),m=c.readShort(),this.cache[r]=l===-1?new pR(c,h,g,u,m):new hR(c,l,h,g,u,m),this.cache[r]))},e.prototype.encode=function(r,n,i){var o,s,l,c,u;for(l=[],s=[],c=0,u=n.length;c<u;c++)o=r[n[c]],s.push(l.length),o&&(l=l.concat(o.encode(i)));return s.push(l.length),{table:l,offsets:s}},e}(),hR=function(){function t(e,r,n,i,o,s){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=o,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),pR=function(){function t(e,r,n,i,o){var s,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;l=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&l;)s.pos+=1&l?4:2,128&l?s.pos+=8:64&l?s.pos+=4:8&l&&(s.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Ba(t_.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),fR=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return ps(e,jo),e.prototype.tag="loca",e.prototype.parse=function(r){var n,i;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=2)s.push(2*r.readUInt16());return s}.call(this):function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=4)s.push(r.readUInt32());return s}.call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,n){for(var i=new Uint32Array(this.offsets.length),o=0,s=0,l=0;l<i.length;++l)if(i[l]=o,s<n.length&&n[s]==l){++s,i[l]=o;var c=this.offsets[l],u=this.offsets[l+1]-c;u>0&&(o+=u)}for(var h=new Array(4*i.length),m=0;m<i.length;++m)h[4*m+3]=255&i[m],h[4*m+2]=(65280&i[m])>>8,h[4*m+1]=(16711680&i[m])>>16,h[4*m]=(4278190080&i[m])>>24;return h},e}(),mR=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,o;for(r in i=this.font.cmap.tables[0].codeMap,e={},o=this.subset)n=o[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,o,s,l,c;for(i={},s=0,l=e.length;s<l;s++)i[o=e[s]]=this.font.glyf.glyphFor(o);for(o in r=[],i)(n=i[o])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(o in c=this.glyphsFor(r))n=c[o],i[o]=n;return i},t.prototype.encode=function(e,r){var n,i,o,s,l,c,u,h,m,g,f,w,x,S,C;for(i in n=e_.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),f={0:0},C=n.charMap)f[(c=C[i]).old]=c.new;for(w in g=n.maxGlyphID,s)w in f||(f[w]=g++);return h=function(j){var oe,te;for(oe in te={},j)te[j[oe]]=oe;return te}(f),m=Object.keys(h).sort(function(j,oe){return j-oe}),x=function(){var j,oe,te;for(te=[],j=0,oe=m.length;j<oe;j++)l=m[j],te.push(h[l]);return te}(),o=this.font.glyf.encode(s,x,f),u=this.font.loca.encode(o.offsets,x),S={cmap:this.font.cmap.raw(),glyf:o.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(S["OS/2"]=this.font.os2.raw()),this.font.directory.encode(S)},t}();sr.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,o,s;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in o=["<<"],r)s=r[i],o.push("/"+i+" "+e.convert(s));return o.push(">>"),o.join(`
`)}return""+r},e}();const r_=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:WL,AcroFormAppearance:Yt,AcroFormButton:Yn,AcroFormCheckBox:wu,AcroFormChoiceField:Pl,AcroFormComboBox:xl,AcroFormEditBox:Su,AcroFormListBox:wl,AcroFormPasswordField:xu,AcroFormPushButton:Pu,AcroFormRadioButton:Al,AcroFormTextField:ka,GState:qu,ShadingPattern:Sa,TilingPattern:gl,default:sr,jsPDF:sr},Symbol.toStringTag,{value:"Module"}));function n_(t,e,r,n,i){n=n||{};var o=1.15,s=i.internal.scaleFactor,l=i.internal.getFontSize()/s,c=i.getLineHeightFactor?i.getLineHeightFactor():o,u=l*c,h=/\r\n|\r|\n/g,m="",g=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(m=typeof t=="string"?t.split(h):t,g=m.length||1),r+=l*(2-o),n.valign==="middle"?r-=g/2*u:n.valign==="bottom"&&(r-=g*u),n.halign==="center"||n.halign==="right"){var f=l;if(n.halign==="center"&&(f*=.5),m&&g>=1){for(var w=0;w<m.length;w++)i.text(m[w],e-i.getStringUnitWidth(m[w])*f,r),r+=u;return i}e-=i.getStringUnitWidth(t)*f}return n.halign==="justify"?i.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):i.text(t,e,r),i}var ib={},vc=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:ib=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,i,o;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var s=this.jsPDFDocument.internal.getFont(),l=s.fontStyle,c=s.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),l=u[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var h=t.unifyColor(e.fillColor);h&&(n=this.jsPDFDocument).setFillColor.apply(n,h),h=t.unifyColor(e.textColor),h&&(i=this.jsPDFDocument).setTextColor.apply(i,h),h=t.unifyColor(e.lineColor),h&&(o=this.jsPDFDocument).setDrawColor.apply(o,h),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,i,o){return this.jsPDFDocument.rect(e,r,n,i,o)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return ib||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),Lm=function(t,e){return Lm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Lm(t,e)};function i_(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Lm(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var o_=function(t){i_(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function yR(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function gR(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function Uh(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],i=n.map(function(o){return r.getTextWidth(o)}).reduce(function(o,s){return Math.max(o,s)},0);return i}function s_(t,e,r,n){var i=e.settings.tableLineWidth,o=e.settings.tableLineColor;t.applyStyles({lineWidth:i,lineColor:o});var s=a_(i,!1);s&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,s)}function a_(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function vp(t,e){var r,n,i,o;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(i=t.right)!==null&&i!==void 0?i:e,bottom:(o=t.bottom)!==null&&o!==void 0?o:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function l_(t,e){var r=vp(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function vR(t,e,r,n,i){var o={},s=1.3333333333333333,l=Ef(e,function(oe){return i.getComputedStyle(oe).backgroundColor});l!=null&&(o.fillColor=l);var c=Ef(e,function(oe){return i.getComputedStyle(oe).color});c!=null&&(o.textColor=c);var u=_R(n,r);u&&(o.cellPadding=u);var h="borderTopColor",m=s*r,g=n.borderTopWidth;if(n.borderBottomWidth===g&&n.borderRightWidth===g&&n.borderLeftWidth===g){var f=(parseFloat(g)||0)/m;f&&(o.lineWidth=f)}else o.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/m,right:(parseFloat(n.borderRightWidth)||0)/m,bottom:(parseFloat(n.borderBottomWidth)||0)/m,left:(parseFloat(n.borderLeftWidth)||0)/m},o.lineWidth.top||(o.lineWidth.right?h="borderRightColor":o.lineWidth.bottom?h="borderBottomColor":o.lineWidth.left&&(h="borderLeftColor"));var w=Ef(e,function(oe){return i.getComputedStyle(oe)[h]});w!=null&&(o.lineColor=w);var x=["left","right","center","justify"];x.indexOf(n.textAlign)!==-1&&(o.halign=n.textAlign),x=["middle","bottom","top"],x.indexOf(n.verticalAlign)!==-1&&(o.valign=n.verticalAlign);var S=parseInt(n.fontSize||"");isNaN(S)||(o.fontSize=S/s);var C=bR(n);C&&(o.fontStyle=C);var j=(n.fontFamily||"").toLowerCase();return t.indexOf(j)!==-1&&(o.font=j),o}function bR(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function Ef(t,e){var r=c_(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var i=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],o=parseInt(n[4]);return o===0||isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function c_(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:c_(t.parentElement,e):r}function _R(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),i=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,o=r.map(function(l){return parseInt(l||"0")/n}),s=vp(o,0);return i>s.top&&(s.top=i),i>s.bottom&&(s.bottom=i),s}function u_(t,e,r,n,i){var o,s;n===void 0&&(n=!1),i===void 0&&(i=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),u=t.scaleFactor(),h=[],m=[],g=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:h,body:m,foot:g};for(var f=0;f<l.rows.length;f++){var w=l.rows[f],x=(s=(o=w?.parentElement)===null||o===void 0?void 0:o.tagName)===null||s===void 0?void 0:s.toLowerCase(),S=SR(c,u,r,w,n,i);S&&(x==="thead"?h.push(S):x==="tfoot"?g.push(S):m.push(S))}return{head:h,body:m,foot:g}}function SR(t,e,r,n,i,o){for(var s=new o_(n),l=0;l<n.cells.length;l++){var c=n.cells[l],u=r.getComputedStyle(c);if(i||u.display!=="none"){var h=void 0;o&&(h=vR(t,c,e,u,r)),s.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:h,_element:c,content:PR(c)})}}var m=r.getComputedStyle(n);if(s.length>0&&(i||m.display!=="none"))return s}function PR(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function wR(t,e,r){for(var n=0,i=[t,e,r];n<i.length;n++){var o=i[n];o&&typeof o!="object"&&console.error("The options parameter should be of type object, is: "+typeof o),o.startY&&typeof o.startY!="number"&&(console.error("Invalid value for startY option",o.startY),delete o.startY)}}function Rs(t,e,r,n,i){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),s=1;s<arguments.length;s++){var l=arguments[s];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(o[c]=l[c])}return o}function d_(t,e){var r=new vc(t),n=r.getDocumentOptions(),i=r.getGlobalOptions();wR(i,n,e);var o=Rs({},i,n,e),s;typeof window<"u"&&(s=window);var l=xR(i,n,e),c=AR(i,n,e),u=CR(r,o),h=$R(r,o,s);return{id:e.tableId,content:h,hooks:c,styles:l,settings:u}}function xR(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},i=function(c){if(c==="columnStyles"){var u=t[c],h=e[c],m=r[c];n.columnStyles=Rs({},u,h,m)}else{var g=[t,e,r],f=g.map(function(w){return w[c]||{}});n[c]=Rs({},f[0],f[1],f[2])}},o=0,s=Object.keys(n);o<s.length;o++){var l=s[o];i(l)}return n}function AR(t,e,r){for(var n=[t,e,r],i={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},o=0,s=n;o<s.length;o++){var l=s[o];l.didParseCell&&i.didParseCell.push(l.didParseCell),l.willDrawCell&&i.willDrawCell.push(l.willDrawCell),l.didDrawCell&&i.didDrawCell.push(l.didDrawCell),l.willDrawPage&&i.willDrawPage.push(l.willDrawPage),l.didDrawPage&&i.didDrawPage.push(l.didDrawPage)}return i}function CR(t,e){var r,n,i,o,s,l,c,u,h,m,g,f,w=vp(e.margin,40/t.scaleFactor()),x=(r=IR(t,e.startY))!==null&&r!==void 0?r:w.top,S;e.showFoot===!0?S="everyPage":e.showFoot===!1?S="never":S=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var C;e.showHead===!0?C="everyPage":e.showHead===!1?C="never":C=(i=e.showHead)!==null&&i!==void 0?i:"everyPage";var j=(o=e.useCss)!==null&&o!==void 0?o:!1,oe=e.theme||(j?"plain":"striped"),te=!!e.horizontalPageBreak,Z=(s=e.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:j,theme:oe,startY:x,margin:w,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=e.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(h=e.tableWidth)!==null&&h!==void 0?h:"auto",showHead:C,showFoot:S,tableLineWidth:(m=e.tableLineWidth)!==null&&m!==void 0?m:0,tableLineColor:(g=e.tableLineColor)!==null&&g!==void 0?g:200,horizontalPageBreak:te,horizontalPageBreakRepeat:Z,horizontalPageBreakBehaviour:(f=e.horizontalPageBreakBehaviour)!==null&&f!==void 0?f:"afterAllRows"}}function IR(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),i=t.pageNumber(),o=!1;if(r&&r.startPageNumber){var s=r.startPageNumber+r.pageNumber-1;o=s===i}return typeof e=="number"?e:(e==null||e===!1)&&o&&r?.finalY!=null?r.finalY+20/n:null}function $R(t,e,r){var n=e.head||[],i=e.body||[],o=e.foot||[];if(e.html){var s=e.includeHiddenHtml;if(r){var l=u_(t,e.html,r,s,e.useCss)||{};n=l.head||n,i=l.body||n,o=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||ER(n,i,o);return{columns:c,head:n,body:i,foot:o}}function ER(t,e,r){var n=t[0]||e[0]||r[0]||[],i=[];return Object.keys(n).filter(function(o){return o!=="_element"}).forEach(function(o){var s=1,l;Array.isArray(n)?l=n[parseInt(o)]:l=n[o],typeof l=="object"&&!Array.isArray(l)&&(s=l?.colSpan||1);for(var c=0;c<s;c++){var u=void 0;Array.isArray(n)?u=i.length:u=o+(c>0?"_".concat(c):"");var h={dataKey:u};i.push(h)}}),i}var Rm=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),TR=function(t){i_(e,t);function e(r,n,i,o,s,l){var c=t.call(this,r,n,l)||this;return c.cell=i,c.row=o,c.column=s,c.section=o.section,c}return e}(Rm),kR=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,i,o,s){for(var l=0,c=r;l<c.length;l++){var u=c[l],h=new TR(e,this,n,i,o,s),m=u(h)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],m)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,i=this.hooks.didDrawPage;n<i.length;n++){var o=i[n];o(new Rm(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,i=this.hooks.willDrawPage;n<i.length;n++){var o=i[n];o(new Rm(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(i,o){return i+o.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),h_=function(){function t(e,r,n,i,o){o===void 0&&(o=!1),this.height=0,this.raw=e,e instanceof o_&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=i,this.spansMultiplePages=o}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,i){var o;return Math.max(n,((o=r.cells[i.index])===null||o===void 0?void 0:o.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var i=r.cells[n.index];return i?i.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(i,o){var s=n.cells[o.index];if(!s)return 0;var l=r.getLineHeight(s.styles.fontSize),c=s.padding("vertical"),u=c+l;return u>i?u:i},0)},t}(),p_=function(){function t(e,r,n){var i;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var o=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,o=(i=e.content)!==null&&i!==void 0?i:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var s=o!=null?""+o:"",l=/\r\n|\r|\n/g;this.text=s.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var i=this.width-this.padding("horizontal");n=this.x+i/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,i=this.styles.fontSize/e*r,o=n*i+this.padding("vertical");return Math.max(o,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=vp(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),NR=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,i=e.allRows();n<i.length;n++){var o=i[n],s=o.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(r=Math.max(r,s.styles.cellWidth))}return r},t}();function LR(t,e){RR(t,e);var r=[],n=0;e.columns.forEach(function(o){var s=o.getMaxCustomCellWidth(e);s?o.width=s:(o.width=o.wrappedWidth,r.push(o)),n+=o.width});var i=e.getWidth(t.pageSize().width)-n;i&&(i=Dm(r,i,function(o){return Math.max(o.minReadableWidth,o.minWidth)})),i&&(i=Dm(r,i,function(o){return o.minWidth})),i=Math.abs(i),!e.settings.horizontalPageBreak&&i>.1/t.scaleFactor()&&(i=i<1?i:Math.round(i),console.warn("Of the table content, ".concat(i," units width could not fit page"))),MR(e),FR(e,t),DR(e)}function RR(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,i=l_(t,e);e.allRows().forEach(function(o){for(var s=0,l=e.columns;s<l.length;s++){var c=l[s],u=o.cells[c.index];if(u){var h=e.hooks.didParseCell;e.callCellHooks(t,h,u,o,c,null);var m=u.padding("horizontal");u.contentWidth=Uh(u.text,u.styles,t)+m;var g=Uh(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,t);if(u.minReadableWidth=g+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>i?(u.minWidth=i,u.wrappedWidth=i):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var f=10/r;u.minWidth=u.styles.minCellWidth||f,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),e.allRows().forEach(function(o){for(var s=0,l=e.columns;s<l.length;s++){var c=l[s],u=o.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var h=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},m=h.cellWidth||h.minCellWidth;m&&typeof m=="number"&&(c.minWidth=m,c.wrappedWidth=m)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function Dm(t,e,r){for(var n=e,i=t.reduce(function(f,w){return f+w.wrappedWidth},0),o=0;o<t.length;o++){var s=t[o],l=s.wrappedWidth/i,c=n*l,u=s.width+c,h=r(s),m=u<h?h:u;e-=m-s.width,s.width=m}if(e=Math.round(e*1e10)/1e10,e){var g=t.filter(function(f){return e<0?f.width>r(f):!0});g.length&&(e=Dm(g,e,r))}return e}function DR(t){for(var e={},r=1,n=t.allRows(),i=0;i<n.length;i++)for(var o=n[i],s=0,l=t.columns;s<l.length;s++){var c=l[s],u=e[c.index];if(r>1)r--,delete o.cells[c.index];else if(u)u.cell.height+=o.height,r=u.cell.colSpan,delete o.cells[c.index],u.left--,u.left<=1&&delete e[c.index];else{var h=o.cells[c.index];if(!h)continue;if(h.height=o.height,h.rowSpan>1){var m=n.length-i,g=h.rowSpan>m?m:h.rowSpan;e[c.index]={cell:h,left:g,row:o}}}}}function MR(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],i=null,o=0,s=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(s-=1,s>1&&t.columns[l+1])o+=c.width,delete n.cells[c.index];else if(i){var u=i;delete n.cells[c.index],i=null,u.width=c.width+o}else{var u=n.cells[c.index];if(!u)continue;if(s=u.colSpan,o=0,u.colSpan>1){i=u,o+=c.width;continue}u.width=c.width+o}}}function FR(t,e){for(var r={count:0,height:0},n=0,i=t.allRows();n<i.length;n++){for(var o=i[n],s=0,l=t.columns;s<l.length;s++){var c=l[s],u=o.cells[c.index];if(u){e.applyStyles(u.styles,!0);var h=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=e.splitTextToSize(u.text,h+1/e.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=ob(u.text,h,u.styles,e,"...");else if(u.styles.overflow==="hidden")u.text=ob(u.text,h,u.styles,e,"");else if(typeof u.styles.overflow=="function"){var m=u.styles.overflow(u.text,h);typeof m=="string"?u.text=[m]:u.text=m}u.contentHeight=u.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var g=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<g*u.rowSpan?r={height:g,count:u.rowSpan}:r&&r.count>0&&r.height>g&&(g=r.height),g>o.height&&(o.height=g)}}r.count--}}function ob(t,e,r,n,i){return t.map(function(o){return OR(o,e,r,n,i)})}function OR(t,e,r,n,i){var o=1e4*n.scaleFactor();if(e=Math.ceil(e*o)/o,e>=Uh(t,r,n))return t;for(;e<Uh(t+i,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+i}function f_(t,e){var r=new vc(t),n=BR(e,r.scaleFactor()),i=new kR(e,n);return LR(r,i),r.applyStyles(r.userStyles),i}function BR(t,e){var r=t.content,n=VR(r.columns);if(r.head.length===0){var i=sb(n,"head");i&&r.head.push(i)}if(r.foot.length===0){var i=sb(n,"foot");i&&r.foot.push(i)}var o=t.settings.theme,s=t.styles;return{columns:n,head:Tf("head",r.head,n,s,o,e),body:Tf("body",r.body,n,s,o,e),foot:Tf("foot",r.foot,n,s,o,e)}}function Tf(t,e,r,n,i,o){var s={},l=e.map(function(c,u){for(var h=0,m={},g=0,f=0,w=0,x=r;w<x.length;w++){var S=x[w];if(s[S.index]==null||s[S.index].left===0)if(f===0){var C=void 0;Array.isArray(c)?C=c[S.index-g-h]:C=c[S.dataKey];var j={};typeof C=="object"&&!Array.isArray(C)&&(j=C?.styles||{});var oe=qR(t,S,u,i,n,o,j),te=new p_(C,oe,t);m[S.dataKey]=te,m[S.index]=te,f=te.colSpan-1,s[S.index]={left:te.rowSpan-1,times:f}}else f--,g++;else s[S.index].left--,f=s[S.index].times,h++}return new h_(c,u,t,m)});return l}function sb(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var i=jR(e,n.raw);i!=null&&(r[n.dataKey]=i)}}),Object.keys(r).length>0?r:null}function jR(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function VR(t){return t.map(function(e,r){var n,i;return typeof e=="object"?i=(n=e.dataKey)!==null&&n!==void 0?n:r:i=r,new NR(i,e,r)})}function qR(t,e,r,n,i,o,s){var l=gR(n),c;t==="head"?c=i.headStyles:t==="body"?c=i.bodyStyles:t==="foot"&&(c=i.footStyles);var u=Rs({},l.table,l[t],i.styles,c),h=i.columnStyles[e.dataKey]||i.columnStyles[e.index]||{},m=t==="body"?h:{},g=t==="body"&&r%2===0?Rs({},l.alternateRow,i.alternateRowStyles):{},f=yR(o),w=Rs({},f,u,g,m);return Rs(w,s)}function zR(t,e,r){var n;r===void 0&&(r={});var i=l_(t,e),o=new Map,s=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(g){var f=e.columns.find(function(w){return w.dataKey===g||w.index===g});f&&!o.has(f.index)&&(o.set(f.index,!0),s.push(f.index),l.push(e.columns[f.index]),i-=f.wrappedWidth)});for(var u=!0,h=(n=r?.start)!==null&&n!==void 0?n:0;h<e.columns.length;){if(o.has(h)){h++;continue}var m=e.columns[h].wrappedWidth;if(u||i>=m)u=!1,s.push(h),l.push(e.columns[h]),i-=m;else break;h++}return{colIndexes:s,columns:l,lastIndex:h-1}}function UR(t,e){for(var r=[],n=0;n<e.columns.length;n++){var i=zR(t,e,{start:n});i.columns.length&&(r.push(i),n=i.lastIndex)}return r}function m_(t,e){var r=e.settings,n=r.startY,i=r.margin,o={x:i.left,y:n},s=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=n+i.bottom+s;if(r.pageBreak==="avoid"){var c=e.body,u=c.reduce(function(g,f){return g+f.height},0);l+=u}var h=new vc(t);(r.pageBreak==="always"||r.startY!=null&&l>h.pageSize().height)&&(g_(h),o.y=i.top),e.callWillDrawPageHooks(h,o);var m=Rs({},o);e.startPageNumber=h.pageNumber(),r.horizontalPageBreak?HR(h,e,m,o):(h.applyStyles(h.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(g){return qs(h,e,g,o,e.columns)}),h.applyStyles(h.userStyles),e.body.forEach(function(g,f){var w=f===e.body.length-1;Hh(h,e,g,w,m,o,e.columns)}),h.applyStyles(h.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(g){return qs(h,e,g,o,e.columns)})),s_(h,e,m,o),e.callEndPageHooks(h,o),e.finalY=o.y,t.lastAutoTable=e,h.applyStyles(h.userStyles)}function HR(t,e,r,n){var i=UR(t,e),o=e.settings;if(o.horizontalPageBreakBehaviour==="afterAllRows")i.forEach(function(u,h){t.applyStyles(t.userStyles),h>0?Au(t,e,r,n,u.columns,!0):ab(t,e,n,u.columns),GR(t,e,r,n,u.columns),kf(t,e,n,u.columns)});else for(var s=-1,l=i[0],c=function(){var u=s;if(l){t.applyStyles(t.userStyles);var h=l.columns;s>=0?Au(t,e,r,n,h,!0):ab(t,e,n,h),u=lb(t,e,s+1,n,h),kf(t,e,n,h)}var m=u-s;i.slice(1).forEach(function(g){t.applyStyles(t.userStyles),Au(t,e,r,n,g.columns,!0),lb(t,e,s+1,n,g.columns,m),kf(t,e,n,g.columns)}),s=u};s<e.body.length-1;)c()}function ab(t,e,r,n){var i=e.settings;t.applyStyles(t.userStyles),(i.showHead==="firstPage"||i.showHead==="everyPage")&&e.head.forEach(function(o){return qs(t,e,o,r,n)})}function GR(t,e,r,n,i){t.applyStyles(t.userStyles),e.body.forEach(function(o,s){var l=s===e.body.length-1;Hh(t,e,o,l,r,n,i)})}function lb(t,e,r,n,i,o){t.applyStyles(t.userStyles),o=o??e.body.length;var s=Math.min(r+o,e.body.length),l=-1;return e.body.slice(r,s).forEach(function(c,u){var h=r+u===e.body.length-1,m=y_(t,e,h,n);c.canEntireRowFit(m,i)&&(qs(t,e,c,n,i),l=r+u)}),l}function kf(t,e,r,n){var i=e.settings;t.applyStyles(t.userStyles),(i.showFoot==="lastPage"||i.showFoot==="everyPage")&&e.foot.forEach(function(o){return qs(t,e,o,r,n)})}function WR(t,e,r){var n=r.getLineHeight(t.styles.fontSize),i=t.padding("vertical"),o=Math.floor((e-i)/n);return Math.max(0,o)}function YR(t,e,r,n){var i={};t.spansMultiplePages=!0,t.height=0;for(var o=0,s=0,l=r.columns;s<l.length;s++){var c=l[s],u=t.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var h=new p_(u.raw,u.styles,u.section);h=Rs(h,u),h.text=[];var m=WR(u,e,n);u.text.length>m&&(h.text=u.text.splice(m,u.text.length));var g=n.scaleFactor(),f=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(g,f),u.contentHeight>=e&&(u.contentHeight=e,h.styles.minCellHeight-=e),u.contentHeight>t.height&&(t.height=u.contentHeight),h.contentHeight=h.getContentHeight(g,f),h.contentHeight>o&&(o=h.contentHeight),i[c.index]=h}}var w=new h_(t.raw,-1,t.section,i,!0);w.height=o;for(var x=0,S=r.columns;x<S.length;x++){var c=S[x],h=w.cells[c.index];h&&(h.height=w.height);var u=t.cells[c.index];u&&(u.height=t.height)}return w}function KR(t,e,r,n){var i=t.pageSize().height,o=n.settings.margin,s=o.top+o.bottom,l=i-s;e.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),u=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var h=e.hasRowSpan(n.columns),m=e.getMaxCellHeight(n.columns)>l;return m?(h&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(h||n.settings.rowPageBreak==="avoid")}function Hh(t,e,r,n,i,o,s){var l=y_(t,e,n,o);if(r.canEntireRowFit(l,s))qs(t,e,r,o,s);else if(KR(t,r,l,e)){var c=YR(r,l,e,t);qs(t,e,r,o,s),Au(t,e,i,o,s),Hh(t,e,c,n,i,o,s)}else Au(t,e,i,o,s),Hh(t,e,r,n,i,o,s)}function qs(t,e,r,n,i){n.x=e.settings.margin.left;for(var o=0,s=i;o<s.length;o++){var l=s[o],c=r.cells[l.index];if(!c){n.x+=l.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,n);if(u===!1){n.x+=l.width;continue}JR(t,c,n);var h=c.getTextPos();n_(c.text,h.x,h.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function JR(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var i=a_(n.lineWidth,n.fillColor);i&&t.rect(e.x,r.y,e.width,e.height,i)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),QR(t,e,r,n.lineWidth))}function QR(t,e,r,n){var i,o,s,l;n.top&&(i=r.x,o=r.y,s=r.x+e.width,l=r.y,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),c(n.top,i,o,s,l)),n.bottom&&(i=r.x,o=r.y+e.height,s=r.x+e.width,l=r.y+e.height,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),c(n.bottom,i,o,s,l)),n.left&&(i=r.x,o=r.y,s=r.x,l=r.y+e.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,i,o,s,l)),n.right&&(i=r.x+e.width,o=r.y,s=r.x+e.width,l=r.y+e.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,i,o,s,l));function c(u,h,m,g,f){t.getDocument().setLineWidth(u),t.getDocument().line(h,m,g,f,"S")}}function y_(t,e,r,n){var i=e.settings.margin.bottom,o=e.settings.showFoot;return(o==="everyPage"||o==="lastPage"&&r)&&(i+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-i}function Au(t,e,r,n,i,o){i===void 0&&(i=[]),o===void 0&&(o=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!o&&e.foot.forEach(function(l){return qs(t,e,l,n,i)}),e.callEndPageHooks(t,n);var s=e.settings.margin;s_(t,e,r,n),g_(t),e.pageNumber++,n.x=s.left,n.y=s.top,r.y=s.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return qs(t,e,l,n,i)}),t.applyStyles(t.userStyles))}function g_(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function XR(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],i=d_(this,n),o=f_(this,i);return m_(this,o),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,i){n_(e,r,n,i,this)},t.API.autoTableSetDefaults=function(e){return vc.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){vc.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var i=new vc(this),o=u_(i,e,window,r,!1),s=o.head,l=o.body,c=((n=s[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:l,data:l}}}var Nf;function k8(t,e){var r=d_(t,e),n=f_(t,r);m_(t,n)}try{if(typeof window<"u"&&window){var cb=window,ub=cb.jsPDF||((Nf=cb.jspdf)===null||Nf===void 0?void 0:Nf.jsPDF);ub&&XR(ub)}}catch(t){console.error("Could not apply autoTable plugin",t)}var ZR=he("<div><div><label></label><select><option value=all></option></select></div><div><label></label><select><option value=all></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label></div><div><label>"),e7=he("<div><div><div></div></div><div><div> <!> <!> <!> </div><div>"),t7=he("<div><div>"),Jd=he("<option>"),r7=he("<div><div><div><div></div><div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div></div><div><div></div><div></div></div></div><div><div><span>: </span><span></span></div><div><span>: </span><span></span></div><div><span>: </span><span></span></div><div><span>: </span><span> kg</span></div><div><span>: </span><span></span></div><div><span>: </span><span>");const n7=t=>{const{t:e}=Zt(),[r,n]=Ce(""),[i,o]=Ce("all"),[s,l]=Ce({start:"",end:""}),[c,u]=Ce(""),[h,m]=Ce(""),[g,f]=Ce(!1),[w,x]=Ce("all"),S=Lt(()=>{let _=t.hbls;var P="";if(r()&&(P+=r().toLowerCase()),r()){const b=r().toLowerCase();_=_.filter(H=>H.hbl.toLowerCase().includes(b)||H.idairguide.toLowerCase().includes(b)||H.nameshipper.toLowerCase().includes(b)||H.consigneeName.toLowerCase().includes(b)||H.namegood.toLowerCase().includes(b)||H.bagnumber.toLowerCase().includes(b)||H.cidentity.toLowerCase().includes(b))}return i()!=="all"&&(_=_.filter(b=>b.idguidestate===i())),w()!=="all"&&(_=_.filter(b=>b.idclasification===w())),(s().start||s().end)&&(_=_.filter(b=>{const H=new Date(b.datereserve),K=s().start?new Date(s().start):new Date("1900-01-01"),R=s().end?new Date(s().end):new Date("2100-12-31");return H>=K&&H<=R})),c()&&(_=_?.filter(b=>b.nameshipper.toLowerCase().includes(c().toLowerCase()))),h()&&(_=_?.filter(b=>b.consigneeName.toLowerCase().includes(h().toLowerCase()))),_=_?.sort((b,H)=>new Date(H.datereserve).getTime()-new Date(b.datereserve).getTime()),t.onFilterChange?.(_),_}),C=Lt(()=>{const _=new Set(t.hbls.map(P=>P.nameshipper));return Array.from(_).sort()}),j=Lt(()=>{const _=new Set(t.hbls.map(P=>P.consigneeName));return Array.from(_).sort()}),oe=Lt(()=>{const _=new Set(t.hbls.map(P=>P.idguidestate));return Array.from(_).sort()}),te=Lt(()=>{const _=new Set(t.hbls.map(P=>P.idclasification));return Array.from(_).sort()}),Z=()=>{n(""),o("all"),l({start:"",end:""}),u(""),m(""),x("all")},re=()=>{const _=["HBL Number","Air Guide","Status","Classification","Shipper","Consignee","Identity","Phone","City","Commodity","Weight (kg)","Quantity","Bag Number","Reserve Date"],P=S().map(k=>[k.hbl,k.idairguide,k.idguidestate,k.idclasification,k.nameshipper,k.consigneeName,k.cidentity,k.phoneshipper,k.address.city,k.namegood,k.weight,k.quantity,k.bagnumber,new Date(k.datereserve).toLocaleDateString()]),b=[_.join(","),...P.map(k=>k.map(W=>`"${W}"`).join(","))].join(`
`),H=new Blob([b],{type:"text/csv"}),K=URL.createObjectURL(H),R=document.createElement("a");R.href=K,R.download=`HBL_List_${new Date().toISOString().split("T")[0]}.csv`,R.click(),URL.revokeObjectURL(K)},E=()=>{const _=["HBL Number","Air Guide","Air Number","Status","Classification","Shipper","Consignee","Identity","Shipper Phone","Consignee Phone","Street","City","State","Commodity","Weight (kg)","Quantity","Bag Number","Agency","Guide","Reserve Date"];S().map(k=>[k.hbl,k.idairguide,k.idairnumber,k.idguidestate,k.idclasification,k.nameshipper,k.consigneeName,k.cidentity,k.phoneshipper,k.ctelephone,k.street,k.address.city,k.address.estate,k.namegood,k.weight,k.quantity,k.bagnumber,k.agency,k.guia,new Date(k.datereserve).toLocaleDateString()]);const P=S().map(k=>[k.hbl,k.idclasification,k.idairguide,k.idairnumber,k.idguidestate,k.nameshipper,k.consigneeName,k.cidentity,k.phoneshipper,k.ctelephone,k.street,k.address.city,k.address.estate,k.namegood,k.weight,k.quantity,k.bagnumber,k.agency,k.guia,new Date(k.datereserve).toLocaleDateString()]),b=[_.join("	"),...P.map(k=>k.join("	"))].join(`
`),H=new Blob([b],{type:"application/vnd.ms-excel"}),K=URL.createObjectURL(H),R=document.createElement("a");R.href=K,R.download=`HBL_List_${new Date().toISOString().split("T")[0]}.xls`,R.click(),URL.revokeObjectURL(K)},$=()=>{const _=new sr;_.setFontSize(16),_.text("House Bill of Lading List",14,15),_.setFontSize(10),_.text(`Generated: ${new Date().toLocaleString()}`,14,25),_.setFontSize(10);let P=35;r()&&(_.text(`Search: ${r()}`,14,P),P+=5),i()!=="all"&&(_.text(`Status: ${i()}`,14,P),P+=5);const b=["HBL#","Status","Shipper","Consignee","City","Weight","Commodity"],H=S().map(K=>[K.hbl,K.idguidestate,K.nameshipper.substring(0,20)+(K.nameshipper.length>20?"...":""),K.consigneeName.substring(0,20)+(K.consigneeName.length>20?"...":""),K.address.city,K.weight+" kg",K.namegood.substring(0,15)+(K.namegood.length>15?"...":"")]);_.autoTable({head:[b],body:H,startY:P+5,styles:{fontSize:8},headStyles:{fillColor:[0,123,255]}}),_.save(`HBL_List_${new Date().toISOString().split("T")[0]}.pdf`)},T=_=>_?new Date(_).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",B=_=>({"EN BODEGA":"#17a2b8",ENVIADO:"#007bff",ENTREGADO:"#28a745",CANCELADO:"#dc3545",PENDIENTE:"#ffc107"})[_]||"#6c757d";return(()=>{var _=t7(),P=_.firstChild;return a(_,D(Dt,{get children(){var b=e7(),H=b.firstChild,K=H.firstChild,R=H.nextSibling,k=R.firstChild,W=k.firstChild,z=W.nextSibling,U=z.nextSibling,le=U.nextSibling,L=le.nextSibling,M=L.nextSibling;M.nextSibling;var G=k.nextSibling;return b.style.setProperty("padding","1rem"),H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","1fr auto"),H.style.setProperty("gap","1rem"),H.style.setProperty("margin-bottom","1rem"),a(H,D(Ar,{type:"text",get placeholder(){return e("hbl.searchPlaceholder","Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...")},get value(){return r()},onInput:I=>n(I.currentTarget.value)}),K),K.style.setProperty("display","flex"),K.style.setProperty("gap","0.5rem"),a(K,D(ht,{variant:"outline",size:"sm",onClick:()=>f(!g()),get children(){return $e(()=>!!g())()?e("common.hideFilters","Hide Filters"):e("common.showFilters","Show Filters")}}),null),a(K,D(ht,{variant:"outline",size:"sm",onClick:Z,get children(){return e("common.clearFilters","Clear Filters")}}),null),a(b,D(Ge,{get when(){return g()},get children(){var I=ZR(),F=I.firstChild,X=F.firstChild,Y=X.nextSibling,Q=Y.firstChild,J=F.nextSibling,V=J.firstChild,ne=V.nextSibling,ee=ne.firstChild,ce=J.nextSibling,se=ce.firstChild,q=se.nextSibling,ue=q.firstChild,ye=ce.nextSibling,de=ye.firstChild,ge=de.nextSibling,xe=ge.firstChild,pe=ye.nextSibling,_e=pe.firstChild,Re=pe.nextSibling,Ee=Re.firstChild;return I.style.setProperty("display","grid"),I.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),I.style.setProperty("gap","1rem"),I.style.setProperty("margin-bottom","1rem"),I.style.setProperty("padding","1rem"),I.style.setProperty("background","var(--background-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),X.style.setProperty("display","block"),X.style.setProperty("margin-bottom","0.25rem"),X.style.setProperty("font-size","0.875rem"),X.style.setProperty("color","var(--text-muted)"),a(X,()=>e("common.status","Status")),Y.addEventListener("change",Te=>o(Te.currentTarget.value)),Y.style.setProperty("width","100%"),Y.style.setProperty("padding","0.5rem"),Y.style.setProperty("border","1px solid var(--border-color)"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("background","var(--surface-color)"),a(Q,()=>e("common.all","All")),a(Y,D(zt,{get each(){return oe()},children:Te=>(()=>{var Le=Jd();return Le.value=Te,a(Le,Te),Le})()}),null),V.style.setProperty("display","block"),V.style.setProperty("margin-bottom","0.25rem"),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),a(V,()=>e("hbl.classification","Classification")),ne.addEventListener("change",Te=>x(Te.currentTarget.value)),ne.style.setProperty("width","100%"),ne.style.setProperty("padding","0.5rem"),ne.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),ne.style.setProperty("background","var(--surface-color)"),a(ee,()=>e("common.all","All")),a(ne,D(zt,{get each(){return te()},children:Te=>(()=>{var Le=Jd();return Le.value=Te,a(Le,Te),Le})()}),null),se.style.setProperty("display","block"),se.style.setProperty("margin-bottom","0.25rem"),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("color","var(--text-muted)"),a(se,()=>e("hbl.shipper","Shipper")),q.addEventListener("change",Te=>u(Te.currentTarget.value)),q.style.setProperty("width","100%"),q.style.setProperty("padding","0.5rem"),q.style.setProperty("border","1px solid var(--border-color)"),q.style.setProperty("border-radius","var(--border-radius-sm)"),q.style.setProperty("background","var(--surface-color)"),a(ue,()=>e("common.all","All")),a(q,D(zt,{get each(){return C()},children:Te=>(()=>{var Le=Jd();return Le.value=Te,a(Le,Te),Le})()}),null),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.25rem"),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),a(de,()=>e("hbl.consignee","Consignee")),ge.addEventListener("change",Te=>m(Te.currentTarget.value)),ge.style.setProperty("width","100%"),ge.style.setProperty("padding","0.5rem"),ge.style.setProperty("border","1px solid var(--border-color)"),ge.style.setProperty("border-radius","var(--border-radius-sm)"),ge.style.setProperty("background","var(--surface-color)"),a(xe,()=>e("common.all","All")),a(ge,D(zt,{get each(){return j()},children:Te=>(()=>{var Le=Jd();return Le.value=Te,a(Le,Te),Le})()}),null),_e.style.setProperty("display","block"),_e.style.setProperty("margin-bottom","0.25rem"),_e.style.setProperty("font-size","0.875rem"),_e.style.setProperty("color","var(--text-muted)"),a(_e,()=>e("common.dateFrom","Date From")),a(pe,D(Ar,{type:"date",get value(){return s().start},onInput:Te=>l({...s(),start:Te.currentTarget.value})}),null),Ee.style.setProperty("display","block"),Ee.style.setProperty("margin-bottom","0.25rem"),Ee.style.setProperty("font-size","0.875rem"),Ee.style.setProperty("color","var(--text-muted)"),a(Ee,()=>e("common.dateTo","Date To")),a(Re,D(Ar,{type:"date",get value(){return s().end},onInput:Te=>l({...s(),end:Te.currentTarget.value})}),null),we(()=>Y.value=i()),we(()=>ne.value=w()),we(()=>q.value=c()),we(()=>ge.value=h()),I}}),R),R.style.setProperty("display","flex"),R.style.setProperty("justify-content","space-between"),R.style.setProperty("align-items","center"),R.style.setProperty("margin-bottom","1rem"),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),a(k,()=>e("common.showing","Showing"),W),a(k,()=>S().length,z),a(k,()=>e("common.of","of"),le),a(k,()=>t.hbls.length,M),a(k,()=>e("hbl.records","records"),null),G.style.setProperty("display","flex"),G.style.setProperty("gap","0.5rem"),a(G,D(ht,{variant:"outline",size:"sm",onClick:$,get children(){return e("common.print","Print")}}),null),a(G,D(ht,{variant:"outline",size:"sm",onClick:re,get children(){return e("common.exportCSV","Export CSV")}}),null),a(G,D(ht,{variant:"outline",size:"sm",onClick:E,get children(){return e("common.exportExcel","Export Excel")}}),null),b}}),P),P.style.setProperty("margin-top","1rem"),a(P,D(zt,{get each(){return S()},children:b=>D(Dt,{style:{"margin-bottom":"0.5rem"},get children(){var H=r7(),K=H.firstChild,R=K.firstChild,k=R.firstChild,W=k.nextSibling,z=R.nextSibling,U=z.firstChild,le=U.firstChild,L=le.nextSibling,M=U.nextSibling,G=M.firstChild,I=G.nextSibling,F=z.nextSibling,X=F.firstChild,Y=X.nextSibling,Q=K.nextSibling,J=Q.firstChild,V=J.firstChild,ne=V.firstChild,ee=V.nextSibling,ce=J.nextSibling,se=ce.firstChild,q=se.firstChild,ue=se.nextSibling,ye=ce.nextSibling,de=ye.firstChild,ge=de.firstChild,xe=de.nextSibling,pe=ye.nextSibling,_e=pe.firstChild,Re=_e.firstChild,Ee=_e.nextSibling,Te=Ee.firstChild,Le=pe.nextSibling,Ie=Le.firstChild,De=Ie.firstChild,Ye=Ie.nextSibling,Be=Le.nextSibling,We=Be.firstChild,Ke=We.firstChild,st=We.nextSibling;return H.addEventListener("mouseleave",nt=>{nt.currentTarget.style.backgroundColor="transparent"}),H.addEventListener("mouseenter",nt=>{nt.currentTarget.style.backgroundColor="var(--strip-color)"}),H.$$click=()=>t.onHBLSelect?.(b),H.style.setProperty("padding","1rem"),H.style.setProperty("cursor","pointer"),H.style.setProperty("transition","background-color 0.2s"),K.style.setProperty("display","grid"),K.style.setProperty("grid-template-columns","150px 1fr auto"),K.style.setProperty("gap","1rem"),K.style.setProperty("align-items","center"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),a(k,()=>b.hbl),W.style.setProperty("font-size","0.75rem"),W.style.setProperty("color","var(--text-muted)"),a(W,()=>b.idairguide),z.style.setProperty("display","grid"),z.style.setProperty("grid-template-columns","1fr 1fr"),z.style.setProperty("gap","1rem"),le.style.setProperty("font-size","0.75rem"),le.style.setProperty("color","var(--text-muted)"),a(le,()=>e("hbl.shipper","Shipper")),L.style.setProperty("font-weight","500"),a(L,()=>b.nameshipper),G.style.setProperty("font-size","0.75rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>e("hbl.consignee","Consignee")),I.style.setProperty("font-weight","500"),a(I,()=>b.consigneeName),F.style.setProperty("text-align","right"),X.style.setProperty("display","inline-block"),X.style.setProperty("padding","0.25rem 0.75rem"),X.style.setProperty("border-radius","var(--border-radius-sm)"),X.style.setProperty("font-size","0.75rem"),X.style.setProperty("font-weight","500"),X.style.setProperty("color","white"),a(X,()=>b.idguidestate),Y.style.setProperty("font-size","0.75rem"),Y.style.setProperty("color","var(--text-muted)"),Y.style.setProperty("margin-top","0.25rem"),a(Y,()=>T(b.datereserve)),Q.style.setProperty("margin-top","0.75rem"),Q.style.setProperty("display","grid"),Q.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),Q.style.setProperty("gap","0.5rem"),Q.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),a(V,()=>e("hbl.city","City"),ne),ee.style.setProperty("font-weight","500"),a(ee,()=>b.address.city),se.style.setProperty("color","var(--text-muted)"),a(se,()=>e("hbl.classification","Class"),q),ue.style.setProperty("font-weight","500"),a(ue,()=>b.idclasification),de.style.setProperty("color","var(--text-muted)"),a(de,()=>e("hbl.commodity","Commodity"),ge),xe.style.setProperty("font-weight","500"),a(xe,()=>b.namegood),_e.style.setProperty("color","var(--text-muted)"),a(_e,()=>e("hbl.weight","Weight"),Re),Ee.style.setProperty("font-weight","500"),a(Ee,()=>b.weight,Te),Ie.style.setProperty("color","var(--text-muted)"),a(Ie,()=>e("hbl.bagNumber","Bag#"),De),Ye.style.setProperty("font-weight","500"),a(Ye,()=>b.bagnumber),We.style.setProperty("color","var(--text-muted)"),a(We,()=>e("hbl.guideNo","Guide No."),Ke),st.style.setProperty("font-weight","500"),a(st,()=>b.guia),we(nt=>(nt=B(b.idguidestate))!=null?X.style.setProperty("background-color",nt):X.style.removeProperty("background-color")),H}})})),_})()};pr(["click"]);var i7=he("<div><div><label></label><select><option value=all>"),o7=he("<div><div><h2>HBL: </h2><button></button></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong><span></span></div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> <!>, </div><div><strong>:</strong> </div><div><strong>:</strong> <!> kg</div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),s7=he("<div>"),a7=he("<div><div><h1></h1><button>"),l7=he("<option> ");const c7=()=>{const{t}=Zt(),[e,r]=Ce([]),[n,i]=Ce(null),[o,s]=Ce([]),[l,c]=Ce("all"),u=w=>{i(w)},h=w=>{s(w)},m=w=>{c(w),g()},g=async()=>{let w=await Ti.getHBLS("230",{guia:l()});w?.error?r([]):r(Object.values(w))};Cn(()=>{});const f=Lt(()=>{const w=new Set([2516,2517,2518,2519,2520,2521].map(x=>x));return Array.from(w).sort((x,S)=>x-S)});return(()=>{var w=a7(),x=w.firstChild,S=x.firstChild,C=S.nextSibling;return w.style.setProperty("padding","1rem"),x.style.setProperty("margin-bottom","2rem"),x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),S.style.setProperty("font-size","1.5rem"),S.style.setProperty("font-weight","600"),S.style.setProperty("color","var(--text-primary)"),a(S,()=>t("hbl.title","House Bill of Lading Management")),C.style.setProperty("padding","0.75rem 1.5rem"),C.style.setProperty("background","var(--primary-color)"),C.style.setProperty("color","white"),C.style.setProperty("border","none"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("cursor","pointer"),C.style.setProperty("font-weight","500"),a(C,()=>t("hbl.addNew","Add New HBL")),a(w,D(Dt,{get children(){var j=i7(),oe=j.firstChild,te=oe.firstChild,Z=te.nextSibling,re=Z.firstChild;return j.style.setProperty("padding","1rem"),oe.style.setProperty("width","13rem"),te.style.setProperty("display","block"),te.style.setProperty("margin-bottom","0.25rem"),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),a(te,()=>t("hbl.guideNumber","Guide Number")),Z.addEventListener("change",E=>m(E.currentTarget.value)),Z.style.setProperty("width","100%"),Z.style.setProperty("padding","0.5rem"),Z.style.setProperty("border","1px solid var(--border-color)"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),Z.style.setProperty("background","var(--surface-color)"),a(re,()=>t("common.all","All")),a(Z,D(zt,{get each(){return f()},children:E=>(()=>{var $=l7(),T=$.firstChild;return $.value=E,a($,()=>t("hbl.guideNo","Guide No."),T),a($,E,null),$})()}),null),we(()=>Z.value=l()),j}}),null),a(w,D(n7,{get hbls(){return e()},onFilterChange:h,onHBLSelect:u}),null),a(w,D(Ge,{get when(){return n()},get children(){var j=s7();return j.style.setProperty("position","fixed"),j.style.setProperty("top","0"),j.style.setProperty("left","0"),j.style.setProperty("right","0"),j.style.setProperty("bottom","0"),j.style.setProperty("background","rgba(0, 0, 0, 0.5)"),j.style.setProperty("display","flex"),j.style.setProperty("align-items","center"),j.style.setProperty("justify-content","center"),j.style.setProperty("z-index","1000"),a(j,D(Dt,{style:{width:"90%","max-width":"600px","max-height":"90vh","overflow-y":"auto"},get children(){var oe=o7(),te=oe.firstChild,Z=te.firstChild;Z.firstChild;var re=Z.nextSibling,E=te.nextSibling,$=E.firstChild,T=$.firstChild,B=T.firstChild;T.nextSibling;var _=$.nextSibling,P=_.firstChild,b=P.firstChild;P.nextSibling;var H=_.nextSibling,K=H.firstChild,R=K.firstChild,k=K.nextSibling,W=H.nextSibling,z=W.firstChild,U=z.firstChild;z.nextSibling;var le=W.nextSibling,L=le.firstChild,M=L.firstChild;L.nextSibling;var G=le.nextSibling,I=G.firstChild,F=I.firstChild;I.nextSibling;var X=G.nextSibling,Y=X.firstChild,Q=Y.firstChild;Y.nextSibling;var J=X.nextSibling,V=J.firstChild,ne=V.firstChild;V.nextSibling;var ee=J.nextSibling,ce=ee.firstChild,se=ce.firstChild;ce.nextSibling;var q=ee.nextSibling,ue=q.firstChild,ye=ue.firstChild;ue.nextSibling;var de=q.nextSibling,ge=de.firstChild,xe=ge.firstChild,pe=ge.nextSibling,_e=pe.nextSibling;_e.nextSibling;var Re=de.nextSibling,Ee=Re.firstChild,Te=Ee.firstChild;Ee.nextSibling;var Le=Re.nextSibling,Ie=Le.firstChild,De=Ie.firstChild,Ye=Ie.nextSibling,Be=Ye.nextSibling;Be.nextSibling;var We=Le.nextSibling,Ke=We.firstChild,st=Ke.firstChild;Ke.nextSibling;var nt=We.nextSibling,He=nt.firstChild,mt=He.firstChild;He.nextSibling;var ut=nt.nextSibling,at=ut.firstChild,It=at.firstChild;at.nextSibling;var Xe=ut.nextSibling,kt=Xe.firstChild,Tt=kt.firstChild;kt.nextSibling;var wt=Xe.nextSibling,Rt=wt.firstChild,fr=Rt.firstChild;return Rt.nextSibling,oe.style.setProperty("padding","2rem"),te.style.setProperty("display","flex"),te.style.setProperty("justify-content","space-between"),te.style.setProperty("align-items","center"),te.style.setProperty("margin-bottom","1.5rem"),Z.style.setProperty("font-size","1.25rem"),Z.style.setProperty("font-weight","600"),a(Z,()=>n().hbl,null),re.$$click=()=>i(null),re.style.setProperty("background","none"),re.style.setProperty("border","none"),re.style.setProperty("font-size","1.5rem"),re.style.setProperty("cursor","pointer"),re.style.setProperty("color","var(--text-muted)"),E.style.setProperty("display","grid"),E.style.setProperty("gap","1rem"),a(T,()=>t("hbl.airGuide","Air Guide"),B),a($,()=>n().idairguide,null),a(P,()=>t("hbl.airNumber","Air Number"),b),a(_,()=>n().idairnumber,null),a(K,()=>t("hbl.status","Status"),R),k.style.setProperty("margin-left","0.5rem"),k.style.setProperty("padding","0.25rem 0.75rem"),k.style.setProperty("border-radius","var(--border-radius-sm)"),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","white"),a(k,()=>n().idguidestate),a(z,()=>t("hbl.classification","Classification"),U),a(W,()=>n().idclasification,null),a(L,()=>t("hbl.shipper","Shipper"),M),a(le,()=>n().nameshipper,null),a(I,()=>t("hbl.shipperPhone","Shipper Phone"),F),a(G,()=>n().phoneshipper,null),a(Y,()=>t("hbl.consignee","Consignee"),Q),a(X,()=>n().consigneeName,null),a(V,()=>t("hbl.consigneePhone","Consignee Phone"),ne),a(J,()=>n().ctelephone,null),a(ce,()=>t("hbl.identity","Identity"),se),a(ee,()=>n().cidentity,null),a(ue,()=>t("hbl.address","Address"),ye),a(q,()=>n().street,null),a(ge,()=>t("hbl.city","City"),xe),a(de,()=>n().address.city,_e),a(de,()=>n().address.estate,null),a(Ee,()=>t("hbl.commodity","Commodity"),Te),a(Re,()=>n().namegood,null),a(Ie,()=>t("hbl.weight","Weight"),De),a(Le,()=>n().weight,Be),a(Ke,()=>t("hbl.quantity","Quantity"),st),a(We,()=>n().quantity,null),a(He,()=>t("hbl.bagNumber","Bag Number"),mt),a(nt,()=>n().bagnumber,null),a(at,()=>t("hbl.agency","Agency"),It),a(ut,()=>n().agency,null),a(kt,()=>t("hbl.guide","Guide"),Tt),a(Xe,()=>n().guia,null),a(Rt,()=>t("hbl.reserveDate","Reserve Date"),fr),a(wt,()=>new Date(n().datereserve).toLocaleDateString(),null),we(ze=>(ze=n().idguidestate==="ENTREGADO"?"#28a745":n().idguidestate==="ENVIADO"?"#17a2b8":n().idguidestate==="EN BODEGA"?"#007bff":"#6c757d")!=null?k.style.setProperty("background-color",ze):k.style.removeProperty("background-color")),oe}})),j}}),null),w})()};pr(["click"]);var u7=he("<div>$124,350"),d7=he("<div>+12% from last month"),h7=he("<div>247"),ic=he("<div>"),p7=he("<div>18"),f7=he("<div>$89,250"),m7=he("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const y7=()=>{const{t}=Zt(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return D(lo,{get title(){return t("dashboard.title")},get children(){return[(()=>{var o=ic();return y(o,e),a(o,D(Dt,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var s=u7();return we(l=>y(s,n,l)),s})(),(()=>{var s=d7();return we(l=>y(s,i,l)),s})()]}}),null),a(o,D(Dt,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var s=h7();return we(l=>y(s,n,l)),s})(),(()=>{var s=ic();return a(s,()=>t("dashboard.newHires")),we(l=>y(s,i,l)),s})()]}}),null),a(o,D(Dt,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var s=p7();return we(l=>y(s,n,l)),s})(),(()=>{var s=ic();return a(s,()=>t("dashboard.totalOutstanding")),we(l=>y(s,i,l)),s})()]}}),null),a(o,D(Dt,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var s=f7();return we(l=>y(s,n,l)),s})(),(()=>{var s=ic();return a(s,()=>t("dashboard.lastUpdatedToday")),we(l=>y(s,i,l)),s})()]}}),null),o})(),(()=>{var o=ic();return y(o,r),a(o,D(Dt,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var s=ic();return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","1rem"),a(s,D(ht,{variant:"primary",get children(){return t("invoices.createNew")}}),null),a(s,D(ht,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),a(s,D(ht,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),s}}),null),a(o,D(Dt,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var s=m7(),l=s.firstChild,c=l.firstChild,u=c.nextSibling,h=l.nextSibling,m=h.firstChild,g=m.nextSibling,f=h.nextSibling,w=f.firstChild,x=w.nextSibling;return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","0.75rem"),l.style.setProperty("border-bottom","1px solid var(--border-color)"),l.style.setProperty("padding-bottom","0.5rem"),c.style.setProperty("font-weight","500"),a(c,()=>t("dashboard.invoicePaid")),u.style.setProperty("font-size","0.875rem"),u.style.setProperty("color","var(--text-muted)"),a(u,()=>t("dashboard.hoursAgo")),h.style.setProperty("border-bottom","1px solid var(--border-color)"),h.style.setProperty("padding-bottom","0.5rem"),m.style.setProperty("font-weight","500"),a(m,()=>t("dashboard.newEmployeeOnboarded")),g.style.setProperty("font-size","0.875rem"),g.style.setProperty("color","var(--text-muted)"),a(g,()=>t("dashboard.dayAgo")),w.style.setProperty("font-weight","500"),a(w,()=>t("dashboard.monthlyReportGenerated")),x.style.setProperty("font-size","0.875rem"),x.style.setProperty("color","var(--text-muted)"),a(x,()=>t("dashboard.daysAgo")),s}}),null),o})(),D(Ge,{get when(){return lr.hasPermission("invoiceAccess")},get children(){return D(y6,{})}})]}})};var db=he("<div>"),g7=he("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),v7=he("<div><h3>Store Access</h3><div></div><div>No store access granted"),b7=he("<div><h3>Permissions</h3><div>"),_7=he('<div><div><input type=text placeholder="Search users..."></div><div>'),S7=he("<div> You need administrator privileges to access this page."),P7=he("<div>Loading users..."),w7=he("<div><div></div><div></div><div> stores"),x7=he("<div>Select a user to view and edit their profile"),A7=he("<div><input type=checkbox><label>"),C7=he("<div><input type=checkbox><div><div></div><div>");const I7=()=>{const[t,e]=Ce([]),[r,n]=Ce(null),[i,o]=Ce(!1),[s,l]=Ce(!1),[c,u]=Ce(""),[h,m]=Ce(null),g=[{id:"YY_8802",name:"Store 8802"},{id:"YY_8803",name:"Store 8803"},{id:"YY_8804",name:"Store 8804"},{id:"YY_8805",name:"Store 8805"},{id:"YY_8816",name:"Store 8816"},{id:"YY_8818",name:"Store 8818"},{id:"YY_8847",name:"Store 8847"},{id:"YY_3251",name:"Store 3251"},{id:"YY_32",name:"Store 32"},{id:"YY_76",name:"Store 76"},{id:"YY_79",name:"Store 79"},{id:"YY_8635",name:"Store 8635"},{id:"YY_8665",name:"Store 8665"},{id:"YY_8901",name:"Store 8901"}],f=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"invoiceAccess",label:"invoice Access",description:"Access to Invoices"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let w={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,invoiceAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};Cn(async()=>{await x()});const x=async()=>{try{o(!0);const b=sI(_m,"users"),H=bI(b,_I("createdAt","desc")),K=await AI(H),R=[];K.forEach(k=>{let W=k.data();Object.keys(w).map(z=>{let U=w?.[z];W.hasOwnProperty(z)||(W[z]=U)}),R.push({uid:k.id,...W})}),e(R)}catch(b){console.error("Error loading users:",b),m({type:"error",text:"Failed to load users"})}finally{o(!1)}},S=Lt(()=>{const b=c().toLowerCase();return b?t().filter(H=>H.email?.toLowerCase().includes(b)||H.displayName?.toLowerCase().includes(b)||H.uid?.toLowerCase().includes(b)):t()}),C=b=>{r()&&n(H=>({...H,stores:{...H.stores,[b]:!H.stores[b]}}))},j=b=>{r()&&n(H=>({...H,[b]:!H[b]}))};Lt(()=>r()?r().stores&&Object.values(r().stores).some(b=>b):!1);const oe=async()=>{if(r())try{l(!0),m(null);const b=y5(_m,"users",r().uid);let H={stores:r().stores,AccountAccess:r().AccountAccess,BankingAccess:r().BankingAccess,InventoryAccess:r().InventoryAccess,invoiceAccess:r().invoiceAccess,JournalAccess:r().JournalAccess,inventoryDownsection:r().inventoryDownsection,onlyRead:r().onlyRead,read_write:r().read_write,isAdmin:r().isAdmin||!1};await C5(b,H),e(K=>K.map(R=>R.uid===r().uid?r():R)),m({type:"success",text:"User profile updated successfully"})}catch(b){console.error("Error saving user profile:",b),m({type:"error",text:"Failed to save user profile"})}finally{l(!1)}},te={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},Z={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},re=b=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:b?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),E={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},$={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},T={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},B={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},_=b=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:b==="success"?"#d4edda":"#f8d7da",color:b==="success"?"#155724":"#721c24",border:`1px solid ${b==="success"?"#c3e6cb":"#f5c6cb"}`}),P=Lt(()=>lr.state.profile?.isAdmin===!0);return D(lo,{title:"User Profile Administration",get children(){return D(Ge,{get when(){return P()},get fallback(){return D(Dt,{get children(){var b=S7();return b.style.setProperty("text-align","center"),b.style.setProperty("padding","2rem"),b.style.setProperty("color","var(--text-muted)"),b}})},get children(){var b=_7(),H=b.firstChild,K=H.firstChild,R=H.nextSibling;return y(b,te),y(H,Z),K.$$input=k=>u(k.currentTarget.value),y(K,E),a(H,D(Ge,{get when(){return!i()},get fallback(){return(()=>{var k=P7();return k.style.setProperty("padding","2rem"),k.style.setProperty("text-align","center"),k})()},get children(){return D(zt,{get each(){return S()},children:k=>(()=>{var W=w7(),z=W.firstChild,U=z.nextSibling,le=U.nextSibling,L=le.firstChild;return W.$$click=()=>n(k),z.style.setProperty("font-weight","600"),a(z,()=>k.displayName||"No Name"),U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),a(U,()=>k.email),le.style.setProperty("font-size","0.75rem"),le.style.setProperty("color","var(--text-muted)"),le.style.setProperty("margin-top","0.25rem"),a(le,()=>k.isAdmin&&" Admin  ",L),a(le,()=>Object.values(k.stores||{}).filter(Boolean).length,L),we(M=>y(W,re(r()?.uid===k.uid),M)),W})()})}}),null),a(R,D(Ge,{get when(){return r()},get fallback(){return D(Dt,{get children(){var k=x7();return k.style.setProperty("text-align","center"),k.style.setProperty("padding","2rem"),k.style.setProperty("color","var(--text-muted)"),k}})},get children(){return[D(Ge,{get when(){return h()},get children(){var k=db();return a(k,()=>h().text),we(W=>y(k,_(h().type),W)),k}}),D(Dt,{title:"User Information",get subtitle(){return r().email},get children(){return[(()=>{var k=g7(),W=k.firstChild,z=W.firstChild,U=z.firstChild;U.nextSibling;var le=z.nextSibling,L=le.firstChild;L.nextSibling;var M=W.nextSibling,G=M.firstChild;return G.nextSibling,k.style.setProperty("margin-bottom","2rem"),W.style.setProperty("display","flex"),W.style.setProperty("justify-content","space-between"),W.style.setProperty("margin-bottom","1rem"),a(z,()=>r().displayName||"Not set",null),a(le,()=>r().uid,null),a(M,()=>new Date(r().createdAt?.toDate?.()||r().createdAt).toLocaleDateString(),null),k})(),(()=>{var k=v7(),W=k.firstChild,z=W.nextSibling,U=z.nextSibling;return k.style.setProperty("margin-bottom","2rem"),W.style.setProperty("margin-bottom","1rem"),y(z,T),a(z,D(zt,{each:g,children:le=>{let L=ct.getLocationById(le?.id);return(()=>{var M=A7(),G=M.firstChild,I=G.nextSibling;return M.$$click=()=>C(le?.id),G.style.setProperty("cursor","pointer"),I.style.setProperty("cursor","pointer"),I.style.setProperty("user-select","none"),a(I,()=>L?.name),we(F=>y(M,{...B,background:r().stores?.[le?.id]?"var(--primary-color-light)":"transparent"},F)),we(()=>G.checked=r().stores?.[le?.id]||!1),M})()}})),U.style.setProperty("margin-top","0.5rem"),U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),k})(),(()=>{var k=b7(),W=k.firstChild,z=W.nextSibling;return k.style.setProperty("margin-bottom","2rem"),W.style.setProperty("margin-bottom","1rem"),y(z,$),a(z,D(zt,{each:f,children:U=>(()=>{var le=C7(),L=le.firstChild,M=L.nextSibling,G=M.firstChild,I=G.nextSibling;return le.$$click=()=>j(U.key),L.style.setProperty("cursor","pointer"),M.style.setProperty("flex","1"),M.style.setProperty("cursor","pointer"),M.style.setProperty("user-select","none"),G.style.setProperty("font-weight","500"),a(G,()=>U.label),I.style.setProperty("font-size","0.75rem"),I.style.setProperty("color","var(--text-muted)"),a(I,()=>U.description),we(F=>y(le,{...B,background:r()[U.key]?"var(--primary-color-light)":"transparent"},F)),we(()=>L.checked=!!r()[U.key]),le})()})),k})(),(()=>{var k=db();return k.style.setProperty("display","flex"),k.style.setProperty("gap","1rem"),k.style.setProperty("justify-content","flex-end"),a(k,D(ht,{variant:"secondary",onClick:()=>n(null),children:"Cancel"}),null),a(k,D(ht,{variant:"primary",onClick:oe,get disabled(){return s()},get children(){return s()?"Saving...":"Save Changes"}}),null),k})()]}})]}})),we(()=>K.value=c()),b}})}})};pr(["input","click"]);const $7=async()=>{try{console.log("Testing PDF generation...");const e=(await Ji(()=>Promise.resolve().then(()=>r_),void 0)).default;console.log("jsPDF imported successfully");const r=new e;console.log("PDF document created"),r.setFontSize(20),r.text("Test PDF",20,20),r.setFontSize(12),r.text("This is a test PDF to verify the library works.",20,40),console.log("Text added to PDF"),r.save("test.pdf"),console.log("PDF saved successfully"),alert("Test PDF generated successfully!")}catch(t){console.error("Test PDF generation failed:",t),alert(`Test PDF failed: ${t.message}`)}},Lf=(t,e)=>{try{console.log("Generating printable PDF...");const r=window.open("","_blank","width=800,height=600");if(!r){alert("Please allow popups to generate PDF");return}const n=t.shipper_consignee||{};let i=ct.getLocationById(t?.store);const o=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Invoice ${t.invoice||"N/A"}</title>
        <style>
          body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
          }
          .header {
            display: flex;
            justify-content: space-between;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
          }
          .company {
            font-size: 24px;
            font-weight: bold;
            color: #2563eb;
          }
          .invoice-info {
            text-align: right;
          }
          .section {
            margin: 20px 0;
          }
          .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
          }
          .customer-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
             font-size: 13px;
          }
          .flex{
            display: flex;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
          }
          th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
          }
          th {
            background-color: #f2f2f2;
            font-weight: bold;
            font-size: 13px;
          }
          td{
           font-size: 12px;
          }
          .total-row {
            font-weight: bold;
            font-size: 16px;
            background-color: #e8f4fd;
          }
          .certification-section {
            page-break-inside: avoid;
            break-inside: avoid;
            orphans: 3;
            widows: 3;
          }
          .page-break-before {
            page-break-before: always;
            break-before: page;
          }
          @media print {
            body { margin: 0; }
            .no-print { display: none; }
            .certification-section {
              page-break-inside: avoid !important;
              break-inside: avoid !important;
              orphans: 3;
              widows: 3;
            }
            .page-break-before {
              page-break-before: always !important;
              break-before: page !important;
            }
            /* Force page break if certification section would be split */
            @page {
              margin: 0.5in;
              orphans: 3;
              widows: 3;
            }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div>
            <div class="company">HRM FINANCE</div>
            <div>${e("common.store")}: ${i?.name||t?.store||"N/A"}</div>
            <div>${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}</div>
            ${t.shippingMethod?`<div>${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}</div>`:""}
          </div>
          <div class="invoice-info">
            <div style="font-size: 18px; font-weight: bold;">${e("common.invoice").toUpperCase()}</div>
            <div style="font-size: 16px; margin: 5px 0;">${t.invoice||"N/A"}</div>
            <div>${t.createDate?new Date(t.createDate).toLocaleDateString():"N/A"}</div>
            <div style="margin-top: 10px;">
              <span style="padding: 4px 8px; background: ${t.isCompleted?"#d4edda":"#fff3cd"}; border-radius: 10px; font-size: 12px;">
                ${t.isCompleted?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()}
              </span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="customer-info">
            <div><strong>${e("invoices.senderInformation")}:</strong> ${n.name||"N/A"}</div>
            ${n.phoneNumberS?`<div><strong>${e("invoices.phoneNumber")}:</strong> ${n.phoneNumberS}</div>`:""}
          
          </div>
          <div class="customer-info">
            <div><strong>${e("invoices.receiptInformation")}:</strong> ${[n.firstName,n.middleName,n.lastName,n.lastName2].filter(Boolean).join(" ")||"N/A"}</div>
            <div><strong>${e("invoices.phoneNumber")}:</strong> ${n.phoneNumber||"N/A"}</div>
            <div><strong>${e("invoices.id")}:</strong> ${n.cid||"N/A"}</div>
            ${n.address?`<div><strong>${e("invoices.address")}:</strong> ${n.address}</div>`:""}
          </div>
        </div>

        ${t.products&&t.products.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.products")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.code")}</th>
                <th>${e("invoices.description")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.products.map(s=>`
                <tr>
                  <td>${s.product?.code||"N/A"}</td>
                  <td>${s.product?.label||"N/A"}</td>
                  <td>${Math.abs(s.qty||0)}</td>
                  <td>$${parseFloat(s.salePrice||0).toFixed(2)}</td>
                  <td>$${(s.total||Math.abs(s.qty||0)*parseFloat(s.salePrice||0)).toFixed(2)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        ${t.reservas&&t.reservas.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.reservations")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.type")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.arancel")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.reservas.map(s=>{const l=parseFloat(s.qty||0),c=parseFloat(s.price||0),u=parseFloat(s.arancel||0),h=s.total||l*c+u;return`
                  <tr>
                    <td>${s.type||"N/A"}</td>
                    <td>${l.toFixed(2)}</td>
                    <td>$${c.toFixed(2)}</td>
                    <td>$${u.toFixed(2)}</td>
                    <td>$${h.toFixed(2)}</td>
                  </tr>
                `}).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        <div class="section flex">
          ${t.paymentMethods?`
        <div class="section" style="margin-right: auto; width: 48%">
          <div class="section-title">${e("common.paymentMethods")}</div>
          <div class="customer-info">
            ${t.paymentMethods.cash>0?`<div><strong> ${e("common.cash")}:</strong> $${t.paymentMethods.cash.toFixed(2)}</div>`:""}
            ${t.paymentMethods.zelle>0?`<div><strong> Zelle:</strong> $${t.paymentMethods.zelle.toFixed(2)}</div>`:""}
            ${t.paymentMethods.creditCard>0?`<div><strong> ${e("common.creditCard")}:</strong> $${t.paymentMethods.creditCard.toFixed(2)}</div>`:""}
            ${t.paymentMethods.exemptTaxOnCash&&t.paymentMethods.cash>0&&t.taxSavings>0?`
              <div style="margin-top: 10px; padding: 8px; background-color: #e7f5ff; border-radius: 4px; font-size: 12px; font-style: italic;">
                * ${e("common.taxExemptNote")} ${e("common.youSaved")} $${t.taxSavings.toFixed(2)}!
              </div>
            `:""}
          </div>
        </div>
        `:""}
        <div class="section ">
          <table style="margin-left: auto; width: width: 48%">
            ${t.productSubtotal?`
            <tr>
              <td><strong>${e("invoices.productsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.productSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.reservaSubtotal?`
            <tr>
              <td><strong>${e("invoices.reservationsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.reservaSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.taxAmount&&t.taxAmount>0?`
            <tr>
              <td><strong>${e("common.subtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.subtotalBeforeTax||0).toFixed(2)}</strong></td>
            </tr>
            <tr>
              <td><strong>${e("common.tax")} (${t.paymentMethods?.taxPercent||7}%):</strong></td>
              <td style="text-align: right;"><strong>$${t.taxAmount.toFixed(2)}</strong></td>
            </tr>
            `:""}
            <tr class="total-row">
              <td><strong>${e("invoices.total").toUpperCase()}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.total||0).toFixed(2)}</strong></td>
            </tr>
          </table>
        </div>
        </div>
        
       

        <!-- Certification Section -->
        <div class="certification-section" style="margin-top: 40px; padding: 20px; border: 2px solid #333; background: #f9f9f9;">
          <div style="text-align: center; font-weight: bold; font-size: 14px; margin-bottom: 15px; text-transform: uppercase;">
            CERTIFICACIN DEL EMBARCADOR
          </div>
          <div style="font-size: 11px; line-height: 1.4; text-align: justify; margin-bottom: 20px;">
            <p><strong>Certifico que no envo sustancias ni productos prohibidos por las leyes y las aduanas de USA y Cuba, como por ejemplo:</strong> drogas, armas, explosivos, cigarrillos electrnicos, drones profesionales, joyas, prendas, dinero en efectivo, semillas, narcticos, frmacos controlados, productos agrcolas de tipo herbicidas o antifngicidas, ningn tipo de producto perecedero que necesite refrigeracin.</p>
            
            <p><strong>Entiendo que al llenar este formulario, al enviar alguna de las sustancias o productos antes descritos mi carga puede ser decamisada completa o parcialmente por las aduanas de Cuba o USA sin derecho a reclamo ni compensacin,</strong> de parte ma como embarcador, ni de la persona a quien envo (consignatario).</p>
            
           </div>
          
          <!-- Signature Section -->
          <div style="display: flex; justify-content: space-between; margin-top: 30px;">
            <div style="width: 45%; text-align: center;">
              <div style="border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px;"></div>
              <div style="font-size: 10px; font-weight: bold;">FIRMA DEL EMBARCADOR / SHIPPER SIGNATURE</div>
              <div style="font-size: 10px; margin-top: 5px;">${n.name||"N/A"}</div>
            </div>
            <div style="width: 45%; text-align: center;">
              <div style="border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px;"></div>
              <div style="font-size: 10px; font-weight: bold;">FECHA / DATE</div>
              <div style="font-size: 10px; margin-top: 5px;">${new Date().toLocaleDateString()}</div>
            </div>
          </div>
        </div>

        <div style="margin-top: 40px; text-align: center; color: #666; font-size: 12px;">
          <p>${e("common.thankForChoosingUs")}</p>
          <p>${e("common.generatedOn")} ${new Date().toLocaleDateString()}</p>
        </div>

        <script>
          // Check if certification section needs page break
          function checkCertificationPageBreak() {
            const certSection = document.querySelector('.certification-section');
            if (!certSection) return;
            
            // Reset any previous page break class to get accurate measurements
            certSection.classList.remove('page-break-before');
            
            // Force a layout recalculation
            certSection.offsetHeight;
            
            const rect = certSection.getBoundingClientRect();
            const certHeight = rect.height;
            const certTop = rect.top;
            
            // Estimate print page height (assuming standard letter size at 96 DPI)
            // Standard letter: 11 inches - 1 inch margins = 10 inches usable
            // At 96 DPI: 10 * 96 = 960px usable height per page
            const printPageHeight = 960;
            const pageMargin = 48; // 0.5 inch margins
            
            // Calculate current position on the page
            const currentPagePosition = certTop % printPageHeight;
            const remainingPageSpace = printPageHeight - currentPagePosition - pageMargin;
            
            // Add some buffer space (50px) to ensure comfortable fit
            const requiredSpace = certHeight + 50;
            
            false && console.log('Certification section analysis:', {
              certHeight,
              certTop,
              currentPagePosition,
              remainingPageSpace,
              requiredSpace,
              needsPageBreak: requiredSpace > remainingPageSpace
            });
            
            // Only add page break if certification truly won't fit
            if (requiredSpace > remainingPageSpace && remainingPageSpace < printPageHeight * 0.4) {
              // console.log('Adding page break for certification section');
              certSection.classList.add('page-break-before');
            }
          }
          
          // Run check when page loads and before printing
          document.addEventListener('DOMContentLoaded', function() {
            // Delay to ensure all content is rendered
            setTimeout(checkCertificationPageBreak, 100);
          });
          window.addEventListener('beforeprint', checkCertificationPageBreak);
        <\/script>

        <div class="no-print" style="margin-top: 30px; text-align: center;">
          <button onclick="window.print()" style="padding: 10px 20px; font-size: 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
            ${e("common.printSavePDF")}
          </button>
          <button onclick="window.close()" style="padding: 10px 20px; font-size: 16px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">
            ${e("common.close")}
          </button>
        </div>
      </body>
      </html>
    `;r.document.write(o),r.document.close(),r.focus(),console.log("Printable PDF window opened")}catch(r){console.error("Error generating printable PDF:",r),alert("Error generating printable PDF: "+r.message)}},E7=async(t,e)=>{try{console.log("Starting professional PDF generation...");const n=(await Ji(()=>Promise.resolve().then(()=>r_),void 0)).default,i=new n,o=210,s=297,l=15,c=o-l*2,u={r:180,g:180,b:180},h={r:80,g:80,b:80},m={r:130,g:130,b:130},g={r:248,g:248,b:248},f={r:252,g:252,b:252},w={r:120,g:120,b:120},x={r:150,g:150,b:150};let S=l;const C=ne=>{i.setTextColor(ne.r,ne.g,ne.b)},j=ne=>{i.setFillColor(ne.r,ne.g,ne.b)},oe=(ne,ee,ce,se,q,ue=!1)=>{i.roundedRect(ne,ee,ce,se,q,q,ue?"F":"S")};j(f),i.rect(0,0,o,50,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.5),i.line(0,50,o,50),C(h),i.setFontSize(32),i.setFont("helvetica","bold"),i.text("HRM",l,25),C(m),i.setFontSize(32),i.setFont("helvetica","normal");const te=i.getTextWidth("HRM ");i.text("FINANCE",l+te,25),C(m),i.setFontSize(9),i.setFont("helvetica","normal"),i.text("Professional Business Solutions",l,35);const Z=70,re=o-l-Z;i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.5),oe(re,12,Z,26,2,!1),C(h),i.setFontSize(14),i.setFont("helvetica","bold");const E=e("common.invoice").toUpperCase(),$=i.getTextWidth(E);i.text(E,re+(Z-$)/2,22),i.setFontSize(11),i.setFont("helvetica","normal");const T=t.invoice||"N/A",B=i.getTextWidth(T);i.text(T,re+(Z-B)/2,32),S=60,j(f),i.rect(0,50,o,20,"F");const _=t.isCompleted,P=_?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase();C(_?h:m),i.setFontSize(8),i.setFont("helvetica","bold"),i.text(`STATUS: ${P}`,l,58),C(m),i.setFontSize(9),i.setFont("helvetica","normal");const H=t.createDate?new Date(t.createDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";i.text(H,o-l-i.getTextWidth(H),58),S=58,i.text(`${e("common.store")}: ${t.store||"N/A"}`,l+60,S),S+=5,i.text(`${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}`,l+60,S),t.shippingMethod&&i.text(`${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}`,o-l-50,S),S=80,C(h),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.customerInformation"),l,S),S+=10;const K=45,R=10,k=(c-R)/2;j(f),oe(l,S,k,K,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),oe(l,S,k,K,3);const W=t.shipper_consignee||{};let z=S+8;C(m),i.setFontSize(9),i.text(e("invoices.senderInformation"),l+5,z),z+=7,C(h),i.setFontSize(11),i.setFont("helvetica","bold"),i.text(W.name||"N/A",l+5,z),W.phoneNumberS&&(z+=6,i.setFont("helvetica","normal"),i.setFontSize(9),C(m),i.text(`${e("invoices.altPhone")}: ${W.phoneNumberS}`,l+5,z)),j(f),oe(l+k+R,S,k,K,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),oe(l+k+R,S,k,K,3),z=S+8,C(m),i.setFontSize(9),i.text(e("invoices.receiptInformation"),l+k+R+5,z),z+=7;const U=[W.firstName,W.middleName,W.lastName,W.lastName2].filter(Boolean).join(" ")||"N/A";if(C(h),i.setFontSize(11),i.setFont("helvetica","bold"),i.text(U,l+k+R+5,z),z+=6,i.setFont("helvetica","normal"),i.setFontSize(9),C(m),i.text(`${e("invoices.phoneNumber")}: ${W.phoneNumber||"N/A"}`,l+k+R+5,z),z+=5,i.text(`${e("invoices.id")}: ${W.cid||"N/A"}`,l+k+R+5,z),W.address)z+=5,W.address.split(",").map(ee=>ee.trim()).forEach((ee,ce)=>{ce<2&&ee&&(i.text(ee,l+k+R+5,z),z+=5)});else{let ne=`${W.ybstreet||""} #${W.ybstreetNo||""} ${e("invoices.between")} ${W.ybbetwen1||""} ${e("invoices.and")} ${W.ybbetwen2||""}`,ee=`${W.ybreparto||""}, ${W.ybcity||""}, ${W.ybestate||""}`;z+=5,i.text(ne,l+k+R+5,z),z+=5,i.text(ee,l+k+R+5,z)}if(S+=K+15,t?.products&&t?.products?.length>0){C(h),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.products"),l,S),S+=10,j(g),i.rect(l,S-6,c,10,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(l,S+4,o-l,S+4),i.setFontSize(9),i.setFont("helvetica","bold"),C(h);const ne={code:l+5,description:l+35,qty:l+115,price:l+135,total:l+160};i.text(e("invoices.code"),ne.code,S),i.text(e("invoices.description"),ne.description,S),i.text(e("invoices.qty"),ne.qty,S),i.text(e("invoices.unitPrice"),ne.price,S),i.text(e("invoices.total"),ne.total,S),S+=10,i.setFont("helvetica","normal"),i.setFontSize(9),t.products.forEach((ee,ce)=>{S>250&&(i.addPage(),S=l),ce%2===0&&(j(f),i.rect(l,S-4,c,8,"F")),C(h),i.text(ee.product?.code||"N/A",ne.code,S);let se=ee.product?.label||"N/A";i.getTextWidth(se)>70&&(se=se.substring(0,40)+"..."),i.text(se,ne.description,S);const q=Math.abs(ee.qty||0),ue=parseFloat(ee.salePrice||0),ye=ee.total||q*ue;i.text(q.toString(),ne.qty,S),i.text(`$${ue.toFixed(2)}`,ne.price,S),i.setFont("helvetica","bold"),i.text(`$${ye.toFixed(2)}`,ne.total,S),i.setFont("helvetica","normal"),S+=8}),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(l,S,o-l,S),S+=15}if(t.reservas&&t.reservas.length>0){S>200&&(i.addPage(),S=l),C(h),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.reservations"),l,S),S+=10,j(g),i.rect(l,S-6,c,10,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(l,S+4,o-l,S+4),i.setFontSize(9),i.setFont("helvetica","bold"),C(h);const ne={type:l+5,qty:l+65,price:l+95,arancel:l+125,total:l+160};i.text(e("invoices.type"),ne.type,S),i.text(e("invoices.qty"),ne.qty,S),i.text(e("invoices.unitPrice"),ne.price,S),i.text(e("invoices.arancel"),ne.arancel,S),i.text(e("invoices.total"),ne.total,S),S+=10,i.setFont("helvetica","normal"),i.setFontSize(9),t.reservas.forEach((ee,ce)=>{S>250&&(i.addPage(),S=l),ce%2===0&&(j(f),i.rect(l,S-4,c,8,"F")),C(h),i.text(ee.type||"N/A",ne.type,S);const se=parseFloat(ee.qty||0),q=parseFloat(ee.price||0),ue=parseFloat(ee.arancel||0),ye=ee.total||se*q+ue;i.text(se.toString(),ne.qty,S),i.text(`$${q.toFixed(2)}`,ne.price,S),i.text(`$${ue.toFixed(2)}`,ne.arancel,S),i.setFont("helvetica","bold"),i.text(`$${ye.toFixed(2)}`,ne.total,S),i.setFont("helvetica","normal"),S+=8}),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(l,S,o-l,S),S+=15}S>210&&(i.addPage(),S=l);const le=o-l-80,L=80;let M=60;t.taxAmount&&t.taxAmount>0&&(M+=16),j(f),oe(le-10,S,L+10,M,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),oe(le-10,S,L+10,M,3);let G=S+10;if(i.setFontSize(10),C(m),t.productSubtotal!==void 0&&t.productSubtotal>0&&(i.text(e("invoices.productsSubtotal"),le,G),i.text(`$${t.productSubtotal.toFixed(2)}`,le+L-15,G,{align:"right"}),G+=8),t.reservaSubtotal!==void 0&&t.reservaSubtotal>0&&(i.text(e("invoices.reservationsSubtotal"),le,G),i.text(`$${t.reservaSubtotal.toFixed(2)}`,le+L-15,G,{align:"right"}),G+=8),t.taxAmount&&t.taxAmount>0){i.text(e("common.subtotal"),le,G),i.text(`$${(t.subtotalBeforeTax||0).toFixed(2)}`,le+L-15,G,{align:"right"}),G+=8;const ne=t.paymentMethods?.taxPercent||7;i.text(`${e("common.tax")} (${ne}%)`,le,G),i.text(`$${t.taxAmount.toFixed(2)}`,le+L-15,G,{align:"right"}),G+=8}if(i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(le,G+2,le+L-10,G+2),G+=10,i.setFontSize(14),i.setFont("helvetica","bold"),C(h),i.text(e("invoices.total"),le,G),i.text(`$${(t.total||0).toFixed(2)}`,le+L-15,G,{align:"right"}),t.paymentMethods){S+=M+20,C(h),i.setFontSize(12),i.setFont("helvetica","bold"),i.text(e("common.paymentMethods"),l,S),S+=10,i.setFontSize(10),i.setFont("helvetica","normal"),C(m);const ne=t.paymentMethods;let ee=S;ne.cash&&ne.cash>0&&(i.text(`${e("common.cash")}:`,l+5,ee),i.text(`$${ne.cash.toFixed(2)}`,l+50,ee),ee+=6),ne.zelle&&ne.zelle>0&&(i.text("Zelle:",l+5,ee),i.text(`$${ne.zelle.toFixed(2)}`,l+50,ee),ee+=6),ne.creditCard&&ne.creditCard>0&&(i.text(`${e("common.creditCard")}:`,l+5,ee),i.text(`$${ne.creditCard.toFixed(2)}`,l+50,ee),ee+=6),ne.exemptTaxOnCash&&ne.cash>0&&t.taxSavings>0&&(ee+=4,i.setFontSize(9),i.setFont("helvetica","italic"),i.text(`* Tax exempted on cash payment. You saved $${t.taxSavings.toFixed(2)}!`,l+5,ee)),S=ee+10}S=s-30,j(f),i.rect(0,S-10,o,40,"F"),i.setFontSize(12),i.setFont("helvetica","italic"),C(m);const I=e("common.thankYouBusiness"),F=i.getTextWidth(I);i.text(I,(o-F)/2,S),S+=8,i.setFontSize(9),i.setFont("helvetica","normal");const X="www.hrmfinance.com | info@hrmfinance.com | +1 (555) 123-4567",Y=i.getTextWidth(X);i.text(X,(o-Y)/2,S),S+=8,i.setFontSize(8);const Q=`Generated on ${new Date().toLocaleString("en-US")}`,J=i.getTextWidth(Q);i.text(Q,(o-J)/2,S);const V=`invoice-${t.invoice||"unknown"}.pdf`;i.save(V),console.log("Professional PDF saved successfully:",V)}catch(r){throw console.error("Error in generateProfessionalInvoicePDF:",r),r}},xa=t=>parseFloat(t?.toString()||"0")||0,T7=t=>{if(t?.includes("/")){const[e,r,n]=t.split("/");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}if(t?.includes("-")){const[e,r,n]=t.split("-");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}return t},k7=t=>{const e=[];return t.ybstreet&&(e.push(t.ybstreet),t.ybstreetNo&&e.push(`# ${t.ybstreetNo}`)),t.ybbetwen1&&t.ybbetwen2&&e.push(`/ ${t.ybbetwen1} y ${t.ybbetwen2}`),t.ybreparto&&e.push(`, Rpto ${t.ybreparto}`),t.ybcity&&e.push(`, ${t.ybcity}`),t.ybestate&&e.push(`, ${t.ybestate}`),e.join(" ")},hb=t=>{const e=xa(t.qty),r=xa(t.price),n=xa(t.arancel);return t.onlyTariff?n:e*r+n},pb=t=>{const e=Math.abs(t.qty),r=xa(t.salePrice);return e*r},N7=(t,e)=>{const r=t.split("-");if(r.length>=3){const n=r[0];return{YY_8803:"BISSONNET"}[n]||e}return e},fb=t=>{const e=t?.products?.reduce((S,C)=>S+pb(C),0),r=t?.reservas?.reduce((S,C)=>S+hb(C),0),n=e+r,i=7,o=.93,l=n*(1-o)*(i/100),c=n*i/100-l,u=n+l,m=(t?.products||[])?.map((S,C)=>({id:Date.now().toString()+C,product:{id:S.product.id,code:S.product.code,label:S.product.label,price:0},qty:Math.abs(S.qty),salePrice:xa(S.salePrice),total:pb(S)})),g=t?.reservas?.map((S,C)=>({id:Date.now().toString()+C+1e3,type:S.type,qty:xa(S.qty),price:xa(S.price),arancel:xa(S.arancel),total:hb(S)})),f={name:t.shipper_consignee.name,firstName:t.shipper_consignee.firstName,middleName:t.shipper_consignee.middleName||"",lastName:t.shipper_consignee.lastName,lastName2:t.shipper_consignee.lastName2||"",phoneNumber:t.shipper_consignee.phoneNumber,cid:t.shipper_consignee.cid,passport:t.shipper_consignee.passport||"",address:k7(t.shipper_consignee),phoneNumberS:t.shipper_consignee.phoneNumberS,dob:T7(t.shipper_consignee.dob)},w=N7(t.invoice,t.store),x=t.shipper_consignee.shipping?.toLowerCase()==="aereo"?"aereo":"maritimo";return{invoice:t.invoice,description:t.description||"",store:w,shipper_consignee:f,products:m,reservas:g,packagesOrder:t.packagesOrder,shippingMethod:x,paymentMethods:t?.paymentMethods,type:t.type,ssg_inventory_key:t.ssg_inventory_key,ssg_sorder_key:t.ssg_sorder_key,createDate:t.createDate,businessId:t.businessId,isCompleted:t.isCompleted,productSubtotal:e,reservaSubtotal:r,subtotalBeforeTax:n,taxAmount:l,taxSavings:c,total:u,taxCalculationMethod:"subtotal",cashPaymentRatio:o}},[ou,Ur]=Hu({invoices:[],selectedInvoice:null,loading:!1,error:null,lastUpdated:null}),[L7,_o]=Ce({fetchAll:!1,fetchById:!1,create:!1,update:!1,delete:!1,generatePDF:!1}),Gi={get state(){return ou},get loadingStates(){return L7()},async fetchInvoices(t){try{_o(s=>({...s,fetchAll:!0})),Ur("loading",!0),Ur("error",null);let e="SALES";if(t?.search&&(e+=" "+t.search),t?.store&&t.store!=="all")e+=" "+t.store;else if(!lr.state?.profile?.isAdmin)return e+=" "+Yh(32),Ur("invoices",[]),Ur("lastUpdated",new Date),[];t?.status&&t.status!=="all"&&(e+=" "+t.status);const r=e.toString(),n=await Ti.getInvoice(r);let i=[];if(t?.dateFrom&&t?.dateTo){const s=l=>{let c=new Date(n[l].createDate).getTime(),u=new Date(t?.dateFrom).getTime(),h=new Date(t?.dateTo).getTime();c>=u&&c<=h&&i.push(n[l])};Object.keys(n).map(s)}else i=Wf(n);const o=Array.isArray(i)?i:i||[];return Ur("invoices",o),Ur("lastUpdated",new Date),o}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoices";throw Ur("error",r),console.error("Error fetching invoices:",e),e}finally{Ur("loading",!1),_o(e=>({...e,fetchAll:!1}))}},fecthInventory:async t=>{},async fetchInvoiceById(t){try{_o(n=>({...n,fetchById:!0})),Ur("error",null);const e=await Ti.getInvoice(t),r=Wf(e);return Ur("selectedInvoice",r[0]),r}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice";throw Ur("error",r),console.error("Error fetching invoice:",e),e}finally{_o(e=>({...e,fetchById:!1}))}},async createInvoice(t){try{_o(r=>({...r,create:!0})),Ur("error",null);const e={type:t.type||"SALES",invoice:t.invoice,description:t.description||"",store:t.store||"",ssg_inventory_key:t.ssg_inventory_key||`INV-${Date.now()}`,ssg_sorder_key:t.ssg_sorder_key||`SO-${Date.now()}`,createDate:t.createDate||Date.now(),shipper_consignee:t.shipper_consignee,packagesOrder:t.packagesOrder||!1,businessId:t.businessId||"YB100423253156428",userId:t.userId||"current-user",reservas:t.reservas||[],products:t.products||[],isCompleted:t.isCompleted||!0};return e.products&&e.products.length>0&&(e.productSubtotal=e.products.reduce((r,n)=>r+n.qty*n.salePrice,0)),e.reservas&&e.reservas.length>0&&(e.reservaSubtotal=e.reservas.reduce((r,n)=>r+n.total,0)),e.total=(e.productSubtotal||0)+(e.reservaSubtotal||0),Ur("invoices",r=>[e,...r]),Ur("lastUpdated",new Date),e}catch(e){const r=e instanceof Error?e.message:"Failed to create invoice";throw Ur("error",r),console.error("Error creating invoice:",e),e}finally{_o(e=>({...e,create:!1}))}},async generateInvoicePDF(t,e="compact",r="es"){try{_o(l=>({...l,generatePDF:!0})),Ur("error",null);const n=ou.invoices.find(l=>l.invoice===t);if(!n)throw new Error("Invoice not found");let i;switch(e){case"compact":const{generateCompactModernInvoicePDF:l}=await Ji(async()=>{const{generateCompactModernInvoicePDF:h}=await import("./compactModernInvoicePdfGenerator-DJq4HuV0.js");return{generateCompactModernInvoicePDF:h}},[]);i=l;break;case"modern":const{generateModernMovementInvoicePDF:c}=await Ji(async()=>{const{generateModernMovementInvoicePDF:h}=await import("./modernMovementInvoicePdfGenerator-q3i-p4Yd.js");return{generateModernMovementInvoicePDF:h}},[]);i=c;break;case"classic":default:const{generateWorkingInvoicePDF:u}=await Ji(async()=>{const{generateWorkingInvoicePDF:h}=await import("./workingPdfGenerator-Ci8nzGlA.js");return{generateWorkingInvoicePDF:h}},[]);i=u;break}const o={...n,movementType:"sales",items:n.products||[],invoiceId:n.invoice,id:n.invoice};return await i(o,null,r)}catch(n){const i=n instanceof Error?n.message:"Failed to generate PDF";throw Ur("error",i),console.error("Error generating invoice PDF:",n),n}finally{_o(n=>({...n,generatePDF:!1}))}},async updateInvoice(t,e){try{_o(n=>({...n,update:!0})),Ur("error",null);const r={};return Ur("invoices",n=>n.map(i=>i.invoice===t?r:i)),ou.selectedInvoice?.invoice===t&&Ur("selectedInvoice",r),Ur("lastUpdated",new Date),r}catch(r){const n=r instanceof Error?r.message:"Failed to update invoice";throw Ur("error",n),console.error("Error updating invoice:",r),r}finally{_o(r=>({...r,update:!1}))}},async deleteInvoice(t){try{_o(i=>({...i,delete:!0})),Ur("error",null),Ur("invoices",i=>i.filter(o=>o.invoice!==t)),ou.selectedInvoice?.invoice===t&&Ur("selectedInvoice",null),Ur("lastUpdated",new Date);const n=await Fi({query:"deleteYabaSalesOrders",params:{businessId:"YB100423253156428",id:t}});return!0}catch(e){const r=e instanceof Error?e.message:"Failed to delete invoice";throw Ur("error",r),console.error("Error deleting invoice:",e),e}finally{_o(e=>({...e,delete:!1}))}},async fetchInvoiceStats(t){try{Ur("error",null);const e=new URLSearchParams;t?.store&&t.store!=="all"&&e.append("store",t.store),t?.dateFrom&&e.append("dateFrom",t.dateFrom),t?.dateTo&&e.append("dateTo",t.dateTo);const r=e.toString();return[]}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice statistics";throw Ur("error",r),console.error("Error fetching invoice stats:",e),e}},async fetchStores(){try{return Ur("error",null),[]}catch(t){const e=t instanceof Error?t.message:"Failed to fetch stores";throw Ur("error",e),console.error("Error fetching stores:",t),t}},setSelectedInvoice(t){Ur("selectedInvoice",t)},clearError(){Ur("error",null)},getFilteredInvoices(t){let e=ou.invoices;if(t.store&&t.store!=="all"&&(e=e.filter(r=>r.store===t.store)),t.dateFrom){const r=new Date(t.dateFrom).getTime();e=e.filter(n=>n.createDate>=r)}if(t.dateTo){const r=new Date(t.dateTo).setHours(23,59,59,999);e=e.filter(n=>n.createDate<=r)}if(t.status&&t.status!=="all"){const r=t.status==="completed";e=e.filter(n=>n.isCompleted===r)}return e},calculateSummary(t){let e=t.length,r=t.filter(g=>g.isCompleted).length,n=0,i=0,o=0,s=0,l=0,c=0,u=new Set,h=new Set;t?.forEach(g=>{u.add(g?.shipper_consignee?.cid),h.add(g.store),g?.products?.length>0&&g?.products?.forEach(f=>{const w=Math.abs(f?.qty);n+=w,o+=w*(parseFloat(f?.salePrice)||1)}),g?.reservas?.length>0&&g?.reservas?.forEach(f=>{let w=parseInt(f?.qty);isNaN(w)&&(w=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[f.type]||f?.onlyTariff?(w=parseFloat(f.arancel)||parseFloat(f.qty)*parseFloat(f.price),c+=w):(f?.arancel&&(l+=parseFloat(f?.arancel)),i+=w,s+=w*parseFloat(f?.price))})});const m=o+s+c;return{totalInvoices:e,completedInvoices:r,pendingInvoices:e-r,totalProducts:n,totalReservas:i,totalProductAmount:o,totalReservaAmount:s,totalAranceles:l,grandTotal:m,totalOther:c,uniqueCustomers:u.size,uniqueStores:h.size,avgInvoiceValue:e>0?m/e:0}},async refreshData(t){return this.fetchInvoices(t)}};var R7=he("<br>"),mb=he("<div><h3></h3><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),yb=he("<div><span>:</span><span>"),D7=he("<button>remove"),M7=he("<div class=invoice-display><div><div><div>:<span></span></div><div>: <span></span></div></div><div><div></div><h2></h2><div></div><div></div></div></div><div><h3></h3><div><div><div></div><div></div></div></div><div></div><h3></h3><div><div><div></div><div> <!> <!> </div><div></div><div></div><div></div><div></div></div><div><div></div><div></div><div></div><div></div><div> #<br> <!> <!> <br>, <br>, </div></div></div></div><div><div><div><span>:</span><span></span></div></div></div><div></div><div><button> </button><button> Test PDF</button><button> </button></div><style>"),gb=he("<tr><td></td><td></td><td></td><td></td><td>");const F7=t=>{const{t:e}=Zt(),[r,n]=Ce(""),[i,o]=Ce(!1),s=K=>new Date(K).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),l=K=>{const R=typeof K=="string"?parseFloat(K):K;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R)},c=Lt(()=>{let K=0,R=0,k=0,W=0;t.invoice?.products?.forEach(L=>{const M=Math.abs(L?.qty),G=parseFloat(L?.salePrice?.toString())||1;K+=M*G}),t.invoice?.reservas?.forEach(L=>{let M=parseFloat(L?.qty?.toString());isNaN(M)&&(M=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[L.type]||L?.onlyTariff?(M=parseFloat(L.arancel?.toString())||parseFloat(L.qty?.toString())*parseFloat(L.price?.toString()),k+=M):(L?.arancel&&(W+=parseFloat(L?.arancel?.toString())),R+=M*parseFloat(L?.price?.toString()))});const z=K+R+W+k,U=0,le=z+U;return{productSubtotal:K,reservaSubtotal:R,tariffSubtotal:W,subtotal:z,tax:U,total:le}}),u={"max-width":"800px",margin:"0 auto",padding:"2rem",background:"white","box-shadow":"0 0 20px rgba(0,0,0,0.1)","border-radius":"var(--border-radius)"},h={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"2rem","padding-bottom":"2rem","border-bottom":"2px solid #e0e0e0"},m={"text-align":"right",flex:"1"},g={display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600","text-transform":"uppercase",background:t.invoice.isCompleted?"#d4edda":"#fff3cd",color:t.invoice.isCompleted?"#155724":"#856404","margin-bottom":"0.5rem"},f={"margin-bottom":"2rem"},w={"font-size":"1.1rem","font-weight":"600","margin-bottom":"1rem",color:"#333"},x={display:"grid","grid-template-columns":"1fr 1fr",gap:"1.5rem"},S={background:"#f8f9fa",padding:"1rem","border-radius":"var(--border-radius-sm)",border:"1px solid #e9ecef"},C={"font-size":"0.875rem",color:"#666","margin-bottom":"0.25rem"},j={"font-size":"1rem",color:"#333","font-weight":"500"},oe={width:"100%","border-collapse":"collapse","margin-top":"1rem"},te={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid #dee2e6","font-weight":"600",color:"#495057","font-size":"0.875rem","text-transform":"uppercase"},Z={padding:"0.75rem","border-bottom":"1px solid #dee2e6",color:"#212529"},re={"font-weight":"600","font-size":"1.1rem"},E={display:"flex",gap:"1rem","justify-content":"center","margin-top":"2rem","padding-top":"2rem","border-top":"2px solid #e0e0e0"},$={padding:"0.75rem 1.5rem","border-radius":"var(--border-radius-sm)",border:"none","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"flex","align-items":"center",gap:"0.5rem"},T={...$,background:"var(--primary-color)",color:"white"},B={...$,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},_=Lt(()=>ct.getLocationById(t.invoice.store)),P=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}const K={...t.invoice,storeName:_()?.name||t.invoice.store,storeType:_()?.type,productSubtotal:c().productSubtotal,reservaSubtotal:c().reservaSubtotal,total:c().total};let R=fb(t.invoice);console.log("Using minimal ink PDF generator...");try{await E7(R,e),console.log("Minimal ink PDF generation completed successfully")}catch(k){console.error("PDF generation failed:",k),console.log("Trying printable PDF fallback..."),Lf(R,e),console.log("Printable PDF fallback completed")}}catch(K){console.error("Error in handleExportPDF:",K),console.error("Error stack:",K.stack),alert(`Error generating PDF: ${K.message}`)}},b=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}const K={...t.invoice,storeName:_()?.name||t.invoice.store,storeType:_()?.type,productSubtotal:c().productSubtotal,reservaSubtotal:c().reservaSubtotal,total:c().total};let R=fb(t.invoice);console.log("Using minimal ink PDF generator...");try{Lf(R,e),console.log("Minimal ink PDF generation completed successfully")}catch(k){console.error("PDF generation failed:",k),console.log("Trying printable PDF fallback..."),Lf(R,e),console.log("Printable PDF fallback completed")}}catch(K){console.error("Error in handleExportPDF:",K),console.error("Error stack:",K.stack),alert(`Error generating PDF: ${K.message}`)}},H=K=>{Gi.deleteInvoice(t.invoice.ssg_sorder_key),t.goBack()};return(()=>{var K=M7(),R=K.firstChild,k=R.firstChild,W=k.firstChild,z=W.firstChild,U=z.nextSibling,le=W.nextSibling,L=le.firstChild,M=L.nextSibling,G=k.nextSibling,I=G.firstChild,F=I.nextSibling,X=F.nextSibling,Y=X.nextSibling,Q=R.nextSibling,J=Q.firstChild,V=J.nextSibling,ne=V.firstChild,ee=ne.firstChild,ce=ee.nextSibling,se=V.nextSibling,q=se.nextSibling,ue=q.nextSibling,ye=ue.firstChild,de=ye.firstChild,ge=de.nextSibling,xe=ge.firstChild,pe=xe.nextSibling,_e=pe.nextSibling,Re=_e.nextSibling;Re.nextSibling;var Ee=ge.nextSibling,Te=Ee.nextSibling,Le=Te.nextSibling,Ie=Le.nextSibling,De=ye.nextSibling,Ye=De.firstChild,Be=Ye.nextSibling,We=Be.nextSibling,Ke=We.nextSibling,st=Ke.nextSibling,nt=st.firstChild,He=nt.nextSibling,mt=He.nextSibling,ut=mt.nextSibling,at=ut.nextSibling,It=at.nextSibling,Xe=It.nextSibling,kt=Xe.nextSibling,Tt=kt.nextSibling,wt=Tt.nextSibling,Rt=wt.nextSibling,fr=Q.nextSibling,ze=fr.firstChild,Ct=ze.firstChild,xt=Ct.firstChild,tt=xt.firstChild,bt=xt.nextSibling,Mt=fr.nextSibling,Wt=Mt.nextSibling,Jt=Wt.firstChild;Jt.firstChild;var lt=Jt.nextSibling,gt=lt.nextSibling;gt.firstChild;var $t=Wt.nextSibling;return y(K,u),y(R,h),W.style.setProperty("color","#666"),W.style.setProperty("margin-top","0.25rem"),a(W,()=>e(`inventory.${_()?.type}Type`),z),U.style.setProperty("font-size","1.1rem"),U.style.setProperty("font-weight","600"),U.style.setProperty("color","#444"),a(U,()=>_()?.name),le.style.setProperty("font-size",".91rem"),le.style.setProperty("font-weight","400"),le.style.setProperty("color","#666"),a(le,()=>e("invoices.id"),L),M.style.setProperty("font-size","1.1rem"),M.style.setProperty("font-weight","600"),M.style.setProperty("color","#444"),a(M,()=>t.invoice.ssg_sorder_key),y(G,m),a(I,(()=>{var et=$e(()=>!!t.invoice.isCompleted);return()=>et()?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()})()),F.style.setProperty("margin","0 0 0.5rem 0"),F.style.setProperty("font-size","1.5rem"),a(F,()=>e("common.invoice").toUpperCase()),X.style.setProperty("font-size","1.1rem"),X.style.setProperty("font-weight","600"),X.style.setProperty("color","#333"),a(X,()=>t.invoice.invoice),Y.style.setProperty("color","#666"),Y.style.setProperty("margin-top","0.5rem"),a(Y,()=>s(t.invoice.createDate)),a(J,()=>e("invoices.senderInformation")),a(ee,()=>e("invoices.customerName")),a(ce,()=>t.invoice.shipper_consignee.name),a(ne,D(Ge,{get when(){return t.invoice.shipper_consignee.phoneNumberS},get children(){return[R7(),$e(()=>e("invoices.altPhone")),": ",$e(()=>t.invoice.shipper_consignee.phoneNumberS)]}}),null),se.style.setProperty("margin","20px"),a(q,()=>e("invoices.receiptInformation")),a(de,()=>e("invoices.customerName")),a(ge,()=>t.invoice.shipper_consignee.firstName,xe),a(ge,()=>t.invoice.shipper_consignee.middleName,pe),a(ge,()=>t.invoice.shipper_consignee.lastName,Re),a(ge,()=>t.invoice.shipper_consignee.lastName2,null),a(Ee,()=>e("invoices.id")),a(Te,()=>t.invoice.shipper_consignee.cid),a(Le,()=>e("invoices.passport")),a(Ie,()=>t.invoice.shipper_consignee.passport),a(Ye,()=>e("invoices.contactInformation")),a(Be,()=>e("invoices.phoneNumber")),a(We,()=>t.invoice.shipper_consignee.phoneNumber),a(Ke,()=>e("invoices.address")),a(st,()=>t.invoice.shipper_consignee.ybstreet,nt),a(st,()=>t.invoice.shipper_consignee.ybstreetNo,He),a(st,()=>e("invoices.between"),mt),a(st,()=>t.invoice.shipper_consignee.ybbetwen1,ut),a(st,()=>e("invoices.and"),It),a(st,()=>t.invoice.shipper_consignee.ybbetwen2,kt),a(st,()=>t.invoice.shipper_consignee.ybreparto,Tt),a(st,()=>t.invoice.shipper_consignee.ybcity,wt),a(st,()=>t.invoice.shipper_consignee.ybestate,Rt),a(st,()=>t.invoice.shipper_consignee.nacionality,null),a(K,D(Ge,{get when(){return t.invoice?.products?.length>0},get children(){var et=mb(),Vt=et.firstChild,Ht=Vt.nextSibling,Xt=Ht.firstChild,er=Xt.firstChild,Kt=er.firstChild,ir=Kt.nextSibling,vr=ir.nextSibling,cr=vr.nextSibling,br=cr.nextSibling,Nt=Xt.nextSibling;return a(Vt,()=>e("invoices.products")),a(Kt,()=>e("invoices.code")),a(ir,()=>e("invoices.description")),a(vr,()=>e("invoices.qty")),a(cr,()=>e("invoices.unitPrice")),a(br,()=>e("invoices.total")),a(Nt,D(zt,{get each(){return t.invoice?.products},children:Et=>(()=>{var Cr=gb(),Tr=Cr.firstChild,mr=Tr.nextSibling,gr=mr.nextSibling,Er=gr.nextSibling,Wr=Er.nextSibling;return a(Tr,()=>Et.product.code),a(mr,()=>Et.product.label),a(gr,()=>Math.abs(Et.qty)),a(Er,()=>l(Et.salePrice)),a(Wr,()=>l(Math.abs(Et.qty)*parseFloat(Et.salePrice))),we(ur=>{var un=Z,yn=Z,zn={...Z,"text-align":"center"},bn={...Z,"text-align":"right"},gn={...Z,"text-align":"right"};return ur.e=y(Tr,un,ur.e),ur.t=y(mr,yn,ur.t),ur.a=y(gr,zn,ur.a),ur.o=y(Er,bn,ur.o),ur.i=y(Wr,gn,ur.i),ur},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Cr})()})),we(Et=>{var Cr=f,Tr=w,mr=oe,gr=te,Er=te,Wr={...te,"text-align":"center"},ur={...te,"text-align":"right"},un={...te,"text-align":"right"};return Et.e=y(et,Cr,Et.e),Et.t=y(Vt,Tr,Et.t),Et.a=y(Ht,mr,Et.a),Et.o=y(Kt,gr,Et.o),Et.i=y(ir,Er,Et.i),Et.n=y(vr,Wr,Et.n),Et.s=y(cr,ur,Et.s),Et.h=y(br,un,Et.h),Et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),et}}),fr),a(K,D(Ge,{get when(){return t.invoice?.reservas?.length>0},get children(){var et=mb(),Vt=et.firstChild,Ht=Vt.nextSibling,Xt=Ht.firstChild,er=Xt.firstChild,Kt=er.firstChild,ir=Kt.nextSibling,vr=ir.nextSibling,cr=vr.nextSibling,br=cr.nextSibling,Nt=Xt.nextSibling;return a(Vt,()=>e("invoices.reservations")),a(Kt,()=>e("invoices.type")),a(ir,()=>e("invoices.qty")),a(vr,()=>e("invoices.unitPrice")),a(cr,()=>e("invoices.arancel")),a(br,()=>e("invoices.total")),a(Nt,D(zt,{get each(){return t.invoice?.reservas},children:Et=>(()=>{var Cr=gb(),Tr=Cr.firstChild,mr=Tr.nextSibling,gr=mr.nextSibling,Er=gr.nextSibling,Wr=Er.nextSibling;return a(Tr,()=>Et.type),a(mr,()=>Et.qty),a(gr,()=>l(Et.price)),a(Er,()=>Et.arancel||"-"),a(Wr,()=>l(parseInt(Et.qty)*parseFloat(Et.price)+(Et.arancel?parseFloat(Et.arancel):0))),we(ur=>{var un=Z,yn={...Z,"text-align":"center"},zn={...Z,"text-align":"right"},bn={...Z,"text-align":"right"},gn={...Z,"text-align":"right"};return ur.e=y(Tr,un,ur.e),ur.t=y(mr,yn,ur.t),ur.a=y(gr,zn,ur.a),ur.o=y(Er,bn,ur.o),ur.i=y(Wr,gn,ur.i),ur},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Cr})()})),we(Et=>{var Cr=f,Tr=w,mr=oe,gr=te,Er={...te,"text-align":"center"},Wr={...te,"text-align":"right"},ur={...te,"text-align":"right"},un={...te,"text-align":"right"};return Et.e=y(et,Cr,Et.e),Et.t=y(Vt,Tr,Et.t),Et.a=y(Ht,mr,Et.a),Et.o=y(Kt,gr,Et.o),Et.i=y(ir,Er,Et.i),Et.n=y(vr,Wr,Et.n),Et.s=y(cr,ur,Et.s),Et.h=y(br,un,Et.h),Et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),et}}),fr),ze.style.setProperty("display","inline-block"),ze.style.setProperty("min-width","250px"),a(ze,D(Ge,{get when(){return t.invoice?.products?.length>0},get children(){var et=yb(),Vt=et.firstChild,Ht=Vt.firstChild,Xt=Vt.nextSibling;return et.style.setProperty("display","flex"),et.style.setProperty("justify-content","space-between"),et.style.setProperty("margin-bottom","0.5rem"),a(Vt,()=>e("invoices.productsSubtotal"),Ht),a(Xt,()=>l(c().productSubtotal)),et}}),Ct),a(ze,D(Ge,{get when(){return t.invoice?.reservas?.length>0},get children(){var et=yb(),Vt=et.firstChild,Ht=Vt.firstChild,Xt=Vt.nextSibling;return et.style.setProperty("display","flex"),et.style.setProperty("justify-content","space-between"),et.style.setProperty("margin-bottom","0.5rem"),a(Vt,()=>e("invoices.subtotal"),Ht),a(Xt,()=>l(c().reservaSubtotal)),et}}),Ct),a(xt,()=>e("invoices.total"),tt),bt.style.setProperty("color","var(--primary-color)"),a(bt,()=>l(c().total)),Jt.addEventListener("mouseleave",et=>et.currentTarget.style.opacity="1"),Jt.addEventListener("mouseenter",et=>et.currentTarget.style.opacity="0.9"),Jt.$$click=b,a(Jt,()=>e("invoices.printInvoice"),null),hs(lt,"click",$7,!0),gt.addEventListener("mouseleave",et=>{et.currentTarget.style.background="white",et.currentTarget.style.color="var(--primary-color)"}),gt.addEventListener("mouseenter",et=>{et.currentTarget.style.background="var(--primary-color)",et.currentTarget.style.color="white"}),gt.$$click=P,a(gt,()=>e("invoices.exportPdf"),null),a(Wt,D(Ge,{get when(){return lr.state?.profile?.isAdmin},get children(){var et=D7();return et.$$click=H,et.addEventListener("mouseleave",Vt=>Vt.currentTarget.style.opacity="1"),et.addEventListener("mouseenter",Vt=>Vt.currentTarget.style.opacity="0.9"),we(Vt=>y(et,T,Vt)),et}}),null),a($t,`
        @media print {
          .invoice-display {
            box-shadow: none !important;
            padding: 0 !important;
          }
          
          ${E} {
            display: none !important;
          }
        }
      `),we(et=>{var Vt=g,Ht=f,Xt=w,er=x,Kt=S,ir=C,vr=j,cr=w,br=x,Nt=S,Et=C,Cr=j,Tr={...C,"margin-top":"0.75rem"},mr=j,gr={...C,"margin-top":"0.75rem"},Er=j,Wr=S,ur=C,un={...C,"margin-top":"0.75rem"},yn=j,zn={...C,"margin-top":"0.75rem"},bn=j,gn={...f,"text-align":"right"},kr={...re,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},Un={...f,"text-align":"center",color:"#666","font-size":"0.875rem"},ei=E,pi=T,tr={...T,background:"#28a745"},Nr=B;return et.e=y(I,Vt,et.e),et.t=y(Q,Ht,et.t),et.a=y(J,Xt,et.a),et.o=y(V,er,et.o),et.i=y(ne,Kt,et.i),et.n=y(ee,ir,et.n),et.s=y(ce,vr,et.s),et.h=y(q,cr,et.h),et.r=y(ue,br,et.r),et.d=y(ye,Nt,et.d),et.l=y(de,Et,et.l),et.u=y(ge,Cr,et.u),et.c=y(Ee,Tr,et.c),et.w=y(Te,mr,et.w),et.m=y(Le,gr,et.m),et.f=y(Ie,Er,et.f),et.y=y(De,Wr,et.y),et.g=y(Ye,ur,et.g),et.p=y(Be,un,et.p),et.b=y(We,yn,et.b),et.T=y(Ke,zn,et.T),et.A=y(st,bn,et.A),et.O=y(fr,gn,et.O),et.I=y(Ct,kr,et.I),et.S=y(Mt,Un,et.S),et.W=y(Wt,ei,et.W),et.C=y(Jt,pi,et.C),et.B=y(lt,tr,et.B),et.v=y(gt,Nr,et.v),et},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0}),K})()};pr(["click"]);const hu={invoice:"",description:"",store:"",guide:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",phoneNumberS:"",cid:"",passport:"",address:""},products:[],reservas:[],packagesOrder:!1,shippingMethod:"",paymentMethods:{taxOnTotal:!1,taxPercent:0,exemptTaxOnCash:!1,cash:0,zelle:0,creditCard:0}},Wy="invoice_styled_form_draft",O7=()=>{try{const t=localStorage.getItem(Wy);if(t){const e=JSON.parse(t);return{...hu,...e,shipper_consignee:{...hu.shipper_consignee,...e.shipper_consignee||{}},paymentMethods:{...hu.paymentMethods,...e.paymentMethods||{}},products:e.products||[],reservas:e.reservas||[]}}}catch(t){console.warn("Failed to load styled invoice form from storage:",t)}return console.log("No saved data found, using default form data"),{...hu}},Yy=t=>{try{localStorage.setItem(Wy,JSON.stringify(t))}catch(e){console.warn("Failed to save styled invoice form to storage:",e)}},vb=()=>{try{localStorage.removeItem(Wy)}catch(t){console.warn("Failed to clear styled invoice form from storage:",t)}},[pl,Xo]=Ce(O7()),[v_,So]=Ce(!1),[B7,ch]=Ce(null);let Rf=null;const Es=()=>{Rf&&clearTimeout(Rf),Rf=setTimeout(()=>{const t=pl();Yy(t),ch(new Date),console.log("Styled invoice form auto-saved at",new Date().toLocaleTimeString())},1e3)},Hr={formData:pl,get isDirty(){return v_()},get lastSaved(){return B7()},updateForm:t=>{Xo(e=>{const r={...e,...t};return So(!0),Es(),r})},updateShipperConsignee:t=>{Xo(e=>{const r={...e,shipper_consignee:{...e.shipper_consignee,...t}};return So(!0),Es(),r})},updatePaymentMethods:t=>{Xo(e=>{const r={...e,paymentMethods:{...e.paymentMethods,...t}};return So(!0),Es(),r})},addProduct:t=>{Xo(e=>{const r={...e,products:[...e.products,t]};return So(!0),Es(),r})},updateProduct:(t,e)=>{Xo(r=>{const n=[...r.products];n[t]={...n[t],...e};const i={...r,products:n};return So(!0),Es(),i})},removeProduct:t=>{Xo(e=>{const r=e.products.filter((i,o)=>o!==t),n={...e,products:r};return So(!0),Es(),n})},addReserva:t=>{Xo(e=>{const r={...e,reservas:[...e.reservas,t]};return So(!0),Es(),r})},updateReserva:(t,e)=>{Xo(r=>{const n=[...r.reservas];n[t]={...n[t],...e};const i={...r,reservas:n};return So(!0),Es(),i})},removeReserva:t=>{Xo(e=>{const r=e.reservas.filter((i,o)=>o!==t),n={...e,reservas:r};return So(!0),Es(),n})},clearForm:()=>{Xo({...hu}),So(!1),vb(),ch(null)},markCompleted:()=>{vb(),So(!1),ch(null)},forceSave:()=>{Yy(pl()),ch(new Date),So(!1)},hasData:()=>{const t=pl();return t.invoice!==""||t.description!==""||t.store!==""||t.shipper_consignee.name!==""||t.shipper_consignee.firstName!==""||t.shipper_consignee.cid!==""||t.products.length>0||t.reservas.length>0||t.paymentMethods.cash>0||t.paymentMethods.zelle>0||t.paymentMethods.creditCard>0},isValid:()=>{const t=pl();return t.invoice.trim()!==""&&t.shipper_consignee.firstName.trim()!==""&&t.shipper_consignee.lastName.trim()!==""&&t.shipper_consignee.cid.trim()!==""&&(t.products.length>0||t.reservas.length>0)},getFormData:()=>pl()};typeof window<"u"&&window.addEventListener("beforeunload",t=>{if(v_()&&(Yy(pl()),Hr.hasData()))return t.preventDefault(),t.returnValue="You have unsaved changes in your invoice. Are you sure you want to leave?",t.returnValue});var j7=he("<div> "),V7=he("<div> <div>"),q7=he("<div><span></span><span>"),Qd=he("<div>"),z7=he("<div><div><div><input type=text autocomplete=off>"),U7=he("<button type=button>+"),H7=he("<div><div></div><div>"),G7=he("<div><div><div><div></div><div><span>: </span><span></span><span></span><span></span><span></span></div></div><div><div> </div><div></div><div>: "),W7=he("<span>"),Y7=he("<span> ");const K7=t=>{const{t:e}=Zt(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),[c,u]=Ce(!1),[h,m]=Ce(null),[g,f]=Ce([]),[w,x]=Ce(null),S=t.searchDelay||300,C=t.maxResults||40,j=Lt(()=>{if(!t.value)return null;const Q=g().find(J=>J.id===t.value);return Q||ct.getProductById(t.value)}),oe=async Q=>{if(!Q.trim()){f([]);return}u(!0),m(null);const J=ct.getActiveProducts().filter(V=>V.name.toLowerCase().includes(Q.toLowerCase())||V.sku.toLowerCase().includes(Q.toLowerCase())||V?.UPC?.toLowerCase().includes(Q?.toLowerCase())||V.category.toLowerCase().includes(Q.toLowerCase())).slice(0,C);f(J),u(!1)},te=Lt(()=>i().toLowerCase()?g():ct.getActiveProducts().slice(0,10)),Z=()=>{n(!0),o(""),l(-1),m(null),i()||f(ct.getActiveProducts().slice(0,10))},re=Q=>{const V=Q.target.value;o(V),n(!0),l(-1),m(null),w()&&clearTimeout(w());const ne=setTimeout(()=>{oe(V)},S);x(ne)},E=Q=>{t.onChange(Q.id),n(!1),o(""),l(-1),m(null),w()&&(clearTimeout(w()),x(null))},$=Q=>{const J=te();switch(Q.key){case"ArrowDown":Q.preventDefault(),l(V=>Math.min(V+1,J.length-1));break;case"ArrowUp":Q.preventDefault(),l(V=>Math.max(V-1,-1));break;case"Enter":Q.preventDefault(),s()>=0&&J[s()]&&E(J[s()]);break;case"Escape":n(!1),o(""),l(-1),m(null),w()&&(clearTimeout(w()),x(null));break}},T=Q=>{setTimeout(()=>{n(!1),o(""),l(-1),w()&&(clearTimeout(w()),x(null))},150)},B=Q=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Q),_=Q=>ct.stockLevels.filter(J=>J.productId===Q).reduce((J,V)=>J+V.quantity,0);Cn(()=>()=>{w()&&clearTimeout(w())});const P={position:"relative",width:"100%",...t.style},b={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},H={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"400px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},K=Q=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:Q?"var(--strip-color)":"transparent",color:Q?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),R={display:"flex","justify-content":"space-between","align-items":"center"},k={flex:"1"},W={"font-weight":"500","margin-bottom":"0.25rem"},z={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","flex-wrap":"wrap"},U={"text-align":"right","font-size":"0.875rem"},le={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},L={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"},M={padding:"1rem","text-align":"center",color:"#d32f2f",background:"#ffebee","border-radius":"var(--border-radius-sm)",margin:"0.5rem","font-size":"0.875rem"},G=()=>r()&&i()?i():j()?`${j().name} (${j().sku})`:"",I={display:"flex","align-items":"stretch",width:"100%"},F={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},X={...b,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},Y={position:"absolute",right:t.onAddNew?"50px":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)","pointer-events":"none"};return(()=>{var Q=z7(),J=Q.firstChild,V=J.firstChild,ne=V.firstChild;return y(J,I),V.style.setProperty("position","relative"),V.style.setProperty("flex","1"),ne.addEventListener("blur",T),ne.$$keydown=$,ne.$$click=Z,ne.$$input=re,a(V,D(Ge,{get when(){return c()},get children(){var ee=j7();return ee.firstChild,a(ee,()=>e("common.searching","Searching..."),null),we(ce=>y(ee,Y,ce)),ee}}),null),a(J,(()=>{var ee=$e(()=>!!t.onAddNew);return()=>ee()&&(()=>{var ce=U7();return ce.addEventListener("mouseleave",se=>{se.currentTarget.style.background="var(--surface-color)",se.currentTarget.style.color="var(--primary-color)"}),ce.addEventListener("mouseenter",se=>{se.currentTarget.style.background="var(--primary-color)",se.currentTarget.style.color="white"}),hs(ce,"click",t.onAddNew,!0),y(ce,F),we(()=>Qt(ce,"title",e("inventory.addProduct","Add new product"))),ce})()})(),null),a(Q,D(Ge,{get when(){return r()},get children(){var ee=Qd();return a(ee,D(Ge,{get when(){return h()},get children(){var ce=V7(),se=ce.firstChild,q=se.nextSibling;return y(ce,M),a(ce,h,q),q.style.setProperty("margin-top","0.5rem"),q.style.setProperty("font-size","0.75rem"),a(q,()=>e("inventory.searchFallback","Showing local results")),ce}}),null),a(ee,D(Ge,{get when(){return c()},get children(){var ce=q7(),se=ce.firstChild,q=se.nextSibling;return y(ce,L),a(q,()=>e("common.searching","Searching products...")),ce}}),null),a(ee,D(Ge,{get when(){return $e(()=>!c())()&&te().length>0},get fallback(){return $e(()=>!c())()&&(()=>{var ce=Qd();return y(ce,le),a(ce,(()=>{var se=$e(()=>!!i());return()=>se()?(()=>{var q=H7(),ue=q.firstChild,ye=ue.nextSibling;return a(ue,()=>e("inventory.noProductsFound","No products found matching your search.")),ye.style.setProperty("margin-top","0.5rem"),ye.style.setProperty("font-size","0.75rem"),a(ye,()=>e("inventory.tryDifferentTerm","Try a different search term or check spelling.")),q})():e("inventory.noProductsAvailable","No products available.")})()),ce})()},get children(){return[D(zt,{get each(){return te()},children:(ce,se)=>{const q=_(ce.id),ue=q<=ce.minStockLevel;return(()=>{var ye=G7(),de=ye.firstChild,ge=de.firstChild,xe=ge.firstChild,pe=xe.nextSibling,_e=pe.firstChild,Re=_e.firstChild,Ee=_e.nextSibling,Te=Ee.nextSibling,Le=Te.nextSibling,Ie=Le.nextSibling,De=ge.nextSibling,Ye=De.firstChild,Be=Ye.firstChild,We=Ye.nextSibling,Ke=We.nextSibling,st=Ke.firstChild;return ye.addEventListener("mouseenter",()=>l(se())),ye.$$click=()=>E(ce),y(de,R),y(ge,k),y(xe,W),a(xe,()=>ce.name,null),a(xe,(()=>{var nt=$e(()=>!!i());return()=>nt()&&(()=>{var He=W7();return He.style.setProperty("margin-left","0.5rem"),He.style.setProperty("font-size","0.75rem"),He.style.setProperty("color","var(--primary-color)"),He.style.setProperty("font-weight","normal"),a(He,()=>g().includes(ce)?" API":" Local"),He})()})(),null),y(pe,z),a(_e,()=>e("inventory.sku","SKU"),Re),a(_e,()=>ce.sku,null),a(Te,()=>ce.category),a(Ie,()=>B(ce.unitCost)),a(ge,(()=>{var nt=$e(()=>!!ce.description);return()=>nt()&&(()=>{var He=Qd();return He.style.setProperty("font-size","0.75rem"),He.style.setProperty("color","var(--text-muted)"),He.style.setProperty("margin-top","0.25rem"),He.style.setProperty("font-style","italic"),a(He,(()=>{var mt=$e(()=>ce.description.length>60);return()=>mt()?`${ce.description.substring(0,60)}...`:ce.description})()),He})()})(),null),y(De,U),Ye.style.setProperty("font-weight","600"),(ue?"#f44336":"var(--text-primary)")!=null?Ye.style.setProperty("color",ue?"#f44336":"var(--text-primary)"):Ye.style.removeProperty("color"),a(Ye,q,Be),a(Ye,()=>ce.unitOfMeasure,null),We.style.setProperty("color","var(--text-muted)"),a(We,()=>ue?(()=>{var nt=Y7();return nt.firstChild,nt.style.setProperty("color","#f44336"),a(nt,()=>e("inventory.lowStock","Low Stock"),null),nt})():e("inventory.inStock","In Stock")),Ke.style.setProperty("font-size","0.75rem"),Ke.style.setProperty("color","var(--text-muted)"),Ke.style.setProperty("margin-top","0.25rem"),a(Ke,()=>e("inventory.min","Min"),st),a(Ke,()=>ce.minStockLevel,null),we(nt=>y(ye,K(se()===s()),nt)),ye})()}}),$e(()=>$e(()=>te().length===C)()&&(()=>{var ce=Qd();return ce.style.setProperty("padding","0.5rem"),ce.style.setProperty("text-align","center"),ce.style.setProperty("font-size","0.75rem"),ce.style.setProperty("color","var(--text-muted)"),ce.style.setProperty("border-top","1px solid var(--border-color)"),ce.style.setProperty("font-style","italic"),a(ce,()=>e("inventory.showingTopResults","Showing top {{count}} results",{count:C})),ce})())]}}),null),we(ce=>y(ee,H,ce)),ee}}),null),we(ee=>{var ce=P,se=X,q=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),ue=t.disabled,ye=t.required;return ee.e=y(Q,ce,ee.e),ee.t=y(ne,se,ee.t),q!==ee.a&&Qt(ne,"placeholder",ee.a=q),ue!==ee.o&&(ne.disabled=ee.o=ue),ye!==ee.i&&(ne.required=ee.i=ye),ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>ne.value=G()),Q})()};pr(["input","click","keydown"]);var J7=he("<label>"),Df=he("<div>"),Q7=he("<div><span></span><span>"),X7=he("<div><input type=text autocomplete=off>"),Z7=he("<span> "),eD=he("<span> "),tD=he("<span> "),rD=he("<div><div><div><div> </div><div>");const nD=t=>{const{t:e}=Zt(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),[c,u]=Ce(!1),[h,m]=Ce([]),[g,f]=Ce(null),w=async k=>{if(!k.trim()||k.trim().length<6){m([]);return}try{u(!0);const W=await Ti.getConsigee(k);console.log(W);const z=Object.values(W).map(U=>({id:U.consigneeId,firstName:U.firstName+(U.middleName?" "+U.middleName:""),fullName:U.firstName+(U.middleName?" "+U.middleName:"")+" "+U.lastName+" "+U.lastName2,lastName:U.lastName+" "+U.lastName2,cid:U.cid,phoneNumber:U.phoneNumber,ybbetwen1:U.ybbetwen1,ybcity:U.ybcity,ybestate:U.ybestate,ybreparto:U.ybreparto,ybstreet:U.ybstreet,ybstreetNo:U.ybstreetNo,address:`Calle ${U.ybstreet}${U.ybstreetNo?" # "+U.ybstreetNo:""}${U.ybbetwen1?" / "+U.ybbetwen1:""}${U.ybbetwen2?" y "+U.ybbetwen2:""}${U.ybreparto?", Rpto "+U.ybreparto:""}, ${U.ybcity?U.ybcity:""}, ${U.ybestate?U.ybestate:""}`}));m(z)}catch(W){console.warn("API search failed, falling back to local search:",W)}finally{u(!1)}},x=()=>{n(!0),o(""),l(-1),i()||w("")},S=k=>{const z=k.target.value;o(z),n(!0),l(-1),g()&&clearTimeout(g());const U=setTimeout(()=>{w(z)},600);f(U)},C=k=>{t.onChange(k),n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},j=k=>{const W=h();switch(k.key){case"ArrowDown":k.preventDefault(),l(z=>Math.min(z+1,W.length-1));break;case"ArrowUp":k.preventDefault(),l(z=>Math.max(z-1,-1));break;case"Enter":k.preventDefault(),s()>=0&&W[s()]&&C(W[s()]);break;case"Escape":n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null));break}},oe=k=>{setTimeout(()=>{n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},150)},te=()=>r()&&i()?i():t.value?t.value.cid:"";Cn(()=>(w(""),()=>{g()&&clearTimeout(g())}));const Z={position:"relative",width:"100%",...t.style},re={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},E={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},$={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},T={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},B=k=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:k?"var(--strip-color)":"transparent",color:k?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),_={display:"flex","justify-content":"space-between","align-items":"flex-start"},P={flex:"1"},b={"font-weight":"500","margin-bottom":"0.25rem"},H={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},K={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},R={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"};return(()=>{var k=X7(),W=k.firstChild;return a(k,D(Ge,{get when(){return t.label},get children(){var z=J7();return y(z,re),a(z,()=>t.label),z}}),W),a(k,D(Ge,{get when(){return t.description},get children(){var z=Df();return y(z,E),a(z,()=>t.description),z}}),W),W.addEventListener("blur",oe),W.$$keydown=j,W.$$click=x,W.$$input=S,a(k,D(Ge,{get when(){return r()},get children(){var z=Df();return a(z,D(Ge,{get when(){return c()},get children(){var U=Q7(),le=U.firstChild,L=le.nextSibling;return y(U,R),a(L,()=>e("common.searching","Buscando clientes...")),U}}),null),a(z,D(Ge,{get when(){return $e(()=>!c())()&&h().length>0},get fallback(){return $e(()=>!c())()&&(()=>{var U=Df();return y(U,K),a(U,(()=>{var le=$e(()=>!!i());return()=>le()?e("customer.noCustomersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noCustomersAvailable","No se encontraron clientes previos. Se crear un nuevo cliente.")})()),U})()},get children(){return D(zt,{get each(){return h()},children:(U,le)=>(()=>{var L=rD(),M=L.firstChild,G=M.firstChild,I=G.firstChild;I.firstChild;var F=I.nextSibling;return L.addEventListener("mouseenter",()=>l(le())),L.$$click=()=>C(U),y(M,_),y(G,P),y(I,b),a(I,()=>U.fullName,null),y(F,H),a(F,D(Ge,{get when(){return U.phoneNumber},get children(){var X=Z7();return X.firstChild,a(X,()=>U.phoneNumber,null),X}}),null),a(F,D(Ge,{get when(){return U.cid},get children(){var X=eD();return X.firstChild,a(X,()=>U.cid,null),X}}),null),a(F,D(Ge,{get when(){return U.email},get children(){var X=tD();return X.firstChild,a(X,()=>U.email,null),X}}),null),we(X=>y(L,B(le()===s()),X)),L})()})}}),null),we(U=>y(z,T,U)),z}}),null),we(z=>{var U=Z,le=$,L=t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, telfono, ID..."),M=t.disabled,G=t.required;return z.e=y(k,U,z.e),z.t=y(W,le,z.t),L!==z.a&&Qt(W,"placeholder",z.a=L),M!==z.o&&(W.disabled=z.o=M),G!==z.i&&(W.required=z.i=G),z},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>W.value=te()),k})()};pr(["input","click","keydown"]);var iD=he("<label>"),Mf=he("<div>"),oD=he("<div><span></span><span>"),sD=he("<div><input type=text autocomplete=off>"),aD=he("<span> "),lD=he("<div><div><div><div> </div><div>");const cD=t=>{const{t:e}=Zt(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),[c,u]=Ce(!1),[h,m]=Ce([]),[g,f]=Ce(null),w=600,x=async W=>{if(!W.trim()||W.trim().length<6){m([]);return}try{u(!0);const z=await Ti.getShipper(W),U=Object.values(z).map(le=>({id:le.shipperId,name:le.name,dob:le.dob,phoneNumberS:le.phoneNumber}));m(U)}catch(z){console.warn("API search failed, falling back to local search:",z)}finally{u(!1)}},S=W=>{const U=W.target.value;o(U),n(!0),l(-1),g()&&clearTimeout(g());const le=setTimeout(()=>{x(U)},w);f(le)},C=()=>{n(!0),o(""),l(-1),i()||x("")},j=W=>{t.onChange(W),n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},oe=W=>{const z=h();switch(W.key){case"ArrowDown":W.preventDefault(),l(U=>Math.min(U+1,z.length-1));break;case"ArrowUp":W.preventDefault(),l(U=>Math.max(U-1,-1));break;case"Enter":W.preventDefault(),s()>=0&&z[s()]&&j(z[s()]);break;case"Escape":n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null));break}},te=W=>{setTimeout(()=>{n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},150)},Z=()=>r()&&i()?i():t.value?t.value.name:"";Cn(()=>(x(""),()=>{g()&&clearTimeout(g())}));const re={position:"relative",width:"100%",...t.style},E={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},$={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},T={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},B={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},_=W=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:W?"var(--strip-color)":"transparent",color:W?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),P={display:"flex","justify-content":"space-between","align-items":"flex-start"},b={flex:"1"},H={"font-weight":"500","margin-bottom":"0.25rem"},K={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},R={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},k={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"};return(()=>{var W=sD(),z=W.firstChild;return a(W,D(Ge,{get when(){return t.label},get children(){var U=iD();return y(U,E),a(U,()=>t.label),U}}),z),a(W,D(Ge,{get when(){return t.description},get children(){var U=Mf();return y(U,$),a(U,()=>t.description),U}}),z),z.addEventListener("blur",te),z.$$keydown=oe,z.$$click=C,z.$$input=S,a(W,D(Ge,{get when(){return r()},get children(){var U=Mf();return a(U,D(Ge,{get when(){return c()},get children(){var le=oD(),L=le.firstChild,M=L.nextSibling;return y(le,k),a(M,()=>e("common.searching","Buscando clientes...")),le}}),null),a(U,D(Ge,{get when(){return $e(()=>!c())()&&h().length>0},get fallback(){return $e(()=>!c())()&&(()=>{var le=Mf();return y(le,R),a(le,(()=>{var L=$e(()=>!!i());return()=>L()?e("customer.noShippersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noShippersAvailable","No se encontraron clientes previos. Se crear un nuevo cliente.")})()),le})()},get children(){return D(zt,{get each(){return h()},children:(le,L)=>(()=>{var M=lD(),G=M.firstChild,I=G.firstChild,F=I.firstChild;F.firstChild;var X=F.nextSibling;return M.addEventListener("mouseenter",()=>l(L())),M.$$click=()=>j(le),y(G,P),y(I,b),y(F,H),a(F,()=>le.name,null),y(X,K),a(X,D(Ge,{get when(){return le.phoneNumberS},get children(){var Y=aD();return Y.firstChild,a(Y,()=>le.phoneNumberS,null),Y}})),we(Y=>y(M,_(L()===s()),Y)),M})()})}}),null),we(le=>y(U,B,le)),U}}),null),we(U=>{var le=re,L=T,M=t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, telfono, ID..."),G=t.disabled,I=t.required;return U.e=y(W,le,U.e),U.t=y(z,L,U.t),M!==U.a&&Qt(z,"placeholder",U.a=M),G!==U.o&&(z.disabled=U.o=G),I!==U.i&&(z.required=U.i=I),U},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>z.value=Z()),W})()};pr(["input","click","keydown"]);var uD=he("<div> "),Gh=he("<div>"),dD=he('<div><h3> Informacin del Cliente</h3><div></div><div><div><label>Nombre del Cliente/Empresa *</label><input type=text placeholder="ej., Juan Prez o Empresa ABC"required></div><div><label>Nmero de Telfono Principal</label><input type=tel placeholder="ej., +53-5-123-4567">'),hD=he('<div><h3> Informacin del Destinatario</h3><div></div><div><label>Primer Nombre</label><input type=text placeholder="ej., Juan"></div><div><label>Apellido</label><input type=text placeholder="ej., Prez"></div><div><label>Nmero de Identificacin</label><input type=text placeholder="ej., 12345678901 o A1234567"></div><div><label>Nmero de Pasaporte</label><input type=text placeholder="ej., AB1234567"></div><div><label>Nmero de Telfono Principal</label><input type=tel placeholder="ej., +53-5-123-4567"></div><div><label>Direccin de Entrega/Facturacin</label><textarea placeholder="ej., Calle 23 #456, Apto 4B, Vedado, La Habana, 10400">'),bb=he("<div><strong>Subtotal: $"),pD=he("<div><div><span> Reservas y Servicios</span><button> Agregar Servicio/Reserva"),fD=he("<div><div><span> Productos y Artculos</span></div><div><label>Agregar Productos a la Factura"),mD=he("<span> Sin impuesto"),yD=he("<div><div>Vista previa del clculo:</div><div>Subtotal: $</div><div> Del Subtotal: $<!>(Total: $<!>)</div><div> Del Total: $<!>(Total: $<!>)"),gD=he("<div><div> Beneficio por Pago en Efectivo:</div><div>Efectivo: $<!> (<!>% del pago)</div><div>Ahorro en impuestos: $</div><div>Impuesto original: $<!>  Impuesto final: $"),vD=he("<div><label><input type=checkbox><span> Exencin de Impuesto por Pago en Efectivo</span></label><div>Los pagos en efectivo estarn exentos de impuestos. Mientras mayor sea el porcentaje pagado en efectivo, mayor ser la exencin."),bD=he('<div><div><span> Mtodos de Pago</span></div><div>Distribuya el pago total entre los diferentes mtodos de pago disponibles.</div><div><button type=button> Todo Efectivo</button><button type=button title="Pagar todo por Zelle"> Todo Zelle</button><button type=button title="Pagar todo con tarjeta"> Todo Tarjeta</button><button type=button title="Limpiar todos los pagos"> Limpiar</button></div><div><div><label> Efectivo</label><input type=text placeholder=0.00 min=0 step=0.01></div><div><label> Zelle</label><input type=text placeholder=0.00 min=0 step=0.01></div></div><div><label> Tarjeta de Crdito</label><input type=text placeholder=0.00 min=0 step=0.01></div><div><div><div>Total de Pagos: <strong>$</strong></div><div>Balance: <strong>$</strong></div></div><div><div>Total a Pagar: <strong>$</strong></div><div></div></div></div><div><label>Impuesto (%)</label><div>Porcentaje de impuesto. Puede aplicarse sobre el subtotal o como porcentaje del total final.</div><input type=number placeholder=0 min=0 max=99 step=0.01><div><div><label><input type=radio name=taxMethod><span>Del Subtotal (tradicional)</span></label><div>Impuesto = Subtotal  <!>%</div><label><input type=radio name=taxMethod><span>Del Total Final</span></label><div>El impuesto representa el <!>% del total final'),_D=he("<span>(Ahorro: $<!>)"),SD=he("<div>Impuesto (<!>% <!>): $"),PD=he("<div>Envo: "),wD=he("<div><div>Productos: $</div><div>Reservas: $</div><div>Subtotal: $</div><div>Total: $"),xD=he("<span><span></span>Auto-guardando cambios..."),AD=he("<span><span></span>Guardado: "),CD=he("<button>Limpiar Formulario"),ID=he("<div><div>"),$D=he("<button>"),ED=he("<div><button></button><button> Nueva Factura"),TD=he('<div><h2> Crear Nueva Factura</h2><div><div><div><h3> Informacin de Factura</h3><div><div><label>Nmero de Factura *</label><input type=text></div><div><label>Ubicacin de Tienda *</label></div></div><div><div><label>Mtodo de Envo</label><div>Seleccione el mtodo de transporte para esta orden.</div><select><option value>Seleccionar mtodo...</option><option value=AEREO> Areo (Avin)</option><option value=SEA> Martimo (Barco)</option></select></div><div><label>fecha</label><div>Seleccione una fecha si es diferente al dia de hoy.</div><input type=date></div><div><label>No de Guia</label><select><option value=all></option></select></div></div><div><label>Descripcin de Factura</label><textarea placeholder="ej., Venta regular, pedido mayorista, descuento especial aplicado..."></textarea></div><label><input type=checkbox><div><span>Orden de Paquete/Envo</span><div>Marque esto si esta factura incluye servicios de envo o manejo de paquetes.</div></div></label></div></div><div>'),kD=he("<option>"),_b=he("<span> ($<!>)"),ND=he("<div>(<!><!>+<!>)"),LD=he("<div><div><button></button></div><div><div><label>Cant (lbs)</label></div><div><label>Precio</label></div><div><label>Arancel</label></div><div>$"),RD=he("<div><div><div><div></div><div></div></div><button></button></div><div><div>$"),DD=he("<input step=0.01>"),MD=he("<div><div><input type=text autocomplete=off><div>");const Sb=[" Ropa"," Zapatos"," Ventilador"," tiles del Hogar"," TV"," Telfono Mvil"," Computadora/Laptop"," Audfonos"," Reloj"," Joyera"," Productos de Belleza"," Medicamentos"," Alimentos"," Juguetes"," Libros"," Videojuegos"," Herramientas"," Repuestos de Auto"," Artculos Deportivos"," Instrumentos Musicales"," Electrnicos"," Maletas"," Lentes"," Cables y Accesorios"," Equipos Mdicos"," Materiales de Arte"," Cmaras"," Bateras"," Productos de Limpieza"," Artculos para el Hogar","Transportacion","Cajas","Servicio de Rapeado"],FD={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},ot={container:{padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)"},header:{"font-size":"1.5rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"1.5rem"},grid:{display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem"},section:{background:"var(--background-color)",padding:"1.25rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},sectionTitle:{"font-size":"1.125rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},formGroup:{"margin-bottom":"1rem"},label:{display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},fieldDescription:{"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","line-height":"1.4","font-style":"italic"},input:{width:"100%",padding:"0.625rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",background:"var(--surface-color)",transition:"border-color 0.2s",outline:"none"},textarea:{width:"100%",padding:"0.625rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",background:"var(--surface-color)",resize:"vertical","min-height":"60px"},button:{padding:"0.625rem 1.25rem",border:"none","border-radius":"var(--border-radius-sm)","font-size":"0.875rem","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"inline-flex","align-items":"center",gap:"0.5rem"},primaryButton:{background:"var(--primary-color)",color:"white"},secondaryButton:{background:"var(--secondary-color)",color:"white"},successButton:{background:"#4CAF50",color:"white"},alert:{padding:"0.75rem 1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1rem","font-size":"0.875rem",display:"flex","align-items":"center",gap:"0.5rem"},errorAlert:{background:"#ffebee",border:"1px solid #ffcdd2",color:"#d32f2f"},successAlert:{background:"#e8f5e9",border:"1px solid #c8e6c9",color:"#2e7d32"},productWrapItem:{padding:"0.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"0.5rem"},productItem:{display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem","margin-bottom":"0.5rem"},smallInput:{width:"70px",padding:"0.375rem 0.5rem","font-size":"0.8125rem"},removeButton:{background:"none",border:"none",color:"#f44336",cursor:"pointer","font-size":"1.25rem",padding:"0.25rem"},totalSection:{background:"var(--primary-color)",color:"white",padding:"1rem","border-radius":"var(--border-radius-sm)","text-align":"right"},gridTwo:{display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"}},OD=()=>{const{t}=Zt(),e=Hr.formData,r=ee=>Hr.updateForm(ee),[n,i]=Ce(null),[o,s]=Ce(""),[l,c]=Ce(""),[u,h]=Ce(null);Cn(()=>{console.log("Styled invoice form mounted, loaded data:",e()),Hr.hasData()&&(S("Form data restored from previous session"),setTimeout(()=>S(""),3e3))});const[m,g]=Ce(!1),[f,w]=Ce(""),[x,S]=Ce(""),[C,j]=Ce(""),[oe,te]=Ce(!1),Z=ee=>{if(!ee)return"";const ce=ct.getLocationById(ee),se=ce?.code||ce?.name?.substring(0,3).toUpperCase()||"INV",ue=new Date().toISOString().slice(0,10).replace(/-/g,"");return`${_P(6)}-${se}-${ue}`};Ei(()=>{const ee=o();if(ee&&!e().invoice.trim()){const ce=Z(ee);c(ce),r({invoice:ce})}}),Ei(()=>{const ee=n();ee&&Hr.updateShipperConsignee({name:ee.name,firstName:ee.firstName||"",lastName:ee.lastName||"",phoneNumber:ee.phoneNumber||"",cid:ee.cid||"",passport:ee.passport||"",address:ee.address||""})}),Ei(()=>{});const re=ee=>{const ce=ct.getProductById(ee);if(!ce)return;const se={id:Date.now().toString(),product:{id:ce.id,code:ce.sku||"",label:ce.name||"",price:ce.unitCost||0},qty:1,salePrice:ce.unitCost||0,total:ce.unitCost||0};Hr.addProduct(se)},E=ee=>{s(ee),r({store:ee})},$=ee=>{i(ce=>({...ce,...ee}))},T=ee=>{h({name:ee?.name}),i(ce=>({...ce,phoneNumberS:ee?.phoneNumberS,name:ee?.name,dob:ee?.dob}))},B=(ee,ce,se)=>{const q=e().products,ue=q.findIndex(ye=>ye.id===ee);if(ue!==-1){const ye={...q[ue],[ce]:se};ye.total=ye.qty*ye.salePrice,Hr.updateProduct(ue,ye)}},_=ee=>{const ce=e().products.findIndex(se=>se.id===ee);ce!==-1&&Hr.removeProduct(ce)},P=()=>{const ee={id:Date.now().toString(),type:"",qty:1,price:0,arancel:0,total:0};Hr.addReserva(ee)},b=(ee,ce,se)=>{const q=e().reservas,ue=q.findIndex(ye=>ye.id===ee);if(ue!==-1){const ye={...q[ue],[ce]:se};(ce==="qty"||ce==="price"||ce==="arancel")&&(ye.total=Number(ye.qty)*Number(ye.price)+Number(ye.arancel)),Hr.updateReserva(ue,ye)}},H=ee=>{const ce=e().reservas.findIndex(se=>se.id===ee);ce!==-1&&Hr.removeReserva(ce)},K=()=>e().products.reduce((ee,ce)=>ee+ce.total,0),R=()=>e().reservas.reduce((ee,ce)=>ee+ce.total,0),k=()=>K()+R(),W=()=>{if(e()?.paymentMethods.taxPercent===0)return 0;if(e()?.paymentMethods.exemptTaxOnCash){const ee=le()>0?e().paymentMethods.cash/le():0,ce=Math.min(ee,1);let se;return e()?.paymentMethods.taxOnTotal?se=k()/(1-e()?.paymentMethods.taxPercent/100)-k():se=k()*(e()?.paymentMethods.taxPercent/100),se*(1-ce)}return e()?.paymentMethods.taxOnTotal?k()/(1-e()?.paymentMethods?.taxPercent/100)-k():k()*(e()?.paymentMethods?.taxPercent/100)},z=()=>{if(!e()?.paymentMethods.exemptTaxOnCash||e()?.paymentMethods.taxPercent===0)return 0;const ee=le()>0?e().paymentMethods.cash/le():0,ce=Math.min(ee,1);let se;return e()?.paymentMethods.taxOnTotal?se=k()/(1-e()?.paymentMethods?.taxPercent/100)-k():se=k()*(e()?.paymentMethods?.taxPercent/100),se*ce},U=()=>k()+W(),le=()=>{const ee=e().paymentMethods;return ee.cash+ee.zelle+ee.creditCard},L=()=>U()-le(),M=(ee,ce)=>{Hr.updatePaymentMethods({[ee]:ce})},G=(ee,ce)=>{Hr.updatePaymentMethods({[ee]:ce})},I=ee=>{const ce=U();Hr.updatePaymentMethods({cash:ee==="cash"?ce:0,zelle:ee==="zelle"?ce:0,creditCard:ee==="creditCard"?ce:0})},F=()=>{Hr.updatePaymentMethods({cash:0,zelle:0,creditCard:0})},X=async()=>{g(!0),w(""),S("");try{if(!e().invoice.trim())throw new Error("Nmero de factura es requerido");if(!e().shipper_consignee.name.trim())throw new Error("Nombre del cliente es requerido");if(e().products.length===0&&e().reservas.length===0)throw new Error("Al menos un producto o reserva es requerido");if(Math.round(L())>.01)throw new Error(`El total de pagos (${le().toFixed()}) no coincide con el total de la factura (${U().toFixed()})`);const ee={...e(),type:"SALES",ssg_inventory_key:`INVOICE-${Date.now()}`,ssg_sorder_key:`SO-${Date.now()}`,createDate:e().createDate||Date.now(),businessId:"YB100423253156428",isCompleted:!0,productSubtotal:K(),reservaSubtotal:R(),subtotalBeforeTax:k(),taxAmount:W(),taxSavings:z(),total:U(),shippingMethod:e().shippingMethod,taxCalculationMethod:e()?.paymentMethods.taxOnTotal?"total":"subtotal",cashPaymentRatio:le()>0?e().paymentMethods.cash/le():0,paymentMethods:e().paymentMethods};console.log("createInvoice",JSON.stringify(ee,null,4));const ce=await Ti.addInventory(ee);Ti.addInvoice(ce),j(ce.data),S(" Invoice created successfully! You can now generate a PDF."),Hr.markCompleted(),Q()}catch(ee){w(ee.message||"Error creating invoice")}finally{g(!1)}},Y=async()=>{if(C()){te(!0),w("");try{const{generateEnhancedInvoicePDF:ee}=await Ji(async()=>{const{generateEnhancedInvoicePDF:ue}=await import("./enhancedInvoicePdfGenerator-gZCPDCuO.js");return{generateEnhancedInvoicePDF:ue}},[]);console.log(JSON.stringify(e()));const se={invoiceId:C(),shippingMethod:e().shippingMethod,taxPercent:e()?.paymentMethods.taxPercent,taxOnTotal:e()?.paymentMethods.taxOnTotal,exemptTaxOnCash:e()?.paymentMethods.exemptTaxOnCash,paymentMethods:e().paymentMethods,productSubtotal:K(),reservaSubtotal:R(),subtotalBeforeTax:k(),taxAmount:W(),taxSavings:e()?.paymentMethods.exemptTaxOnCash?k()*e()?.paymentMethods.taxPercent/100-W():0,total:U(),cashPaymentRatio:le()>0?e().paymentMethods.cash/le():0};console.log(JSON.stringify(se));const q=await ee({...e(),...se},"es","modern");S(` PDF generated successfully: ${q}`)}catch(ee){w(ee.message||"Error generating PDF")}finally{te(!1)}}},Q=()=>{Hr.clearForm(),j(""),S(""),w("")},J=()=>Hr.hasData()&&Hr.isDirty,V=()=>{J()?confirm("Are you sure you want to clear the form? All unsaved changes will be lost.")&&Q():Q()};Cn(()=>{});const ne=Lt(()=>{const ee=new Set([2516,2517,2518,2519,2520,2521,2522,2523].map(ce=>ce));return Array.from(ee).sort((ce,se)=>ce-se)});return(()=>{var ee=TD(),ce=ee.firstChild,se=ce.nextSibling,q=se.firstChild,ue=q.firstChild,ye=ue.firstChild,de=ye.nextSibling,ge=de.firstChild,xe=ge.firstChild,pe=xe.nextSibling,_e=ge.nextSibling,Re=_e.firstChild,Ee=de.nextSibling,Te=Ee.firstChild,Le=Te.firstChild,Ie=Le.nextSibling,De=Ie.nextSibling,Ye=Te.nextSibling,Be=Ye.firstChild,We=Be.nextSibling,Ke=We.nextSibling,st=Ye.nextSibling,nt=st.firstChild,He=nt.nextSibling,mt=He.firstChild,ut=Ee.nextSibling,at=ut.firstChild,It=at.nextSibling,Xe=ut.nextSibling,kt=Xe.firstChild,Tt=kt.nextSibling,wt=Tt.firstChild,Rt=wt.nextSibling,fr=q.nextSibling;return a(ee,D(Ge,{get when(){return f()},get children(){var ze=uD();return ze.firstChild,a(ze,f,null),we(Ct=>y(ze,{...ot.alert,...ot.errorAlert},Ct)),ze}}),se),a(ee,D(Ge,{get when(){return x()},get children(){var ze=Gh();return a(ze,x),we(Ct=>y(ze,{...ot.alert,...ot.successAlert},Ct)),ze}}),se),pe.$$input=ze=>r({invoice:ze.target.value}),a(_e,D(ju,{get value(){return o()},onChange:E,get placeholder(){return t("inventory.selectStoreLocation","Buscar y seleccionar ubicacin de tienda...")},filterType:"store",required:!0}),null),De.addEventListener("change",ze=>r({shippingMethod:ze.currentTarget.value})),Ke.addEventListener("change",ze=>r({createDate:ze.currentTarget.value})),y(Ke,FD),He.addEventListener("change",ze=>r({guide:ze.currentTarget.value})),He.style.setProperty("width","100%"),He.style.setProperty("padding","0.5rem"),He.style.setProperty("border","1px solid var(--border-color)"),He.style.setProperty("border-radius","var(--border-radius-sm)"),He.style.setProperty("background","var(--surface-color)"),a(mt,()=>t("common.all","All")),a(He,D(zt,{get each(){return ne()},children:ze=>(()=>{var Ct=kD();return Ct.value=ze,a(Ct,ze),Ct})()}),null),It.$$input=ze=>r({description:ze.target.value}),kt.addEventListener("change",ze=>r({packagesOrder:ze.target.checked})),a(q,D(Ge,{get when(){return $e(()=>!!(e().shippingMethod&&e().invoice&&e().guide))()&&o()},get children(){return[(()=>{var ze=dD(),Ct=ze.firstChild,xt=Ct.nextSibling,tt=xt.nextSibling,bt=tt.firstChild,Mt=bt.firstChild,Wt=Mt.nextSibling,Jt=bt.nextSibling,lt=Jt.firstChild,gt=lt.nextSibling;return a(xt,D(cD,{get value(){return u()},onChange:T,label:"Buscar Cliente Existente",description:"Busque clientes existentes por nombre, telfono o ID. Si no se encuentra, complete el formulario a continuacin para crear un nuevo cliente.",placeholder:"Escriba nombre del cliente, nmero de telfono o ID para buscar..."})),Wt.$$input=$t=>Hr.updateShipperConsignee({name:$t.target.value}),gt.$$input=$t=>Hr.updateShipperConsignee({phoneNumberS:$t.target.value}),we($t=>{var et={...ot.section,"margin-top":"1rem"},Vt=ot.sectionTitle,Ht=ot.formGroup,Xt=ot.gridTwo,er=ot.formGroup,Kt=ot.label,ir=ot.input,vr=ot.formGroup,cr=ot.label,br=ot.input;return $t.e=y(ze,et,$t.e),$t.t=y(Ct,Vt,$t.t),$t.a=y(xt,Ht,$t.a),$t.o=y(tt,Xt,$t.o),$t.i=y(bt,er,$t.i),$t.n=y(Mt,Kt,$t.n),$t.s=y(Wt,ir,$t.s),$t.h=y(Jt,vr,$t.h),$t.r=y(lt,cr,$t.r),$t.d=y(gt,br,$t.d),$t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),we(()=>Wt.value=e().shipper_consignee.name),we(()=>gt.value=e().shipper_consignee.phoneNumberS||""),ze})(),(()=>{var ze=hD(),Ct=ze.firstChild,xt=Ct.nextSibling,tt=xt.nextSibling,bt=tt.firstChild,Mt=bt.nextSibling,Wt=tt.nextSibling,Jt=Wt.firstChild,lt=Jt.nextSibling,gt=Wt.nextSibling,$t=gt.firstChild,et=$t.nextSibling,Vt=gt.nextSibling,Ht=Vt.firstChild,Xt=Ht.nextSibling,er=Vt.nextSibling,Kt=er.firstChild,ir=Kt.nextSibling,vr=er.nextSibling,cr=vr.firstChild,br=cr.nextSibling;return a(xt,D(nD,{get value(){return n()},onChange:$,label:"Buscar Destinatario Existente",description:"Busque Destinatario existentes por telfono o ID. Si no se encuentra, complete el formulario a continuacin para crear un nuevo destinatario.",placeholder:"Escriba nombre del destinatario, nmero de telfono o ID para buscar..."})),Mt.$$input=Nt=>Hr.updateShipperConsignee({firstName:Nt.target.value}),lt.$$input=Nt=>Hr.updateShipperConsignee({lastName:Nt.target.value}),et.$$input=Nt=>Hr.updateShipperConsignee({cid:Nt.target.value}),Xt.$$input=Nt=>Hr.updateShipperConsignee({passport:Nt.target.value}),ir.$$input=Nt=>Hr.updateShipperConsignee({phoneNumber:Nt.target.value}),br.$$input=Nt=>Hr.updateShipperConsignee({address:Nt.target.value}),we(Nt=>{var Et={...ot.section,"margin-top":"1rem"},Cr=ot.sectionTitle,Tr=ot.formGroup,mr=ot.formGroup,gr=ot.label,Er=ot.input,Wr=ot.formGroup,ur=ot.label,un=ot.input,yn=ot.formGroup,zn=ot.label,bn=ot.input,gn=ot.formGroup,kr=ot.label,Un=ot.input,ei=ot.formGroup,pi=ot.label,tr=ot.input,Nr=ot.formGroup,Vr=ot.label,_n=ot.textarea;return Nt.e=y(ze,Et,Nt.e),Nt.t=y(Ct,Cr,Nt.t),Nt.a=y(xt,Tr,Nt.a),Nt.o=y(tt,mr,Nt.o),Nt.i=y(bt,gr,Nt.i),Nt.n=y(Mt,Er,Nt.n),Nt.s=y(Wt,Wr,Nt.s),Nt.h=y(Jt,ur,Nt.h),Nt.r=y(lt,un,Nt.r),Nt.d=y(gt,yn,Nt.d),Nt.l=y($t,zn,Nt.l),Nt.u=y(et,bn,Nt.u),Nt.c=y(Vt,gn,Nt.c),Nt.w=y(Ht,kr,Nt.w),Nt.m=y(Xt,Un,Nt.m),Nt.f=y(er,ei,Nt.f),Nt.y=y(Kt,pi,Nt.y),Nt.g=y(ir,tr,Nt.g),Nt.p=y(vr,Nr,Nt.p),Nt.b=y(cr,Vr,Nt.b),Nt.T=y(br,_n,Nt.T),Nt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),we(()=>Mt.value=e().shipper_consignee.firstName||""),we(()=>lt.value=e().shipper_consignee.lastName||""),we(()=>et.value=e().shipper_consignee.cid||""),we(()=>Xt.value=e().shipper_consignee.passport||""),we(()=>ir.value=e().shipper_consignee.phoneNumber||""),we(()=>br.value=e().shipper_consignee.address||""),ze})()]}}),null),a(fr,D(Ge,{get when(){return $e(()=>!!(e().shippingMethod&&e().invoice&&e().shipper_consignee?.cid))()&&e().shipper_consignee?.name},get children(){return[(()=>{var ze=pD(),Ct=ze.firstChild,xt=Ct.firstChild,tt=xt.nextSibling;return tt.$$click=P,a(ze,D(zt,{get each(){return e().reservas},children:bt=>D(BD,{updateReserva:b,reserva:bt,removeReserva:H})}),null),a(ze,D(Ge,{get when(){return e().reservas.length>0},get children(){var bt=bb(),Mt=bt.firstChild;return Mt.firstChild,bt.style.setProperty("margin-top","0.75rem"),bt.style.setProperty("padding-top","0.75rem"),bt.style.setProperty("border-top","1px solid var(--border-color)"),bt.style.setProperty("text-align","right"),a(Mt,()=>R().toFixed(),null),bt}}),null),we(bt=>{var Mt={...ot.section,"margin-top":"1rem"},Wt={...ot.sectionTitle,"justify-content":"space-between"},Jt={...ot.button,...ot.successButton};return bt.e=y(ze,Mt,bt.e),bt.t=y(Ct,Wt,bt.t),bt.a=y(tt,Jt,bt.a),bt},{e:void 0,t:void 0,a:void 0}),ze})(),(()=>{var ze=fD(),Ct=ze.firstChild,xt=Ct.nextSibling,tt=xt.firstChild;return a(xt,D(K7,{value:"",onChange:re,get placeholder(){return t("inventory.searchProductsToAdd","Buscar productos por nombre, SKU o categora para agregar a la factura...")},searchDelay:300,maxResults:15}),null),a(ze,D(zt,{get each(){return e().products},children:bt=>D(jD,{product:bt,updateProduct:B,removeProduct:_})}),null),a(ze,D(Ge,{get when(){return e().products.length>0},get children(){var bt=bb(),Mt=bt.firstChild;return Mt.firstChild,bt.style.setProperty("margin-top","0.75rem"),bt.style.setProperty("padding-top","0.75rem"),bt.style.setProperty("border-top","1px solid var(--border-color)"),bt.style.setProperty("text-align","right"),a(Mt,()=>K().toFixed(),null),bt}}),null),we(bt=>{var Mt={...ot.section,"margin-top":"1rem"},Wt={...ot.sectionTitle,"justify-content":"space-between"},Jt=ot.formGroup,lt=ot.label;return bt.e=y(ze,Mt,bt.e),bt.t=y(Ct,Wt,bt.t),bt.a=y(xt,Jt,bt.a),bt.o=y(tt,lt,bt.o),bt},{e:void 0,t:void 0,a:void 0,o:void 0}),ze})(),(()=>{var ze=bD(),Ct=ze.firstChild,xt=Ct.nextSibling,tt=xt.nextSibling,bt=tt.firstChild;bt.firstChild;var Mt=bt.nextSibling,Wt=Mt.nextSibling,Jt=Wt.nextSibling,lt=tt.nextSibling,gt=lt.firstChild,$t=gt.firstChild,et=$t.nextSibling,Vt=gt.nextSibling,Ht=Vt.firstChild,Xt=Ht.nextSibling,er=lt.nextSibling,Kt=er.firstChild,ir=Kt.nextSibling,vr=er.nextSibling,cr=vr.firstChild,br=cr.firstChild,Nt=br.firstChild,Et=Nt.nextSibling;Et.firstChild;var Cr=br.nextSibling,Tr=Cr.firstChild,mr=Tr.nextSibling;mr.firstChild;var gr=cr.nextSibling,Er=gr.firstChild,Wr=Er.firstChild,ur=Wr.nextSibling;ur.firstChild;var un=Er.nextSibling,yn=vr.nextSibling,zn=yn.firstChild,bn=zn.nextSibling,gn=bn.nextSibling,kr=gn.nextSibling,Un=kr.firstChild,ei=Un.firstChild,pi=ei.firstChild,tr=ei.nextSibling,Nr=tr.firstChild,Vr=Nr.nextSibling;Vr.nextSibling;var _n=tr.nextSibling,qr=_n.firstChild,Lr=_n.nextSibling,ti=Lr.firstChild,ri=ti.nextSibling;return ri.nextSibling,tt.style.setProperty("display","flex"),tt.style.setProperty("gap","0.5rem"),tt.style.setProperty("margin-bottom","1rem"),tt.style.setProperty("flex-wrap","wrap"),bt.$$click=()=>I("cash"),a(bt,D(Ge,{get when(){return $e(()=>!!e()?.paymentMethods.exemptTaxOnCash)()&&e()?.paymentMethods.taxPercent>0},get children(){var _t=mD();return _t.style.setProperty("font-size","0.6rem"),_t.style.setProperty("display","block"),_t.style.setProperty("line-height","1"),_t}}),null),Mt.$$click=()=>I("zelle"),Wt.$$click=()=>I("creditCard"),Jt.$$click=F,et.$$input=_t=>M("cash",parseFloat(_t.target.value)||0),Xt.$$input=_t=>M("zelle",parseFloat(_t.target.value)||0),ir.$$input=_t=>M("creditCard",parseFloat(_t.target.value)||0),vr.style.setProperty("margin-top","1rem"),vr.style.setProperty("padding-top","1rem"),vr.style.setProperty("border-top","1px solid var(--border-color)"),vr.style.setProperty("display","grid"),vr.style.setProperty("grid-template-columns","1fr 1fr"),vr.style.setProperty("gap","1rem"),vr.style.setProperty("font-size","0.875rem"),a(Et,()=>le().toFixed(),null),a(mr,()=>L().toFixed(),null),gr.style.setProperty("text-align","right"),a(ur,()=>U().toFixed(),null),un.style.setProperty("font-weight","500"),a(un,(()=>{var _t=$e(()=>Math.round(L())===0);return()=>_t()?" Pagado Completo":L()>0?"Falta Pagar":"Sobrepago"})()),a(yn,D(Ge,{get when(){return $e(()=>e()?.paymentMethods.taxPercent>0)()&&k()>0},get children(){var _t=yD(),ar=_t.firstChild,vn=ar.nextSibling;vn.firstChild;var nn=vn.nextSibling,Gr=nn.firstChild,Jn=Gr.nextSibling,ni=Jn.nextSibling,co=ni.nextSibling;co.nextSibling;var Pn=nn.nextSibling,Bi=Pn.firstChild,fi=Bi.nextSibling,Rn=fi.nextSibling,Rr=Rn.nextSibling;return Rr.nextSibling,_t.style.setProperty("margin-top","0.5rem"),_t.style.setProperty("padding","0.5rem"),_t.style.setProperty("background","var(--strip-color)"),_t.style.setProperty("border-radius","var(--border-radius-sm)"),_t.style.setProperty("font-size","0.75rem"),_t.style.setProperty("border","1px solid var(--border-color)"),ar.style.setProperty("font-weight","500"),ar.style.setProperty("margin-bottom","0.25rem"),a(vn,()=>k().toFixed(2),null),a(nn,()=>(k()*e()?.paymentMethods?.taxPercent/100).toFixed(2),Jn),a(nn,()=>(k()+k()*e()?.paymentMethods?.taxPercent/100).toFixed(2),co),a(Pn,()=>W().toFixed(2),fi),a(Pn,()=>U().toFixed(2),Rr),we(mi=>{var yi=e()?.paymentMethods?.taxOnTotal?"var(--primary-color)":"var(--text-muted)",nr=e()?.paymentMethods?.taxOnTotal?"var(--text-muted)":"var(--primary-color)";return yi!==mi.e&&((mi.e=yi)!=null?nn.style.setProperty("color",yi):nn.style.removeProperty("color")),nr!==mi.t&&((mi.t=nr)!=null?Pn.style.setProperty("color",nr):Pn.style.removeProperty("color")),mi},{e:void 0,t:void 0}),_t}}),gn),gn.$$input=_t=>M("taxPercent",parseFloat(_t.target.value)||0),kr.style.setProperty("margin-top","0.5rem"),kr.style.setProperty("align-items","center"),kr.style.setProperty("gap","0.5rem"),Un.style.setProperty("margin-top","0.5rem"),pi.addEventListener("change",()=>M("taxOnTotal",!1)),a(tr,()=>e()?.paymentMethods?.taxPercent,Vr),a(tr,(()=>{var _t=$e(()=>e()?.paymentMethods?.taxPercent>0&&!e()?.paymentMethods?.taxOnTotal);return()=>_t()&&(()=>{var ar=_b(),vn=ar.firstChild,nn=vn.nextSibling;return nn.nextSibling,ar.style.setProperty("color","var(--primary-color)"),a(ar,()=>(k()*e()?.paymentMethods?.taxPercent/100).toFixed(2),nn),ar})()})(),null),qr.addEventListener("change",()=>M("taxOnTotal",!0)),a(Lr,()=>e()?.paymentMethods?.taxPercent,ri),a(Lr,(()=>{var _t=$e(()=>!!(e()?.paymentMethods?.taxPercent>0&&e()?.paymentMethods?.taxOnTotal));return()=>_t()&&(()=>{var ar=_b(),vn=ar.firstChild,nn=vn.nextSibling;return nn.nextSibling,ar.style.setProperty("color","var(--primary-color)"),a(ar,()=>W().toFixed(2),nn),ar})()})(),null),a(kr,D(Ge,{get when(){return e()?.paymentMethods?.taxPercent>0},get children(){var _t=vD(),ar=_t.firstChild,vn=ar.firstChild,nn=ar.nextSibling;return _t.style.setProperty("margin-top","1rem"),_t.style.setProperty("padding-top","1rem"),_t.style.setProperty("border-top","1px solid var(--border-color)"),vn.addEventListener("change",Gr=>G("exemptTaxOnCash",Gr.target.checked)),a(_t,D(Ge,{get when(){return $e(()=>!!e()?.paymentMethods?.exemptTaxOnCash)()&&le()>0},get children(){var Gr=gD(),Jn=Gr.firstChild,ni=Jn.nextSibling,co=ni.firstChild,Pn=co.nextSibling,Bi=Pn.nextSibling,fi=Bi.nextSibling;fi.nextSibling;var Rn=ni.nextSibling;Rn.firstChild;var Rr=Rn.nextSibling,mi=Rr.firstChild,yi=mi.nextSibling;return yi.nextSibling,Gr.style.setProperty("margin-top","0.5rem"),Gr.style.setProperty("padding","0.75rem"),Gr.style.setProperty("background","#e8f5e9"),Gr.style.setProperty("border-radius","var(--border-radius-sm)"),Gr.style.setProperty("font-size","0.875rem"),Gr.style.setProperty("border","1px solid #c8e6c9"),Jn.style.setProperty("font-weight","500"),Jn.style.setProperty("color","#2e7d32"),Jn.style.setProperty("margin-bottom","0.5rem"),a(ni,()=>e().paymentMethods.cash.toFixed(2),Pn),a(ni,()=>(e().paymentMethods.cash/le()*100).toFixed(1),fi),Rn.style.setProperty("color","#4CAF50"),Rn.style.setProperty("font-weight","500"),a(Rn,()=>z().toFixed(2),null),Rr.style.setProperty("font-size","0.8rem"),Rr.style.setProperty("color","#666"),Rr.style.setProperty("margin-top","0.25rem"),a(Rr,()=>(W()+z()).toFixed(2),yi),a(Rr,()=>W().toFixed(2),null),Gr}}),null),we(Gr=>{var Jn={...ot.label,display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"0.5rem"},ni=ot.fieldDescription;return Gr.e=y(ar,Jn,Gr.e),Gr.t=y(nn,ni,Gr.t),Gr},{e:void 0,t:void 0}),we(()=>vn.checked=e()?.paymentMethods?.exemptTaxOnCash),_t}}),null),we(_t=>{var ar={...ot.section,"margin-top":"1rem"},vn=ot.sectionTitle,nn=ot.fieldDescription,Gr={...ot.button,...e()?.paymentMethods.exemptTaxOnCash&&e()?.paymentMethods.taxPercent>0?{background:"#4CAF50",color:"white"}:ot.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem",position:"relative"},Jn=e()?.paymentMethods.exemptTaxOnCash&&e()?.paymentMethods.taxPercent>0?`Pagar todo en efectivo (Ahorro: $${(k()*e()?.paymentMethods.taxPercent/100).toFixed(2)})`:"Pagar todo en efectivo",ni={...ot.button,...ot.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem"},co={...ot.button,...ot.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem"},Pn={...ot.button,background:"#f44336",color:"white","font-size":"0.75rem",padding:"0.5rem 0.75rem"},Bi=ot.gridTwo,fi=ot.formGroup,Rn=ot.label,Rr=ot.input,mi=ot.formGroup,yi=ot.label,nr=ot.input,uo=ot.formGroup,Ua=ot.label,ji=ot.input,Vo=parseFloat(L().toFixed())===0?"#4CAF50":L()>0?"#f44336":"#FF9800",ii=parseFloat(L().toFixed())===0?"#4CAF50":"#f44336",qo=ot.formGroup,fs=ot.label,zo=ot.fieldDescription,Uo=ot.input,Us={...ot.label,display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.8rem","margin-bottom":"0.25rem"},Zi={...ot.fieldDescription,"margin-left":"1.5rem","margin-bottom":"0.5rem"},Ni={...ot.label,display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.8rem","margin-bottom":"0.25rem"},eo={...ot.fieldDescription,"margin-left":"1.5rem"};return _t.e=y(ze,ar,_t.e),_t.t=y(Ct,vn,_t.t),_t.a=y(xt,nn,_t.a),_t.o=y(bt,Gr,_t.o),Jn!==_t.i&&Qt(bt,"title",_t.i=Jn),_t.n=y(Mt,ni,_t.n),_t.s=y(Wt,co,_t.s),_t.h=y(Jt,Pn,_t.h),_t.r=y(lt,Bi,_t.r),_t.d=y(gt,fi,_t.d),_t.l=y($t,Rn,_t.l),_t.u=y(et,Rr,_t.u),_t.c=y(Vt,mi,_t.c),_t.w=y(Ht,yi,_t.w),_t.m=y(Xt,nr,_t.m),_t.f=y(er,uo,_t.f),_t.y=y(Kt,Ua,_t.y),_t.g=y(ir,ji,_t.g),Vo!==_t.p&&((_t.p=Vo)!=null?Cr.style.setProperty("color",Vo):Cr.style.removeProperty("color")),ii!==_t.b&&((_t.b=ii)!=null?un.style.setProperty("color",ii):un.style.removeProperty("color")),_t.T=y(yn,qo,_t.T),_t.A=y(zn,fs,_t.A),_t.O=y(bn,zo,_t.O),_t.I=y(gn,Uo,_t.I),_t.S=y(ei,Us,_t.S),_t.W=y(tr,Zi,_t.W),_t.C=y(_n,Ni,_t.C),_t.B=y(Lr,eo,_t.B),_t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),we(()=>et.value=e().paymentMethods.cash),we(()=>Xt.value=e().paymentMethods.zelle),we(()=>ir.value=e().paymentMethods.creditCard),we(()=>gn.value=e()?.paymentMethods?.taxPercent),we(()=>pi.checked=!e()?.paymentMethods?.taxOnTotal),we(()=>qr.checked=e()?.paymentMethods?.taxOnTotal),ze})(),(()=>{var ze=wD(),Ct=ze.firstChild;Ct.firstChild;var xt=Ct.nextSibling;xt.firstChild;var tt=xt.nextSibling;tt.firstChild;var bt=tt.nextSibling;return bt.firstChild,Ct.style.setProperty("font-size","0.875rem"),Ct.style.setProperty("opacity","0.9"),a(Ct,()=>K().toFixed(),null),xt.style.setProperty("font-size","0.875rem"),xt.style.setProperty("opacity","0.9"),a(xt,()=>R().toFixed(),null),tt.style.setProperty("font-size","0.875rem"),tt.style.setProperty("opacity","0.9"),tt.style.setProperty("border-top","1px solid rgba(255,255,255,0.2)"),tt.style.setProperty("padding-top","0.5rem"),tt.style.setProperty("margin-top","0.5rem"),a(tt,()=>k().toFixed(2),null),a(ze,D(Ge,{get when(){return e()?.paymentMethods?.taxPercent>0},get children(){var Mt=SD(),Wt=Mt.firstChild,Jt=Wt.nextSibling,lt=Jt.nextSibling,gt=lt.nextSibling;return gt.nextSibling,Mt.style.setProperty("font-size","0.875rem"),Mt.style.setProperty("opacity","0.9"),a(Mt,()=>e()?.paymentMethods?.taxPercent,Jt),a(Mt,()=>e()?.paymentMethods?.taxOnTotal?"del total":"del subtotal",gt),a(Mt,()=>W().toFixed(2),null),a(Mt,D(Ge,{get when(){return $e(()=>!!e()?.paymentMethods?.exemptTaxOnCash)()&&z()>0},get children(){var $t=_D(),et=$t.firstChild,Vt=et.nextSibling;return Vt.nextSibling,$t.style.setProperty("color","#4CAF50"),$t.style.setProperty("margin-left","0.5rem"),a($t,()=>z().toFixed(2),Vt),$t}}),null),Mt}}),bt),a(ze,D(Ge,{get when(){return e().shippingMethod},get children(){var Mt=PD();return Mt.firstChild,Mt.style.setProperty("font-size","0.875rem"),Mt.style.setProperty("opacity","0.9"),a(Mt,()=>e().shippingMethod==="aereo"?" Areo":" Martimo",null),Mt}}),bt),bt.style.setProperty("font-size","1.5rem"),bt.style.setProperty("font-weight","700"),bt.style.setProperty("margin-top","0.5rem"),bt.style.setProperty("border-top","1px solid rgba(255,255,255,0.3)"),bt.style.setProperty("padding-top","0.5rem"),a(bt,()=>U().toFixed(0),null),we(Mt=>y(ze,ot.totalSection,Mt)),ze})(),D(Ge,{get when(){return Hr.isDirty||Hr.lastSaved},get children(){var ze=ID(),Ct=ze.firstChild;return ze.style.setProperty("margin-top","1rem"),ze.style.setProperty("background","rgba(76, 175, 80, 0.1)"),ze.style.setProperty("border","1px solid rgba(76, 175, 80, 0.3)"),ze.style.setProperty("border-radius","var(--border-radius-sm)"),ze.style.setProperty("padding","0.75rem"),Ct.style.setProperty("display","flex"),Ct.style.setProperty("align-items","center"),Ct.style.setProperty("justify-content","space-between"),Ct.style.setProperty("font-size","0.875rem"),a(Ct,D(Ge,{get when(){return Hr.isDirty},get children(){var xt=xD(),tt=xt.firstChild;return xt.style.setProperty("color","#4CAF50"),xt.style.setProperty("display","flex"),xt.style.setProperty("align-items","center"),xt.style.setProperty("gap","0.5rem"),tt.style.setProperty("width","8px"),tt.style.setProperty("height","8px"),tt.style.setProperty("background","#4CAF50"),tt.style.setProperty("border-radius","50%"),tt.style.setProperty("display","inline-block"),tt.style.setProperty("animation","pulse 2s infinite"),xt}}),null),a(Ct,D(Ge,{get when(){return!Hr.isDirty&&Hr.lastSaved},get children(){var xt=AD(),tt=xt.firstChild;return tt.nextSibling,xt.style.setProperty("color","#4CAF50"),xt.style.setProperty("display","flex"),xt.style.setProperty("align-items","center"),xt.style.setProperty("gap","0.5rem"),tt.style.setProperty("width","8px"),tt.style.setProperty("height","8px"),tt.style.setProperty("background","#4CAF50"),tt.style.setProperty("border-radius","50%"),tt.style.setProperty("display","inline-block"),a(xt,()=>Hr.lastSaved?.toLocaleTimeString(),null),xt}}),null),a(Ct,D(Ge,{get when(){return J()},get children(){var xt=CD();return xt.$$click=V,xt.style.setProperty("background","none"),xt.style.setProperty("border","none"),xt.style.setProperty("color","#f44336"),xt.style.setProperty("cursor","pointer"),xt.style.setProperty("font-size","0.75rem"),xt.style.setProperty("text-decoration","underline"),xt}}),null),ze}}),(()=>{var ze=Gh();return ze.style.setProperty("margin-top","1rem"),a(ze,D(Ge,{get when(){return!C()},get children(){var Ct=$D();return Ct.$$click=X,a(Ct,()=>m()?" Creando Factura...":" Crear Factura"),we(xt=>{var tt=m()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round(L())>.01,bt={...ot.button,...ot.primaryButton,width:"100%","justify-content":"center",padding:"0.875rem","font-size":"1rem",opacity:m()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round(L())>.01?"0.6":"1"},Mt=e().invoice.trim()?e().shipper_consignee.name.trim()?Math.abs(L())>.01?`El balance de pago debe ser $0.00 (actual: $${L().toFixed(2)})`:"Crear esta factura":"Por favor ingrese el nombre del cliente":"Por favor ingrese un nmero de factura";return tt!==xt.e&&(Ct.disabled=xt.e=tt),xt.t=y(Ct,bt,xt.t),Mt!==xt.a&&Qt(Ct,"title",xt.a=Mt),xt},{e:void 0,t:void 0,a:void 0}),Ct}}),null),a(ze,D(Ge,{get when(){return C()},get children(){var Ct=ED(),xt=Ct.firstChild,tt=xt.nextSibling;return Ct.style.setProperty("display","grid"),Ct.style.setProperty("grid-template-columns","1fr 1fr"),Ct.style.setProperty("gap","0.75rem"),xt.$$click=Y,a(xt,()=>oe()?" Generando...":" Generar PDF"),tt.$$click=V,we(bt=>{var Mt=oe(),Wt={...ot.button,...ot.successButton,"justify-content":"center",opacity:oe()?"0.6":"1"},Jt={...ot.button,...ot.secondaryButton,"justify-content":"center"};return Mt!==bt.e&&(xt.disabled=bt.e=Mt),bt.t=y(xt,Wt,bt.t),bt.a=y(tt,Jt,bt.a),bt},{e:void 0,t:void 0,a:void 0}),Ct}}),null),ze})()]}})),we(ze=>{var Ct=ot.container,xt=ot.header,tt=ot.grid,bt=ot.section,Mt=ot.sectionTitle,Wt=ot.gridTwo,Jt=ot.formGroup,lt=ot.label,gt=ot.input,$t=l()||"INV-20241201-1234",et=ot.formGroup,Vt=ot.label,Ht=ot.gridTwo,Xt=ot.formGroup,er=ot.label,Kt=ot.fieldDescription,ir=ot.input,vr=ot.formGroup,cr=ot.label,br=ot.fieldDescription,Nt=ot.formGroup,Et=ot.label,Cr=ot.formGroup,Tr=ot.label,mr=ot.textarea,gr={...ot.label,display:"flex","align-items":"center",gap:"0.5rem"},Er=ot.fieldDescription;return ze.e=y(ee,Ct,ze.e),ze.t=y(ce,xt,ze.t),ze.a=y(se,tt,ze.a),ze.o=y(ue,bt,ze.o),ze.i=y(ye,Mt,ze.i),ze.n=y(de,Wt,ze.n),ze.s=y(ge,Jt,ze.s),ze.h=y(xe,lt,ze.h),ze.r=y(pe,gt,ze.r),$t!==ze.d&&Qt(pe,"placeholder",ze.d=$t),ze.l=y(_e,et,ze.l),ze.u=y(Re,Vt,ze.u),ze.c=y(Ee,Ht,ze.c),ze.w=y(Te,Xt,ze.w),ze.m=y(Le,er,ze.m),ze.f=y(Ie,Kt,ze.f),ze.y=y(De,ir,ze.y),ze.g=y(Ye,vr,ze.g),ze.p=y(Be,cr,ze.p),ze.b=y(We,br,ze.b),ze.T=y(st,Nt,ze.T),ze.A=y(nt,Et,ze.A),ze.O=y(ut,Cr,ze.O),ze.I=y(at,Tr,ze.I),ze.S=y(It,mr,ze.S),ze.W=y(Xe,gr,ze.W),ze.C=y(Rt,Er,ze.C),ze},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0}),we(()=>pe.value=e().invoice),we(()=>De.value=e().shippingMethod),we(()=>Ke.value=e().createDate),we(()=>He.value=e().guide),we(()=>It.value=e().description),we(()=>kt.checked=e().packagesOrder),ee})()},BD=t=>{let{reserva:e,updateReserva:r,removeReserva:n}=t;return(()=>{var i=LD(),o=i.firstChild,s=o.firstChild,l=o.nextSibling,c=l.firstChild,u=c.firstChild,h=c.nextSibling,m=h.firstChild,g=h.nextSibling,f=g.firstChild,w=g.nextSibling;return w.firstChild,a(o,D(VD,{get value(){return e.type},onChange:x=>r(e.id,"type",x),placeholder:"ej., Ropa, Zapatos, TV, tiles del Hogar...",width:"80%",index:1}),s),s.$$click=()=>n(e.id),a(c,D(Cu,{type:"number",get value(){return e.qty},update:x=>r(e.id,"qty",parseFloat(x)||0),get style(){return{...ot.input,...ot.smallInput,width:"60px"}},placeholder:"Cant",min:"1",step:"0.01",index:2}),null),a(h,D(Cu,{type:"number",get value(){return e.price},update:x=>r(e.id,"price",parseFloat(x)||0),get style(){return{...ot.input,...ot.smallInput}},placeholder:"Precio",step:"0.01",index:3}),null),a(g,D(Cu,{type:"number",get value(){return e.arancel},update:x=>r(e.id,"arancel",parseFloat(x)||0),get style(){return{...ot.input,...ot.smallInput}},placeholder:"Arancel",step:"0.01",index:4}),null),w.style.setProperty("width","80px"),w.style.setProperty("text-align","right"),w.style.setProperty("font-weight","500"),a(w,()=>e.total?.toFixed(2)||"0.00",null),a(w,D(Ge,{get when(){return!1},get children(){var x=ND(),S=x.firstChild,C=S.nextSibling,j=C.nextSibling,oe=j.nextSibling,te=oe.nextSibling,Z=te.nextSibling;return Z.nextSibling,x.style.setProperty("font-size","0.6rem"),x.style.setProperty("color","var(--text-muted)"),a(x,()=>e.qty,C),a(x,()=>e.price,oe),a(x,()=>e.arancel,Z),x}}),null),we(x=>{var S=ot.productWrapItem,C={...ot.productItem,"justify-content":"space-around"},j=ot.removeButton,oe=ot.productItem,te=ot.formGroup,Z=ot.label,re=ot.formGroup,E=ot.label,$=ot.formGroup,T=ot.label;return x.e=y(i,S,x.e),x.t=y(o,C,x.t),x.a=y(s,j,x.a),x.o=y(l,oe,x.o),x.i=y(c,te,x.i),x.n=y(u,Z,x.n),x.s=y(h,re,x.s),x.h=y(m,E,x.h),x.r=y(g,$,x.r),x.d=y(f,T,x.d),x},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),i})()},jD=t=>{let{product:e,updateProduct:r,removeProduct:n}=t;return(()=>{var i=RD(),o=i.firstChild,s=o.firstChild,l=s.firstChild,c=l.nextSibling,u=s.nextSibling,h=o.nextSibling,m=h.firstChild;return m.firstChild,s.style.setProperty("flex","1"),l.style.setProperty("font-weight","500"),l.style.setProperty("font-size","0.875rem"),a(l,()=>e?.product.label),c.style.setProperty("font-size","0.75rem"),c.style.setProperty("color","var(--text-muted)"),a(c,()=>e?.product.code),u.$$click=()=>n(e?.id),a(h,D(Cu,{type:"number",get value(){return e?.qty},placeholder:"Cant",update:g=>r(e?.id,"qty",parseFloat(g)||0)}),m),a(h,D(Cu,{type:"number",get value(){return e?.salePrice},placeholder:"Precio",update:g=>r(e?.id,"salePrice",parseFloat(g)||0)}),m),m.style.setProperty("width","80px"),m.style.setProperty("text-align","right"),m.style.setProperty("font-weight","500"),a(m,()=>e?.total.toFixed(2),null),we(g=>{var f=ot.productWrapItem,w=ot.productItem,x=ot.removeButton,S=ot.productItem;return g.e=y(i,f,g.e),g.t=y(o,w,g.t),g.a=y(u,x,g.a),g.o=y(h,S,g.o),g},{e:void 0,t:void 0,a:void 0,o:void 0}),i})()},Cu=t=>{const[e,r]=Ce("");Cn(()=>{t?.value!==void 0&&r(t.value.toString())});const n=o=>{(o.key==="Enter"||o.key==="Escape"||o.key==="Tab")&&t.update&&_l(e())&&t.update(e())},i=()=>{t.update&&_l(e())&&t.update(e())};return(()=>{var o=DD();return o.addEventListener("blur",i),o.$$keydown=n,o.$$input=s=>r(s.target.value),we(s=>{var l=t?.type,c={...ot.input,...ot.smallInput,width:t?.width||"90px"},u=t.placeholder,h=t.title,m=t?.index;return l!==s.e&&Qt(o,"type",s.e=l),s.t=y(o,c,s.t),u!==s.a&&Qt(o,"placeholder",s.a=u),h!==s.o&&Qt(o,"title",s.o=h),m!==s.i&&Qt(o,"tabindex",s.i=m),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>o.value=e()),o})()},VD=t=>{const[e,r]=Ce(!1),[n,i]=Ce(""),[o,s]=Ce(-1),l=()=>{const oe=n().toLowerCase();if(!oe)return Sb;const te=Sb.filter(Z=>Z.toLowerCase().includes(oe));return te.length===0&&oe.length>0?[` Agregar "${n()}"`]:te},c=()=>{r(!0),i(""),s(-1)},u=oe=>{const Z=oe.target.value;i(Z),r(Z.length>0),s(-1)},h=oe=>{let te;oe.startsWith(" Agregar")?te=n():te=oe.replace(/^[\u{1F000}-\u{1F9FF}\u{2600}-\u{27BF}]\s*/u,""),t.onChange(te),r(!1),i(""),s(-1)},m=oe=>{const te=l();switch(oe.key){case"ArrowDown":oe.preventDefault(),s(Z=>Math.min(Z+1,te.length-1));break;case"ArrowUp":oe.preventDefault(),s(Z=>Math.max(Z-1,-1));break;case"Enter":oe.preventDefault(),o()>=0&&te[o()]?h(te[o()]):(t.onChange(n()||t.value),r(!1));break;case"Escape":r(!1),i(""),s(-1);break}},g=()=>{setTimeout(()=>{n()&&n()!==t.value&&t.onChange(n()),r(!1),i(""),s(-1)},150)},f=()=>e()&&n()?n():t.value||"",w={position:"relative",width:t.width||"100%",flex:t.width?void 0:"1"},x={...ot.input,width:"100%","padding-right":"2rem"},S={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"200px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},C=oe=>({padding:"0.5rem 0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:oe?"var(--strip-color)":"transparent",color:oe?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease","font-size":"0.875rem"}),j={position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)","pointer-events":"none",color:"var(--text-muted)","font-size":"0.75rem"};return(()=>{var oe=MD(),te=oe.firstChild,Z=te.firstChild,re=Z.nextSibling;return te.style.setProperty("position","relative"),Z.addEventListener("blur",g),Z.$$keydown=m,Z.$$click=c,Z.$$input=u,a(re,()=>e()?"":""),a(oe,D(Ge,{get when(){return $e(()=>!!e())()&&l().length>0},get children(){var E=Gh();return a(E,D(zt,{get each(){return l()},children:($,T)=>{const B=$.startsWith(" Agregar");return(()=>{var _=Gh();return _.addEventListener("mouseenter",()=>s(T())),_.$$click=()=>h($),a(_,$),we(P=>y(_,{...C(T()===o()),...B&&{"font-style":"italic","border-left":"3px solid var(--primary-color)",background:T()===o()?"var(--primary-color)":"#f0f8ff",color:T()===o()?"white":"var(--primary-color)"}},P)),_})()}})),we($=>y(E,S,$)),E}}),null),we(E=>{var $=w,T=x,B=t.placeholder,_=t?.index,P=j;return E.e=y(oe,$,E.e),E.t=y(Z,T,E.t),B!==E.a&&Qt(Z,"placeholder",E.a=B),_!==E.o&&Qt(Z,"tabindex",E.o=_),E.i=y(re,P,E.i),E},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),we(()=>Z.value=f()),oe})()};pr(["input","click","keydown"]);const qD={common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",view:"View",unknown:"Unknown",details:"Details",notAvailable:"N/A",download:"Download",upload:"Upload",print:"Print",export:"Export",import:"Import",exportCSV:"Export CSV",exportExcel:"Export Excel",showing:"Showing",of:"of",dateFrom:"Date From",dateTo:"Date To",showFilters:"Show Filters",hideFilters:"Hide Filters",clearFilters:"Clear Filters"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",inventoryManagement:"Inventory Management",employees:"Employees",employeeManagement:"Employee Management",entryBooks:"Entry Books",journalEntries:"Journal Entries",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings",logout:"Logout",home:"Home",hbl:"House Bill of Lading"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalEquity:"Total Equity",totalRevenue:"Total Revenue",totalExpenses:"Total Expenses",netIncome:"Net Income",cashBalance:"Cash Balance",accountsReceivable:"Accounts Receivable",accountsPayable:"Accounts Payable",inventoryValue:"Inventory Value",lowStockItems:"Low Stock Items",pendingInvoices:"Pending Invoices",employeeCount:"Employee Count",monthlyPayroll:"Monthly Payroll"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"},allAccounts:"All Accounts"},banking:{title:"Banking",unreconciled:"Unreconciled",reconciled:"Reconciled",reconciliation:"Reconciliation",notReconciled:"Not Reconciled"},balanceSheet:{title:"Balance Sheet",asOf:"As of",assets:"Assets",liabilities:"Liabilities",equity:"Equity",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalEquity:"Total Equity",currentAssets:"Current Assets",nonCurrentAssets:"Non-current Assets",currentLiabilities:"Current Liabilities",nonCurrentLiabilities:"Non-current Liabilities",retainedEarnings:"Retained Earnings",commonStock:"Common Stock",generateReport:"Generate Report",exportPDF:"Export PDF",exportExcel:"Export Excel"},inventory:{title:"Inventory Management",products:"Products",locations:"Locations",movements:"Movements",overview:"Overview",addProduct:"Add Product",addLocation:"Add Location",addMovement:"Add Movement",bulkMovement:"Bulk Movement",productName:"Product Name",productCode:"Product Code",sku:"SKU",category:"Category",quantity:"Quantity",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",totalValue:"Total Value",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",reorderPoint:"Reorder Point",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",address:"Address",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",recentMovements:"Recent Movements",searchProducts:"Search products...",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",activeProducts:"Active Products",totalLocations:"Total Locations",activeLocations:"Active Locations",lowStockAlert:"Low Stock Alert",productsNeedRestocking:"products need restocking",lastSeen:"Last seen",noProducts:"No products at this location",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees..."},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",addEntry:"Add Journal Entry",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",post:"Post",postEntry:"Post Entry",voidEntry:"Void Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",balanced:"Balanced",notBalanced:"Not Balanced",outOfBalance:"Out of Balance",unbalanced:"Unbalanced",recurringEntry:"Recurring Entry",attachments:"Attachments",draftEntry:"Draft Entry",postedEntry:"Posted Entry",totalDebits:"Total Debits",totalCredits:"Total Credits",totalDebit:"Total Debit",totalCredit:"Total Credit",totalAmount:"Total Amount",debitShort:"Dr.",creditShort:"Cr.",allEntries:"All Entries",noReference:"No reference",createdBy:"By",lines:"Lines",entryLines:"Journal Entry Lines",journalLines:"Journal Lines",addLine:"Add Line",lineDescription:"Line description",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",balanceStatus:"Balance Status",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",fixBalance:"Fix Balance",editEntryTooltip:"Edit this journal entry",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",draftEntryDescription:"This entry can be edited and posted.",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",entryMustBeBalanced:"Entry must be balanced to post",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",entryNotBalancedShort:"Entry is not balanced",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number",quickEntry:"Quick Journal Entry",selectCategory:"Select Category",selectTemplate:"Select Template",chooseCategory:"Choose a category...",chooseTemplate:"Choose a template...",enterAmounts:"Enter Amounts",entryPreview:"Entry Preview",createQuickEntry:"Create Quick Entry",templateRequired:"Please select a template",amountRequired:"Amount is required for {field}",templates:"Templates",manageTemplates:"Manage Templates",addNewTemplate:"Add New Template",templateDetails:"Template Details",newTemplate:"New Template",editTemplate:"Edit Template",templateName:"Template Name",enterTemplateName:"Enter template name",enterTemplateDescription:"Enter template description",category:"Category",templateLines:"Template Lines",type:"Type",amountType:"Amount Type",fieldName:"Field Name",selectAccount:"Select account...",variable:"Variable",fixed:"Fixed",fieldNamePlaceholder:"e.g., Amount",custom:"Custom",templateNameRequired:"Template name is required",templateDescriptionRequired:"Template description is required",lineDescriptionRequired:"Line {lineNumber}: Description is required",amountFieldNameRequired:"Line {lineNumber}: Amount field name is required",confirmDeleteTemplate:"Are you sure you want to delete this template?",selectTemplateToView:"Select a template from the list to view details",orCreateNew:"or create a new custom template",reconciliationSummary:"Reconciliation Summary",totalLines:"Total Lines",bankAccounts:"Bank Accounts",bankReconciled:"Bank Reconciled",bankPending:"Bank Pending",reconciledLines:"Reconciled Lines",unreconciledLines:"Unreconciled Lines",fullyReconciled:"Fully Reconciled",partiallyReconciled:"Partially Reconciled",unreconciled:"Unreconciled",reconciled:"Reconciled",pending:"Pending",matched:"Matched",manual:"Manual",pendingBankReconciliation:"Pending Bank Reconciliation",visitBankConsolidations:"Visit Bank Consolidations to reconcile these transactions",reconciliationTip:"Reconciliation Tip",unreconciledBankTransactions:"This entry has unreconciled bank account transactions.",bankAccount:"bank account",currentUser:"Current User",errorDeletingTemplate:"Error deleting template",errorSavingTemplate:"Error saving template",noLines:"No lines",noTemplateLines:"No template lines"},invoiceReport:{title:"Invoice Resume Report",filters:"Filters",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",paymentMethod:"Payment Method",allMethods:"All Methods",cash:"Cash",zelle:"Zelle",other:"Other",shippingType:"Shipping Type",allTypes:"All Types",maritime:" Maritime",air:" Air",generateReport:"Generate Report",loading:"Loading...",print:" Print",exportPdf:" Export PDF",generating:" Generating...",close:"Close",invoiceSummary:"Invoice Summary",totalInvoices:"Total Invoices",dateRange:"Date Range",store:"Store",shippingTypeLabel:"Shipping Type",notSet:"Not Set",paymentMethods:"Payment Methods",total:"Total",additionalCharges:"Additional Charges",transport:"Transport",aranceles:"Aranceles",tax:"Tax",productsSummary:"Products Summary",productType:"Product Type",quantity:"Quantity",totalValue:"Total Value",avgPrice:"Avg Price",reservasSummary:"Reservas Summary (Grouped by Price)",reservaType:"Reserva Type",totalQtyLbs:"Total Qty (lbs)",priceGroups:"Price Groups (Price  Qty)",otherServicesTitle:"Other Services & Charges",serviceType:"Service Type",totalOtherServices:"Total Other Services",totalSummary:"Total Summary",productsTotal:"Products Total",reservasTotal:"Reservas Total",transportServices:"Transport & Services",grandTotal:"GRAND TOTAL",invoiceReferences:"Invoice References",type:"Type",pricePerPound:"Price per pound",totalInvoicesCount:"Total invoices",invoiceNumbers:"Invoice Numbers",copyInvoiceNumbers:" Copy Invoice Numbers",reportPeriod:"Report Period",allTimeReport:"All Time Report",generatedOn:"Generated on",generatingReport:"Generating report...",pdfGenerationFailed:"PDF generation failed. Using print instead.",invoiceNumbersCopied:"Invoice numbers copied to clipboard!",allTypesOption:"All Types",seaOption:" Maritime",airOption:" Air",allMethodsOption:"All Methods",cashOption:"Cash",zelleOption:"Zelle",otherOption:"Other",pdf:{title:"Invoice Resume Report",subtitle:"Comprehensive Financial Summary",paymentMethodsSummary:"Payment Methods Summary",productsSummary:"Products Summary",reservasSummary:"Reservas Summary (Grouped by Price)",otherServicesTitle:"Other Services & Charges",totalSummary:"Total Summary",paymentMethod:"Payment Method",amount:"Amount",product:"Product",quantity:"Quantity",total:"Total",type:"Type",totalQty:"Total Qty",priceGroups:"Price Groups",serviceType:"Service Type",productsTotal:"Products Total",reservasTotal:"Reservas Total",transportServices:"Transport & Services",grandTotal:"GRAND TOTAL",generatedOn:"Generated on:",all:"All",reportDate:"Report Date:",dateRange:"Date Range:",totalInvoices:"Total Invoices:",allTypes:"All Types",lbs:"lbs",page:"Page",of:"of"}},entryBooks:{title:"Entry Books",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",details:"Details",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",editEntryTooltip:"Edit this journal entry",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",post:"Post",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",voidEntry:"Void Entry",entryNotBalanced:"Entry Not Balanced",reconciliationSummary:"Reconciliation Summary",totalLines:"Total Lines",bankAccounts:"Bank Accounts",bankReconciled:"Bank Reconciled",bankPending:"Bank Pending",reconciledLines:"Reconciled Lines",manual:"Manual",pendingBankReconciliation:"Pending Bank Reconciliation",visitBankConsolidations:"Visit Bank Consolidations to reconcile these transactions",reconciliationTip:"Reconciliation Tip",unreconciledBankTransactions:"This entry has unreconciled bank account transactions.",unreconciledLines:"Unreconciled Lines",fullyReconciled:"Fully Reconciled",partiallyReconciled:"Partially Reconciled",unreconciled:"Unreconciled",reconciled:"Reconciled",pending:"Pending",matched:"Matched",noDescription:"No description",bankAccount:"bank account",currentUser:"Current User",errorDeletingTemplate:"Error deleting template",errorSavingTemplate:"Error saving template",noLines:"No lines",noTemplateLines:"No template lines"},consolidation:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",minLength:"Minimum length is",maxLength:"Maximum length is",minValue:"Minimum value is",maxValue:"Maximum value is",passwordMismatch:"Passwords do not match",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry"},reports:{title:"Reports",incomeStatement:"Income Statement",balanceSheet:"Balance Sheet",cashFlow:"Cash Flow Statement",trialBalance:"Trial Balance",generalLedger:"General Ledger",accountsReceivable:"Accounts Receivable",accountsPayable:"Accounts Payable",inventoryReport:"Inventory Report",payrollReport:"Payroll Report",taxReport:"Tax Report",customReport:"Custom Report",dateRange:"Date Range",fromDate:"From Date",toDate:"To Date",generateReport:"Generate Report",exportOptions:"Export Options",pdf:"PDF",excel:"Excel",csv:"CSV"},settings:{title:"Settings",general:"General",company:"Company",users:"Users",security:"Security",backup:"Backup",companyName:"Company Name",companyAddress:"Company Address",taxId:"Tax ID",fiscalYear:"Fiscal Year",currency:"Currency",dateFormat:"Date Format",timeZone:"Time Zone",language:"Language",theme:"Theme",lightTheme:"Light",darkTheme:"Dark",autoBackup:"Auto Backup",backupFrequency:"Backup Frequency",lastBackup:"Last Backup",restoreBackup:"Restore Backup",exportData:"Export Data",importData:"Import Data",changePassword:"Change Password",twoFactorAuth:"Two-factor Authentication",sessionTimeout:"Session Timeout",auditLog:"Audit Log"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access",HBLAccess:"HBL Management Access"}},hbl:{title:"House Bill of Lading Management",records:"records",searchPlaceholder:"Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...",addNew:"Add New HBL",hblNumber:"HBL Number",airGuide:"Air Guide",airNumber:"Air Number",shipper:"Shipper",consignee:"Consignee",shipperPhone:"Shipper Phone",consigneePhone:"Consignee Phone",identity:"Identity",classification:"Classification",address:"Address",city:"City",state:"State",street:"Street",commodity:"Commodity",weight:"Weight",quantity:"Quantity",bagNumber:"Bag Number",agency:"Agency",guide:"Guide",guideNumber:"Guide Number",guideNo:"Guide No.",reserveDate:"Reserve Date",status:{"EN BODEGA":"In Warehouse",ENVIADO:"Shipped",ENTREGADO:"Delivered",CANCELADO:"Cancelled",PENDIENTE:"Pending"}}},zD={common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrs",next:"Siguiente",previous:"Anterior",yes:"S",no:"No",from:"Desde",to:"Hasta",loading:"Cargando...",error:"Error",success:"xito",warning:"Advertencia",info:"Informacin",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripcin",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Ingls",spanish:"Espaol",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",unknown:"Desconocido",details:"Detalles",notAvailable:"N/A",download:"Descargar",upload:"Cargar",print:"Imprimir",export:"Exportar",import:"Importar",exportCSV:"Exportar CSV",exportExcel:"Exportar Excel",showing:"Mostrando",of:"de",dateFrom:"Fecha Desde",dateTo:"Fecha Hasta",showFilters:"Mostrar Filtros",hideFilters:"Ocultar Filtros",clearFilters:"Limpiar Filtros"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",inventoryManagement:"Gestin de Inventario",employees:"Empleados",employeeManagement:"Gestin de Empleados",entryBooks:"Libros de Entrada",journalEntries:"Asientos Contables",consolidate:"Consolidacin Bancaria",reports:"Reportes",settings:"Configuracin",logout:"Cerrar Sesin",home:"Inicio",hbl:"Conocimiento de Embarque"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rpidas",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalEquity:"Patrimonio Total",totalRevenue:"Ingresos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",cashBalance:"Saldo en Efectivo",accountsReceivable:"Cuentas por Cobrar",accountsPayable:"Cuentas por Pagar",inventoryValue:"Valor del Inventario",lowStockItems:"Artculos con Bajo Stock",pendingInvoices:"Facturas Pendientes",employeeCount:"Nmero de Empleados",monthlyPayroll:"Nmina Mensual"},accounts:{title:"Plan de Cuentas",accountNumber:"Nmero de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categora",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operativos",operatingExpenses:"Gastos Operativos"},allAccounts:"Todas las Cuentas"},banking:{title:"Bancario",unreconciled:"Sin Conciliar",reconciled:"Conciliado",reconciliation:"Conciliacin",notReconciled:"No Conciliado"},balanceSheet:{title:"Balance General",asOf:"Al",assets:"Activos",liabilities:"Pasivos",equity:"Patrimonio",totalAssets:"Total de Activos",totalLiabilities:"Total de Pasivos",totalEquity:"Total de Patrimonio",currentAssets:"Activos Corrientes",nonCurrentAssets:"Activos No Corrientes",currentLiabilities:"Pasivos Corrientes",nonCurrentLiabilities:"Pasivos No Corrientes",retainedEarnings:"Utilidades Retenidas",commonStock:"Capital Social",generateReport:"Generar Reporte",exportPDF:"Exportar PDF",exportExcel:"Exportar Excel"},inventory:{title:"Gestin de Inventario",products:"Productos",locations:"Ubicaciones",movements:"Movimientos",overview:"Resumen",addProduct:"Agregar Producto",addLocation:"Agregar Ubicacin",addMovement:"Agregar Movimiento",bulkMovement:"Movimiento Masivo",productName:"Nombre del Producto",productCode:"Cdigo del Producto",sku:"SKU",category:"Categora",quantity:"Cantidad",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",totalValue:"Valor Total",minStockLevel:"Nivel Mnimo de Stock",maxStockLevel:"Nivel Mximo de Stock",reorderPoint:"Punto de Reorden",locationName:"Nombre de Ubicacin",locationType:"Tipo de Ubicacin",locationCode:"Cdigo de Ubicacin",address:"Direccin",movementType:"Tipo de Movimiento",fromLocation:"Desde Ubicacin",toLocation:"Hacia Ubicacin",referenceNumber:"Nmero de Referencia",invoiceNumber:"Nmero de Factura",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicacin",recentMovements:"Movimientos Recientes",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicacin",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",activeProducts:"Productos Activos",totalLocations:"Total de Ubicaciones",activeLocations:"Ubicaciones Activas",lowStockAlert:"Alerta de Stock Bajo",productsNeedRestocking:"productos necesitan reabastecimiento",lastSeen:"Visto por ltima vez",noProducts:"No hay productos en esta ubicacin",warehouseType:"Almacn",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente"},employees:{title:"Gestin de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Informacin Personal",employmentInfo:"Informacin Laboral",payrollInfo:"Informacin de Nmina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrnico",phone:"Telfono",address:"Direccin",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratacin",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nmina Total",searchEmployees:"Buscar empleados..."},journal:{title:"Asientos Contables",entryNumber:"Nmero de Asiento",entryDate:"Fecha del Asiento",debit:"Dbito",credit:"Crdito",account:"Cuenta",memo:"Nota",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",addEntry:"Agregar Asiento Contable",updateEntry:"Actualizar Asiento",saveAsDraft:"Guardar como Borrador",post:"Registrar",postEntry:"Registrar Asiento",voidEntry:"Anular Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",balanced:"Balanceado",notBalanced:"No Balanceado",outOfBalance:"Desbalanceado",unbalanced:"Desbalanceado",recurringEntry:"Asiento Recurrente",attachments:"Archivos Adjuntos",draftEntry:"Asiento Borrador",postedEntry:"Asiento Registrado",totalDebits:"Dbitos Totales",totalCredits:"Crditos Totales",totalDebit:"Dbito Total",totalCredit:"Crdito Total",totalAmount:"Monto Total",debitShort:"Db.",creditShort:"Cr.",allEntries:"Todos los Asientos",noReference:"Sin referencia",createdBy:"Por",lines:"Lneas",entryLines:"Lneas del Asiento Contable",journalLines:"Lneas del Diario",addLine:"Agregar Lnea",lineDescription:"Descripcin de lnea",accountLines:"Lneas de Cuentas",noDescription:"Sin descripcin",andMoreLines:"... y {count} lneas ms",viewDetails:"Ver Detalles",entryDetails:"Detalles del Asiento Contable",entryNotFound:"Asiento No Encontrado",entryNotFoundMessage:"El asiento contable que busca no se pudo encontrar o puede haber sido eliminado.",balanceStatus:"Estado del Balance",difference:"diferencia",createdAt:"Creado el",postedAt:"Registrado el",quickActions:"Acciones Rpidas",fixBalance:"Corregir Balance",editEntryTooltip:"Editar este asiento contable",postEntryTooltip:"Registrar este asiento contable",voidEntryTooltip:"Anular este asiento contable",draftEntryDescription:"Este asiento puede ser editado y registrado.",postedEntryDescription:"Este asiento ha sido registrado en el libro mayor. Editar crear una nueva copia borrador.",voidEntryDescription:"Este asiento ha sido anulado y no puede ser modificado.",entryMustBeBalanced:"El asiento debe estar balanceado para registrarse",entryMustBeBalancedBeforePosting:"El asiento debe estar balanceado antes de registrarse.",entryNotBalancedShort:"El asiento no est balanceado",confirmEditPosted:"Este asiento ha sido registrado. Editar crear una nueva copia borrador. Continuar?",confirmPost:"Est seguro que desea registrar este asiento contable? Esta accin no se puede deshacer.",confirmVoid:"Est seguro que desea anular este asiento contable?",minTwoLinesRequired:"Se requieren al menos 2 lneas",entryNotBalanced:"Asiento no balanceado. Dbito: ${debit}, Crdito: ${credit}",lineAccountRequired:"Lnea {lineNumber}: La cuenta es requerida",lineAmountRequired:"Lnea {lineNumber}: Se debe proporcionar monto en dbito o crdito",lineBothAmounts:"Lnea {lineNumber}: No puede tener montos en dbito y crdito",enterEntryDescription:"Ingrese la descripcin del asiento contable",enterReferenceNumber:"Ingrese el nmero de referencia",quickEntry:"Entrada Rpida de Diario",selectCategory:"Seleccionar Categora",selectTemplate:"Seleccionar Plantilla",chooseCategory:"Elija una categora...",chooseTemplate:"Elija una plantilla...",enterAmounts:"Ingresar Montos",entryPreview:"Vista Previa del Asiento",createQuickEntry:"Crear Entrada Rpida",templateRequired:"Por favor seleccione una plantilla",amountRequired:"Se requiere monto para {field}",templates:"Plantillas",manageTemplates:"Administrar Plantillas",addNewTemplate:"Agregar Nueva Plantilla",templateDetails:"Detalles de Plantilla",newTemplate:"Nueva Plantilla",editTemplate:"Editar Plantilla",templateName:"Nombre de Plantilla",enterTemplateName:"Ingrese nombre de plantilla",enterTemplateDescription:"Ingrese descripcin de plantilla",category:"Categora",templateLines:"Lneas de Plantilla",type:"Tipo",amountType:"Tipo de Monto",fieldName:"Nombre del Campo",selectAccount:"Seleccionar cuenta...",variable:"Variable",fixed:"Fijo",fieldNamePlaceholder:"ej., Monto",custom:"Personalizado",templateNameRequired:"El nombre de plantilla es requerido",templateDescriptionRequired:"La descripcin de plantilla es requerida",lineDescriptionRequired:"Lnea {lineNumber}: Se requiere descripcin",amountFieldNameRequired:"Lnea {lineNumber}: Se requiere nombre del campo de monto",confirmDeleteTemplate:"Est seguro que desea eliminar esta plantilla?",selectTemplateToView:"Seleccione una plantilla de la lista para ver detalles",orCreateNew:"o cree una nueva plantilla personalizada",reconciliationSummary:"Resumen de Conciliacin",totalLines:"Lneas Totales",bankAccounts:"Cuentas Bancarias",bankReconciled:"Conciliadas Bancarias",bankPending:"Bancarias Pendientes",reconciledLines:"Lneas Conciliadas",unreconciledLines:"Lneas Sin Conciliar",fullyReconciled:"Completamente Conciliado",partiallyReconciled:"Parcialmente Conciliado",unreconciled:"Sin Conciliar",reconciled:"Conciliadas",pending:"Pendientes",matched:"Coincididas",manual:"Manual",pendingBankReconciliation:"Conciliacin Bancaria Pendiente",visitBankConsolidations:"Visite Consolidaciones Bancarias para conciliar estas transacciones",reconciliationTip:"Consejo de Conciliacin",unreconciledBankTransactions:"Este asiento tiene transacciones de cuentas bancarias sin conciliar.",bankAccount:"cuenta bancaria",currentUser:"Usuario Actual",errorDeletingTemplate:"Error al eliminar plantilla",errorSavingTemplate:"Error al guardar plantilla",noLines:"Sin lneas",noTemplateLines:"Sin lneas de plantilla"},invoiceReport:{title:"Reporte Resumen de Facturas",filters:"Filtros",storeLocation:"Ubicacin de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",paymentMethod:"Mtodo de Pago",allMethods:"Todos los Mtodos",cash:"Efectivo",zelle:"Zelle",other:"Otro",shippingType:"Tipo de Envo",allTypes:"Todos los Tipos",maritime:" Martimo",air:" Areo",generateReport:"Generar Reporte",loading:"Cargando...",print:" Imprimir",exportPdf:" Exportar PDF",generating:" Generando...",close:"Cerrar",invoiceSummary:"Resumen de Facturas",totalInvoices:"Total de Facturas",dateRange:"Rango de Fechas",store:"Tienda",shippingTypeLabel:"Tipo de Envo",notSet:"No Establecido",paymentMethods:"Mtodos de Pago",total:"Total",additionalCharges:"Cargos Adicionales",transport:"Transporte",aranceles:"Aranceles",tax:"Impuesto",productsSummary:"Resumen de Productos",productType:"Tipo de Producto",quantity:"Cantidad",totalValue:"Valor Total",avgPrice:"Precio Promedio",reservasSummary:"Resumen de Reservas (Agrupado por Precio)",reservaType:"Tipo de Reserva",totalQtyLbs:"Cantidad Total (lbs)",priceGroups:"Grupos de Precio (Precio  Cantidad)",otherServicesTitle:"Otros Servicios y Cargos",serviceType:"Tipo de Servicio",totalOtherServices:"Total Otros Servicios",totalSummary:"Resumen Total",productsTotal:"Total Productos",reservasTotal:"Total Reservas",transportServices:"Transporte y Servicios",grandTotal:"TOTAL GENERAL",invoiceReferences:"Referencias de Facturas",type:"Tipo",pricePerPound:"Precio por libra",totalInvoicesCount:"Total facturas",invoiceNumbers:"Nmeros de Facturas",copyInvoiceNumbers:" Copiar Nmeros de Facturas",reportPeriod:"Perodo del Reporte",allTimeReport:"Reporte de Todo el Tiempo",generatedOn:"Generado el",generatingReport:"Generando reporte...",pdfGenerationFailed:"Fall la generacin del PDF. Usando impresin en su lugar.",invoiceNumbersCopied:"Nmeros de facturas copiados al portapapeles!",allTypesOption:"Todos los Tipos",seaOption:" Martimo",airOption:" Areo",allMethodsOption:"Todos los Mtodos",cashOption:"Efectivo",zelleOption:"Zelle",otherOption:"Otro",pdf:{title:"Reporte Resumen de Facturas",subtitle:"Resumen Financiero Completo",paymentMethodsSummary:"Resumen de Mtodos de Pago",productsSummary:"Resumen de Productos",reservasSummary:"Resumen de Reservas (Agrupado por Precio)",otherServicesTitle:"Otros Servicios y Cargos",totalSummary:"Resumen Total",paymentMethod:"Mtodo de Pago",amount:"Monto",product:"Producto",quantity:"Cantidad",total:"Total",type:"Tipo",totalQty:"Cantidad Total",priceGroups:"Grupos de Precio",serviceType:"Tipo de Servicio",productsTotal:"Total Productos",reservasTotal:"Total Reservas",transportServices:"Transporte y Servicios",grandTotal:"TOTAL GENERAL",generatedOn:"Generado el:",all:"Todo",reportDate:"Fecha del Reporte:",dateRange:"Rango de Fechas:",totalInvoices:"Total de Facturas:",allTypes:"Todos los Tipos",lbs:"lbs",page:"Pgina",of:"de"}},entryBooks:{title:"Libros de Entrada",subtitle:"Administrar asientos contables y registros del libro mayor",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Perodo",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Est Conciliado",totalEntries:"Total de Asientos",allJournalEntries:"Todos los asientos contables",postedEntriesOnly:"Solo asientos registrados",fromPostedEntries:"De {count} asientos registrados",needBankReconciliation:"Necesita conciliacin bancaria",allReconciled:"Todo conciliado",sortBy:"Ordenar Por",fromDate:"Fecha Desde",toDate:"Fecha Hasta",order:"Orden",newest:"Ms Reciente",oldest:"Ms Antiguo",resetFilters:"Restablecer Filtros",activeFilters:"Filtros activos",from:"Desde",to:"Hasta",entriesFound:"{count} asientos encontrados",noJournalEntries:"Sin Asientos Contables",startByCreating:"Comience creando su primer asiento",noEntriesMatch:"No hay asientos que coincidan con sus filtros actuales.",createFirstEntry:"Crear Primer Asiento",confirmVoid:"Est seguro que desea anular este asiento contable?",void:"Anulado",viewReconciliation:"Ver Conciliacin"},consolidation:{title:"Consolidacin Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depsitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automtica",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliacin",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depsitos en Trnsito"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Direccin de correo invlida",invalidNumber:"Nmero invlido",invalidDate:"Fecha invlida",minLength:"La longitud mnima es",maxLength:"La longitud mxima es",minValue:"El valor mnimo es",maxValue:"El valor mximo es",passwordMismatch:"Las contraseas no coinciden",selectOption:"Por favor seleccione una opcin",enterValue:"Por favor ingrese un valor",confirmDelete:"Est seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",descriptionRequired:"La descripcin es requerida",errorOccurred:"Ocurri un error",errorPostingEntry:"Ocurri un error al registrar el asiento"},reports:{title:"Reportes",incomeStatement:"Estado de Resultados",balanceSheet:"Balance General",cashFlow:"Estado de Flujo de Efectivo",trialBalance:"Balance de Comprobacin",generalLedger:"Libro Mayor",accountsReceivable:"Cuentas por Cobrar",accountsPayable:"Cuentas por Pagar",inventoryReport:"Reporte de Inventario",payrollReport:"Reporte de Nmina",taxReport:"Reporte de Impuestos",customReport:"Reporte Personalizado",dateRange:"Rango de Fechas",fromDate:"Desde",toDate:"Hasta",generateReport:"Generar Reporte",exportOptions:"Opciones de Exportacin",pdf:"PDF",excel:"Excel",csv:"CSV"},settings:{title:"Configuracin",general:"General",company:"Empresa",users:"Usuarios",security:"Seguridad",backup:"Respaldo",companyName:"Nombre de la Empresa",companyAddress:"Direccin de la Empresa",taxId:"ID Fiscal",fiscalYear:"Ao Fiscal",currency:"Moneda",dateFormat:"Formato de Fecha",timeZone:"Zona Horaria",language:"Idioma",theme:"Tema",lightTheme:"Claro",darkTheme:"Oscuro",autoBackup:"Respaldo Automtico",backupFrequency:"Frecuencia de Respaldo",lastBackup:"ltimo Respaldo",restoreBackup:"Restaurar Respaldo",exportData:"Exportar Datos",importData:"Importar Datos",changePassword:"Cambiar Contrasea",twoFactorAuth:"Autenticacin de Dos Factores",sessionTimeout:"Tiempo de Espera de Sesin",auditLog:"Registro de Auditora"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"Por qu veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadsticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestin de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestin de Facturas",productManagement:"Acceso a Gestin de Productos",HBLAccess:"Acceso a Gestin de HBL"}},hbl:{title:"Gestin de Conocimiento de Embarque",records:"registros",searchPlaceholder:"Buscar por HBL#, gua area, remitente, consignatario, mercanca, bolsa#, identidad...",addNew:"Agregar Nuevo HBL",hblNumber:"Nmero HBL",airGuide:"Gua Area",airNumber:"Nmero Areo",shipper:"Remitente",consignee:"Consignatario",shipperPhone:"Telfono del Remitente",consigneePhone:"Telfono del Consignatario",identity:"Identidad",classification:"Clasificacin",address:"Direccin",city:"Ciudad",state:"Provincia",street:"Calle",commodity:"Mercanca",weight:"Peso",quantity:"Cantidad",bagNumber:"Nmero de Bolsa",agency:"Agencia",guide:"Gua",guideNumber:"Nmero de Gua",guideNo:"Gua No.",reserveDate:"Fecha de Reserva",status:{"EN BODEGA":"En Bodega",ENVIADO:"Enviado",ENTREGADO:"Entregado",CANCELADO:"Cancelado",PENDIENTE:"Pendiente"}}},UD=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["es","en"].includes(t))return t}return"en"},[Pb,HD]=Ce(UD()),[wb,GD]=Ce({en:{},es:{}}),pu={get language(){return Pb()},get translations(){return wb()},setLanguage(t){HD(t),typeof window<"u"&&localStorage.setItem("hrmfinance-language",t)},setTranslations(t){GD(t)},translate(t,e){const r=Pb(),n=wb()[r];if(!n)return e||t;const i=t.split(".");let o=n;for(const s of i)if(o&&typeof o=="object"&&s in o)o=o[s];else return e||t;return typeof o=="string"?o:e||t},t(t,e){return this.translate(t,e)}},WD=()=>({t:pu.translate.bind(pu),language:pu.language,setLanguage:pu.setLanguage});pu.setTranslations({en:qD,es:zD});var YD=he("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label><select><option value=all></option><option value=cash></option><option value=zelle></option><option value=other></option></select></div><div><label></label><select><option value=all></option><option value=SEA></option><option value=AEREO>"),KD=he("<div><div><strong>:</strong> </div><div><strong>:</strong> <!> <!> </div><div><strong>:</strong> </div><div><strong>:</strong> "),JD=he("<div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),QD=he("<div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),xb=he("<div>"),Ab=he("<div><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody>"),XD=he("<div><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td colspan=4><strong>:</strong></td><td>"),ZD=he("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),e8=he("<div><div>"),t8=he("<div><div><div><h3></h3><button></button></div><div><div>: <strong></strong></div><div>: <strong></strong></div><div>: <strong></strong></div></div><div><div>:</div><div></div></div><div>"),r8=he("<div><div class=print-only><h1></h1><div></div><div>: </div></div><div class=no-print><h1></h1><div>"),n8=he("<option>"),i8=he("<tr><td></td><td></td><td></td><td>"),o8=he("<tr><td></td><td></td><td><div></div></td><td>"),s8=he("<div><span>  <!> lbs</span><button> <!> invoice"),a8=he("<tr><td><div><span></span></div></td><td>");const l8=t=>{const{t:e}=WD(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(""),[c,u]=Ce("all"),[h,m]=Ce("all"),[g,f]=Ce("all"),[w,x]=Ce("all"),[S,C]=Ce(null),[j,oe]=Ce([]),[te,Z]=Ce(!1),[re,E]=Ce(null);Cn(async()=>{await T()});const $=()=>ct.getActiveLocations(),T=async()=>{n(!0);try{let K=c()!=="all"?c():void 0;const R={store:K,dateFrom:i()||void 0,dateTo:s()||void 0};K&&(await Gi.fetchInvoices(R),B())}catch(K){console.error("Error loading report data:",K)}finally{n(!1)}},B=()=>{let K=Gi.getFilteredInvoices({store:c(),dateFrom:i(),dateTo:s()});w()!=="all"&&(K=K.filter(X=>X.shippingType===w()||!X.shippingType&&w()==="SEA")),oe(K);let R=0,k=0,W=0,z=new Map,U=new Map,le=new Map,L=0,M=0,G=0;K.forEach(X=>{const Y=S_(X),Q=parseFloat(Y.total);console.log(X),X.paymentMethods?(X?.paymentMethods?.cash&&(R+=X?.paymentMethods?.cash),X?.paymentMethods?.zelle&&(k+=X?.paymentMethods?.zelle)):X.hasTax&&X?.TaxPercent?(k+=Q,G+=X?.TaxPercent/100*Q):R+=Q,X.products?.forEach(J=>{const V=J.product.label,ne=Math.abs(J.qty),ee=parseFloat(__(J));if(z.has(V)){const ce=z.get(V);z.set(V,{qty:ce.qty+ne,total:ce.total+ee})}else z.set(V,{qty:ne,total:ee})}),X.reservas?.forEach(J=>{const V=J.type,ne=parseInt(J.qty)||0,ee=parseFloat(J.price)||0,ce=parseFloat(J.arancel)||0,se=parseFloat(b_(J));if(["TRANSPORTACION","OTROS SERVICIO","OTROS","SERVICIO DE RAPEADO","CAJAS"].includes(V)||ne===0)if(L+=se,le.has(V)){const ue=le.get(V);le.set(V,{qty:ue.qty+ne,price:ue.price,arancel:ue.arancel+ce,total:ue.total+se})}else le.set(V,{qty:ne,price:ee,arancel:ce,total:se});else{const ue=V;if(U.has(ue)){const ye=U.get(ue);U.set(ue,{qty:ye.qty+ne,price:ye.price,total:ye.total+se,priceGroups:ye.priceGroups});const de=ye.priceGroups.get(ee)||{qty:0,invoices:[]};de.qty+=ne,de.invoices.includes(X.invoice)||de.invoices.push(X.invoice),ye.priceGroups.set(ee,de)}else{const ye=new Map;ye.set(ee,{qty:ne,invoices:[X.invoice]}),U.set(ue,{qty:ne,price:ee,arancel:ce,total:se,priceGroups:ye})}}M+=ce})});const I=R+k+W,F={dateRange:{from:i(),to:s()},store:c(),shippingType:w(),totalInvoices:K.length,paymentMethods:{cash:R,zelle:k,other:W,total:R+k+W},productsByType:z,reservasByTypeAndPrice:U,otherServicesByType:le,transportTotal:L,arancelesTotal:M,taxTotal:G,grandTotal:I+G};C(F)},_=K=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(K),P=()=>{document.body.classList.add("printing"),setTimeout(()=>{window.print(),document.body.classList.remove("printing")},100)},b=async()=>{try{const K=H();if(K){Z(!0);const{generateInvoiceResumePDF:R}=await Ji(async()=>{const{generateInvoiceResumePDF:W}=await import("./invoiceResumePdfGenerator-Do799Fg4.js");return{generateInvoiceResumePDF:W}},[]),k=`invoice-resume-report-${new Date().toISOString().split("T")[0]}.pdf`;await R(K,e,k),console.log(`PDF generated successfully: ${k}`)}}catch(K){console.error("Error generating PDF:",K),alert(e("invoiceReport.pdfGenerationFailed")),P()}finally{Z(!1)}},H=Lt(()=>S());return(()=>{var K=r8(),R=K.firstChild,k=R.firstChild,W=k.nextSibling,z=W.nextSibling,U=z.firstChild,le=R.nextSibling,L=le.firstChild,M=L.nextSibling;return K.style.setProperty("padding","2rem"),K.style.setProperty("max-width","1200px"),K.style.setProperty("margin","0 auto"),R.style.setProperty("text-align","center"),R.style.setProperty("margin-bottom","2rem"),R.style.setProperty("border-bottom","2px solid #333"),R.style.setProperty("padding-bottom","1rem"),a(k,()=>e("invoiceReport.title")),W.style.setProperty("font-size","12pt"),W.style.setProperty("margin-top","0.5rem"),W.style.setProperty("color","#666"),a(W,D(Ge,{get when(){return $e(()=>!!H()?.dateRange?.from)()&&H()?.dateRange?.to},get children(){return[$e(()=>e("invoiceReport.reportPeriod")),": ",$e(()=>H()?.dateRange?.from)," to ",$e(()=>H()?.dateRange?.to)]}}),null),a(W,D(Ge,{get when(){return!H()?.dateRange?.from||!H()?.dateRange?.to},get children(){return e("invoiceReport.allTimeReport")}}),null),z.style.setProperty("font-size","10pt"),z.style.setProperty("margin-top","0.5rem"),a(z,()=>e("invoiceReport.generatedOn"),U),a(z,()=>new Date().toLocaleDateString(),null),le.style.setProperty("display","flex"),le.style.setProperty("justify-content","space-between"),le.style.setProperty("align-items","center"),le.style.setProperty("margin-bottom","2rem"),L.style.setProperty("font-size","1.75rem"),L.style.setProperty("font-weight","bold"),a(L,()=>e("invoiceReport.title")),M.style.setProperty("display","flex"),M.style.setProperty("gap","1rem"),a(M,D(ht,{variant:"outline",onClick:P,get children(){return e("invoiceReport.print")}}),null),a(M,D(ht,{variant:"outline",onClick:b,get disabled(){return te()},get children(){return $e(()=>!!te())()?e("invoiceReport.generating"):e("invoiceReport.exportPdf")}}),null),a(M,D(Ge,{get when(){return t.onClose},get children(){return D(ht,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("invoiceReport.close")}})}}),null),a(K,D(Dt,{get title(){return e("invoiceReport.filters")},style:{"margin-bottom":"2rem"},class:"no-print",get children(){var G=YD(),I=G.firstChild,F=I.firstChild,X=F.nextSibling,Y=X.firstChild,Q=I.nextSibling,J=Q.firstChild,V=J.nextSibling,ne=Q.nextSibling,ee=ne.firstChild,ce=ee.nextSibling,se=ne.nextSibling,q=se.firstChild,ue=q.nextSibling,ye=ue.firstChild,de=ye.nextSibling,ge=de.nextSibling,xe=ge.nextSibling,pe=se.nextSibling,_e=pe.firstChild,Re=_e.nextSibling,Ee=Re.firstChild,Te=Ee.nextSibling,Le=Te.nextSibling;return G.style.setProperty("display","grid"),G.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),G.style.setProperty("gap","1rem"),G.style.setProperty("align-items","end"),F.style.setProperty("display","block"),F.style.setProperty("margin-bottom","0.5rem"),F.style.setProperty("font-weight","500"),a(F,()=>e("invoiceReport.storeLocation")),X.addEventListener("change",Ie=>u(Ie.currentTarget.value)),X.style.setProperty("width","100%"),X.style.setProperty("padding","0.75rem"),X.style.setProperty("border","1px solid var(--border-color)"),X.style.setProperty("border-radius","var(--border-radius-sm)"),a(Y,()=>e("invoiceReport.allStores")),a(X,D(zt,{get each(){return $()},children:Ie=>(()=>{var De=n8();return a(De,()=>Ie.name),we(()=>De.value=Ie.id),De})()}),null),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),a(J,()=>e("invoiceReport.fromDate")),V.addEventListener("change",Ie=>o(Ie.currentTarget.value)),V.style.setProperty("width","100%"),V.style.setProperty("padding","0.75rem"),V.style.setProperty("border","1px solid var(--border-color)"),V.style.setProperty("border-radius","var(--border-radius-sm)"),ee.style.setProperty("display","block"),ee.style.setProperty("margin-bottom","0.5rem"),ee.style.setProperty("font-weight","500"),a(ee,()=>e("invoiceReport.toDate")),ce.addEventListener("change",Ie=>l(Ie.currentTarget.value)),ce.style.setProperty("width","100%"),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),q.style.setProperty("display","block"),q.style.setProperty("margin-bottom","0.5rem"),q.style.setProperty("font-weight","500"),a(q,()=>e("invoiceReport.paymentMethod")),ue.addEventListener("change",Ie=>f(Ie.currentTarget.value)),ue.style.setProperty("width","100%"),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),a(ye,()=>e("invoiceReport.allMethodsOption")),a(de,()=>e("invoiceReport.cashOption")),a(ge,()=>e("invoiceReport.zelleOption")),a(xe,()=>e("invoiceReport.otherOption")),_e.style.setProperty("display","block"),_e.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("font-weight","500"),a(_e,()=>e("invoiceReport.shippingType")),Re.addEventListener("change",Ie=>x(Ie.currentTarget.value)),Re.style.setProperty("width","100%"),Re.style.setProperty("padding","0.75rem"),Re.style.setProperty("border","1px solid var(--border-color)"),Re.style.setProperty("border-radius","var(--border-radius-sm)"),a(Ee,()=>e("invoiceReport.allTypesOption")),a(Te,()=>e("invoiceReport.seaOption")),a(Le,()=>e("invoiceReport.airOption")),a(G,D(Ge,{get when(){return c()!=="all"},get children(){return D(ht,{variant:"primary",onClick:T,get disabled(){return $e(()=>c()==="all")()&&r()},get children(){return $e(()=>!!r())()?e("invoiceReport.loading"):e("invoiceReport.generateReport")}})}}),null),we(()=>X.value=c()),we(()=>V.value=i()),we(()=>ce.value=s()),we(()=>ue.value=g()),we(()=>Re.value=w()),G}}),null),a(K,D(Ge,{get when(){return $e(()=>!!(c()!=="all"&&H()))()&&!r()},get children(){return[(()=>{var G=xb();return G.style.setProperty("display","grid"),G.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),G.style.setProperty("gap","1.5rem"),G.style.setProperty("margin-bottom","2rem"),a(G,D(Dt,{get title(){return e("invoiceReport.invoiceSummary")},get children(){var I=KD(),F=I.firstChild,X=F.firstChild,Y=X.firstChild;X.nextSibling;var Q=F.nextSibling,J=Q.firstChild,V=J.firstChild,ne=J.nextSibling,ee=ne.nextSibling,ce=ee.nextSibling,se=ce.nextSibling;se.nextSibling;var q=Q.nextSibling,ue=q.firstChild,ye=ue.firstChild;ue.nextSibling;var de=q.nextSibling,ge=de.firstChild,xe=ge.firstChild;return ge.nextSibling,I.style.setProperty("padding","1rem"),F.style.setProperty("margin-bottom","0.5rem"),a(X,()=>e("invoiceReport.totalInvoices"),Y),a(F,()=>H().totalInvoices,null),Q.style.setProperty("margin-bottom","0.5rem"),a(J,()=>e("invoiceReport.dateRange"),V),a(Q,()=>H().dateRange.from||e("common.all"),ee),a(Q,()=>e("common.to"),se),a(Q,()=>H().dateRange.to||e("common.all"),null),q.style.setProperty("margin-bottom","0.5rem"),a(ue,()=>e("invoiceReport.store"),ye),a(q,(()=>{var pe=$e(()=>H().store==="all");return()=>pe()?e("invoiceReport.allStores"):H().store})(),null),a(ge,()=>e("invoiceReport.shippingTypeLabel"),xe),a(de,(()=>{var pe=$e(()=>H().shippingType==="all");return()=>pe()?e("invoiceReport.allTypes"):$e(()=>H().shippingType==="SEA")()?e("invoiceReport.maritime"):$e(()=>H().shippingType==="AEREO")()?e("invoiceReport.air"):e("invoiceReport.notSet")})(),null),I}}),null),a(G,D(Dt,{get title(){return e("invoiceReport.paymentMethods")},get children(){var I=JD(),F=I.firstChild,X=F.firstChild,Y=X.firstChild;X.nextSibling;var Q=F.nextSibling,J=Q.firstChild,V=J.firstChild;J.nextSibling;var ne=Q.nextSibling,ee=ne.firstChild,ce=ee.firstChild;ee.nextSibling;var se=ne.nextSibling,q=se.firstChild,ue=q.firstChild;return q.nextSibling,I.style.setProperty("padding","1rem"),F.style.setProperty("margin-bottom","0.5rem"),a(X,()=>e("invoiceReport.cash"),Y),a(F,()=>_(H().paymentMethods.cash),null),Q.style.setProperty("margin-bottom","0.5rem"),a(J,()=>e("invoiceReport.zelle"),V),a(Q,()=>_(H().paymentMethods.zelle),null),ne.style.setProperty("margin-bottom","0.5rem"),a(ee,()=>e("invoiceReport.other"),ce),a(ne,()=>_(H().paymentMethods.other),null),se.style.setProperty("border-top","1px solid var(--border-color)"),se.style.setProperty("padding-top","0.5rem"),se.style.setProperty("font-weight","bold"),a(q,()=>e("invoiceReport.total"),ue),a(se,()=>_(H().paymentMethods.total),null),I}}),null),a(G,D(Dt,{get title(){return e("invoiceReport.additionalCharges")},get children(){var I=QD(),F=I.firstChild,X=F.firstChild,Y=X.firstChild;X.nextSibling;var Q=F.nextSibling,J=Q.firstChild,V=J.firstChild;J.nextSibling;var ne=Q.nextSibling,ee=ne.firstChild,ce=ee.firstChild;return ee.nextSibling,I.style.setProperty("padding","1rem"),F.style.setProperty("margin-bottom","0.5rem"),a(X,()=>e("invoiceReport.transport"),Y),a(F,()=>_(H().transportTotal),null),Q.style.setProperty("margin-bottom","0.5rem"),a(J,()=>e("invoiceReport.aranceles"),V),a(Q,()=>_(H().arancelesTotal),null),ne.style.setProperty("margin-bottom","0.5rem"),a(ee,()=>e("invoiceReport.tax"),ce),a(ne,()=>_(H().taxTotal),null),I}}),null),G})(),D(Ge,{get when(){return H().productsByType?.size>0},get children(){return D(Dt,{get title(){return e("invoiceReport.productsSummary")},style:{"margin-bottom":"2rem"},get children(){var G=Ab(),I=G.firstChild,F=I.firstChild,X=F.firstChild,Y=X.firstChild,Q=Y.nextSibling,J=Q.nextSibling,V=J.nextSibling,ne=F.nextSibling;return G.style.setProperty("overflow-x","auto"),I.style.setProperty("width","100%"),I.style.setProperty("border-collapse","collapse"),X.style.setProperty("background","var(--background-color)"),Y.style.setProperty("padding","1rem"),Y.style.setProperty("text-align","left"),Y.style.setProperty("border-bottom","2px solid var(--border-color)"),a(Y,()=>e("invoiceReport.productType")),Q.style.setProperty("padding","1rem"),Q.style.setProperty("text-align","right"),Q.style.setProperty("border-bottom","2px solid var(--border-color)"),a(Q,()=>e("invoiceReport.quantity")),J.style.setProperty("padding","1rem"),J.style.setProperty("text-align","right"),J.style.setProperty("border-bottom","2px solid var(--border-color)"),a(J,()=>e("invoiceReport.totalValue")),V.style.setProperty("padding","1rem"),V.style.setProperty("text-align","right"),V.style.setProperty("border-bottom","2px solid var(--border-color)"),a(V,()=>e("invoiceReport.avgPrice")),a(ne,D(zt,{get each(){return Array.from(H().productsByType.entries()).sort((ee,ce)=>ce[1].total-ee[1].total)},children:([ee,ce])=>(()=>{var se=i8(),q=se.firstChild,ue=q.nextSibling,ye=ue.nextSibling,de=ye.nextSibling;return q.style.setProperty("padding","0.75rem"),q.style.setProperty("border-bottom","1px solid var(--border-color)"),a(q,ee),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("text-align","right"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ue,()=>ce.qty),ye.style.setProperty("padding","0.75rem"),ye.style.setProperty("text-align","right"),ye.style.setProperty("border-bottom","1px solid var(--border-color)"),ye.style.setProperty("font-weight","600"),a(ye,()=>_(ce.total)),de.style.setProperty("padding","0.75rem"),de.style.setProperty("text-align","right"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),a(de,()=>_(ce.total/ce.qty)),se})()})),G}})}}),D(Ge,{get when(){return H().reservasByTypeAndPrice?.size>0},get children(){return D(Dt,{get title(){return e("invoiceReport.reservasSummary")},style:{"margin-bottom":"2rem"},get children(){var G=Ab(),I=G.firstChild,F=I.firstChild,X=F.firstChild,Y=X.firstChild,Q=Y.nextSibling,J=Q.nextSibling,V=J.nextSibling,ne=F.nextSibling;return G.style.setProperty("overflow-x","auto"),I.style.setProperty("width","100%"),I.style.setProperty("border-collapse","collapse"),X.style.setProperty("background","var(--background-color)"),Y.style.setProperty("padding","1rem"),Y.style.setProperty("text-align","left"),Y.style.setProperty("border-bottom","2px solid var(--border-color)"),a(Y,()=>e("invoiceReport.reservaType")),Q.style.setProperty("padding","1rem"),Q.style.setProperty("text-align","right"),Q.style.setProperty("border-bottom","2px solid var(--border-color)"),a(Q,()=>e("invoiceReport.totalQtyLbs")),J.style.setProperty("padding","1rem"),J.style.setProperty("text-align","left"),J.style.setProperty("border-bottom","2px solid var(--border-color)"),a(J,()=>e("invoiceReport.priceGroups")),V.style.setProperty("padding","1rem"),V.style.setProperty("text-align","right"),V.style.setProperty("border-bottom","2px solid var(--border-color)"),a(V,()=>e("invoiceReport.total")),a(ne,D(zt,{get each(){return Array.from(H().reservasByTypeAndPrice.entries()).sort((ee,ce)=>ce[1].total-ee[1].total)},children:([ee,ce])=>(()=>{var se=o8(),q=se.firstChild,ue=q.nextSibling,ye=ue.nextSibling,de=ye.firstChild,ge=ye.nextSibling;return q.style.setProperty("padding","0.75rem"),q.style.setProperty("border-bottom","1px solid var(--border-color)"),a(q,ee),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("text-align","right"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),ue.style.setProperty("font-weight","600"),a(ue,()=>ce.qty),ye.style.setProperty("padding","0.75rem"),ye.style.setProperty("border-bottom","1px solid var(--border-color)"),de.style.setProperty("font-size","0.875rem"),a(de,D(zt,{get each(){return Array.from(ce.priceGroups.entries()).sort((xe,pe)=>xe[0]-pe[0])},children:([xe,pe])=>(()=>{var _e=s8(),Re=_e.firstChild,Ee=Re.firstChild,Te=Ee.nextSibling;Te.nextSibling;var Le=Re.nextSibling,Ie=Le.firstChild,De=Ie.nextSibling;return De.nextSibling,_e.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("display","flex"),_e.style.setProperty("align-items","center"),_e.style.setProperty("gap","0.5rem"),a(Re,()=>_(xe),Ee),a(Re,()=>pe.qty,Te),Le.addEventListener("mouseleave",Ye=>Ye.currentTarget.style.background="#3498db"),Le.addEventListener("mouseenter",Ye=>Ye.currentTarget.style.background="#2980b9"),Le.$$click=()=>E({price:xe,invoices:pe.invoices,type:ee}),Le.style.setProperty("background","#3498db"),Le.style.setProperty("color","white"),Le.style.setProperty("border","none"),Le.style.setProperty("border-radius","4px"),Le.style.setProperty("padding","0.25rem 0.5rem"),Le.style.setProperty("font-size","0.75rem"),Le.style.setProperty("cursor","pointer"),Le.style.setProperty("transition","background 0.2s"),a(Le,()=>pe.invoices.length,De),a(Le,()=>pe.invoices.length>1?"s":"",null),_e})()})),ge.style.setProperty("padding","0.75rem"),ge.style.setProperty("text-align","right"),ge.style.setProperty("border-bottom","1px solid var(--border-color)"),ge.style.setProperty("font-weight","600"),a(ge,()=>_(ce.total)),se})()})),G}})}}),D(Ge,{get when(){return H().otherServicesByType?.size>0},get children(){return D(Dt,{get title(){return e("invoiceReport.otherServicesTitle")},style:{"margin-bottom":"2rem"},get children(){var G=XD(),I=G.firstChild,F=I.firstChild,X=F.firstChild,Y=X.firstChild,Q=Y.nextSibling,J=F.nextSibling,V=J.firstChild,ne=V.firstChild,ee=ne.firstChild,ce=ee.firstChild,se=ne.nextSibling;return G.style.setProperty("overflow-x","auto"),I.style.setProperty("width","100%"),I.style.setProperty("border-collapse","collapse"),X.style.setProperty("background","var(--background-color)"),Y.style.setProperty("padding","1rem"),Y.style.setProperty("text-align","left"),Y.style.setProperty("border-bottom","2px solid var(--border-color)"),a(Y,()=>e("invoiceReport.serviceType")),Q.style.setProperty("padding","1rem"),Q.style.setProperty("text-align","right"),Q.style.setProperty("border-bottom","2px solid var(--border-color)"),a(Q,()=>e("invoiceReport.total")),a(J,D(zt,{get each(){return Array.from(H().otherServicesByType.entries()).sort((q,ue)=>ue[1].total-q[1].total)},children:([q,ue])=>(()=>{var ye=a8(),de=ye.firstChild,ge=de.firstChild,xe=ge.firstChild,pe=de.nextSibling;return de.style.setProperty("padding","0.75rem"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),ge.style.setProperty("display","flex"),ge.style.setProperty("align-items","center"),ge.style.setProperty("gap","0.5rem"),(q==="TRANSPORTACION"?"#e3f2fd":q==="CAJAS"?"#f3e5f5":"#fff3e0")!=null?xe.style.setProperty("background",q==="TRANSPORTACION"?"#e3f2fd":q==="CAJAS"?"#f3e5f5":"#fff3e0"):xe.style.removeProperty("background"),(q==="TRANSPORTACION"?"#1976d2":q==="CAJAS"?"#7b1fa2":"#f57c00")!=null?xe.style.setProperty("color",q==="TRANSPORTACION"?"#1976d2":q==="CAJAS"?"#7b1fa2":"#f57c00"):xe.style.removeProperty("color"),xe.style.setProperty("padding","0.25rem 0.5rem"),xe.style.setProperty("border-radius","4px"),xe.style.setProperty("font-size","0.75rem"),xe.style.setProperty("font-weight","600"),a(xe,q==="TRANSPORTACION"?"":q==="CAJAS"?"":q==="SERVICIO DE RAPEADO"?"":""),a(ge,q,null),pe.style.setProperty("padding","0.75rem"),pe.style.setProperty("text-align","right"),pe.style.setProperty("border-bottom","1px solid var(--border-color)"),pe.style.setProperty("font-weight","600"),a(pe,()=>_(ue.total)),ye})()}),V),V.style.setProperty("background","var(--strip-color)"),V.style.setProperty("font-weight","bold"),ne.style.setProperty("padding","0.75rem"),ne.style.setProperty("text-align","right"),ne.style.setProperty("border-top","2px solid var(--border-color)"),a(ee,()=>e("invoiceReport.totalOtherServices"),ce),se.style.setProperty("padding","0.75rem"),se.style.setProperty("text-align","right"),se.style.setProperty("border-top","2px solid var(--border-color)"),se.style.setProperty("font-weight","700"),a(se,()=>_(H().transportTotal)),G}})}}),D(Dt,{get title(){return e("invoiceReport.totalSummary")},get children(){var G=ZD(),I=G.firstChild,F=I.firstChild,X=F.nextSibling,Y=I.nextSibling,Q=Y.firstChild,J=Q.nextSibling,V=Y.nextSibling,ne=V.firstChild,ee=ne.nextSibling,ce=V.nextSibling,se=ce.firstChild,q=se.nextSibling;return G.style.setProperty("display","grid"),G.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),G.style.setProperty("gap","2rem"),G.style.setProperty("padding","2rem"),I.style.setProperty("text-align","center"),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-secondary)"),F.style.setProperty("margin-bottom","0.5rem"),a(F,()=>e("invoiceReport.productsTotal")),X.style.setProperty("font-size","1.5rem"),X.style.setProperty("font-weight","bold"),X.style.setProperty("color","var(--primary-color)"),a(X,()=>_(Array.from(H().productsByType.values()).reduce((ue,ye)=>ue+ye.total,0))),Y.style.setProperty("text-align","center"),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-secondary)"),Q.style.setProperty("margin-bottom","0.5rem"),a(Q,()=>e("invoiceReport.reservasTotal")),J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","bold"),J.style.setProperty("color","var(--primary-color)"),a(J,()=>_(Array.from(H().reservasByTypeAndPrice.values()).reduce((ue,ye)=>ue+ye.total,0))),V.style.setProperty("text-align","center"),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-secondary)"),ne.style.setProperty("margin-bottom","0.5rem"),a(ne,()=>e("invoiceReport.transportServices")),ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","bold"),ee.style.setProperty("color","var(--primary-color)"),a(ee,()=>_(H().transportTotal)),ce.style.setProperty("text-align","center"),ce.style.setProperty("border-left","2px solid var(--primary-color)"),ce.style.setProperty("padding-left","2rem"),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("color","var(--text-secondary)"),se.style.setProperty("margin-bottom","0.5rem"),a(se,()=>e("invoiceReport.grandTotal")),q.style.setProperty("font-size","2rem"),q.style.setProperty("font-weight","bold"),q.style.setProperty("color","var(--primary-color)"),a(q,()=>_(H().paymentMethods.total)),G}})]}}),null),a(K,D(Ge,{get when(){return r()},get children(){var G=e8(),I=G.firstChild;return G.style.setProperty("text-align","center"),G.style.setProperty("padding","3rem"),I.style.setProperty("font-size","1.25rem"),I.style.setProperty("margin-bottom","1rem"),a(I,()=>e("invoiceReport.generatingReport")),G}}),null),a(K,D(Ge,{get when(){return re()},get children(){var G=t8(),I=G.firstChild,F=I.firstChild,X=F.firstChild,Y=X.nextSibling,Q=F.nextSibling,J=Q.firstChild,V=J.firstChild,ne=V.nextSibling,ee=J.nextSibling,ce=ee.firstChild,se=ce.nextSibling,q=ee.nextSibling,ue=q.firstChild,ye=ue.nextSibling,de=Q.nextSibling,ge=de.firstChild,xe=ge.firstChild,pe=ge.nextSibling,_e=de.nextSibling;return G.$$click=()=>E(null),G.style.setProperty("position","fixed"),G.style.setProperty("top","0"),G.style.setProperty("left","0"),G.style.setProperty("right","0"),G.style.setProperty("bottom","0"),G.style.setProperty("background","rgba(0, 0, 0, 0.5)"),G.style.setProperty("display","flex"),G.style.setProperty("align-items","center"),G.style.setProperty("justify-content","center"),G.style.setProperty("z-index","1000"),I.$$click=Re=>Re.stopPropagation(),I.style.setProperty("background","white"),I.style.setProperty("padding","2rem"),I.style.setProperty("border-radius","var(--border-radius)"),I.style.setProperty("max-width","600px"),I.style.setProperty("max-height","80vh"),I.style.setProperty("overflow-y","auto"),I.style.setProperty("box-shadow","var(--shadow-lg)"),F.style.setProperty("display","flex"),F.style.setProperty("justify-content","space-between"),F.style.setProperty("align-items","center"),F.style.setProperty("margin-bottom","1.5rem"),X.style.setProperty("font-size","1.25rem"),X.style.setProperty("font-weight","bold"),a(X,()=>e("invoiceReport.invoiceReferences")),Y.$$click=()=>E(null),Y.style.setProperty("background","none"),Y.style.setProperty("border","none"),Y.style.setProperty("font-size","1.5rem"),Y.style.setProperty("cursor","pointer"),Y.style.setProperty("color","#666"),Q.style.setProperty("margin-bottom","1rem"),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-secondary)"),a(J,()=>e("invoiceReport.type"),V),a(ne,()=>re().type),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-secondary)"),a(ee,()=>e("invoiceReport.pricePerPound"),ce),a(se,()=>_(re().price)),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","var(--text-secondary)"),a(q,()=>e("invoiceReport.totalInvoicesCount"),ue),a(ye,()=>re().invoices.length),de.style.setProperty("border","1px solid var(--border-color)"),de.style.setProperty("border-radius","var(--border-radius-sm)"),de.style.setProperty("padding","1rem"),de.style.setProperty("background","var(--background-color)"),ge.style.setProperty("font-weight","600"),ge.style.setProperty("margin-bottom","0.75rem"),a(ge,()=>e("invoiceReport.invoiceNumbers"),xe),pe.style.setProperty("display","grid"),pe.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(120px, 1fr))"),pe.style.setProperty("gap","0.5rem"),a(pe,D(zt,{get each(){return re().invoices},children:Re=>(()=>{var Ee=xb();return Ee.$$click=()=>{const Te=j().find(Le=>Le.invoice===Re);Te&&console.log("Invoice details:",Te)},Ee.addEventListener("mouseleave",Te=>{Te.currentTarget.style.background="white",Te.currentTarget.style.borderColor="var(--border-color)"}),Ee.addEventListener("mouseenter",Te=>{Te.currentTarget.style.background="#e3f2fd",Te.currentTarget.style.borderColor="#2196f3"}),Ee.style.setProperty("padding","0.5rem"),Ee.style.setProperty("background","white"),Ee.style.setProperty("border","1px solid var(--border-color)"),Ee.style.setProperty("border-radius","var(--border-radius-sm)"),Ee.style.setProperty("font-family","monospace"),Ee.style.setProperty("font-size","0.875rem"),Ee.style.setProperty("text-align","center"),Ee.style.setProperty("transition","all 0.2s"),Ee.style.setProperty("cursor","pointer"),a(Ee,Re),Ee})()})),_e.style.setProperty("margin-top","1.5rem"),_e.style.setProperty("display","flex"),_e.style.setProperty("justify-content","flex-end"),_e.style.setProperty("gap","1rem"),a(_e,D(ht,{variant:"outline",onClick:()=>{const Re=re().invoices.join(", ");navigator.clipboard.writeText(Re).then(()=>{alert(e("invoiceReport.invoiceNumbersCopied"))})},get children(){return e("invoiceReport.copyInvoiceNumbers")}}),null),a(_e,D(ht,{variant:"primary",onClick:()=>E(null),get children(){return e("invoiceReport.close")}}),null),G}}),null),K})()};pr(["click"]);var c8=he("<div><div>"),u8=he("<div> "),d8=he("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label><input type=text>"),h8=he("<div><button></button><button></button><button> Crear Nueva Factura</button><button> Resume Report"),al=he("<div>"),p8=he("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),f8=he("<button> "),m8=he("<option>"),y8=he("<div><div></div><div></div><div></div><div>"),Cb=he("<div><span></span><span> "),g8=he("<div><span></span><span> $"),v8=he("<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><span></span></td><td><button>");const uh=t=>parseFloat(t?.toString())||0,b_=t=>{let e=uh(t.qty),r=uh(t.price),n=uh(t.arancel);return`${(e*r+n)?.toFixed(2)}`},__=t=>{let e=Math.abs(t.qty),r=uh(t.salePrice);return`${(e*r)?.toFixed(2)}`},S_=t=>{let e=0;t?.reservas?.forEach(i=>{e+=parseFloat(b_(i))});let r=0;t?.products?.forEach(i=>{r+=parseFloat(__(i))});let n={};return n.reservaSubtotal=e.toFixed(2),n.productSubtotal=r.toFixed(2),n.subtotalBeforeTax=(r+e).toFixed(2),n.total=n.subtotalBeforeTax,n},b8=t=>{const{t:e}=Zt(),[r,n]=Ce(!1),[i,o]=Ce("all"),[s,l]=Ce(""),[c,u]=Ce(""),[h,m]=Ce(null),[g,f]=Ce("dashboard"),[w,x]=Ce([]),[S,C]=Ce(""),[j,oe]=Ce("overview");Cn(async()=>{try{t.invoices;try{const J=await Gi.fetchStores();let V=Array.isArray(J)?J:Object.keys(J)||[]}catch{const V=Gi.state.invoices||t.invoices,ne=[...new Set(V.map(ee=>ee.store))];x(ne.sort())}}catch(J){console.error("Error loading dashboard data:",J)}}),Lt(()=>Gi.state.invoices||t.invoices);const te=Lt(()=>{let J;return t.invoices?J=Gi.getFilteredInvoices({store:i(),dateFrom:s(),dateTo:c()}):J=Gi.getFilteredInvoices({store:i(),dateFrom:s(),dateTo:c()}),J}),Z=async()=>{try{t.invoices,n(!0),await Gi.refreshData({store:i()!=="all"?i():void 0,dateFrom:s()||void 0,dateTo:c()||void 0,search:S()}),n(!1)}catch(J){console.error("Error refreshing data:",J)}},re=Lt(()=>{r();const J=te(),V=Gi.calculateSummary(J);let ne=new Map,ee=new Map,ce=new Map;return J.forEach(se=>{se?.products?.length>0&&se?.products?.forEach(q=>{const ue=Math.abs(q.qty),ye=q.product.label;ne.set(ye,(ne.get(ye)||0)+ue)}),se?.reservas?.length>0&&se?.reservas?.forEach(q=>{let ue=parseInt(q.qty);isNaN(ue)&&(ue=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[q.type]||q?.onlyTariff?(ue=parseFloat(q.arancel)||parseFloat(q.qty)*parseFloat(q.price),ce.set(q.type,(ee.get(q.type)||0)+ue)):ee.set(q.type,(ee.get(q.type)||0)+ue)})}),{...V,productsByCategory:ne,reservasByType:ee,othersByType:ce}}),E=J=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(J),$=J=>new Date(J).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),T={padding:"2rem"},B={display:"flex",gap:"1rem","align-items":"flex-end","margin-bottom":"2rem","flex-wrap":"wrap",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)"},_={display:"flex","flex-direction":"column",gap:"0.5rem",flex:"1","min-width":"200px"},P={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},b={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},H={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(280px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},K={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)"},R={width:"48px",height:"48px","border-radius":"12px",display:"flex","align-items":"center","justify-content":"center","font-size":"1.5rem","margin-bottom":"1rem"},k={"font-size":"0.875rem",color:"var(--text-secondary)","margin-bottom":"0.5rem"},W={"font-size":"1.75rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"0.25rem"},z={"font-size":"0.75rem",color:"var(--text-muted)"},U={width:"100%",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",overflow:"hidden"},le={padding:"1rem","text-align":"left",background:"var(--background-color)","font-weight":"600",color:"var(--text-secondary)","font-size":"0.875rem","border-bottom":"2px solid var(--border-color)"},L={padding:"1rem","border-bottom":"1px solid var(--border-color)"},M={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},G=J=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:J?"var(--primary-color)":"var(--text-muted)","border-bottom":J?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),I={padding:"0.5rem 1rem",background:"var(--primary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","font-size":"0.875rem",transition:"opacity 0.2s"},F={padding:"0.75rem 1.5rem",background:"var(--secondary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},X=()=>[{title:e("invoices.totalRevenue"),value:re().grandTotal,icon:"",color:"#4CAF50",subtext:`${e("common.of")} ${re().totalInvoices} ${e("common.invoice")} `},{title:e("invoices.totalProducts"),value:re().totalProducts,icon:"",color:"#2196F3",subtext:`${E(re().totalProductAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.totalReservations"),value:re().totalReservas,icon:"",color:"#FF9800",subtext:`${E(re().totalReservaAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.aranceles"),value:re().totalAranceles,icon:"",color:"#9C27B0",subtext:e("invoices.customsFees")},{title:e("invoices.uniqueCustomers"),value:re().uniqueCustomers,icon:"",color:"#00BCD4",subtext:e("invoices.activeCustomers"),isNumber:!0},{title:e("invoices.averageInvoice"),value:re().avgInvoiceValue,icon:"",color:"#FF5722",subtext:e("invoices.perInvoiceValue")},{title:e("invoices.completed"),value:re().completedInvoices,icon:"",color:"#4CAF50",subtext:`${re().pendingInvoices} ${e("invoices.pending")}`,isNumber:!0},{title:e("invoices.storesActive"),value:w().length,icon:"",color:"#795548",subtext:e("invoices.locations"),isNumber:!0}],Y=()=>ct.getActiveLocations();Ei(()=>{});const Q=async()=>{let J="YB1";Vy.calcStockLevels(),await ct.fecthProduct(J),await ct.fecthInventory(J)};return Cn(()=>{Q()}),D(lo,{get title(){return e("invoices.title")},get children(){var J=al();return y(J,T),a(J,D(Ge,{get when(){return g()==="dashboard"},get children(){return[D(Ge,{get when(){return!t.invoices&&Gi.state.loading},get children(){var V=c8(),ne=V.firstChild;return V.style.setProperty("text-align","center"),V.style.setProperty("padding","2rem"),ne.style.setProperty("font-size","1.25rem"),ne.style.setProperty("margin-bottom","1rem"),a(ne,()=>e("invoices.loadingInvoices")),V}}),D(Ge,{get when(){return Gi.state.error},get children(){var V=u8();return V.firstChild,V.style.setProperty("padding","1rem"),V.style.setProperty("margin-bottom","1rem"),V.style.setProperty("background","#ffebee"),V.style.setProperty("border","1px solid #ffcdd2"),V.style.setProperty("border-radius","var(--border-radius)"),V.style.setProperty("color","#d32f2f"),a(V,()=>Gi.state.error,null),a(V,D(ht,{variant:"outline",size:"sm",onClick:Z,style:{"margin-left":"1rem"},get children(){return e("invoices.refreshData")}}),null),V}}),(()=>{var V=d8(),ne=V.firstChild,ee=ne.firstChild,ce=ee.nextSibling,se=ce.firstChild,q=ne.nextSibling,ue=q.firstChild,ye=ue.nextSibling,de=q.nextSibling,ge=de.firstChild,xe=ge.nextSibling,pe=de.nextSibling,_e=pe.firstChild,Re=_e.nextSibling;return y(V,B),a(ee,()=>e("invoices.storeLocation")),ce.addEventListener("change",Ee=>o(Ee.currentTarget.value)),a(se,()=>e("invoices.allStores")),a(ce,D(zt,{get each(){return Y()},children:Ee=>(()=>{var Te=m8();return a(Te,()=>Ee.name),we(()=>Te.value=Ee.id),Te})()}),null),a(ue,()=>e("invoices.fromDate")),ye.addEventListener("change",Ee=>l(Ee.currentTarget.value)),a(ge,()=>e("invoices.toDate")),xe.addEventListener("change",Ee=>u(Ee.currentTarget.value)),a(_e,()=>e("invoices.search")),Re.addEventListener("change",Ee=>C(Ee.currentTarget.value)),a(V,D(ht,{variant:"secondary",onClick:()=>{o("all"),l(""),u(""),C("")},get children(){return e("invoices.clearFilters")}}),null),a(V,D(ht,{variant:"primary",onClick:Z,get disabled(){return!t.invoices&&Gi.state.loading},get children(){return[" ",$e(()=>e("invoices.refreshData"))]}}),null),we(Ee=>{var Te=_,Le=P,Ie=b,De=_,Ye=P,Be=b,We=_,Ke=P,st=b,nt=_,He=P,mt=b,ut=e("invoices.searchPlaceholder");return Ee.e=y(ne,Te,Ee.e),Ee.t=y(ee,Le,Ee.t),Ee.a=y(ce,Ie,Ee.a),Ee.o=y(q,De,Ee.o),Ee.i=y(ue,Ye,Ee.i),Ee.n=y(ye,Be,Ee.n),Ee.s=y(de,We,Ee.s),Ee.h=y(ge,Ke,Ee.h),Ee.r=y(xe,st,Ee.r),Ee.d=y(pe,nt,Ee.d),Ee.l=y(_e,He,Ee.l),Ee.u=y(Re,mt,Ee.u),ut!==Ee.c&&Qt(Re,"placeholder",Ee.c=ut),Ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),we(()=>ce.value=i()),we(()=>ye.value=s()),we(()=>xe.value=c()),we(()=>Re.value=S()),V})(),(()=>{var V=h8(),ne=V.firstChild,ee=ne.nextSibling,ce=ee.nextSibling,se=ce.nextSibling;return y(V,M),ne.$$click=()=>oe("overview"),a(ne,()=>e("inventory.overview")),ee.$$click=()=>oe("invoices"),a(ee,()=>e("invoices.invoices")),ce.$$click=()=>oe("add"),se.$$click=()=>oe("report"),we(q=>{var ue=G(j()==="overview"),ye=G(j()==="invoices"),de=G(j()==="add"),ge=G(j()==="report");return q.e=y(ne,ue,q.e),q.t=y(ee,ye,q.t),q.a=y(ce,de,q.a),q.o=y(se,ge,q.o),q},{e:void 0,t:void 0,a:void 0,o:void 0}),V})(),D(Ge,{get when(){return j()==="overview"},get children(){return[(()=>{var V=al();return y(V,H),a(V,D(zt,{get each(){return X()},children:ne=>(()=>{var ee=y8(),ce=ee.firstChild,se=ce.nextSibling,q=se.nextSibling,ue=q.nextSibling;return y(ee,K),a(ce,()=>ne?.icon),y(se,k),a(se,()=>ne?.title),y(q,W),a(q,(()=>{var ye=$e(()=>!!ne.isNumber);return()=>ye()?ne.value:E(ne.value)})()),y(ue,z),a(ue,()=>ne.subtext),we(ye=>y(ce,{...R,background:`${ne?.color}20`,color:ne?.color},ye)),ee})()})),V})(),D(Ge,{get when(){return re()?.productsByCategory?.size>0},get children(){return D(Dt,{get title(){return e("invoices.topProducts")},get subtitle(){return e("invoices.mostSoldProducts")},get children(){var V=al();return V.style.setProperty("max-height","300px"),V.style.setProperty("overflow-y","auto"),a(V,()=>Array.from(re().productsByCategory.entries()).sort((ne,ee)=>ee[1]-ne[1]).slice(0,10).map(([ne,ee])=>(()=>{var ce=Cb(),se=ce.firstChild,q=se.nextSibling,ue=q.firstChild;return ce.style.setProperty("display","flex"),ce.style.setProperty("justify-content","space-between"),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("border-bottom","1px solid var(--border-color)"),a(se,ne),q.style.setProperty("font-weight","600"),a(q,ee,ue),a(q,()=>e("common.units"),null),ce})())),V}})}}),(()=>{var V=al();return V.style.setProperty("margin","19px"),V})(),D(Ge,{get when(){return re()?.reservasByType?.size>0},get children(){return D(Dt,{get title(){return e("invoices.reservationsByType")},get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var V=al();return V.style.setProperty("max-height","300px"),V.style.setProperty("overflow-y","auto"),a(V,()=>Array.from(re().reservasByType.entries()).sort((ne,ee)=>ee[1]-ne[1]).map(([ne,ee])=>(()=>{var ce=Cb(),se=ce.firstChild,q=se.nextSibling,ue=q.firstChild;return ce.style.setProperty("display","flex"),ce.style.setProperty("justify-content","space-between"),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("border-bottom","1px solid var(--border-color)"),a(se,ne),q.style.setProperty("font-weight","600"),a(q,ee,ue),a(q,()=>e("common.lbs"),null),ce})())),V}})}}),(()=>{var V=al();return V.style.setProperty("margin","19px"),V})(),D(Ge,{get when(){return re()?.othersByType?.size>0},get children(){return D(Dt,{title:"Aranceles y otros servicios",get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var V=al();return V.style.setProperty("max-height","300px"),V.style.setProperty("overflow-y","auto"),a(V,()=>Array.from(re().othersByType.entries()).sort((ne,ee)=>ee[1]-ne[1]).map(([ne,ee])=>(()=>{var ce=g8(),se=ce.firstChild,q=se.nextSibling,ue=q.firstChild;return ce.style.setProperty("display","flex"),ce.style.setProperty("justify-content","space-between"),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("border-bottom","1px solid var(--border-color)"),a(se,ne),q.style.setProperty("font-weight","600"),a(q,ee,ue),ce})())),V}})}})]}})]}}),null),a(J,D(Ge,{get when(){return j()==="invoices"},get children(){return[D(Ge,{get when(){return g()!=="detail"},get children(){return D(Dt,{get title(){return e("invoices.recentInvoices")},get subtitle(){return`Mostrando ${te().length} facturas`},style:{"margin-top":"1.5rem"},get children(){var V=p8(),ne=V.firstChild,ee=ne.firstChild,ce=ee.firstChild,se=ce.firstChild,q=se.nextSibling,ue=q.nextSibling,ye=ue.nextSibling,de=ye.nextSibling,ge=de.nextSibling,xe=ge.nextSibling,pe=xe.nextSibling,_e=pe.nextSibling,Re=ee.nextSibling;return V.style.setProperty("overflow-x","auto"),y(ne,U),a(se,()=>e("invoices.invoiceNumber")),a(q,()=>e("invoices.date")),a(ue,()=>e("invoices.customer")),a(ye,()=>e("invoices.store")),a(de,()=>e("invoices.products")),a(ge,()=>e("invoices.reservations")),a(xe,()=>e("invoices.total")),a(pe,()=>e("invoices.status")),a(_e,()=>e("invoices.actions")),a(Re,D(zt,{get each(){return te().slice(0,50)},children:Ee=>{const Te=()=>{let Le=S_(Hm(Ee)),Ie=Le.productSubtotal,De=Le.reservaSubtotal;return{total:Le.total,totalProductAmount:Ie,totalReservaAmount:De,totalOther:0}};return(()=>{var Le=v8(),Ie=Le.firstChild,De=Ie.nextSibling,Ye=De.nextSibling,Be=Ye.nextSibling,We=Be.nextSibling,Ke=We.nextSibling,st=Ke.nextSibling,nt=st.nextSibling,He=nt.firstChild,mt=nt.nextSibling,ut=mt.firstChild;return a(Ie,()=>Ee?.invoice),a(De,()=>$(Ee?.createDate)),a(Ye,()=>Ee?.shipper_consignee?.name),a(Be,()=>Ee?.store),a(We,()=>Te()?.totalProductAmount),a(Ke,()=>Te()?.totalReservaAmount),a(st,()=>E(Te()?.total)),He.style.setProperty("padding","0.25rem 0.75rem"),He.style.setProperty("border-radius","9999px"),He.style.setProperty("font-size","0.75rem"),He.style.setProperty("font-weight","600"),a(He,(()=>{var at=$e(()=>!!Ee.isCompleted);return()=>at()?e("invoices.completed"):e("invoices.pending")})()),ut.addEventListener("mouseleave",at=>at.currentTarget.style.opacity="1"),ut.addEventListener("mouseenter",at=>at.currentTarget.style.opacity="0.8"),ut.$$click=()=>{m(Ee),f("detail")},y(ut,I),a(ut,()=>e("invoices.view")),we(at=>{var It=L,Xe=L,kt=L,Tt=L,wt=L,Rt=L,fr={...L,"text-align":"right","font-weight":"600"},ze=L,Ct=Ee.isCompleted?"#d4edda":"#fff3cd",xt=Ee.isCompleted?"#155724":"#856404",tt=L;return at.e=y(Ie,It,at.e),at.t=y(De,Xe,at.t),at.a=y(Ye,kt,at.a),at.o=y(Be,Tt,at.o),at.i=y(We,wt,at.i),at.n=y(Ke,Rt,at.n),at.s=y(st,fr,at.s),at.h=y(nt,ze,at.h),Ct!==at.r&&((at.r=Ct)!=null?He.style.setProperty("background",Ct):He.style.removeProperty("background")),xt!==at.d&&((at.d=xt)!=null?He.style.setProperty("color",xt):He.style.removeProperty("color")),at.l=y(mt,tt,at.l),at},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Le})()}})),we(Ee=>{var Te=le,Le=le,Ie=le,De=le,Ye=le,Be=le,We={...le,"text-align":"right"},Ke=le,st=le;return Ee.e=y(se,Te,Ee.e),Ee.t=y(q,Le,Ee.t),Ee.a=y(ue,Ie,Ee.a),Ee.o=y(ye,De,Ee.o),Ee.i=y(de,Ye,Ee.i),Ee.n=y(ge,Be,Ee.n),Ee.s=y(xe,We,Ee.s),Ee.h=y(pe,Ke,Ee.h),Ee.r=y(_e,st,Ee.r),Ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),V}})}}),D(Ge,{get when(){return $e(()=>g()==="detail")()&&h()},get children(){return[(()=>{var V=f8();return V.firstChild,V.$$click=()=>{f("dashboard"),m(null)},y(V,F),a(V,()=>e("invoices.backToDashboard"),null),V})(),D(F7,{get invoice(){return h()},onPrint:()=>window.print(),goBack:()=>{f("dashboard"),m(null)}})]}})]}}),null),a(J,D(Ge,{get when(){return j()==="add"},get children(){return D(OD,{})}}),null),a(J,D(Ge,{get when(){return j()==="report"},get children(){return D(l8,{})}}),null),J}})};pr(["click"]);const _8=()=>D(b8,{invoices:[{type:"SALES",invoice:"20255FK6S4B43SSS",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCim",ssg_sorder_key:"JqdrRwGBpdBfRCim",createDate:1736132690425,shipper_consignee:{name:"Yudith Perez Medero",phoneNumberS:"5022408378",dob:"1982-07-23",firstName:"RAUL",lastName:"BATISTA",lastName2:"ESPOSITO",middleName:"",email:"",phoneNumber:"52393232",altPhoneNumber:"",cid:"48121007305",ybstreetNo:"9",ybstreet:"10",ybbetwen1:"CARRALERO",ybbetwen2:"3RA",ybapt:"",ybreparto:"PUEBLO NUEVO",consigneeId:"26144",ssg_consignee_key:"26144",passport:"NA",nacionality:"CUB",ybcity:"HOLGUIN",ybestate:"HOLGUIN",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534800",reservas:[{type:"UTILES DEL HOGAR",qty:"15",arancel:"10",price:"5",key:"1GB16SD80"},{type:"MISCELANEAS",qty:"19",arancel:"",price:"4",key:"0DS6K14Y2"}],products:[{product:{id:"CmrhMfVjLR9HxT6P",label:"FOGONES ELECTRICO DOBLE RESISTENCIA DE ALAMBRE",code:"978Y82K94"},qty:-1,price:23.696296296296296,salePrice:"34"},{product:{id:"ov56aPYGbXIq4XGy",label:"Caramelos",code:"C852CSKB5"},qty:-2,price:5.990000000000001,salePrice:"10"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43TTT",description:"",store:"YY_8803",ssg_inventory_key:"JqdrRwGBpdBfRCin",ssg_sorder_key:"JqdrRwGBpdBfRCin",createDate:1736032690425,shipper_consignee:{name:"Maria Rodriguez Santos",phoneNumberS:"5024567890",dob:"1990-03-15",firstName:"MARIA",lastName:"RODRIGUEZ",lastName2:"SANTOS",middleName:"ELENA",email:"maria@email.com",phoneNumber:"52987654",altPhoneNumber:"",cid:"90031507890",ybstreetNo:"15",ybstreet:"23",ybbetwen1:"MARTI",ybbetwen2:"CESPEDES",ybapt:"2A",ybreparto:"CENTRO",consigneeId:"26145",ssg_consignee_key:"26145",passport:"A1234567",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534801",reservas:[{type:"ELECTRONICOS",qty:"5",arancel:"15",price:"12",key:"2GB16SD81"},{type:"ROPA Y CALZADO",qty:"8",arancel:"8",price:"7",key:"0DS6K14Y3"}],products:[{product:{id:"XmrhMfVjLR9HxT6Q",label:"TELEVISOR LED 32 PULGADAS",code:"TV32LED01"},qty:-1,price:150.5,salePrice:"220"},{product:{id:"Yv56aPYGbXIq4XGz",label:"Zapatos Deportivos Nike",code:"ZAP001"},qty:-1,price:45.99,salePrice:"75"}],isCompleted:!1},{type:"SALES",invoice:"20255FK6S4B43UUU",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCio",ssg_sorder_key:"JqdrRwGBpdBfRCio",createDate:1735932690425,shipper_consignee:{name:"Carlos Mendez Perez",phoneNumberS:"5025678901",dob:"1975-12-08",firstName:"CARLOS",lastName:"MENDEZ",lastName2:"PEREZ",middleName:"ANTONIO",email:"",phoneNumber:"52876543",altPhoneNumber:"",cid:"75120878901",ybstreetNo:"7",ybstreet:"45",ybbetwen1:"LINEA",ybbetwen2:"PASEO",ybapt:"",ybreparto:"VEDADO",consigneeId:"26146",ssg_consignee_key:"26146",passport:"NA",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534802",reservas:[{type:"ALIMENTOS",qty:"25",arancel:"5",price:"3",key:"3GB16SD82"}],products:[{product:{id:"ZmrhMfVjLR9HxT6R",label:"ARROZ ESPECIAL 5LB",code:"ARZ005"},qty:-5,price:2.5,salePrice:"4"},{product:{id:"Av56aPYGbXIq4XG1",label:"ACEITE DE COCINA 1L",code:"ACE001"},qty:-3,price:3.75,salePrice:"6"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43VVV",description:"",store:"YY_8802",ssg_inventory_key:"JqdrRwGBpdBfRCip",ssg_sorder_key:"JqdrRwGBpdBfRCip",createDate:1735832690425,shipper_consignee:{name:"Ana Lucia Fernandez",phoneNumberS:"5026789012",dob:"1988-06-20",firstName:"ANA",lastName:"FERNANDEZ",lastName2:"LOPEZ",middleName:"LUCIA",email:"ana.lucia@email.com",phoneNumber:"52765432",altPhoneNumber:"52111222",cid:"88062076789",ybstreetNo:"12",ybstreet:"18",ybbetwen1:"CALZADA",ybbetwen2:"SAN LAZARO",ybapt:"3B",ybreparto:"CENTRO HABANA",consigneeId:"26147",ssg_consignee_key:"26147",passport:"B9876543",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:"Entrega en horario de oficina"},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534803",reservas:[{type:"MEDICINA Y SALUD",qty:"10",arancel:"12",price:"8",key:"4GB16SD83"},{type:"UTILES DEL HOGAR",qty:"6",arancel:"6",price:"4",key:"5GB16SD84"}],products:[{product:{id:"BmrhMfVjLR9HxT6S",label:"VITAMINAS MULTIPLES 60 CAP",code:"VIT001"},qty:-2,price:12.5,salePrice:"18"}],isCompleted:!0}]}),dh={invoice:"",description:"",store:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",cid:"",passport:"",address:""},products:[],reservas:[],packagesOrder:!1,shippingType:"SEA"},Ky="invoice_form_draft",S8=()=>{try{const t=localStorage.getItem(Ky);if(t){const e=JSON.parse(t),r={...dh,...e,shipper_consignee:{...dh.shipper_consignee,...e.shipper_consignee||{}},products:e.products||[],reservas:e.reservas||[]};return console.log("Loaded form data from storage:",r),r}}catch(t){console.warn("Failed to load invoice form from storage:",t)}return console.log("No saved data found, using default form data"),{...dh}},Jy=t=>{try{localStorage.setItem(Ky,JSON.stringify(t))}catch(e){console.warn("Failed to save invoice form to storage:",e)}},Ib=()=>{try{localStorage.removeItem(Ky)}catch(t){console.warn("Failed to clear invoice form from storage:",t)}},[fl,Ts]=Ce(S8()),[P_,No]=Ce(!1),[P8,hh]=Ce(null);let Ff=null;const ga=()=>{Ff&&clearTimeout(Ff),Ff=setTimeout(()=>{const t=fl();Jy(t),hh(new Date),console.log("Invoice form auto-saved at",new Date().toLocaleTimeString())},1e3)},w8={formData:fl,get isDirty(){return P_()},get lastSaved(){return P8()},updateForm:t=>{Ts(e=>{const r={...e,...t};return No(!0),ga(),r})},updateShipperConsignee:t=>{Ts(e=>{const r={...e,shipper_consignee:{...e.shipper_consignee,...t}};return No(!0),ga(),r})},addProduct:t=>{Ts(e=>{const r={...e,products:[...e.products,t]};return No(!0),ga(),r})},updateProduct:(t,e)=>{Ts(r=>{const n=[...r.products];n[t]={...n[t],...e};const i={...r,products:n};return No(!0),ga(),i})},removeProduct:t=>{Ts(e=>{const r=e.products.filter((i,o)=>o!==t),n={...e,products:r};return No(!0),ga(),n})},addReserva:t=>{Ts(e=>{const r={...e,reservas:[...e.reservas,t]};return No(!0),ga(),r})},updateReserva:(t,e)=>{Ts(r=>{const n=[...r.reservas];n[t]={...n[t],...e};const i={...r,reservas:n};return No(!0),ga(),i})},removeReserva:t=>{Ts(e=>{const r=e.reservas.filter((i,o)=>o!==t),n={...e,reservas:r};return No(!0),ga(),n})},clearForm:()=>{Ts({...dh}),No(!1),Ib(),hh(null)},markCompleted:()=>{Ib(),No(!1),hh(null)},forceSave:()=>{Jy(fl()),hh(new Date),No(!1)},hasData:()=>{const t=fl();return t.invoice!==""||t.description!==""||t.store!==""||t.shipper_consignee.name!==""||t.shipper_consignee.firstName!==""||t.shipper_consignee.cid!==""||t.products.length>0||t.reservas.length>0},isValid:()=>{const t=fl();return t.invoice.trim()!==""&&t.shipper_consignee.firstName.trim()!==""&&t.shipper_consignee.lastName.trim()!==""&&t.shipper_consignee.cid.trim()!==""&&(t.products.length>0||t.reservas.length>0)},getFormData:()=>fl()};typeof window<"u"&&window.addEventListener("beforeunload",t=>{if(P_()&&(Jy(fl()),w8.hasData()))return t.preventDefault(),t.returnValue="You have unsaved changes in your invoice. Are you sure you want to leave?",t.returnValue});var x8=he("<div><main>");const A8=t=>[D(g$,{}),$e(()=>t.children)],C8=()=>D(WI,{get children(){var t=x8(),e=t.firstChild;return a(e,D(fP,{root:A8,get children(){return[D(bo,{path:"/",component:y7}),D(bo,{path:"/accounts",component:()=>D(Eo,{permission:"AccountAccess",featureName:"Accounts",get children(){return D(aE,{})}})}),D(bo,{path:"/accounts/:id",component:()=>D(Eo,{permission:"AccountAccess",featureName:"Account Details",get children(){return D(fE,{})}})}),D(bo,{path:"/entry-books",component:()=>D(Eo,{permission:"JournalAccess",featureName:"Entry Books",get children(){return D(gL,{})}})}),D(bo,{path:"/employees",component:()=>D(Eo,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return D(fN,{})}})}),D(bo,{path:"/bank-consolidations",component:()=>D(Eo,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return D(qN,{})}})}),D(bo,{path:"/balance-sheet",component:()=>D(Eo,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return D(_E,{})}})}),D(bo,{path:"/invoices",component:()=>D(Eo,{permission:"invoiceAccess",featureName:"Invoices",get children(){return D(_8,{})}})}),D(bo,{path:"/inventory",component:()=>D(Eo,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return D(oN,{})}})}),D(bo,{path:"/products",component:()=>D(Eo,{permission:"InventoryAccess",featureName:"Product Management",get children(){return D(k5,{})}})}),D(bo,{path:"/hbl",component:()=>D(Eo,{permission:"HBLAccess",featureName:"HBL Management",get children(){return D(c7,{})}})}),D(bo,{path:"/admin/users",component:()=>D(Eo,{permission:"isAdmin",featureName:"User Administration",get children(){return D(I7,{})}})})]}})),a(t,(()=>{var r=$e(()=>!1);return()=>r()&&D(E$,{})})(),null),t}}),I8=document.getElementById("root");ES(()=>D(C8,{}),I8);export{sr as E,Ji as _,rn as a,k8 as b,ct as i,r_ as j};
