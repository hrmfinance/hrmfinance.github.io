import{g as j,O as Oe,P as at,c as ee,f as Yt,W as st,t as f,h as e,i as o,a as b,b as h,F as je,S as p,d as Ye,_ as ct,V as tt,v as Ge,A as Qt,aB as Jt}from"./index-wpMFRghj.js";const He=[{code:"USD",name:"US Dollar",symbol:"$"},{code:"EUR",name:"Euro",symbol:"€"},{code:"CUP",name:"Peso Cubano",symbol:"$"},{code:"CUC",name:"Peso Convertible Cubano",symbol:"CUC"}],rt=[{value:"pending",label:"Pendiente",color:"#f59e0b"},{value:"processing",label:"Procesando",color:"#3b82f6"},{value:"completed",label:"Completada",color:"#10b981"},{value:"cancelled",label:"Cancelada",color:"#ef4444"}],Xt=()=>{const n=new Date,l=n.getFullYear(),S=String(n.getMonth()+1).padStart(2,"0"),t=String(n.getDate()).padStart(2,"0"),s=`${l}${S}${t}`,y=String(n.getHours()).padStart(2,"0"),i=String(n.getMinutes()).padStart(2,"0"),z=String(n.getSeconds()).padStart(2,"0"),I=`${y}${i}${z}`,G=Math.random().toString(36).substr(2,5).toUpperCase();return`REM-${s}-${I}-${G}`},Ve={async getAll(n,l=1,S=20){try{let t={businessId:j.getBusinessId(),page:l,pageSize:S},s=["businessId = businessId"];const y=j.state?.profile;y&&!y.isAdmin&&!y.read_write&&(t[":createdBy"]=j.currentUser?.uid||"unknown",s.push("createdBy = :createdBy")),n?.search&&n.search.split(" ").forEach((G,H)=>{const J=`search${H}`;t[`:${J}`]=G.trim(),s.push(`(remittanceNumber contain :${J} OR customerName contain :${J} OR reference contain :${J})`)}),n?.status&&(t[":status"]=n.status,s.push("status = :status")),n?.currency&&(t[":currency"]=n.currency,s.push("currency = :currency")),n?.dateFrom&&(t[":dateFrom"]=n.dateFrom.toISOString(),s.push("createdAt >= :dateFrom")),n?.dateTo&&(t[":dateTo"]=n.dateTo.toISOString(),s.push("createdAt <= :dateTo")),n?.customerId&&(t[":customerId"]=n.customerId,s.push("customerId = :customerId"));const z={query:"getRemittance",queryString:s.join(" AND "),params:t},I=await Oe(z);return{remittances:I.data||[],total:I.total||0,page:l,pageSize:S}}catch(t){return console.error("Error fetching remittances:",t),{remittances:[],total:0,page:l,pageSize:S}}},async getById(n){try{const l={businessId:j.getBusinessId(),id:n},S={query:"getRemittance",queryString:"businessId = businessId AND id = id",params:{businessId:l.businessId,id:l.id}},t=await Oe(S);return console.log(t),t.data&&t.data.length>0?t.data[0]:null}catch(l){return console.error("Error fetching remittance by ID:",l),null}},async create(n){try{const l=Xt(),S={...n,remittanceNumber:l,id:at(),date:new Date,status:"pending",createdAt:new Date,updatedAt:new Date,businessId:j.getBusinessId(),createdBy:j.currentUser?.uid||"unknown"},s={query:"addRemittance",params:{businessId:j.getBusinessId()},form:S},y=await Oe(s);if(y.error)throw new Error(y.error);return{...S}}catch(l){throw console.error("Error creating remittance:",l),new Error("Error al crear la remesa")}},async update(n){try{const l={...n,updatedAt:new Date},t={query:"updateRemittance",params:{businessId:j.getBusinessId(),id:n.id},form:l},s=await Oe(t);if(s.error)throw new Error(s.error);const y=await this.getById(n.id);if(!y)throw new Error("No se pudo recuperar la remesa actualizada");return y}catch(l){throw console.error("Error updating remittance:",l),new Error("Error al actualizar la remesa")}},async delete(n){try{const S={query:"deleteRemittance",params:{businessId:j.getBusinessId(),id:n}},t=await Oe(S);if(t.error)throw new Error(t.error);return{success:!0,message:"Remesa eliminada exitosamente"}}catch(l){return console.error("Error deleting remittance:",l),{success:!1,message:"Error al eliminar la remesa"}}},async updateStatus(n,l){return this.update({id:n,status:l})},async getByCustomer(n){try{const l={customerId:n};return(await this.getAll(l,1,100)).remittances}catch(l){return console.error("Error fetching remittances by customer:",l),[]}},async getStatistics(){try{const l={query:"getRemittanceStatistics",params:{businessId:j.getBusinessId()}};return(await Oe(l)).data||{total:0,byStatus:{},byCurrency:{},totalAmount:{}}}catch(n){return console.error("Error fetching remittance statistics:",n),{total:0,byStatus:{},byCurrency:{},totalAmount:{}}}}},dt=n=>({pending:"Pendiente",processing:"Procesando",completed:"Completada",cancelled:"Cancelada"})[n]||n,Ke=n=>({pending:"#f59e0b",processing:"#3b82f6",completed:"#10b981",cancelled:"#ef4444"})[n]||"#6b7280";var Zt=f("<th>Creado por"),er=f("<table><thead><tr><th>Número</th><th>Cliente</th><th>Cantidad</th><th>Estado</th><th>Fecha</th><th>Acciones</th></tr></thead><tbody>"),tr=f("<div><button>Anterior</button><span>Página <!> de </span><button>Siguiente"),rr=f('<div><div><h1>Lista de Remesas</h1><button>+ Nueva Remesa</button></div><div><div><label>Buscar</label><input type=text placeholder="Número, cliente, referencia..."></div><div><label>Estado</label><select><option value>Todos los estados</option></select></div><div><label>Moneda</label><select><option value>Todas las monedas</option></select></div><div><label>&nbsp;</label><div><button>Filtrar</button><button>Limpiar'),nt=f("<option>"),nr=f("<option> - "),ir=f("<div>Cargando remesas..."),or=f("<div><p>No se encontraron remesas.</p><button>Crear primera remesa"),it=f("<br>"),lr=f("<small>Ref: "),ar=f("<small>Cédula: "),sr=f("<small> $"),cr=f("<select>"),dr=f("<td><small>"),ur=f("<button>Editar"),vr=f("<button>Eliminar"),mr=f("<tr><td><strong></strong></td><td><div></div></td><td><strong></strong></td><td></td><td></td><td><button>Ver"),gr=f("<span>");const hr=n=>{const[l,S]=ee({}),[t,s]=ee(1),[y]=ee(20),[i,z]=ee(""),[I,G]=ee(""),[H,J]=ee(""),[P,te]=ee(!1),re=Yt(()=>{const F={};return i()&&(F.search=i()),I()&&(F.status=I()),H()&&(F.currency=H()),F}),[m,{refetch:x}]=st(()=>({filter:re(),page:t(),pageSize:y()}),async({filter:F,page:Y,pageSize:ve})=>await Ve.getAll(F,Y,ve)),D=async F=>{if(confirm(`¿Está seguro que desea eliminar la remesa ${F.remittanceNumber}?`)){const Y=await Ve.delete(F.id);Y.success?(alert("Remesa eliminada exitosamente"),x()):alert(Y.message)}},be=async(F,Y)=>{try{await Ve.updateStatus(F.id,Y),alert("Estado actualizado exitosamente"),x()}catch{alert("Error al actualizar el estado")}},Te=()=>{s(1),x()},U=()=>{z(""),G(""),J(""),s(1),x()},_=(F,Y)=>`${He.find(fe=>fe.code===Y)?.symbol||Y} ${F.toFixed(2)}`,W={padding:"2rem","background-color":"var(--background-color)"},k={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},Re={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)"},De={padding:"0.75rem 1.5rem","background-color":"var(--primary-color)",color:"white",border:"none","border-radius":"4px",cursor:"pointer","font-weight":"500"},L={display:"flex",gap:"1rem","margin-bottom":"2rem","flex-wrap":"wrap","align-items":"end"},ie={display:"flex","flex-direction":"column",gap:"0.5rem"},Ce={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},Ae={padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"4px","font-size":"0.875rem"},we={...Ae,cursor:"pointer"},v={padding:"0.5rem 1rem",border:"none","border-radius":"4px",cursor:"pointer","font-size":"0.875rem","font-weight":"500"},$={...v,"background-color":"var(--primary-color)",color:"white"},M={...v,"background-color":"var(--border-color)",color:"var(--text-secondary)"},X={width:"100%","border-collapse":"collapse","background-color":"white","border-radius":"8px",overflow:"hidden","box-shadow":"0 1px 3px rgba(0,0,0,0.1)"},K={padding:"1rem","text-align":"left","background-color":"var(--strip-color)","font-weight":"600","font-size":"0.875rem",color:"var(--text-primary)","border-bottom":"1px solid var(--border-color)"},A={padding:"1rem","border-bottom":"1px solid var(--border-light)","font-size":"0.875rem","vertical-align":"middle"},pe=F=>({display:"inline-block",padding:"0.25rem 0.5rem","border-radius":"12px","font-size":"0.75rem","font-weight":"500","background-color":Ke(F)+"20",color:Ke(F)}),ue={...v,padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-right":"0.5rem"},xe={...ue,"background-color":"#3b82f6",color:"white"},Le={...ue,"background-color":"#6b7280",color:"white"},Pe={...ue,"background-color":"#ef4444",color:"white"},_e={display:"flex","justify-content":"center","align-items":"center",gap:"1rem","margin-top":"2rem"},Me={"text-align":"center",padding:"3rem",color:"var(--text-muted)"},Ue={"text-align":"center",padding:"3rem",color:"var(--text-muted)"};return(()=>{var F=rr(),Y=F.firstChild,ve=Y.firstChild,me=ve.nextSibling,fe=Y.nextSibling,$e=fe.firstChild,a=$e.firstChild,E=a.nextSibling,q=$e.nextSibling,N=q.firstChild,le=N.nextSibling;le.firstChild;var ge=q.nextSibling,Se=ge.firstChild,ae=Se.nextSibling;ae.firstChild;var Fe=ge.nextSibling,R=Fe.firstChild,se=R.nextSibling,Z=se.firstChild,ce=Z.nextSibling;return e(F,W),e(Y,k),e(ve,Re),me.$$click=()=>n.onCreate(),e(me,De),e(fe,L),E.$$input=d=>z(d.target.value),le.addEventListener("change",d=>G(d.target.value)),o(le,b(je,{each:rt,children:d=>(()=>{var C=nt();return o(C,()=>d.label),h(()=>C.value=d.value),C})()}),null),ae.addEventListener("change",d=>J(d.target.value)),o(ae,b(je,{each:He,children:d=>(()=>{var C=nr(),O=C.firstChild;return o(C,()=>d.code,O),o(C,()=>d.name,null),h(()=>C.value=d.code),C})()}),null),Z.$$click=Te,ce.$$click=U,o(F,b(p,{get when(){return!m.loading},get fallback(){return(()=>{var d=ir();return h(C=>e(d,Me,C)),d})()},get children(){return b(p,{get when(){return m()?.remittances.length>0},get fallback(){return(()=>{var d=or(),C=d.firstChild,O=C.nextSibling;return O.$$click=()=>n.onCreate(),h(ne=>{var oe=Ue,de=$;return ne.e=e(d,oe,ne.e),ne.t=e(O,de,ne.t),ne},{e:void 0,t:void 0}),d})()},get children(){return[(()=>{var d=er(),C=d.firstChild,O=C.firstChild,ne=O.firstChild,oe=ne.nextSibling,de=oe.nextSibling,V=de.nextSibling,ke=V.nextSibling,Ee=ke.nextSibling,Ne=C.nextSibling;return o(O,b(p,{get when(){return j.state?.profile?.isAdmin||j.state?.profile?.read_write},get children(){var u=Zt();return h(he=>e(u,K,he)),u}}),Ee),o(Ne,b(je,{get each(){return m()?.remittances||[]},children:u=>(()=>{var he=mr(),ye=he.firstChild,Be=ye.firstChild,ze=ye.nextSibling,qe=ze.firstChild,Ie=ze.nextSibling,We=Ie.firstChild,r=Ie.nextSibling,B=r.nextSibling,T=B.nextSibling,g=T.firstChild;return o(Be,()=>u.remittanceNumber),o(ye,b(p,{get when(){return u.reference},get children(){return[it(),(()=>{var c=lr();return c.firstChild,c.style.setProperty("color","var(--text-muted)"),o(c,()=>u.reference,null),c})()]}}),null),o(qe,()=>u.customer.fullName||u.customer.name),o(ze,b(p,{get when(){return u.customer.cid},get children(){var c=ar();return c.firstChild,c.style.setProperty("color","var(--text-muted)"),o(c,()=>u.customer.cid,null),c}}),null),o(We,()=>_(u.amount,u.currency)),o(Ie,b(p,{get when(){return u.currency!=="USD"&&u.exchangeRate},get children(){return[it(),(()=>{var c=sr(),w=c.firstChild;return c.style.setProperty("color","var(--text-muted)"),o(c,()=>u.currency,w),o(c,()=>(u.amount*(u.exchangeRate||1)).toFixed(2),null),c})()]}}),null),o(r,b(p,{get when(){return j.state?.profile?.isAdmin||j.state?.profile?.read_write||u.createdBy===j.currentUser?.uid},get fallback(){return(()=>{var c=gr();return o(c,()=>dt(u.status)),h(w=>e(c,pe(u.status),w)),c})()},get children(){var c=cr();return c.addEventListener("change",w=>be(u,w.target.value)),o(c,b(je,{each:rt,children:w=>(()=>{var Q=nt();return o(Q,()=>w.label),h(()=>Q.value=w.value),Q})()})),h(w=>e(c,{...we,...pe(u.status),border:"none",background:"transparent"},w)),h(()=>c.value=u.status),c}})),o(B,()=>new Date(u.date).toLocaleDateString("es-ES")),o(he,b(p,{get when(){return j.state?.profile?.isAdmin||j.state?.profile?.read_write},get children(){var c=dr(),w=c.firstChild;return w.style.setProperty("color","var(--text-muted)"),o(w,()=>u.createdBy||"N/A"),h(Q=>e(c,A,Q)),c}}),T),g.$$click=()=>n.onView(u),o(T,b(p,{get when(){return j.state?.profile?.isAdmin||j.state?.profile?.read_write||u.createdBy===j.currentUser?.uid},get children(){return[(()=>{var c=ur();return c.$$click=()=>n.onEdit(u),h(w=>e(c,xe,w)),c})(),(()=>{var c=vr();return c.$$click=()=>D(u),h(w=>e(c,Pe,w)),c})()]}}),null),h(c=>{var w=A,Q=A,Qe=A,Je=A,Xe=A,Ze=A,et=Le;return c.e=e(ye,w,c.e),c.t=e(ze,Q,c.t),c.a=e(Ie,Qe,c.a),c.o=e(r,Je,c.o),c.i=e(B,Xe,c.i),c.n=e(T,Ze,c.n),c.s=e(g,et,c.s),c},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),he})()})),h(u=>{var he=X,ye=K,Be=K,ze=K,qe=K,Ie=K,We=K;return u.e=e(d,he,u.e),u.t=e(ne,ye,u.t),u.a=e(oe,Be,u.a),u.o=e(de,ze,u.o),u.i=e(V,qe,u.i),u.n=e(ke,Ie,u.n),u.s=e(Ee,We,u.s),u},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),d})(),b(p,{get when(){return m()?.total>y()},get children(){var d=tr(),C=d.firstChild,O=C.nextSibling,ne=O.firstChild,oe=ne.nextSibling;oe.nextSibling;var de=O.nextSibling;return e(d,_e),C.$$click=()=>s(t()-1),o(O,t,oe),o(O,()=>Math.ceil((m()?.total||0)/y()),null),de.$$click=()=>s(t()+1),h(V=>{var ke=M,Ee=t()===1,Ne=M,u=t()>=Math.ceil((m()?.total||0)/y());return V.e=e(C,ke,V.e),Ee!==V.t&&(C.disabled=V.t=Ee),V.a=e(de,Ne,V.a),u!==V.o&&(de.disabled=V.o=u),V},{e:void 0,t:void 0,a:void 0,o:void 0}),d}})]}})}}),null),h(d=>{var C=ie,O=Ce,ne=Ae,oe=ie,de=Ce,V=we,ke=ie,Ee=Ce,Ne=we,u=ie,he=Ce,ye=$,Be=M;return d.e=e($e,C,d.e),d.t=e(a,O,d.t),d.a=e(E,ne,d.a),d.o=e(q,oe,d.o),d.i=e(N,de,d.i),d.n=e(le,V,d.n),d.s=e(ge,ke,d.s),d.h=e(Se,Ee,d.h),d.r=e(ae,Ne,d.r),d.d=e(Fe,u,d.d),d.l=e(R,he,d.l),d.u=e(Z,ye,d.u),d.c=e(ce,Be,d.c),d},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),h(()=>E.value=i()),h(()=>le.value=I()),h(()=>ae.value=H()),F})()};Ye(["click","input"]);const br=n=>{const l=58.419999999999995,S=4*25.4,t=new ct({orientation:"portrait",unit:"mm",format:[l,S]}),s=5,y=5;let i=s;const z=(m,x,D=10)=>{t.setFontSize(D);const be=t.splitTextToSize(m,l-2*s);return t.text(be,s,x),x+be.length*y};t.setFontSize(14),t.setFont("helvetica","bold"),t.text("REMESA",l/2,i,{align:"center"}),i+=8,t.setLineWidth(.5),t.line(s,i,l-s,i),i+=5,t.setFontSize(8),t.setFont("helvetica","normal");const I=new Date(n.date);t.text(`Fecha: ${I.toLocaleDateString("es-ES")}`,s,i),i+=4,t.text(`No.: ${n.remittanceNumber}`,s,i),i+=4,t.setLineWidth(.2),t.line(s,i,l-s,i),i+=5,t.setFontSize(10),t.setFont("helvetica","bold"),t.text("DESTINATARIO:",s,i),i+=5,t.setFont("helvetica","normal");const G=n.customer.fullName||`${n.customer.firstName||""} ${n.customer.lastName||""}`.trim()||n.customer.name;i=z(G,i,9),i+=2,n.customer.address&&(t.setFontSize(8),i=z(n.customer.address,i,8),i+=2),n.customer.phoneNumber&&(t.setFontSize(8),t.text(`Teléfono: ${n.customer.phoneNumber}`,s,i),i+=4),n.customer.cid&&(t.setFontSize(8),t.text(`Cédula: ${n.customer.cid}`,s,i),i+=4),i+=2,t.setLineWidth(.2),t.line(s,i,l-s,i),i+=5,t.setFontSize(10),t.setFont("helvetica","bold"),t.text("CANTIDAD:",s,i),i+=5;const H={USD:"$",EUR:"€",CUP:"₱",CUC:"CUC$"};t.setFontSize(14),t.setFont("helvetica","bold");const P=`${H[n.currency]||n.currency}${n.amount.toFixed(2)}`;if(t.text(P,l/2,i,{align:"center"}),i+=6,t.setFontSize(8),t.setFont("helvetica","normal"),t.text(n.currency,l/2,i,{align:"center"}),i+=5,n.currency!=="USD"&&n.exchangeRate){t.setFontSize(8);const m=(n.amount*n.exchangeRate).toFixed(2);t.text(`(USD $${m})`,l/2,i,{align:"center"}),i+=5}n.reference&&(i+=3,t.setLineWidth(.2),t.line(s,i,l-s,i),i+=5,t.setFontSize(8),t.setFont("helvetica","normal"),i=z(`Referencia: ${n.reference}`,i,8)),S-i-s>10&&(i=S-10,t.setFontSize(6),t.setFont("helvetica","italic"),t.text("Gracias por su confianza",l/2,i,{align:"center"}));const re=`remesa_${n.customer.cid||"cliente"}_${Date.now()}.pdf`;t.save(re)},ut=n=>{const l=58.419999999999995,S=5*25.4,t=new ct({orientation:"portrait",unit:"mm",format:[l,S]}),s=5,y=5;let i=s;const z=(re,m,x=10)=>{t.setFontSize(x);const D=t.splitTextToSize(re,l-2*s);return t.text(D,s,m),m+D.length*y};t.setFontSize(14),t.setFont("helvetica","bold"),t.text("REMESA",l/2,i,{align:"center"}),i+=8,t.setLineWidth(.5),t.line(s,i,l-s,i),i+=5,t.setFontSize(8),t.setFont("helvetica","normal");const I=new Date(n.date);t.text(`Fecha: ${I.toLocaleDateString("es-ES")}`,s,i),i+=4,t.text(`No.: ${n.remittanceNumber}`,s,i),i+=4,t.setLineWidth(.2),t.line(s,i,l-s,i),i+=5,t.setFontSize(10),t.setFont("helvetica","bold"),t.text("DESTINATARIO:",s,i),i+=5,t.setFont("helvetica","normal");const G=n.customer.fullName||`${n.customer.firstName||""} ${n.customer.lastName||""}`.trim()||n.customer.name;i=z(G,i,9),i+=2,n.customer.address&&(t.setFontSize(8),i=z(n.customer.address,i,8),i+=2),n.customer.phoneNumber&&(t.setFontSize(8),t.text(`Teléfono: ${n.customer.phoneNumber}`,s,i),i+=4),n.customer.cid&&(t.setFontSize(8),t.text(`Cédula: ${n.customer.cid}`,s,i),i+=4),i+=2,t.setLineWidth(.2),t.line(s,i,l-s,i),i+=5,t.setFontSize(10),t.setFont("helvetica","bold"),t.text("CANTIDAD:",s,i),i+=9;const H={USD:"$",EUR:"€",CUP:"$",CUC:"CUC"};if(n.currency!=="USD"&&n.exchangeRate){t.setFontSize(14),t.setFont("helvetica","bold");const re=H[n.currency]||n.currency,m=(n.amount*n.exchangeRate).toFixed(2),x=`${n.currency} ${re} ${m}`;t.text(x,l/2,i,{align:"center"}),i+=6,t.setFontSize(8),t.text(`(USD $${n.amount.toFixed(2)})`,l/2,i,{align:"center"}),i+=5}n.reference&&(i+=3,t.setLineWidth(.2),t.line(s,i,l-s,i),i+=5,t.setFontSize(8),t.setFont("helvetica","normal"),i=z(`Referencia: ${n.reference}`,i,8)),S-i-s>10&&(i=S-10,t.setFontSize(6),t.setFont("helvetica","italic"),t.text("Gracias por su confianza",l/2,i,{align:"center"}));const P=t.output("dataurlstring"),te=window.open();te&&te.document.write(`
      <html>
        <head>
          <title>Recibo de Remesa</title>
          <style>
            body { margin: 0; padding: 20px; background: #f0f0f0; display: flex; justify-content: center; }
            iframe { box-shadow: 0 0 20px rgba(0,0,0,0.2); }
          </style>
        </head>
        <body>
          <iframe src="${P}" width="600" height="800"></iframe>
        </body>
      </html>
    `)};var fr=f("<div><div><div><h2>Detalles de Remesa</h2><button>×"),Sr=f("<div>Cargando detalles..."),yr=f("<div>No se pudo cargar la remesa"),xr=f("<div><span>Dirección</span><span>"),$r=f("<div><span>Tasa de Cambio</span><span>"),Cr=f("<div><span>Equivalente </span><span>$"),wr=f("<div><h3>Notas</h3><div>"),pr=f("<div><span>Creado por</span><span>"),_r=f("<div><div><h3>Información General</h3><div><div><span>Número de Remesa</span><span></span></div><div><span>Estado</span><span></span></div><div><span>Fecha</span><span></span></div><div><span>Referencia</span><span></span></div></div></div><div><h3>Información del Cliente</h3><div><div><span>Nombre Completo</span><span></span></div><div><span>Cédula</span><span></span></div><div><span>Teléfono</span><span></span></div><div><span>Email</span><span></span></div></div></div><div><h3>Información Financiera</h3><div><div><span>Cantidad</span><span> USD</span></div><div><span>Moneda</span><span></span></div></div></div><div><h3>Información de Auditoría</h3><div><div><span>Creado</span><span></span></div><div><span>Última Actualización</span><span>"),Fr=f("<div><button>Vista Previa PDF</button><button>Editar</button><button>Cerrar");const Er=n=>{const[l,S]=ee(!1),[t]=st(()=>n.remittanceId,async L=>L?await Ve.getById(L):null),s=async()=>{const L=t();if(L)try{await ut(L)}catch(ie){console.error("Error previewing PDF:",ie),alert("Error al mostrar la vista previa")}},y=(L,ie)=>`${He.find(we=>we.code===ie)?.symbol||ie} ${L.toFixed(2)}`,i={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},z={"background-color":"white","border-radius":"8px","max-width":"600px",width:"90%","max-height":"90%",overflow:"auto","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1)"},I={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},G={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)"},H={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)"},J={padding:"1.5rem"},P={"margin-bottom":"2rem"},te={"font-size":"1rem","font-weight":"600","margin-bottom":"1rem",color:"var(--text-primary)","border-bottom":"1px solid var(--border-light)","padding-bottom":"0.5rem"},re={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},m={display:"flex","flex-direction":"column",gap:"0.25rem"},x={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},D={"font-size":"0.875rem",color:"var(--text-primary)"},be={...D,"font-weight":"600","font-size":"1rem"},Te=L=>({display:"inline-block",padding:"0.5rem 1rem","border-radius":"20px","font-size":"0.875rem","font-weight":"500","background-color":Ke(L)+"20",color:Ke(L)}),U={padding:"1.5rem","border-top":"1px solid var(--border-color)",display:"flex",gap:"1rem","justify-content":"flex-end"},_={padding:"0.75rem 1.5rem",border:"none","border-radius":"4px",cursor:"pointer","font-weight":"500","font-size":"0.875rem"},W={..._,"background-color":"var(--primary-color)",color:"white"},k={..._,"background-color":"var(--border-color)",color:"var(--text-secondary)"},Re={"text-align":"center",padding:"2rem",color:"var(--text-muted)"},De={"text-align":"center",padding:"2rem",color:"#ef4444"};return(()=>{var L=fr(),ie=L.firstChild,Ce=ie.firstChild,Ae=Ce.firstChild,we=Ae.nextSibling;return tt(L,"click",n.onClose,!0),ie.$$click=v=>v.stopPropagation(),e(ie,z),e(Ce,I),e(Ae,G),tt(we,"click",n.onClose,!0),e(we,H),o(ie,b(p,{get when(){return!t.loading},get fallback(){return(()=>{var v=Sr();return h($=>e(v,Re,$)),v})()},get children(){return b(p,{get when(){return t()},get fallback(){return(()=>{var v=yr();return h($=>e(v,De,$)),v})()},children:v=>[(()=>{var $=_r(),M=$.firstChild,X=M.firstChild,K=X.nextSibling,A=K.firstChild,pe=A.firstChild,ue=pe.nextSibling,xe=A.nextSibling,Le=xe.firstChild,Pe=Le.nextSibling,_e=xe.nextSibling,Me=_e.firstChild,Ue=Me.nextSibling,F=_e.nextSibling,Y=F.firstChild,ve=Y.nextSibling,me=M.nextSibling,fe=me.firstChild,$e=fe.nextSibling,a=$e.firstChild,E=a.firstChild,q=E.nextSibling,N=a.nextSibling,le=N.firstChild,ge=le.nextSibling,Se=N.nextSibling,ae=Se.firstChild,Fe=ae.nextSibling,R=Se.nextSibling,se=R.firstChild,Z=se.nextSibling,ce=me.nextSibling,d=ce.firstChild,C=d.nextSibling,O=C.firstChild,ne=O.firstChild,oe=ne.nextSibling,de=oe.firstChild,V=O.nextSibling,ke=V.firstChild,Ee=ke.nextSibling,Ne=ce.nextSibling,u=Ne.firstChild,he=u.nextSibling,ye=he.firstChild,Be=ye.firstChild,ze=Be.nextSibling,qe=ye.nextSibling,Ie=qe.firstChild,We=Ie.nextSibling;return e($,J),o(ue,()=>v().remittanceNumber),o(Pe,()=>dt(v().status)),o(Ue,()=>new Date(v().date).toLocaleDateString("es-ES")),o(ve,()=>v().reference||"N/A"),o(q,()=>v().customer.fullName||v().customer.name),o(ge,()=>v().customer.cid||"N/A"),o(Fe,()=>v().customer.phoneNumber||"N/A"),o(Z,()=>v().customer.email||"N/A"),o(me,b(p,{get when(){return v().customer.address},get children(){var r=xr(),B=r.firstChild,T=B.nextSibling;return o(T,()=>v().customer.address),h(g=>{var c=m,w=x,Q=D;return g.e=e(r,c,g.e),g.t=e(B,w,g.t),g.a=e(T,Q,g.a),g},{e:void 0,t:void 0,a:void 0}),r}}),null),o(oe,()=>y(v().amount,"USD"),de),o(Ee,()=>v().currency),o(C,b(p,{get when(){return Ge(()=>!!v().exchangeRate)()&&v().currency!=="USD"},get children(){return[(()=>{var r=$r(),B=r.firstChild,T=B.nextSibling;return o(T,()=>v().exchangeRate?.toFixed(4)),h(g=>{var c=m,w=x,Q=D;return g.e=e(r,c,g.e),g.t=e(B,w,g.t),g.a=e(T,Q,g.a),g},{e:void 0,t:void 0,a:void 0}),r})(),(()=>{var r=Cr(),B=r.firstChild;B.firstChild;var T=B.nextSibling;return T.firstChild,o(B,()=>v().currency,null),o(T,()=>(v().amount*(v().exchangeRate||1)).toFixed(2),null),h(g=>{var c=m,w=x,Q=D;return g.e=e(r,c,g.e),g.t=e(B,w,g.t),g.a=e(T,Q,g.a),g},{e:void 0,t:void 0,a:void 0}),r})()]}}),null),o($,b(p,{get when(){return v().notes},get children(){var r=wr(),B=r.firstChild,T=B.nextSibling;return o(T,()=>v().notes),h(g=>{var c=P,w=te,Q=D;return g.e=e(r,c,g.e),g.t=e(B,w,g.t),g.a=e(T,Q,g.a),g},{e:void 0,t:void 0,a:void 0}),r}}),Ne),o(ze,()=>new Date(v().createdAt).toLocaleString("es-ES")),o(We,()=>new Date(v().updatedAt).toLocaleString("es-ES")),o(he,b(p,{get when(){return v().createdBy},get children(){var r=pr(),B=r.firstChild,T=B.nextSibling;return o(T,()=>v().createdBy),h(g=>{var c=m,w=x,Q=D;return g.e=e(r,c,g.e),g.t=e(B,w,g.t),g.a=e(T,Q,g.a),g},{e:void 0,t:void 0,a:void 0}),r}}),null),h(r=>{var B=P,T=te,g=re,c=m,w=x,Q=be,Qe=m,Je=x,Xe=Te(v().status),Ze=m,et=x,vt=D,mt=m,gt=x,ht=D,bt=P,ft=te,St=re,yt=m,xt=x,$t=be,Ct=m,wt=x,pt=D,_t=m,Ft=x,Et=D,Rt=m,Dt=x,kt=D,Nt=P,zt=te,It=re,At=m,Pt=x,Ut=be,Bt=m,Tt=x,Lt=D,Mt=P,qt=te,Wt=re,Ot=m,Vt=x,jt=D,Gt=m,Ht=x,Kt=D;return r.e=e(M,B,r.e),r.t=e(X,T,r.t),r.a=e(K,g,r.a),r.o=e(A,c,r.o),r.i=e(pe,w,r.i),r.n=e(ue,Q,r.n),r.s=e(xe,Qe,r.s),r.h=e(Le,Je,r.h),r.r=e(Pe,Xe,r.r),r.d=e(_e,Ze,r.d),r.l=e(Me,et,r.l),r.u=e(Ue,vt,r.u),r.c=e(F,mt,r.c),r.w=e(Y,gt,r.w),r.m=e(ve,ht,r.m),r.f=e(me,bt,r.f),r.y=e(fe,ft,r.y),r.g=e($e,St,r.g),r.p=e(a,yt,r.p),r.b=e(E,xt,r.b),r.T=e(q,$t,r.T),r.A=e(N,Ct,r.A),r.O=e(le,wt,r.O),r.I=e(ge,pt,r.I),r.S=e(Se,_t,r.S),r.W=e(ae,Ft,r.W),r.C=e(Fe,Et,r.C),r.B=e(R,Rt,r.B),r.v=e(se,Dt,r.v),r.k=e(Z,kt,r.k),r.x=e(ce,Nt,r.x),r.j=e(d,zt,r.j),r.q=e(C,It,r.q),r.z=e(O,At,r.z),r.P=e(ne,Pt,r.P),r.H=e(oe,Ut,r.H),r.F=e(V,Bt,r.F),r.M=e(ke,Tt,r.M),r.D=e(Ee,Lt,r.D),r.R=e(Ne,Mt,r.R),r.E=e(u,qt,r.E),r.L=e(he,Wt,r.L),r.N=e(ye,Ot,r.N),r.G=e(Be,Vt,r.G),r.U=e(ze,jt,r.U),r.K=e(qe,Gt,r.K),r.V=e(Ie,Ht,r.V),r.Y=e(We,Kt,r.Y),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0,H:void 0,F:void 0,M:void 0,D:void 0,R:void 0,E:void 0,L:void 0,N:void 0,G:void 0,U:void 0,K:void 0,V:void 0,Y:void 0}),$})(),(()=>{var $=Fr(),M=$.firstChild,X=M.nextSibling,K=X.nextSibling;return e($,U),M.$$click=s,X.$$click=()=>n.onEdit(v()),tt(K,"click",n.onClose,!0),h(A=>{var pe=k,ue=W,xe=k;return A.e=e(M,pe,A.e),A.t=e(X,ue,A.t),A.a=e(K,xe,A.a),A},{e:void 0,t:void 0,a:void 0}),$})()]})}}),null),h(v=>e(L,i,v)),L})()};Ye(["click"]);var Rr=f("<div><label>Tasa de Cambio (a USD)</label><input type=number step=0.0001 min=0 placeholder=1.0000>"),Dr=f("<div><span>Equivalente:</span><span>$<!> "),kr=f("<div><span>Cédula:</span><span>"),Nr=f("<div><span>Teléfono:</span><span>"),zr=f("<div><h3>Resumen</h3><div><span>Cliente:</span><span></span></div><div><span>Cantidad:</span><span> USD"),Ir=f("<button type=button>Vista Previa"),Ar=f('<div><h2></h2><form><div></div><div><label>Moneda</label><select required></select></div><div><label>Cantidad USD</label><input type=number step=0.01 min=0 placeholder=0.00 required></div><div><label>Referencia (Opcional)</label><input type=text placeholder="Número de referencia o descripción"></div><div><label>Notas (Opcional)</label><textarea placeholder="Notas adicionales sobre esta remesa"></textarea></div><div><button type=button>Cancelar</button><button type=submit>'),Pr=f("<option> <!> - ");const ot=n=>{const[l,S]=ee(null),[t,s]=ee(0),[y,i]=ee("CUP"),[z,I]=ee(395),[G,H]=ee(""),[J,P]=ee(""),[te,re]=ee(!1),m=()=>!!n.remittance;Qt(()=>{const $=n.remittance;$?(S($.customer),s($.amount),i($.currency),I($.exchangeRate||1),H($.reference||""),P($.notes||"")):(S(null),s(0),i("CUP"),I(395),H(""),P(""))});const x=async $=>{if($.preventDefault(),!l()){alert("Por favor seleccione un cliente");return}if(t()<=0){alert("Por favor ingrese una cantidad válida");return}re(!0);try{if(m()){const M={id:n.remittance.id,customer:l(),amount:t(),currency:y(),exchangeRate:z(),reference:G(),notes:J()};await Ve.update(M),alert("Remesa actualizada exitosamente")}else{const M={customer:l(),amount:t(),currency:y(),exchangeRate:z(),reference:G(),notes:J()},X=await Ve.create(M),K={...X,date:new Date,remittanceNumber:X.remittanceNumber};br(K),alert("¡Remesa creada exitosamente! Se ha descargado el recibo PDF.")}n.onSubmit?.(m()),m()||(S(null),s(0),i("USD"),I(1),H(""),P(""))}catch(M){console.error("Error submitting remittance:",M);const X=m()?"Error al actualizar la remesa. Por favor intente de nuevo.":"Error al crear la remesa. Por favor intente de nuevo.";alert(X)}finally{re(!1)}},D=()=>{if(!l()||t()<=0){alert("Por favor complete cliente y cantidad para ver la vista previa");return}const $={customer:l(),amount:t(),currency:y(),exchangeRate:z(),reference:G(),notes:J(),date:new Date,remittanceNumber:m()?n.remittance.remittanceNumber:at()};ut($)},be=()=>{m()||(S(null),s(0),i("CUP"),I(395),H(""),P("")),n.onCancel?.()},Te=n.isModal?{"max-width":"600px",margin:"0 auto",padding:"0"}:{"max-width":"600px",margin:"0 auto",padding:"2rem","background-color":"white","border-radius":"8px","box-shadow":"0 4px 12px rgba(0,0,0,0.15)"},U={"font-size":"1.5rem","font-weight":"600","margin-bottom":"1.5rem","text-align":"center",color:"var(--text-primary)"},_={"margin-bottom":"1.5rem"},W={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.5rem"},k={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"4px","font-size":"1rem",background:"var(--surface-color)",color:"var(--text-primary)"},Re={...k,cursor:"pointer"},De={...k,"min-height":"80px",resize:"vertical"},L={padding:"0.75rem 1.5rem","background-color":"var(--primary-color)",color:"white",border:"none","border-radius":"4px",cursor:"pointer","font-weight":"500","margin-right":"0.5rem"},ie={...L,"background-color":"var(--border-color)",color:"var(--text-secondary)"},Ce={...L,"background-color":"var(--secondary-color, #6b7280)",color:"white"},Ae={display:"flex","justify-content":"flex-end","margin-top":"2rem"},we={"background-color":"var(--strip-color)",padding:"1rem","border-radius":"4px","margin-bottom":"1.5rem"},v={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"};return(()=>{var $=Ar(),M=$.firstChild,X=M.nextSibling,K=X.firstChild,A=K.nextSibling,pe=A.firstChild,ue=pe.nextSibling,xe=A.nextSibling,Le=xe.firstChild,Pe=Le.nextSibling,_e=xe.nextSibling,Me=_e.firstChild,Ue=Me.nextSibling,F=_e.nextSibling,Y=F.firstChild,ve=Y.nextSibling,me=F.nextSibling,fe=me.firstChild,$e=fe.nextSibling;return o(M,()=>m()?"Editar Remesa":"Crear Remesa"),X.addEventListener("submit",x),o(K,b(Jt,{get value(){return l()},onChange:S,label:"Seleccionar Cliente",placeholder:"Buscar clientes por nombre, teléfono, cédula...",required:!0})),ue.addEventListener("change",a=>i(a.target.value)),o(ue,b(je,{each:He,children:a=>(()=>{var E=Pr(),q=E.firstChild,N=q.nextSibling;return N.nextSibling,o(E,()=>a.symbol,q),o(E,()=>a.code,N),o(E,()=>a.name,null),h(()=>E.value=a.code),E})()})),Pe.$$input=a=>s(parseFloat(a.target.value)||0),o(X,b(p,{get when(){return y()!=="USD"},get children(){var a=Rr(),E=a.firstChild,q=E.nextSibling;return q.$$input=N=>I(parseFloat(N.target.value)||1),h(N=>{var le=_,ge=W,Se=k;return N.e=e(a,le,N.e),N.t=e(E,ge,N.t),N.a=e(q,Se,N.a),N},{e:void 0,t:void 0,a:void 0}),h(()=>q.value=z()),a}}),_e),Ue.$$input=a=>H(a.target.value),ve.$$input=a=>P(a.target.value),o(X,b(p,{get when(){return Ge(()=>!!l())()&&t()>0},get children(){var a=zr(),E=a.firstChild,q=E.nextSibling,N=q.firstChild,le=N.nextSibling,ge=q.nextSibling,Se=ge.firstChild,ae=Se.nextSibling,Fe=ae.firstChild;return e(a,we),E.style.setProperty("margin-bottom","0.75rem"),E.style.setProperty("font-weight","600"),o(le,()=>l()?.fullName||l()?.name),o(ae,()=>He.find(R=>R.code===y())?.symbol,Fe),o(ae,()=>t().toFixed(2),Fe),o(a,b(p,{get when(){return Ge(()=>y()!=="USD")()&&z()!==1},get children(){var R=Dr(),se=R.firstChild,Z=se.nextSibling,ce=Z.firstChild,d=ce.nextSibling;return d.nextSibling,o(Z,()=>(t()*z()).toFixed(2),d),o(Z,y,null),h(C=>e(R,v,C)),R}}),null),o(a,b(p,{get when(){return l()?.cid},get children(){var R=kr(),se=R.firstChild,Z=se.nextSibling;return o(Z,()=>l()?.cid),h(ce=>e(R,v,ce)),R}}),null),o(a,b(p,{get when(){return l()?.phoneNumber},get children(){var R=Nr(),se=R.firstChild,Z=se.nextSibling;return o(Z,()=>l()?.phoneNumber),h(ce=>e(R,v,ce)),R}}),null),h(R=>{var se=v,Z=v;return R.e=e(q,se,R.e),R.t=e(ge,Z,R.t),R},{e:void 0,t:void 0}),a}}),me),e(me,Ae),fe.$$click=be,o(me,b(p,{get when(){return!m()},get children(){var a=Ir();return a.$$click=D,h(E=>{var q=Ce,N=te()||!l()||t()<=0;return E.e=e(a,q,E.e),N!==E.t&&(a.disabled=E.t=N),E},{e:void 0,t:void 0}),a}}),$e),o($e,(()=>{var a=Ge(()=>!!te());return()=>a()?m()?"Actualizando...":"Creando...":m()?"Actualizar Remesa":"Crear Remesa"})()),h(a=>{var E=Te,q=U,N=_,le=_,ge=W,Se=Re,ae=_,Fe=W,R=k,se=_,Z=W,ce=k,d=_,C=W,O=De,ne=ie,oe=te(),de=L,V=te()||!l()||t()<=0;return a.e=e($,E,a.e),a.t=e(M,q,a.t),a.a=e(K,N,a.a),a.o=e(A,le,a.o),a.i=e(pe,ge,a.i),a.n=e(ue,Se,a.n),a.s=e(xe,ae,a.s),a.h=e(Le,Fe,a.h),a.r=e(Pe,R,a.r),a.d=e(_e,se,a.d),a.l=e(Me,Z,a.l),a.u=e(Ue,ce,a.u),a.c=e(F,d,a.c),a.w=e(Y,C,a.w),a.m=e(ve,O,a.m),a.f=e(fe,ne,a.f),oe!==a.y&&(fe.disabled=a.y=oe),a.g=e($e,de,a.g),V!==a.p&&($e.disabled=a.p=V),a},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0}),h(()=>ue.value=y()),h(()=>Pe.value=t()),h(()=>Ue.value=G()),h(()=>ve.value=J()),$})()};Ye(["input","click"]);var Ur=f("<div><span>Remesas"),lt=f("<div><div>"),Br=f("<div>");const Tr=()=>{const[n,l]=ee("list"),[S,t]=ee(null),[s,y]=ee(0),i=()=>{l("list"),t(null),y(U=>U+1)},z=()=>{l("create"),t(null)},I=U=>{t(U),l("edit")},G=U=>{t(U),l("view")},H=()=>{i()},J=()=>{i()},P=()=>{i()},te=U=>{},re=U=>{I(U)},m={"min-height":"100vh","background-color":"var(--background-color)"},x={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},D={"background-color":"white","border-radius":"8px","max-width":"800px",width:"90%","max-height":"90%",overflow:"auto","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1)",padding:"2rem"},be={padding:"1rem 2rem","background-color":"white","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem",color:"var(--text-muted)"},Te={color:"var(--primary-color)","text-decoration":"none",cursor:"pointer"};return(()=>{var U=Br();return e(U,m),o(U,b(p,{get when(){return n()!=="list"},get children(){var _=Ur(),W=_.firstChild;return e(_,be),W.$$click=i,e(W,Te),o(_,b(p,{get when(){return n()==="create"},children:" > Nueva Remesa"}),null),o(_,b(p,{get when(){return n()==="edit"},get children(){return" > Editar > "+(S()?.remittanceNumber||"")}}),null),o(_,b(p,{get when(){return n()==="view"},get children(){return" > Ver > "+(S()?.remittanceNumber||"")}}),null),_}}),null),o(U,b(p,{get when(){return n()==="list"},get children(){return b(hr,{get key(){return s()},onCreate:z,onEdit:I,onView:G,onDelete:te})}}),null),o(U,b(p,{get when(){return n()==="create"},get children(){var _=lt(),W=_.firstChild;return _.$$click=P,W.$$click=k=>k.stopPropagation(),o(W,b(ot,{remittance:null,onSubmit:H,onCancel:P,isModal:!0})),h(k=>{var Re=x,De=D;return k.e=e(_,Re,k.e),k.t=e(W,De,k.t),k},{e:void 0,t:void 0}),_}}),null),o(U,b(p,{get when(){return n()==="edit"},get children(){var _=lt(),W=_.firstChild;return _.$$click=P,W.$$click=k=>k.stopPropagation(),o(W,b(ot,{get remittance(){return S()},onSubmit:J,onCancel:P,isModal:!0})),h(k=>{var Re=x,De=D;return k.e=e(_,Re,k.e),k.t=e(W,De,k.t),k},{e:void 0,t:void 0}),_}}),null),o(U,b(p,{get when(){return Ge(()=>n()==="view")()&&S()},get children(){return b(Er,{get remittanceId(){return S().id},onEdit:re,onClose:P})}}),null),U})()};Ye(["click"]);const Mr=()=>b(Tr,{});export{Mr as default};
