import{c as _,D as $t,e as re,t as g,j as a,i as e,a as n,B as T,b as C,S as h,y as Tt,v as I,F as pe,w as Ne,W as Bt,d as Ct,u as At,a2 as mt,M as Lt,k as vt}from"./index-CkaLb4-V.js";import{g as Ft,a as It,b as ft,i as Mt,f as ht,c as Ut,d as jt,s as Vt,e as Xt,h as Yt,j as Ot,k as Ht,l as qt,m as Gt}from"./taxPortalApi-DF7xImza.js";import{a as Qt,A as dt,V as bt}from"./drakeTypes-DcjcYEfx.js";var ct=g("<div>"),Wt=g("<div><h4>Nueva Solicitud de Documentos</h4><div><div></div></div><div><label>Verificacion de Informacion (Formularios)</label><div></div></div><div><label>Documentos a Subir (Archivos)</label><div></div></div><div>"),Kt=g("<div><p>Cargando solicitudes..."),Zt=g("<div><p>No hay solicitudes de documentos</p><p>Cree una nueva solicitud para que el cliente suba sus documentos fiscales."),Jt=g("<div><div><h3>Solicitudes de Documentos"),er=g('<div><input type=checkbox><span><svg viewBox="0 0 20 20"fill=#8b5cf6><path fill-rule=evenodd d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z"clip-rule=evenodd>'),tr=g('<div><input type=checkbox><span><svg viewBox="0 0 20 20"fill=#3b82f6><path fill-rule=evenodd d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z"clip-rule=evenodd>'),xt=g('<svg width=16 height=16 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><polyline points="20 6 9 17 4 12">'),rr=g('<div><img alt="QR Code">'),lr=g('<svg width=16 height=16 viewBox="0 0 24 24"fill=currentColor><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z">'),ir=g("<div>Ultimo acceso: "),nr=g("<div><strong>Instrucciones:</strong> "),sr=g('<div><div><div><div>Enlace Magico</div><div><div></div><button title="Copiar enlace"></button></div></div><div><div>Codigo PIN</div><div><div></div><button title="Copiar PIN"></button></div><div>Usar en: </div></div><div><div>Codigo QR</div></div></div><div><div>Documentos Solicitados</div><div></div></div><div></div><div><div>Creado: </div><div>Por: '),or=g('<div><div><div><span></span><span>Ano </span><div><div></div></div><span>%</span></div><div><span></span><svg width=16 height=16 viewBox="0 0 16 16"><path d="M4 6L8 10L12 6"stroke=currentColor stroke-width=1.5 stroke-linecap=round stroke-linejoin=round fill=none>'),Pt=g('<svg width=16 height=16 viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2><rect x=9 y=9 width=13 height=13 rx=2 ry=2></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1">'),ar=g("<span> ");const dr=R=>{const[G,B]=_([]),[le,P]=_(!1),[ie,M]=_(null),[ge,A]=_(null),[ne,me]=_(!1),[Q,se]=_(2024),[L,b]=_(Qt.filter(l=>l.required).map(l=>l.type)),[N,ve]=_(""),[Re,Te]=_(!1),[fe,qe]=_(null),[oe,Be]=_(null);$t(()=>{re(R.taxPortal),R.taxPortal?.id&&ae()});const ae=async()=>{P(!0),M(null);try{const l=await Ft(R.taxPortal.id);B(l)}catch(l){M("Error al cargar las solicitudes"),re("Error loading requests:",l)}finally{P(!1)}},Ge=async()=>{Te(!0),M(null);try{const l=dt.filter(d=>L().includes(d.type)).map(d=>({...d,required:!0,uploaded:!1})),r=await jt(R.taxPortal,{taxYear:Q(),requestedDocuments:l,instructions:N()||void 0});B(d=>[r,...d]),me(!1),ve(""),A("Solicitud creada exitosamente"),setTimeout(()=>A(null),3e3),R.onRequestCreated?.(r)}catch(l){M("Error al crear la solicitud"),re("Error creating request:",l)}finally{Te(!1)}},Ae=async l=>{if(confirm("Esta seguro de cancelar esta solicitud?"))try{await Xt(l),B(r=>r.map(d=>d.id===l?{...d,status:"cancelled"}:d)),A("Solicitud cancelada"),setTimeout(()=>A(null),3e3)}catch{M("Error al cancelar la solicitud")}},Qe=async l=>{if(confirm("Esta seguro de eliminar esta solicitud? Esta accion no se puede deshacer."))try{await Yt(l),B(r=>r.filter(d=>d.id!==l)),A("Solicitud eliminada"),setTimeout(()=>A(null),3e3)}catch{M("Error al eliminar la solicitud")}},We=async l=>{try{await Vt(l),B(r=>r.map(d=>d.id===l?{...d,remindersSent:(d.remindersSent||0)+1}:d)),A("Recordatorio enviado"),setTimeout(()=>A(null),3e3)}catch{M("Error al enviar el recordatorio")}},Le=async(l,r)=>{try{await navigator.clipboard.writeText(l),Be(r),setTimeout(()=>Be(null),2e3)}catch(d){re("Error copying to clipboard:",d)}},Ke=l=>{const r=l.clientPhone?.replace(/\D/g,"")||"",d=ft(l.accessToken),i=encodeURIComponent(`Hola ${l.clientName}, necesitamos que suba sus documentos fiscales para el ano ${l.taxYear}.

Puede acceder usando este enlace: ${d}

O ingrese con el PIN: ${l.accessPin}

La solicitud expira en: ${ht(l.expiresAt)}`),t=r?`https://wa.me/${r}?text=${i}`:`https://wa.me/?text=${i}`;window.open(t,"_blank")},y=l=>{const r={pending:{label:"Pendiente",color:"#F59E0B",bg:"rgba(245, 158, 11, 0.15)"},partial:{label:"Parcial",color:"#3B82F6",bg:"rgba(59, 130, 246, 0.15)"},complete:{label:"Completo",color:"#10B981",bg:"rgba(16, 185, 129, 0.15)"},expired:{label:"Expirado",color:"#EF4444",bg:"rgba(239, 68, 68, 0.15)"},cancelled:{label:"Cancelado",color:"#6B7280",bg:"rgba(107, 114, 128, 0.15)"}};return r[l]||r.pending},v=l=>{b(r=>r.includes(l)?r.filter(d=>d!==l):[...r,l])},Fe={display:"flex","flex-direction":"column",gap:"1rem"},de={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},Ie={"font-size":"1.125rem","font-weight":"600",color:"var(--text-primary, #1f2937)",margin:"0"},W=l=>({padding:"0.75rem 1rem","border-radius":"6px","font-size":"0.875rem",background:l==="success"?"rgba(16, 185, 129, 0.1)":"rgba(239, 68, 68, 0.1)",color:l==="success"?"#10B981":"#EF4444",border:`1px solid ${l==="success"?"#10B981":"#EF4444"}`,"margin-bottom":"1rem"}),he={padding:"1rem",background:"var(--surface-alt, #f9fafb)","border-radius":"8px",border:"1px solid var(--border-color, #e5e7eb)","margin-bottom":"1rem"},be={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-bottom":"1rem"},X={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.5rem","margin-bottom":"1rem"},xe=l=>({display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:l?"rgba(59, 130, 246, 0.1)":"var(--surface-color, #ffffff)",border:`1px solid ${l?"#3B82F6":"var(--border-color, #e5e7eb)"}`,"border-radius":"6px",cursor:"pointer","font-size":"0.875rem",transition:"all 0.2s ease"}),Pe=l=>({background:"var(--surface-color, #ffffff)",border:"1px solid var(--border-color, #e5e7eb)","border-radius":"8px",overflow:"hidden",transition:"box-shadow 0.2s ease","box-shadow":l?"var(--shadow-md, 0 4px 6px rgba(0, 0, 0, 0.1))":"none"}),K={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",cursor:"pointer","user-select":"none"},Me={display:"flex","align-items":"center",gap:"1rem"},$e=l=>({display:"inline-flex","align-items":"center",padding:"0.25rem 0.625rem","border-radius":"9999px",background:l.bg,color:l.color,"font-size":"0.75rem","font-weight":"600"}),Z={width:"100px",height:"6px",background:"var(--border-color, #e5e7eb)","border-radius":"3px",overflow:"hidden"},Ue=l=>({width:`${l}%`,height:"100%",background:l===100?"#10B981":"#3B82F6",transition:"width 0.3s ease"}),je={padding:"1rem","border-top":"1px solid var(--border-color, #e5e7eb)",background:"var(--surface-alt, #f9fafb)"},J={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"1rem"},ce={padding:"1rem",background:"var(--surface-color, #ffffff)","border-radius":"8px",border:"1px solid var(--border-color, #e5e7eb)"},ee={"font-size":"0.75rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.05em",color:"var(--text-secondary, #6B7280)","margin-bottom":"0.5rem"},Y={display:"flex","align-items":"center",gap:"0.5rem"},Ve={flex:"1",padding:"0.5rem",background:"var(--surface-alt, #f9fafb)","border-radius":"4px","font-family":"monospace","font-size":"0.875rem",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},Ce=l=>({padding:"0.5rem",background:l?"#10B981":"var(--primary-color, #3B82F6)",color:"#ffffff",border:"none","border-radius":"4px",cursor:"pointer",display:"flex","align-items":"center","justify-content":"center",transition:"background 0.2s ease"}),ye={display:"flex","justify-content":"center","align-items":"center",padding:"1rem",background:"#ffffff","border-radius":"8px"},Ze={display:"flex",gap:"0.5rem","flex-wrap":"wrap","margin-top":"1rem"},_e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)","font-size":"0.875rem"},s={"text-align":"center",padding:"2rem",color:"var(--text-secondary, #6B7280)"},c=[{value:"2023",label:"2023"},{value:"2024",label:"2024"},{value:"2025",label:"2025"},{value:"2026",label:"2026"}];return(()=>{var l=Jt(),r=l.firstChild,d=r.firstChild;return a(r,de),a(d,Ie),e(r,n(T,{get variant(){return ne()?"secondary":"primary"},size:"sm",onClick:()=>me(!ne()),get children(){return ne()?"Cancelar":"+ Nueva Solicitud"}}),null),e(l,n(h,{get when(){return ie()},get children(){var i=ct();return e(i,ie),C(t=>a(i,W("error"),t)),i}}),null),e(l,n(h,{get when(){return ge()},get children(){var i=ct();return e(i,ge),C(t=>a(i,W("success"),t)),i}}),null),e(l,n(h,{get when(){return ne()},get children(){var i=Wt(),t=i.firstChild,p=t.nextSibling,w=p.firstChild,m=p.nextSibling,f=m.firstChild,x=f.nextSibling,D=m.nextSibling,U=D.firstChild,O=U.nextSibling,F=D.nextSibling;return a(i,he),t.style.setProperty("margin","0 0 1rem 0"),t.style.setProperty("font-size","1rem"),a(p,be),e(p,n(Tt,{label:"Ano Fiscal",get value(){return Q().toString()},onChange:u=>se(parseInt(u)),options:c,required:!0}),w),e(w,n(I,{label:"Instrucciones (opcional)",get value(){return N()},onChange:ve,placeholder:"Instrucciones adicionales para el cliente..."})),e(x,n(pe,{get each(){return dt.filter(u=>bt.includes(u.type))},children:u=>(()=>{var k=er(),z=k.firstChild,S=z.nextSibling,j=S.firstChild;return k.$$click=()=>v(u.type),z.addEventListener("change",()=>v(u.type)),S.style.setProperty("display","flex"),S.style.setProperty("align-items","center"),S.style.setProperty("gap","0.375rem"),j.style.setProperty("width","14px"),j.style.setProperty("height","14px"),e(S,()=>u.label,null),C(H=>a(k,{...xe(L().includes(u.type)),background:L().includes(u.type)?"rgba(139, 92, 246, 0.1)":"var(--surface-alt, #f9fafb)",border:L().includes(u.type)?"2px solid #8b5cf6":"1px solid var(--border-color, #e5e7eb)"},H)),C(()=>z.checked=L().includes(u.type)),k})()})),e(O,n(pe,{get each(){return dt.filter(u=>!bt.includes(u.type))},children:u=>(()=>{var k=tr(),z=k.firstChild,S=z.nextSibling,j=S.firstChild;return k.$$click=()=>v(u.type),z.addEventListener("change",()=>v(u.type)),S.style.setProperty("display","flex"),S.style.setProperty("align-items","center"),S.style.setProperty("gap","0.375rem"),j.style.setProperty("width","14px"),j.style.setProperty("height","14px"),e(S,()=>u.label,null),C(H=>a(k,xe(L().includes(u.type)),H)),C(()=>z.checked=L().includes(u.type)),k})()})),F.style.setProperty("display","flex"),F.style.setProperty("gap","0.5rem"),F.style.setProperty("justify-content","flex-end"),e(F,n(T,{variant:"secondary",size:"sm",onClick:()=>me(!1),children:"Cancelar"}),null),e(F,n(T,{variant:"primary",size:"sm",onClick:Ge,get disabled(){return Re()||L().length===0},get children(){return Re()?"Creando...":"Crear Solicitud"}}),null),C(u=>{var k=_e,z=X,S=_e,j=X;return u.e=a(f,k,u.e),u.t=a(x,z,u.t),u.a=a(U,S,u.a),u.o=a(O,j,u.o),u},{e:void 0,t:void 0,a:void 0,o:void 0}),i}}),null),e(l,n(h,{get when(){return le()},get children(){var i=Kt();return C(t=>a(i,s,t)),i}}),null),e(l,n(h,{get when(){return Ne(()=>!le())()&&G().length===0},get children(){var i=Zt(),t=i.firstChild,p=t.nextSibling;return p.style.setProperty("font-size","0.875rem"),p.style.setProperty("margin-top","0.5rem"),C(w=>a(i,s,w)),i}}),null),e(l,n(h,{get when(){return Ne(()=>!le())()&&G().length>0},get children(){var i=ct();return i.style.setProperty("display","flex"),i.style.setProperty("flex-direction","column"),i.style.setProperty("gap","0.75rem"),e(i,n(pe,{get each(){return G()},children:t=>{const p=()=>fe()===t.id,w=y(t.status),m=It(t),f=ft(t.accessToken),x=Mt(t);return(()=>{var D=or(),U=D.firstChild,O=U.firstChild,F=O.firstChild,u=F.nextSibling;u.firstChild;var k=u.nextSibling,z=k.firstChild,S=k.nextSibling,j=S.firstChild,H=O.nextSibling,Xe=H.firstChild,Je=Xe.nextSibling;return U.$$click=()=>qe(p()?null:t.id),a(O,Me),e(F,()=>w.label),u.style.setProperty("font-weight","500"),e(u,()=>t.taxYear,null),a(k,Z),S.style.setProperty("font-size","0.75rem"),S.style.setProperty("color","var(--text-secondary)"),e(S,m,j),H.style.setProperty("display","flex"),H.style.setProperty("align-items","center"),H.style.setProperty("gap","0.75rem"),Xe.style.setProperty("font-size","0.75rem"),Xe.style.setProperty("color","var(--text-secondary)"),e(Xe,()=>ht(t.expiresAt)),Je.style.setProperty("transition","transform 0.2s ease"),e(D,n(h,{get when(){return p()},get children(){var E=sr(),Se=E.firstChild,we=Se.firstChild,Ye=we.firstChild,Oe=Ye.nextSibling,te=Oe.firstChild,et=te.nextSibling,tt=we.nextSibling,ut=tt.firstChild,rt=ut.nextSibling,lt=rt.firstChild,it=lt.nextSibling,ke=rt.nextSibling;ke.firstChild;var nt=tt.nextSibling,_t=nt.firstChild,st=Se.nextSibling,pt=st.firstChild,He=pt.nextSibling,ue=st.nextSibling,q=ue.nextSibling,ot=q.firstChild;ot.firstChild;var gt=ot.nextSibling;return gt.firstChild,a(E,je),a(Se,J),e(te,f),et.$$click=()=>Le(f,`link-${t.id}`),e(et,n(h,{get when(){return oe()===`link-${t.id}`},get fallback(){return Pt()},get children(){return xt()}})),e(lt,()=>t.accessPin),it.$$click=()=>Le(t.accessPin,`pin-${t.id}`),e(it,n(h,{get when(){return oe()===`pin-${t.id}`},get fallback(){return Pt()},get children(){return xt()}})),ke.style.setProperty("font-size","0.75rem"),ke.style.setProperty("color","var(--text-secondary)"),ke.style.setProperty("margin-top","0.5rem"),e(ke,Ut,null),e(nt,n(h,{get when(){return t.qrCodeUrl},get children(){var o=rr(),$=o.firstChild;return a(o,ye),$.style.setProperty("width","150px"),$.style.setProperty("height","150px"),C(()=>Bt($,"src",t.qrCodeUrl)),o}}),null),st.style.setProperty("margin-bottom","1rem"),He.style.setProperty("display","flex"),He.style.setProperty("flex-wrap","wrap"),He.style.setProperty("gap","0.5rem"),e(He,n(pe,{get each(){return t.requestedDocuments},children:o=>(()=>{var $=ar(),at=$.firstChild;return $.style.setProperty("padding","0.25rem 0.5rem"),$.style.setProperty("border-radius","4px"),$.style.setProperty("font-size","0.75rem"),e($,()=>o.uploaded?"OK":o.required?"*":"",at),e($,()=>o.label,null),C(V=>{var ze=o.uploaded?"rgba(16, 185, 129, 0.1)":o.required?"rgba(239, 68, 68, 0.1)":"rgba(107, 114, 128, 0.1)",Ee=o.uploaded?"#10B981":o.required?"#EF4444":"#6B7280",De=`1px solid ${o.uploaded?"#10B981":o.required?"#EF4444":"#6B7280"}`;return ze!==V.e&&((V.e=ze)!=null?$.style.setProperty("background",ze):$.style.removeProperty("background")),Ee!==V.t&&((V.t=Ee)!=null?$.style.setProperty("color",Ee):$.style.removeProperty("color")),De!==V.a&&((V.a=De)!=null?$.style.setProperty("border",De):$.style.removeProperty("border")),V},{e:void 0,t:void 0,a:void 0}),$})()})),e(ue,n(T,{variant:"primary",size:"sm",onClick:()=>Ke(t),get children(){return[lr(),"WhatsApp"]}}),null),e(ue,n(h,{get when(){return t.status!=="complete"&&t.status!=="cancelled"&&!x},get children(){return n(T,{variant:"secondary",size:"sm",onClick:()=>We(t.id),get children(){return["Enviar Recordatorio",Ne(()=>t.remindersSent?` (${t.remindersSent})`:"")]}})}}),null),e(ue,n(h,{get when(){return t.status==="pending"||t.status==="partial"},get children(){return n(T,{variant:"outline",size:"sm",onClick:()=>Ae(t.id),children:"Cancelar"})}}),null),e(ue,n(h,{get when(){return t.status==="cancelled"||t.status==="expired"},get children(){return n(T,{variant:"danger",size:"sm",onClick:()=>Qe(t.id),children:"Eliminar"})}}),null),q.style.setProperty("margin-top","1rem"),q.style.setProperty("padding-top","1rem"),q.style.setProperty("border-top","1px solid var(--border-color)"),q.style.setProperty("font-size","0.75rem"),q.style.setProperty("color","var(--text-secondary)"),e(ot,()=>new Date(t.createdAt).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),null),e(gt,()=>t.requestedByName,null),e(q,n(h,{get when(){return t.lastAccessedAt},get children(){var o=ir();return o.firstChild,e(o,()=>new Date(t.lastAccessedAt).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),null),o}}),null),e(q,n(h,{get when(){return t.instructions},get children(){var o=nr(),$=o.firstChild;return $.nextSibling,o.style.setProperty("margin-top","0.5rem"),e(o,()=>t.instructions,null),o}}),null),C(o=>{var $=ce,at=ee,V=Y,ze=Ve,Ee=Ce(oe()===`link-${t.id}`),De=ce,St=ee,wt=Y,kt={...Ve,"font-size":"1.25rem","font-weight":"700","letter-spacing":"0.1em","text-align":"center"},zt=Ce(oe()===`pin-${t.id}`),Et=ce,Dt=ee,Nt=ee,Rt=Ze;return o.e=a(we,$,o.e),o.t=a(Ye,at,o.t),o.a=a(Oe,V,o.a),o.o=a(te,ze,o.o),o.i=a(et,Ee,o.i),o.n=a(tt,De,o.n),o.s=a(ut,St,o.s),o.h=a(rt,wt,o.h),o.r=a(lt,kt,o.r),o.d=a(it,zt,o.d),o.l=a(nt,Et,o.l),o.u=a(_t,Dt,o.u),o.c=a(pt,Nt,o.c),o.w=a(ue,Rt,o.w),o},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),E}}),null),C(E=>{var Se=Pe(p()),we=K,Ye=$e(w),Oe=Ue(m),te=p()?"rotate(180deg)":"rotate(0deg)";return E.e=a(D,Se,E.e),E.t=a(U,we,E.t),E.a=a(F,Ye,E.a),E.o=a(z,Oe,E.o),te!==E.i&&((E.i=te)!=null?Je.style.setProperty("transform",te):Je.style.removeProperty("transform")),E},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),D})()}})),i}}),null),C(i=>a(l,Fe,i)),l})()};Ct(["click"]);var cr=g("<div><div>Loading..."),yt=g("<div>"),yr=g("<div>No tax clients found"),ur=g("<div><h2> "),pr=g("<div><div><div>Email</div><div></div></div><div><div>Phone</div><div></div></div><div><div>SSN</div><div></div></div><div><div>Address</div><div>"),gr=g("<div><div>"),mr=g("<div>Select a client to manage document requests"),vr=g("<div><div><div>"),fr=g("<div>No document requests yet. Create one from a client's profile."),hr=g("<div><div><div><h1>Tax Portal</h1><p>Manage tax clients and document requests</p></div><div></div></div><div><div><div></div><div>Tax Clients</div></div><div><div></div><div>Pending Requests</div></div><div><div></div><div>Partial Uploads</div></div><div><div></div><div>Complete</div></div></div><div><button>Tax Clients (<!>)</button><button>Document Requests (<!>)"),br=g("<div> documents"),xr=g("<div><div><div><div> </div><div></div></div><button>x"),Pr=g("<div><div><div></div><div>Tax Year <!> - Created </div></div><div>"),$r=g("<div><div><span>Upload Progress</span><span> / <!> documents</span></div><div><div>");const wr=()=>{At();const[R,G]=_([]),[B,le]=_([]),[P,ie]=_(null),[M,ge]=_(!0),[A,ne]=_(""),[me,Q]=_(!1),[se,L]=_("portals"),[b,N]=_({firstName:"",lastName:"",email:"",phone:"",ssn:"",address:"",city:"",state:"",zipCode:""});$t(async()=>{ge(!0);try{const[y,v]=await Promise.all([Ot(),Ht()]);G(y),le(v)}catch(y){re("Error loading data:",y)}finally{ge(!1)}});const ve=()=>{const y=A().toLowerCase();return y?R().filter(v=>v.firstName.toLowerCase().includes(y)||v.lastName.toLowerCase().includes(y)||v.email?.toLowerCase().includes(y)||v.phone?.includes(y)):R()},Re=async()=>{try{const y=await qt(b());G([y,...R()]),Q(!1),N({firstName:"",lastName:"",email:"",phone:"",ssn:"",address:"",city:"",state:"",zipCode:""}),ie(y)}catch(y){re("Error creating portal:",y),alert("Error al crear el portal")}},Te=async y=>{if(confirm("Are you sure you want to delete this tax portal?"))try{await Gt(y),G(R().filter(v=>v.id!==y)),P()?.id===y&&ie(null)}catch(v){re("Error deleting portal:",v)}},fe=()=>{const y=B();return{pending:y.filter(v=>v.status==="pending").length,partial:y.filter(v=>v.status==="partial").length,complete:y.filter(v=>v.status==="complete").length,expired:y.filter(v=>v.status==="expired").length}},qe={padding:"1.5rem","max-width":"1400px",margin:"0 auto"},oe={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","flex-wrap":"wrap",gap:"1rem"},Be={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"1.5rem"},ae=y=>({background:"var(--surface-color)",border:"1px solid var(--border-color)","border-left":`4px solid ${y}`,"border-radius":"var(--border-radius-md)",padding:"1rem","text-align":"center"}),Ge={display:"flex",gap:"0.5rem","margin-bottom":"1.5rem","border-bottom":"1px solid var(--border-color)","padding-bottom":"0.5rem"},Ae=y=>({padding:"0.75rem 1.5rem",background:y?"var(--primary-color)":"transparent",color:y?"white":"var(--text-primary)",border:"none","border-radius":"var(--border-radius-md)",cursor:"pointer","font-weight":"500",transition:"all 0.2s"}),Qe={display:"grid","grid-template-columns":P()?"350px 1fr":"1fr",gap:"1.5rem"},We={display:"flex","flex-direction":"column",gap:"0.75rem","max-height":"70vh","overflow-y":"auto"},Le=y=>({background:y?"var(--primary-color)":"var(--surface-color)",color:y?"white":"var(--text-primary)",border:`1px solid ${y?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius-md)",padding:"1rem",cursor:"pointer",transition:"all 0.2s"}),Ke={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem"};return(()=>{var y=hr(),v=y.firstChild,Fe=v.firstChild,de=Fe.firstChild,Ie=de.nextSibling,W=Fe.nextSibling,he=v.nextSibling,be=he.firstChild,X=be.firstChild,xe=X.nextSibling,Pe=be.nextSibling,K=Pe.firstChild,Me=K.nextSibling,$e=Pe.nextSibling,Z=$e.firstChild,Ue=Z.nextSibling,je=$e.nextSibling,J=je.firstChild,ce=J.nextSibling,ee=he.nextSibling,Y=ee.firstChild,Ve=Y.firstChild,Ce=Ve.nextSibling;Ce.nextSibling;var ye=Y.nextSibling,Ze=ye.firstChild,_e=Ze.nextSibling;return _e.nextSibling,a(y,qe),a(v,oe),de.style.setProperty("font-size","1.75rem"),de.style.setProperty("font-weight","700"),de.style.setProperty("margin","0 0 0.25rem 0"),Ie.style.setProperty("color","var(--text-muted)"),Ie.style.setProperty("margin","0"),W.style.setProperty("display","flex"),W.style.setProperty("gap","0.75rem"),e(W,n(mt,{href:"/accounting/drake-export",style:{"text-decoration":"none"},get children(){return n(T,{variant:"secondary",children:"Drake Export"})}}),null),e(W,n(T,{onClick:()=>Q(!0),children:"+ New Client"}),null),a(he,Be),X.style.setProperty("font-size","2rem"),X.style.setProperty("font-weight","700"),X.style.setProperty("color","#3b82f6"),e(X,()=>R().length),xe.style.setProperty("font-size","0.875rem"),xe.style.setProperty("color","var(--text-muted)"),K.style.setProperty("font-size","2rem"),K.style.setProperty("font-weight","700"),K.style.setProperty("color","#f59e0b"),e(K,()=>fe().pending),Me.style.setProperty("font-size","0.875rem"),Me.style.setProperty("color","var(--text-muted)"),Z.style.setProperty("font-size","2rem"),Z.style.setProperty("font-weight","700"),Z.style.setProperty("color","#8b5cf6"),e(Z,()=>fe().partial),Ue.style.setProperty("font-size","0.875rem"),Ue.style.setProperty("color","var(--text-muted)"),J.style.setProperty("font-size","2rem"),J.style.setProperty("font-weight","700"),J.style.setProperty("color","#22c55e"),e(J,()=>fe().complete),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),a(ee,Ge),Y.$$click=()=>L("portals"),e(Y,()=>R().length,Ce),ye.$$click=()=>L("requests"),e(ye,()=>B().length,_e),e(y,n(h,{get when(){return M()},get children(){var s=cr(),c=s.firstChild;return s.style.setProperty("text-align","center"),s.style.setProperty("padding","3rem"),c.style.setProperty("font-size","1.5rem"),c.style.setProperty("color","var(--text-muted)"),s}}),null),e(y,n(Lt,{get isOpen(){return me()},onClose:()=>Q(!1),title:"New Tax Client",maxWidth:"600px",get children(){return[(()=>{var s=yt();return a(s,Ke),e(s,n(I,{label:"First Name *",get value(){return b().firstName},onChange:c=>N({...b(),firstName:c})}),null),e(s,n(I,{label:"Last Name *",get value(){return b().lastName},onChange:c=>N({...b(),lastName:c})}),null),e(s,n(I,{label:"Email",type:"email",get value(){return b().email},onChange:c=>N({...b(),email:c})}),null),e(s,n(I,{label:"Phone",get value(){return b().phone},onChange:c=>N({...b(),phone:c})}),null),e(s,n(I,{label:"SSN",placeholder:"XXX-XX-XXXX",get value(){return b().ssn},onChange:c=>N({...b(),ssn:c})}),null),e(s,n(I,{label:"Address",get value(){return b().address},onChange:c=>N({...b(),address:c})}),null),e(s,n(I,{label:"City",get value(){return b().city},onChange:c=>N({...b(),city:c})}),null),e(s,n(I,{label:"State",get value(){return b().state},onChange:c=>N({...b(),state:c})}),null),e(s,n(I,{label:"Zip Code",get value(){return b().zipCode},onChange:c=>N({...b(),zipCode:c})}),null),s})(),(()=>{var s=yt();return s.style.setProperty("display","flex"),s.style.setProperty("gap","1rem"),s.style.setProperty("justify-content","flex-end"),s.style.setProperty("margin-top","1.5rem"),e(s,n(T,{variant:"secondary",onClick:()=>Q(!1),children:"Cancel"}),null),e(s,n(T,{onClick:Re,get disabled(){return!b().firstName||!b().lastName},children:"Create Client"}),null),s})()]}}),null),e(y,n(h,{get when(){return!M()},get children(){return[n(h,{get when(){return se()==="portals"},get children(){var s=vr(),c=s.firstChild,l=c.firstChild;return e(c,n(I,{placeholder:"Search clients...",get value(){return A()},onChange:r=>ne(r),style:{"margin-bottom":"1rem"}}),l),a(l,We),e(l,n(h,{get when(){return ve().length===0},get children(){var r=yr();return r.style.setProperty("text-align","center"),r.style.setProperty("padding","2rem"),r.style.setProperty("color","var(--text-muted)"),r}}),null),e(l,n(pe,{get each(){return ve()},children:r=>(()=>{var d=xr(),i=d.firstChild,t=i.firstChild,p=t.firstChild,w=p.firstChild,m=p.nextSibling,f=t.nextSibling;return d.$$click=()=>ie(r),i.style.setProperty("display","flex"),i.style.setProperty("justify-content","space-between"),i.style.setProperty("align-items","flex-start"),p.style.setProperty("font-weight","600"),p.style.setProperty("margin-bottom","0.25rem"),e(p,()=>r.firstName,w),e(p,()=>r.lastName,null),m.style.setProperty("font-size","0.875rem"),m.style.setProperty("opacity","0.8"),e(m,()=>r.email||r.phone||"No contact info"),e(t,n(h,{get when(){return r.documentCount},get children(){var x=br(),D=x.firstChild;return x.style.setProperty("font-size","0.75rem"),x.style.setProperty("margin-top","0.5rem"),x.style.setProperty("opacity","0.7"),e(x,()=>r.documentCount,D),x}}),null),f.$$click=x=>{x.stopPropagation(),Te(r.id)},f.style.setProperty("background","none"),f.style.setProperty("border","none"),f.style.setProperty("cursor","pointer"),f.style.setProperty("opacity","0.6"),f.style.setProperty("font-size","1.25rem"),C(x=>a(d,Le(P()?.id===r.id),x)),d})()}),null),e(s,n(h,{get when(){return P()},get children(){var r=gr(),d=r.firstChild;return e(r,n(vt,{get children(){return[(()=>{var i=ur(),t=i.firstChild,p=t.firstChild;return i.style.setProperty("display","flex"),i.style.setProperty("justify-content","space-between"),i.style.setProperty("align-items","center"),i.style.setProperty("margin-bottom","1rem"),t.style.setProperty("margin","0"),e(t,()=>P().firstName,p),e(t,()=>P().lastName,null),e(i,n(mt,{get href(){return`/accounting/drake-export?client=${P().id}`},style:{"text-decoration":"none"},get children(){return n(T,{variant:"secondary",size:"sm",children:"Open in Drake Export"})}}),null),i})(),(()=>{var i=pr(),t=i.firstChild,p=t.firstChild,w=p.nextSibling,m=t.nextSibling,f=m.firstChild,x=f.nextSibling,D=m.nextSibling,U=D.firstChild,O=U.nextSibling,F=D.nextSibling,u=F.firstChild,k=u.nextSibling;return i.style.setProperty("display","grid"),i.style.setProperty("grid-template-columns","repeat(2, 1fr)"),i.style.setProperty("gap","1rem"),i.style.setProperty("margin-bottom","1.5rem"),p.style.setProperty("font-size","0.75rem"),p.style.setProperty("color","var(--text-muted)"),e(w,()=>P().email||"-"),f.style.setProperty("font-size","0.75rem"),f.style.setProperty("color","var(--text-muted)"),e(x,()=>P().phone||"-"),U.style.setProperty("font-size","0.75rem"),U.style.setProperty("color","var(--text-muted)"),e(O,(()=>{var z=Ne(()=>!!P().ssn);return()=>z()?`***-**-${P().ssn.slice(-4)}`:"-"})()),u.style.setProperty("font-size","0.75rem"),u.style.setProperty("color","var(--text-muted)"),e(k,(()=>{var z=Ne(()=>!!P().address);return()=>z()?`${P().address}, ${P().city}, ${P().state} ${P().zipCode}`:"-"})()),i})()]}}),d),d.style.setProperty("margin-top","1.5rem"),e(d,n(dr,{get taxPortal(){return P()},onRequestCreated:i=>le([i,...B()])})),r}}),null),e(s,n(h,{get when(){return!P()},get children(){var r=mr();return r.style.setProperty("display","flex"),r.style.setProperty("align-items","center"),r.style.setProperty("justify-content","center"),r.style.setProperty("background","var(--surface-color)"),r.style.setProperty("border","1px solid var(--border-color)"),r.style.setProperty("border-radius","var(--border-radius-md)"),r.style.setProperty("padding","3rem"),r.style.setProperty("color","var(--text-muted)"),r}}),null),C(r=>a(s,Qe,r)),s}}),n(h,{get when(){return se()==="requests"},get children(){var s=yt();return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","1rem"),e(s,n(h,{get when(){return B().length===0},get children(){var c=fr();return c.style.setProperty("text-align","center"),c.style.setProperty("padding","3rem"),c.style.setProperty("color","var(--text-muted)"),c}}),null),e(s,n(pe,{get each(){return B()},children:c=>{const l={pending:"#f59e0b",partial:"#8b5cf6",complete:"#22c55e",expired:"#ef4444",cancelled:"#6b7280"};return n(vt,{get children(){return[(()=>{var r=Pr(),d=r.firstChild,i=d.firstChild,t=i.nextSibling,p=t.firstChild,w=p.nextSibling;w.nextSibling;var m=d.nextSibling;return r.style.setProperty("display","flex"),r.style.setProperty("justify-content","space-between"),r.style.setProperty("align-items","flex-start"),i.style.setProperty("font-weight","600"),i.style.setProperty("margin-bottom","0.25rem"),e(i,()=>c.clientName),t.style.setProperty("font-size","0.875rem"),t.style.setProperty("color","var(--text-muted)"),e(t,()=>c.taxYear,w),e(t,()=>new Date(c.createdAt).toLocaleDateString(),null),m.style.setProperty("color","white"),m.style.setProperty("padding","0.25rem 0.75rem"),m.style.setProperty("border-radius","9999px"),m.style.setProperty("font-size","0.75rem"),m.style.setProperty("font-weight","600"),m.style.setProperty("text-transform","uppercase"),e(m,()=>c.status),C(f=>(f=l[c.status])!=null?m.style.setProperty("background",f):m.style.removeProperty("background")),r})(),(()=>{var r=$r(),d=r.firstChild,i=d.firstChild,t=i.nextSibling,p=t.firstChild,w=p.nextSibling;w.nextSibling;var m=d.nextSibling,f=m.firstChild;return r.style.setProperty("margin-top","1rem"),d.style.setProperty("display","flex"),d.style.setProperty("justify-content","space-between"),d.style.setProperty("font-size","0.875rem"),d.style.setProperty("margin-bottom","0.5rem"),e(t,()=>c.requestedDocuments.filter(x=>x.uploaded).length,p),e(t,()=>c.requestedDocuments.length,w),m.style.setProperty("height","8px"),m.style.setProperty("background","var(--border-color)"),m.style.setProperty("border-radius","4px"),m.style.setProperty("overflow","hidden"),f.style.setProperty("height","100%"),f.style.setProperty("background","var(--primary-color)"),f.style.setProperty("transition","width 0.3s"),C(x=>(x=`${c.requestedDocuments.filter(D=>D.uploaded).length/c.requestedDocuments.length*100}%`)!=null?f.style.setProperty("width",x):f.style.removeProperty("width")),r})()]}})}}),null),s}})]}}),null),C(s=>{var c=ae("#3b82f6"),l=ae("#f59e0b"),r=ae("#8b5cf6"),d=ae("#22c55e"),i=Ae(se()==="portals"),t=Ae(se()==="requests");return s.e=a(be,c,s.e),s.t=a(Pe,l,s.t),s.a=a($e,r,s.a),s.o=a(je,d,s.o),s.i=a(Y,i,s.i),s.n=a(ye,t,s.n),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),y})()};Ct(["click"]);export{wr as default};
