import{P as l,h as d,e as m}from"./index-BcWqWqyn.js";async function v(a,r,s,t){try{const n=await a.arrayBuffer(),o=Array.from(new Uint8Array(n)),c=await l({query:"uploadTaxDocument",params:{businessId:d.getBusinessId()},form:{fileBuffer:o,fileName:a.name,mimeType:a.type,fileSize:a.size,taxPortalId:r,taxYear:s,documentType:t?.documentType,tags:t?.tags,notes:t?.notes,businessId:d.getBusinessId()}});return c?.success&&c?.documentId?{success:!0,documentId:c.documentId,document:c.document}:{success:!1,error:c?.error||"Failed to upload document"}}catch(n){return m("Error uploading tax document:",n),{success:!1,error:n.message}}}async function T(a){try{const r=await l({query:"processTaxDocument",params:{businessId:d.getBusinessId()},form:{documentId:a,options:{forceReprocess:!0}}});return r?.success&&r?.document?{success:!0,document:r.document}:{success:!1,error:r?.error||"Failed to process document"}}catch(r){return m("Error processing tax document:",r),{success:!1,error:r.message}}}async function x(a){try{const r=await l({query:"batchProcessTaxDocuments",params:{businessId:d.getBusinessId()},form:{documentIds:a}});return{success:r?.success||!1,results:r?.results||[],totalProcessed:r?.totalProcessed||0,totalFailed:r?.totalFailed||0}}catch(r){return m("Error batch processing tax documents:",r),{success:!1,results:[],totalProcessed:0,totalFailed:a.length}}}async function D(a,r){try{const s=await l({query:"getTaxDocuments",params:{businessId:d.getBusinessId()},form:{taxPortalId:a,taxYear:r}});return(s?.data?.data||s?.data||[]).map(n=>p(n))}catch(s){return m("Error getting client tax documents:",s),[]}}async function P(a){try{const r=await l({query:"deleteTaxDocument",params:{businessId:d.getBusinessId(),id:a},form:{documentId:a,id:a}});return{success:r?.success||!1,error:r?.error}}catch(r){return m("Error deleting tax document:",r),{success:!1,error:r.message}}}async function A(a,r){try{const s=await l({query:"verifyTaxDocument",params:{businessId:d.getBusinessId()},form:{documentId:a,verifiedData:r}});return{success:s?.success||!1,document:s?.document,error:s?.error}}catch(s){return m("Error verifying tax document:",s),{success:!1,error:s.message}}}function p(a){const r={pending:"pending",processing:"analyzing",processed:"analyzed",complete:"analyzed",verified:"verified",error:"error",flagged:"error"},s={"w-2":"w2",w2:"w2",form_w2:"w2","1099-misc":"1099_misc","1099_misc":"1099_misc",form_1099_misc:"1099_misc","1099-nec":"1099_nec","1099_nec":"1099_nec",form_1099_nec:"1099_nec","1099-int":"1099_int","1099_int":"1099_int",form_1099_int:"1099_int","1099-div":"1099_div","1099_div":"1099_div",form_1099_div:"1099_div",1098:"1098",form_1098:"1098","1098-t":"1098_t","1098_t":"1098_t",form_1098_t:"1098_t",schedule_k1:"schedule_k1","schedule k-1":"schedule_k1","k-1":"schedule_k1",k1:"schedule_k1",receipt:"receipt","1095-a":"1095_a","1095_a":"1095_a",form_1095_a:"1095_a",form_1095a:"1095_a"},t={},n=a.extractedData;if(n?.w2Data){const e=n.w2Data;t.wages=e.wagesTipsCompensation,t.federalTaxWithheld=e.federalTaxWithheld,t.socialSecurityWages=e.socialSecurityWages,t.socialSecurityTax=e.socialSecurityTax,t.medicareWages=e.medicareWages,t.medicareTax=e.medicareTax,t.socialSecurityTips=e.socialSecurityTips,t.allocatedTips=e.allocatedTips,t.dependentCareBenefits=e.dependentCareBenefits,t.nonqualifiedPlans=e.nonqualifiedPlans,t.stateWages=e.stateWages,t.stateTaxWithheld=e.stateTax,t.localWages=e.localWages,t.localTaxWithheld=e.localTax}if(n?.form1099necData){const e=n.form1099necData;t.nonEmployeeCompensation=e.nonEmployeeCompensation,t.federalTaxWithheld1099=e.federalTaxWithheld}if(n?.form1099miscData){const e=n.form1099miscData;t.rents=e.rents,t.royalties=e.royalties,t.otherIncome=e.otherIncome,t.fishingBoatProceeds=e.fishingBoatProceeds,t.medicalPayments=e.medicalPayments,t.cropInsurance=e.cropInsurance,t.grossProceeds=e.grossProceeds,t.federalTaxWithheld1099=e.federalTaxWithheld}if(n?.form1099intData){const e=n.form1099intData;t.interestIncome=e.interestIncome,t.earlyWithdrawalPenalty=e.earlyWithdrawalPenalty,t.usSavingsBondInterest=e.usSavingsBondInterest,t.taxExemptInterest=e.taxExemptInterest,t.privateBondInterest=e.privateBondInterest,t.foreignTaxPaid=e.foreignTaxPaid,t.federalTaxWithheld1099=e.federalTaxWithheld}if(n?.form1099divData){const e=n.form1099divData;t.ordinaryDividends=e.ordinaryDividends,t.qualifiedDividends=e.qualifiedDividends,t.capitalGainDistributions=e.capitalGainDistributions,t.unrecaptured1250Gain=e.unrecaptured1250Gain,t.section1202Gain=e.section1202Gain,t.collectiblesGain=e.collectiblesGain,t.nondividendDistributions=e.nondividendDistributions,t.section199ADividends=e.section199ADividends,t.investmentExpenses=e.investmentExpenses,t.foreignTaxPaid=e.foreignTaxPaid,t.exemptInterestDividends=e.exemptInterestDividends,t.federalTaxWithheld1099=e.federalTaxWithheld}if(n?.form1098Data){const e=n.form1098Data;t.mortgageInterest=e.mortgageInterest,t.outstandingPrincipal=e.outstandingPrincipal,t.mortgageOriginationDate=e.mortgageOriginationDate,t.refundOfOverpaidInterest=e.refundOfOverpaidInterest,t.mortgageInsurancePremiums=e.mortgageInsurancePremiums,t.pointsPaid=e.pointsPaid,t.propertyAddress=e.propertyAddress,t.propertyTaxes=e.propertyTax}if(n?.form1098tData){const e=n.form1098tData;t.paymentsReceived=e.paymentsReceived,t.amountsBilled=e.amountsBilled,t.adjustmentsPriorYear=e.adjustmentsPriorYear,t.scholarshipsGrants=e.scholarshipsGrants,t.adjustmentsScholarships=e.adjustmentsScholarships,t.includesJanMarch=e.includesJanMarch,t.halfTimeStudent=e.halfTimeStudent,t.graduateStudent=e.graduateStudent}if(n?.scheduleK1Data){const e=n.scheduleK1Data;t.ordinaryBusinessIncome=e.ordinaryBusinessIncome,t.rentalRealEstateIncome=e.rentalRealEstateIncome,t.otherRentalIncome=e.otherRentalIncome,t.guaranteedPayments=e.guaranteedPayments,t.interestIncomeK1=e.interestIncome,t.dividendIncomeK1=e.ordinaryDividends,t.qualifiedDividendsK1=e.qualifiedDividends,t.royaltiesK1=e.royalties,t.shortTermCapitalGain=e.shortTermCapitalGain,t.longTermCapitalGain=e.longTermCapitalGain,t.unrecaptured1250GainK1=e.unrecaptured1250Gain,t.section1231Gain=e.section1231Gain,t.section179Deduction=e.section179Deduction,t.selfEmploymentEarnings=e.selfEmploymentEarnings}if(n?.form1095AData){console.log("[1095-A] Extracting form1095AData:",n.form1095AData);const e=n.form1095AData,f=e.annualTotals||{};t.annualPremiumAmount=e.totalEnrollmentPremiums||f.totalEnrollmentPremiums||0,t.annualSlcspPremium=e.totalSlcsp||f.totalSlcsp||0,t.annualAdvancePtc=e.totalAdvancePremiumTaxCredit||f.totalAdvancePremiumTaxCredit||0,console.log("[1095-A] Annual totals extracted:",{annualPremiumAmount:t.annualPremiumAmount,annualSlcspPremium:t.annualSlcspPremium,annualAdvancePtc:t.annualAdvancePtc}),e.monthlyData&&Array.isArray(e.monthlyData)?(t.monthlyPremiums=e.monthlyData.map(i=>i.enrollmentPremiums||0),t.monthlySlcsp=e.monthlyData.map(i=>i.slcsp||0),t.monthlyAptc=e.monthlyData.map(i=>i.advancePremiumTaxCredit||0),t.coverageMonths=e.monthlyData.filter(i=>(i.enrollmentPremiums||0)>0).length,console.log("[1095-A] Monthly data extracted, coverage months:",t.coverageMonths)):(t.monthlyPremiums=e.monthlyPremiums,t.monthlySlcsp=e.monthlySlcsp,t.monthlyAptc=e.monthlyAptc,t.coverageMonths=e.coverageMonths),!t.coverageMonths&&e.coveredMonthFlags&&(t.coverageMonths=e.coveredMonthFlags.filter(Boolean).length),!t.annualPremiumAmount&&e.monthlyPremiums?.length&&(t.annualPremiumAmount=e.monthlyPremiums.reduce((i,u)=>i+(u||0),0)),!t.annualSlcspPremium&&e.monthlySlcsp?.length&&(t.annualSlcspPremium=e.monthlySlcsp.reduce((i,u)=>i+(u||0),0)),!t.annualAdvancePtc&&e.monthlyAptc?.length&&(t.annualAdvancePtc=e.monthlyAptc.reduce((i,u)=>i+(u||0),0))}const o={};(n?.payerName||n?.payerTIN||n?.payerAddress)&&(o.name=n.payerName,o.ein=n.payerTIN,n.payerAddress&&(o.address=n.payerAddress.street,o.city=n.payerAddress.city,o.state=n.payerAddress.state,o.zip=n.payerAddress.zipCode));const c=a.uploadedAt?new Date(a.uploadedAt).getTime():a.createdAt?new Date(a.createdAt).getTime():Date.now(),y=a.documentType||a.classification?.documentType||"other",h=a.ocrConfidence?a.ocrConfidence<=1?Math.round(a.ocrConfidence*100):a.ocrConfidence:void 0;return{id:a.id,clientNotaryId:a.taxPortalId||a.clientNotaryId||"",documentType:y,drakeFormType:s[y.toLowerCase()]||"other",fileUrl:a.fileUrl||a.filePath||"",originalFileName:a.originalName||a.fileName||"",fileSize:a.fileSize,mimeType:a.mimeType,uploadedAt:c,uploadStatus:r[a.status]||r[a.processingStage||""]||"pending",aiConfidence:h,aiAnalyzedAt:a.updatedAt?new Date(a.updatedAt).getTime():void 0,extractedAmounts:Object.keys(t).length>0?t:void 0,payerInfo:Object.keys(o).length>0?o:void 0,taxYear:a.taxYear||n?.taxYear,verified:a.verified||a.validationStatus==="valid",verifiedBy:a.verifiedBy,verifiedAt:a.verifiedAt,notes:a.notes,errorMessage:a.errorMessage||(a.validationErrors?.length?a.validationErrors.map(e=>e.message).join("; "):void 0)}}export{p as a,x as b,P as d,D as g,T as p,v as u,A as v};
