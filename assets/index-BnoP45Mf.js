(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const oS=!1,sS=(t,e)=>t===e,$o=Symbol("solid-proxy"),Ib=typeof Proxy=="function",fh=Symbol("solid-track"),mh={equals:sS};let $b=Mb;const La=1,yh=2,Eb={owned:null,cleanups:null,context:null,owner:null};var Kr=null;let Op=null,aS=null,an=null,mi=null,ws=null,Kh=0;function dl(t,e){const r=an,n=Kr,i=t.length===0,o=e===void 0?n:e,s=i?Eb:{owned:null,cleanups:null,context:o?o.context:null,owner:o},l=i?t:()=>t(()=>Bi(()=>Iu(s)));Kr=s,an=null;try{return Ra(l,!0)}finally{an=r,Kr=n}}function Ce(t,e){e=e?Object.assign({},mh,e):mh;const r={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.value)),Db(r,i));return[Rb.bind(r),n]}function Se(t,e,r){const n=Vm(t,e,!1,La);Uu(n)}function yi(t,e,r){$b=dS;const n=Vm(t,e,!1,La);n.user=!0,ws?ws.push(n):Uu(n)}function Dt(t,e,r){r=r?Object.assign({},mh,r):mh;const n=Vm(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,Uu(n),Rb.bind(n)}function Tb(t){return Ra(t,!1)}function Bi(t){if(an===null)return t();const e=an;an=null;try{return t()}finally{an=e}}function Om(t,e,r){const n=Array.isArray(t);let i,o=r&&r.defer;return s=>{let l;if(n){l=Array(t.length);for(let u=0;u<t.length;u++)l[u]=t[u]()}else l=t();if(o)return o=!1,s;const c=Bi(()=>e(l,i,s));return i=l,c}}function Sn(t){yi(()=>Bi(t))}function xl(t){return Kr===null||(Kr.cleanups===null?Kr.cleanups=[t]:Kr.cleanups.push(t)),t}function jf(){return an}function kb(){return Kr}function Nb(t,e){const r=Kr,n=an;Kr=t,an=null;try{return Ra(e,!0)}catch(i){qm(i)}finally{Kr=r,an=n}}function lS(t){const e=an,r=Kr;return Promise.resolve().then(()=>{an=e,Kr=r;let n;return Ra(t,!1),an=Kr=null,n?n.done:void 0})}const[N8,L8]=Ce(!1);function Lb(t,e){const r=Symbol("context");return{id:r,Provider:pS(r),defaultValue:t}}function Bm(t){let e;return Kr&&Kr.context&&(e=Kr.context[t.id])!==void 0?e:t.defaultValue}function jm(t){const e=Dt(t),r=Dt(()=>Vf(e()));return r.toArray=()=>{const n=r();return Array.isArray(n)?n:n!=null?[n]:[]},r}function Rb(){if(this.sources&&this.state)if(this.state===La)Uu(this);else{const t=mi;mi=null,Ra(()=>vh(this),!1),mi=t}if(an){const t=this.observers?this.observers.length:0;an.sources?(an.sources.push(this),an.sourceSlots.push(t)):(an.sources=[this],an.sourceSlots=[t]),this.observers?(this.observers.push(an),this.observerSlots.push(an.sources.length-1)):(this.observers=[an],this.observerSlots=[an.sources.length-1])}return this.value}function Db(t,e,r){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&Ra(()=>{for(let i=0;i<t.observers.length;i+=1){const o=t.observers[i],s=Op&&Op.running;s&&Op.disposed.has(o),(s?!o.tState:!o.state)&&(o.pure?mi.push(o):ws.push(o),o.observers&&Fb(o)),s||(o.state=La)}if(mi.length>1e6)throw mi=[],new Error},!1)),e}function Uu(t){if(!t.fn)return;Iu(t);const e=Kh;cS(t,t.value,e)}function cS(t,e,r){let n;const i=Kr,o=an;an=Kr=t;try{n=t.fn(e)}catch(s){return t.pure&&(t.state=La,t.owned&&t.owned.forEach(Iu),t.owned=null),t.updatedAt=r+1,qm(s)}finally{an=o,Kr=i}(!t.updatedAt||t.updatedAt<=r)&&(t.updatedAt!=null&&"observers"in t?Db(t,n):t.value=n,t.updatedAt=r)}function Vm(t,e,r,n=La,i){const o={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:Kr,context:Kr?Kr.context:null,pure:r};return Kr===null||Kr!==Eb&&(Kr.owned?Kr.owned.push(o):Kr.owned=[o]),o}function gh(t){if(t.state===0)return;if(t.state===yh)return vh(t);if(t.suspense&&Bi(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Kh);)t.state&&e.push(t);for(let r=e.length-1;r>=0;r--)if(t=e[r],t.state===La)Uu(t);else if(t.state===yh){const n=mi;mi=null,Ra(()=>vh(t,e[0]),!1),mi=n}}function Ra(t,e){if(mi)return t();let r=!1;e||(mi=[]),ws?r=!0:ws=[],Kh++;try{const n=t();return uS(r),n}catch(n){r||(ws=null),mi=null,qm(n)}}function uS(t){if(mi&&(Mb(mi),mi=null),t)return;const e=ws;ws=null,e.length&&Ra(()=>$b(e),!1)}function Mb(t){for(let e=0;e<t.length;e++)gh(t[e])}function dS(t){let e,r=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[r++]=n:gh(n)}for(e=0;e<r;e++)gh(t[e])}function vh(t,e){t.state=0;for(let r=0;r<t.sources.length;r+=1){const n=t.sources[r];if(n.sources){const i=n.state;i===La?n!==e&&(!n.updatedAt||n.updatedAt<Kh)&&gh(n):i===yh&&vh(n,e)}}}function Fb(t){for(let e=0;e<t.observers.length;e+=1){const r=t.observers[e];r.state||(r.state=yh,r.pure?mi.push(r):ws.push(r),r.observers&&Fb(r))}}function Iu(t){let e;if(t.sources)for(;t.sources.length;){const r=t.sources.pop(),n=t.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),s=r.observerSlots.pop();n<i.length&&(o.sourceSlots[s]=n,i[n]=o,r.observerSlots[n]=s)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Iu(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Iu(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function hS(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function qm(t,e=Kr){throw hS(t)}function Vf(t){if(typeof t=="function"&&!t.length)return Vf(t());if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++){const n=Vf(t[r]);Array.isArray(n)?e.push.apply(e,n):e.push(n)}return e}return t}function pS(t,e){return function(n){let i;return Se(()=>i=Bi(()=>(Kr.context={...Kr.context,[t]:n.value},jm(()=>n.children))),void 0),i}}const qf=Symbol("fallback");function bh(t){for(let e=0;e<t.length;e++)t[e]()}function fS(t,e,r={}){let n=[],i=[],o=[],s=0,l=e.length>1?[]:null;return xl(()=>bh(o)),()=>{let c=t()||[],u=c.length,h,y;return c[fh],Bi(()=>{let f,x,S,P,$,U,se,X,Z;if(u===0)s!==0&&(bh(o),o=[],n=[],i=[],s=0,l&&(l=[])),r.fallback&&(n=[qf],i[0]=dl(re=>(o[0]=re,r.fallback())),s=1);else if(s===0){for(i=new Array(u),y=0;y<u;y++)n[y]=c[y],i[y]=dl(g);s=u}else{for(S=new Array(u),P=new Array(u),l&&($=new Array(u)),U=0,se=Math.min(s,u);U<se&&n[U]===c[U];U++);for(se=s-1,X=u-1;se>=U&&X>=U&&n[se]===c[X];se--,X--)S[X]=i[se],P[X]=o[se],l&&($[X]=l[se]);for(f=new Map,x=new Array(X+1),y=X;y>=U;y--)Z=c[y],h=f.get(Z),x[y]=h===void 0?-1:h,f.set(Z,y);for(h=U;h<=se;h++)Z=n[h],y=f.get(Z),y!==void 0&&y!==-1?(S[y]=i[h],P[y]=o[h],l&&($[y]=l[h]),y=x[y],f.set(Z,y)):o[h]();for(y=U;y<u;y++)y in S?(i[y]=S[y],o[y]=P[y],l&&(l[y]=$[y],l[y](y))):i[y]=dl(g);i=i.slice(0,s=u),n=c.slice(0)}return i});function g(f){if(o[y]=f,l){const[x,S]=Ce(y);return l[y]=S,e(c[y],x)}return e(c[y])}}}function mS(t,e,r={}){let n=[],i=[],o=[],s=[],l=0,c;return xl(()=>bh(o)),()=>{const u=t()||[],h=u.length;return u[fh],Bi(()=>{if(h===0)return l!==0&&(bh(o),o=[],n=[],i=[],l=0,s=[]),r.fallback&&(n=[qf],i[0]=dl(g=>(o[0]=g,r.fallback())),l=1),i;for(n[0]===qf&&(o[0](),o=[],n=[],i=[],l=0),c=0;c<h;c++)c<n.length&&n[c]!==u[c]?s[c](()=>u[c]):c>=n.length&&(i[c]=dl(y));for(;c<n.length;c++)o[c]();return l=s.length=o.length=h,n=u.slice(0),i=i.slice(0,l)});function y(g){o[c]=g;const[f,x]=Ce(u[c]);return s[c]=x,e(f,c)}}}function M(t,e){return Bi(()=>t(e||{}))}function Ed(){return!0}const zf={get(t,e,r){return e===$o?r:t.get(e)},has(t,e){return e===$o?!0:t.has(e)},set:Ed,deleteProperty:Ed,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Ed,deleteProperty:Ed}},ownKeys(t){return t.keys()}};function Bp(t){return(t=typeof t=="function"?t():t)?t:{}}function yS(){for(let t=0,e=this.length;t<e;++t){const r=this[t]();if(r!==void 0)return r}}function Uf(...t){let e=!1;for(let s=0;s<t.length;s++){const l=t[s];e=e||!!l&&$o in l,t[s]=typeof l=="function"?(e=!0,Dt(l)):l}if(Ib&&e)return new Proxy({get(s){for(let l=t.length-1;l>=0;l--){const c=Bp(t[l])[s];if(c!==void 0)return c}},has(s){for(let l=t.length-1;l>=0;l--)if(s in Bp(t[l]))return!0;return!1},keys(){const s=[];for(let l=0;l<t.length;l++)s.push(...Object.keys(Bp(t[l])));return[...new Set(s)]}},zf);const r={},n=Object.create(null);for(let s=t.length-1;s>=0;s--){const l=t[s];if(!l)continue;const c=Object.getOwnPropertyNames(l);for(let u=c.length-1;u>=0;u--){const h=c[u];if(h==="__proto__"||h==="constructor")continue;const y=Object.getOwnPropertyDescriptor(l,h);if(!n[h])n[h]=y.get?{enumerable:!0,configurable:!0,get:yS.bind(r[h]=[y.get.bind(l)])}:y.value!==void 0?y:void 0;else{const g=r[h];g&&(y.get?g.push(y.get.bind(l)):y.value!==void 0&&g.push(()=>y.value))}}}const i={},o=Object.keys(n);for(let s=o.length-1;s>=0;s--){const l=o[s],c=n[l];c&&c.get?Object.defineProperty(i,l,c):i[l]=c?c.value:void 0}return i}function gS(t,...e){if(Ib&&$o in t){const i=new Set(e.length>1?e.flat():e[0]),o=e.map(s=>new Proxy({get(l){return s.includes(l)?t[l]:void 0},has(l){return s.includes(l)&&l in t},keys(){return s.filter(l=>l in t)}},zf));return o.push(new Proxy({get(s){return i.has(s)?void 0:t[s]},has(s){return i.has(s)?!1:s in t},keys(){return Object.keys(t).filter(s=>!i.has(s))}},zf)),o}const r={},n=e.map(()=>({}));for(const i of Object.getOwnPropertyNames(t)){const o=Object.getOwnPropertyDescriptor(t,i),s=!o.get&&!o.set&&o.enumerable&&o.writable&&o.configurable;let l=!1,c=0;for(const u of e)u.includes(i)&&(l=!0,s?n[c][i]=o.value:Object.defineProperty(n[c],i,o)),++c;l||(s?r[i]=o.value:Object.defineProperty(r,i,o))}return[...n,r]}const vS=t=>`Stale read from <${t}>.`;function Ht(t){const e="fallback"in t&&{fallback:()=>t.fallback};return Dt(fS(()=>t.each,t.children,e||void 0))}function bS(t){const e="fallback"in t&&{fallback:()=>t.fallback};return Dt(mS(()=>t.each,t.children,e||void 0))}function Ge(t){const e=t.keyed,r=Dt(()=>t.when,void 0,void 0),n=e?r:Dt(r,void 0,{equals:(i,o)=>!i==!o});return Dt(()=>{const i=n();if(i){const o=t.children;return typeof o=="function"&&o.length>0?Bi(()=>o(e?i:()=>{if(!Bi(n))throw vS("Show");return r()})):o}return t.fallback},void 0,void 0)}const _S=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],SS=new Set(["className","value","readOnly","noValidate","formNoValidate","isMap","noModule","playsInline",..._S]),PS=new Set(["innerHTML","textContent","innerText","children"]),wS=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),xS=Object.assign(Object.create(null),{class:"className",novalidate:{$:"noValidate",FORM:1},formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});function AS(t,e){const r=xS[t];return typeof r=="object"?r[e]?r.$:void 0:r}const CS=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),Ee=t=>Dt(()=>t());function IS(t,e,r){let n=r.length,i=e.length,o=n,s=0,l=0,c=e[i-1].nextSibling,u=null;for(;s<i||l<o;){if(e[s]===r[l]){s++,l++;continue}for(;e[i-1]===r[o-1];)i--,o--;if(i===s){const h=o<n?l?r[l-1].nextSibling:r[o-l]:c;for(;l<o;)t.insertBefore(r[l++],h)}else if(o===l)for(;s<i;)(!u||!u.has(e[s]))&&e[s].remove(),s++;else if(e[s]===r[o-1]&&r[l]===e[i-1]){const h=e[--i].nextSibling;t.insertBefore(r[l++],e[s++].nextSibling),t.insertBefore(r[--o],h),e[i]=r[o]}else{if(!u){u=new Map;let y=l;for(;y<o;)u.set(r[y],y++)}const h=u.get(e[s]);if(h!=null)if(l<h&&h<o){let y=s,g=1,f;for(;++y<i&&y<o&&!((f=u.get(e[y]))==null||f!==h+g);)g++;if(g>h-l){const x=e[s];for(;l<h;)t.insertBefore(r[l++],x)}else t.replaceChild(r[l++],e[s++])}else s++;else e[s++].remove()}}}const Ag="_$DX_DELEGATE";function $S(t,e,r,n={}){let i;return dl(o=>{i=o,e===document?t():a(e,t(),e.firstChild?null:void 0,r)},n.owner),()=>{i(),e.textContent=""}}function he(t,e,r,n){let i;const o=()=>{const l=n?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return l.innerHTML=t,r?l.content.firstChild.firstChild:n?l.firstChild:l.content.firstChild},s=e?()=>Bi(()=>document.importNode(i||(i=o()),!0)):()=>(i||(i=o())).cloneNode(!0);return s.cloneNode=s,s}function yr(t,e=window.document){const r=e[Ag]||(e[Ag]=new Set);for(let n=0,i=t.length;n<i;n++){const o=t[n];r.has(o)||(r.add(o),e.addEventListener(o,DS))}}function nr(t,e,r){r==null?t.removeAttribute(e):t.setAttribute(e,r)}function ES(t,e,r){r?t.setAttribute(e,""):t.removeAttribute(e)}function zm(t,e){e==null?t.removeAttribute("class"):t.className=e}function ts(t,e,r,n){if(n)Array.isArray(r)?(t[`$$${e}`]=r[0],t[`$$${e}Data`]=r[1]):t[`$$${e}`]=r;else if(Array.isArray(r)){const i=r[0];t.addEventListener(e,r[0]=o=>i.call(t,r[1],o))}else t.addEventListener(e,r,typeof r!="function"&&r)}function TS(t,e,r={}){const n=Object.keys(e||{}),i=Object.keys(r);let o,s;for(o=0,s=i.length;o<s;o++){const l=i[o];!l||l==="undefined"||e[l]||(Cg(t,l,!1),delete r[l])}for(o=0,s=n.length;o<s;o++){const l=n[o],c=!!e[l];!l||l==="undefined"||r[l]===c||!c||(Cg(t,l,!0),r[l]=c)}return r}function m(t,e,r){if(!e)return r?nr(t,"style"):e;const n=t.style;if(typeof e=="string")return n.cssText=e;typeof r=="string"&&(n.cssText=r=void 0),r||(r={}),e||(e={});let i,o;for(o in r)e[o]==null&&n.removeProperty(o),delete r[o];for(o in e)i=e[o],i!==r[o]&&(n.setProperty(o,i),r[o]=i);return r}function kS(t,e={},r,n){const i={};return Se(()=>i.children=$u(t,e.children,i.children)),Se(()=>typeof e.ref=="function"&&NS(e.ref,t)),Se(()=>LS(t,e,r,!0,i,!0)),i}function NS(t,e,r){return Bi(()=>t(e,r))}function a(t,e,r,n){if(r!==void 0&&!n&&(n=[]),typeof e!="function")return $u(t,e,n,r);Se(i=>$u(t,e(),i,r),n)}function LS(t,e,r,n,i={},o=!1){e||(e={});for(const s in i)if(!(s in e)){if(s==="children")continue;i[s]=Ig(t,s,null,i[s],r,o,e)}for(const s in e){if(s==="children")continue;const l=e[s];i[s]=Ig(t,s,l,i[s],r,o,e)}}function RS(t){return t.toLowerCase().replace(/-([a-z])/g,(e,r)=>r.toUpperCase())}function Cg(t,e,r){const n=e.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)t.classList.toggle(n[i],r)}function Ig(t,e,r,n,i,o,s){let l,c,u,h,y;if(e==="style")return m(t,r,n);if(e==="classList")return TS(t,r,n);if(r===n)return n;if(e==="ref")o||r(t);else if(e.slice(0,3)==="on:"){const g=e.slice(3);n&&t.removeEventListener(g,n,typeof n!="function"&&n),r&&t.addEventListener(g,r,typeof r!="function"&&r)}else if(e.slice(0,10)==="oncapture:"){const g=e.slice(10);n&&t.removeEventListener(g,n,!0),r&&t.addEventListener(g,r,!0)}else if(e.slice(0,2)==="on"){const g=e.slice(2).toLowerCase(),f=CS.has(g);if(!f&&n){const x=Array.isArray(n)?n[0]:n;t.removeEventListener(g,x)}(f||r)&&(ts(t,g,r,f),f&&yr([g]))}else e.slice(0,5)==="attr:"?nr(t,e.slice(5),r):e.slice(0,5)==="bool:"?ES(t,e.slice(5),r):(y=e.slice(0,5)==="prop:")||(u=PS.has(e))||(h=AS(e,t.tagName))||(c=SS.has(e))||(l=t.nodeName.includes("-")||"is"in s)?(y&&(e=e.slice(5),c=!0),e==="class"||e==="className"?zm(t,r):l&&!c&&!u?t[RS(e)]=r:t[h||e]=r):nr(t,wS[e]||e,r);return r}function DS(t){let e=t.target;const r=`$$${t.type}`,n=t.target,i=t.currentTarget,o=c=>Object.defineProperty(t,"target",{configurable:!0,value:c}),s=()=>{const c=e[r];if(c&&!e.disabled){const u=e[`${r}Data`];if(u!==void 0?c.call(e,u,t):c.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&o(e.host),!0},l=()=>{for(;s()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const c=t.composedPath();o(c[0]);for(let u=0;u<c.length-2&&(e=c[u],!!s());u++){if(e._$host){e=e._$host,l();break}if(e.parentNode===i)break}}else l();o(n)}function $u(t,e,r,n,i){for(;typeof r=="function";)r=r();if(e===r)return r;const o=typeof e,s=n!==void 0;if(t=s&&r[0]&&r[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===r))return r;if(s){let l=r[0];l&&l.nodeType===3?l.data!==e&&(l.data=e):l=document.createTextNode(e),r=Kl(t,r,n,l)}else r!==""&&typeof r=="string"?r=t.firstChild.data=e:r=t.textContent=e}else if(e==null||o==="boolean")r=Kl(t,r,n);else{if(o==="function")return Se(()=>{let l=e();for(;typeof l=="function";)l=l();r=$u(t,l,r,n)}),()=>r;if(Array.isArray(e)){const l=[],c=r&&Array.isArray(r);if(Hf(l,e,r,i))return Se(()=>r=$u(t,l,r,n,!0)),()=>r;if(l.length===0){if(r=Kl(t,r,n),s)return r}else c?r.length===0?$g(t,l,n):IS(t,r,l):(r&&Kl(t),$g(t,l));r=l}else if(e.nodeType){if(Array.isArray(r)){if(s)return r=Kl(t,r,n,e);Kl(t,r,null,e)}else r==null||r===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);r=e}}return r}function Hf(t,e,r,n){let i=!1;for(let o=0,s=e.length;o<s;o++){let l=e[o],c=r&&r[t.length],u;if(!(l==null||l===!0||l===!1))if((u=typeof l)=="object"&&l.nodeType)t.push(l);else if(Array.isArray(l))i=Hf(t,l,c)||i;else if(u==="function")if(n){for(;typeof l=="function";)l=l();i=Hf(t,Array.isArray(l)?l:[l],Array.isArray(c)?c:[c])||i}else t.push(l),i=!0;else{const h=String(l);c&&c.nodeType===3&&c.data===h?t.push(c):t.push(document.createTextNode(h))}}return i}function $g(t,e,r=null){for(let n=0,i=e.length;n<i;n++)t.insertBefore(e[n],r)}function Kl(t,e,r,n){if(r===void 0)return t.textContent="";const i=n||document.createTextNode("");if(e.length){let o=!1;for(let s=e.length-1;s>=0;s--){const l=e[s];if(i!==l){const c=l.parentNode===t;!o&&!s?c?t.replaceChild(i,l):t.insertBefore(i,r):c&&l.remove()}else o=!0}}else t.insertBefore(i,r);return[i]}const MS=!1;function Ob(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function n(i,o){if(r)return!(r=!1);const s={to:i,options:o,defaultPrevented:!1,preventDefault:()=>s.defaultPrevented=!0};for(const l of t)l.listener({...s,from:l.location,retry:c=>{c&&(r=!0),l.navigate(i,{...o,resolve:!1})}});return!s.defaultPrevented}return{subscribe:e,confirm:n}}let Gf;function Um(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Gf=window.history.state._depth}Um();function FS(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function OS(t,e){let r=!1;return()=>{const n=Gf;Um();const i=n==null?null:Gf-n;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const BS=/^(?:[a-z0-9]+:)?\/\//i,jS=/^\/+|(\/)\/+$/g,Bb="http://sr";function hl(t,e=!1){const r=t.replace(jS,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function Zd(t,e,r){if(BS.test(e))return;const n=hl(t),i=r&&hl(r);let o="";return!i||e.startsWith("/")?o=n:i.toLowerCase().indexOf(n.toLowerCase())!==0?o=n+i:o=i,(o||"/")+hl(e,!o)}function VS(t,e){if(t==null)throw new Error(e);return t}function qS(t,e){return hl(t).replace(/\/*(\*.*)?$/g,"")+hl(e)}function jb(t){const e={};return t.searchParams.forEach((r,n)=>{n in e?Array.isArray(e[n])?e[n].push(r):e[n]=[e[n],r]:e[n]=r}),e}function zS(t,e,r){const[n,i]=t.split("/*",2),o=n.split("/").filter(Boolean),s=o.length;return l=>{const c=l.split("/").filter(Boolean),u=c.length-s;if(u<0||u>0&&i===void 0&&!e)return null;const h={path:s?"":"/",params:{}},y=g=>r===void 0?void 0:r[g];for(let g=0;g<s;g++){const f=o[g],x=f[0]===":",S=x?c[g]:c[g].toLowerCase(),P=x?f.slice(1):f.toLowerCase();if(x&&jp(S,y(P)))h.params[P]=S;else if(x||!jp(S,P))return null;h.path+=`/${S}`}if(i){const g=u?c.slice(-u).join("/"):"";if(jp(g,y(i)))h.params[i]=g;else return null}return h}}function jp(t,e){const r=n=>n===t;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function US(t){const[e,r]=t.pattern.split("/*",2),n=e.split("/").filter(Boolean);return n.reduce((i,o)=>i+(o.startsWith(":")?2:3),n.length-(r===void 0?0:1))}function Vb(t){const e=new Map,r=kb();return new Proxy({},{get(n,i){return e.has(i)||Nb(r,()=>e.set(i,Dt(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function qb(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),n=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(n);)i.push(r+=e[1]),n=n.slice(e[0].length);return qb(n).reduce((o,s)=>[...o,...i.map(l=>l+s)],[])}const HS=100,zb=Lb(),Hm=Lb(),Hu=()=>VS(Bm(zb),"<A> and 'use' router primitives can be only used inside a Route."),GS=()=>Bm(Hm)||Hu().base,WS=t=>{const e=GS();return Dt(()=>e.resolvePath(t()))},YS=t=>{const e=Hu();return Dt(()=>{const r=t();return r!==void 0?e.renderPath(r):r})},Gm=()=>Hu().navigatorFactory(),KS=()=>Hu().location,JS=()=>Hu().params;function QS(t,e=""){const{component:r,preload:n,load:i,children:o,info:s}=t,l=!o||Array.isArray(o)&&!o.length,c={key:t,component:r,preload:n||i,info:s};return Ub(t.path).reduce((u,h)=>{for(const y of qb(h)){const g=qS(e,y);let f=l?g:g.split("/*",1)[0];f=f.split("/").map(x=>x.startsWith(":")||x.startsWith("*")?x:encodeURIComponent(x)).join("/"),u.push({...c,originalPath:h,pattern:f,matcher:zS(f,!l,t.matchFilters)})}return u},[])}function XS(t,e=0){return{routes:t,score:US(t[t.length-1])*1e4-e,matcher(r){const n=[];for(let i=t.length-1;i>=0;i--){const o=t[i],s=o.matcher(r);if(!s)return null;n.unshift({...s,route:o})}return n}}}function Ub(t){return Array.isArray(t)?t:[t]}function Hb(t,e="",r=[],n=[]){const i=Ub(t);for(let o=0,s=i.length;o<s;o++){const l=i[o];if(l&&typeof l=="object"){l.hasOwnProperty("path")||(l.path="");const c=QS(l,e);for(const u of c){r.push(u);const h=Array.isArray(l.children)&&l.children.length===0;if(l.children&&!h)Hb(l.children,u.pattern,r,n);else{const y=XS([...r],n.length);n.push(y)}r.pop()}}}return r.length?n:n.sort((o,s)=>s.score-o.score)}function Vp(t,e){for(let r=0,n=t.length;r<n;r++){const i=t[r].matcher(e);if(i)return i}return[]}function ZS(t,e,r){const n=new URL(Bb),i=Dt(h=>{const y=t();try{return new URL(y,n)}catch{return console.error(`Invalid path ${y}`),h}},n,{equals:(h,y)=>h.href===y.href}),o=Dt(()=>i().pathname),s=Dt(()=>i().search,!0),l=Dt(()=>i().hash),c=()=>"",u=Om(s,()=>jb(i()));return{get pathname(){return o()},get search(){return s()},get hash(){return l()},get state(){return e()},get key(){return c()},query:r?r(u):Vb(u)}}let nl;function eP(){return nl}function tP(t,e,r,n={}){const{signal:[i,o],utils:s={}}=t,l=s.parsePath||(W=>W),c=s.renderPath||(W=>W),u=s.beforeLeave||Ob(),h=Zd("",n.base||"");if(h===void 0)throw new Error(`${h} is not a valid base path`);h&&!i().value&&o({value:h,replace:!0,scroll:!1});const[y,g]=Ce(!1);let f;const x=(W,K)=>{K.value===S()&&K.state===$()||(f===void 0&&g(!0),nl=W,f=K,lS(()=>{f===K&&(P(f.value),U(f.state),Z[1](k=>k.filter(R=>R.pending)))}).finally(()=>{f===K&&Tb(()=>{nl=void 0,W==="navigate"&&w(f),g(!1),f=void 0})}))},[S,P]=Ce(i().value),[$,U]=Ce(i().state),se=ZS(S,$,s.queryWrapper),X=[],Z=Ce([]),re=Dt(()=>typeof n.transformUrl=="function"?Vp(e(),n.transformUrl(se.pathname)):Vp(e(),se.pathname)),E=()=>{const W=re(),K={};for(let k=0;k<W.length;k++)Object.assign(K,W[k].params);return K},C=s.paramsWrapper?s.paramsWrapper(E,e):Vb(E),T={pattern:h,path:()=>h,outlet:()=>null,resolvePath(W){return Zd(h,W)}};return Se(Om(i,W=>x("native",W),{defer:!0})),{base:T,location:se,params:C,isRouting:y,renderPath:c,parsePath:l,navigatorFactory:b,matches:re,beforeLeave:u,preloadRoute:_,singleFlight:n.singleFlight===void 0?!0:n.singleFlight,submissions:Z};function j(W,K,k){Bi(()=>{if(typeof K=="number"){K&&(s.go?s.go(K):console.warn("Router integration does not support relative routing"));return}const R=!K||K[0]==="?",{replace:Y,resolve:q,scroll:O,state:le}={replace:!1,resolve:!R,scroll:!0,...k},N=q?W.resolvePath(K):Zd(R&&se.pathname||"",K);if(N===void 0)throw new Error(`Path '${K}' is not a routable path`);if(X.length>=HS)throw new Error("Too many redirects");const D=S();(N!==D||le!==$())&&(MS||u.confirm(N,k)&&(X.push({value:D,replace:Y,scroll:O,state:$()}),x("navigate",{value:N,state:le})))})}function b(W){return W=W||Bm(Hm)||T,(K,k)=>j(W,K,k)}function w(W){const K=X[0];K&&(o({...W,replace:K.replace,scroll:K.scroll}),X.length=0)}function _(W,K){const k=Vp(e(),W.pathname),R=nl;nl="preload";for(let Y in k){const{route:q,params:O}=k[Y];q.component&&q.component.preload&&q.component.preload();const{preload:le}=q;K&&le&&Nb(r(),()=>le({params:O,location:{pathname:W.pathname,search:W.search,hash:W.hash,query:jb(W),state:null,key:""},intent:"preload"}))}nl=R}}function rP(t,e,r,n){const{base:i,location:o,params:s}=t,{pattern:l,component:c,preload:u}=n().route,h=Dt(()=>n().path);c&&c.preload&&c.preload();const y=u?u({params:s,location:o,intent:nl||"initial"}):void 0;return{parent:e,pattern:l,path:h,outlet:()=>c?M(c,{params:s,location:o,data:y,get children(){return r()}}):r(),resolvePath(f){return Zd(i.path(),f,h())}}}const nP=t=>e=>{const{base:r}=e,n=jm(()=>e.children),i=Dt(()=>Hb(n(),e.base||""));let o;const s=tP(t,i,()=>o,{base:r,singleFlight:e.singleFlight,transformUrl:e.transformUrl});return t.create&&t.create(s),M(zb.Provider,{value:s,get children(){return M(iP,{routerState:s,get root(){return e.root},get preload(){return e.rootPreload||e.rootLoad},get children(){return[Ee(()=>(o=kb())&&null),M(oP,{routerState:s,get branches(){return i()}})]}})}})};function iP(t){const e=t.routerState.location,r=t.routerState.params,n=Dt(()=>t.preload&&Bi(()=>{t.preload({params:r,location:e,intent:eP()||"initial"})}));return M(Ge,{get when(){return t.root},keyed:!0,get fallback(){return t.children},children:i=>M(i,{params:r,location:e,get data(){return n()},get children(){return t.children}})})}function oP(t){const e=[];let r;const n=Dt(Om(t.routerState.matches,(i,o,s)=>{let l=o&&i.length===o.length;const c=[];for(let u=0,h=i.length;u<h;u++){const y=o&&o[u],g=i[u];s&&y&&g.route.key===y.route.key?c[u]=s[u]:(l=!1,e[u]&&e[u](),dl(f=>{e[u]=f,c[u]=rP(t.routerState,c[u-1]||t.routerState.base,Eg(()=>n()[u+1]),()=>t.routerState.matches()[u])}))}return e.splice(i.length).forEach(u=>u()),s&&l?s:(r=c[0],c)}));return Eg(()=>n()&&r)()}const Eg=t=>()=>M(Ge,{get when(){return t()},keyed:!0,children:e=>M(Hm.Provider,{value:e,get children(){return e.outlet()}})}),so=t=>{const e=jm(()=>t.children);return Uf(t,{get children(){return e()}})};function sP([t,e],r,n){return[t,n?i=>e(n(i)):e]}function aP(t){let e=!1;const r=i=>typeof i=="string"?{value:i}:i,n=sP(Ce(r(t.get()),{equals:(i,o)=>i.value===o.value&&i.state===o.state}),void 0,i=>(!e&&t.set(i),i));return t.init&&xl(t.init((i=t.get())=>{e=!0,n[1](r(i)),e=!1})),nP({signal:n,create:t.create,utils:t.utils})}function lP(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function cP(t,e){const r=t&&document.getElementById(t);r?r.scrollIntoView():e&&window.scrollTo(0,0)}const uP=new Map;function dP(t=!0,e=!1,r="/_server",n){return i=>{const o=i.base.path(),s=i.navigatorFactory(i.base);let l,c;function u(S){return S.namespaceURI==="http://www.w3.org/2000/svg"}function h(S){if(S.defaultPrevented||S.button!==0||S.metaKey||S.altKey||S.ctrlKey||S.shiftKey)return;const P=S.composedPath().find(re=>re instanceof Node&&re.nodeName.toUpperCase()==="A");if(!P||e&&!P.hasAttribute("link"))return;const $=u(P),U=$?P.href.baseVal:P.href;if(($?P.target.baseVal:P.target)||!U&&!P.hasAttribute("state"))return;const X=(P.getAttribute("rel")||"").split(/\s+/);if(P.hasAttribute("download")||X&&X.includes("external"))return;const Z=$?new URL(U,document.baseURI):new URL(U);if(!(Z.origin!==window.location.origin||o&&Z.pathname&&!Z.pathname.toLowerCase().startsWith(o.toLowerCase())))return[P,Z]}function y(S){const P=h(S);if(!P)return;const[$,U]=P,se=i.parsePath(U.pathname+U.search+U.hash),X=$.getAttribute("state");S.preventDefault(),s(se,{resolve:!1,replace:$.hasAttribute("replace"),scroll:!$.hasAttribute("noscroll"),state:X?JSON.parse(X):void 0})}function g(S){const P=h(S);if(!P)return;const[$,U]=P;i.preloadRoute(U,$.getAttribute("preload")!=="false")}function f(S){clearTimeout(l);const P=h(S);if(!P)return c=null;const[$,U]=P;c!==$&&(l=setTimeout(()=>{i.preloadRoute(U,$.getAttribute("preload")!=="false"),c=$},20))}function x(S){if(S.defaultPrevented)return;let P=S.submitter&&S.submitter.hasAttribute("formaction")?S.submitter.getAttribute("formaction"):S.target.getAttribute("action");if(!P)return;if(!P.startsWith("https://action/")){const U=new URL(P,Bb);if(P=i.parsePath(U.pathname+U.search),!P.startsWith(r))return}if(S.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const $=uP.get(P);if($){S.preventDefault();const U=new FormData(S.target,S.submitter);$.call({r:i,f:S.target},S.target.enctype==="multipart/form-data"?U:new URLSearchParams(U))}}yr(["click","submit"]),document.addEventListener("click",y),t&&(document.addEventListener("mousemove",f,{passive:!0}),document.addEventListener("focusin",g,{passive:!0}),document.addEventListener("touchstart",g,{passive:!0})),document.addEventListener("submit",x),xl(()=>{document.removeEventListener("click",y),t&&(document.removeEventListener("mousemove",f),document.removeEventListener("focusin",g),document.removeEventListener("touchstart",g)),document.removeEventListener("submit",x)})}}function hP(t){const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,r="/"]=window.location.hash.split("#",2);return`${r}#${e}`}return e}function pP(t){const e=()=>window.location.hash.slice(1),r=Ob();return aP({get:e,set({value:n,replace:i,scroll:o,state:s}){i?window.history.replaceState(FS(s),"","#"+n):window.history.pushState(s,"","#"+n);const l=n.indexOf("#"),c=l>=0?n.slice(l+1):"";cP(c,o),Um()},init:n=>lP(window,"hashchange",OS(n,i=>!r.confirm(i&&i<0?i:e()))),create:dP(t.preload,t.explicitLinks,t.actionBase),utils:{go:n=>window.history.go(n),renderPath:n=>`#${n}`,parsePath:hP,beforeLeave:r}})(t)}var fP=he("<a>");function rc(t){t=Uf({inactiveClass:"inactive",activeClass:"active"},t);const[,e]=gS(t,["href","state","class","activeClass","inactiveClass","end"]),r=WS(()=>t.href),n=YS(r),i=KS(),o=Dt(()=>{const s=r();if(s===void 0)return[!1,!1];const l=hl(s.split(/[?#]/,1)[0]).toLowerCase(),c=decodeURI(hl(i.pathname).toLowerCase());return[t.end?l===c:c.startsWith(l+"/")||c===l,l===c]});return(()=>{var s=fP();return kS(s,Uf(e,{get href(){return n()||t.href},get state(){return JSON.stringify(t.state)},get classList(){return{...t.class&&{[t.class]:!0},[t.inactiveClass]:!o()[0],[t.activeClass]:o()[0],...e.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),s})()}const Wf=Symbol("store-raw"),cc=Symbol("store-node"),bs=Symbol("store-has"),Gb=Symbol("store-self");function Wb(t){let e=t[$o];if(!e&&(Object.defineProperty(t,$o,{value:e=new Proxy(t,gP)}),!Array.isArray(t))){const r=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let i=0,o=r.length;i<o;i++){const s=r[i];n[s].get&&Object.defineProperty(t,s,{enumerable:n[s].enumerable,get:n[s].get.bind(e)})}}return e}function _h(t){let e;return t!=null&&typeof t=="object"&&(t[$o]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function Eu(t,e=new Set){let r,n,i,o;if(r=t!=null&&t[Wf])return r;if(!_h(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let s=0,l=t.length;s<l;s++)i=t[s],(n=Eu(i,e))!==i&&(t[s]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const s=Object.keys(t),l=Object.getOwnPropertyDescriptors(t);for(let c=0,u=s.length;c<u;c++)o=s[c],!l[o].get&&(i=t[o],(n=Eu(i,e))!==i&&(t[o]=n))}return t}function Sh(t,e){let r=t[e];return r||Object.defineProperty(t,e,{value:r=Object.create(null)}),r}function Tu(t,e,r){if(t[e])return t[e];const[n,i]=Ce(r,{equals:!1,internal:!0});return n.$=i,t[e]=n}function mP(t,e){const r=Reflect.getOwnPropertyDescriptor(t,e);return!r||r.get||!r.configurable||e===$o||e===cc||(delete r.value,delete r.writable,r.get=()=>t[$o][e]),r}function Yb(t){jf()&&Tu(Sh(t,cc),Gb)()}function yP(t){return Yb(t),Reflect.ownKeys(t)}const gP={get(t,e,r){if(e===Wf)return t;if(e===$o)return r;if(e===fh)return Yb(t),r;const n=Sh(t,cc),i=n[e];let o=i?i():t[e];if(e===cc||e===bs||e==="__proto__")return o;if(!i){const s=Object.getOwnPropertyDescriptor(t,e);jf()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(s&&s.get)&&(o=Tu(n,e,o)())}return _h(o)?Wb(o):o},has(t,e){return e===Wf||e===$o||e===fh||e===cc||e===bs||e==="__proto__"?!0:(jf()&&Tu(Sh(t,bs),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:yP,getOwnPropertyDescriptor:mP};function Ph(t,e,r,n=!1){if(!n&&t[e]===r)return;const i=t[e],o=t.length;r===void 0?(delete t[e],t[bs]&&t[bs][e]&&i!==void 0&&t[bs][e].$()):(t[e]=r,t[bs]&&t[bs][e]&&i===void 0&&t[bs][e].$());let s=Sh(t,cc),l;if((l=Tu(s,e,i))&&l.$(()=>r),Array.isArray(t)&&t.length!==o){for(let c=t.length;c<o;c++)(l=s[c])&&l.$();(l=Tu(s,"length",o))&&l.$(t.length)}(l=s[Gb])&&l.$()}function Kb(t,e){const r=Object.keys(e);for(let n=0;n<r.length;n+=1){const i=r[n];Ph(t,i,e[i])}}function vP(t,e){if(typeof e=="function"&&(e=e(t)),e=Eu(e),Array.isArray(e)){if(t===e)return;let r=0,n=e.length;for(;r<n;r++){const i=e[r];t[r]!==i&&Ph(t,r,i)}Ph(t,"length",n)}else Kb(t,e)}function su(t,e,r=[]){let n,i=t;if(e.length>1){n=e.shift();const s=typeof n,l=Array.isArray(t);if(Array.isArray(n)){for(let c=0;c<n.length;c++)su(t,[n[c]].concat(e),r);return}else if(l&&s==="function"){for(let c=0;c<t.length;c++)n(t[c],c)&&su(t,[c].concat(e),r);return}else if(l&&s==="object"){const{from:c=0,to:u=t.length-1,by:h=1}=n;for(let y=c;y<=u;y+=h)su(t,[y].concat(e),r);return}else if(e.length>1){su(t[n],e,[n].concat(r));return}i=t[n],r=[n].concat(r)}let o=e[0];typeof o=="function"&&(o=o(i,r),o===i)||n===void 0&&o==null||(o=Eu(o),n===void 0||_h(i)&&_h(o)&&!Array.isArray(o)?Kb(i,o):Ph(t,n,o))}function Gu(...[t,e]){const r=Eu(t||{}),n=Array.isArray(r),i=Wb(r);function o(...s){Tb(()=>{n&&s.length===1?vP(r,s[0]):su(r,s)})}return[i,o]}const Yr=(t=300+Math.random()*700)=>new Promise(e=>setTimeout(e,t)),Qa=(t="")=>`${t}${Date.now()}-${Math.random().toString(36).substr(2,9)}`;let zt={products:[{id:"prod-001",name:"Wireless Headphones",sku:"WH-001",productCode:"WH-001",productName:"Wireless Headphones",description:"High-quality wireless bluetooth headphones",category:"Electronics",unitOfMeasure:"pcs",unitCost:45,sellingPrice:89.99,minStockLevel:10,maxStockLevel:100,isActive:!0,createdDate:"2024-01-15T10:00:00Z",lastModified:"2024-01-15T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-002",name:"USB-C Cable",sku:"USB-001",description:"3ft USB-C charging cable",category:"Accessories",unitOfMeasure:"pcs",unitCost:8.5,sellingPrice:19.99,minStockLevel:25,maxStockLevel:200,isActive:!0,createdDate:"2024-01-16T10:00:00Z",lastModified:"2024-01-16T10:00:00Z",businessId:"YB100423253156428"},{id:"prod-003",name:"Laptop Stand",sku:"LS-001",description:"Adjustable aluminum laptop stand",category:"Office",unitOfMeasure:"pcs",unitCost:25,sellingPrice:49.99,minStockLevel:5,maxStockLevel:50,isActive:!0,createdDate:"2024-01-17T10:00:00Z",lastModified:"2024-01-17T10:00:00Z",businessId:"YB100423253156428"}],locations:[{id:"loc-001",name:"Main Warehouse",code:"WH-001",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-002",name:"Retail Store - Downtown",code:"ST-001",type:"store",address:"456 Main St, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"},{id:"loc-003",name:"Retail Store - Mall",code:"ST-002",type:"store",address:"789 Mall Blvd, City, State 12345",isActive:!0,createdDate:"2024-01-01T10:00:00Z"}],movements:[{id:"mov-001",productId:"prod-001",productName:"Wireless Headphones",productSku:"WH-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:50,unitCost:45,totalCost:2250,referenceNumber:"PO-001",notes:"Initial stock purchase",createdBy:"admin",createdDate:"2024-01-15T10:00:00Z",invoiceId:"INV-1000001"},{id:"mov-002",productId:"prod-002",productName:"USB-C Cable",productSku:"USB-001",locationId:"loc-001",locationName:"Main Warehouse",movementType:"in",quantity:100,unitCost:8.5,totalCost:850,referenceNumber:"PO-001",notes:"Bulk purchase",createdBy:"admin",createdDate:"2024-01-15T10:05:00Z",invoiceId:"INV-1000001"}],accounts:[{id:"acc-001",accountNumber:"1000",accountName:"Cash",accountType:"asset",category:"currentAssets",balance:5e4,parentAccountId:null,description:"Cash and cash equivalents",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"},{id:"acc-002",accountNumber:"1100",accountName:"Accounts Receivable",accountType:"asset",category:"currentAssets",balance:25e3,parentAccountId:null,description:"Money owed by customers",isActive:!0,createdDate:"2024-01-01T10:00:00Z",lastModified:"2024-01-01T10:00:00Z"}],journalEntries:[{id:"je-001",entryNumber:"JE-001",date:"2024-01-15",description:"Initial cash deposit",reference:"DEP-001",status:"posted",createdBy:"admin",createdAt:"2024-01-15T10:00:00Z",postedAt:"2024-01-15T10:05:00Z",lines:[{id:"jel-001",accountId:"acc-001",accountName:"Cash",description:"Initial deposit",debitAmount:5e4,creditAmount:0},{id:"jel-002",accountId:"acc-003",accountName:"Owner Equity",description:"Initial capital",debitAmount:0,creditAmount:5e4}]}]};const Nn=(t=.05)=>Math.random()<t,Ln=()=>{const t=["Network timeout","Connection refused","Server temporarily unavailable","Invalid request"];throw new Error(t[Math.floor(Math.random()*t.length)])},$i={products:{async getAll(t,e){await Yr(),Nn()&&Ln();let r=[...zt.products];if(t&&t.trim()){const n=t.toLowerCase();r=r.filter(i=>i.name.toLowerCase().includes(n)||i.sku.toLowerCase().includes(n)||i.category.toLowerCase().includes(n)||i.description.toLowerCase().includes(n))}return e?.category&&(r=r.filter(n=>n.category===e.category)),e?.isActive!==void 0&&(r=r.filter(n=>n.isActive===e.isActive)),r},async getById(t){return await Yr(),Nn()&&Ln(),zt.products.find(e=>e.id===t)||null},async create(t){if(await Yr(),Nn()&&Ln(),zt.products.some(r=>r.sku===t.sku))throw new Error("SKU already exists");const e={...t,id:Qa("prod-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return zt.products.push(e),e},async update(t,e){await Yr(),Nn()&&Ln();const r=zt.products.findIndex(i=>i.id===t);if(r===-1)throw new Error("Product not found");if(e.sku&&zt.products.some(i=>i.id!==t&&i.sku===e.sku))throw new Error("SKU already exists");const n={...zt.products[r],...e,lastModified:new Date().toISOString()};return zt.products[r]=n,n},async delete(t){await Yr(),Nn()&&Ln();const e=zt.products.findIndex(n=>n.id===t);if(e===-1)throw new Error("Product not found");return zt.movements.some(n=>n.productId===t)?{success:!1,message:"Cannot delete product with existing movements"}:(zt.products.splice(e,1),{success:!0,message:"Product deleted successfully"})}},locations:{async getAll(t){await Yr(),Nn()&&Ln();let e=[...zt.locations];return t?.type&&(e=e.filter(r=>r.type===t.type)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Yr(),zt.locations.find(e=>e.id===t)||null},async create(t){if(await Yr(),Nn()&&Ln(),zt.locations.some(r=>r.code===t.code))throw new Error("Location code already exists");const e={...t,id:Qa("loc-"),createdDate:new Date().toISOString()};return zt.locations.push(e),e},async update(t,e){await Yr(),Nn()&&Ln();const r=zt.locations.findIndex(n=>n.id===t);if(r===-1)throw new Error("Location not found");if(e.code&&zt.locations.some(n=>n.id!==t&&n.code===e.code))throw new Error("Location code already exists");return zt.locations[r]={...zt.locations[r],...e},zt.locations[r]}},movements:{async getAll(t){await Yr(),Nn()&&Ln();let e=[...zt.movements];if(t?.productId&&(e=e.filter(r=>r.productId===t.productId)),t?.locationId&&(e=e.filter(r=>r.locationId===t.locationId)),t?.movementType&&(e=e.filter(r=>r.movementType===t.movementType)),t?.dateFrom&&(e=e.filter(r=>r.createdDate>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.createdDate<=t.dateTo)),t?.search){const r=t.search.toLowerCase();e=e.filter(n=>n.productName.toLowerCase().includes(r)||n.productSku.toLowerCase().includes(r)||n.referenceNumber.toLowerCase().includes(r)||n.notes.toLowerCase().includes(r))}return e.sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime()),e},async getById(t){return await Yr(),zt.movements.find(e=>e.id===t)||null},async create(t){if(await Yr(),Nn()&&Ln(),!zt.products.find(i=>i.id===t.productId))throw new Error("Product not found");if(!zt.locations.find(i=>i.id===t.locationId))throw new Error("Location not found");if(t.movementType==="out"){const i=await this.getStockLevel(t.productId,t.locationId);if(i<t.quantity)throw new Error(`Insufficient stock. Available: ${i}, Requested: ${t.quantity}`)}const n={...t,id:Qa("mov-"),createdDate:new Date().toISOString()};return zt.movements.push(n),n},async update(t,e){await Yr(),Nn()&&Ln();const r=zt.movements.findIndex(i=>i.id===t);if(r===-1)throw new Error("Movement not found");const n={...zt.movements[r],...e,lastModified:new Date().toISOString()};return zt.movements[r]=n,n},async delete(t){await Yr(),Nn()&&Ln();const e=zt.movements.findIndex(r=>r.id===t);if(e===-1)throw new Error("Movement not found");return zt.movements.splice(e,1),{success:!0,message:"Movement deleted successfully"}},async createBulk(t){await Yr(),Nn()&&Ln();const e=[],r=[],n=new Date().toISOString(),i=zt.locations.find(o=>o.id===t.locationId);if(!i)return{success:!1,movements:[],errors:["Invalid location"]};for(let o=0;o<t.items.length;o++){const s=t.items[o],l=zt.products.find(h=>h.id===s.productId);if(!l){e.push(`Item ${o+1}: Product not found`);continue}if(s.quantity<=0){e.push(`Item ${o+1}: Quantity must be greater than 0`);continue}if(t.movementType==="out"){const h=await this.getStockLevel(s.productId,t.locationId);if(s.quantity>h){e.push(`Item ${o+1}: Insufficient stock. Available: ${h}, Requested: ${s.quantity}`);continue}}const c=s.unitCost||l.unitCost,u={id:Qa("mov-"),productId:l.id,productName:l.name,productSku:l.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:s.quantity,unitCost:c,totalCost:s.quantity*c,referenceNumber:t.referenceNumber,notes:s.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:t.fromLocationId?zt.locations.find(h=>h.id===t.fromLocationId)?.name:void 0};r.push(u)}return e.length>0?{success:!1,movements:[],errors:e}:(zt.movements.push(...r),{success:!0,movements:r,errors:[]})},async getStockLevel(t,e){return await Yr(50),zt.movements.filter(r=>r.productId===t&&r.locationId===e).reduce((r,n)=>{switch(n.movementType){case"in":case"adjustment":return r+n.quantity;case"out":return r-n.quantity;case"transfer":return n.locationId===e?r+n.quantity:r;default:return r}},0)},async getStockLevels(){await Yr();const t=new Map;for(const e of zt.movements){const r=`${e.productId}-${e.locationId}`;let n=t.get(r);switch(n||(n={id:r,productId:e.productId,locationId:e.locationId,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,n)),e.movementType){case"in":case"adjustment":n.quantity+=e.quantity;break;case"out":n.quantity-=e.quantity;break;case"transfer":e.locationId===e.locationId&&(n.quantity+=e.quantity);break}new Date(e.createdDate)>new Date(n.lastMovementDate)&&(n.lastMovementDate=e.createdDate,n.lastMovementType=e.movementType),n.averageCost=e.unitCost,n.availableQuantity=n.quantity-n.reservedQuantity}return Array.from(t.values())}},accounts:{async getAll(t){await Yr(),Nn()&&Ln();let e=[...zt.accounts];return t?.accountType&&(e=e.filter(r=>r.accountType===t.accountType)),t?.category&&(e=e.filter(r=>r.category===t.category)),t?.isActive!==void 0&&(e=e.filter(r=>r.isActive===t.isActive)),e},async getById(t){return await Yr(),zt.accounts.find(e=>e.id===t)||null},async create(t){if(await Yr(),Nn()&&Ln(),zt.accounts.some(r=>r.accountNumber===t.accountNumber))throw new Error("Account number already exists");const e={...t,id:Qa("acc-"),createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};return zt.accounts.push(e),e},async update(t,e){await Yr(),Nn()&&Ln();const r=zt.accounts.findIndex(n=>n.id===t);if(r===-1)throw new Error("Account not found");if(e.accountNumber&&zt.accounts.some(n=>n.id!==t&&n.accountNumber===e.accountNumber))throw new Error("Account number already exists");return zt.accounts[r]={...zt.accounts[r],...e,lastModified:new Date().toISOString()},zt.accounts[r]}},journal:{async getAll(t){await Yr(),Nn()&&Ln();let e=[...zt.journalEntries];return t?.status&&(e=e.filter(r=>r.status===t.status)),t?.accountId&&(e=e.filter(r=>r.lines.some(n=>n.accountId===t.accountId))),t?.dateFrom&&(e=e.filter(r=>r.date>=t.dateFrom)),t?.dateTo&&(e=e.filter(r=>r.date<=t.dateTo)),e.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime())},async getById(t){return await Yr(),zt.journalEntries.find(e=>e.id===t)||null},async create(t){await Yr(),Nn()&&Ln();const e=t.lines.reduce((l,c)=>l+(c.debitAmount||0),0),r=t.lines.reduce((l,c)=>l+(c.creditAmount||0),0);if(Math.abs(e-r)>.01)throw new Error(`Entry is not balanced. Debit: ${e}, Credit: ${r}`);const n=zt.journalEntries.sort((l,c)=>c.entryNumber.localeCompare(l.entryNumber))[0],o=`JE-${((n?parseInt(n.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`,s={...t,id:Qa("je-"),entryNumber:o,createdAt:new Date().toISOString(),lines:t.lines.map(l=>({...l,id:Qa("jel-")}))};return zt.journalEntries.push(s),s},async update(t,e){await Yr(),Nn()&&Ln();const r=zt.journalEntries.findIndex(n=>n.id===t);if(r===-1)throw new Error("Journal entry not found");if(zt.journalEntries[r].status==="posted")throw new Error("Cannot modify posted entries");return zt.journalEntries[r]={...zt.journalEntries[r],...e},zt.journalEntries[r]},async post(t){await Yr(),Nn()&&Ln();const e=zt.journalEntries.findIndex(o=>o.id===t);if(e===-1)throw new Error("Journal entry not found");const r=zt.journalEntries[e];if(r.status==="posted")throw new Error("Entry is already posted");const n=r.lines.reduce((o,s)=>o+(s.debitAmount||0),0),i=r.lines.reduce((o,s)=>o+(s.creditAmount||0),0);if(Math.abs(n-i)>.01)throw new Error("Entry must be balanced before posting");return zt.journalEntries[e]={...r,status:"posted",postedAt:new Date().toISOString()},r.lines.forEach(o=>{const s=zt.accounts.findIndex(l=>l.id===o.accountId);if(s!==-1){const l=zt.accounts[s],c=o.debitAmount||0,u=o.creditAmount||0;["asset","expense"].includes(l.accountType)?l.balance+=c-u:l.balance+=u-c}}),zt.journalEntries[e]}},utils:{async getNextEntryNumber(){await Yr(100);const t=zt.journalEntries.sort((r,n)=>n.entryNumber.localeCompare(r.entryNumber))[0];return`JE-${((t?parseInt(t.entryNumber.split("-")[1]):0)+1).toString().padStart(3,"0")}`},async getNextProductCode(t){await Yr(100);const e=t.toUpperCase().slice(0,3),r=zt.products.filter(i=>i.productCode?.startsWith(e)).sort((i,o)=>(o.productCode||"").localeCompare(i.productCode||""));if(r.length===0)return`${e}001`;const n=parseInt(r[0].productCode?.slice(-3)||"0");return`${e}${(n+1).toString().padStart(3,"0")}`},async healthCheck(){return await Yr(50),{status:"healthy",timestamp:new Date().toISOString(),version:"1.0.0"}},async resetDatabase(){return await Yr(200),zt={products:[...zt.products.slice(0,3)],locations:[...zt.locations.slice(0,3)],movements:[...zt.movements.slice(0,2)],accounts:[...zt.accounts.slice(0,2)],journalEntries:[...zt.journalEntries.slice(0,1)]},{success:!0,message:"Database reset to initial state"}},async getStats(){return await Yr(100),{products:zt.products.length,locations:zt.locations.length,movements:zt.movements.length,accounts:zt.accounts.length,journalEntries:zt.journalEntries.length,totalStockValue:zt.movements.reduce((t,e)=>e.movementType==="in"?t+e.totalCost:e.movementType==="out"?t-e.totalCost:t,0)}}}},Jb=t=>t===null||typeof t!="object"?t:t instanceof Date?new Date(t.getTime()):Array.isArray(t)?t.map(e=>Jb(e)):JSON.parse(JSON.stringify(t)),ku=(t=16)=>{const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},Tg=(t=16)=>{const e="123456789";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},bP=(t=4)=>{const e="0123456789BCDFGKSY";let r="";for(let n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r},pl=t=>typeof t=="string"&&t.trim().length>0,di=async t=>{const n=await fetch("https://qvamarkets.com/gql_api",{method:"POST",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate, br",Authorization:"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlOGZjOGU1NTZmN2E3NmQwOGQzNTgyOWQ2ZjkwYWUyZTEyY2ZkMGQiLCJ0eXAiOiJKV1QifQ"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.json();if(i.errors)throw new Error(i.errors[0]?.message||"GraphQL error");return i.data},_P=t=>({ENTRY:"in",in:"in",TRANSFER:"transfer",transfer:"transfer",SALES:"out",out:"out",adjustment:"adjustment"})[t],Yf=t=>({ENTRY:"ENTRY",in:"ENTRY",TRANSFER:"TRANSFER",transfer:"TRANSFER",SALES:"SALES",out:"SALES",adjustment:"adjustment"})[t];function Kf(t){var e=[];return t&&Object.keys(t).map(r=>{e.push(t[r])}),e}function SP(t){if(!/^[a-z0-9+/]+={0,2}$/i.test(t)||t.length%4!=0)throw Error("Not base64 string");for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,n,i,o,s,l,c,u,h=[],y=0;y<t.length;y+=4)o=e.indexOf(t.charAt(y)),s=e.indexOf(t.charAt(y+1)),l=e.indexOf(t.charAt(y+2)),c=e.indexOf(t.charAt(y+3)),u=o<<18|s<<12|l<<6|c,r=u>>>16&255,n=u>>>8&255,i=u&255,h[y/4]=String.fromCharCode(r,n,i),c==64&&(h[y/4]=String.fromCharCode(r,n)),l==64&&(h[y/4]=String.fromCharCode(r));return t=h.join(""),t}const PP=(t,e,r,n)=>{let i=0,o={};return t.map(s=>{n?.[s]||Qb(e?.[s],r?.[s])||(i=1,o[s]=e[s])}),{hasChange:i,data:o}},Qb=(t,e)=>Object.prototype.toString.call(t)===Object.prototype.toString.call(e)?Object.prototype.toString.call(t)==="[object Object]"||Object.prototype.toString.call(t)==="[object Array]"?Object.keys(t).length!==Object.keys(e).length?!1:Object.keys(t).every(function(r){return Qb(t[r],e[r])}):t===e:!1,wP=()=>{};var kg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},xP=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],s=t[r++],l=t[r++],c=((i&7)<<18|(o&63)<<12|(s&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const o=t[r++],s=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},Zb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],s=i+1<t.length,l=s?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,h=o>>2,y=(o&3)<<4|l>>4;let g=(l&15)<<2|u>>6,f=u&63;c||(f=64,s||(g=64)),n.push(r[h],r[y],r[g],r[f])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Xb(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):xP(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],l=i<t.length?r[t.charAt(i)]:0;++i;const u=i<t.length?r[t.charAt(i)]:64;++i;const y=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||l==null||u==null||y==null)throw new AP;const g=o<<2|l>>4;if(n.push(g),u!==64){const f=l<<4&240|u>>2;if(n.push(f),y!==64){const x=u<<6&192|y;n.push(x)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class AP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const CP=function(t){const e=Xb(t);return Zb.encodeByteArray(e,!0)},wh=function(t){return CP(t).replace(/\./g,"")},e1=function(t){try{return Zb.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $P=()=>IP().__FIREBASE_DEFAULTS__,EP=()=>{if(typeof process>"u"||typeof kg>"u")return;const t=kg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},TP=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&e1(t[1]);return e&&JSON.parse(e)},Jh=()=>{try{return wP()||$P()||EP()||TP()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},t1=t=>Jh()?.emulatorHosts?.[t],kP=t=>{const e=t1(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},r1=()=>Jh()?.config,n1=t=>Jh()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function i1(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LP(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[wh(JSON.stringify(r)),wh(JSON.stringify(s)),""].join(".")}const fu={};function RP(){const t={prod:[],emulator:[]};for(const e of Object.keys(fu))fu[e]?t.emulator.push(e):t.prod.push(e);return t}function DP(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Ng=!1;function o1(t,e){if(typeof window>"u"||typeof document>"u"||!xc(window.location.host)||fu[t]===e||fu[t]||Ng)return;fu[t]=e;function r(g){return`__firebase__banner__${g}`}const n="__firebase__banner",o=RP().prod.length>0;function s(){const g=document.getElementById(n);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,f){g.setAttribute("width","24"),g.setAttribute("id",f),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function u(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Ng=!0,s()},g}function h(g,f){g.setAttribute("id",f),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function y(){const g=DP(n),f=r("text"),x=document.getElementById(f)||document.createElement("span"),S=r("learnmore"),P=document.getElementById(S)||document.createElement("a"),$=r("preprendIcon"),U=document.getElementById($)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const se=g.element;l(se),h(P,S);const X=u();c(U,$),se.append(U,x,P,X),document.body.appendChild(se)}o?(x.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",f)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function MP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vi())}function FP(){const t=Jh()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function OP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function BP(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function jP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function VP(){const t=vi();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function qP(){return!FP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function zP(){try{return typeof indexedDB=="object"}catch{return!1}}function UP(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HP="FirebaseError";class ks extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=HP,Object.setPrototypeOf(this,ks.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Wu.prototype.create)}}class Wu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?GP(o,n):"Error",l=`${this.serviceName}: ${s} (${i}).`;return new ks(i,l,n)}}function GP(t,e){return t.replace(WP,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const WP=/\{\$([^}]+)}/g;function YP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function bl(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],s=e[i];if(Lg(o)&&Lg(s)){if(!bl(o,s))return!1}else if(o!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function Lg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function KP(t,e){const r=new JP(t,e);return r.subscribe.bind(r)}class JP{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");QP(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=qp),i.error===void 0&&(i.error=qp),i.complete===void 0&&(i.complete=qp);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function QP(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function qp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(t){return t&&t._delegate?t._delegate:t}class _l{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new NP;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ew(e))try{this.getOrInitializeService({instanceIdentifier:tl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=tl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=tl){return this.instances.has(e)}getOptions(e=tl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,s]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);n===l&&s.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const o=this.instances.get(n);return o&&e(o,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:ZP(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=tl){return this.component?this.component.multipleInstances?e:tl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ZP(t){return t===tl?void 0:t}function ew(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new XP(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mr;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Mr||(Mr={}));const rw={debug:Mr.DEBUG,verbose:Mr.VERBOSE,info:Mr.INFO,warn:Mr.WARN,error:Mr.ERROR,silent:Mr.SILENT},nw=Mr.INFO,iw={[Mr.DEBUG]:"log",[Mr.VERBOSE]:"log",[Mr.INFO]:"info",[Mr.WARN]:"warn",[Mr.ERROR]:"error"},ow=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=iw[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Wm{constructor(e){this.name=e,this._logLevel=nw,this._logHandler=ow,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Mr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?rw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Mr.DEBUG,...e),this._logHandler(this,Mr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Mr.VERBOSE,...e),this._logHandler(this,Mr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Mr.INFO,...e),this._logHandler(this,Mr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Mr.WARN,...e),this._logHandler(this,Mr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Mr.ERROR,...e),this._logHandler(this,Mr.ERROR,...e)}}const sw=(t,e)=>e.some(r=>t instanceof r);let Rg,Dg;function aw(){return Rg||(Rg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function lw(){return Dg||(Dg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const s1=new WeakMap,Jf=new WeakMap,a1=new WeakMap,zp=new WeakMap,Ym=new WeakMap;function cw(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",s)},o=()=>{r(va(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",s)});return e.then(r=>{r instanceof IDBCursor&&s1.set(r,t)}).catch(()=>{}),Ym.set(e,t),e}function uw(t){if(Jf.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",s),t.removeEventListener("abort",s)},o=()=>{r(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",s),t.addEventListener("abort",s)});Jf.set(t,e)}let Qf={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Jf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||a1.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return va(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function dw(t){Qf=t(Qf)}function hw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Up(this),e,...r);return a1.set(n,e.sort?e.sort():[e]),va(n)}:lw().includes(t)?function(...e){return t.apply(Up(this),e),va(s1.get(this))}:function(...e){return va(t.apply(Up(this),e))}}function pw(t){return typeof t=="function"?hw(t):(t instanceof IDBTransaction&&uw(t),sw(t,aw())?new Proxy(t,Qf):t)}function va(t){if(t instanceof IDBRequest)return cw(t);if(zp.has(t))return zp.get(t);const e=pw(t);return e!==t&&(zp.set(t,e),Ym.set(e,t)),e}const Up=t=>Ym.get(t);function fw(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),l=va(s);return n&&s.addEventListener("upgradeneeded",c=>{n(va(s.result),c.oldVersion,c.newVersion,va(s.transaction),c)}),r&&s.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const mw=["get","getKey","getAll","getAllKeys","count"],yw=["put","add","delete","clear"],Hp=new Map;function Mg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Hp.get(e))return Hp.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=yw.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||mw.includes(r)))return;const o=async function(s,...l){const c=this.transaction(s,i?"readwrite":"readonly");let u=c.store;return n&&(u=u.index(l.shift())),(await Promise.all([u[r](...l),i&&c.done]))[0]};return Hp.set(e,o),o}dw(t=>({...t,get:(e,r,n)=>Mg(e,r)||t.get(e,r,n),has:(e,r)=>!!Mg(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(vw(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function vw(t){return t.getComponent()?.type==="VERSION"}const Xf="@firebase/app",Fg="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const As=new Wm("@firebase/app"),bw="@firebase/app-compat",_w="@firebase/analytics-compat",Sw="@firebase/analytics",Pw="@firebase/app-check-compat",ww="@firebase/app-check",xw="@firebase/auth",Aw="@firebase/auth-compat",Cw="@firebase/database",Iw="@firebase/data-connect",$w="@firebase/database-compat",Ew="@firebase/functions",Tw="@firebase/functions-compat",kw="@firebase/installations",Nw="@firebase/installations-compat",Lw="@firebase/messaging",Rw="@firebase/messaging-compat",Dw="@firebase/performance",Mw="@firebase/performance-compat",Fw="@firebase/remote-config",Ow="@firebase/remote-config-compat",Bw="@firebase/storage",jw="@firebase/storage-compat",Vw="@firebase/firestore",qw="@firebase/ai",zw="@firebase/firestore-compat",Uw="firebase",Hw="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zf="[DEFAULT]",Gw={[Xf]:"fire-core",[bw]:"fire-core-compat",[Sw]:"fire-analytics",[_w]:"fire-analytics-compat",[ww]:"fire-app-check",[Pw]:"fire-app-check-compat",[xw]:"fire-auth",[Aw]:"fire-auth-compat",[Cw]:"fire-rtdb",[Iw]:"fire-data-connect",[$w]:"fire-rtdb-compat",[Ew]:"fire-fn",[Tw]:"fire-fn-compat",[kw]:"fire-iid",[Nw]:"fire-iid-compat",[Lw]:"fire-fcm",[Rw]:"fire-fcm-compat",[Dw]:"fire-perf",[Mw]:"fire-perf-compat",[Fw]:"fire-rc",[Ow]:"fire-rc-compat",[Bw]:"fire-gcs",[jw]:"fire-gcs-compat",[Vw]:"fire-fst",[zw]:"fire-fst-compat",[qw]:"fire-vertex","fire-js":"fire-js",[Uw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xh=new Map,Ww=new Map,em=new Map;function Og(t,e){try{t.container.addComponent(e)}catch(r){As.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function yc(t){const e=t.name;if(em.has(e))return As.debug(`There were multiple attempts to register component ${e}.`),!1;em.set(e,t);for(const r of xh.values())Og(r,t);for(const r of Ww.values())Og(r,t);return!0}function Km(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function co(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ba=new Wu("app","Firebase",Yw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new _l("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ba.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ac=Hw;function l1(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Zf,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw ba.create("bad-app-name",{appName:String(i)});if(r||(r=r1()),!r)throw ba.create("no-options");const o=xh.get(i);if(o){if(bl(r,o.options)&&bl(n,o.config))return o;throw ba.create("duplicate-app",{appName:i})}const s=new tw(i);for(const c of em.values())s.addComponent(c);const l=new Kw(r,n,s);return xh.set(i,l),l}function c1(t=Zf){const e=xh.get(t);if(!e&&t===Zf&&r1())return l1();if(!e)throw ba.create("no-app",{appName:t});return e}function _a(t,e,r){let n=Gw[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const s=[`Unable to register library "${n}" with version "${e}":`];i&&s.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&o&&s.push("and"),o&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),As.warn(s.join(" "));return}yc(new _l(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw="firebase-heartbeat-database",Qw=1,Nu="firebase-heartbeat-store";let Gp=null;function u1(){return Gp||(Gp=fw(Jw,Qw,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Nu)}catch(r){console.warn(r)}}}}).catch(t=>{throw ba.create("idb-open",{originalErrorMessage:t.message})})),Gp}async function Xw(t){try{const r=(await u1()).transaction(Nu),n=await r.objectStore(Nu).get(d1(t));return await r.done,n}catch(e){if(e instanceof ks)As.warn(e.message);else{const r=ba.create("idb-get",{originalErrorMessage:e?.message});As.warn(r.message)}}}async function Bg(t,e){try{const n=(await u1()).transaction(Nu,"readwrite");await n.objectStore(Nu).put(e,d1(t)),await n.done}catch(r){if(r instanceof ks)As.warn(r.message);else{const n=ba.create("idb-set",{originalErrorMessage:r?.message});As.warn(n.message)}}}function d1(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw=1024,ex=30;class tx{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new nx(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=jg();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>ex){const i=ix(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){As.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=jg(),{heartbeatsToSend:r,unsentEntries:n}=rx(this._heartbeatsCache.heartbeats),i=wh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return As.warn(e),""}}}function jg(){return new Date().toISOString().substring(0,10)}function rx(t,e=Zw){const r=[];let n=t.slice();for(const i of t){const o=r.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),Vg(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Vg(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class nx{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zP()?UP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Xw(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Bg(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Bg(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Vg(t){return wh(JSON.stringify({version:2,heartbeats:t})).length}function ix(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(t){yc(new _l("platform-logger",e=>new gw(e),"PRIVATE")),yc(new _l("heartbeat",e=>new tx(e),"PRIVATE")),_a(Xf,Fg,t),_a(Xf,Fg,"esm2020"),_a("fire-js","")}ox("");function h1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const sx=h1,p1=new Wu("auth","Firebase",h1());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah=new Wm("@firebase/auth");function ax(t,...e){Ah.logLevel<=Mr.WARN&&Ah.warn(`Auth (${Ac}): ${t}`,...e)}function eh(t,...e){Ah.logLevel<=Mr.ERROR&&Ah.error(`Auth (${Ac}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zo(t,...e){throw Qm(t,...e)}function Io(t,...e){return Qm(t,...e)}function Jm(t,e,r){const n={...sx(),[e]:r};return new Wu("auth","Firebase",n).create(e,{appName:t.name})}function Sa(t){return Jm(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function f1(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Zo(t,"argument-error"),Jm(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Qm(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return p1.create(t,...e)}function br(t,e,...r){if(!t)throw Qm(e,...r)}function _s(t){const e="INTERNAL ASSERTION FAILED: "+t;throw eh(e),new Error(e)}function Cs(t,e){t||_s(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tm(){return typeof self<"u"&&self.location?.href||""}function lx(){return qg()==="http:"||qg()==="https:"}function qg(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cx(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(lx()||BP()||"connection"in navigator)?navigator.onLine:!0}function ux(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,r){this.shortDelay=e,this.longDelay=r,Cs(r>e,"Short delay should be less than long delay!"),this.isMobile=MP()||jP()}get(){return cx()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xm(t,e){Cs(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;_s("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;_s("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;_s("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dx={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],px=new Ku(3e4,6e4);function Zm(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Cc(t,e,r,n,i={}){return y1(t,i,async()=>{let o={},s={};n&&(e==="GET"?s=n:o={body:JSON.stringify(n)});const l=Yu({key:t.config.apiKey,...s}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...o};return OP()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&xc(t.emulatorConfig.host)&&(u.credentials="include"),m1.fetch()(await g1(t,t.config.apiHost,r,l),u)})}async function y1(t,e,r){t._canInitEmulator=!1;const n={...dx,...e};try{const i=new mx(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const s=await o.json();if("needConfirmation"in s)throw Td(t,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const l=o.ok?s.errorMessage:s.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Td(t,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw Td(t,"email-already-in-use",s);if(c==="USER_DISABLED")throw Td(t,"user-disabled",s);const h=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Jm(t,h,u);Zo(t,h)}}catch(i){if(i instanceof ks)throw i;Zo(t,"network-request-failed",{message:String(i)})}}async function fx(t,e,r,n,i={}){const o=await Cc(t,e,r,n,i);return"mfaPendingCredential"in o&&Zo(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function g1(t,e,r,n){const i=`${e}${r}?${n}`,o=t,s=o.config.emulator?Xm(t.config,i):`${t.config.apiScheme}://${i}`;return hx.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s}class mx{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Io(this.auth,"network-request-failed")),px.get())})}}function Td(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Io(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yx(t,e){return Cc(t,"POST","/v1/accounts:delete",e)}async function Ch(t,e){return Cc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function gx(t,e=!1){const r=ei(t),n=await r.getIdToken(e),i=ey(n);br(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:n,authTime:mu(Wp(i.auth_time)),issuedAtTime:mu(Wp(i.iat)),expirationTime:mu(Wp(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Wp(t){return Number(t)*1e3}function ey(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return eh("JWT malformed, contained fewer than 3 sections"),null;try{const i=e1(r);return i?JSON.parse(i):(eh("Failed to decode base64 JWT payload"),null)}catch(i){return eh("Caught error parsing JWT payload as JSON",i?.toString()),null}}function zg(t){const e=ey(t);return br(e,"internal-error"),br(typeof e.exp<"u","internal-error"),br(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lu(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof ks&&vx(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function vx({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=mu(this.lastLoginAt),this.creationTime=mu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ih(t){const e=t.auth,r=await t.getIdToken(),n=await Lu(t,Ch(e,{idToken:r}));br(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const o=i.providerUserInfo?.length?v1(i.providerUserInfo):[],s=Sx(t.providerData,o),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!s?.length,u=l?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new rm(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function _x(t){const e=ei(t);await Ih(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Sx(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function v1(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Px(t,e){const r=await y1(t,{},async()=>{const n=Yu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,s=await g1(t,i,"/v1/token",`key=${o}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:n};return t.emulatorConfig&&xc(t.emulatorConfig.host)&&(c.credentials="include"),m1.fetch()(s,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function wx(t,e){return Cc(t,"POST","/v2/accounts:revokeToken",Zm(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){br(e.idToken,"internal-error"),br(typeof e.idToken<"u","internal-error"),br(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):zg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){br(e.length!==0,"internal-error");const r=zg(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(br(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await Px(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,s=new uc;return n&&(br(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),i&&(br(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(br(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new uc,this.toJSON())}_performRefresh(){return _s("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function na(t,e){br(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ao{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new bx(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new rm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Lu(this,this.stsTokenManager.getToken(this.auth,e));return br(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return gx(this,e)}reload(){return _x(this)}_assign(e){this!==e&&(br(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Ao({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){br(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Ih(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(co(this.auth.app))return Promise.reject(Sa(this.auth));const e=await this.getIdToken();return await Lu(this,yx(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,o=r.phoneNumber??void 0,s=r.photoURL??void 0,l=r.tenantId??void 0,c=r._redirectEventId??void 0,u=r.createdAt??void 0,h=r.lastLoginAt??void 0,{uid:y,emailVerified:g,isAnonymous:f,providerData:x,stsTokenManager:S}=r;br(y&&S,e,"internal-error");const P=uc.fromJSON(this.name,S);br(typeof y=="string",e,"internal-error"),na(n,e.name),na(i,e.name),br(typeof g=="boolean",e,"internal-error"),br(typeof f=="boolean",e,"internal-error"),na(o,e.name),na(s,e.name),na(l,e.name),na(c,e.name),na(u,e.name),na(h,e.name);const $=new Ao({uid:y,auth:e,email:i,emailVerified:g,displayName:n,isAnonymous:f,photoURL:s,phoneNumber:o,tenantId:l,stsTokenManager:P,createdAt:u,lastLoginAt:h});return x&&Array.isArray(x)&&($.providerData=x.map(U=>({...U}))),c&&($._redirectEventId=c),$}static async _fromIdTokenResponse(e,r,n=!1){const i=new uc;i.updateFromServerResponse(r);const o=new Ao({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Ih(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];br(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?v1(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!o?.length,l=new uc;l.updateFromIdToken(n);const c=new Ao({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:s}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new rm(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ug=new Map;function Ss(t){Cs(t instanceof Function,"Expected a class definition");let e=Ug.get(t);return e?(Cs(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Ug.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}b1.type="NONE";const Hg=b1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(t,e,r){return`firebase:${t}:${e}:${r}`}class dc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=th(this.userKey,i.apiKey,o),this.fullPersistenceKey=th("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Ch(this.auth,{idToken:e}).catch(()=>{});return r?Ao._fromGetAccountInfoResponse(this.auth,r,e):null}return Ao._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new dc(Ss(Hg),e,n);const i=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let o=i[0]||Ss(Hg);const s=th(n,e.config.apiKey,e.name);let l=null;for(const u of r)try{const h=await u._get(s);if(h){let y;if(typeof h=="string"){const g=await Ch(e,{idToken:h}).catch(()=>{});if(!g)break;y=await Ao._fromGetAccountInfoResponse(e,g,h)}else y=Ao._fromJSON(e,h);u!==o&&(l=y),o=u;break}}catch{}const c=i.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new dc(o,e,n):(o=c[0],l&&await o._set(s,l.toJSON()),await Promise.all(r.map(async u=>{if(u!==o)try{await u._remove(s)}catch{}})),new dc(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(w1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(A1(e))return"Blackberry";if(C1(e))return"Webos";if(S1(e))return"Safari";if((e.includes("chrome/")||P1(e))&&!e.includes("edge/"))return"Chrome";if(x1(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function _1(t=vi()){return/firefox\//i.test(t)}function S1(t=vi()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function P1(t=vi()){return/crios\//i.test(t)}function w1(t=vi()){return/iemobile/i.test(t)}function x1(t=vi()){return/android/i.test(t)}function A1(t=vi()){return/blackberry/i.test(t)}function C1(t=vi()){return/webos/i.test(t)}function ty(t=vi()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function xx(t=vi()){return ty(t)&&!!window.navigator?.standalone}function Ax(){return VP()&&document.documentMode===10}function I1(t=vi()){return ty(t)||x1(t)||C1(t)||A1(t)||/windows phone/i.test(t)||w1(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $1(t,e=[]){let r;switch(t){case"Browser":r=Gg(vi());break;case"Worker":r=`${Gg(vi())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ac}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((s,l)=>{try{const c=e(o);s(c)}catch(c){l(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ix(t,e={}){return Cc(t,"GET","/v2/passwordPolicy",Zm(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x=6;class Ex{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??$x,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tx{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Wg(this),this.idTokenSubscription=new Wg(this),this.beforeStateQueue=new Cx(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=p1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ss(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await dc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Ch(this,{idToken:e}),n=await Ao._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(co(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,s=n?._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===s)&&l?.user&&(n=l.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return br(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Ih(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ux()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(co(this.app))return Promise.reject(Sa(this));const r=e?ei(e):null;return r&&br(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&br(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return co(this.app)?Promise.reject(Sa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return co(this.app)?Promise.reject(Sa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ss(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Ix(this),r=new Ex(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Wu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await wx(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ss(e)||this._popupRedirectResolver;br(r,this,"argument-error"),this.redirectPersistenceManager=await dc.create(this,[Ss(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let s=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(br(l,this,"internal-error"),l.then(()=>{s||o(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,i);return()=>{s=!0,c()}}else{const c=e.addObserver(r);return()=>{s=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return br(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(co(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&ax(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Al(t){return ei(t)}class Wg{constructor(e){this.auth=e,this.observer=null,this.addObserver=KP(r=>this.observer=r)}get next(){return br(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ry={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function kx(t){ry=t}function Nx(t){return ry.loadJS(t)}function Lx(){return ry.gapiScript}function Rx(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(t,e){const r=Km(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(bl(o,e??{}))return i;Zo(i,"already-initialized")}return r.initialize({options:e})}function Mx(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Ss);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function Fx(t,e,r){const n=Al(t);br(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=E1(e),{host:s,port:l}=Ox(e),c=l===null?"":`:${l}`,u={url:`${o}//${s}${c}/`},h=Object.freeze({host:s,port:l,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){br(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),br(bl(u,n.config.emulator)&&bl(h,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=u,n.emulatorConfig=h,n.settings.appVerificationDisabledForTesting=!0,xc(s)?(i1(`${o}//${s}${c}`),o1("Auth",!0)):Bx()}function E1(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Ox(t){const e=E1(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:Yg(n.substr(o.length+1))}}else{const[o,s]=n.split(":");return{host:o,port:Yg(s)}}}function Yg(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Bx(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return _s("not implemented")}_getIdTokenResponse(e){return _s("not implemented")}_linkToIdToken(e,r){return _s("not implemented")}_getReauthenticationResolver(e){return _s("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hc(t,e){return fx(t,"POST","/v1/accounts:signInWithIdp",Zm(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jx="http://localhost";class Sl extends T1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Sl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Zo("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...o}=r;if(!n||!i)return null;const s=new Sl(n,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){const r=this.buildRequest();return hc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,hc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,hc(e,r)}buildRequest(){const e={requestUri:jx,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Yu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju extends Qh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da extends Ju{constructor(){super("facebook.com")}static credential(e){return Sl._fromParams({providerId:da.PROVIDER_ID,signInMethod:da.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return da.credentialFromTaggedObject(e)}static credentialFromError(e){return da.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return da.credential(e.oauthAccessToken)}catch{return null}}}da.FACEBOOK_SIGN_IN_METHOD="facebook.com";da.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo extends Ju{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Sl._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Uo.credential(r,n)}catch{return null}}}Uo.GOOGLE_SIGN_IN_METHOD="google.com";Uo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha extends Ju{constructor(){super("github.com")}static credential(e){return Sl._fromParams({providerId:ha.PROVIDER_ID,signInMethod:ha.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ha.credentialFromTaggedObject(e)}static credentialFromError(e){return ha.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ha.credential(e.oauthAccessToken)}catch{return null}}}ha.GITHUB_SIGN_IN_METHOD="github.com";ha.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa extends Ju{constructor(){super("twitter.com")}static credential(e,r){return Sl._fromParams({providerId:pa.PROVIDER_ID,signInMethod:pa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return pa.credentialFromTaggedObject(e)}static credentialFromError(e){return pa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return pa.credential(r,n)}catch{return null}}}pa.TWITTER_SIGN_IN_METHOD="twitter.com";pa.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await Ao._fromIdTokenResponse(e,n,i),s=Kg(n);return new gc({user:o,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=Kg(n);return new gc({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function Kg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h extends ks{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,$h.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new $h(e,r,n,i)}}function k1(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?$h._fromErrorAndOperation(t,o,e,n):o})}async function Vx(t,e,r=!1){const n=await Lu(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return gc._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qx(t,e,r=!1){const{auth:n}=t;if(co(n.app))return Promise.reject(Sa(n));const i="reauthenticate";try{const o=await Lu(t,k1(n,i,e,t),r);br(o.idToken,n,"internal-error");const s=ey(o.idToken);br(s,n,"internal-error");const{sub:l}=s;return br(t.uid===l,n,"user-mismatch"),gc._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&Zo(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N1(t,e,r=!1){if(co(t.app))return Promise.reject(Sa(t));const n="signIn",i=await k1(t,n,e),o=await gc._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function zx(t,e){return N1(Al(t),e)}function Ux(t,e,r,n){return ei(t).onIdTokenChanged(e,r,n)}function Hx(t,e,r){return ei(t).beforeAuthStateChanged(e,r)}function Gx(t,e,r,n){return ei(t).onAuthStateChanged(e,r,n)}function Wx(t){return ei(t).signOut()}const Eh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Eh,"1"),this.storage.removeItem(Eh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yx=1e3,Kx=10;class R1 extends L1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=I1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,l,c)=>{this.notifyListeners(s,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},o=this.storage.getItem(n);Ax()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Kx):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},Yx)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}R1.type="LOCAL";const Jx=R1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1 extends L1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}D1.type="SESSION";const M1=D1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qx(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Xh(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,s=this.handlersMap[i];if(!s?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const l=Array.from(s).map(async u=>u(r.origin,o)),c=await Qx(l);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Xh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ny(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((l,c)=>{const u=ny("",20);i.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(y){const g=y;if(g.data.eventId===u)switch(g.data.status){case"ack":clearTimeout(h),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),l(g.data.response);break;default:clearTimeout(h),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:u,data:r},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Go(){return window}function Zx(t){Go().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(){return typeof Go().WorkerGlobalScope<"u"&&typeof Go().importScripts=="function"}async function eA(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function tA(){return navigator?.serviceWorker?.controller||null}function rA(){return F1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1="firebaseLocalStorageDb",nA=1,Th="firebaseLocalStorage",B1="fbase_key";class Qu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Zh(t,e){return t.transaction([Th],e?"readwrite":"readonly").objectStore(Th)}function iA(){const t=indexedDB.deleteDatabase(O1);return new Qu(t).toPromise()}function nm(){const t=indexedDB.open(O1,nA);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Th,{keyPath:B1})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Th)?e(n):(n.close(),await iA(),e(await nm()))})})}async function Jg(t,e,r){const n=Zh(t,!0).put({[B1]:e,value:r});return new Qu(n).toPromise()}async function oA(t,e){const r=Zh(t,!1).get(e),n=await new Qu(r).toPromise();return n===void 0?null:n.value}function Qg(t,e){const r=Zh(t,!0).delete(e);return new Qu(r).toPromise()}const sA=800,aA=3;class j1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await nm(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>aA)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return F1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Xh._getInstance(rA()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await eA(),!this.activeServiceWorker)return;this.sender=new Xx(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||tA()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await nm();return await Jg(e,Eh,"1"),await Qg(e,Eh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Jg(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>oA(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Qg(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Zh(i,!1).getAll();return new Qu(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),sA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}j1.type="LOCAL";const lA=j1;new Ku(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iy(t,e){return e?Ss(e):(br(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy extends T1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return hc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return hc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return hc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function cA(t){return N1(t.auth,new oy(t),t.bypassAuthState)}function uA(t){const{auth:e,user:r}=t;return br(r,e,"internal-error"),qx(r,new oy(t),t.bypassAuthState)}async function dA(t){const{auth:e,user:r}=t;return br(r,e,"internal-error"),Vx(r,new oy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:s,type:l}=e;if(s){this.reject(s);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return cA;case"linkViaPopup":case"linkViaRedirect":return dA;case"reauthViaPopup":case"reauthViaRedirect":return uA;default:Zo(this.auth,"internal-error")}}resolve(e){Cs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Cs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA=new Ku(2e3,1e4);async function pA(t,e,r){if(co(t.app))return Promise.reject(Io(t,"operation-not-supported-in-this-environment"));const n=Al(t);f1(t,e,Qh);const i=iy(n,r);return new ll(n,"signInViaPopup",e,i).executeNotNull()}class ll extends V1{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,ll.currentPopupAction&&ll.currentPopupAction.cancel(),ll.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return br(e,this.auth,"internal-error"),e}async onExecution(){Cs(this.filter.length===1,"Popup operations only handle one event");const e=ny();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Io(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Io(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ll.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Io(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,hA.get())};e()}}ll.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA="pendingRedirect",rh=new Map;class mA extends V1{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=rh.get(this.auth._key());if(!e){try{const n=await yA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}rh.set(this.auth._key(),e)}return this.bypassAuthState||rh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function yA(t,e){const r=z1(e),n=q1(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}async function gA(t,e){return q1(t)._set(z1(e),"true")}function vA(t,e){rh.set(t._key(),e)}function q1(t){return Ss(t._redirectPersistence)}function z1(t){return th(fA,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bA(t,e,r){return _A(t,e,r)}async function _A(t,e,r){if(co(t.app))return Promise.reject(Sa(t));const n=Al(t);f1(t,e,Qh),await n._initializationPromise;const i=iy(n,r);return await gA(i,n),i._openRedirect(n,e,"signInViaRedirect")}async function SA(t,e){return await Al(t)._initializationPromise,U1(t,e,!1)}async function U1(t,e,r=!1){if(co(t.app))return Promise.reject(Sa(t));const n=Al(t),i=iy(n,e),s=await new mA(n,i,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PA=10*60*1e3;class wA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!xA(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!H1(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Io(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=PA&&this.cachedEventUids.clear(),this.cachedEventUids.has(Xg(e))}saveEventToCache(e){this.cachedEventUids.add(Xg(e)),this.lastProcessedEventTime=Date.now()}}function Xg(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function H1({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function xA(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return H1(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AA(t,e={}){return Cc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,IA=/^https?/;async function $A(t){if(t.config.emulator)return;const{authorizedDomains:e}=await AA(t);for(const r of e)try{if(EA(r))return}catch{}Zo(t,"unauthorized-domain")}function EA(t){const e=tm(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!IA.test(r))return!1;if(CA.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA=new Ku(3e4,6e4);function Zg(){const t=Go().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function kA(t){return new Promise((e,r)=>{function n(){Zg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Zg(),r(Io(t,"network-request-failed"))},timeout:TA.get()})}if(Go().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Go().gapi?.load)n();else{const i=Rx("iframefcb");return Go()[i]=()=>{gapi.load?n():r(Io(t,"network-request-failed"))},Nx(`${Lx()}?onload=${i}`).catch(o=>r(o))}}).catch(e=>{throw nh=null,e})}let nh=null;function NA(t){return nh=nh||kA(t),nh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LA=new Ku(5e3,15e3),RA="__/auth/iframe",DA="emulator/auth/iframe",MA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},FA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function OA(t){const e=t.config;br(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Xm(e,DA):`https://${t.config.authDomain}/${RA}`,n={apiKey:e.apiKey,appName:t.name,v:Ac},i=FA.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${Yu(n).slice(1)}`}async function BA(t){const e=await NA(t),r=Go().gapi;return br(r,t,"internal-error"),e.open({where:document.body,url:OA(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:MA,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const s=Io(t,"network-request-failed"),l=Go().setTimeout(()=>{o(s)},LA.get());function c(){Go().clearTimeout(l),i(n)}n.ping(c).then(c,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},VA=500,qA=600,zA="_blank",UA="http://localhost";class ev{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function HA(t,e,r,n=VA,i=qA){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const c={...jA,width:n.toString(),height:i.toString(),top:o,left:s},u=vi().toLowerCase();r&&(l=P1(u)?zA:r),_1(u)&&(e=e||UA,c.scrollbars="yes");const h=Object.entries(c).reduce((g,[f,x])=>`${g}${f}=${x},`,"");if(xx(u)&&l!=="_self")return GA(e||"",l),new ev(null);const y=window.open(e||"",l,h);br(y,t,"popup-blocked");try{y.focus()}catch{}return new ev(y)}function GA(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WA="__/auth/handler",YA="emulator/auth/handler",KA=encodeURIComponent("fac");async function tv(t,e,r,n,i,o){br(t.config.authDomain,t,"auth-domain-config-required"),br(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Ac,eventId:i};if(e instanceof Qh){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",YP(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,y]of Object.entries({}))s[h]=y}if(e instanceof Ju){const h=e.getScopes().filter(y=>y!=="");h.length>0&&(s.scopes=h.join(","))}t.tenantId&&(s.tid=t.tenantId);const l=s;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const c=await t._getAppCheckToken(),u=c?`#${KA}=${encodeURIComponent(c)}`:"";return`${JA(t)}?${Yu(l).slice(1)}${u}`}function JA({config:t}){return t.emulator?Xm(t,YA):`https://${t.authDomain}/${WA}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp="webStorageSupport";class QA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=M1,this._completeRedirectFn=U1,this._overrideRedirectResult=vA}async _openPopup(e,r,n,i){Cs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await tv(e,r,n,tm(),i);return HA(e,o,ny())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await tv(e,r,n,tm(),i);return Zx(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(Cs(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await BA(e),n=new wA(e);return r.register("authEvent",i=>(br(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Yp,{type:Yp},i=>{const o=i?.[0]?.[Yp];o!==void 0&&r(!!o),Zo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=$A(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return I1()||S1()||ty()}}const XA=QA;var rv="@firebase/auth",nv="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){br(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function tC(t){yc(new _l("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:l}=n.options;br(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:s,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$1(t)},u=new Tx(n,i,o,c);return Mx(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),yc(new _l("auth-internal",e=>{const r=Al(e.getProvider("auth").getImmediate());return(n=>new ZA(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),_a(rv,nv,eC(t)),_a(rv,nv,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=5*60,nC=n1("authIdTokenMaxAge")||rC;let iv=null;const iC=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>nC)return;const i=r?.token;iv!==i&&(iv=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function oC(t=c1()){const e=Km(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Dx(t,{popupRedirectResolver:XA,persistence:[lA,Jx,M1]}),n=n1("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const s=iC(o.toString());Hx(r,s,()=>s(r.currentUser)),Ux(r,l=>s(l))}}const i=t1("auth");return i&&Fx(r,`http://${i}`),r}function sC(){return document.getElementsByTagName("head")?.[0]??document}kx({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Io("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",sC().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});tC("Browser");var aC="firebase",lC="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_a(aC,lC,"app");var ov=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Pa,G1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,C){function T(){}T.prototype=C.prototype,E.D=C.prototype,E.prototype=new T,E.prototype.constructor=E,E.C=function(j,b,w){for(var _=Array(arguments.length-2),W=2;W<arguments.length;W++)_[W-2]=arguments[W];return C.prototype[b].apply(j,_)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,C,T){T||(T=0);var j=Array(16);if(typeof C=="string")for(var b=0;16>b;++b)j[b]=C.charCodeAt(T++)|C.charCodeAt(T++)<<8|C.charCodeAt(T++)<<16|C.charCodeAt(T++)<<24;else for(b=0;16>b;++b)j[b]=C[T++]|C[T++]<<8|C[T++]<<16|C[T++]<<24;C=E.g[0],T=E.g[1],b=E.g[2];var w=E.g[3],_=C+(w^T&(b^w))+j[0]+3614090360&4294967295;C=T+(_<<7&4294967295|_>>>25),_=w+(b^C&(T^b))+j[1]+3905402710&4294967295,w=C+(_<<12&4294967295|_>>>20),_=b+(T^w&(C^T))+j[2]+606105819&4294967295,b=w+(_<<17&4294967295|_>>>15),_=T+(C^b&(w^C))+j[3]+3250441966&4294967295,T=b+(_<<22&4294967295|_>>>10),_=C+(w^T&(b^w))+j[4]+4118548399&4294967295,C=T+(_<<7&4294967295|_>>>25),_=w+(b^C&(T^b))+j[5]+1200080426&4294967295,w=C+(_<<12&4294967295|_>>>20),_=b+(T^w&(C^T))+j[6]+2821735955&4294967295,b=w+(_<<17&4294967295|_>>>15),_=T+(C^b&(w^C))+j[7]+4249261313&4294967295,T=b+(_<<22&4294967295|_>>>10),_=C+(w^T&(b^w))+j[8]+1770035416&4294967295,C=T+(_<<7&4294967295|_>>>25),_=w+(b^C&(T^b))+j[9]+2336552879&4294967295,w=C+(_<<12&4294967295|_>>>20),_=b+(T^w&(C^T))+j[10]+4294925233&4294967295,b=w+(_<<17&4294967295|_>>>15),_=T+(C^b&(w^C))+j[11]+2304563134&4294967295,T=b+(_<<22&4294967295|_>>>10),_=C+(w^T&(b^w))+j[12]+1804603682&4294967295,C=T+(_<<7&4294967295|_>>>25),_=w+(b^C&(T^b))+j[13]+4254626195&4294967295,w=C+(_<<12&4294967295|_>>>20),_=b+(T^w&(C^T))+j[14]+2792965006&4294967295,b=w+(_<<17&4294967295|_>>>15),_=T+(C^b&(w^C))+j[15]+1236535329&4294967295,T=b+(_<<22&4294967295|_>>>10),_=C+(b^w&(T^b))+j[1]+4129170786&4294967295,C=T+(_<<5&4294967295|_>>>27),_=w+(T^b&(C^T))+j[6]+3225465664&4294967295,w=C+(_<<9&4294967295|_>>>23),_=b+(C^T&(w^C))+j[11]+643717713&4294967295,b=w+(_<<14&4294967295|_>>>18),_=T+(w^C&(b^w))+j[0]+3921069994&4294967295,T=b+(_<<20&4294967295|_>>>12),_=C+(b^w&(T^b))+j[5]+3593408605&4294967295,C=T+(_<<5&4294967295|_>>>27),_=w+(T^b&(C^T))+j[10]+38016083&4294967295,w=C+(_<<9&4294967295|_>>>23),_=b+(C^T&(w^C))+j[15]+3634488961&4294967295,b=w+(_<<14&4294967295|_>>>18),_=T+(w^C&(b^w))+j[4]+3889429448&4294967295,T=b+(_<<20&4294967295|_>>>12),_=C+(b^w&(T^b))+j[9]+568446438&4294967295,C=T+(_<<5&4294967295|_>>>27),_=w+(T^b&(C^T))+j[14]+3275163606&4294967295,w=C+(_<<9&4294967295|_>>>23),_=b+(C^T&(w^C))+j[3]+4107603335&4294967295,b=w+(_<<14&4294967295|_>>>18),_=T+(w^C&(b^w))+j[8]+1163531501&4294967295,T=b+(_<<20&4294967295|_>>>12),_=C+(b^w&(T^b))+j[13]+2850285829&4294967295,C=T+(_<<5&4294967295|_>>>27),_=w+(T^b&(C^T))+j[2]+4243563512&4294967295,w=C+(_<<9&4294967295|_>>>23),_=b+(C^T&(w^C))+j[7]+1735328473&4294967295,b=w+(_<<14&4294967295|_>>>18),_=T+(w^C&(b^w))+j[12]+2368359562&4294967295,T=b+(_<<20&4294967295|_>>>12),_=C+(T^b^w)+j[5]+4294588738&4294967295,C=T+(_<<4&4294967295|_>>>28),_=w+(C^T^b)+j[8]+2272392833&4294967295,w=C+(_<<11&4294967295|_>>>21),_=b+(w^C^T)+j[11]+1839030562&4294967295,b=w+(_<<16&4294967295|_>>>16),_=T+(b^w^C)+j[14]+4259657740&4294967295,T=b+(_<<23&4294967295|_>>>9),_=C+(T^b^w)+j[1]+2763975236&4294967295,C=T+(_<<4&4294967295|_>>>28),_=w+(C^T^b)+j[4]+1272893353&4294967295,w=C+(_<<11&4294967295|_>>>21),_=b+(w^C^T)+j[7]+4139469664&4294967295,b=w+(_<<16&4294967295|_>>>16),_=T+(b^w^C)+j[10]+3200236656&4294967295,T=b+(_<<23&4294967295|_>>>9),_=C+(T^b^w)+j[13]+681279174&4294967295,C=T+(_<<4&4294967295|_>>>28),_=w+(C^T^b)+j[0]+3936430074&4294967295,w=C+(_<<11&4294967295|_>>>21),_=b+(w^C^T)+j[3]+3572445317&4294967295,b=w+(_<<16&4294967295|_>>>16),_=T+(b^w^C)+j[6]+76029189&4294967295,T=b+(_<<23&4294967295|_>>>9),_=C+(T^b^w)+j[9]+3654602809&4294967295,C=T+(_<<4&4294967295|_>>>28),_=w+(C^T^b)+j[12]+3873151461&4294967295,w=C+(_<<11&4294967295|_>>>21),_=b+(w^C^T)+j[15]+530742520&4294967295,b=w+(_<<16&4294967295|_>>>16),_=T+(b^w^C)+j[2]+3299628645&4294967295,T=b+(_<<23&4294967295|_>>>9),_=C+(b^(T|~w))+j[0]+4096336452&4294967295,C=T+(_<<6&4294967295|_>>>26),_=w+(T^(C|~b))+j[7]+1126891415&4294967295,w=C+(_<<10&4294967295|_>>>22),_=b+(C^(w|~T))+j[14]+2878612391&4294967295,b=w+(_<<15&4294967295|_>>>17),_=T+(w^(b|~C))+j[5]+4237533241&4294967295,T=b+(_<<21&4294967295|_>>>11),_=C+(b^(T|~w))+j[12]+1700485571&4294967295,C=T+(_<<6&4294967295|_>>>26),_=w+(T^(C|~b))+j[3]+2399980690&4294967295,w=C+(_<<10&4294967295|_>>>22),_=b+(C^(w|~T))+j[10]+4293915773&4294967295,b=w+(_<<15&4294967295|_>>>17),_=T+(w^(b|~C))+j[1]+2240044497&4294967295,T=b+(_<<21&4294967295|_>>>11),_=C+(b^(T|~w))+j[8]+1873313359&4294967295,C=T+(_<<6&4294967295|_>>>26),_=w+(T^(C|~b))+j[15]+4264355552&4294967295,w=C+(_<<10&4294967295|_>>>22),_=b+(C^(w|~T))+j[6]+2734768916&4294967295,b=w+(_<<15&4294967295|_>>>17),_=T+(w^(b|~C))+j[13]+1309151649&4294967295,T=b+(_<<21&4294967295|_>>>11),_=C+(b^(T|~w))+j[4]+4149444226&4294967295,C=T+(_<<6&4294967295|_>>>26),_=w+(T^(C|~b))+j[11]+3174756917&4294967295,w=C+(_<<10&4294967295|_>>>22),_=b+(C^(w|~T))+j[2]+718787259&4294967295,b=w+(_<<15&4294967295|_>>>17),_=T+(w^(b|~C))+j[9]+3951481745&4294967295,E.g[0]=E.g[0]+C&4294967295,E.g[1]=E.g[1]+(b+(_<<21&4294967295|_>>>11))&4294967295,E.g[2]=E.g[2]+b&4294967295,E.g[3]=E.g[3]+w&4294967295}n.prototype.u=function(E,C){C===void 0&&(C=E.length);for(var T=C-this.blockSize,j=this.B,b=this.h,w=0;w<C;){if(b==0)for(;w<=T;)i(this,E,w),w+=this.blockSize;if(typeof E=="string"){for(;w<C;)if(j[b++]=E.charCodeAt(w++),b==this.blockSize){i(this,j),b=0;break}}else for(;w<C;)if(j[b++]=E[w++],b==this.blockSize){i(this,j),b=0;break}}this.h=b,this.o+=C},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var C=1;C<E.length-8;++C)E[C]=0;var T=8*this.o;for(C=E.length-8;C<E.length;++C)E[C]=T&255,T/=256;for(this.u(E),E=Array(16),C=T=0;4>C;++C)for(var j=0;32>j;j+=8)E[T++]=this.g[C]>>>j&255;return E};function o(E,C){var T=l;return Object.prototype.hasOwnProperty.call(T,E)?T[E]:T[E]=C(E)}function s(E,C){this.h=C;for(var T=[],j=!0,b=E.length-1;0<=b;b--){var w=E[b]|0;j&&w==C||(T[b]=w,j=!1)}this.g=T}var l={};function c(E){return-128<=E&&128>E?o(E,function(C){return new s([C|0],0>C?-1:0)}):new s([E|0],0>E?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return y;if(0>E)return P(u(-E));for(var C=[],T=1,j=0;E>=T;j++)C[j]=E/T|0,T*=4294967296;return new s(C,0)}function h(E,C){if(E.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(E.charAt(0)=="-")return P(h(E.substring(1),C));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=u(Math.pow(C,8)),j=y,b=0;b<E.length;b+=8){var w=Math.min(8,E.length-b),_=parseInt(E.substring(b,b+w),C);8>w?(w=u(Math.pow(C,w)),j=j.j(w).add(u(_))):(j=j.j(T),j=j.add(u(_)))}return j}var y=c(0),g=c(1),f=c(16777216);t=s.prototype,t.m=function(){if(S(this))return-P(this).m();for(var E=0,C=1,T=0;T<this.g.length;T++){var j=this.i(T);E+=(0<=j?j:4294967296+j)*C,C*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(x(this))return"0";if(S(this))return"-"+P(this).toString(E);for(var C=u(Math.pow(E,6)),T=this,j="";;){var b=X(T,C).g;T=$(T,b.j(C));var w=((0<T.g.length?T.g[0]:T.h)>>>0).toString(E);if(T=b,x(T))return w+j;for(;6>w.length;)w="0"+w;j=w+j}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function x(E){if(E.h!=0)return!1;for(var C=0;C<E.g.length;C++)if(E.g[C]!=0)return!1;return!0}function S(E){return E.h==-1}t.l=function(E){return E=$(this,E),S(E)?-1:x(E)?0:1};function P(E){for(var C=E.g.length,T=[],j=0;j<C;j++)T[j]=~E.g[j];return new s(T,~E.h).add(g)}t.abs=function(){return S(this)?P(this):this},t.add=function(E){for(var C=Math.max(this.g.length,E.g.length),T=[],j=0,b=0;b<=C;b++){var w=j+(this.i(b)&65535)+(E.i(b)&65535),_=(w>>>16)+(this.i(b)>>>16)+(E.i(b)>>>16);j=_>>>16,w&=65535,_&=65535,T[b]=_<<16|w}return new s(T,T[T.length-1]&-2147483648?-1:0)};function $(E,C){return E.add(P(C))}t.j=function(E){if(x(this)||x(E))return y;if(S(this))return S(E)?P(this).j(P(E)):P(P(this).j(E));if(S(E))return P(this.j(P(E)));if(0>this.l(f)&&0>E.l(f))return u(this.m()*E.m());for(var C=this.g.length+E.g.length,T=[],j=0;j<2*C;j++)T[j]=0;for(j=0;j<this.g.length;j++)for(var b=0;b<E.g.length;b++){var w=this.i(j)>>>16,_=this.i(j)&65535,W=E.i(b)>>>16,K=E.i(b)&65535;T[2*j+2*b]+=_*K,U(T,2*j+2*b),T[2*j+2*b+1]+=w*K,U(T,2*j+2*b+1),T[2*j+2*b+1]+=_*W,U(T,2*j+2*b+1),T[2*j+2*b+2]+=w*W,U(T,2*j+2*b+2)}for(j=0;j<C;j++)T[j]=T[2*j+1]<<16|T[2*j];for(j=C;j<2*C;j++)T[j]=0;return new s(T,0)};function U(E,C){for(;(E[C]&65535)!=E[C];)E[C+1]+=E[C]>>>16,E[C]&=65535,C++}function se(E,C){this.g=E,this.h=C}function X(E,C){if(x(C))throw Error("division by zero");if(x(E))return new se(y,y);if(S(E))return C=X(P(E),C),new se(P(C.g),P(C.h));if(S(C))return C=X(E,P(C)),new se(P(C.g),C.h);if(30<E.g.length){if(S(E)||S(C))throw Error("slowDivide_ only works with positive integers.");for(var T=g,j=C;0>=j.l(E);)T=Z(T),j=Z(j);var b=re(T,1),w=re(j,1);for(j=re(j,2),T=re(T,2);!x(j);){var _=w.add(j);0>=_.l(E)&&(b=b.add(T),w=_),j=re(j,1),T=re(T,1)}return C=$(E,b.j(C)),new se(b,C)}for(b=y;0<=E.l(C);){for(T=Math.max(1,Math.floor(E.m()/C.m())),j=Math.ceil(Math.log(T)/Math.LN2),j=48>=j?1:Math.pow(2,j-48),w=u(T),_=w.j(C);S(_)||0<_.l(E);)T-=j,w=u(T),_=w.j(C);x(w)&&(w=g),b=b.add(w),E=$(E,_)}return new se(b,E)}t.A=function(E){return X(this,E).h},t.and=function(E){for(var C=Math.max(this.g.length,E.g.length),T=[],j=0;j<C;j++)T[j]=this.i(j)&E.i(j);return new s(T,this.h&E.h)},t.or=function(E){for(var C=Math.max(this.g.length,E.g.length),T=[],j=0;j<C;j++)T[j]=this.i(j)|E.i(j);return new s(T,this.h|E.h)},t.xor=function(E){for(var C=Math.max(this.g.length,E.g.length),T=[],j=0;j<C;j++)T[j]=this.i(j)^E.i(j);return new s(T,this.h^E.h)};function Z(E){for(var C=E.g.length+1,T=[],j=0;j<C;j++)T[j]=E.i(j)<<1|E.i(j-1)>>>31;return new s(T,E.h)}function re(E,C){var T=C>>5;C%=32;for(var j=E.g.length-T,b=[],w=0;w<j;w++)b[w]=0<C?E.i(w+T)>>>C|E.i(w+T+1)<<32-C:E.i(w+T);return new s(b,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,G1=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=u,s.fromString=h,Pa=s}).apply(typeof ov<"u"?ov:typeof self<"u"?self:typeof window<"u"?window:{});var kd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var W1,au,Y1,ih,im,K1,J1,Q1;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,B,ae){return p==Array.prototype||p==Object.prototype||(p[B]=ae.value),p};function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof kd=="object"&&kd];for(var B=0;B<p.length;++B){var ae=p[B];if(ae&&ae.Math==Math)return ae}throw Error("Cannot find global object")}var n=r(this);function i(p,B){if(B)e:{var ae=n;p=p.split(".");for(var Pe=0;Pe<p.length-1;Pe++){var qe=p[Pe];if(!(qe in ae))break e;ae=ae[qe]}p=p[p.length-1],Pe=ae[p],B=B(Pe),B!=Pe&&B!=null&&e(ae,p,{configurable:!0,writable:!0,value:B})}}function o(p,B){p instanceof String&&(p+="");var ae=0,Pe=!1,qe={next:function(){if(!Pe&&ae<p.length){var et=ae++;return{value:B(et,p[et]),done:!1}}return Pe=!0,{done:!0,value:void 0}}};return qe[Symbol.iterator]=function(){return qe},qe}i("Array.prototype.values",function(p){return p||function(){return o(this,function(B,ae){return ae})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},l=this||self;function c(p){var B=typeof p;return B=B!="object"?B:p?Array.isArray(p)?"array":B:"null",B=="array"||B=="object"&&typeof p.length=="number"}function u(p){var B=typeof p;return B=="object"&&p!=null||B=="function"}function h(p,B,ae){return p.call.apply(p.bind,arguments)}function y(p,B,ae){if(!p)throw Error();if(2<arguments.length){var Pe=Array.prototype.slice.call(arguments,2);return function(){var qe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(qe,Pe),p.apply(B,qe)}}return function(){return p.apply(B,arguments)}}function g(p,B,ae){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:y,g.apply(null,arguments)}function f(p,B){var ae=Array.prototype.slice.call(arguments,1);return function(){var Pe=ae.slice();return Pe.push.apply(Pe,arguments),p.apply(this,Pe)}}function x(p,B){function ae(){}ae.prototype=B.prototype,p.aa=B.prototype,p.prototype=new ae,p.prototype.constructor=p,p.Qb=function(Pe,qe,et){for(var At=Array(arguments.length-2),Pr=2;Pr<arguments.length;Pr++)At[Pr-2]=arguments[Pr];return B.prototype[qe].apply(Pe,At)}}function S(p){const B=p.length;if(0<B){const ae=Array(B);for(let Pe=0;Pe<B;Pe++)ae[Pe]=p[Pe];return ae}return[]}function P(p,B){for(let ae=1;ae<arguments.length;ae++){const Pe=arguments[ae];if(c(Pe)){const qe=p.length||0,et=Pe.length||0;p.length=qe+et;for(let At=0;At<et;At++)p[qe+At]=Pe[At]}else p.push(Pe)}}class ${constructor(B,ae){this.i=B,this.j=ae,this.h=0,this.g=null}get(){let B;return 0<this.h?(this.h--,B=this.g,this.g=B.next,B.next=null):B=this.i(),B}}function U(p){return/^[\s\xa0]*$/.test(p)}function se(){var p=l.navigator;return p&&(p=p.userAgent)?p:""}function X(p){return X[" "](p),p}X[" "]=function(){};var Z=se().indexOf("Gecko")!=-1&&!(se().toLowerCase().indexOf("webkit")!=-1&&se().indexOf("Edge")==-1)&&!(se().indexOf("Trident")!=-1||se().indexOf("MSIE")!=-1)&&se().indexOf("Edge")==-1;function re(p,B,ae){for(const Pe in p)B.call(ae,p[Pe],Pe,p)}function E(p,B){for(const ae in p)B.call(void 0,p[ae],ae,p)}function C(p){const B={};for(const ae in p)B[ae]=p[ae];return B}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(p,B){let ae,Pe;for(let qe=1;qe<arguments.length;qe++){Pe=arguments[qe];for(ae in Pe)p[ae]=Pe[ae];for(let et=0;et<T.length;et++)ae=T[et],Object.prototype.hasOwnProperty.call(Pe,ae)&&(p[ae]=Pe[ae])}}function b(p){var B=1;p=p.split(":");const ae=[];for(;0<B&&p.length;)ae.push(p.shift()),B--;return p.length&&ae.push(p.join(":")),ae}function w(p){l.setTimeout(()=>{throw p},0)}function _(){var p=q;let B=null;return p.g&&(B=p.g,p.g=p.g.next,p.g||(p.h=null),B.next=null),B}class W{constructor(){this.h=this.g=null}add(B,ae){const Pe=K.get();Pe.set(B,ae),this.h?this.h.next=Pe:this.g=Pe,this.h=Pe}}var K=new $(()=>new k,p=>p.reset());class k{constructor(){this.next=this.g=this.h=null}set(B,ae){this.h=B,this.g=ae,this.next=null}reset(){this.next=this.g=this.h=null}}let R,Y=!1,q=new W,O=()=>{const p=l.Promise.resolve(void 0);R=()=>{p.then(le)}};var le=()=>{for(var p;p=_();){try{p.h.call(p.g)}catch(ae){w(ae)}var B=K;B.j(p),100>B.h&&(B.h++,p.next=B.g,B.g=p)}Y=!1};function N(){this.s=this.s,this.C=this.C}N.prototype.s=!1,N.prototype.ma=function(){this.s||(this.s=!0,this.N())},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(p,B){this.type=p,this.g=this.target=B,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var V=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var p=!1,B=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const ae=()=>{};l.addEventListener("test",ae,B),l.removeEventListener("test",ae,B)}catch{}return p}();function I(p,B){if(D.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var ae=this.type=p.type,Pe=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=B,B=p.relatedTarget){if(Z){e:{try{X(B.nodeName);var qe=!0;break e}catch{}qe=!1}qe||(B=null)}}else ae=="mouseover"?B=p.fromElement:ae=="mouseout"&&(B=p.toElement);this.relatedTarget=B,Pe?(this.clientX=Pe.clientX!==void 0?Pe.clientX:Pe.pageX,this.clientY=Pe.clientY!==void 0?Pe.clientY:Pe.pageY,this.screenX=Pe.screenX||0,this.screenY=Pe.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:F[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&I.aa.h.call(this)}}x(I,D);var F={2:"touch",3:"pen",4:"mouse"};I.prototype.h=function(){I.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Q="closure_listenable_"+(1e6*Math.random()|0),H=0;function J(p,B,ae,Pe,qe){this.listener=p,this.proxy=null,this.src=B,this.type=ae,this.capture=!!Pe,this.ha=qe,this.key=++H,this.da=this.fa=!1}function te(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ee(p){this.src=p,this.g={},this.h=0}ee.prototype.add=function(p,B,ae,Pe,qe){var et=p.toString();p=this.g[et],p||(p=this.g[et]=[],this.h++);var At=G(p,B,Pe,qe);return-1<At?(B=p[At],ae||(B.fa=!1)):(B=new J(B,this.src,et,!!Pe,qe),B.fa=ae,p.push(B)),B};function ne(p,B){var ae=B.type;if(ae in p.g){var Pe=p.g[ae],qe=Array.prototype.indexOf.call(Pe,B,void 0),et;(et=0<=qe)&&Array.prototype.splice.call(Pe,qe,1),et&&(te(B),p.g[ae].length==0&&(delete p.g[ae],p.h--))}}function G(p,B,ae,Pe){for(var qe=0;qe<p.length;++qe){var et=p[qe];if(!et.da&&et.listener==B&&et.capture==!!ae&&et.ha==Pe)return qe}return-1}var ce="closure_lm_"+(1e6*Math.random()|0),oe={};function z(p,B,ae,Pe,qe){if(Array.isArray(B)){for(var et=0;et<B.length;et++)z(p,B[et],ae,Pe,qe);return null}return ae=De(ae),p&&p[Q]?p.K(B,ae,u(Pe)?!!Pe.capture:!1,qe):de(p,B,ae,!1,Pe,qe)}function de(p,B,ae,Pe,qe,et){if(!B)throw Error("Invalid event type");var At=u(qe)?!!qe.capture:!!qe,Pr=_e(p);if(Pr||(p[ce]=Pr=new ee(p)),ae=Pr.add(B,ae,Pe,At,et),ae.proxy)return ae;if(Pe=fe(),ae.proxy=Pe,Pe.src=p,Pe.listener=ae,p.addEventListener)V||(qe=At),qe===void 0&&(qe=!1),p.addEventListener(B.toString(),Pe,qe);else if(p.attachEvent)p.attachEvent(xe(B.toString()),Pe);else if(p.addListener&&p.removeListener)p.addListener(Pe);else throw Error("addEventListener and attachEvent are unavailable.");return ae}function fe(){function p(ae){return B.call(p.src,p.listener,ae)}const B=pe;return p}function ue(p,B,ae,Pe,qe){if(Array.isArray(B))for(var et=0;et<B.length;et++)ue(p,B[et],ae,Pe,qe);else Pe=u(Pe)?!!Pe.capture:!!Pe,ae=De(ae),p&&p[Q]?(p=p.i,B=String(B).toString(),B in p.g&&(et=p.g[B],ae=G(et,ae,Pe,qe),-1<ae&&(te(et[ae]),Array.prototype.splice.call(et,ae,1),et.length==0&&(delete p.g[B],p.h--)))):p&&(p=_e(p))&&(B=p.g[B.toString()],p=-1,B&&(p=G(B,ae,Pe,qe)),(ae=-1<p?B[p]:null)&&ge(ae))}function ge(p){if(typeof p!="number"&&p&&!p.da){var B=p.src;if(B&&B[Q])ne(B.i,p);else{var ae=p.type,Pe=p.proxy;B.removeEventListener?B.removeEventListener(ae,Pe,p.capture):B.detachEvent?B.detachEvent(xe(ae),Pe):B.addListener&&B.removeListener&&B.removeListener(Pe),(ae=_e(B))?(ne(ae,p),ae.h==0&&(ae.src=null,B[ce]=null)):te(p)}}}function xe(p){return p in oe?oe[p]:oe[p]="on"+p}function pe(p,B){if(p.da)p=!0;else{B=new I(B,this);var ae=p.listener,Pe=p.ha||p.src;p.fa&&ge(p),p=ae.call(Pe,B)}return p}function _e(p){return p=p[ce],p instanceof ee?p:null}var Le="__closure_events_fn_"+(1e9*Math.random()>>>0);function De(p){return typeof p=="function"?p:(p[Le]||(p[Le]=function(B){return p.handleEvent(B)}),p[Le])}function Te(){N.call(this),this.i=new ee(this),this.M=this,this.F=null}x(Te,N),Te.prototype[Q]=!0,Te.prototype.removeEventListener=function(p,B,ae,Pe){ue(this,p,B,ae,Pe)};function $e(p,B){var ae,Pe=p.F;if(Pe)for(ae=[];Pe;Pe=Pe.F)ae.push(Pe);if(p=p.M,Pe=B.type||B,typeof B=="string")B=new D(B,p);else if(B instanceof D)B.target=B.target||p;else{var qe=B;B=new D(Pe,p),j(B,qe)}if(qe=!0,ae)for(var et=ae.length-1;0<=et;et--){var At=B.g=ae[et];qe=Ie(At,Pe,!0,B)&&qe}if(At=B.g=p,qe=Ie(At,Pe,!0,B)&&qe,qe=Ie(At,Pe,!1,B)&&qe,ae)for(et=0;et<ae.length;et++)At=B.g=ae[et],qe=Ie(At,Pe,!1,B)&&qe}Te.prototype.N=function(){if(Te.aa.N.call(this),this.i){var p=this.i,B;for(B in p.g){for(var ae=p.g[B],Pe=0;Pe<ae.length;Pe++)te(ae[Pe]);delete p.g[B],p.h--}}this.F=null},Te.prototype.K=function(p,B,ae,Pe){return this.i.add(String(p),B,!1,ae,Pe)},Te.prototype.L=function(p,B,ae,Pe){return this.i.add(String(p),B,!0,ae,Pe)};function Ie(p,B,ae,Pe){if(B=p.i.g[String(B)],!B)return!0;B=B.concat();for(var qe=!0,et=0;et<B.length;++et){var At=B[et];if(At&&!At.da&&At.capture==ae){var Pr=At.listener,Rr=At.ha||At.src;At.fa&&ne(p.i,At),qe=Pr.call(Rr,Pe)!==!1&&qe}}return qe&&!Pe.defaultPrevented}function Re(p,B,ae){if(typeof p=="function")ae&&(p=g(p,ae));else if(p&&typeof p.handleEvent=="function")p=g(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(B)?-1:l.setTimeout(p,B||0)}function Ke(p){p.g=Re(()=>{p.g=null,p.i&&(p.i=!1,Ke(p))},p.l);const B=p.h;p.h=null,p.m.apply(null,B)}class je extends N{constructor(B,ae){super(),this.m=B,this.l=ae,this.h=null,this.i=!1,this.g=null}j(B){this.h=arguments,this.g?this.i=!0:Ke(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function We(p){N.call(this),this.h=p,this.g={}}x(We,N);var Qe=[];function at(p){re(p.g,function(B,ae){this.g.hasOwnProperty(ae)&&ge(B)},p),p.g={}}We.prototype.N=function(){We.aa.N.call(this),at(this)},We.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var nt=l.JSON.stringify,Ye=l.JSON.parse,ht=class{stringify(p){return l.JSON.stringify(p,void 0)}parse(p){return l.JSON.parse(p,void 0)}};function lt(){}lt.prototype.h=null;function $t(p){return p.h||(p.h=p.i())}function _t(){}var ze={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Lt(){D.call(this,"d")}x(Lt,D);function Nt(){D.call(this,"c")}x(Nt,D);var wt={},Ot=null;function gr(){return Ot=Ot||new Te}wt.La="serverreachability";function Be(p){D.call(this,wt.La,p)}x(Be,D);function Pt(p){const B=gr();$e(B,new Be(B))}wt.STAT_EVENT="statevent";function Ct(p,B){D.call(this,wt.STAT_EVENT,p),this.stat=B}x(Ct,D);function tt(p){const B=gr();$e(B,new Ct(B,p))}wt.Ma="timingevent";function ft(p,B){D.call(this,wt.Ma,p),this.size=B}x(ft,D);function Vt(p,B){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){p()},B)}function Rt(){this.g=!0}Rt.prototype.xa=function(){this.g=!1};function rr(p,B,ae,Pe,qe,et){p.info(function(){if(p.g)if(et)for(var At="",Pr=et.split("&"),Rr=0;Rr<Pr.length;Rr++){var wr=Pr[Rr].split("=");if(1<wr.length){var Qr=wr[0];wr=wr[1];var nn=Qr.split("_");At=2<=nn.length&&nn[1]=="type"?At+(Qr+"="+wr+"&"):At+(Qr+"=redacted&")}}else At=null;else At=et;return"XMLHTTP REQ ("+Pe+") [attempt "+qe+"]: "+B+`
`+ae+`
`+At})}function it(p,B,ae,Pe,qe,et,At){p.info(function(){return"XMLHTTP RESP ("+Pe+") [ attempt "+qe+"]: "+B+`
`+ae+`
`+et+" "+At})}function yt(p,B,ae,Pe){p.info(function(){return"XMLHTTP TEXT ("+B+"): "+Jt(p,ae)+(Pe?" "+Pe:"")})}function It(p,B){p.info(function(){return"TIMEOUT: "+B})}Rt.prototype.info=function(){};function Jt(p,B){if(!p.g)return B;if(!B)return null;try{var ae=JSON.parse(B);if(ae){for(p=0;p<ae.length;p++)if(Array.isArray(ae[p])){var Pe=ae[p];if(!(2>Pe.length)){var qe=Pe[1];if(Array.isArray(qe)&&!(1>qe.length)){var et=qe[0];if(et!="noop"&&et!="stop"&&et!="close")for(var At=1;At<qe.length;At++)qe[At]=""}}}}return nt(ae)}catch{return B}}var Je={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Et={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Wt;function Yt(){}x(Yt,lt),Yt.prototype.g=function(){return new XMLHttpRequest},Yt.prototype.i=function(){return{}},Wt=new Yt;function er(p,B,ae,Pe){this.j=p,this.i=B,this.l=ae,this.R=Pe||1,this.U=new We(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new kt}function kt(){this.i=null,this.g="",this.h=!1}var Xt={},tr={};function Zt(p,B,ae){p.L=1,p.v=Vi(Br(B)),p.m=ae,p.P=!0,vt(p,null)}function vt(p,B){p.F=Date.now(),Ir(p),p.A=Br(p.v);var ae=p.A,Pe=p.R;Array.isArray(Pe)||(Pe=[String(Pe)]),vr(ae.i,"t",Pe),p.C=0,ae=p.j.J,p.h=new kt,p.g=me(p.j,ae?B:null,!p.m),0<p.O&&(p.M=new je(g(p.Y,p,p.g),p.O)),B=p.U,ae=p.g,Pe=p.ca;var qe="readystatechange";Array.isArray(qe)||(qe&&(Qe[0]=qe.toString()),qe=Qe);for(var et=0;et<qe.length;et++){var At=z(ae,qe[et],Pe||B.handleEvent,!1,B.h||B);if(!At)break;B.g[At.key]=At}B=p.H?C(p.H):{},p.m?(p.u||(p.u="POST"),B["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,B)):(p.u="GET",p.g.ea(p.A,p.u,null,B)),Pt(),rr(p.i,p.u,p.A,p.l,p.R,p.m)}er.prototype.ca=function(p){p=p.target;const B=this.M;B&&Bn(p)==3?B.j():this.Y(p)},er.prototype.Y=function(p){try{if(p==this.g)e:{const nn=Bn(this.g);var B=this.g.Ba();const go=this.g.Z();if(!(3>nn)&&(nn!=3||this.g&&(this.h.h||this.g.oa()||Rl(this.g)))){this.J||nn!=4||B==7||(B==8||0>=go?Pt(3):Pt(2)),cr(this);var ae=this.g.Z();this.X=ae;t:if(ir(this)){var Pe=Rl(this.g);p="";var qe=Pe.length,et=Bn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Tr(this),_r(this);var At="";break t}this.h.i=new l.TextDecoder}for(B=0;B<qe;B++)this.h.h=!0,p+=this.h.i.decode(Pe[B],{stream:!(et&&B==qe-1)});Pe.length=0,this.h.g+=p,this.C=0,At=this.h.g}else At=this.g.oa();if(this.o=ae==200,it(this.i,this.u,this.A,this.l,this.R,nn,ae),this.o){if(this.T&&!this.K){t:{if(this.g){var Pr,Rr=this.g;if((Pr=Rr.g?Rr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(Pr)){var wr=Pr;break t}}wr=null}if(ae=wr)yt(this.i,this.l,ae,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,kr(this,ae);else{this.o=!1,this.s=3,tt(12),Tr(this),_r(this);break e}}if(this.P){ae=!0;let Kn;for(;!this.J&&this.C<At.length;)if(Kn=Tt(this,At),Kn==tr){nn==4&&(this.s=4,tt(14),ae=!1),yt(this.i,this.l,null,"[Incomplete Response]");break}else if(Kn==Xt){this.s=4,tt(15),yt(this.i,this.l,At,"[Invalid Chunk]"),ae=!1;break}else yt(this.i,this.l,Kn,null),kr(this,Kn);if(ir(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),nn!=4||At.length!=0||this.h.h||(this.s=1,tt(16),ae=!1),this.o=this.o&&ae,!ae)yt(this.i,this.l,At,"[Invalid Chunked Response]"),Tr(this),_r(this);else if(0<At.length&&!this.W){this.W=!0;var Qr=this.j;Qr.g==this&&Qr.ba&&!Qr.M&&(Qr.j.info("Great, no buffering proxy detected. Bytes received: "+At.length),zs(Qr),Qr.M=!0,tt(11))}}else yt(this.i,this.l,At,null),kr(this,At);nn==4&&Tr(this),this.o&&!this.J&&(nn==4?Mo(this.j,this):(this.o=!1,Ir(this)))}else Ro(this.g),ae==400&&0<At.indexOf("Unknown SID")?(this.s=3,tt(12)):(this.s=0,tt(13)),Tr(this),_r(this)}}}catch{}finally{}};function ir(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function Tt(p,B){var ae=p.C,Pe=B.indexOf(`
`,ae);return Pe==-1?tr:(ae=Number(B.substring(ae,Pe)),isNaN(ae)?Xt:(Pe+=1,Pe+ae>B.length?tr:(B=B.slice(Pe,Pe+ae),p.C=Pe+ae,B)))}er.prototype.cancel=function(){this.J=!0,Tr(this)};function Ir(p){p.S=Date.now()+p.I,or(p,p.I)}function or(p,B){if(p.B!=null)throw Error("WatchDog timer not null");p.B=Vt(g(p.ba,p),B)}function cr(p){p.B&&(l.clearTimeout(p.B),p.B=null)}er.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(It(this.i,this.A),this.L!=2&&(Pt(),tt(17)),Tr(this),this.s=2,_r(this)):or(this,this.S-p)};function _r(p){p.j.G==0||p.J||Mo(p.j,p)}function Tr(p){cr(p);var B=p.M;B&&typeof B.ma=="function"&&B.ma(),p.M=null,at(p.U),p.g&&(B=p.g,p.g=null,B.abort(),B.ma())}function kr(p,B){try{var ae=p.j;if(ae.G!=0&&(ae.g==p||En(ae.h,p))){if(!p.K&&En(ae.h,p)&&ae.G==3){try{var Pe=ae.Da.g.parse(B)}catch{Pe=null}if(Array.isArray(Pe)&&Pe.length==3){var qe=Pe;if(qe[0]==0){e:if(!ae.u){if(ae.g)if(ae.g.F+3e3<p.F)yo(ae),Bs(ae);else break e;ss(ae),tt(18)}}else ae.za=qe[1],0<ae.za-ae.T&&37500>qe[2]&&ae.F&&ae.v==0&&!ae.C&&(ae.C=Vt(g(ae.Za,ae),6e3));if(1>=gn(ae.h)&&ae.ca){try{ae.ca()}catch{}ae.ca=void 0}}else ni(ae,11)}else if((p.K||ae.g==p)&&yo(ae),!U(B))for(qe=ae.Da.g.parse(B),B=0;B<qe.length;B++){let wr=qe[B];if(ae.T=wr[0],wr=wr[1],ae.G==2)if(wr[0]=="c"){ae.K=wr[1],ae.ia=wr[2];const Qr=wr[3];Qr!=null&&(ae.la=Qr,ae.j.info("VER="+ae.la));const nn=wr[4];nn!=null&&(ae.Aa=nn,ae.j.info("SVER="+ae.Aa));const go=wr[5];go!=null&&typeof go=="number"&&0<go&&(Pe=1.5*go,ae.L=Pe,ae.j.info("backChannelRequestTimeoutMs_="+Pe)),Pe=ae;const Kn=p.g;if(Kn){const Fo=Kn.g?Kn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Fo){var et=Pe.h;et.g||Fo.indexOf("spdy")==-1&&Fo.indexOf("quic")==-1&&Fo.indexOf("h2")==-1||(et.j=et.l,et.g=new Set,et.h&&(Nr(et,et.h),et.h=null))}if(Pe.D){const Oo=Kn.g?Kn.g.getResponseHeader("X-HTTP-Session-Id"):null;Oo&&(Pe.ya=Oo,qr(Pe.I,Pe.D,Oo))}}ae.G=3,ae.l&&ae.l.ua(),ae.ba&&(ae.R=Date.now()-p.F,ae.j.info("Handshake RTT: "+ae.R+"ms")),Pe=ae;var At=p;if(Pe.qa=A(Pe,Pe.J?Pe.ia:null,Pe.W),At.K){On(Pe.h,At);var Pr=At,Rr=Pe.L;Rr&&(Pr.I=Rr),Pr.B&&(cr(Pr),Ir(Pr)),Pe.g=At}else qs(Pe);0<ae.i.length&&js(ae)}else wr[0]!="stop"&&wr[0]!="close"||ni(ae,7);else ae.G==3&&(wr[0]=="stop"||wr[0]=="close"?wr[0]=="stop"?ni(ae,7):mo(ae):wr[0]!="noop"&&ae.l&&ae.l.ta(wr),ae.v=0)}}Pt(4)}catch{}}var lr=class{constructor(p,B){this.g=p,this.map=B}};function Mt(p){this.l=p||10,l.PerformanceNavigationTiming?(p=l.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function yn(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function gn(p){return p.h?1:p.g?p.g.size:0}function En(p,B){return p.h?p.h==B:p.g?p.g.has(B):!1}function Nr(p,B){p.g?p.g.add(B):p.h=B}function On(p,B){p.h&&p.h==B?p.h=null:p.g&&p.g.has(B)&&p.g.delete(B)}Mt.prototype.cancel=function(){if(this.i=bi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function bi(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let B=p.i;for(const ae of p.g.values())B=B.concat(ae.D);return B}return S(p.i)}function _i(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(c(p)){for(var B=[],ae=p.length,Pe=0;Pe<ae;Pe++)B.push(p[Pe]);return B}B=[],ae=0;for(Pe in p)B[ae++]=p[Pe];return B}function hr(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(c(p)||typeof p=="string"){var B=[];p=p.length;for(var ae=0;ae<p;ae++)B.push(ae);return B}B=[],ae=0;for(const Pe in p)B[ae++]=Pe;return B}}}function Lr(p,B){if(p.forEach&&typeof p.forEach=="function")p.forEach(B,void 0);else if(c(p)||typeof p=="string")Array.prototype.forEach.call(p,B,void 0);else for(var ae=hr(p),Pe=_i(p),qe=Pe.length,et=0;et<qe;et++)B.call(void 0,Pe[et],ae&&ae[et],p)}var jr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fn(p,B){if(p){p=p.split("&");for(var ae=0;ae<p.length;ae++){var Pe=p[ae].indexOf("="),qe=null;if(0<=Pe){var et=p[ae].substring(0,Pe);qe=p[ae].substring(Pe+1)}else et=p[ae];B(et,qe?decodeURIComponent(qe.replace(/\+/g," ")):"")}}}function Gr(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof Gr){this.h=p.h,Wn(this,p.j),this.o=p.o,this.g=p.g,ri(this,p.s),this.l=p.l;var B=p.i,ae=new No;ae.i=B.i,B.g&&(ae.g=new Map(B.g),ae.h=B.h),Si(this,ae),this.m=p.m}else p&&(B=String(p).match(jr))?(this.h=!1,Wn(this,B[1]||"",!0),this.o=Pi(B[2]||""),this.g=Pi(B[3]||"",!0),ri(this,B[4]),this.l=Pi(B[5]||"",!0),Si(this,B[6]||"",!0),this.m=Pi(B[7]||"")):(this.h=!1,this.i=new No(null,this.h))}Gr.prototype.toString=function(){var p=[],B=this.j;B&&p.push(wi(B,Tl,!0),":");var ae=this.g;return(ae||B=="file")&&(p.push("//"),(B=this.o)&&p.push(wi(B,Tl,!0),"@"),p.push(encodeURIComponent(String(ae)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),ae=this.s,ae!=null&&p.push(":",String(ae))),(ae=this.l)&&(this.g&&ae.charAt(0)!="/"&&p.push("/"),p.push(wi(ae,ae.charAt(0)=="/"?ho:Lc,!0))),(ae=this.i.toString())&&p.push("?",ae),(ae=this.m)&&p.push("#",wi(ae,Ls)),p.join("")};function Br(p){return new Gr(p)}function Wn(p,B,ae){p.j=ae?Pi(B,!0):B,p.j&&(p.j=p.j.replace(/:$/,""))}function ri(p,B){if(B){if(B=Number(B),isNaN(B)||0>B)throw Error("Bad port number "+B);p.s=B}else p.s=null}function Si(p,B,ae){B instanceof No?(p.i=B,Rc(p.i,p.h)):(ae||(B=wi(B,Ns)),p.i=new No(B,p.h))}function qr(p,B,ae){p.i.set(B,ae)}function Vi(p){return qr(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function Pi(p,B){return p?B?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function wi(p,B,ae){return typeof p=="string"?(p=encodeURI(p).replace(B,Nc),ae&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Nc(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Tl=/[#\/\?@]/g,Lc=/[#\?:]/g,ho=/[#\?]/g,Ns=/[#\?@]/g,Ls=/#/g;function No(p,B){this.h=this.g=null,this.i=p||null,this.j=!!B}function dn(p){p.g||(p.g=new Map,p.h=0,p.i&&fn(p.i,function(B,ae){p.add(decodeURIComponent(B.replace(/\+/g," ")),ae)}))}t=No.prototype,t.add=function(p,B){dn(this),this.i=null,p=Lo(this,p);var ae=this.g.get(p);return ae||this.g.set(p,ae=[]),ae.push(B),this.h+=1,this};function kl(p,B){dn(p),B=Lo(p,B),p.g.has(B)&&(p.i=null,p.h-=p.g.get(B).length,p.g.delete(B))}function Fa(p,B){return dn(p),B=Lo(p,B),p.g.has(B)}t.forEach=function(p,B){dn(this),this.g.forEach(function(ae,Pe){ae.forEach(function(qe){p.call(B,qe,Pe,this)},this)},this)},t.na=function(){dn(this);const p=Array.from(this.g.values()),B=Array.from(this.g.keys()),ae=[];for(let Pe=0;Pe<B.length;Pe++){const qe=p[Pe];for(let et=0;et<qe.length;et++)ae.push(B[Pe])}return ae},t.V=function(p){dn(this);let B=[];if(typeof p=="string")Fa(this,p)&&(B=B.concat(this.g.get(Lo(this,p))));else{p=Array.from(this.g.values());for(let ae=0;ae<p.length;ae++)B=B.concat(p[ae])}return B},t.set=function(p,B){return dn(this),this.i=null,p=Lo(this,p),Fa(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[B]),this.h+=1,this},t.get=function(p,B){return p?(p=this.V(p),0<p.length?String(p[0]):B):B};function vr(p,B,ae){kl(p,B),0<ae.length&&(p.i=null,p.g.set(Lo(p,B),S(ae)),p.h+=ae.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],B=Array.from(this.g.keys());for(var ae=0;ae<B.length;ae++){var Pe=B[ae];const et=encodeURIComponent(String(Pe)),At=this.V(Pe);for(Pe=0;Pe<At.length;Pe++){var qe=et;At[Pe]!==""&&(qe+="="+encodeURIComponent(String(At[Pe]))),p.push(qe)}}return this.i=p.join("&")};function Lo(p,B){return B=String(B),p.j&&(B=B.toLowerCase()),B}function Rc(p,B){B&&!p.j&&(dn(p),p.i=null,p.g.forEach(function(ae,Pe){var qe=Pe.toLowerCase();Pe!=qe&&(kl(this,Pe),vr(this,qe,ae))},p)),p.j=B}function Xi(p,B){const ae=new Rt;if(l.Image){const Pe=new Image;Pe.onload=f(qi,ae,"TestLoadImage: loaded",!0,B,Pe),Pe.onerror=f(qi,ae,"TestLoadImage: error",!1,B,Pe),Pe.onabort=f(qi,ae,"TestLoadImage: abort",!1,B,Pe),Pe.ontimeout=f(qi,ae,"TestLoadImage: timeout",!1,B,Pe),l.setTimeout(function(){Pe.ontimeout&&Pe.ontimeout()},1e4),Pe.src=p}else B(!1)}function Nl(p,B){const ae=new Rt,Pe=new AbortController,qe=setTimeout(()=>{Pe.abort(),qi(ae,"TestPingServer: timeout",!1,B)},1e4);fetch(p,{signal:Pe.signal}).then(et=>{clearTimeout(qe),et.ok?qi(ae,"TestPingServer: ok",!0,B):qi(ae,"TestPingServer: server error",!1,B)}).catch(()=>{clearTimeout(qe),qi(ae,"TestPingServer: error",!1,B)})}function qi(p,B,ae,Pe,qe){try{qe&&(qe.onload=null,qe.onerror=null,qe.onabort=null,qe.ontimeout=null),Pe(ae)}catch{}}function Rs(){this.g=new ht}function Oa(p,B,ae){const Pe=ae||"";try{Lr(p,function(qe,et){let At=qe;u(qe)&&(At=nt(qe)),B.push(Pe+et+"="+encodeURIComponent(At))})}catch(qe){throw B.push(Pe+"type="+encodeURIComponent("_badmap")),qe}}function Ds(p){this.l=p.Ub||null,this.j=p.eb||!1}x(Ds,lt),Ds.prototype.g=function(){return new Ms(this.l,this.j)},Ds.prototype.i=function(p){return function(){return p}}({});function Ms(p,B){Te.call(this),this.D=p,this.o=B,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(Ms,Te),t=Ms.prototype,t.open=function(p,B){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=B,this.readyState=1,zi(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const B={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(B.body=p),(this.D||l).fetch(new Request(this.A,B)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,po(this)),this.readyState=0},t.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,zi(this)),this.g&&(this.readyState=3,zi(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ll(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ll(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}t.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var B=p.value?p.value:new Uint8Array(0);(B=this.v.decode(B,{stream:!p.done}))&&(this.response=this.responseText+=B)}p.done?po(this):zi(this),this.readyState==3&&Ll(this)}},t.Ra=function(p){this.g&&(this.response=this.responseText=p,po(this))},t.Qa=function(p){this.g&&(this.response=p,po(this))},t.ga=function(){this.g&&po(this)};function po(p){p.readyState=4,p.l=null,p.j=null,p.v=null,zi(p)}t.setRequestHeader=function(p,B){this.u.append(p,B)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],B=this.h.entries();for(var ae=B.next();!ae.done;)ae=ae.value,p.push(ae[0]+": "+ae[1]),ae=B.next();return p.join(`\r
`)};function zi(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Ms.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function fo(p){let B="";return re(p,function(ae,Pe){B+=Pe,B+=":",B+=ae,B+=`\r
`}),B}function Ba(p,B,ae){e:{for(Pe in ae){var Pe=!1;break e}Pe=!0}Pe||(ae=fo(ae),typeof p=="string"?ae!=null&&encodeURIComponent(String(ae)):qr(p,B,ae))}function Jr(p){Te.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(Jr,Te);var ja=/^https?$/i,Fs=["POST","PUT"];t=Jr.prototype,t.Ha=function(p){this.J=p},t.ea=function(p,B,ae,Pe){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);B=B?B.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Wt.g(),this.v=this.o?$t(this.o):$t(Wt),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(B,String(p),!0),this.B=!1}catch(et){Va(this,et);return}if(p=ae||"",ae=new Map(this.headers),Pe)if(Object.getPrototypeOf(Pe)===Object.prototype)for(var qe in Pe)ae.set(qe,Pe[qe]);else if(typeof Pe.keys=="function"&&typeof Pe.get=="function")for(const et of Pe.keys())ae.set(et,Pe.get(et));else throw Error("Unknown input type for opt_headers: "+String(Pe));Pe=Array.from(ae.keys()).find(et=>et.toLowerCase()=="content-type"),qe=l.FormData&&p instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Fs,B,void 0))||Pe||qe||ae.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[et,At]of ae)this.g.setRequestHeader(et,At);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ui(this),this.u=!0,this.g.send(p),this.u=!1}catch(et){Va(this,et)}};function Va(p,B){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=B,p.m=5,qa(p),ns(p)}function qa(p){p.A||(p.A=!0,$e(p,"complete"),$e(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,$e(this,"complete"),$e(this,"abort"),ns(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ns(this,!0)),Jr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?za(this):this.bb())},t.bb=function(){za(this)};function za(p){if(p.h&&typeof s<"u"&&(!p.v[1]||Bn(p)!=4||p.Z()!=2)){if(p.u&&Bn(p)==4)Re(p.Ea,0,p);else if($e(p,"readystatechange"),Bn(p)==4){p.h=!1;try{const At=p.Z();e:switch(At){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var B=!0;break e;default:B=!1}var ae;if(!(ae=B)){var Pe;if(Pe=At===0){var qe=String(p.D).match(jr)[1]||null;!qe&&l.self&&l.self.location&&(qe=l.self.location.protocol.slice(0,-1)),Pe=!ja.test(qe?qe.toLowerCase():"")}ae=Pe}if(ae)$e(p,"complete"),$e(p,"success");else{p.m=6;try{var et=2<Bn(p)?p.g.statusText:""}catch{et=""}p.l=et+" ["+p.Z()+"]",qa(p)}}finally{ns(p)}}}}function ns(p,B){if(p.g){Ui(p);const ae=p.g,Pe=p.v[0]?()=>{}:null;p.g=null,p.v=null,B||$e(p,"ready");try{ae.onreadystatechange=Pe}catch{}}}function Ui(p){p.I&&(l.clearTimeout(p.I),p.I=null)}t.isActive=function(){return!!this.g};function Bn(p){return p.g?p.g.readyState:0}t.Z=function(){try{return 2<Bn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(p){if(this.g){var B=this.g.responseText;return p&&B.indexOf(p)==0&&(B=B.substring(p.length)),Ye(B)}};function Rl(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Ro(p){const B={};p=(p.g&&2<=Bn(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let Pe=0;Pe<p.length;Pe++){if(U(p[Pe]))continue;var ae=b(p[Pe]);const qe=ae[0];if(ae=ae[1],typeof ae!="string")continue;ae=ae.trim();const et=B[qe]||[];B[qe]=et,et.push(ae)}E(B,function(Pe){return Pe.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Yn(p,B,ae){return ae&&ae.internalChannelParams&&ae.internalChannelParams[p]||B}function Os(p){this.Aa=0,this.i=[],this.j=new Rt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Yn("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Yn("baseRetryDelayMs",5e3,p),this.cb=Yn("retryDelaySeedMs",1e4,p),this.Wa=Yn("forwardChannelMaxRetries",2,p),this.wa=Yn("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new Mt(p&&p.concurrentRequestLimit),this.Da=new Rs,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Os.prototype,t.la=8,t.G=1,t.connect=function(p,B,ae,Pe){tt(0),this.W=p,this.H=B||{},ae&&Pe!==void 0&&(this.H.OSID=ae,this.H.OAID=Pe),this.F=this.X,this.I=A(this,null,this.W),js(this)};function mo(p){if(is(p),p.G==3){var B=p.U++,ae=Br(p.I);if(qr(ae,"SID",p.K),qr(ae,"RID",B),qr(ae,"TYPE","terminate"),Do(p,ae),B=new er(p,p.j,B),B.L=2,B.v=Vi(Br(ae)),ae=!1,l.navigator&&l.navigator.sendBeacon)try{ae=l.navigator.sendBeacon(B.v.toString(),"")}catch{}!ae&&l.Image&&(new Image().src=B.v,ae=!0),ae||(B.g=me(B.j,null),B.g.ea(B.v)),B.F=Date.now(),Ir(B)}Hs(p)}function Bs(p){p.g&&(zs(p),p.g.cancel(),p.g=null)}function is(p){Bs(p),p.u&&(l.clearTimeout(p.u),p.u=null),yo(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&l.clearTimeout(p.s),p.s=null)}function js(p){if(!yn(p.h)&&!p.s){p.s=!0;var B=p.Ga;R||O(),Y||(R(),Y=!0),q.add(B,p),p.B=0}}function Ua(p,B){return gn(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=B.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=Vt(g(p.Ga,p,B),Us(p,p.B)),p.B++,!0)}t.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const qe=new er(this,this.j,p);let et=this.o;if(this.S&&(et?(et=C(et),j(et,this.S)):et=this.S),this.m!==null||this.O||(qe.H=et,et=null),this.P)e:{for(var B=0,ae=0;ae<this.i.length;ae++){t:{var Pe=this.i[ae];if("__data__"in Pe.map&&(Pe=Pe.map.__data__,typeof Pe=="string")){Pe=Pe.length;break t}Pe=void 0}if(Pe===void 0)break;if(B+=Pe,4096<B){B=ae;break e}if(B===4096||ae===this.i.length-1){B=ae+1;break e}}B=1e3}else B=1e3;B=os(this,qe,B),ae=Br(this.I),qr(ae,"RID",p),qr(ae,"CVER",22),this.D&&qr(ae,"X-HTTP-Session-Id",this.D),Do(this,ae),et&&(this.O?B="headers="+encodeURIComponent(String(fo(et)))+"&"+B:this.m&&Ba(ae,this.m,et)),Nr(this.h,qe),this.Ua&&qr(ae,"TYPE","init"),this.P?(qr(ae,"$req",B),qr(ae,"SID","null"),qe.T=!0,Zt(qe,ae,null)):Zt(qe,ae,B),this.G=2}}else this.G==3&&(p?Vs(this,p):this.i.length==0||yn(this.h)||Vs(this))};function Vs(p,B){var ae;B?ae=B.l:ae=p.U++;const Pe=Br(p.I);qr(Pe,"SID",p.K),qr(Pe,"RID",ae),qr(Pe,"AID",p.T),Do(p,Pe),p.m&&p.o&&Ba(Pe,p.m,p.o),ae=new er(p,p.j,ae,p.B+1),p.m===null&&(ae.H=p.o),B&&(p.i=B.D.concat(p.i)),B=os(p,ae,1e3),ae.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),Nr(p.h,ae),Zt(ae,Pe,B)}function Do(p,B){p.H&&re(p.H,function(ae,Pe){qr(B,Pe,ae)}),p.l&&Lr({},function(ae,Pe){qr(B,Pe,ae)})}function os(p,B,ae){ae=Math.min(p.i.length,ae);var Pe=p.l?g(p.l.Na,p.l,p):null;e:{var qe=p.i;let et=-1;for(;;){const At=["count="+ae];et==-1?0<ae?(et=qe[0].g,At.push("ofs="+et)):et=0:At.push("ofs="+et);let Pr=!0;for(let Rr=0;Rr<ae;Rr++){let wr=qe[Rr].g;const Qr=qe[Rr].map;if(wr-=et,0>wr)et=Math.max(0,qe[Rr].g-100),Pr=!1;else try{Oa(Qr,At,"req"+wr+"_")}catch{Pe&&Pe(Qr)}}if(Pr){Pe=At.join("&");break e}}}return p=p.i.splice(0,ae),B.D=p,Pe}function qs(p){if(!p.g&&!p.u){p.Y=1;var B=p.Fa;R||O(),Y||(R(),Y=!0),q.add(B,p),p.v=0}}function ss(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=Vt(g(p.Fa,p),Us(p,p.v)),p.v++,!0)}t.Fa=function(){if(this.u=null,Dl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=Vt(g(this.ab,this),p)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,tt(10),Bs(this),Dl(this))};function zs(p){p.A!=null&&(l.clearTimeout(p.A),p.A=null)}function Dl(p){p.g=new er(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var B=Br(p.qa);qr(B,"RID","rpc"),qr(B,"SID",p.K),qr(B,"AID",p.T),qr(B,"CI",p.F?"0":"1"),!p.F&&p.ja&&qr(B,"TO",p.ja),qr(B,"TYPE","xmlhttp"),Do(p,B),p.m&&p.o&&Ba(B,p.m,p.o),p.L&&(p.g.I=p.L);var ae=p.g;p=p.ia,ae.L=1,ae.v=Vi(Br(B)),ae.m=null,ae.P=!0,vt(ae,p)}t.Za=function(){this.C!=null&&(this.C=null,Bs(this),ss(this),tt(19))};function yo(p){p.C!=null&&(l.clearTimeout(p.C),p.C=null)}function Mo(p,B){var ae=null;if(p.g==B){yo(p),zs(p),p.g=null;var Pe=2}else if(En(p.h,B))ae=B.D,On(p.h,B),Pe=1;else return;if(p.G!=0){if(B.o)if(Pe==1){ae=B.m?B.m.length:0,B=Date.now()-B.F;var qe=p.B;Pe=gr(),$e(Pe,new ft(Pe,ae)),js(p)}else qs(p);else if(qe=B.s,qe==3||qe==0&&0<B.X||!(Pe==1&&Ua(p,B)||Pe==2&&ss(p)))switch(ae&&0<ae.length&&(B=p.h,B.i=B.i.concat(ae)),qe){case 1:ni(p,5);break;case 4:ni(p,10);break;case 3:ni(p,6);break;default:ni(p,2)}}}function Us(p,B){let ae=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(ae*=2),ae*B}function ni(p,B){if(p.j.info("Error code "+B),B==2){var ae=g(p.fb,p),Pe=p.Xa;const qe=!Pe;Pe=new Gr(Pe||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Wn(Pe,"https"),Vi(Pe),qe?Xi(Pe.toString(),ae):Nl(Pe.toString(),ae)}else tt(2);p.G=0,p.l&&p.l.sa(B),Hs(p),is(p)}t.fb=function(p){p?(this.j.info("Successfully pinged google.com"),tt(2)):(this.j.info("Failed to ping google.com"),tt(1))};function Hs(p){if(p.G=0,p.ka=[],p.l){const B=bi(p.h);(B.length!=0||p.i.length!=0)&&(P(p.ka,B),P(p.ka,p.i),p.h.i.length=0,S(p.i),p.i.length=0),p.l.ra()}}function A(p,B,ae){var Pe=ae instanceof Gr?Br(ae):new Gr(ae);if(Pe.g!="")B&&(Pe.g=B+"."+Pe.g),ri(Pe,Pe.s);else{var qe=l.location;Pe=qe.protocol,B=B?B+"."+qe.hostname:qe.hostname,qe=+qe.port;var et=new Gr(null);Pe&&Wn(et,Pe),B&&(et.g=B),qe&&ri(et,qe),ae&&(et.l=ae),Pe=et}return ae=p.D,B=p.ya,ae&&B&&qr(Pe,ae,B),qr(Pe,"VER",p.la),Do(p,Pe),Pe}function me(p,B,ae){if(B&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return B=p.Ca&&!p.pa?new Jr(new Ds({eb:ae})):new Jr(p.pa),B.Ha(p.J),B}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ne(){}t=Ne.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Me(){}Me.prototype.g=function(p,B){return new Ue(p,B)};function Ue(p,B){Te.call(this),this.g=new Os(B),this.l=p,this.h=B&&B.messageUrlParams||null,p=B&&B.messageHeaders||null,B&&B.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=B&&B.initMessageHeaders||null,B&&B.messageContentType&&(p?p["X-WebChannel-Content-Type"]=B.messageContentType:p={"X-WebChannel-Content-Type":B.messageContentType}),B&&B.va&&(p?p["X-WebChannel-Client-Profile"]=B.va:p={"X-WebChannel-Client-Profile":B.va}),this.g.S=p,(p=B&&B.Sb)&&!U(p)&&(this.g.m=p),this.v=B&&B.supportsCrossDomainXhr||!1,this.u=B&&B.sendRawJson||!1,(B=B&&B.httpSessionIdParam)&&!U(B)&&(this.g.D=B,p=this.h,p!==null&&B in p&&(p=this.h,B in p&&delete p[B])),this.j=new jt(this)}x(Ue,Te),Ue.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ue.prototype.close=function(){mo(this.g)},Ue.prototype.o=function(p){var B=this.g;if(typeof p=="string"){var ae={};ae.__data__=p,p=ae}else this.u&&(ae={},ae.__data__=nt(p),p=ae);B.i.push(new lr(B.Ya++,p)),B.G==3&&js(B)},Ue.prototype.N=function(){this.g.l=null,delete this.j,mo(this.g),delete this.g,Ue.aa.N.call(this)};function ot(p){Lt.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var B=p.__sm__;if(B){e:{for(const ae in B){p=ae;break e}p=void 0}(this.i=p)&&(p=this.i,B=B!==null&&p in B?B[p]:void 0),this.data=B}else this.data=p}x(ot,Lt);function xt(){Nt.call(this),this.status=1}x(xt,Nt);function jt(p){this.g=p}x(jt,Ne),jt.prototype.ua=function(){$e(this.g,"a")},jt.prototype.ta=function(p){$e(this.g,new ot(p))},jt.prototype.sa=function(p){$e(this.g,new xt)},jt.prototype.ra=function(){$e(this.g,"b")},Me.prototype.createWebChannel=Me.prototype.g,Ue.prototype.send=Ue.prototype.o,Ue.prototype.open=Ue.prototype.m,Ue.prototype.close=Ue.prototype.close,Q1=function(){return new Me},J1=function(){return gr()},K1=wt,im={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Je.NO_ERROR=0,Je.TIMEOUT=8,Je.HTTP_ERROR=6,ih=Je,Et.COMPLETE="complete",Y1=Et,_t.EventType=ze,ze.OPEN="a",ze.CLOSE="b",ze.ERROR="c",ze.MESSAGE="d",Te.prototype.listen=Te.prototype.K,au=_t,Jr.prototype.listenOnce=Jr.prototype.L,Jr.prototype.getLastError=Jr.prototype.Ka,Jr.prototype.getLastErrorCode=Jr.prototype.Ba,Jr.prototype.getStatus=Jr.prototype.Z,Jr.prototype.getResponseJson=Jr.prototype.Oa,Jr.prototype.getResponseText=Jr.prototype.oa,Jr.prototype.send=Jr.prototype.ea,Jr.prototype.setWithCredentials=Jr.prototype.Ha,W1=Jr}).apply(typeof kd<"u"?kd:typeof self<"u"?self:typeof window<"u"?window:{});const sv="@firebase/firestore",av="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}hi.UNAUTHENTICATED=new hi(null),hi.GOOGLE_CREDENTIALS=new hi("google-credentials-uid"),hi.FIRST_PARTY=new hi("first-party-uid"),hi.MOCK_USER=new hi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ic="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pl=new Wm("@firebase/firestore");function nc(){return Pl.logLevel}function Kt(t,...e){if(Pl.logLevel<=Mr.DEBUG){const r=e.map(sy);Pl.debug(`Firestore (${Ic}): ${t}`,...r)}}function Is(t,...e){if(Pl.logLevel<=Mr.ERROR){const r=e.map(sy);Pl.error(`Firestore (${Ic}): ${t}`,...r)}}function vc(t,...e){if(Pl.logLevel<=Mr.WARN){const r=e.map(sy);Pl.warn(`Firestore (${Ic}): ${t}`,...r)}}function sy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,X1(t,n,r)}function X1(t,e,r){let n=`FIRESTORE (${Ic}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Is(n),new Error(n)}function Xr(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||X1(e,i,n)}function Cr(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ut={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ut extends ks{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class cC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(hi.UNAUTHENTICATED))}shutdown(){}}class uC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class dC{constructor(e){this.t=e,this.currentUser=hi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Xr(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let o=new xs;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new xs,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const c=o;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{Kt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Kt("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new xs)}},0),s()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Kt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Xr(typeof n.accessToken=="string",31837,{l:n}),new Z1(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Xr(e===null||typeof e=="string",2055,{h:e}),new hi(e)}}class hC{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=hi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class pC{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new hC(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(hi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class lv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fC{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,co(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Xr(this.o===void 0,3512);const n=o=>{o.error!=null&&Kt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.m;return this.m=o.token,Kt("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{Kt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):Kt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new lv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Xr(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new lv(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=mC(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function Fr(t,e){return t<e?-1:t>e?1:0}function om(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),o=e.charAt(n);if(i!==o)return Kp(i)===Kp(o)?Fr(i,o):Kp(i)?1:-1}return Fr(t.length,e.length)}const yC=55296,gC=57343;function Kp(t){const e=t.charCodeAt(0);return e>=yC&&e<=gC}function bc(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cv="__name__";class zo{constructor(e,r,n){r===void 0?r=0:r>e.length&&mr(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&mr(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return zo.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof zo?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=zo.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return Fr(e.length,r.length)}static compareSegments(e,r){const n=zo.isNumericId(e),i=zo.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?zo.extractNumericId(e).compare(zo.extractNumericId(r)):om(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Pa.fromString(e.substring(4,e.length-2))}}class un extends zo{construct(e,r,n){return new un(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ut(ut.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new un(r)}static emptyPath(){return new un([])}}const vC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Zn extends zo{construct(e,r,n){return new Zn(e,r,n)}static isValidIdentifier(e){return vC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Zn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===cv}static keyField(){return new Zn([cv])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new Ut(ut.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let s=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new Ut(ut.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Ut(ut.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else l==="`"?(s=!s,i++):l!=="."||s?(n+=l,i++):(o(),i++)}if(o(),s)throw new Ut(ut.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Zn(r)}static emptyPath(){return new Zn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this.path=e}static fromPath(e){return new ar(un.fromString(e))}static fromName(e){return new ar(un.fromString(e).popFirst(5))}static empty(){return new ar(un.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&un.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return un.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ar(new un(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2(t,e,r){if(!r)throw new Ut(ut.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function bC(t,e,r,n){if(e===!0&&n===!0)throw new Ut(ut.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function uv(t){if(!ar.isDocumentKey(t))throw new Ut(ut.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function dv(t){if(ar.isDocumentKey(t))throw new Ut(ut.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function t2(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function ep(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":mr(12329,{type:typeof t})}function $s(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ut(ut.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=ep(t);throw new Ut(ut.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(t,e){const r={typeString:t};return e&&(r.value=e),r}function Xu(t,e){if(!t2(t))throw new Ut(ut.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const s=t[n];if(i&&typeof s!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new Ut(ut.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hv=-62135596800,pv=1e6;class hn{static now(){return hn.fromMillis(Date.now())}static fromDate(e){return hn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*pv);return new hn(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ut(ut.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ut(ut.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<hv)throw new Ut(ut.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ut(ut.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/pv}_compareTo(e){return this.seconds===e.seconds?Fr(this.nanoseconds,e.nanoseconds):Fr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:hn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Xu(e,hn._jsonSchema))return new hn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-hv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}hn._jsonSchemaVersion="firestore/timestamp/1.0",hn._jsonSchema={type:Mn("string",hn._jsonSchemaVersion),seconds:Mn("number"),nanoseconds:Mn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{static fromTimestamp(e){return new Sr(e)}static min(){return new Sr(new hn(0,0))}static max(){return new Sr(new hn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ru=-1;function _C(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Sr.fromTimestamp(n===1e9?new hn(r+1,0):new hn(r,n));return new Aa(i,ar.empty(),e)}function SC(t){return new Aa(t.readTime,t.key,Ru)}class Aa{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Aa(Sr.min(),ar.empty(),Ru)}static max(){return new Aa(Sr.max(),ar.empty(),Ru)}}function PC(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ar.comparator(t.documentKey,e.documentKey),r!==0?r:Fr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $c(t){if(t.code!==ut.FAILED_PRECONDITION||t.message!==wC)throw t;Kt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&mr(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new bt((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof bt?r:bt.resolve(r)}catch(r){return bt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):bt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):bt.reject(r)}static resolve(e){return new bt((r,n)=>{r(e)})}static reject(e){return new bt((r,n)=>{n(e)})}static waitFor(e){return new bt((r,n)=>{let i=0,o=0,s=!1;e.forEach(l=>{++i,l.next(()=>{++o,s&&o===i&&r()},c=>n(c))}),s=!0,o===i&&r()})}static or(e){let r=bt.resolve(!1);for(const n of e)r=r.next(i=>i?bt.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new bt((n,i)=>{const o=e.length,s=new Array(o);let l=0;for(let c=0;c<o;c++){const u=c;r(e[u]).next(h=>{s[u]=h,++l,l===o&&n(s)},h=>i(h))}})}static doWhile(e,r){return new bt((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function AC(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Ec(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}tp.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ly=-1;function rp(t){return t==null}function kh(t){return t===0&&1/t==-1/0}function CC(t){return typeof t=="number"&&Number.isInteger(t)&&!kh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r2="";function IC(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=fv(e)),e=$C(t.get(r),e);return fv(e)}function $C(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case r2:r+="";break;default:r+=o}}return r}function fv(t){return t+r2+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mv(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Da(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function n2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e,r){this.comparator=e,this.root=r||Xn.EMPTY}insert(e,r){return new mn(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Xn.BLACK,null,null))}remove(e){return new mn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Nd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Nd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Nd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Nd(this.root,e,this.comparator,!0)}}class Nd{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xn{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??Xn.RED,this.left=i??Xn.EMPTY,this.right=o??Xn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new Xn(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Xn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Xn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw mr(43730,{key:this.key,value:this.value});if(this.right.isRed())throw mr(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw mr(27949);return e+(this.isRed()?0:1)}}Xn.EMPTY=null,Xn.RED=!0,Xn.BLACK=!1;Xn.EMPTY=new class{constructor(){this.size=0}get key(){throw mr(57766)}get value(){throw mr(16141)}get color(){throw mr(16727)}get left(){throw mr(29726)}get right(){throw mr(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new Xn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.comparator=e,this.data=new mn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new yv(this.data.getIterator())}getIteratorFrom(e){return new yv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof zn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new zn(this.comparator);return r.data=e,r}}class yv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e){this.fields=e,e.sort(Zn.comparator)}static empty(){return new Ki([])}unionWith(e){let r=new zn(Zn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ki(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return bc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new i2("Invalid base64 string: "+o):o}}(e);return new ti(r)}static fromUint8Array(e){const r=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new ti(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Fr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ti.EMPTY_BYTE_STRING=new ti("");const EC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ca(t){if(Xr(!!t,39018),typeof t=="string"){let e=0;const r=EC.exec(t);if(Xr(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:xn(t.seconds),nanos:xn(t.nanos)}}function xn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ia(t){return typeof t=="string"?ti.fromBase64String(t):ti.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o2="server_timestamp",s2="__type__",a2="__previous_value__",l2="__local_write_time__";function cy(t){return(t?.mapValue?.fields||{})[s2]?.stringValue===o2}function np(t){const e=t.mapValue.fields[a2];return cy(e)?np(e):e}function Du(t){const e=Ca(t.mapValue.fields[l2].timestampValue);return new hn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(e,r,n,i,o,s,l,c,u,h){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=h}}const Nh="(default)";class Mu{constructor(e,r){this.projectId=e,this.database=r||Nh}static empty(){return new Mu("","")}get isDefaultDatabase(){return this.database===Nh}isEqual(e){return e instanceof Mu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c2="__type__",kC="__max__",Ld={mapValue:{}},u2="__vector__",Lh="value";function $a(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?cy(t)?4:LC(t)?9007199254740991:NC(t)?10:11:mr(28295,{value:t})}function es(t,e){if(t===e)return!0;const r=$a(t);if(r!==$a(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Du(t).isEqual(Du(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=Ca(i.timestampValue),l=Ca(o.timestampValue);return s.seconds===l.seconds&&s.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Ia(i.bytesValue).isEqual(Ia(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return xn(i.geoPointValue.latitude)===xn(o.geoPointValue.latitude)&&xn(i.geoPointValue.longitude)===xn(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return xn(i.integerValue)===xn(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=xn(i.doubleValue),l=xn(o.doubleValue);return s===l?kh(s)===kh(l):isNaN(s)&&isNaN(l)}return!1}(t,e);case 9:return bc(t.arrayValue.values||[],e.arrayValue.values||[],es);case 10:case 11:return function(i,o){const s=i.mapValue.fields||{},l=o.mapValue.fields||{};if(mv(s)!==mv(l))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(l[c]===void 0||!es(s[c],l[c])))return!1;return!0}(t,e);default:return mr(52216,{left:t})}}function Fu(t,e){return(t.values||[]).find(r=>es(r,e))!==void 0}function _c(t,e){if(t===e)return 0;const r=$a(t),n=$a(e);if(r!==n)return Fr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Fr(t.booleanValue,e.booleanValue);case 2:return function(o,s){const l=xn(o.integerValue||o.doubleValue),c=xn(s.integerValue||s.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return gv(t.timestampValue,e.timestampValue);case 4:return gv(Du(t),Du(e));case 5:return om(t.stringValue,e.stringValue);case 6:return function(o,s){const l=Ia(o),c=Ia(s);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(o,s){const l=o.split("/"),c=s.split("/");for(let u=0;u<l.length&&u<c.length;u++){const h=Fr(l[u],c[u]);if(h!==0)return h}return Fr(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,s){const l=Fr(xn(o.latitude),xn(s.latitude));return l!==0?l:Fr(xn(o.longitude),xn(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return vv(t.arrayValue,e.arrayValue);case 10:return function(o,s){const l=o.fields||{},c=s.fields||{},u=l[Lh]?.arrayValue,h=c[Lh]?.arrayValue,y=Fr(u?.values?.length||0,h?.values?.length||0);return y!==0?y:vv(u,h)}(t.mapValue,e.mapValue);case 11:return function(o,s){if(o===Ld.mapValue&&s===Ld.mapValue)return 0;if(o===Ld.mapValue)return 1;if(s===Ld.mapValue)return-1;const l=o.fields||{},c=Object.keys(l),u=s.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let y=0;y<c.length&&y<h.length;++y){const g=om(c[y],h[y]);if(g!==0)return g;const f=_c(l[c[y]],u[h[y]]);if(f!==0)return f}return Fr(c.length,h.length)}(t.mapValue,e.mapValue);default:throw mr(23264,{he:r})}}function gv(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Fr(t,e);const r=Ca(t),n=Ca(e),i=Fr(r.seconds,n.seconds);return i!==0?i:Fr(r.nanos,n.nanos)}function vv(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=_c(r[i],n[i]);if(o)return o}return Fr(r.length,n.length)}function Sc(t){return sm(t)}function sm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Ca(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Ia(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ar.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=sm(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const s of n)o?o=!1:i+=",",i+=`${s}:${sm(r.fields[s])}`;return i+"}"}(t.mapValue):mr(61005,{value:t})}function oh(t){switch($a(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=np(t);return e?16+oh(e):16;case 5:return 2*t.stringValue.length;case 6:return Ia(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+oh(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Da(n.fields,(o,s)=>{i+=o.length+oh(s)}),i}(t.mapValue);default:throw mr(13486,{value:t})}}function bv(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function am(t){return!!t&&"integerValue"in t}function uy(t){return!!t&&"arrayValue"in t}function _v(t){return!!t&&"nullValue"in t}function Sv(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function sh(t){return!!t&&"mapValue"in t}function NC(t){return(t?.mapValue?.fields||{})[c2]?.stringValue===u2}function yu(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Da(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=yu(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=yu(t.arrayValue.values[r]);return e}return{...t}}function LC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===kC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e){this.value=e}static empty(){return new Mi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!sh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=yu(r)}setAll(e){let r=Zn.emptyPath(),n={},i=[];e.forEach((s,l)=>{if(!r.isImmediateParentOf(l)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=l.popLast()}s?n[l.lastSegment()]=yu(s):i.push(l.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());sh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return es(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];sh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Da(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new Mi(yu(this.value))}}function d2(t){const e=[];return Da(t.fields,(r,n)=>{const i=new Zn([r]);if(sh(n)){const o=d2(n.mapValue).fields;if(o.length===0)e.push(i);else for(const s of o)e.push(i.child(s))}else e.push(i)}),new Ki(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,r,n,i,o,s,l){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=s,this.documentState=l}static newInvalidDocument(e){return new pi(e,0,Sr.min(),Sr.min(),Sr.min(),Mi.empty(),0)}static newFoundDocument(e,r,n,i){return new pi(e,1,r,Sr.min(),n,i,0)}static newNoDocument(e,r){return new pi(e,2,r,Sr.min(),Sr.min(),Mi.empty(),0)}static newUnknownDocument(e,r){return new pi(e,3,r,Sr.min(),Sr.min(),Mi.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Sr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Mi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Mi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Sr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof pi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new pi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e,r){this.position=e,this.inclusive=r}}function Pv(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],s=t.position[i];if(o.field.isKeyField()?n=ar.comparator(ar.fromName(s.referenceValue),r.key):n=_c(s,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function wv(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!es(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,r="asc"){this.field=e,this.dir=r}}function RC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{}class Dn extends h2{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new MC(e,r,n):r==="array-contains"?new BC(e,n):r==="in"?new jC(e,n):r==="not-in"?new VC(e,n):r==="array-contains-any"?new qC(e,n):new Dn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new FC(e,n):new OC(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(_c(r,this.value)):r!==null&&$a(this.value)===$a(r)&&this.matchesComparison(_c(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return mr(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Eo extends h2{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Eo(e,r)}matches(e){return p2(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function p2(t){return t.op==="and"}function f2(t){return DC(t)&&p2(t)}function DC(t){for(const e of t.filters)if(e instanceof Eo)return!1;return!0}function lm(t){if(t instanceof Dn)return t.field.canonicalString()+t.op.toString()+Sc(t.value);if(f2(t))return t.filters.map(e=>lm(e)).join(",");{const e=t.filters.map(r=>lm(r)).join(",");return`${t.op}(${e})`}}function m2(t,e){return t instanceof Dn?function(n,i){return i instanceof Dn&&n.op===i.op&&n.field.isEqual(i.field)&&es(n.value,i.value)}(t,e):t instanceof Eo?function(n,i){return i instanceof Eo&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,s,l)=>o&&m2(s,i.filters[l]),!0):!1}(t,e):void mr(19439)}function y2(t){return t instanceof Dn?function(r){return`${r.field.canonicalString()} ${r.op} ${Sc(r.value)}`}(t):t instanceof Eo?function(r){return r.op.toString()+" {"+r.getFilters().map(y2).join(" ,")+"}"}(t):"Filter"}class MC extends Dn{constructor(e,r,n){super(e,r,n),this.key=ar.fromName(n.referenceValue)}matches(e){const r=ar.comparator(e.key,this.key);return this.matchesComparison(r)}}class FC extends Dn{constructor(e,r){super(e,"in",r),this.keys=g2("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class OC extends Dn{constructor(e,r){super(e,"not-in",r),this.keys=g2("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function g2(t,e){return(e.arrayValue?.values||[]).map(r=>ar.fromName(r.referenceValue))}class BC extends Dn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return uy(r)&&Fu(r.arrayValue,this.value)}}class jC extends Dn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Fu(this.value.arrayValue,r)}}class VC extends Dn{constructor(e,r){super(e,"not-in",r)}matches(e){if(Fu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Fu(this.value.arrayValue,r)}}class qC extends Dn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!uy(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Fu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e,r=null,n=[],i=[],o=null,s=null,l=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=s,this.endAt=l,this.Te=null}}function xv(t,e=null,r=[],n=[],i=null,o=null,s=null){return new zC(t,e,r,n,i,o,s)}function dy(t){const e=Cr(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>lm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),rp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Sc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Sc(n)).join(",")),e.Te=r}return e.Te}function hy(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!RC(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!m2(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!wv(t.startAt,e.startAt)&&wv(t.endAt,e.endAt)}function cm(t){return ar.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(e,r=null,n=[],i=[],o=null,s="F",l=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=s,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function UC(t,e,r,n,i,o,s,l){return new Tc(t,e,r,n,i,o,s,l)}function py(t){return new Tc(t)}function Av(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function v2(t){return t.collectionGroup!==null}function gu(t){const e=Cr(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let l=new zn(Zn.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Ou(o,n))}),r.has(Zn.keyField().canonicalString())||e.Ie.push(new Ou(Zn.keyField(),n))}return e.Ie}function Wo(t){const e=Cr(t);return e.Ee||(e.Ee=HC(e,gu(t))),e.Ee}function HC(t,e){if(t.limitType==="F")return xv(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new Ou(i.field,o)});const r=t.endAt?new Rh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Rh(t.startAt.position,t.startAt.inclusive):null;return xv(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function um(t,e){const r=t.filters.concat([e]);return new Tc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function dm(t,e,r){return new Tc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function ip(t,e){return hy(Wo(t),Wo(e))&&t.limitType===e.limitType}function b2(t){return`${dy(Wo(t))}|lt:${t.limitType}`}function ic(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>y2(i)).join(", ")}]`),rp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Sc(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Sc(i)).join(",")),`Target(${n})`}(Wo(t))}; limitType=${t.limitType})`}function op(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):ar.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of gu(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(s,l,c){const u=Pv(s,l,c);return s.inclusive?u<=0:u<0}(n.startAt,gu(n),i)||n.endAt&&!function(s,l,c){const u=Pv(s,l,c);return s.inclusive?u>=0:u>0}(n.endAt,gu(n),i))}(t,e)}function GC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function _2(t){return(e,r)=>{let n=!1;for(const i of gu(t)){const o=WC(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function WC(t,e,r){const n=t.field.isKeyField()?ar.comparator(e.key,r.key):function(o,s,l){const c=s.data.field(o),u=l.data.field(o);return c!==null&&u!==null?_c(c,u):mr(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return mr(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Da(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return n2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC=new mn(ar.comparator);function Es(){return YC}const S2=new mn(ar.comparator);function lu(...t){let e=S2;for(const r of t)e=e.insert(r.key,r);return e}function P2(t){let e=S2;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function cl(){return vu()}function w2(){return vu()}function vu(){return new Cl(t=>t.toString(),(t,e)=>t.isEqual(e))}const KC=new mn(ar.comparator),JC=new zn(ar.comparator);function Or(...t){let e=JC;for(const r of t)e=e.add(r);return e}const QC=new zn(Fr);function XC(){return QC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:kh(e)?"-0":e}}function x2(t){return{integerValue:""+t}}function ZC(t,e){return CC(e)?x2(e):fy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(){this._=void 0}}function e3(t,e,r){return t instanceof Dh?function(i,o){const s={fields:{[s2]:{stringValue:o2},[l2]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&cy(o)&&(o=np(o)),o&&(s.fields[a2]=o),{mapValue:s}}(r,e):t instanceof Bu?C2(t,e):t instanceof ju?I2(t,e):function(i,o){const s=A2(i,o),l=Cv(s)+Cv(i.Ae);return am(s)&&am(i.Ae)?x2(l):fy(i.serializer,l)}(t,e)}function t3(t,e,r){return t instanceof Bu?C2(t,e):t instanceof ju?I2(t,e):r}function A2(t,e){return t instanceof Mh?function(n){return am(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class Dh extends sp{}class Bu extends sp{constructor(e){super(),this.elements=e}}function C2(t,e){const r=$2(e);for(const n of t.elements)r.some(i=>es(i,n))||r.push(n);return{arrayValue:{values:r}}}class ju extends sp{constructor(e){super(),this.elements=e}}function I2(t,e){let r=$2(e);for(const n of t.elements)r=r.filter(i=>!es(i,n));return{arrayValue:{values:r}}}class Mh extends sp{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Cv(t){return xn(t.integerValue||t.doubleValue)}function $2(t){return uy(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function r3(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Bu&&i instanceof Bu||n instanceof ju&&i instanceof ju?bc(n.elements,i.elements,es):n instanceof Mh&&i instanceof Mh?es(n.Ae,i.Ae):n instanceof Dh&&i instanceof Dh}(t.transform,e.transform)}class n3{constructor(e,r){this.version=e,this.transformResults=r}}class Yo{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Yo}static exists(e){return new Yo(void 0,e)}static updateTime(e){return new Yo(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ah(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ap{}function E2(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new k2(t.key,Yo.none()):new Zu(t.key,t.data,Yo.none());{const r=t.data,n=Mi.empty();let i=new zn(Zn.comparator);for(let o of e.fields)if(!i.has(o)){let s=r.field(o);s===null&&o.length>1&&(o=o.popLast(),s=r.field(o)),s===null?n.delete(o):n.set(o,s),i=i.add(o)}return new Ma(t.key,n,new Ki(i.toArray()),Yo.none())}}function i3(t,e,r){t instanceof Zu?function(i,o,s){const l=i.value.clone(),c=$v(i.fieldTransforms,o,s.transformResults);l.setAll(c),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(t,e,r):t instanceof Ma?function(i,o,s){if(!ah(i.precondition,o))return void o.convertToUnknownDocument(s.version);const l=$v(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(T2(i)),c.setAll(l),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(t,e,r):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,r)}function bu(t,e,r,n){return t instanceof Zu?function(o,s,l,c){if(!ah(o.precondition,s))return l;const u=o.value.clone(),h=Ev(o.fieldTransforms,c,s);return u.setAll(h),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null}(t,e,r,n):t instanceof Ma?function(o,s,l,c){if(!ah(o.precondition,s))return l;const u=Ev(o.fieldTransforms,c,s),h=s.data;return h.setAll(T2(o)),h.setAll(u),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(y=>y.field))}(t,e,r,n):function(o,s,l){return ah(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):l}(t,e,r)}function o3(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=A2(n.transform,i||null);o!=null&&(r===null&&(r=Mi.empty()),r.set(n.field,o))}return r||null}function Iv(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&bc(n,i,(o,s)=>r3(o,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Zu extends ap{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ma extends ap{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function T2(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function $v(t,e,r){const n=new Map;Xr(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const o=t[i],s=o.transform,l=e.data.field(o.field);n.set(o.field,t3(s,l,r[i]))}return n}function Ev(t,e,r){const n=new Map;for(const i of t){const o=i.transform,s=r.data.field(i.field);n.set(i.field,e3(o,s,e))}return n}class k2 extends ap{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class s3 extends ap{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a3{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&i3(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=bu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=bu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=w2();return this.mutations.forEach(i=>{const o=e.get(i.key),s=o.overlayedDocument;let l=this.applyToLocalView(s,o.mutatedFields);l=r.has(i.key)?null:l;const c=E2(s,l);c!==null&&n.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(Sr.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Or())}isEqual(e){return this.batchId===e.batchId&&bc(this.mutations,e.mutations,(r,n)=>Iv(r,n))&&bc(this.baseMutations,e.baseMutations,(r,n)=>Iv(r,n))}}class my{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Xr(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return KC}();const o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,n[s].version);return new my(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c3{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rn,Vr;function u3(t){switch(t){case ut.OK:return mr(64938);case ut.CANCELLED:case ut.UNKNOWN:case ut.DEADLINE_EXCEEDED:case ut.RESOURCE_EXHAUSTED:case ut.INTERNAL:case ut.UNAVAILABLE:case ut.UNAUTHENTICATED:return!1;case ut.INVALID_ARGUMENT:case ut.NOT_FOUND:case ut.ALREADY_EXISTS:case ut.PERMISSION_DENIED:case ut.FAILED_PRECONDITION:case ut.ABORTED:case ut.OUT_OF_RANGE:case ut.UNIMPLEMENTED:case ut.DATA_LOSS:return!0;default:return mr(15467,{code:t})}}function N2(t){if(t===void 0)return Is("GRPC error has no .code"),ut.UNKNOWN;switch(t){case Rn.OK:return ut.OK;case Rn.CANCELLED:return ut.CANCELLED;case Rn.UNKNOWN:return ut.UNKNOWN;case Rn.DEADLINE_EXCEEDED:return ut.DEADLINE_EXCEEDED;case Rn.RESOURCE_EXHAUSTED:return ut.RESOURCE_EXHAUSTED;case Rn.INTERNAL:return ut.INTERNAL;case Rn.UNAVAILABLE:return ut.UNAVAILABLE;case Rn.UNAUTHENTICATED:return ut.UNAUTHENTICATED;case Rn.INVALID_ARGUMENT:return ut.INVALID_ARGUMENT;case Rn.NOT_FOUND:return ut.NOT_FOUND;case Rn.ALREADY_EXISTS:return ut.ALREADY_EXISTS;case Rn.PERMISSION_DENIED:return ut.PERMISSION_DENIED;case Rn.FAILED_PRECONDITION:return ut.FAILED_PRECONDITION;case Rn.ABORTED:return ut.ABORTED;case Rn.OUT_OF_RANGE:return ut.OUT_OF_RANGE;case Rn.UNIMPLEMENTED:return ut.UNIMPLEMENTED;case Rn.DATA_LOSS:return ut.DATA_LOSS;default:return mr(39323,{code:t})}}(Vr=Rn||(Rn={}))[Vr.OK=0]="OK",Vr[Vr.CANCELLED=1]="CANCELLED",Vr[Vr.UNKNOWN=2]="UNKNOWN",Vr[Vr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vr[Vr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vr[Vr.NOT_FOUND=5]="NOT_FOUND",Vr[Vr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vr[Vr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vr[Vr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vr[Vr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vr[Vr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vr[Vr.ABORTED=10]="ABORTED",Vr[Vr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vr[Vr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vr[Vr.INTERNAL=13]="INTERNAL",Vr[Vr.UNAVAILABLE=14]="UNAVAILABLE",Vr[Vr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d3(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h3=new Pa([4294967295,4294967295],0);function Tv(t){const e=d3().encode(t),r=new G1;return r.update(e),new Uint8Array(r.digest())}function kv(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Pa([r,n],0),new Pa([i,o],0)]}class yy{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new cu(`Invalid padding: ${r}`);if(n<0)throw new cu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new cu(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new cu(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Pa.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Pa.fromNumber(n)));return i.compare(h3)===1&&(i=new Pa([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=Tv(e),[n,i]=kv(r);for(let o=0;o<this.hashCount;o++){const s=this.ye(n,i,o);if(!this.we(s))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new yy(o,i,r);return n.forEach(l=>s.insert(l)),s}insert(e){if(this.ge===0)return;const r=Tv(e),[n,i]=kv(r);for(let o=0;o<this.hashCount;o++){const s=this.ye(n,i,o);this.Se(s)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class cu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,ed.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new lp(Sr.min(),i,new mn(Fr),Es(),Or())}}class ed{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new ed(n,r,Or(),Or(),Or())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class L2{constructor(e,r){this.targetId=e,this.Ce=r}}class R2{constructor(e,r,n=ti.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class Nv{constructor(){this.ve=0,this.Fe=Lv(),this.Me=ti.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Or(),r=Or(),n=Or();return this.Fe.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:mr(38017,{changeType:o})}}),new ed(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=Lv()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Xr(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class p3{constructor(e){this.Ge=e,this.ze=new Map,this.je=Es(),this.Je=Rd(),this.He=Rd(),this.Ye=new mn(Fr)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:mr(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const o=i.target;if(cm(o))if(n===0){const s=new ar(o.path);this.et(r,s,pi.newNoDocument(s,Sr.min()))}else Xr(n===1,20013,{expectedCount:n});else{const s=this._t(r);if(s!==n){const l=this.ut(e),c=l?this.ct(l,e,s):1;if(c!==0){this.it(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,u)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let s,l;try{s=Ia(n).toUint8Array()}catch(c){if(c instanceof i2)return vc("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new yy(s,i,o)}catch(c){return vc(c instanceof cu?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.ge===0?null:l}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const s=this.Ge.ht(),l=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(l)||(this.et(r,o,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((o,s)=>{const l=this.ot(s);if(l){if(o.current&&cm(l.target)){const c=new ar(l.target.path);this.It(c).has(s)||this.Et(s,c)||this.et(s,c,pi.newNoDocument(c,e))}o.Be&&(r.set(s,o.ke()),o.qe())}});let n=Or();this.He.forEach((o,s)=>{let l=!0;s.forEachWhile(c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(o))}),this.je.forEach((o,s)=>s.setReadTime(e));const i=new lp(e,r,this.Ye,this.je,n);return this.je=Es(),this.Je=Rd(),this.He=Rd(),this.Ye=new mn(Fr),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new Nv,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new zn(Fr),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new zn(Fr),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Kt("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Nv),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Rd(){return new mn(ar.comparator)}function Lv(){return new mn(ar.comparator)}const f3={asc:"ASCENDING",desc:"DESCENDING"},m3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},y3={and:"AND",or:"OR"};class g3{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function hm(t,e){return t.useProto3Json||rp(e)?e:{value:e}}function Fh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function D2(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function v3(t,e){return Fh(t,e.toTimestamp())}function Ko(t){return Xr(!!t,49232),Sr.fromTimestamp(function(r){const n=Ca(r);return new hn(n.seconds,n.nanos)}(t))}function gy(t,e){return pm(t,e).canonicalString()}function pm(t,e){const r=function(i){return new un(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function M2(t){const e=un.fromString(t);return Xr(V2(e),10190,{key:e.toString()}),e}function fm(t,e){return gy(t.databaseId,e.path)}function Jp(t,e){const r=M2(e);if(r.get(1)!==t.databaseId.projectId)throw new Ut(ut.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ut(ut.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ar(O2(r))}function F2(t,e){return gy(t.databaseId,e)}function b3(t){const e=M2(t);return e.length===4?un.emptyPath():O2(e)}function mm(t){return new un(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function O2(t){return Xr(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Rv(t,e,r){return{name:fm(t,e),fields:r.value.mapValue.fields}}function _3(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:mr(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(u,h){return u.useProto3Json?(Xr(h===void 0||typeof h=="string",58123),ti.fromBase64String(h||"")):(Xr(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),ti.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,l=s&&function(u){const h=u.code===void 0?ut.UNKNOWN:N2(u.code);return new Ut(h,u.message||"")}(s);r=new R2(n,i,o,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Jp(t,n.document.name),o=Ko(n.document.updateTime),s=n.document.createTime?Ko(n.document.createTime):Sr.min(),l=new Mi({mapValue:{fields:n.document.fields}}),c=pi.newFoundDocument(i,o,s,l),u=n.targetIds||[],h=n.removedTargetIds||[];r=new lh(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Jp(t,n.document),o=n.readTime?Ko(n.readTime):Sr.min(),s=pi.newNoDocument(i,o),l=n.removedTargetIds||[];r=new lh([],l,s.key,s)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Jp(t,n.document),o=n.removedTargetIds||[];r=new lh([],o,i,null)}else{if(!("filter"in e))return mr(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,s=new c3(i,o),l=n.targetId;r=new L2(l,s)}}return r}function S3(t,e){let r;if(e instanceof Zu)r={update:Rv(t,e.key,e.value)};else if(e instanceof k2)r={delete:fm(t,e.key)};else if(e instanceof Ma)r={update:Rv(t,e.key,e.data),updateMask:T3(e.fieldMask)};else{if(!(e instanceof s3))return mr(16599,{Vt:e.type});r={verify:fm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,s){const l=s.transform;if(l instanceof Dh)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Bu)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ju)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Mh)return{fieldPath:s.field.canonicalString(),increment:l.Ae};throw mr(20930,{transform:s.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:v3(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:mr(27497)}(t,e.precondition)),r}function P3(t,e){return t&&t.length>0?(Xr(e!==void 0,14353),t.map(r=>function(i,o){let s=i.updateTime?Ko(i.updateTime):Ko(o);return s.isEqual(Sr.min())&&(s=Ko(o)),new n3(s,i.transformResults||[])}(r,e))):[]}function w3(t,e){return{documents:[F2(t,e.path)]}}function x3(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=F2(t,i);const o=function(u){if(u.length!==0)return j2(Eo.create(u,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const s=function(u){if(u.length!==0)return u.map(h=>function(g){return{field:oc(g.field),direction:I3(g.dir)}}(h))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const l=hm(t,e.limit);return l!==null&&(r.structuredQuery.limit=l),e.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:r,parent:i}}function A3(t){let e=b3(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Xr(n===1,65062);const h=r.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];r.where&&(o=function(y){const g=B2(y);return g instanceof Eo&&f2(g)?g.getFilters():[g]}(r.where));let s=[];r.orderBy&&(s=function(y){return y.map(g=>function(x){return new Ou(sc(x.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(g))}(r.orderBy));let l=null;r.limit&&(l=function(y){let g;return g=typeof y=="object"?y.value:y,rp(g)?null:g}(r.limit));let c=null;r.startAt&&(c=function(y){const g=!!y.before,f=y.values||[];return new Rh(f,g)}(r.startAt));let u=null;return r.endAt&&(u=function(y){const g=!y.before,f=y.values||[];return new Rh(f,g)}(r.endAt)),UC(e,i,s,o,l,"F",c,u)}function C3(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return mr(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function B2(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=sc(r.unaryFilter.field);return Dn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=sc(r.unaryFilter.field);return Dn.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=sc(r.unaryFilter.field);return Dn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=sc(r.unaryFilter.field);return Dn.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return mr(61313);default:return mr(60726)}}(t):t.fieldFilter!==void 0?function(r){return Dn.create(sc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return mr(58110);default:return mr(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Eo.create(r.compositeFilter.filters.map(n=>B2(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return mr(1026)}}(r.compositeFilter.op))}(t):mr(30097,{filter:t})}function I3(t){return f3[t]}function $3(t){return m3[t]}function E3(t){return y3[t]}function oc(t){return{fieldPath:t.canonicalString()}}function sc(t){return Zn.fromServerFormat(t.fieldPath)}function j2(t){return t instanceof Dn?function(r){if(r.op==="=="){if(Sv(r.value))return{unaryFilter:{field:oc(r.field),op:"IS_NAN"}};if(_v(r.value))return{unaryFilter:{field:oc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Sv(r.value))return{unaryFilter:{field:oc(r.field),op:"IS_NOT_NAN"}};if(_v(r.value))return{unaryFilter:{field:oc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:oc(r.field),op:$3(r.op),value:r.value}}}(t):t instanceof Eo?function(r){const n=r.getFilters().map(i=>j2(i));return n.length===1?n[0]:{compositeFilter:{op:E3(r.op),filters:n}}}(t):mr(54877,{filter:t})}function T3(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function V2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(e,r,n,i,o=Sr.min(),s=Sr.min(),l=ti.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new ma(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new ma(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ma(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ma(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{constructor(e){this.yt=e}}function N3(t){const e=A3({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?dm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(){this.Cn=new R3}addToCollectionParentIndex(e,r){return this.Cn.add(r),bt.resolve()}getCollectionParents(e,r){return bt.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return bt.resolve()}deleteFieldIndex(e,r){return bt.resolve()}deleteAllFieldIndexes(e){return bt.resolve()}createTargetIndexes(e,r){return bt.resolve()}getDocumentsMatchingTarget(e,r){return bt.resolve(null)}getIndexType(e,r){return bt.resolve(0)}getFieldIndexes(e,r){return bt.resolve([])}getNextCollectionGroupToUpdate(e){return bt.resolve(null)}getMinOffset(e,r){return bt.resolve(Aa.min())}getMinOffsetFromCollectionGroup(e,r){return bt.resolve(Aa.min())}updateCollectionGroup(e,r,n){return bt.resolve()}updateIndexEntries(e,r){return bt.resolve()}}class R3{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new zn(un.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new zn(un.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},q2=41943040;class Di{static withCacheSize(e){return new Di(e,Di.DEFAULT_COLLECTION_PERCENTILE,Di.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Di.DEFAULT_COLLECTION_PERCENTILE=10,Di.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Di.DEFAULT=new Di(q2,Di.DEFAULT_COLLECTION_PERCENTILE,Di.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Di.DISABLED=new Di(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Pc(0)}static cr(){return new Pc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mv="LruGarbageCollector",D3=1048576;function Fv([t,e],[r,n]){const i=Fr(t,r);return i===0?Fr(e,n):i}class M3{constructor(e){this.Ir=e,this.buffer=new zn(Fv),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();Fv(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class F3{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Kt(Mv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Ec(r)?Kt(Mv,"Ignoring IndexedDB error during garbage collection: ",r):await $c(r)}await this.Vr(3e5)})}}class O3{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return bt.resolve(tp.ce);const n=new M3(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Kt("LruGarbageCollector","Garbage collection skipped; disabled"),bt.resolve(Dv)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Kt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Dv):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,o,s,l,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(Kt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,s=Date.now(),this.nthSequenceNumber(e,i))).next(y=>(n=y,l=Date.now(),this.removeTargets(e,n,r))).next(y=>(o=y,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(y=>(u=Date.now(),nc()<=Mr.DEBUG&&Kt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(l-s)+`ms
	Removed ${o} targets in `+(c-l)+`ms
	Removed ${y} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),bt.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:y})))}}function B3(t,e){return new O3(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j3{constructor(){this.changes=new Cl(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,pi.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?bt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V3{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&bu(n.mutation,i,Ki.empty(),hn.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Or()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Or()){const i=cl();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let s=lu();return o.forEach((l,c)=>{s=s.insert(l,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,r){const n=cl();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Or()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,l)=>{r.set(s,l)})})}computeViews(e,r,n,i){let o=Es();const s=vu(),l=function(){return vu()}();return r.forEach((c,u)=>{const h=n.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof Ma)?o=o.insert(u.key,u):h!==void 0?(s.set(u.key,h.mutation.getFieldMask()),bu(h.mutation,u,h.mutation.getFieldMask(),hn.now())):s.set(u.key,Ki.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((u,h)=>s.set(u,h)),r.forEach((u,h)=>l.set(u,new V3(h,s.get(u)??null))),l))}recalculateAndSaveOverlays(e,r){const n=vu();let i=new mn((s,l)=>s-l),o=Or();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(s=>{for(const l of s)l.keys().forEach(c=>{const u=r.get(c);if(u===null)return;let h=n.get(c)||Ki.empty();h=l.applyToLocalView(u,h),n.set(c,h);const y=(i.get(l.batchId)||Or()).add(c);i=i.insert(l.batchId,y)})}).next(()=>{const s=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,h=c.value,y=w2();h.forEach(g=>{if(!o.has(g)){const f=E2(r.get(g),n.get(g));f!==null&&y.set(g,f),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,u,y))}return bt.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(s){return ar.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):v2(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):bt.resolve(cl());let l=Ru,c=o;return s.next(u=>bt.forEach(u,(h,y)=>(l<y.largestBatchId&&(l=y.largestBatchId),o.get(h)?bt.resolve():this.remoteDocumentCache.getEntry(e,h).next(g=>{c=c.insert(h,g)}))).next(()=>this.populateOverlays(e,u,o)).next(()=>this.computeViews(e,c,u,Or())).next(h=>({batchId:l,changes:P2(h)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ar(r)).next(n=>{let i=lu();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let s=lu();return this.indexManager.getCollectionParents(e,o).next(l=>bt.forEach(l,c=>{const u=function(y,g){return new Tc(g,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(r,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,u,n,i).next(h=>{h.forEach((y,g)=>{s=s.insert(y,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(s=>{o.forEach((c,u)=>{const h=u.getKey();s.get(h)===null&&(s=s.insert(h,pi.newInvalidDocument(h)))});let l=lu();return s.forEach((c,u)=>{const h=o.get(c);h!==void 0&&bu(h.mutation,u,Ki.empty(),hn.now()),op(r,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return bt.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Ko(i.createTime)}}(r)),bt.resolve()}getNamedQuery(e,r){return bt.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:N3(i.bundledQuery),readTime:Ko(i.readTime)}}(r)),bt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(){this.overlays=new mn(ar.comparator),this.qr=new Map}getOverlay(e,r){return bt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=cl();return bt.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.St(e,r,o)}),bt.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(n)),bt.resolve()}getOverlaysForCollection(e,r,n){const i=cl(),o=r.length+1,s=new ar(r.child("")),l=this.overlays.getIteratorFrom(s);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===o&&c.largestBatchId>n&&i.set(c.getKey(),c)}return bt.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new mn((u,h)=>u-h);const s=this.overlays.getIterator();for(;s.hasNext();){const u=s.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let h=o.get(u.largestBatchId);h===null&&(h=cl(),o=o.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const l=cl(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,h)=>l.set(u,h)),!(l.size()>=i)););return bt.resolve(l)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new l3(r,n));let o=this.qr.get(r);o===void 0&&(o=Or(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H3{constructor(){this.sessionToken=ti.EMPTY_BYTE_STRING}getSessionToken(e){return bt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,bt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(){this.Qr=new zn(Gn.$r),this.Ur=new zn(Gn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new Gn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new Gn(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new ar(new un([])),n=new Gn(r,e),i=new Gn(r,e+1),o=[];return this.Ur.forEachInRange([n,i],s=>{this.Gr(s),o.push(s.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new ar(new un([])),n=new Gn(r,e),i=new Gn(r,e+1);let o=Or();return this.Ur.forEachInRange([n,i],s=>{o=o.add(s.key)}),o}containsKey(e){const r=new Gn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Gn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return ar.comparator(e.key,r.key)||Fr(e.Yr,r.Yr)}static Kr(e,r){return Fr(e.Yr,r.Yr)||ar.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G3{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new zn(Gn.$r)}checkEmpty(e){return bt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new a3(o,r,n,i);this.mutationQueue.push(s);for(const l of i)this.Zr=this.Zr.add(new Gn(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return bt.resolve(s)}lookupMutationBatch(e,r){return bt.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),o=i<0?0:i;return bt.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return bt.resolve(this.mutationQueue.length===0?ly:this.tr-1)}getAllMutationBatches(e){return bt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Gn(r,0),i=new Gn(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,i],s=>{const l=this.Xr(s.Yr);o.push(l)}),bt.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new zn(Fr);return r.forEach(i=>{const o=new Gn(i,0),s=new Gn(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,s],l=>{n=n.add(l.Yr)})}),bt.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;ar.isDocumentKey(o)||(o=o.child(""));const s=new Gn(new ar(o),0);let l=new zn(Fr);return this.Zr.forEachWhile(c=>{const u=c.key.path;return!!n.isPrefixOf(u)&&(u.length===i&&(l=l.add(c.Yr)),!0)},s),bt.resolve(this.ti(l))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Xr(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return bt.forEach(r.mutations,i=>{const o=new Gn(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new Gn(r,0),i=this.Zr.firstAfterOrEqual(n);return bt.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,bt.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{constructor(e){this.ri=e,this.docs=function(){return new mn(ar.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,s=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return bt.resolve(n?n.document.mutableCopy():pi.newInvalidDocument(r))}getEntries(e,r){let n=Es();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():pi.newInvalidDocument(i))}),bt.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=Es();const s=r.path,l=new ar(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!s.isPrefixOf(u.path))break;u.path.length>s.length+1||PC(SC(h),n)<=0||(i.has(h.key)||op(r,h))&&(o=o.insert(h.key,h.mutableCopy()))}return bt.resolve(o)}getAllFromCollectionGroup(e,r,n,i){mr(9500)}ii(e,r){return bt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new Y3(this)}getSize(e){return bt.resolve(this.size)}}class Y3 extends j3{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),bt.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K3{constructor(e){this.persistence=e,this.si=new Cl(r=>dy(r),hy),this.lastRemoteSnapshotVersion=Sr.min(),this.highestTargetId=0,this.oi=0,this._i=new vy,this.targetCount=0,this.ai=Pc.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),bt.resolve()}getLastRemoteSnapshotVersion(e){return bt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return bt.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),bt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),bt.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Pc(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,bt.resolve()}updateTargetData(e,r){return this.Pr(r),bt.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,bt.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.si.forEach((s,l)=>{l.sequenceNumber<=r&&n.get(l.targetId)===null&&(this.si.delete(s),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),bt.waitFor(o).next(()=>i)}getTargetCount(e){return bt.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return bt.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),bt.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),bt.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),bt.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return bt.resolve(n)}containsKey(e,r){return bt.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e,r){this.ui={},this.overlays={},this.ci=new tp(0),this.li=!1,this.li=!0,this.hi=new H3,this.referenceDelegate=e(this),this.Pi=new K3(this),this.indexManager=new L3,this.remoteDocumentCache=function(i){return new W3(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new k3(r),this.Ii=new z3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new U3,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new G3(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Kt("MemoryPersistence","Starting transaction:",e);const i=new J3(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ai(e,r){return bt.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class J3 extends xC{constructor(e){super(),this.currentSequenceNumber=e}}class by{constructor(e){this.persistence=e,this.Ri=new vy,this.Vi=null}static mi(e){return new by(e)}get fi(){if(this.Vi)return this.Vi;throw mr(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),bt.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),bt.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),bt.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.fi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return bt.forEach(this.fi,n=>{const i=ar.fromPath(n);return this.gi(e,i).next(o=>{o||r.removeEntry(i,Sr.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return bt.or([()=>bt.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Oh{constructor(e,r){this.persistence=e,this.pi=new Cl(n=>IC(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=B3(this,r)}static mi(e,r){return new Oh(e,r)}Ei(){}di(e){return bt.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return bt.forEach(this.pi,(n,i)=>this.br(e,n,i).next(o=>o?bt.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ii(e,s=>this.br(e,s,r).next(l=>{l||(n++,o.removeEntry(s,Sr.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),bt.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),bt.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),bt.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),bt.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=oh(e.data.value)),r}br(e,r,n){return bt.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return bt.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=Or(),i=Or();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new _y(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X3{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return qP()?8:AC(vi())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ys(e,r).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ws(e,r,i,n).next(s=>{o.result=s})}).next(()=>{if(o.result)return;const s=new Q3;return this.Ss(e,r,s).next(l=>{if(o.result=l,this.Vs)return this.bs(e,r,s,l.size)})}).next(()=>o.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(nc()<=Mr.DEBUG&&Kt("QueryEngine","SDK will not create cache indexes for query:",ic(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),bt.resolve()):(nc()<=Mr.DEBUG&&Kt("QueryEngine","Query:",ic(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(nc()<=Mr.DEBUG&&Kt("QueryEngine","The SDK decides to create cache indexes for query:",ic(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wo(r))):bt.resolve())}ys(e,r){if(Av(r))return bt.resolve(null);let n=Wo(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=dm(r,null,"F"),n=Wo(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const s=Or(...o);return this.ps.getDocuments(e,s).next(l=>this.indexManager.getMinOffset(e,n).next(c=>{const u=this.Ds(r,l);return this.Cs(r,u,s,c.readTime)?this.ys(e,dm(r,null,"F")):this.vs(e,u,r,c)}))})))}ws(e,r,n,i){return Av(r)||i.isEqual(Sr.min())?bt.resolve(null):this.ps.getDocuments(e,n).next(o=>{const s=this.Ds(r,o);return this.Cs(r,s,n,i)?bt.resolve(null):(nc()<=Mr.DEBUG&&Kt("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ic(r)),this.vs(e,s,r,_C(i,Ru)).next(l=>l))})}Ds(e,r){let n=new zn(_2(e));return r.forEach((i,o)=>{op(e,o)&&(n=n.add(o))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Ss(e,r,n){return nc()<=Mr.DEBUG&&Kt("QueryEngine","Using full collection scan to execute query:",ic(r)),this.ps.getDocumentsMatchingQuery(e,r,Aa.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(s=>{o=o.insert(s.key,s)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sy="LocalStore",Z3=3e8;class e4{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new mn(Fr),this.xs=new Cl(o=>dy(o),hy),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new q3(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function t4(t,e,r,n){return new e4(t,e,r,n)}async function U2(t,e){const r=Cr(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const s=[],l=[];let c=Or();for(const u of i){s.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of o){l.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return r.localDocuments.getDocuments(n,c).next(u=>({Ls:u,removedBatchIds:s,addedBatchIds:l}))})})}function r4(t,e){const r=Cr(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return function(l,c,u,h){const y=u.batch,g=y.keys();let f=bt.resolve();return g.forEach(x=>{f=f.next(()=>h.getEntry(c,x)).next(S=>{const P=u.docVersions.get(x);Xr(P!==null,48541),S.version.compareTo(P)<0&&(y.applyToRemoteDocument(S,u),S.isValidDocument()&&(S.setReadTime(u.commitVersion),h.addEntry(S)))})}),f.next(()=>l.mutationQueue.removeMutationBatch(c,y))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let c=Or();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function H2(t){const e=Cr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function n4(t,e){const r=Cr(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const l=[];e.targetChanges.forEach((h,y)=>{const g=i.get(y);if(!g)return;l.push(r.Pi.removeMatchingKeys(o,h.removedDocuments,y).next(()=>r.Pi.addMatchingKeys(o,h.addedDocuments,y)));let f=g.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(y)!==null?f=f.withResumeToken(ti.EMPTY_BYTE_STRING,Sr.min()).withLastLimboFreeSnapshotVersion(Sr.min()):h.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(h.resumeToken,n)),i=i.insert(y,f),function(S,P,$){return S.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=Z3?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0}(g,f,h)&&l.push(r.Pi.updateTargetData(o,f))});let c=Es(),u=Or();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(r.persistence.referenceDelegate.updateLimboDocument(o,h))}),l.push(i4(o,s,e.documentUpdates).next(h=>{c=h.ks,u=h.qs})),!n.isEqual(Sr.min())){const h=r.Pi.getLastRemoteSnapshotVersion(o).next(y=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n));l.push(h)}return bt.waitFor(l).next(()=>s.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,c,u)).next(()=>c)}).then(o=>(r.Ms=i,o))}function i4(t,e,r){let n=Or(),i=Or();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let s=Es();return r.forEach((l,c)=>{const u=o.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(Sr.min())?(e.removeEntry(l,c.readTime),s=s.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),s=s.insert(l,c)):Kt(Sy,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{ks:s,qs:i}})}function o4(t,e){const r=Cr(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=ly),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function s4(t,e){const r=Cr(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(o=>o?(i=o,bt.resolve(i)):r.Pi.allocateTargetId(n).next(s=>(i=new ma(e,s,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function ym(t,e,r){const n=Cr(t),i=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,s=>n.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!Ec(s))throw s;Kt(Sy,`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Ov(t,e,r){const n=Cr(t);let i=Sr.min(),o=Or();return n.persistence.runTransaction("Execute query","readwrite",s=>function(c,u,h){const y=Cr(c),g=y.xs.get(h);return g!==void 0?bt.resolve(y.Ms.get(g)):y.Pi.getTargetData(u,h)}(n,s,Wo(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(s,l.targetId).next(c=>{o=c})}).next(()=>n.Fs.getDocumentsMatchingQuery(s,e,r?i:Sr.min(),r?o:Or())).next(l=>(a4(n,GC(e),l),{documents:l,Qs:o})))}function a4(t,e,r){let n=t.Os.get(e)||Sr.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Os.set(e,n)}class Bv{constructor(){this.activeTargetIds=XC()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class l4{constructor(){this.Mo=new Bv,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Bv,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv="ConnectivityMonitor";class Vv{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Kt(jv,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Kt(jv,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dd=null;function gm(){return Dd===null?Dd=function(){return 268435456+Math.round(2147483648*Math.random())}():Dd++,"0x"+Dd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qp="RestConnection",u4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class d4{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===Nh?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,o){const s=gm(),l=this.zo(e,r.toUriEncodedString());Kt(Qp,`Sending RPC '${e}' ${s}:`,l,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,o);const{host:u}=new URL(l),h=xc(u);return this.Jo(e,l,c,n,h).then(y=>(Kt(Qp,`Received RPC '${e}' ${s}: `,y),y),y=>{throw vc(Qp,`RPC '${e}' ${s} failed with error: `,y,"url: ",l,"request:",n),y})}Ho(e,r,n,i,o,s){return this.Go(e,r,n,i,o)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ic}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}zo(e,r){const n=u4[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h4{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ii="WebChannelConnection";class p4 extends d4{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,o){const s=gm();return new Promise((l,c)=>{const u=new W1;u.setWithCredentials(!0),u.listenOnce(Y1.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case ih.NO_ERROR:const y=u.getResponseJson();Kt(ii,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(y)),l(y);break;case ih.TIMEOUT:Kt(ii,`RPC '${e}' ${s} timed out`),c(new Ut(ut.DEADLINE_EXCEEDED,"Request time out"));break;case ih.HTTP_ERROR:const g=u.getStatus();if(Kt(ii,`RPC '${e}' ${s} failed with status:`,g,"response text:",u.getResponseText()),g>0){let f=u.getResponseJson();Array.isArray(f)&&(f=f[0]);const x=f?.error;if(x&&x.status&&x.message){const S=function($){const U=$.toLowerCase().replace(/_/g,"-");return Object.values(ut).indexOf(U)>=0?U:ut.UNKNOWN}(x.status);c(new Ut(S,x.message))}else c(new Ut(ut.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new Ut(ut.UNAVAILABLE,"Connection failed."));break;default:mr(9055,{l_:e,streamId:s,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Kt(ii,`RPC '${e}' ${s} completed.`)}});const h=JSON.stringify(i);Kt(ii,`RPC '${e}' ${s} sending request:`,i),u.send(r,"POST",h,n,15)})}T_(e,r,n){const i=gm(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Q1(),l=J1(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const h=o.join("");Kt(ii,`Creating RPC '${e}' stream ${i}: ${h}`,c);const y=s.createWebChannel(h,c);this.I_(y);let g=!1,f=!1;const x=new h4({Yo:P=>{f?Kt(ii,`Not sending because RPC '${e}' stream ${i} is closed:`,P):(g||(Kt(ii,`Opening RPC '${e}' stream ${i} transport.`),y.open(),g=!0),Kt(ii,`RPC '${e}' stream ${i} sending:`,P),y.send(P))},Zo:()=>y.close()}),S=(P,$,U)=>{P.listen($,se=>{try{U(se)}catch(X){setTimeout(()=>{throw X},0)}})};return S(y,au.EventType.OPEN,()=>{f||(Kt(ii,`RPC '${e}' stream ${i} transport opened.`),x.o_())}),S(y,au.EventType.CLOSE,()=>{f||(f=!0,Kt(ii,`RPC '${e}' stream ${i} transport closed`),x.a_(),this.E_(y))}),S(y,au.EventType.ERROR,P=>{f||(f=!0,vc(ii,`RPC '${e}' stream ${i} transport errored. Name:`,P.name,"Message:",P.message),x.a_(new Ut(ut.UNAVAILABLE,"The operation could not be completed")))}),S(y,au.EventType.MESSAGE,P=>{if(!f){const $=P.data[0];Xr(!!$,16349);const U=$,se=U?.error||U[0]?.error;if(se){Kt(ii,`RPC '${e}' stream ${i} received error:`,se);const X=se.status;let Z=function(C){const T=Rn[C];if(T!==void 0)return N2(T)}(X),re=se.message;Z===void 0&&(Z=ut.INTERNAL,re="Unknown error status: "+X+" with message "+se.message),f=!0,x.a_(new Ut(Z,re)),y.close()}else Kt(ii,`RPC '${e}' stream ${i} received:`,$),x.u_($)}}),S(l,K1.STAT_EVENT,P=>{P.stat===im.PROXY?Kt(ii,`RPC '${e}' stream ${i} detected buffering proxy`):P.stat===im.NOPROXY&&Kt(ii,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{x.__()},0),x}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Xp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cp(t){return new g3(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&Kt("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qv="PersistentStream";class W2{constructor(e,r,n,i,o,s,l,c){this.Mi=e,this.S_=n,this.b_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new G2(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===ut.RESOURCE_EXHAUSTED?(Is(r.toString()),Is("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===ut.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new Ut(ut.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Kt(qv,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Kt(qv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class f4 extends W2{constructor(e,r,n,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,s),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=_3(this.serializer,e),n=function(o){if(!("targetChange"in o))return Sr.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?Sr.min():s.readTime?Ko(s.readTime):Sr.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=mm(this.serializer),r.addTarget=function(o,s){let l;const c=s.target;if(l=cm(c)?{documents:w3(o,c)}:{query:x3(o,c).ft},l.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){l.resumeToken=D2(o,s.resumeToken);const u=hm(o,s.expectedCount);u!==null&&(l.expectedCount=u)}else if(s.snapshotVersion.compareTo(Sr.min())>0){l.readTime=Fh(o,s.snapshotVersion.toTimestamp());const u=hm(o,s.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const n=C3(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=mm(this.serializer),r.removeTarget=e,this.q_(r)}}class m4 extends W2{constructor(e,r,n,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,s),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Xr(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Xr(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Xr(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=P3(e.writeResults,e.commitTime),n=Ko(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=mm(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>S3(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y4{}class g4 extends y4{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Ut(ut.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Go(e,pm(r,n),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===ut.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ut(ut.UNKNOWN,o.toString())})}Ho(e,r,n,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,l])=>this.connection.Ho(e,pm(r,n),i,s,l,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ut.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ut(ut.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class v4{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Is(r),this.aa=!1):Kt("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl="RemoteStore";class b4{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(s=>{n.enqueueAndForget(async()=>{Il(this)&&(Kt(wl,"Restarting streams for network reachability change."),await async function(c){const u=Cr(c);u.Ea.add(4),await td(u),u.Ra.set("Unknown"),u.Ea.delete(4),await up(u)}(this))})}),this.Ra=new v4(n,i)}}async function up(t){if(Il(t))for(const e of t.da)await e(!0)}async function td(t){for(const e of t.da)await e(!1)}function Y2(t,e){const r=Cr(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Ay(r)?xy(r):kc(r).O_()&&wy(r,e))}function Py(t,e){const r=Cr(t),n=kc(r);r.Ia.delete(e),n.O_()&&K2(r,e),r.Ia.size===0&&(n.O_()?n.L_():Il(r)&&r.Ra.set("Unknown"))}function wy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Sr.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}kc(t).Y_(e)}function K2(t,e){t.Va.Ue(e),kc(t).Z_(e)}function xy(t){t.Va=new p3({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),kc(t).start(),t.Ra.ua()}function Ay(t){return Il(t)&&!kc(t).x_()&&t.Ia.size>0}function Il(t){return Cr(t).Ea.size===0}function J2(t){t.Va=void 0}async function _4(t){t.Ra.set("Online")}async function S4(t){t.Ia.forEach((e,r)=>{wy(t,e)})}async function P4(t,e){J2(t),Ay(t)?(t.Ra.ha(e),xy(t)):t.Ra.set("Unknown")}async function w4(t,e,r){if(t.Ra.set("Online"),e instanceof R2&&e.state===2&&e.cause)try{await async function(i,o){const s=o.cause;for(const l of o.targetIds)i.Ia.has(l)&&(await i.remoteSyncer.rejectListen(l,s),i.Ia.delete(l),i.Va.removeTarget(l))}(t,e)}catch(n){Kt(wl,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Bh(t,n)}else if(e instanceof lh?t.Va.Ze(e):e instanceof L2?t.Va.st(e):t.Va.tt(e),!r.isEqual(Sr.min()))try{const n=await H2(t.localStore);r.compareTo(n)>=0&&await function(o,s){const l=o.Va.Tt(s);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=o.Ia.get(u);h&&o.Ia.set(u,h.withResumeToken(c.resumeToken,s))}}),l.targetMismatches.forEach((c,u)=>{const h=o.Ia.get(c);if(!h)return;o.Ia.set(c,h.withResumeToken(ti.EMPTY_BYTE_STRING,h.snapshotVersion)),K2(o,c);const y=new ma(h.target,c,u,h.sequenceNumber);wy(o,y)}),o.remoteSyncer.applyRemoteEvent(l)}(t,r)}catch(n){Kt(wl,"Failed to raise snapshot:",n),await Bh(t,n)}}async function Bh(t,e,r){if(!Ec(e))throw e;t.Ea.add(1),await td(t),t.Ra.set("Offline"),r||(r=()=>H2(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Kt(wl,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await up(t)})}function Q2(t,e){return e().catch(r=>Bh(t,r,e))}async function dp(t){const e=Cr(t),r=Ea(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ly;for(;x4(e);)try{const i=await o4(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,A4(e,i)}catch(i){await Bh(e,i)}X2(e)&&Z2(e)}function x4(t){return Il(t)&&t.Ta.length<10}function A4(t,e){t.Ta.push(e);const r=Ea(t);r.O_()&&r.X_&&r.ea(e.mutations)}function X2(t){return Il(t)&&!Ea(t).x_()&&t.Ta.length>0}function Z2(t){Ea(t).start()}async function C4(t){Ea(t).ra()}async function I4(t){const e=Ea(t);for(const r of t.Ta)e.ea(r.mutations)}async function $4(t,e,r){const n=t.Ta.shift(),i=my.from(n,e,r);await Q2(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await dp(t)}async function E4(t,e){e&&Ea(t).X_&&await async function(n,i){if(function(s){return u3(s)&&s!==ut.ABORTED}(i.code)){const o=n.Ta.shift();Ea(n).B_(),await Q2(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await dp(n)}}(t,e),X2(t)&&Z2(t)}async function zv(t,e){const r=Cr(t);r.asyncQueue.verifyOperationInProgress(),Kt(wl,"RemoteStore received new credentials");const n=Il(r);r.Ea.add(3),await td(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await up(r)}async function T4(t,e){const r=Cr(t);e?(r.Ea.delete(2),await up(r)):e||(r.Ea.add(2),await td(r),r.Ra.set("Unknown"))}function kc(t){return t.ma||(t.ma=function(r,n,i){const o=Cr(r);return o.sa(),new f4(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:_4.bind(null,t),t_:S4.bind(null,t),r_:P4.bind(null,t),H_:w4.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Ay(t)?xy(t):t.Ra.set("Unknown")):(await t.ma.stop(),J2(t))})),t.ma}function Ea(t){return t.fa||(t.fa=function(r,n,i){const o=Cr(r);return o.sa(),new m4(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:C4.bind(null,t),r_:E4.bind(null,t),ta:I4.bind(null,t),na:$4.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await dp(t)):(await t.fa.stop(),t.Ta.length>0&&(Kt(wl,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new xs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const s=Date.now()+n,l=new Cy(e,r,s,i,o);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ut(ut.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Iy(t,e){if(Is("AsyncQueue",`${e}: ${t}`),Ec(t))return new Ut(ut.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{static emptySet(e){return new pc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||ar.comparator(r.key,n.key):(r,n)=>ar.comparator(r.key,n.key),this.keyedMap=lu(),this.sortedSet=new mn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof pc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new pc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(){this.ga=new mn(ar.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):mr(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class wc{constructor(e,r,n,i,o,s,l,c,u){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,r,n,i,o){const s=[];return r.forEach(l=>{s.push({type:0,doc:l})}),new wc(e,r,pc.emptySet(r),s,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ip(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class N4{constructor(){this.queries=Hv(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=Cr(r),o=i.queries;i.queries=Hv(),o.forEach((s,l)=>{for(const c of l.Sa)c.onError(n)})})(this,new Ut(ut.ABORTED,"Firestore shutting down"))}}function Hv(){return new Cl(t=>b2(t),ip)}async function e5(t,e){const r=Cr(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.ba()&&e.Da()&&(n=2):(o=new k4,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(i,!0);break;case 1:o.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(s){const l=Iy(s,`Initialization of query '${ic(e.query)}' failed`);return void e.onError(l)}r.queries.set(i,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&$y(r)}async function t5(t,e){const r=Cr(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const s=o.Sa.indexOf(e);s>=0&&(o.Sa.splice(s,1),o.Sa.length===0?i=e.Da()?0:1:!o.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function L4(t,e){const r=Cr(t);let n=!1;for(const i of e){const o=i.query,s=r.queries.get(o);if(s){for(const l of s.Sa)l.Fa(i)&&(n=!0);s.wa=i}}n&&$y(r)}function R4(t,e,r){const n=Cr(t),i=n.queries.get(e);if(i)for(const o of i.Sa)o.onError(r);n.queries.delete(e)}function $y(t){t.Ca.forEach(e=>{e.next()})}var vm,Gv;(Gv=vm||(vm={})).Ma="default",Gv.Cache="cache";class r5{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new wc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=wc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==vm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n5{constructor(e){this.key=e}}class i5{constructor(e){this.key=e}}class D4{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Or(),this.mutatedKeys=Or(),this.eu=_2(e),this.tu=new pc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Uv,i=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,s=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,y)=>{const g=i.get(h),f=op(this.query,y)?y:null,x=!!g&&this.mutatedKeys.has(g.key),S=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let P=!1;g&&f?g.data.isEqual(f.data)?x!==S&&(n.track({type:3,doc:f}),P=!0):this.su(g,f)||(n.track({type:2,doc:f}),P=!0,(c&&this.eu(f,c)>0||u&&this.eu(f,u)<0)&&(l=!0)):!g&&f?(n.track({type:0,doc:f}),P=!0):g&&!f&&(n.track({type:1,doc:g}),P=!0,(c||u)&&(l=!0)),P&&(f?(s=s.add(f),o=S?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),n.track({type:1,doc:h})}return{tu:s,iu:n,Cs:l,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((h,y)=>function(f,x){const S=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return mr(20277,{Rt:P})}};return S(f)-S(x)}(h.type,y.type)||this.eu(h.doc,y.doc)),this.ou(n),i=i??!1;const l=r&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,u=c!==this.Za;return this.Za=c,s.length!==0||u?{snapshot:new wc(this.query,e.tu,o,s,e.mutatedKeys,c===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Uv,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Or(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new i5(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new n5(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Or();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return wc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Ey="SyncEngine";class M4{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class F4{constructor(e){this.key=e,this.hu=!1}}class O4{constructor(e,r,n,i,o,s){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Cl(l=>b2(l),ip),this.Iu=new Map,this.Eu=new Set,this.du=new mn(ar.comparator),this.Au=new Map,this.Ru=new vy,this.Vu={},this.mu=new Map,this.fu=Pc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function B4(t,e,r=!0){const n=u5(t);let i;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await o5(n,e,r,!0),i}async function j4(t,e){const r=u5(t);await o5(r,e,!0,!1)}async function o5(t,e,r,n){const i=await s4(t.localStore,Wo(e)),o=i.targetId,s=t.sharedClientState.addLocalQueryTarget(o,r);let l;return n&&(l=await V4(t,e,o,s==="current",i.resumeToken)),t.isPrimaryClient&&r&&Y2(t.remoteStore,i),l}async function V4(t,e,r,n,i){t.pu=(y,g,f)=>async function(S,P,$,U){let se=P.view.ru($);se.Cs&&(se=await Ov(S.localStore,P.query,!1).then(({documents:E})=>P.view.ru(E,se)));const X=U&&U.targetChanges.get(P.targetId),Z=U&&U.targetMismatches.get(P.targetId)!=null,re=P.view.applyChanges(se,S.isPrimaryClient,X,Z);return Yv(S,P.targetId,re.au),re.snapshot}(t,y,g,f);const o=await Ov(t.localStore,e,!0),s=new D4(e,o.Qs),l=s.ru(o.documents),c=ed.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),u=s.applyChanges(l,t.isPrimaryClient,c);Yv(t,r,u.au);const h=new M4(e,r,s);return t.Tu.set(e,h),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),u.snapshot}async function q4(t,e,r){const n=Cr(t),i=n.Tu.get(e),o=n.Iu.get(i.targetId);if(o.length>1)return n.Iu.set(i.targetId,o.filter(s=>!ip(s,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await ym(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Py(n.remoteStore,i.targetId),bm(n,i.targetId)}).catch($c)):(bm(n,i.targetId),await ym(n.localStore,i.targetId,!0))}async function z4(t,e){const r=Cr(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Py(r.remoteStore,n.targetId))}async function U4(t,e,r){const n=Q4(t);try{const i=await function(s,l){const c=Cr(s),u=hn.now(),h=l.reduce((f,x)=>f.add(x.key),Or());let y,g;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let x=Es(),S=Or();return c.Ns.getEntries(f,h).next(P=>{x=P,x.forEach(($,U)=>{U.isValidDocument()||(S=S.add($))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,x)).next(P=>{y=P;const $=[];for(const U of l){const se=o3(U,y.get(U.key).overlayedDocument);se!=null&&$.push(new Ma(U.key,se,d2(se.value.mapValue),Yo.exists(!0)))}return c.mutationQueue.addMutationBatch(f,u,$,l)}).next(P=>{g=P;const $=P.applyToLocalDocumentSet(y,S);return c.documentOverlayCache.saveOverlays(f,P.batchId,$)})}).then(()=>({batchId:g.batchId,changes:P2(y)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,l,c){let u=s.Vu[s.currentUser.toKey()];u||(u=new mn(Fr)),u=u.insert(l,c),s.Vu[s.currentUser.toKey()]=u}(n,i.batchId,r),await rd(n,i.changes),await dp(n.remoteStore)}catch(i){const o=Iy(i,"Failed to persist write");r.reject(o)}}async function s5(t,e){const r=Cr(t);try{const n=await n4(r.localStore,e);e.targetChanges.forEach((i,o)=>{const s=r.Au.get(o);s&&(Xr(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?Xr(s.hu,14607):i.removedDocuments.size>0&&(Xr(s.hu,42227),s.hu=!1))}),await rd(r,n,e)}catch(n){await $c(n)}}function Wv(t,e,r){const n=Cr(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((o,s)=>{const l=s.view.va(e);l.snapshot&&i.push(l.snapshot)}),function(s,l){const c=Cr(s);c.onlineState=l;let u=!1;c.queries.forEach((h,y)=>{for(const g of y.Sa)g.va(l)&&(u=!0)}),u&&$y(c)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function H4(t,e,r){const n=Cr(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),o=i&&i.key;if(o){let s=new mn(ar.comparator);s=s.insert(o,pi.newNoDocument(o,Sr.min()));const l=Or().add(o),c=new lp(Sr.min(),new Map,new mn(Fr),s,l);await s5(n,c),n.du=n.du.remove(o),n.Au.delete(e),Ty(n)}else await ym(n.localStore,e,!1).then(()=>bm(n,e,r)).catch($c)}async function G4(t,e){const r=Cr(t),n=e.batch.batchId;try{const i=await r4(r.localStore,e);l5(r,n,null),a5(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await rd(r,i)}catch(i){await $c(i)}}async function W4(t,e,r){const n=Cr(t);try{const i=await function(s,l){const c=Cr(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,l).next(y=>(Xr(y!==null,37113),h=y.keys(),c.mutationQueue.removeMutationBatch(u,y))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(n.localStore,e);l5(n,e,r),a5(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await rd(n,i)}catch(i){await $c(i)}}function a5(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function l5(t,e,r){const n=Cr(t);let i=n.Vu[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function bm(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||c5(t,n)})}function c5(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Py(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Ty(t))}function Yv(t,e,r){for(const n of r)n instanceof n5?(t.Ru.addReference(n.key,e),Y4(t,n)):n instanceof i5?(Kt(Ey,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||c5(t,n.key)):mr(19791,{wu:n})}function Y4(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Kt(Ey,"New document in limbo: "+r),t.Eu.add(n),Ty(t))}function Ty(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new ar(un.fromString(e)),n=t.fu.next();t.Au.set(n,new F4(r)),t.du=t.du.insert(r,n),Y2(t.remoteStore,new ma(Wo(py(r.path)),n,"TargetPurposeLimboResolution",tp.ce))}}async function rd(t,e,r){const n=Cr(t),i=[],o=[],s=[];n.Tu.isEmpty()||(n.Tu.forEach((l,c)=>{s.push(n.pu(c,e,r).then(u=>{if((u||r)&&n.isPrimaryClient){const h=u?!u.fromCache:r?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){i.push(u);const h=_y.As(c.targetId,u);o.push(h)}}))}),await Promise.all(s),n.Pu.H_(i),await async function(c,u){const h=Cr(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>bt.forEach(u,g=>bt.forEach(g.Es,f=>h.persistence.referenceDelegate.addReference(y,g.targetId,f)).next(()=>bt.forEach(g.ds,f=>h.persistence.referenceDelegate.removeReference(y,g.targetId,f)))))}catch(y){if(!Ec(y))throw y;Kt(Sy,"Failed to update sequence numbers: "+y)}for(const y of u){const g=y.targetId;if(!y.fromCache){const f=h.Ms.get(g),x=f.snapshotVersion,S=f.withLastLimboFreeSnapshotVersion(x);h.Ms=h.Ms.insert(g,S)}}}(n.localStore,o))}async function K4(t,e){const r=Cr(t);if(!r.currentUser.isEqual(e)){Kt(Ey,"User change. New user:",e.toKey());const n=await U2(r.localStore,e);r.currentUser=e,function(o,s){o.mu.forEach(l=>{l.forEach(c=>{c.reject(new Ut(ut.CANCELLED,s))})}),o.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await rd(r,n.Ls)}}function J4(t,e){const r=Cr(t),n=r.Au.get(e);if(n&&n.hu)return Or().add(n.key);{let i=Or();const o=r.Iu.get(e);if(!o)return i;for(const s of o){const l=r.Tu.get(s);i=i.unionWith(l.view.nu)}return i}}function u5(t){const e=Cr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=s5.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=J4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=H4.bind(null,e),e.Pu.H_=L4.bind(null,e.eventManager),e.Pu.yu=R4.bind(null,e.eventManager),e}function Q4(t){const e=Cr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=G4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=W4.bind(null,e),e}class jh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=cp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return t4(this.persistence,new X3,e.initialUser,this.serializer)}Cu(e){return new z2(by.mi,this.serializer)}Du(e){return new l4}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jh.provider={build:()=>new jh};class X4 extends jh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Xr(this.persistence.referenceDelegate instanceof Oh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new F3(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Di.withCacheSize(this.cacheSizeBytes):Di.DEFAULT;return new z2(n=>Oh.mi(n,r),this.serializer)}}class _m{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Wv(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=K4.bind(null,this.syncEngine),await T4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new N4}()}createDatastore(e){const r=cp(e.databaseInfo.databaseId),n=function(o){return new p4(o)}(e.databaseInfo);return function(o,s,l,c){return new g4(o,s,l,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,s,l){return new b4(n,i,o,s,l)}(this.localStore,this.datastore,e.asyncQueue,r=>Wv(this.syncEngine,r,0),function(){return Vv.v()?new Vv:new c4}())}createSyncEngine(e,r){return function(i,o,s,l,c,u,h){const y=new O4(i,o,s,l,c,u);return h&&(y.gu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=Cr(r);Kt(wl,"RemoteStore shutting down."),n.Ea.add(5),await td(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}_m.provider={build:()=>new _m};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d5{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Is("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ta="FirestoreClient";class Z4{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=hi.UNAUTHENTICATED,this.clientId=ay.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async s=>{Kt(Ta,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(Kt(Ta,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new xs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Iy(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Zp(t,e){t.asyncQueue.verifyOperationInProgress(),Kt(Ta,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await U2(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Kv(t,e){t.asyncQueue.verifyOperationInProgress();const r=await eI(t);Kt(Ta,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>zv(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>zv(e.remoteStore,i)),t._onlineComponents=e}async function eI(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Kt(Ta,"Using user provided OfflineComponentProvider");try{await Zp(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===ut.FAILED_PRECONDITION||i.code===ut.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;vc("Error using user provided cache. Falling back to memory cache: "+r),await Zp(t,new jh)}}else Kt(Ta,"Using default OfflineComponentProvider"),await Zp(t,new X4(void 0));return t._offlineComponents}async function h5(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Kt(Ta,"Using user provided OnlineComponentProvider"),await Kv(t,t._uninitializedComponentsProvider._online)):(Kt(Ta,"Using default OnlineComponentProvider"),await Kv(t,new _m))),t._onlineComponents}function tI(t){return h5(t).then(e=>e.syncEngine)}async function p5(t){const e=await h5(t),r=e.eventManager;return r.onListen=B4.bind(null,e.syncEngine),r.onUnlisten=q4.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=j4.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=z4.bind(null,e.syncEngine),r}function rI(t,e,r={}){const n=new xs;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,l,c,u){const h=new d5({next:g=>{h.Nu(),s.enqueueAndForget(()=>t5(o,y));const f=g.docs.has(l);!f&&g.fromCache?u.reject(new Ut(ut.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&g.fromCache&&c&&c.source==="server"?u.reject(new Ut(ut.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),y=new r5(py(l.path),h,{includeMetadataChanges:!0,qa:!0});return e5(o,y)}(await p5(t),t.asyncQueue,e,r,n)),n.promise}function nI(t,e,r={}){const n=new xs;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,l,c,u){const h=new d5({next:g=>{h.Nu(),s.enqueueAndForget(()=>t5(o,y)),g.fromCache&&c.source==="server"?u.reject(new Ut(ut.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),y=new r5(l,h,{includeMetadataChanges:!0,qa:!0});return e5(o,y)}(await p5(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f5(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m5="firestore.googleapis.com",Qv=!0;class Xv{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ut(ut.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=m5,this.ssl=Qv}else this.host=e.host,this.ssl=e.ssl??Qv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=q2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<D3)throw new Ut(ut.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}bC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=f5(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Ut(ut.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Ut(ut.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Ut(ut.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class hp{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Xv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ut(ut.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ut(ut.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Xv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new cC;switch(n.type){case"firstParty":return new pC(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ut(ut.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Jv.get(r);n&&(Kt("ComponentProvider","Removing Datastore"),Jv.delete(r),n.terminate())}(this),Promise.resolve()}}function iI(t,e,r,n={}){t=$s(t,hp);const i=xc(e),o=t._getSettings(),s={...o,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${r}`;i&&(i1(`https://${l}`),o1("Firestore",!0)),o.host!==m5&&o.host!==l&&vc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...o,host:l,ssl:i,emulatorOptions:n};if(!bl(c,s)&&(t._setSettings(c),n.mockUserToken)){let u,h;if(typeof n.mockUserToken=="string")u=n.mockUserToken,h=hi.MOCK_USER;else{u=LP(n.mockUserToken,t._app?.options.projectId);const y=n.mockUserToken.sub||n.mockUserToken.user_id;if(!y)throw new Ut(ut.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new hi(y)}t._authCredentials=new uC(new Z1(u,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new $l(this.firestore,e,this._query)}}class $n{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new $n(this.firestore,e,this._key)}toJSON(){return{type:$n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Xu(r,$n._jsonSchema))return new $n(e,n||null,new ar(un.fromString(r.referencePath)))}}$n._jsonSchemaVersion="firestore/documentReference/1.0",$n._jsonSchema={type:Mn("string",$n._jsonSchemaVersion),referencePath:Mn("string")};class wa extends $l{constructor(e,r,n){super(e,r,py(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new $n(this.firestore,null,new ar(e))}withConverter(e){return new wa(this.firestore,e,this._path)}}function oI(t,e,...r){if(t=ei(t),e2("collection","path",e),t instanceof hp){const n=un.fromString(e,...r);return dv(n),new wa(t,null,n)}{if(!(t instanceof $n||t instanceof wa))throw new Ut(ut.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(un.fromString(e,...r));return dv(n),new wa(t.firestore,null,n)}}function y5(t,e,...r){if(t=ei(t),arguments.length===1&&(e=ay.newId()),e2("doc","path",e),t instanceof hp){const n=un.fromString(e,...r);return uv(n),new $n(t,null,new ar(n))}{if(!(t instanceof $n||t instanceof wa))throw new Ut(ut.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(un.fromString(e,...r));return uv(n),new $n(t.firestore,t instanceof wa?t.converter:null,new ar(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zv="AsyncQueue";class e0{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new G2(this,"async_queue_retry"),this._c=()=>{const n=Xp();n&&Kt(Zv,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Xp();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Xp();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new xs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ec(e))throw e;Kt(Zv,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Is("INTERNAL UNHANDLED ERROR: ",t0(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=Cy.createAndSchedule(this,e,r,n,o=>this.hc(o));return this.tc.push(i),i}uc(){this.nc&&mr(47125,{Pc:t0(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function t0(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class nd extends hp{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new e0,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new e0(e),this._firestoreClient=void 0,await e}}}function sI(t,e){const r=typeof t=="object"?t:c1(),n=typeof t=="string"?t:Nh,i=Km(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=kP("firestore");o&&iI(i,...o)}return i}function ky(t){if(t._terminated)throw new Ut(ut.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||aI(t),t._firestoreClient}function aI(t){const e=t._freezeSettings(),r=function(i,o,s,l){return new TC(i,o,s,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,f5(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new Z4(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new uo(ti.fromBase64String(e))}catch(r){throw new Ut(ut.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new uo(ti.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:uo._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Xu(e,uo._jsonSchema))return uo.fromBase64String(e.bytes)}}uo._jsonSchemaVersion="firestore/bytes/1.0",uo._jsonSchema={type:Mn("string",uo._jsonSchemaVersion),bytes:Mn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ut(ut.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Zn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ut(ut.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ut(ut.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Fr(this._lat,e._lat)||Fr(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Jo._jsonSchemaVersion}}static fromJSON(e){if(Xu(e,Jo._jsonSchema))return new Jo(e.latitude,e.longitude)}}Jo._jsonSchemaVersion="firestore/geoPoint/1.0",Jo._jsonSchema={type:Mn("string",Jo._jsonSchemaVersion),latitude:Mn("number"),longitude:Mn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Qo._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Xu(e,Qo._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new Qo(e.vectorValues);throw new Ut(ut.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Qo._jsonSchemaVersion="firestore/vectorValue/1.0",Qo._jsonSchema={type:Mn("string",Qo._jsonSchemaVersion),vectorValues:Mn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI=/^__.*__$/;class cI{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Ma(e,this.data,this.fieldMask,r,this.fieldTransforms):new Zu(e,this.data,r,this.fieldTransforms)}}class g5{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Ma(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function v5(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw mr(40011,{Ac:t})}}class Ly{constructor(e,r,n,i,o,s){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Ly({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Vh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(v5(this.Ac)&&lI.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class uI{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||cp(e)}Cc(e,r,n,i=!1){return new Ly({Ac:e,methodName:r,Dc:n,path:Zn.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ry(t){const e=t._freezeSettings(),r=cp(t._databaseId);return new uI(t._databaseId,!!e.ignoreUndefinedProperties,r)}function dI(t,e,r,n,i,o={}){const s=t.Cc(o.merge||o.mergeFields?2:0,e,r,i);Dy("Data must be an object, but it was:",s,n);const l=b5(n,s);let c,u;if(o.merge)c=new Ki(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){const h=[];for(const y of o.mergeFields){const g=Sm(e,y,r);if(!s.contains(g))throw new Ut(ut.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);S5(h,g)||h.push(g)}c=new Ki(h),u=s.fieldTransforms.filter(y=>c.covers(y.field))}else c=null,u=s.fieldTransforms;return new cI(new Mi(l),c,u)}class fp extends Ny{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof fp}}function hI(t,e,r,n){const i=t.Cc(1,e,r);Dy("Data must be an object, but it was:",i,n);const o=[],s=Mi.empty();Da(n,(c,u)=>{const h=My(e,c,r);u=ei(u);const y=i.yc(h);if(u instanceof fp)o.push(h);else{const g=id(u,y);g!=null&&(o.push(h),s.set(h,g))}});const l=new Ki(o);return new g5(s,l,i.fieldTransforms)}function pI(t,e,r,n,i,o){const s=t.Cc(1,e,r),l=[Sm(e,n,r)],c=[i];if(o.length%2!=0)throw new Ut(ut.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)l.push(Sm(e,o[g])),c.push(o[g+1]);const u=[],h=Mi.empty();for(let g=l.length-1;g>=0;--g)if(!S5(u,l[g])){const f=l[g];let x=c[g];x=ei(x);const S=s.yc(f);if(x instanceof fp)u.push(f);else{const P=id(x,S);P!=null&&(u.push(f),h.set(f,P))}}const y=new Ki(u);return new g5(h,y,s.fieldTransforms)}function fI(t,e,r,n=!1){return id(r,t.Cc(n?4:3,e))}function id(t,e){if(_5(t=ei(t)))return Dy("Unsupported field value:",e,t),b5(t,e);if(t instanceof Ny)return function(n,i){if(!v5(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const o=[];let s=0;for(const l of n){let c=id(l,i.wc(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=ei(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return ZC(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=hn.fromDate(n);return{timestampValue:Fh(i.serializer,o)}}if(n instanceof hn){const o=new hn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Fh(i.serializer,o)}}if(n instanceof Jo)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof uo)return{bytesValue:D2(i.serializer,n._byteString)};if(n instanceof $n){const o=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(o))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:gy(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof Qo)return function(s,l){return{mapValue:{fields:{[c2]:{stringValue:u2},[Lh]:{arrayValue:{values:s.toArray().map(u=>{if(typeof u!="number")throw l.Sc("VectorValues must only contain numeric values.");return fy(l.serializer,u)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${ep(n)}`)}(t,e)}function b5(t,e){const r={};return n2(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Da(t,(n,i)=>{const o=id(i,e.mc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function _5(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof hn||t instanceof Jo||t instanceof uo||t instanceof $n||t instanceof Ny||t instanceof Qo)}function Dy(t,e,r){if(!_5(r)||!t2(r)){const n=ep(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function Sm(t,e,r){if((e=ei(e))instanceof pp)return e._internalPath;if(typeof e=="string")return My(t,e);throw Vh("Field path arguments must be of type string or ",t,!1,void 0,r)}const mI=new RegExp("[~\\*/\\[\\]]");function My(t,e,r){if(e.search(mI)>=0)throw Vh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new pp(...e.split("."))._internalPath}catch{throw Vh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Vh(t,e,r,n,i){const o=n&&!n.isEmpty(),s=i!==void 0;let l=`Function ${e}() called with invalid data`;r&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${n}`),s&&(c+=` in document ${i}`),c+=")"),new Ut(ut.INVALID_ARGUMENT,l+t+c)}function S5(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P5{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new $n(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new yI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Fy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class yI extends P5{data(){return super.data()}}function Fy(t,e){return typeof e=="string"?My(t,e):e instanceof pp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ut(ut.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Oy{}class w5 extends Oy{}function vI(t,e,...r){let n=[];e instanceof Oy&&n.push(e),n=n.concat(r),function(o){const s=o.filter(c=>c instanceof jy).length,l=o.filter(c=>c instanceof By).length;if(s>1||s>0&&l>0)throw new Ut(ut.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class By extends w5{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new By(e,r,n)}_apply(e){const r=this._parse(e);return x5(e._query,r),new $l(e.firestore,e.converter,um(e._query,r))}_parse(e){const r=Ry(e.firestore);return function(o,s,l,c,u,h,y){let g;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Ut(ut.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){n0(y,h);const x=[];for(const S of y)x.push(r0(c,o,S));g={arrayValue:{values:x}}}else g=r0(c,o,y)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||n0(y,h),g=fI(l,s,y,h==="in"||h==="not-in");return Dn.create(u,h,g)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}class jy extends Oy{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new jy(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Eo.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,o){let s=i;const l=o.getFlattenedFilters();for(const c of l)x5(s,c),s=um(s,c)}(e._query,r),new $l(e.firestore,e.converter,um(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Vy extends w5{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Vy(e,r)}_apply(e){const r=function(i,o,s){if(i.startAt!==null)throw new Ut(ut.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Ut(ut.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ou(o,s)}(e._query,this._field,this._direction);return new $l(e.firestore,e.converter,function(i,o){const s=i.explicitOrderBy.concat([o]);return new Tc(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function bI(t,e="asc"){const r=e,n=Fy("orderBy",t);return Vy._create(n,r)}function r0(t,e,r){if(typeof(r=ei(r))=="string"){if(r==="")throw new Ut(ut.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!v2(e)&&r.indexOf("/")!==-1)throw new Ut(ut.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(un.fromString(r));if(!ar.isDocumentKey(n))throw new Ut(ut.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return bv(t,new ar(n))}if(r instanceof $n)return bv(t,r._key);throw new Ut(ut.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ep(r)}.`)}function n0(t,e){if(!Array.isArray(t)||t.length===0)throw new Ut(ut.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function x5(t,e){const r=function(i,o){for(const s of i)for(const l of s.getFlattenedFilters())if(o.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Ut(ut.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ut(ut.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class _I{convertValue(e,r="none"){switch($a(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Ia(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw mr(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Da(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){const r=e.fields?.[Lh].arrayValue?.values?.map(n=>xn(n.doubleValue));return new Qo(r)}convertGeoPoint(e){return new Jo(xn(e.latitude),xn(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=np(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Du(e));default:return null}}convertTimestamp(e){const r=Ca(e);return new hn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=un.fromString(e);Xr(V2(n),9688,{name:e});const i=new Mu(n.get(1),n.get(3)),o=new ar(n.popFirst(5));return i.isEqual(r)||Is(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SI(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class uu{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fl extends P5{constructor(e,r,n,i,o,s){super(e,r,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new ch(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Fy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ut(ut.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=fl._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}fl._jsonSchemaVersion="firestore/documentSnapshot/1.0",fl._jsonSchema={type:Mn("string",fl._jsonSchemaVersion),bundleSource:Mn("string","DocumentSnapshot"),bundleName:Mn("string"),bundle:Mn("string")};class ch extends fl{data(e={}){return super.data(e)}}class fc{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new uu(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new ch(this._firestore,this._userDataWriter,n.key,n,new uu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ut(ut.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(l=>{const c=new ch(i._firestore,i._userDataWriter,l.doc.key,l.doc,new uu(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>o||l.type!==3).map(l=>{const c=new ch(i._firestore,i._userDataWriter,l.doc.key,l.doc,new uu(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return l.type!==0&&(u=s.indexOf(l.doc.key),s=s.delete(l.doc.key)),l.type!==1&&(s=s.add(l.doc),h=s.indexOf(l.doc.key)),{type:PI(l.type),doc:c,oldIndex:u,newIndex:h}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ut(ut.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=fc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ay.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function PI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return mr(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wI(t){t=$s(t,$n);const e=$s(t.firestore,nd);return rI(ky(e),t._key).then(r=>CI(e,t,r))}fc._jsonSchemaVersion="firestore/querySnapshot/1.0",fc._jsonSchema={type:Mn("string",fc._jsonSchemaVersion),bundleSource:Mn("string","QuerySnapshot"),bundleName:Mn("string"),bundle:Mn("string")};class A5 extends _I{constructor(e){super(),this.firestore=e}convertBytes(e){return new uo(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new $n(this.firestore,null,r)}}function xI(t){t=$s(t,$l);const e=$s(t.firestore,nd),r=ky(e),n=new A5(e);return gI(t._query),nI(r,t._query).then(i=>new fc(e,n,t,i))}function AI(t,e,r){t=$s(t,$n);const n=$s(t.firestore,nd),i=SI(t.converter,e);return I5(n,[dI(Ry(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Yo.none())])}function C5(t,e,r,...n){t=$s(t,$n);const i=$s(t.firestore,nd),o=Ry(i);let s;return s=typeof(e=ei(e))=="string"||e instanceof pp?pI(o,"updateDoc",t._key,e,r,n):hI(o,"updateDoc",t._key,e),I5(i,[s.toMutation(t._key,Yo.exists(!0))])}function I5(t,e){return function(n,i){const o=new xs;return n.asyncQueue.enqueueAndForget(async()=>U4(await tI(n),i,o)),o.promise}(ky(t),e)}function CI(t,e,r){const n=r.docs.get(e._key),i=new A5(t);return new fl(t,i,e._key,n,new uu(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Ic=i})(Ac),yc(new _l("firestore",(n,{instanceIdentifier:i,options:o})=>{const s=n.getProvider("app").getImmediate(),l=new nd(new dC(n.getProvider("auth-internal")),new fC(s,n.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Ut(ut.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Mu(u.options.projectId,h)}(s,i),s);return o={useFetchStreams:r,...o},l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),_a(sv,av,e),_a(sv,av,"esm2020")})();let II="eyAiYXBpS2V5IjogIkFJemFTeUJBbGN2WlRMMXRsQ05LRExENEJpTWJhR01iTnhCRjQtTSIsICAiYXV0aERvbWFpbiI6ICJocm0tMTEyOC5maXJlYmFzZWFwcC5jb20iLCAgImRhdGFiYXNlVVJMIjogImh0dHBzOi8vaHJtLTExMjguZmlyZWJhc2Vpby5jb20iLCAgInByb2plY3RJZCI6ICJocm0tMTEyOCIsICAic3RvcmFnZUJ1Y2tldCI6ICJocm0tMTEyOC5hcHBzcG90LmNvbSIsICAibWVzc2FnaW5nU2VuZGVySWQiOiAiMTA0OTI1MDU4NTI0NSIsICAiYXBwSWQiOiAiMToxMDQ5MjUwNTg1MjQ1OndlYjowZGFkMDAyMDI3MjM1MTRjY2M1Mjc0In0=";const $5=l1(JSON.parse(SP(II))),il=oC($5),qh=new Uo,Pm=sI($5);qh.addScope("profile");qh.addScope("email");class du extends Error{}du.prototype.name="InvalidTokenError";function $I(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function EI(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return $I(e)}catch{return atob(e)}}function TI(t,e){if(typeof t!="string")throw new du("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new du(`Invalid token specified: missing part #${r+1}`);let i;try{i=EI(n)}catch(o){throw new du(`Invalid token specified: invalid base64 for part #${r+1} (${o.message})`)}try{return JSON.parse(i)}catch(o){throw new du(`Invalid token specified: invalid json for part #${r+1} (${o.message})`)}}const kI={clientId:"195275085181-8ccjpgp8v1g80qhnlk6v4lpgid7n81gr.apps.googleusercontent.com"},NI=t=>{const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{window.google&&window.google.accounts.id.initialize({client_id:kI.clientId,callback:r=>{t(r.credential)},auto_select:!1,cancel_on_tap_outside:!0})},document.head.appendChild(e)},LI=t=>TI(t),RI=()=>{window.google&&window.google.accounts.id.disableAutoSelect()},[DI,MI]=Gu({}),FI=async()=>{const e=await di({query:"qcm42351987"});if(e&&!e.error){let n=Object.assign({},{},e);MI(n)}return 1},OI=async t=>{let e=DI?.[992002];e&&(e.params={tkn:t})},[Jl,ci]=Gu({user:null,loading:!0,error:null,authMethod:null}),[E5,i0]=Ce(null);Gx(il,t=>{t?ci({user:t,loading:!1,error:null,authMethod:"firebase"}):E5()||ci({user:null,loading:!1,error:null,authMethod:null})});SA(il).then(t=>{t&&ci({user:t.user,loading:!1,error:null,authMethod:"firebase"})}).catch(t=>{console.error("Redirect sign-in error:",t),ci({loading:!1,error:t.message})});const pr={get state(){return Jl},async getUserProfile(t){try{const e=y5(Pm,"users",t),r=await wI(e);if(r.exists()){ci("profile",r.data());let n={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_2376:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},i=r.data(),o={};return Object.keys(n).map(s=>{let l=n?.[s];i.hasOwnProperty(s)||(o[s]=l)}),Object.keys(o).length>0&&C5(e,o),r.data()}else{let n=pr?.state?.user,i={uid:n?.uid,email:n?.email,displayName:n?.displayName,createdAt:new Date,stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_2376:!1,YY_79:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1};return await AI(e,i),console.log("No such user profile!"),null}}catch(e){return console.error("Error fetching user profile:",e),null}},getBusinessId:()=>pr.state?.profile?.businessId,hasPermission:t=>{const e=pr.state?.profile;return e?.isAdmin?!0:e?e?.[t]===!0:!1},async signInWithGoogle(){try{ci("loading",!0),ci("error",null);try{const t=await pA(il,qh);ci({user:t.user,loading:!1,error:null,authMethod:"firebase"});try{pr.getUserProfile(t.user.uid)}catch(e){console.error("firestore error:",e)}}catch(t){if(t.code==="auth/popup-blocked")await bA(il,qh);else throw t}}catch(t){console.error("Sign-in error:",t),ci({loading:!1,error:t.message||"Failed to sign in with Google"})}},async signInWithGoogleP(t){const r=await di({params:{id_token:t},query:"getGoogleUserbyToken"});if(r&&r){let n=new Date().getTime(),i=new Date(n+6e4*60*24*365),o="hrm_tkn_acc";document.cookie=`${o}=${r.data}; expires=${i}; path=/;g_state = {"i_l":1,"i_p":${i}}; ssgl_access_tkn = ${t}`,document.cookie=`ssgl_access_tkn = ${t}; expires=${i};`,await FI(),OI(r.data)}},async signInWithGoogleCloud(t){try{ci("loading",!0),ci("error",null);const e=LI(t),r={uid:e.sub,email:e.email,displayName:e.name,photoURL:e.picture};i0(r);const n={uid:r.uid,email:r.email,displayName:r.displayName,photoURL:r.photoURL,emailVerified:!0};ci({user:n,loading:!1,error:null,authMethod:"google-cloud"});try{const i=Uo.credential(t);await zx(il,i)}catch{console.log("Firebase sign-in optional, continuing with Google Cloud auth")}}catch(e){console.error("Google Cloud sign-in error:",e),ci({loading:!1,error:e.message||"Failed to sign in with Google Cloud"})}},async signOut(){try{ci("loading",!0),(Jl.authMethod==="firebase"||il.currentUser)&&await Wx(il),Jl.authMethod==="google-cloud"&&(RI(),i0(null)),ci({user:null,loading:!1,error:null,authMethod:null})}catch(t){console.error("Sign-out error:",t),ci({loading:!1,error:t.message||"Failed to sign out"})}},get isAuthenticated(){return!!Jl.user||!!E5()},get currentUser(){return Jl.user},get authMethod(){return Jl.authMethod}},BI=async()=>({}),jI=()=>(typeof window<"u"&&localStorage.getItem("hrmfinance-api-mode"),"real");let ol=jI();const wm={getMode(){return ol},setMode(t){ol=t,typeof window<"u"&&localStorage.setItem("hrmfinance-api-mode",t)},isFakeMode(){return ol==="fake"},isRealMode(){return ol==="real"},isHybridMode(){return ol==="hybrid"}},Fi=async(t,e,r=!0)=>{if(ol==="fake")return e();if(ol==="real")return t();try{return await t()}catch(n){if(console.warn("Real API failed, falling back to fake server:",n),r)return e();throw n}},o0={async getAll(t,e){const r=await di({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:{businessId:pr.getBusinessId(),":search0":"produ"}});return Kf(r)},async getById(t){return Fi(async()=>(await this.getAll()).find(r=>r.id===t)||null,()=>$i.products.getById(t))},async create(t){return Fi(async()=>{throw console.log("Creating product via real API:",t),new Error("Real API not implemented yet")},()=>$i.products.create(t))},async update(t,e){return Fi(async()=>{throw console.log("Updating product via real API:",t,e),new Error("Real API not implemented yet")},()=>$i.products.update(t,e))},async delete(t){return Fi(async()=>{throw console.log("Deleting product via real API:",t),new Error("Real API not implemented yet")},()=>$i.products.delete(t))}},gi={async getInventory(t,e){if(!(t&&t?.trim()))return[];let r={businessId:pr.getBusinessId()};return t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await di({query:"getScanYabaInventory",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async getProducts(t){if(!(t&&t?.trim()))return[];let e={businessId:pr.getBusinessId()};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await di({query:"getScanYabaProducts",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getConsigee(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await di({query:"getScanConsigneeYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getShipper(t){if(!(t&&t?.trim()))return[];let e={businessId:"all"};return t&&t.split(" ").map((i,o)=>{i&&(e[":search"+o]=i.trim())}),await di({query:"getScanShipperYabaExpress",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:e})},async getInvoice(t,e){if(!(t&&t?.trim()))return[];let r={businessId:pr.getBusinessId()};return t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await di({query:"getScanYabaSalesOrders",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:r})},async addInventory(t){let r={query:"addYabaInventory",params:{businessId:pr.getBusinessId()},form:t};return await di(r)},async updInventory(t){return pr.getBusinessId(),await BI()},async addInvoice(t){let r={query:"addYabaSalesOrders",params:{businessId:pr.getBusinessId()},form:t};return await di(r)},async getHBLS(t,e){if(!(t&&t?.trim()))return[];let r={businessId:pr.getBusinessId()};e?.search,e?.guia&&e.guia!=="all"&&(r.guia=e.guia),t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())});let n={query:"getScanYabaHbls",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND guia = guia",params:r};const i=await di(n);return console.log(n),console.log(i),i}},qy={async getAll(t){return gi.getInventory("ref")},async getById(t){return Fi(async()=>{throw console.log("Getting movement by ID via real API:",t),new Error("Real API not implemented yet")},()=>$i.movements.getById(t))},async create(t){return Fi(async()=>{throw console.log("Creating movement via real API:",t),new Error("Real API not implemented yet")},()=>$i.movements.create(t))},async update(t,e){return Fi(async()=>{throw console.log("Updating movement via real API:",t,e),new Error("Real API not implemented yet")},()=>$i.movements.update(t,e))},async createBulk(t){return Fi(async()=>{throw console.log("Creating bulk movements via real API:",t),new Error("Real API not implemented yet")},()=>$i.movements.createBulk(t))},async getStockLevels(t){return await di({query:"calculateInventoryStock",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4",params:t})},async calcStockLevels(){return[]}},zh={async getAlls(t,e){if(console.log("getAlls",t),!(t&&t?.trim()))return[];let r={businessId:"hcPiDPfZFS8ymqoh"};return e?.search,t&&t.split(" ").map((o,s)=>{o&&(r[":search"+s]=o.trim())}),await di({query:"getAllAccountsByUserId",queryString:"!* contain :search0 AND !* contain :search1 AND !* contain :search2 AND !* contain :search3 AND !* contain :search4 AND guia = guia",params:r})},async getAll(t){return Fi(async()=>{throw console.log("Getting accounts via real API:",t),new Error("Real API not implemented yet")},()=>$i.accounts.getAll(t))},async getById(t){return Fi(async()=>{throw console.log("Getting account by ID via real API:",t),new Error("Real API not implemented yet")},()=>$i.accounts.getById(t))},async create(t){let r={query:"addAccounts",params:{businessId:"hcPiDPfZFS8ymqoh"},form:t};console.log(r);const n=await di(r);return console.log(n),n},async update(t,e){let n={query:"updateAccounts",params:{businessId:"hcPiDPfZFS8ymqoh",accountId:t},data2update:e};console.log(n);const i=await di(n);return console.log(i),i}},s0={async getNextEntryNumber(){return Fi(async()=>{throw console.log("Getting next entry number via real API"),new Error("Real API not implemented yet")},()=>$i.utils.getNextEntryNumber())},async getNextProductCode(t){return Fi(async()=>{throw console.log("Getting next product code via real API:",t),new Error("Real API not implemented yet")},()=>$i.utils.getNextProductCode(t))},async healthCheck(){return Fi(async()=>{const t=await fetch("/api/health");if(!t.ok)throw new Error("Health check failed");return t.json()},()=>$i.utils.healthCheck())},async getStats(){return Fi(async()=>{throw console.log("Getting stats via real API"),new Error("Real API not implemented yet")},()=>$i.utils.getStats())}},VI=()=>{wm.setMode("real"),console.log("🚀 HRM Finance initialized in REAL API mode for production")};VI();var qI=he("<p>"),zI=he('<div><div><div><h1>HRM Finance</h1><p>Complete Business Management Solution</p><div><div><button><svg width=24 height=24 viewBox="0 0 24 24"><path fill=#4285F4 d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill=#34A853 d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill=#FBBC05 d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill=#EA4335 d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg></button><p>Firebase Authentication</p></div></div></div><div><div><div>💰</div><h3>Financial Management</h3><p>Complete chart of accounts, balance sheets, journal entries, and invoice management in one place.</p></div><div><div>👥</div><h3>HR Management</h3><p>Track employees, manage onboarding, and monitor your workforce with powerful analytics.</p></div><div><div>📦</div><h3>Inventory Control</h3><p>Real-time inventory tracking, product management, and movement history across multiple locations.</p></div><div><div>🏦</div><h3>Banking Integration</h3><p>Streamline bank reconciliation with CSV imports and automated consolidation features.</p></div><div><div>📊</div><h3>Real-time Analytics</h3><p>Get instant insights with dashboards showing revenue, cash flow, and business performance.</p></div><div><div>🌐</div><h3>Multi-language Support</h3><p>Available in multiple languages to support your global business operations.</p></div></div><div><p>Secure authentication powered by Google • Your data is encrypted and protected</p><p>Choose your preferred authentication method above');const UI=()=>{Sn(()=>{NI(P=>{pr.signInWithGoogleP(P)}),setTimeout(()=>{},100)});const t={"min-height":"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},e={background:"white","border-radius":"1rem","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","max-width":"1200px",width:"100%",overflow:"hidden"},r={padding:"3rem","text-align":"center","border-bottom":"1px solid #e2e8f0"},n={"font-size":"2.5rem","font-weight":"800",color:"#1a202c","margin-bottom":"1rem"},i={"font-size":"1.125rem",color:"#718096","margin-bottom":"2rem"},o={display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","margin-bottom":"1rem"},s={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"2rem",padding:"3rem"},l={"text-align":"center",padding:"2rem","border-radius":"0.5rem",background:"#f7fafc",transition:"transform 0.2s",cursor:"default"},c={"font-size":"3rem","margin-bottom":"1rem"},u={"font-size":"1.25rem","font-weight":"600",color:"#2d3748","margin-bottom":"0.5rem"},h={color:"#718096","line-height":"1.6"},y={display:"inline-flex","align-items":"center",gap:"0.75rem",background:"white",color:"#4285f4",border:"2px solid #4285f4",padding:"0.75rem 2rem","font-size":"1.125rem","font-weight":"500","border-radius":"0.5rem",cursor:"pointer",transition:"all 0.2s","min-width":"250px","justify-content":"center"},g={color:"#e53e3e","margin-top":"1rem","font-size":"0.875rem"},f={background:"#f7fafc",padding:"2rem","text-align":"center",color:"#718096","font-size":"0.875rem"},x={"font-size":"0.75rem",color:"#718096","margin-top":"0.25rem","font-style":"italic"},S=()=>{pr.signInWithGoogle()};return(()=>{var P=zI(),$=P.firstChild,U=$.firstChild,se=U.firstChild,X=se.nextSibling,Z=X.nextSibling,re=Z.firstChild,E=re.firstChild;E.firstChild;var C=E.nextSibling,T=U.nextSibling,j=T.firstChild,b=j.firstChild,w=b.nextSibling,_=w.nextSibling,W=j.nextSibling,K=W.firstChild,k=K.nextSibling,R=k.nextSibling,Y=W.nextSibling,q=Y.firstChild,O=q.nextSibling,le=O.nextSibling,N=Y.nextSibling,D=N.firstChild,V=D.nextSibling,I=V.nextSibling,F=N.nextSibling,Q=F.firstChild,H=Q.nextSibling,J=H.nextSibling,te=F.nextSibling,ee=te.firstChild,ne=ee.nextSibling,G=ne.nextSibling,ce=T.nextSibling,oe=ce.firstChild,z=oe.nextSibling;return m(P,t),m($,e),m(U,r),m(se,n),m(X,i),m(Z,o),E.addEventListener("mouseleave",de=>{de.currentTarget.style.background="white",de.currentTarget.style.color="#4285f4"}),E.addEventListener("mouseenter",de=>{de.currentTarget.style.background="#4285f4",de.currentTarget.style.color="white"}),E.$$click=S,m(E,y),a(E,M(Ge,{get when(){return pr.state.loading},fallback:"Sign in with Google",children:"Signing in..."}),null),m(C,x),a(U,M(Ge,{get when(){return pr.state.error},get children(){var de=qI();return m(de,g),a(de,()=>pr.state.error),de}}),null),m(T,s),m(ce,f),z.style.setProperty("margin-top","0.5rem"),z.style.setProperty("font-size","0.75rem"),Se(de=>{var fe=pr.state.loading,ue=l,ge=c,xe=u,pe=h,_e=l,Le=c,De=u,Te=h,$e=l,Ie=c,Re=u,Ke=h,je=l,We=c,Qe=u,at=h,nt=l,Ye=c,ht=u,lt=h,$t=l,_t=c,ze=u,Lt=h;return fe!==de.e&&(E.disabled=de.e=fe),de.t=m(j,ue,de.t),de.a=m(b,ge,de.a),de.o=m(w,xe,de.o),de.i=m(_,pe,de.i),de.n=m(W,_e,de.n),de.s=m(K,Le,de.s),de.h=m(k,De,de.h),de.r=m(R,Te,de.r),de.d=m(Y,$e,de.d),de.l=m(q,Ie,de.l),de.u=m(O,Re,de.u),de.c=m(le,Ke,de.c),de.w=m(N,je,de.w),de.m=m(D,We,de.m),de.f=m(V,Qe,de.f),de.y=m(I,at,de.y),de.g=m(F,nt,de.g),de.p=m(Q,Ye,de.p),de.b=m(H,ht,de.b),de.T=m(J,lt,de.T),de.A=m(te,$t,de.A),de.O=m(ee,_t,de.O),de.I=m(ne,ze,de.I),de.S=m(G,Lt,de.S),de},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0}),P})()};yr(["click"]);var HI=he("<div><div>");const GI=t=>{const e={"min-height":"100vh",display:"flex","align-items":"center","justify-content":"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},r={width:"50px",height:"50px",border:"3px solid rgba(255, 255, 255, 0.3)","border-top-color":"white","border-radius":"50%",animation:"spin 1s linear infinite"},n=document.createElement("style");return n.textContent=`
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  `,document.head.appendChild(n),yi(async()=>{pr.state?.user?.uid&&pr.getUserProfile(pr.state?.user?.uid)}),Sn(()=>{}),M(Ge,{get when(){return!pr.state.loading},get fallback(){return(()=>{var i=HI(),o=i.firstChild;return m(i,e),m(o,r),i})()},get children(){return M(Ge,{get when(){return pr.isAuthenticated},get fallback(){return M(UI,{})},get children(){return t.children}})}})};var WI=he("<button>");const dt=t=>{const e=()=>{const r={"font-family":"inherit",cursor:t.disabled?"not-allowed":"pointer",border:"none","border-radius":"var(--border-radius-sm)","font-weight":"500",transition:"all 0.2s ease","text-decoration":"none",display:"inline-flex","align-items":"center","justify-content":"center",gap:"0.5rem",opacity:t.disabled?"0.6":"1"},n={sm:{padding:"0.5rem 1rem","font-size":"0.875rem"},md:{padding:"0.75rem 1.5rem","font-size":"1rem"},lg:{padding:"1rem 2rem","font-size":"1.125rem"}},i={primary:{background:"linear-gradient(135deg, var(--primary-color), var(--primary-dark))",color:"white","box-shadow":"var(--shadow-sm)"},secondary:{background:"var(--surface-color)",color:"var(--text-primary)",border:"1px solid var(--border-color)"},outline:{background:"transparent",color:"var(--primary-color)",border:"1px solid var(--primary-color)"}};return{...r,...n[t.size||"md"],...i[t.variant||"primary"]}};return(()=>{var r=WI();return ts(r,"click",t.onClick,!0),a(r,()=>t.children),Se(n=>{var i=e(),o=t.disabled,s=t.type||"button",l=`btn btn-${t.variant||"primary"} ${t.className||""}`;return n.e=m(r,i,n.e),o!==n.t&&(r.disabled=n.t=o),s!==n.a&&nr(r,"type",n.a=s),l!==n.o&&zm(r,n.o=l),n},{e:void 0,t:void 0,a:void 0,o:void 0}),r})()};yr(["click"]);var YI=he("<div><div><div><h2></h2><button>×</button></div><div>");const Fn=t=>{const e={position:"fixed",top:"0",left:"0",right:"0",bottom:"0","background-color":"rgba(0, 0, 0, 0.5)",display:"flex","align-items":"center","justify-content":"center","z-index":"1000"},r={background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)",width:"90%","max-height":"80vh",overflow:"auto",position:"relative"},n={padding:"1.5rem","border-bottom":"1px solid var(--border-color)",display:"flex","justify-content":"space-between","align-items":"center"},i={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},o={background:"none",border:"none","font-size":"1.5rem",cursor:"pointer",color:"var(--text-muted)",padding:"0.5rem","border-radius":"var(--border-radius-sm)"},s={padding:"1.5rem"},l=c=>{c.target===c.currentTarget&&t.onClose()};return M(Ge,{get when(){return t.isOpen},get children(){var c=YI(),u=c.firstChild,h=u.firstChild,y=h.firstChild,g=y.nextSibling,f=h.nextSibling;return c.$$click=l,m(h,n),m(y,i),a(y,()=>t.title),g.addEventListener("mouseleave",x=>x.target.style.background="none"),g.addEventListener("mouseenter",x=>x.target.style.background="var(--background-color)"),ts(g,"click",t.onClose,!0),m(g,o),m(f,s),a(f,()=>t.children),Se(x=>{var S=e,P=r;return x.e=m(c,S,x.e),x.t=m(u,P,x.t),x},{e:void 0,t:void 0}),c}})};yr(["click"]);var a0=he("<div>"),KI=he("<h3>"),JI=he("<p>");const Ft=t=>{const e={background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"1.5rem","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",transition:"all 0.2s ease",cursor:t.onClick?"pointer":"default",margin:"9px"},r={"margin-bottom":"1rem"},n={"font-size":"1.25rem","font-weight":"600",color:"var(--text-primary)",margin:"0 0 0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)",margin:"0"};return(()=>{var o=a0();return ts(o,"click",t.onClick,!0),a(o,(()=>{var s=Ee(()=>!!(t.title||t.subtitle));return()=>s()&&(()=>{var l=a0();return m(l,r),a(l,(()=>{var c=Ee(()=>!!t.title);return()=>c()&&(()=>{var u=KI();return m(u,n),a(u,()=>t.title),u})()})(),null),a(l,(()=>{var c=Ee(()=>!!t.subtitle);return()=>c()&&(()=>{var u=JI();return m(u,i),a(u,()=>t.subtitle),u})()})(),null),l})()})(),null),a(o,()=>t.children,null),Se(s=>{var l=e,c=`card ${t.className||""}`;return s.e=m(o,l,s.e),c!==s.t&&zm(o,s.t=c),s},{e:void 0,t:void 0}),o})()};yr(["click"]);var QI=he("<div><label></label><input>"),XI=he("<span>*");const Ar=t=>{const e={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},r={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},n={"margin-bottom":"1rem"},[i,o]=Ce("");yi(()=>{t?.value!==void 0&&o(t.value.toString())});const s=c=>{(c.key==="Enter"||c.key==="Escape"||c.key==="Tab")&&t.onChange&&pl(i())&&t.onChange(i())},l=()=>{pl(i())&&t.onChange(i())};return(()=>{var c=QI(),u=c.firstChild,h=u.nextSibling;return m(c,n),m(u,e),a(u,()=>t.label,null),a(u,(()=>{var y=Ee(()=>!!t.required);return()=>y()&&(()=>{var g=XI();return g.style.setProperty("color","var(--primary-color)"),g})()})(),null),h.addEventListener("blur",y=>{l(),y.target.style.borderColor="var(--border-color)"}),h.addEventListener("focus",y=>{y.target.style.borderColor="var(--primary-color)"}),h.$$keydown=s,h.$$input=y=>o(y.target.value),m(h,r),Se(y=>{var g=t.type||"text",f=t.placeholder,x=t.required,S=t.disabled;return g!==y.e&&nr(h,"type",y.e=g),f!==y.t&&nr(h,"placeholder",y.t=f),x!==y.a&&(h.required=y.a=x),S!==y.o&&(h.disabled=y.o=S),y},{e:void 0,t:void 0,a:void 0,o:void 0}),Se(()=>h.value=i()),c})()};yr(["input","keydown"]);const ZI={en:{common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",searching:"Searching...",refresh:"Refresh",showAll:"Show All",products:"products",filtered:"Filtered",view:"View",suggested:"Suggested",clearFilters:"Clear Filters",enhanced:"Enhanced",legacy:"Legacy",email:"Email",phone:"Phone",address:"Address",name:"Name",code:"Code",category:"Category",type:"Type",quantity:"Quantity",price:"Price",cost:"Cost",value:"Value",balance:"Balance",created:"Created",modified:"Modified",details:"Details",summary:"Summary",history:"History",new:"New",addNew:"Add New",unknown:"Unknown",notAvailable:"N/A",remove:"Remove",startDate:"Start Date",endDate:"End Date",from:"From",invoice:"Invoice",invoices:"invoices",reference:"Reference",createdBy:"Created By",units:"units",invoiceDocumentId:"Invoice/Document ID",referenceNumber:"Reference Number",referenceNumberPlaceholder:"Enter reference number...",generalNotes:"General Notes",auto:"Auto",optionalNotes:"Optional notes...",showPerPage:"Show per page",first:"First",last:"Last",store:"Store",orderId:"Order ID",tax:"Tax",paymentMethods:"Payment Methods",cash:"Cash",creditCard:"Credit Card",shipping:"Shipping",air:"Air",sea:"Sea",thankYouBusiness:"Thank you for your business!",thankForChoosingUs:"Thank you for choosing us!",taxExemptNote:"Tax exempted on cash payment.",youSaved:"You saved",generatedOn:"Generated on",printSavePDF:"Print / Save as PDF",pageOfPages:"Page {{current}} of {{total}}",showingXofY:"Showing {{start}}-{{end}} of {{total}}",page:"Page",of:"of",print:"Print",export:"Export",pending:"Pending",completed:"Completed",customer:"Customer",location:"Location",reservations:"Reservations",backToDashboard:"Back to Dashboard",lbs:"pounds"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",employees:"Employees",entryBooks:"Entry Books",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",totalRevenue:"Total Revenue",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",employeeCount:"Employee Count",pendingInvoices:"Pending Invoices",cashBalance:"Cash Balance",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalExpenses:"Total Expenses",netIncome:"Net Income",netLoss:"Net Loss",monthlyPayroll:"Monthly Payroll",current:"Current",newHires:"+3 new hires",outstanding:"Outstanding",totalOutstanding:"$23,450 total",lastUpdatedToday:"Last updated today",commonTasks:"Common tasks",generateReport:"Generate Report",latestUpdates:"Latest updates",invoicePaid:"Invoice #1234 paid",hoursAgo:"2 hours ago",newEmployeeOnboarded:"New employee onboarded",dayAgo:"1 day ago",monthlyReportGenerated:"Monthly report generated",daysAgo:"2 days ago"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",backToAccounts:"Back to Accounts",accountNotFound:"Account not found",accountInformation:"Account Information",accountPurpose:"Account purpose",transactionHistory:"Transaction History",noTransactions:"No transactions found for this account",createdDate:"Created Date",lastModified:"Last Modified",noDescription:"No description provided.",totalCount:"Total count",basicDetails:"Basic details",currentBalance:"Current balance",classification:"Classification",allTransactions:"All account transactions",reference:"Reference",allAccounts:"All Accounts",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"}},inventory:{title:"Inventory Management",overview:"Overview",products:"Products & Stock",movements:"Movements",locations:"Locations",bulkMovement:"Bulk Movement",addMovement:"Add Movement",addProduct:"Add Product",addLocation:"Add Location",singleMovement:"Add Single Movement",addNewItem:"Add New Item",activeProducts:"Active Products",lowStockAlert:"Low Stock Items",totalValue:"Total Stock Value",activeLocations:"Active Locations",productsNeedRestocking:"products need restocking",recentMovements:"Recent Movements",noProducts:"No products at this location",productName:"Product Name",productCode:"Product Code",sku:"SKU",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",movementType:"Movement Type",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",fromLocation:"From Location",toLocation:"To Location",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",searchProducts:"Search products by name, SKU, or category...",searchProductsStock:"Search products and check stock levels...",searchResult:"Search Result",searchResults:"Search Results",searchFallback:"Showing local results",tryDifferentTerm:"Try a different search term or check spelling.",showingTopResults:"Showing top {{count}} results",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",totalLocations:"Total Locations",lastSeen:"Last seen",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer",currentlyManaged:"Currently managed",needAttention:"Need attention",currentWorth:"Current worth",warehousesStores:"Warehouses & stores",thisMonth:"This Month",latestActivities:"Latest inventory activities",searchMovements:"Search Movements",countingSheet:"Counting Sheet",physicalCount:"Physical Count",physicalInventoryCount:"Physical Inventory Count",setupPhysicalCount:"Setup Physical Inventory Count",setupDescription:"Configure your physical inventory count settings and begin the counting process.",countWillInclude:"This count will include {{count}} products from {{location}} in {{category}} category.",startCounting:"Start Physical Count",counted:"Counted",remaining:"Remaining",variances:"Variances",complete:"Complete",systemQty:"System Qty",variance:"Variance",addNotes:"Add notes...",reviewAndConfirm:"Review and Confirm Adjustments",reviewDescription:"Review the inventory adjustments below and confirm to update your system.",stockIncreases:"Stock Increases",stockDecreases:"Stock Decreases",totalAdjustments:"Total Adjustments",confirmAdjustments:"Confirm Adjustments",perfectCount:"Perfect Count!",noVariances:"No variances found. Your physical count matches the system exactly.",physicalCountAdjustment:"Physical count adjustment",inventoryCountingSheetTitle:"INVENTORY COUNTING SHEET",location:"Location",allCategories:"All Categories",countedBy:"Counted by",verifiedBy:"Verified by",instructions:"Instructions",countInstructions:["Count all items physically present at this location",'Write the actual count in the "Physical Count" column',"Leave blank if item is not found",'Note any discrepancies in the "Notes" column',"Sign and date when complete"],unit:"Unit",totalProductsListed:"Total Products Listed",itemsCounted:"Items Counted",summaryFor:"SUMMARY FOR",discrepanciesFound:"Discrepancies Found",counterSignature:"Counter Signature",supervisorSignature:"Supervisor Signature",downloadCSV:"Download CSV",noAdjustmentsToDownload:"No adjustments to download",stockIncrease:"Stock Increase",stockDecrease:"Stock Decrease",purchaseReceive:"Purchase/Receive",saleIssue:"Sale/Issue",generalNotesPlaceholder:"Enter general notes for this movement...",sortBy:"Sort By",allLocations:"All Locations",searchByProduct:"Search by product, location, reference, notes, invoice...",allProducts:"All Products",bulkMovementReport:"Bulk Movement Report",totalQuantity:"Total Quantity",estimatedValue:"Estimated Value",viewHistoricalReports:"View Historical Reports",noBulkReportsFound:"No bulk movement reports found",bulkReportsAppearHere:"Bulk movement reports will appear here after you create bulk movements",allTypes:"All Types",startDate:"Start Date",endDate:"End Date",totalMovements:"Total Movements",totalItems:"Total Items",adjustMovements:"Try adjusting your filters or check back later.",inventoryMovements:"Inventory Movements",createdBy:"Created By",view:"View",enhanced:"Enhanced",legacy:"Legacy",addSingleMovement:"Add Single Movement",inStockSubtitle:"In stock",itemsBelowThreshold:"Items below threshold",inventoryWorth:"Inventory worth",quantity:"Quantity",units:"units",normal:"Normal",productsAndStock:"Products & Stock",lowStockItems:"Low Stock Items",totalStockValue:"Total Stock Value",warehousesAndStores:"Warehouses & stores",andMore:"...and {count} more",latestInventoryActivities:"Latest inventory activities",min:"Min",max:"Max",cost:"Cost",noProductsFound:"No products found matching your search.",noProductsAvailable:"No products available.",noLocationsFound:"No locations found matching your search.",noLocationsAvailable:"No locations available.",searchPlaceholder:"Search by product, location, reference, notes, invoice...",noMovementsFound:"No movements found",tryAdjustingFilters:"Try adjusting your filters or check back later.",transfers:"Transfers",adjustments:"Adjustments",bulk:"Bulk",product:"Product",store:"Store",supplier:"Supplier",warehouse:"Warehouse",movement:"Movement",editMovement:"Edit Movement",updateMovement:"Update Movement",movementInformation:"Movement Information",locationInformation:"Location Information",searchProductsImages:"Search products to view images...",searchForProducts:"Search for Products",startTypingToSearch:"Start typing to search and view product images",tryDifferentSearch:"Try a different search term"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees...",enterFullName:"Enter employee's full name",enterPosition:"Enter job position",enterEmail:"Enter email address",enterPhone:"Enter phone number",enterSalary:"Enter annual salary",departments:{engineering:"Engineering",product:"Product",design:"Design",marketing:"Marketing",sales:"Sales",humanResources:"Human Resources",finance:"Finance",operations:"Operations",analytics:"Analytics"}},entryBooks:{title:"Entry Books",bookName:"Book Name",bookType:"Book Type",createBook:"Create Book",editBook:"Edit Book",salesBook:"Sales Book",purchaseBook:"Purchase Book",cashBook:"Cash Book",generalBook:"General Book",entries:"Entries",addEntry:"Add Entry",period:"Period",startDate:"Start Date",endDate:"End Date",bookBalance:"Book Balance",reconciledBalance:"Reconciled Balance",difference:"Difference",reconcile:"Reconcile",isReconciled:"Is Reconciled",noBooks:"No entry books found",createFirst:"Create your first entry book to get started",bookDetails:"Book Details",entriesCount:"entries",bookOverview:"Book overview and details",bookEntries:"Book Entries",allEntries:"All entries in this book",noEntries:"No entries found",addFirst:"Add your first entry to this book",entryDate:"Entry Date",entryDescription:"Entry Description",entryAmount:"Entry Amount",entryReference:"Entry Reference",subtitle:"Manage accounting entries and general ledger records",viewReconciliation:"View Reconciliation",totalEntries:"Total Entries",allJournalEntries:"All journal entries",postedEntriesOnly:"Posted entries only",fromPostedEntries:"From {count} posted entries",needBankReconciliation:"Need bank reconciliation",allReconciled:"All reconciled",sortBy:"Sort By",fromDate:"From Date",toDate:"To Date",order:"Order",newest:"Newest",oldest:"Oldest",resetFilters:"Reset Filters",activeFilters:"Active filters",from:"From",to:"To",entriesFound:"{count} entries found",noJournalEntries:"No Journal Entries",startByCreating:"Start by creating your first entry",noEntriesMatch:"No journal entries match your current filters.",createFirstEntry:"Create First Entry",void:"Void",confirmVoid:"Are you sure you want to void this journal entry?",entryBookRecords:"Entry Book Records"},banking:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit",reconciled:"Reconciled",notReconciled:"Not Reconciled",unreconciled:"Unreconciled",reconciliation:"Reconciliation",compareStatements:"Compare bank statements with entry book records",importCSV:"Import CSV",startNewReconciliation:"Start New Reconciliation",bankAccountInfo:"Bank Account Info",currentAccountDetails:"Current account details",lastReconciled:"Last reconciled",bankTransactions:"Bank Transactions",selectedPeriod:"Selected period",pending:"pending",bookEntriesForComparison:"Book entries for comparison",reconciliationRate:"Reconciliation Rate",completionStatus:"Completion status",recentReconciliationSessions:"Recent Reconciliation Sessions",latestActivity:"Latest activity",noRecentSessions:"No recent reconciliation sessions found.",startFirstReconciliation:"Start First Reconciliation",entryBookRecords:"Entry Book Records",pleaseUploadCSV:"Please upload a CSV file",csvRequiresHeaderAndData:"CSV file must have at least a header and one data row",successfullyParsed:"Successfully parsed {count} rows",errorParsingCSV:"Error parsing CSV file. Please check the format.",dateDescriptionRequired:"Date and Description columns are required",importedTransaction:"Imported transaction",successfullyImported:"Successfully imported {count} bank transactions",errorImportingTransactions:"Error importing transactions. Please check your data.",importBankStatementCSV:"Import Bank Statement CSV",dropCSVHere:"Drop CSV file here",clickToUploadCSV:"Click to upload or drag and drop CSV file",supportedFormat:"Supported format: CSV with Date, Description, and Amount columns",mapCSVColumns:"Map CSV Columns",dateColumn:"Date Column",selectColumn:"Select column...",descriptionColumn:"Description Column",referenceColumn:"Reference Column",amountDebitColumn:"Amount/Debit Column",creditColumn:"Credit Column",balanceColumn:"Balance Column",andMoreRows:"... and {count} more rows",importing:"Importing...",importTransactions:"Import {count} Transactions",reconciliationComparison:"Reconciliation Comparison",bankStatements:"Bank Statements",totalTransactions:"Total transactions",totalEntries:"Total entries",unreconciledBank:"Unreconciled Bank",unreconciledBooks:"Unreconciled Books",needAttention:"Need attention",unreconcile:"Unreconcile",clickToReconcile:"Click to reconcile",potentialMatchesFound:"Potential Matches Found",clickRecordToReconcile:"Click on a record below to reconcile",exactMatch:"Exact Match",possibleMatch:"Possible Match",selected:"Selected",clearSelection:"Clear Selection"},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",recurringEntry:"Recurring Entry",attachments:"Attachments",totalDebits:"Total Debits",totalCredits:"Total Credits",outOfBalance:"Out of Balance",balanced:"Balanced",addEntry:"Add Journal Entry",allEntries:"All Entries",totalDebit:"Total Debit",totalCredit:"Total Credit",debitShort:"Dr.",creditShort:"Cr.",noReference:"No reference",createdBy:"By",totalAmount:"Total Amount",lines:"Lines",entryNotBalancedShort:"Entry is not balanced",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryLines:"Journal Entry Lines",addLine:"Add Line",lineDescription:"Line description",notBalanced:"Not Balanced",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",editEntryTooltip:"Edit this journal entry",post:"Post",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",voidEntry:"Void Entry",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number"},invoices:{title:"Invoice Dashboard",invoice:"Invoice",invoices:"Invoices",invoiceNumber:"Invoice Number",invoiceDetails:"Invoice Details",customerInformation:"Customer Information",customerName:"Customer Name",legalName:"Legal Name",contactInformation:"Contact Information",idPassport:"ID/Passport",phoneNumber:"Phone Number",altPhone:"Alt Phone",address:"Address",between:"Between",and:"and",products:"Products",reservations:"Reservations",unitPrice:"Unit Price",total:"Total",subtotal:"Subtotal",totalRevenue:"Total Revenue",totalProducts:"Total Products",totalReservations:"Total Reservations",aranceles:"Aranceles (Customs)",uniqueCustomers:"Unique Customers",averageInvoice:"Average Invoice",completed:"Completed",pending:"Pending",storesActive:"Stores Active",topProducts:"Top Products",mostSoldProducts:"Most sold products by quantity",reservationsByType:"Reservations by Type",distributionOfCategories:"Distribution of reservation categories",recentInvoices:"Recent Invoices",showingInvoices:"Showing {{count}} invoices",date:"Date",customer:"Customer",store:"Store",actions:"Actions",view:"View",status:"Status",printInvoice:"Print Invoice",exportPdf:"Export PDF",backToDashboard:"Back to Dashboard",fromInvoices:"From {{count}} invoices",value:"value",activeCustomers:"Active customers",perInvoiceValue:"Per invoice value",locations:"Locations",mostRecentActivity:"Most recent activity",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",clearFilters:"Clear Filters",search:"Search",searchPlaceholder:"Search by invoice #, customer, store...",customsFees:"Total customs fees",salesType:"SALES",packagesOrder:"Packages Order",businessId:"Business ID",orderKey:"Order Key",reservationType:"Reservation Type",arancel:"Arancel",key:"Key",noInvoicesFound:"No invoices found",loadingInvoices:"Loading invoices...",errorLoadingInvoices:"Error loading invoices",refreshData:"Refresh Data",currentStockValue:"Current Stock Value",filterByStore:"Filter by store",filterByDate:"Filter by date range",totalCustomsFees:"Total customs fees",averageValue:"Average value",senderInformation:"Sender Information",receiptInformation:"Receipt Information",productsSubtotal:"Products Subtotal",reservationsSubtotal:"Reservations Subtotal",code:"Code",description:"Description",qty:"Qty",type:"Type",id:"ID",passport:"Passport",createNew:"Create New Invoice",totalOutstanding:"Total Outstanding",unpaidInvoices:"Unpaid invoices",thisMonth:"This Month",revenueCollected:"Revenue collected",overdue:"Overdue",pastDueInvoices:"Past due invoices",latestBillingActivity:"Latest billing activity",paid:"Paid"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",duplicateAccountNumber:"Account number already exists",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry",referenceNumberRequired:"Reference number is required",locationRequired:"Location is required",fromLocationRequired:"From location is required for transfers",atLeastOneProduct:"At least one product is required",itemProductRequired:"Product is required for item {{index}}",itemQuantityRequired:"Quantity must be greater than 0 for item {{index}}"},modals:{addInventory:"Add Inventory Movement",bulkMovement:"Bulk Inventory Movement",addProduct:"Add New Product",addLocation:"Add New Location",inventoryDetail:"Inventory Item Details",quickAdd:"Quick Add",selectProduct:"Select Product",selectLocation:"Select Location",enterQuantity:"Enter quantity",enterCost:"Enter unit cost",enterReference:"Enter reference number",addNotes:"Add notes (optional)",generalInformation:"General Information",stockInformation:"Stock Information",locationInformation:"Location Information",movementInformation:"Movement Information",addToInventory:"Add to Inventory",createProduct:"Create Product",createLocation:"Create Location",processing:"Processing...",addingMovement:"Adding movement...",creatingProduct:"Creating product...",creatingLocation:"Creating location..."},products:{title:"Products",addNew:"Add New Product",totalProducts:"Total Products",inCatalog:"In catalog",activeProducts:"Active Products",currentlyAvailable:"Currently available",outOfStock:"Out of Stock",needsRestock:"Needs restock",productCatalog:"Product Catalog",manageYourProducts:"Manage your products and pricing",inStock:"In Stock",furniture:"Furniture",electronics:"Electronics",supplies:"Supplies",lighting:"Lighting",searchPlaceholder:"Search products by name, SKU, or category...",allCategories:"All Categories",clearFilters:"Clear filters",noResults:"No products found matching your criteria.",noProducts:"No products available.",showing:"Showing",filtered:"Filtered results",allProducts:"All products",searchResult:"Search Result",stock:"Stock",lowStock:"Low Stock"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access"}}},es:{common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrás",next:"Siguiente",previous:"Anterior",yes:"Sí",no:"No",loading:"Cargando...",error:"Error",success:"Éxito",warning:"Advertencia",info:"Información",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripción",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Inglés",spanish:"Español",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",suggested:"Sugerido",clearFilters:"Limpiar Filtros",enhanced:"Mejorado",legacy:"Clásico",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",name:"Nombre",code:"Código",category:"Categoría",type:"Tipo",quantity:"Cantidad",price:"Precio",cost:"Costo",value:"Valor",balance:"Saldo",created:"Creado",modified:"Modificado",details:"Detalles",summary:"Resumen",history:"Historial",new:"Nuevo",addNew:"Agregar Nuevo",unknown:"Desconocido",notAvailable:"N/A",remove:"Remover",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",from:"De",invoice:"Factura",invoices:"facturas",reference:"Referencia",createdBy:"Creado Por",units:"unidades",invoiceDocumentId:"ID de Factura/Documento",referenceNumber:"Número de Referencia",referenceNumberPlaceholder:"Ingrese número de referencia...",generalNotes:"Notas Generales",auto:"Auto",optionalNotes:"Notas opcionales...",showPerPage:"Mostrar por página",first:"Primera",last:"Última",store:"Tienda",orderId:"ID de Orden",tax:"Impuesto",paymentMethods:"Métodos de Pago",cash:"Efectivo",creditCard:"Tarjeta de Crédito",shipping:"Envío",air:"Aéreo",sea:"Marítimo",thankYouBusiness:"¡Gracias por su negocio!",thankForChoosingUs:"¡Gracias por elejirnos!",taxExemptNote:"Impuesto exento en pago en efectivo.",youSaved:"Usted ahorró",generatedOn:"Generado el",printSavePDF:"Imprimir / Guardar como PDF",pageOfPages:"Página {{current}} de {{total}}",showingXofY:"Mostrando {{start}}-{{end}} de {{total}}",page:"Página",of:"de",lbs:"libras"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",employees:"Empleados",entryBooks:"Libros de Entrada",consolidate:"Consolidación Bancaria",reports:"Reportes",settings:"Configuración"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",totalRevenue:"Ingresos Totales",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rápidas",employeeCount:"Número de Empleados",pendingInvoices:"Facturas Pendientes",cashBalance:"Saldo en Efectivo",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",netLoss:"Pérdida Neta",monthlyPayroll:"Nómina Mensual",current:"Actual",newHires:"+3 nuevas contrataciones",outstanding:"Pendiente",totalOutstanding:"$23,450 total",lastUpdatedToday:"Última actualización hoy",commonTasks:"Tareas comunes",generateReport:"Generar Reporte",latestUpdates:"Últimas actualizaciones",invoicePaid:"Factura #1234 pagada",hoursAgo:"hace 2 horas",newEmployeeOnboarded:"Nuevo empleado incorporado",dayAgo:"hace 1 día",monthlyReportGenerated:"Reporte mensual generado",daysAgo:"hace 2 días"},accounts:{title:"Plan de Cuentas",accountNumber:"Número de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categoría",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",backToAccounts:"Volver a Cuentas",accountNotFound:"Cuenta no encontrada",accountInformation:"Información de Cuenta",accountPurpose:"Propósito de la cuenta",transactionHistory:"Historial de Transacciones",noTransactions:"No se encontraron transacciones para esta cuenta",createdDate:"Fecha de Creación",lastModified:"Última Modificación",noDescription:"No se proporcionó descripción.",totalCount:"Conteo total",basicDetails:"Detalles básicos",currentBalance:"Saldo actual",classification:"Clasificación",allTransactions:"Todas las transacciones de la cuenta",reference:"Referencia",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operacionales",operatingExpenses:"Gastos Operacionales"}},inventory:{title:"Gestión de Inventario",overview:"Resumen",products:"Productos y Stock",movements:"Movimientos",locations:"Ubicaciones",bulkMovement:"Movimiento Masivo",addMovement:"Agregar Movimiento",addProduct:"Agregar Producto",addLocation:"Agregar Ubicación",singleMovement:"Agregar Movimiento Individual",addNewItem:"Agregar Nuevo Artículo",activeProducts:"Productos Activos",lowStockAlert:"Artículos con Stock Bajo",totalValue:"Valor Total del Stock",activeLocations:"Ubicaciones Activas",productsNeedRestocking:"productos necesitan reabastecimiento",recentMovements:"Movimientos Recientes",noProducts:"No hay productos en esta ubicación",productName:"Nombre del Producto",productCode:"Código del Producto",sku:"SKU",category:"Categoria",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",minStockLevel:"Nivel Mínimo de Stock",maxStockLevel:"Nivel Máximo de Stock",locationName:"Nombre de Ubicación",locationType:"Tipo de Ubicación",locationCode:"Código de Ubicación",movementType:"Tipo de Movimiento",referenceNumber:"Número de Referencia",invoiceNumber:"Número de Factura",fromLocation:"Desde Ubicación",toLocation:"Hacia Ubicación",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicación",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicación",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",totalLocations:"Total de Ubicaciones",lastSeen:"Visto por última vez",warehouseType:"Almacén",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente",currentlyManaged:"Gestionados actualmente",needAttention:"Necesitan atención",currentWorth:"Valor actual",warehousesStores:"Almacenes y tiendas",thisMonth:"Este Mes",latestActivities:"Últimas actividades de inventario",searchMovements:"Buscar Movimientos",countingSheet:"Hoja de Conteo",physicalCount:"Conteo Físico",physicalInventoryCount:"Conteo Físico de Inventario",setupPhysicalCount:"Configurar Conteo Físico de Inventario",setupDescription:"Configure los ajustes de su conteo físico de inventario y comience el proceso de conteo.",countWillInclude:"Este conteo incluirá {{count}} productos de {{location}} en la categoría {{category}}.",startCounting:"Iniciar Conteo Físico",counted:"Contado",remaining:"Restante",variances:"Variaciones",complete:"Completo",systemQty:"Cant. Sistema",variance:"Variación",addNotes:"Agregar notas...",reviewAndConfirm:"Revisar y Confirmar Ajustes",reviewDescription:"Revise los ajustes de inventario a continuación y confirme para actualizar su sistema.",stockIncreases:"Aumentos de Stock",stockDecreases:"Disminuciones de Stock",totalAdjustments:"Ajustes Totales",confirmAdjustments:"Confirmar Ajustes",perfectCount:"¡Conteo Perfecto!",noVariances:"No se encontraron variaciones. Su conteo físico coincide exactamente con el sistema.",physicalCountAdjustment:"Ajuste de conteo físico",inventoryCountingSheetTitle:"HOJA DE CONTEO DE INVENTARIO",location:"Ubicación",allCategories:"Todas las Categorías",countedBy:"Contado por",verifiedBy:"Verificado por",instructions:"Instrucciones",countInstructions:["Contar todos los artículos físicamente presentes en esta ubicación",'Escribir el conteo real en la columna "Conteo Físico"',"Dejar en blanco si el artículo no se encuentra",'Anotar cualquier discrepancia en la columna "Notas"',"Firmar y fechar cuando esté completo"],unit:"Unidad",totalProductsListed:"Total de Productos Listados",itemsCounted:"Artículos Contados",summaryFor:"RESUMEN PARA",discrepanciesFound:"Discrepancias Encontradas",counterSignature:"Firma del Contador",supervisorSignature:"Firma del Supervisor",downloadCSV:"Descargar CSV",noAdjustmentsToDownload:"No hay ajustes para descargar",stockIncrease:"Aumento de Stock",stockDecrease:"Disminución de Stock",purchaseReceive:"Compra/Recepción",saleIssue:"Venta/Emisión",generalNotesPlaceholder:"Ingrese notas generales para este movimiento...",sortBy:"Ordenar Por",allLocations:"Todas las Ubicaciones",searchByProduct:"Buscar por producto, ubicación, referencia, notas, factura...",allProducts:"Todos los Productos",bulkMovementReport:"Reporte de Movimiento en Lote",totalQuantity:"Cantidad Total",estimatedValue:"Valor Estimado",viewHistoricalReports:"Ver Reportes Históricos",noBulkReportsFound:"No se encontraron reportes de movimientos en lote",bulkReportsAppearHere:"Los reportes de movimientos en lote aparecerán aquí después de crear movimientos en lote",allTypes:"Todos los Tipos",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",totalMovements:"Movimientos Totales",adjustMovements:"Intenta ajustar tus filtros o revisa más tarde.",inventoryMovements:"Movimientos de Inventario",createdBy:"Creado Por",view:"Ver",enhanced:"Mejorado",legacy:"Clásico",addSingleMovement:"Agregar Movimiento Individual",inStockSubtitle:"En stock",itemsBelowThreshold:"Artículos bajo el umbral",inventoryWorth:"Valor del inventario",quantity:"Cantidad",units:"unidades",normal:"Normal",productsAndStock:"Productos y Stock",lowStockItems:"Artículos con Stock Bajo",totalStockValue:"Valor Total del Stock",warehousesAndStores:"Almacenes y tiendas",andMore:"...y {count} más",latestInventoryActivities:"Últimas actividades de inventario",min:"Mín",max:"Máx",cost:"Costo",noProductsFound:"No se encontraron productos que coincidan con su búsqueda.",noProductsAvailable:"No hay productos disponibles.",noLocationsFound:"No se encontraron ubicaciones que coincidan con su búsqueda.",noLocationsAvailable:"No hay ubicaciones disponibles.",searchPlaceholder:"Buscar por producto, ubicación, referencia, notas, factura...",noMovementsFound:"No se encontraron movimientos",tryAdjustingFilters:"Intenta ajustar tus filtros o revisa más tarde.",transfers:"Transferencias",adjustments:"Ajustes",bulk:"Masivo",product:"Producto",store:"Tienda",supplier:"Proveedor",warehouse:"Almacén",movement:"Movimiento",editMovement:"Editar Movimiento",updateMovement:"Actualizar Movimiento",movementInformation:"Información del Movimiento",locationInformation:"Información de Ubicación",searchProductsImages:"Buscar productos para ver imágenes...",searchForProducts:"Buscar Productos",startTypingToSearch:"Comienza a escribir para buscar y ver imágenes de productos",tryDifferentSearch:"Prueba con un término de búsqueda diferente"},employees:{title:"Gestión de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Información Personal",employmentInfo:"Información Laboral",payrollInfo:"Información de Nómina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratación",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nómina Total",searchEmployees:"Buscar empleados...",enterFullName:"Ingrese el nombre completo del empleado",enterPosition:"Ingrese el puesto de trabajo",enterEmail:"Ingrese la dirección de correo electrónico",enterPhone:"Ingrese el número de teléfono",enterSalary:"Ingrese el salario anual",departments:{engineering:"Ingeniería",product:"Producto",design:"Diseño",marketing:"Marketing",sales:"Ventas",humanResources:"Recursos Humanos",finance:"Finanzas",operations:"Operaciones",analytics:"Analítica"}},entryBooks:{title:"Libros de Entrada",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Período",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Está Conciliado",noBooks:"No se encontraron libros de entrada",createFirst:"Crea tu primer libro de entrada para comenzar",bookDetails:"Detalles del Libro",entriesCount:"entradas",bookOverview:"Resumen y detalles del libro",bookEntries:"Entradas del Libro",allEntries:"Todas las entradas en este libro",noEntries:"No se encontraron entradas",addFirst:"Agrega tu primera entrada a este libro",entryDate:"Fecha de Entrada",entryDescription:"Descripción de Entrada",entryAmount:"Monto de Entrada",entryReference:"Referencia de Entrada"},banking:{title:"Consolidación Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depósitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automática",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliación",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depósitos en Tránsito",reconciled:"Conciliado",notReconciled:"No Conciliado",unreconciled:"No Conciliado",reconciliation:"Conciliación",compareStatements:"Comparar estados bancarios con registros de libros de entrada",importCSV:"Importar CSV",startNewReconciliation:"Iniciar Nueva Conciliación",bankAccountInfo:"Información de Cuenta Bancaria",currentAccountDetails:"Detalles de cuenta actual",lastReconciled:"Última conciliación",bankTransactions:"Transacciones Bancarias",selectedPeriod:"Período seleccionado",pending:"pendiente",bookEntriesForComparison:"Entradas de libros para comparación",reconciliationRate:"Tasa de Conciliación",completionStatus:"Estado de finalización",recentReconciliationSessions:"Sesiones de Conciliación Recientes",latestActivity:"Actividad reciente",noRecentSessions:"No se encontraron sesiones de conciliación recientes.",startFirstReconciliation:"Iniciar Primera Conciliación",entryBookRecords:"Registros de Libros de Entrada",pleaseUploadCSV:"Por favor suba un archivo CSV",csvRequiresHeaderAndData:"El archivo CSV debe tener al menos un encabezado y una fila de datos",successfullyParsed:"Se analizaron exitosamente {count} filas",errorParsingCSV:"Error al analizar el archivo CSV. Verifique el formato.",dateDescriptionRequired:"Las columnas de Fecha y Descripción son requeridas",importedTransaction:"Transacción importada",successfullyImported:"Se importaron exitosamente {count} transacciones bancarias",errorImportingTransactions:"Error al importar transacciones. Verifique sus datos.",importBankStatementCSV:"Importar CSV de Estado Bancario",dropCSVHere:"Suelte el archivo CSV aquí",clickToUploadCSV:"Haga clic para cargar o arrastre y suelte el archivo CSV",supportedFormat:"Formato soportado: CSV con columnas de Fecha, Descripción y Monto",mapCSVColumns:"Mapear Columnas CSV",dateColumn:"Columna de Fecha",selectColumn:"Seleccionar columna...",descriptionColumn:"Columna de Descripción",referenceColumn:"Columna de Referencia",amountDebitColumn:"Columna de Monto/Débito",creditColumn:"Columna de Crédito",balanceColumn:"Columna de Saldo",andMoreRows:"... y {count} filas más",importing:"Importando...",importTransactions:"Importar {count} Transacciones",reconciliationComparison:"Comparación de Conciliación",bankStatements:"Estados Bancarios",totalTransactions:"Transacciones totales",totalEntries:"Entradas totales",unreconciledBank:"Banco No Conciliado",unreconciledBooks:"Libros No Conciliados",needAttention:"Necesitan atención",unreconcile:"Desconciliar",clickToReconcile:"Hacer clic para conciliar",potentialMatchesFound:"Coincidencias Potenciales Encontradas",clickRecordToReconcile:"Haga clic en un registro a continuación para conciliar",exactMatch:"Coincidencia Exacta",possibleMatch:"Posible Coincidencia",selected:"Seleccionado",clearSelection:"Limpiar Selección"},journal:{title:"Asientos Contables",entryNumber:"Número de Asiento",entryDate:"Fecha del Asiento",debit:"Débito",credit:"Crédito",account:"Cuenta",memo:"Memo",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",recurringEntry:"Asiento Recurrente",attachments:"Adjuntos",totalDebits:"Débitos Totales",totalCredits:"Créditos Totales",outOfBalance:"Desbalanceado",balanced:"Balanceado"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Dirección de correo inválida",invalidNumber:"Número inválido",invalidDate:"Fecha inválida",selectOption:"Por favor seleccione una opción",enterValue:"Por favor ingrese un valor",confirmDelete:"¿Está seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. ¿Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",duplicateAccountNumber:"El número de cuenta ya existe",referenceNumberRequired:"El número de referencia es requerido",locationRequired:"La ubicación es requerida",fromLocationRequired:"La ubicación de origen es requerida para transferencias",atLeastOneProduct:"Al menos un producto es requerido",itemProductRequired:"El producto es requerido para el artículo {{index}}",itemQuantityRequired:"La cantidad debe ser mayor que 0 para el artículo {{index}}"},modals:{addInventory:"Agregar Movimiento de Inventario",bulkMovement:"Movimiento Masivo de Inventario",addProduct:"Agregar Nuevo Producto",addLocation:"Agregar Nueva Ubicación",inventoryDetail:"Detalles del Artículo de Inventario",quickAdd:"Agregar Rápido",selectProduct:"Seleccionar Producto",selectLocation:"Seleccionar Ubicación",enterQuantity:"Ingresar cantidad",enterCost:"Ingresar costo unitario",enterReference:"Ingresar número de referencia",addNotes:"Agregar notas (opcional)",generalInformation:"Información General",stockInformation:"Información de Stock",locationInformation:"Información de Ubicación",movementInformation:"Información de Movimiento",addToInventory:"Agregar al Inventario",createProduct:"Crear Producto",createLocation:"Crear Ubicación",processing:"Procesando...",addingMovement:"Agregando movimiento...",creatingProduct:"Creando producto...",creatingLocation:"Creando ubicación..."},products:{title:"Productos",addNew:"Agregar Nuevo Producto",totalProducts:"Total de Productos",inCatalog:"En catálogo",activeProducts:"Productos Activos",currentlyAvailable:"Actualmente disponibles",outOfStock:"Sin Stock",needsRestock:"Necesita reabastecimiento",productCatalog:"Catálogo de Productos",manageYourProducts:"Gestiona tus productos y precios",inStock:"En Stock",furniture:"Muebles",electronics:"Electrónicos",supplies:"Suministros",lighting:"Iluminación"},invoices:{title:"Panel de Facturas",invoice:"Factura",invoices:"Facturas",invoiceNumber:"Número de Factura",invoiceDetails:"Detalles de Factura",customerInformation:"Información del Cliente",customerName:"Nombre del Cliente",legalName:"Nombre Legal",contactInformation:"Información de Contacto",idPassport:"ID/Pasaporte",phoneNumber:"Número de Teléfono",altPhone:"Teléfono Alt.",address:"Dirección",between:"Entre",and:"y",products:"Productos",reservations:"Reservaciones",unitPrice:"Precio Unitario",total:"Total",subtotal:"Subtotal",category:"Categoria",totalRevenue:"Ingresos Totales",totalProducts:"Total de Productos",totalReservations:"Total de Reservaciones",aranceles:"Aranceles (Aduanas)",uniqueCustomers:"Clientes Únicos",averageInvoice:"Factura Promedio",completed:"Completada",pending:"Pendiente",storesActive:"Tiendas Activas",topProducts:"Productos Principales",mostSoldProducts:"Productos más vendidos por cantidad",reservationsByType:"Reservaciones por Tipo",distributionOfCategories:"Distribución de categorías de reservaciones",recentInvoices:"Facturas Recientes",showingInvoices:"Mostrando {{count}} facturas",date:"Fecha",customer:"Cliente",store:"Tienda",actions:"Acciones",view:"Ver",status:"Estado",printInvoice:"Imprimir Factura",exportPdf:"Exportar PDF",backToDashboard:"Volver al Panel",fromInvoices:"De {{count}} facturas",value:"valor",activeCustomers:"Clientes activos",perInvoiceValue:"Valor por factura",locations:"Ubicaciones",mostRecentActivity:"Actividad más reciente",storeLocation:"Ubicación de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",clearFilters:"Limpiar Filtros",search:"Buscar",searchPlaceholder:"Buscar por # factura, cliente, tienda...",customsFees:"Aranceles totales",salesType:"VENTAS",packagesOrder:"Orden de Paquetes",businessId:"ID de Negocio",orderKey:"Clave de Orden",reservationType:"Tipo de Reservación",arancel:"Arancel",key:"Clave",noInvoicesFound:"No se encontraron facturas",loadingInvoices:"Cargando facturas...",errorLoadingInvoices:"Error al cargar facturas",refreshData:"Actualizar Datos",currentStockValue:"Valor de Stock Actual",filterByStore:"Filtrar por tienda",filterByDate:"Filtrar por rango de fechas",totalCustomsFees:"Aranceles totales",averageValue:"Valor promedio",senderInformation:"Información del Remitente",receiptInformation:"Información del Destinatario",productsSubtotal:"Subtotal de Productos",reservationsSubtotal:"Subtotal de Reservaciones",code:"Código",description:"Descripción",qty:"Cant.",type:"Tipo",id:"ID",passport:"Pasaporte"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"¿Por qué veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadísticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"¿Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestión de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestión de Facturas",productManagement:"Acceso a Gestión de Productos"}}}},e$=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["en","es"].includes(t))return t}return"en"},[ef,t$]=Ce(e$()),sr=()=>({t:(n,i,o)=>{const s=ef(),l=n.split(".");let c=ZI[s];for(const h of l)if(c&&typeof c=="object"&&h in c)c=c[h];else return i||n;let u=typeof c=="string"?c:i||n;return o&&typeof u=="string"&&Object.keys(o).forEach(h=>{const y=o[h],g=`{{${h}}}`;u=u.replace(new RegExp(g,"g"),String(y))}),u},language:()=>ef(),setLanguage:n=>{t$(n),typeof window<"u"&&localStorage.setItem("hrmfinance-language",n)},currentLanguage:ef});var r$=he("<div><label></label><select><option value>"),n$=he("<span>*"),i$=he("<option>");const _n=t=>{const{t:e}=sr(),r={display:"block","font-weight":"500","margin-bottom":"0.5rem",color:"var(--text-primary)"},n={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem","font-family":"inherit",background:"var(--surface-color)",color:"var(--text-primary)",transition:"border-color 0.2s ease"},i={"margin-bottom":"1rem"};return(()=>{var o=r$(),s=o.firstChild,l=s.nextSibling,c=l.firstChild;return m(o,i),m(s,r),a(s,()=>t.label,null),a(s,(()=>{var u=Ee(()=>!!t.required);return()=>u()&&(()=>{var h=n$();return h.style.setProperty("color","var(--primary-color)"),h})()})(),null),l.addEventListener("blur",u=>u.target.style.borderColor="var(--border-color)"),l.addEventListener("focus",u=>u.target.style.borderColor="var(--primary-color)"),l.addEventListener("change",u=>t.onChange(u.target.value)),m(l,n),a(c,()=>e("forms.selectOption")),a(l,()=>t.options.map(u=>(()=>{var h=i$();return a(h,()=>u.label),Se(()=>h.value=u.value),h})()),null),Se(u=>{var h=t.required,y=t.disabled;return h!==u.e&&(l.required=u.e=h),y!==u.t&&(l.disabled=u.t=y),u},{e:void 0,t:void 0}),Se(()=>l.value=t.value),o})()};var o$=he("<main><div>"),s$=he("<header><h1>");const Qi=t=>{const e={"min-height":"100vh",background:"var(--background-color)"},r={"max-width":"1200px",margin:"0 auto",padding:"2rem"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},i={"font-size":"2rem","font-weight":"700",color:"var(--text-primary)",margin:"0"};return(()=>{var o=o$(),s=o.firstChild;return m(o,e),m(s,r),a(s,(()=>{var l=Ee(()=>!!t.title);return()=>l()&&(()=>{var c=s$(),u=c.firstChild;return m(c,n),m(u,i),a(u,()=>t.title),c})()})(),null),a(s,()=>t.children,null),o})()};var a$=he("<div><span></span><select><option value=en>🇺🇸 </option><option value=es>🇪🇸 ");const l$=()=>{const{t,language:e,setLanguage:r}=sr(),n={display:"flex","align-items":"center",gap:"0.5rem","margin-left":"auto"},i={padding:"0.5rem 1rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",background:"var(--surface-color)",color:"var(--text-primary)",cursor:"pointer","font-size":"0.875rem","font-weight":"500",transition:"all 0.2s ease","min-width":"120px"},o={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},s=l=>{const c=l.target;r(c.value)};return(()=>{var l=a$(),c=l.firstChild,u=c.nextSibling,h=u.firstChild;h.firstChild;var y=h.nextSibling;return y.firstChild,m(l,n),m(c,o),u.addEventListener("change",s),m(u,i),a(h,()=>t("common.english"),null),a(y,()=>t("common.spanish"),null),Se(()=>u.value=e()),l})()};var l0=he('<img alt="User avatar">'),c$=he("<div class=user-info-desktop><span>"),u$=he("<button class=sign-out-desktop>Sign Out"),d$=he("<div><div><span></span></div><button>Sign Out"),h$=he(`<nav><div><div class=desktop-nav></div><div><button class=mobile-menu-button><svg width=24 height=24 viewBox="0 0 24 24"fill=currentColor><path></path></svg></button></div></div><div class=mobile-nav></div><style>
        .nav-active {
          background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
          color: white !important;
          box-shadow: var(--shadow-sm);
        }
        
        .desktop-nav a:hover:not(.nav-active),
        .nav-group button:hover {
          background: var(--background-color);
          color: var(--text-primary);
        }
        
        .mobile-nav a:hover:not(.nav-active) {
          background: var(--background-color);
          color: var(--text-primary);
        }

        /* Create invisible bridge to prevent gap issues */
        .nav-group::before {
          content: '';
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          height: 0.5rem;
          z-index: 9;
        }
        
        @media (max-width: 768px) {
          .desktop-nav {
            display: none !important;
          }
          
          .mobile-menu-button {
            display: block !important;
          }
          
          .user-info-desktop,
          .sign-out-desktop {
            display: none !important;
          }
          
          nav > div:first-child {
            padding: 1rem;
          }
        }
        
        @media (min-width: 769px) {
          .mobile-nav {
            display: none !important;
          }
        }
      `),p$=he("<div class=nav-group><button> <span>▼</span></button><div>"),f$=he("<div>"),m$=he("<div><div><span> </span><span>▼");const y$=()=>{const{t}=sr(),[e,r]=Ce(!1),[n,i]=Ce(null),[o,s]=Ce(null),l={background:"var(--surface-color)","border-bottom":"1px solid var(--border-color)","box-shadow":"var(--shadow-sm)","backdrop-filter":"blur(10px)",position:"sticky",top:"0","z-index":"100"},c={display:"flex","align-items":"center","justify-content":"space-between",padding:"1rem 2rem",margin:"0 auto",position:"relative"},u={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","text-decoration":"none"},h={display:"flex",gap:"1rem","align-items":"center",flex:"1","margin-left":"2rem"},y={display:"none",position:"absolute",top:"100%",left:"0",right:"0",background:"var(--surface-color)","border-top":"1px solid var(--border-color)","box-shadow":"var(--shadow-md)","max-height":"70vh","overflow-y":"auto"},g={position:"relative",display:"flex","align-items":"center"},f={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem",background:"transparent",border:"none",color:"var(--text-secondary)","font-weight":"500","font-size":"0.875rem",cursor:"pointer","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease","white-space":"nowrap"},x={position:"absolute",top:"100%",left:"0",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-lg)","min-width":"200px","margin-top":"0.25rem","z-index":"10",display:"none","padding-top":"0.25rem"},S={"border-bottom":"1px solid var(--border-color)"},P={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",cursor:"pointer","font-weight":"600",color:"var(--text-primary)"},$={display:"block","text-decoration":"none",color:"var(--text-secondary)",padding:"0.75rem 1rem","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease","white-space":"nowrap"},U={...$,padding:"0.75rem 1.5rem","border-bottom":"1px solid var(--border-light)"},se={display:"none",background:"transparent",border:"none",padding:"0.5rem",cursor:"pointer",color:"var(--text-primary)"},X={display:"flex","align-items":"center",gap:"1rem"},Z={display:"flex","align-items":"center",gap:"0.75rem",padding:"0.5rem 1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",color:"var(--text-primary)"},re={width:"32px",height:"32px","border-radius":"50%","object-fit":"cover"},E={...$,cursor:"pointer",border:"1px solid var(--border-color)",background:"transparent","border-radius":"var(--border-radius-sm)"},C=()=>{pr.signOut()},T=k=>{const R=pr.state?.profile;return R?R[k]===!0||R.isAdmin===!0:!1},j=()=>{r(!e())},b=k=>{i(n()===k?null:k)},w=k=>{const R=o();R&&(clearTimeout(R),s(null)),i(k)},_=()=>{const k=setTimeout(()=>{i(null)},300);s(k)},W=[{name:"Finance",icon:"💰",items:[{path:"/accounts",label:t("navigation.accounts"),permission:"AccountAccess",icon:"📊"},{path:"/entry-books",label:t("navigation.entryBooks"),permission:"JournalAccess",icon:"📚"},{path:"/balance-sheet",label:t("navigation.balanceSheet"),permission:"AccountAccess",icon:"📈"},{path:"/bank-consolidations",label:t("navigation.consolidate"),permission:"BankingAccess",icon:"🏦"}]},{name:"Operations",icon:"📦",items:[{path:"/inventory",label:t("navigation.inventory"),permission:"InventoryAccess",icon:"📦"},{path:"/invoices",label:t("invoices.invoices"),permission:"invoiceAccess",icon:"📚"},{path:"/hbl",label:t("navigation.hbl"),permission:"HBLAccess",icon:"🚢"}]},{name:"Management",icon:"👥",items:[{path:"/employees",label:t("navigation.employees"),permission:"EmployeeAccess",icon:"👷"},{path:"/admin/users",label:"Admin",permission:"isAdmin",icon:"👑",adminOnly:!0}]}],K=()=>W.map(k=>({...k,items:k.items.filter(R=>R.adminOnly?pr.state?.profile?.isAdmin:T(R.permission))})).filter(k=>k.items.length>0);return(()=>{var k=h$(),R=k.firstChild,Y=R.firstChild,q=Y.nextSibling,O=q.firstChild,le=O.firstChild,N=le.firstChild,D=R.nextSibling;return a(R,M(rc,{href:"/",style:u,children:"HRM Finance"}),Y),m(Y,h),a(Y,M(rc,{href:"/",style:$,activeClass:"nav-active",get children(){return["🏠 ",Ee(()=>t("navigation.dashboard"))]}}),null),a(Y,M(Ht,{get each(){return K()},children:V=>(()=>{var I=p$(),F=I.firstChild,Q=F.firstChild,H=Q.nextSibling,J=F.nextSibling;return I.addEventListener("mouseleave",_),I.addEventListener("mouseenter",()=>w(V.name)),a(F,()=>V.icon,Q),a(F,()=>V.name,H),H.style.setProperty("font-size","0.75rem"),J.addEventListener("mouseleave",_),J.addEventListener("mouseenter",()=>w(V.name)),a(J,M(Ht,{get each(){return V.items},children:te=>M(rc,{get href(){return te.path},style:$,activeClass:"nav-active",onClick:()=>i(null),get children(){return[Ee(()=>te.icon)," ",Ee(()=>te.label)]}})})),Se(te=>{var ee=g,ne=f,G={...x,display:n()===V.name?"block":"none"};return te.e=m(I,ee,te.e),te.t=m(F,ne,te.t),te.a=m(J,G,te.a),te},{e:void 0,t:void 0,a:void 0}),I})()}),null),m(q,X),a(q,M(l$,{}),O),a(q,M(Ge,{get when(){return pr.currentUser},get children(){return[(()=>{var V=c$(),I=V.firstChild;return a(V,M(Ge,{get when(){return pr.currentUser?.photoURL},get children(){var F=l0();return Se(Q=>{var H=pr.currentUser.photoURL,J=re;return H!==Q.e&&nr(F,"src",Q.e=H),Q.t=m(F,J,Q.t),Q},{e:void 0,t:void 0}),F}}),I),a(I,()=>pr.currentUser?.displayName||pr.currentUser?.email),Se(F=>m(V,Z,F)),V})(),(()=>{var V=u$();return V.addEventListener("mouseleave",I=>{I.currentTarget.style.background="transparent",I.currentTarget.style.color="var(--text-secondary)"}),V.addEventListener("mouseenter",I=>{I.currentTarget.style.background="var(--background-color)",I.currentTarget.style.color="var(--text-primary)"}),V.$$click=C,Se(I=>m(V,E,I)),V})()]}}),O),O.$$click=j,m(O,se),a(D,M(rc,{href:"/",style:U,activeClass:"nav-active",onClick:()=>r(!1),get children(){return["🏠 ",Ee(()=>t("navigation.dashboard"))]}}),null),a(D,M(Ht,{get each(){return K()},children:V=>(()=>{var I=m$(),F=I.firstChild,Q=F.firstChild,H=Q.firstChild,J=Q.nextSibling;return m(I,S),F.$$click=()=>b(V.name),m(F,P),a(Q,()=>V.icon,H),a(Q,()=>V.name,null),J.style.setProperty("transition","transform 0.2s"),a(I,M(Ge,{get when(){return n()===V.name},get children(){var te=f$();return te.style.setProperty("background","var(--background-color)"),a(te,M(Ht,{get each(){return V.items},children:ee=>M(rc,{get href(){return ee.path},get style(){return{...U,"padding-left":"3rem"}},activeClass:"nav-active",onClick:()=>r(!1),get children(){return[Ee(()=>ee.icon)," ",Ee(()=>ee.label)]}})})),te}}),null),Se(te=>(te=n()===V.name?"rotate(180deg)":"none")!=null?J.style.setProperty("transform",te):J.style.removeProperty("transform")),I})()}),null),a(D,M(Ge,{get when(){return pr.currentUser},get children(){var V=d$(),I=V.firstChild,F=I.firstChild,Q=I.nextSibling;return V.style.setProperty("padding","1rem"),V.style.setProperty("border-top","2px solid var(--border-color)"),a(I,M(Ge,{get when(){return pr.currentUser?.photoURL},get children(){var H=l0();return Se(J=>{var te=pr.currentUser.photoURL,ee=re;return te!==J.e&&nr(H,"src",J.e=te),J.t=m(H,ee,J.t),J},{e:void 0,t:void 0}),H}}),F),a(F,()=>pr.currentUser?.displayName||pr.currentUser?.email),Q.$$click=()=>{C(),r(!1)},Se(H=>{var J={...Z,"margin-bottom":"1rem"},te={...E,width:"100%"};return H.e=m(I,J,H.e),H.t=m(Q,te,H.t),H},{e:void 0,t:void 0}),V}}),null),Se(V=>{var I=l,F=c,Q=e()?"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z":"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",H={...y,display:e()?"block":"none"};return V.e=m(k,I,V.e),V.t=m(R,F,V.t),Q!==V.a&&nr(N,"d",V.a=Q),V.o=m(D,H,V.o),V},{e:void 0,t:void 0,a:void 0,o:void 0}),k})()};yr(["click"]);var g$=he("<div><div><div>🔒</div><h1></h1><p>.</p><div><p><strong></strong><br></p></div><div><button></button></div><div><h3></h3><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div><div><span>✓</span><span></span></div></div><div><p>"),c0=he("<br>"),v$=he("<strong>");const b$=t=>{const{t:e}=sr(),r={"min-height":"calc(100vh - 200px)",display:"flex","align-items":"center","justify-content":"center",padding:"2rem"},n={"text-align":"center","max-width":"600px",width:"100%"},i={"font-size":"5rem",color:"#e53e3e","margin-bottom":"2rem"},o={"font-size":"2.5rem","font-weight":"700",color:"#1a202c","margin-bottom":"1rem"},s={"font-size":"1.25rem",color:"#718096","margin-bottom":"2rem","line-height":"1.6"},l={background:"#f7fafc",border:"1px solid #e2e8f0","border-radius":"0.5rem",padding:"1.5rem","margin-bottom":"2rem"},c={color:"#4a5568","font-size":"1rem","line-height":"1.6"},u={display:"flex",gap:"1rem","justify-content":"center","flex-wrap":"wrap"},h={padding:"0.75rem 2rem","border-radius":"0.5rem","text-decoration":"none","font-weight":"500",transition:"all 0.2s",display:"inline-block"},y={...h,background:"var(--primary-color)",color:"white",border:"2px solid var(--primary-color)"},g={...h,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},f={"text-align":"left","margin-top":"2rem",padding:"0 2rem"},x={display:"flex","align-items":"center",gap:"0.75rem","margin-bottom":"1rem",color:"#4a5568"},S={color:"#48bb78","font-size":"1.25rem"};return M(Qi,{get title(){return e("unauthorized.title")},get children(){var P=g$(),$=P.firstChild,U=$.firstChild,se=U.nextSibling,X=se.nextSibling,Z=X.firstChild,re=X.nextSibling,E=re.firstChild,C=E.firstChild;C.nextSibling;var T=re.nextSibling,j=T.firstChild,b=T.nextSibling,w=b.firstChild,_=w.nextSibling,W=_.firstChild,K=W.nextSibling,k=_.nextSibling,R=k.firstChild,Y=R.nextSibling,q=k.nextSibling,O=q.firstChild,le=O.nextSibling,N=b.nextSibling,D=N.firstChild;return m(P,r),m($,n),m(U,i),m(se,o),a(se,()=>e("unauthorized.accessDenied")),m(X,s),a(X,()=>e("unauthorized.noPermission"),Z),a(X,(()=>{var V=Ee(()=>!!t.featureName);return()=>V()?` ${t.featureName}`:` ${e("unauthorized.thisFeature")}`})(),Z),m(re,l),m(E,c),a(C,()=>e("unauthorized.whySeeing")),a(E,()=>e("unauthorized.explanation"),null),a(E,(()=>{var V=Ee(()=>!!t.requiredPermission);return()=>V()&&[c0(),c0(),(()=>{var I=v$();return a(I,()=>e("unauthorized.requiredPermission")),I})()," ",Ee(()=>t.requiredPermission)]})(),null),m(T,u),a(T,M(rc,{href:"/",style:y,get children(){return e("unauthorized.goToDashboard")}}),j),j.$$click=()=>window.history.back(),a(j,()=>e("unauthorized.goBack")),m(b,f),w.style.setProperty("margin-bottom","1rem"),w.style.setProperty("color","#2d3748"),a(w,()=>e("unauthorized.featuresCanAccess")),a(K,()=>e("unauthorized.dashboardAccess")),a(Y,()=>e("unauthorized.profileAccess")),a(le,()=>e("unauthorized.roleBasedAccess")),N.style.setProperty("margin-top","3rem"),N.style.setProperty("padding","1.5rem"),N.style.setProperty("background","#edf2f7"),N.style.setProperty("border-radius","0.5rem"),D.style.setProperty("color","#4a5568"),D.style.setProperty("font-size","0.875rem"),a(D,()=>e("unauthorized.needAccess")),Se(V=>{var I=g,F=x,Q=S,H=x,J=S,te=x,ee=S;return V.e=m(j,I,V.e),V.t=m(_,F,V.t),V.a=m(W,Q,V.a),V.o=m(k,H,V.o),V.i=m(R,J,V.i),V.n=m(q,te,V.n),V.s=m(O,ee,V.s),V},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),P}})};yr(["click"]);const _o=t=>{const{t:e}=sr(),r=()=>{if(!t.permission)return!0;const i=pr.state?.profile;if(!i)return!1;if(i.isAdmin)return!0;switch(t.permission){case"AccountAccess":return i.AccountAccess===!0;case"InventoryAccess":return i.InventoryAccess===!0;case"EmployeeAccess":return i.EmployeeAccess===!0;case"BankingAccess":return i.BankingAccess===!0;case"JournalAccess":return i.JournalAccess===!0;case"AdminAccess":return i.isAdmin===!0;default:return i[t.permission]===!0}},n=()=>{if(t.requiredPermission)return t.requiredPermission;switch(t.permission){case"AccountAccess":return e("unauthorized.permissions.accountAccess");case"InventoryAccess":return e("unauthorized.permissions.inventoryAccess");case"EmployeeAccess":return e("unauthorized.permissions.employeeAccess");case"BankingAccess":return e("unauthorized.permissions.bankingAccess");case"JournalAccess":return e("unauthorized.permissions.journalAccess");case"AdminAccess":return e("unauthorized.permissions.adminAccess");default:return t.permission}};return M(Ge,{get when(){return r()},get fallback(){return t.fallback||M(b$,{get featureName(){return t.featureName},get requiredPermission(){return n()}})},get children(){return t.children}})};var _$=he('<button title="Open Dev Tools">🛠️'),S$=he("<span>(<!>)"),P$=he("<div><span></span><span>"),u0=he("<div>"),w$=he("<div>Database reset only available in fake mode"),x$=he("<div><div>Loading..."),A$=he("<div><div><h3>🛠️ Dev Tools</h3><button>✕</button></div><div><div>API Mode</div><div><button>Fake Server</button><button>Real API</button><button>Hybrid</button></div><div>Current: <strong></strong></div></div><div><div>Health Status</div></div><div><div>Database Stats</div></div><div><div>Actions</div><div><button>🔄 Refresh Stats</button><button>💊 Health Check</button></div><div><button>🗑️ Reset DB</button></div></div><div><div>Info</div><div>• <strong>Fake Server:</strong> Uses local mock data<br>• <strong>Real API:</strong> Connects to actual backend<br>• <strong>Hybrid:</strong> Real API with fake fallback<br>• Settings are saved in localStorage"),C$=he("<div>Loading..."),I$=he("<div><span>:</span><span>");const $$=()=>{const[t,e]=Ce(!1),[r,n]=Ce(wm.getMode()),[i,o]=Ce({}),[s,l]=Ce(null),[c,u]=Ce(!1);Sn(async()=>{await h(),await y()});const h=async()=>{try{const E=await s0.getStats();o(E)}catch(E){console.error("Failed to load stats:",E)}},y=async()=>{try{const E=await s0.healthCheck();l(E)}catch(E){console.error("Health check failed:",E),l({status:"error",error:E.message})}},g=async E=>{u(!0);try{wm.setMode(E),n(E),await h(),await y()}catch(C){console.error("Failed to change API mode:",C)}finally{u(!1)}},f=async()=>{if(confirm("Are you sure you want to reset the fake database to its initial state?")){u(!0);try{const E=await $i.utils.resetDatabase();alert(E.message),await h()}catch(E){console.error("Failed to reset database:",E),alert("Failed to reset database")}finally{u(!1)}}},x={position:"fixed",bottom:"20px",right:"20px","z-index":"10000","font-family":"monospace"},S={background:"#1a1a1a",color:"#fff",border:"1px solid #333","border-radius":"8px",padding:"16px","min-width":"300px","max-width":"400px","box-shadow":"0 4px 20px rgba(0,0,0,0.3)"},P={background:"#007acc",color:"#fff",border:"none","border-radius":"50%",width:"50px",height:"50px",cursor:"pointer","font-size":"20px","box-shadow":"0 2px 10px rgba(0,0,0,0.2)",display:"flex","align-items":"center","justify-content":"center"},$={background:"#333",color:"#fff",border:"1px solid #555","border-radius":"4px",padding:"6px 12px",cursor:"pointer","font-size":"12px","margin-right":"8px","margin-bottom":"8px"},U={...$,background:"#007acc","border-color":"#007acc"},se={"margin-bottom":"16px","padding-bottom":"12px","border-bottom":"1px solid #333"},X={"font-size":"14px","font-weight":"bold","margin-bottom":"8px",color:"#007acc"},Z={display:"flex","justify-content":"space-between","font-size":"12px","margin-bottom":"4px"},re=E=>({display:"inline-block",width:"8px",height:"8px","border-radius":"50%","margin-right":"8px",background:E==="healthy"?"#00ff00":E==="error"?"#ff0000":"#ffff00"});return(()=>{var E=u0();return a(E,M(Ge,{get when(){return!t()},get children(){var C=_$();return C.$$click=()=>e(!0),m(C,P),C}}),null),a(E,M(Ge,{get when(){return t()},get children(){var C=A$(),T=C.firstChild,j=T.firstChild,b=j.nextSibling,w=T.nextSibling,_=w.firstChild,W=_.nextSibling,K=W.firstChild,k=K.nextSibling,R=k.nextSibling,Y=W.nextSibling,q=Y.firstChild,O=q.nextSibling,le=w.nextSibling,N=le.firstChild,D=le.nextSibling,V=D.firstChild,I=D.nextSibling,F=I.firstChild,Q=F.nextSibling,H=Q.firstChild,J=H.nextSibling,te=Q.nextSibling,ee=te.firstChild,ne=I.nextSibling,G=ne.firstChild,ce=G.nextSibling;return m(C,S),T.style.setProperty("display","flex"),T.style.setProperty("justify-content","space-between"),T.style.setProperty("align-items","center"),T.style.setProperty("margin-bottom","16px"),j.style.setProperty("margin","0"),j.style.setProperty("color","#007acc"),j.style.setProperty("font-size","16px"),b.$$click=()=>e(!1),K.$$click=()=>g("fake"),k.$$click=()=>g("real"),R.$$click=()=>g("hybrid"),Y.style.setProperty("font-size","11px"),Y.style.setProperty("color","#888"),Y.style.setProperty("margin-top","4px"),a(O,r),a(Y,()=>r()==="fake"&&" (Using fake server)",null),a(Y,()=>r()==="real"&&" (Using real API)",null),a(Y,()=>r()==="hybrid"&&" (Real API with fallback)",null),a(le,M(Ge,{get when(){return s()},get fallback(){return(()=>{var oe=C$();return oe.style.setProperty("font-size","12px"),oe})()},get children(){return[(()=>{var oe=P$(),z=oe.firstChild,de=z.nextSibling;return oe.style.setProperty("display","flex"),oe.style.setProperty("align-items","center"),oe.style.setProperty("font-size","12px"),a(de,()=>s()?.status||"Unknown"),a(oe,M(Ge,{get when(){return s()?.timestamp},get children(){var fe=S$(),ue=fe.firstChild,ge=ue.nextSibling;return ge.nextSibling,fe.style.setProperty("margin-left","8px"),fe.style.setProperty("color","#888"),a(fe,()=>new Date(s().timestamp).toLocaleTimeString(),ge),fe}}),null),Se(fe=>m(z,re(s()?.status||"unknown"),fe)),oe})(),M(Ge,{get when(){return s()?.error},get children(){var oe=u0();return oe.style.setProperty("font-size","11px"),oe.style.setProperty("color","#ff6666"),oe.style.setProperty("margin-top","4px"),a(oe,()=>s().error),oe}})]}}),null),a(D,M(Ht,{get each(){return Object.entries(i())},children:([oe,z])=>(()=>{var de=I$(),fe=de.firstChild,ue=fe.firstChild,ge=fe.nextSibling;return m(de,Z),fe.style.setProperty("text-transform","capitalize"),a(fe,oe,ue),ge.style.setProperty("color","#00ff00"),a(ge,z),de})()}),null),H.$$click=h,J.$$click=y,te.style.setProperty("margin-top","8px"),ee.$$click=f,a(I,M(Ge,{get when(){return r()!=="fake"},get children(){var oe=w$();return oe.style.setProperty("font-size","11px"),oe.style.setProperty("color","#888"),oe.style.setProperty("margin-top","4px"),oe}}),null),ce.style.setProperty("font-size","11px"),ce.style.setProperty("color","#888"),ce.style.setProperty("line-height","1.4"),a(C,M(Ge,{get when(){return c()},get children(){var oe=x$(),z=oe.firstChild;return oe.style.setProperty("position","absolute"),oe.style.setProperty("top","0"),oe.style.setProperty("left","0"),oe.style.setProperty("right","0"),oe.style.setProperty("bottom","0"),oe.style.setProperty("background","rgba(0,0,0,0.7)"),oe.style.setProperty("display","flex"),oe.style.setProperty("align-items","center"),oe.style.setProperty("justify-content","center"),oe.style.setProperty("border-radius","8px"),z.style.setProperty("color","#fff"),z.style.setProperty("font-size","14px"),oe}}),null),Se(oe=>{var z={...$,padding:"4px 8px"},de=se,fe=X,ue=r()==="fake"?U:$,ge=c(),xe=r()==="real"?U:$,pe=c(),_e=r()==="hybrid"?U:$,Le=c(),De=se,Te=X,$e=se,Ie=X,Re=se,Ke=X,je=$,We=c(),Qe=$,at=c(),nt={...$,background:"#cc4400","border-color":"#cc4400"},Ye=c()||r()!=="fake",ht=X;return oe.e=m(b,z,oe.e),oe.t=m(w,de,oe.t),oe.a=m(_,fe,oe.a),oe.o=m(K,ue,oe.o),ge!==oe.i&&(K.disabled=oe.i=ge),oe.n=m(k,xe,oe.n),pe!==oe.s&&(k.disabled=oe.s=pe),oe.h=m(R,_e,oe.h),Le!==oe.r&&(R.disabled=oe.r=Le),oe.d=m(le,De,oe.d),oe.l=m(N,Te,oe.l),oe.u=m(D,$e,oe.u),oe.c=m(V,Ie,oe.c),oe.w=m(I,Re,oe.w),oe.m=m(F,Ke,oe.m),oe.f=m(H,je,oe.f),We!==oe.y&&(H.disabled=oe.y=We),oe.g=m(J,Qe,oe.g),at!==oe.p&&(J.disabled=oe.p=at),oe.b=m(ee,nt,oe.b),Ye!==oe.T&&(ee.disabled=oe.T=Ye),oe.A=m(G,ht,oe.A),oe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),C}}),null),Se(C=>m(E,x,C)),E})()};yr(["click"]);const E$=[{id:"1",accountNumber:"1000",name:"Cash and Cash Equivalents",accountType:"Asset",category:"Current Assets",description:"Cash on hand and in bank accounts",balance:45230.5,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1001",accountNumber:"1001",name:"Petty Cash",accountType:"Asset",category:"Current Assets",description:"Small amounts of cash for minor expenses",balance:500,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1002",accountNumber:"1002",name:"Bank - Checking Account",accountType:"Asset",category:"Current Assets",description:"Main operating checking account",balance:32730.5,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"1003",accountNumber:"1003",name:"Bank - Savings Account",accountType:"Asset",category:"Current Assets",description:"Interest-bearing savings account",balance:12e3,isActive:!0,parentAccountId:"1",createdDate:"2024-01-01",lastModified:"2024-01-15"},{id:"2",accountNumber:"1100",name:"Accounts Receivable",accountType:"Asset",category:"Current Assets",description:"Money owed by customers",balance:23450.75,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2001",accountNumber:"1101",name:"Trade Receivables",accountType:"Asset",category:"Current Assets",description:"Receivables from regular customers",balance:18450.75,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"2002",accountNumber:"1102",name:"Employee Advances",accountType:"Asset",category:"Current Assets",description:"Money advanced to employees",balance:5e3,isActive:!0,parentAccountId:"2",createdDate:"2024-01-01",lastModified:"2024-01-14"},{id:"3",accountNumber:"1200",name:"Inventory",accountType:"Asset",category:"Current Assets",description:"Products held for sale",balance:78920.25,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-13"},{id:"4",accountNumber:"1500",name:"Equipment",accountType:"Asset",category:"Fixed Assets",description:"Office equipment and machinery",balance:125e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-12"},{id:"5",accountNumber:"2000",name:"Accounts Payable",accountType:"Liability",category:"Current Liabilities",description:"Money owed to suppliers",balance:15670.3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-11"},{id:"6",accountNumber:"2100",name:"Accrued Expenses",accountType:"Liability",category:"Current Liabilities",description:"Expenses incurred but not yet paid",balance:8945.6,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-10"},{id:"7",accountNumber:"2500",name:"Long-term Debt",accountType:"Liability",category:"Long-term Liabilities",description:"Long-term loans and mortgages",balance:85e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-09"},{id:"8",accountNumber:"3000",name:"Owner's Equity",accountType:"Equity",category:"Owner's Equity",description:"Owner's investment in the business",balance:15e4,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-08"},{id:"9",accountNumber:"3100",name:"Retained Earnings",accountType:"Equity",category:"Owner's Equity",description:"Accumulated profits retained in business",balance:32450.8,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-07"},{id:"10",accountNumber:"4000",name:"Sales Revenue",accountType:"Revenue",category:"Operating Revenue",description:"Revenue from product sales",balance:245678.9,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-06"},{id:"11",accountNumber:"4100",name:"Service Revenue",accountType:"Revenue",category:"Operating Revenue",description:"Revenue from services provided",balance:89432.15,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-05"},{id:"12",accountNumber:"5000",name:"Cost of Goods Sold",accountType:"Expense",category:"Operating Expenses",description:"Direct costs of producing goods",balance:125678.45,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-04"},{id:"13",accountNumber:"5100",name:"Salaries Expense",accountType:"Expense",category:"Operating Expenses",description:"Employee salary expenses",balance:98765.32,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-03"},{id:"14",accountNumber:"5200",name:"Rent Expense",accountType:"Expense",category:"Operating Expenses",description:"Office rent expenses",balance:24e3,isActive:!0,createdDate:"2024-01-01",lastModified:"2024-01-02"}],T$=[{id:"1",accountId:"1",date:"2024-01-15",description:"Customer payment received",debitAmount:5e3,creditAmount:0,reference:"INV-2024-001",type:"debit"},{id:"2",accountId:"2",date:"2024-01-15",description:"Customer payment received",debitAmount:0,creditAmount:5e3,reference:"INV-2024-001",type:"credit"},{id:"3",accountId:"5",date:"2024-01-14",description:"Office supplies purchased",debitAmount:0,creditAmount:1250,reference:"PO-2024-001",type:"credit"}],[jo,Kc]=Ce(E$),[tf,k$]=Ce(T$),Er={get accounts(){return jo()},get transactions(){return tf()},parseAccount(t){return{id:t.id||t?.code,accountNumber:t.accountNumber||t?.code,name:t.name,type:t.type,accountType:t.accountType,category:t.category,description:t.description,isActive:!0,accountId:t?.accountId}},updAccount(t){Kc(t.map(Er.parseAccount))},fetchAllAccount(t){const e={...t,createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};return Kc([...jo(),e]),e},async addAccount(t){const e={...t,accountId:ku(),id:ku(),createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};console.log("newAccount",e);let r=await zh.create(e);return console.log(r),Kc([...jo(),e]),e},async updateAccountServer(t,e){let r=await zh.update(t,e);Er.updateAccount(t,e),console.log(r,t,e)},updateAccount(t,e){Kc(jo().map(r=>r.id===t?{...r,...e,lastModified:new Date().toISOString().split("T")[0]}:r))},deleteAccount(t){Kc(jo().filter(e=>e.id!==t))},getAccountById(t){return jo().find(e=>e.id===t)},getAccountsByType(t){return jo().filter(e=>e.type===t)},getAccountTransactions(t){return tf().filter(e=>e.accountId===t)},addTransaction(t){const e={...t,id:Date.now().toString()};k$([...tf(),e]);const r=this.getAccountById(t.accountId);if(r){const n=t.type==="debit"?t.debitAmount:-t.creditAmount;this.updateAccount(t.accountId,{balance:r.balance+n})}return e},getTotalByType(t){return jo().filter(e=>e.type===t&&e.isActive).reduce((e,r)=>e+r.balance,0)},getAccountCategories(t){const e=this.getAccountsByType(t);return[...new Set(e.map(r=>r.category))]},getSubAccounts(t){return jo().filter(e=>e.parentAccountId===t)},getParentAccounts(){return jo().filter(t=>!t.parentAccountId)},getAccountHierarchy(){const t=this.getParentAccounts();return console.log(this.getSubAccounts("20110")),console.log(t),t.map(e=>({...e,subAccounts:this.getSubAccounts(e?.id)}))},getAccountWithSubAccounts(t){const e=this.getAccountById(t);return e?{...e,subAccounts:this.getSubAccounts(t),parentAccount:e.parentAccountId?this.getAccountById(e.parentAccountId):null}:null},getAccountPath(t){const e=this.getAccountById(t);if(!e)return[];const r=[e];let n=e;for(;n.parentAccountId;){const i=this.getAccountById(n.parentAccountId);if(i)r.unshift(i),n=i;else break}return r},getTotalBalanceWithSubAccounts(t){const e=this.getAccountById(t);if(!e)return 0;const n=this.getSubAccounts(t).reduce((i,o)=>i+this.getTotalBalanceWithSubAccounts(o.id),0);return e.balance+n},canDeleteAccount(t){const e=this.getSubAccounts(t);if(e.length>0)return{canDelete:!1,reason:`Account has ${e.length} sub-account(s). Delete or move sub-accounts first.`};const r=this.getAccountTransactions(t);return r.length>0?{canDelete:!1,reason:`Account has ${r.length} transaction(s). Cannot delete account with transaction history.`}:{canDelete:!0}}};var ia=he("<div>"),Jc=he("<div> ");const N$=()=>{const{t}=sr(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},n={"font-size":"0.875rem",color:"var(--text-muted)"},i=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(S),o=Er.getTotalByType("Asset"),s=Er.getTotalByType("Liability"),l=Er.getTotalByType("Equity"),c=Er.getTotalByType("Revenue"),u=Er.getTotalByType("Expense"),h=Er.getAccountsByType("Asset").length,y=Er.getAccountsByType("Liability").length,g=Er.getAccountsByType("Equity").length,f=Er.getAccountsByType("Revenue").length,x=Er.getAccountsByType("Expense").length;return(()=>{var S=ia();return m(S,e),a(S,M(Ft,{get title(){return t("dashboard.totalAssets")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var P=ia();return a(P,()=>i(o)),Se($=>m(P,r,$)),P})(),(()=>{var P=Jc(),$=P.firstChild;return a(P,h,$),a(P,()=>t("navigation.accounts"),null),Se(U=>m(P,n,U)),P})()]}}),null),a(S,M(Ft,{get title(){return t("dashboard.totalLiabilities")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var P=ia();return a(P,()=>i(s)),Se($=>m(P,r,$)),P})(),(()=>{var P=Jc(),$=P.firstChild;return a(P,y,$),a(P,()=>t("navigation.accounts"),null),Se(U=>m(P,n,U)),P})()]}}),null),a(S,M(Ft,{get title(){return t("dashboard.totalEquity")},get subtitle(){return t("accounts.categories.ownersEquity")},get children(){return[(()=>{var P=ia();return a(P,()=>i(l)),Se($=>m(P,r,$)),P})(),(()=>{var P=Jc(),$=P.firstChild;return a(P,g,$),a(P,()=>t("navigation.accounts"),null),Se(U=>m(P,n,U)),P})()]}}),null),a(S,M(Ft,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("accounts.categories.operatingRevenue")},get children(){return[(()=>{var P=ia();return a(P,()=>i(c)),Se($=>m(P,r,$)),P})(),(()=>{var P=Jc(),$=P.firstChild;return a(P,f,$),a(P,()=>t("navigation.accounts"),null),Se(U=>m(P,n,U)),P})()]}}),null),a(S,M(Ft,{get title(){return t("dashboard.totalExpenses")},get subtitle(){return t("accounts.categories.operatingExpenses")},get children(){return[(()=>{var P=ia();return a(P,()=>i(u)),Se($=>m(P,r,$)),P})(),(()=>{var P=Jc(),$=P.firstChild;return a(P,x,$),a(P,()=>t("navigation.accounts"),null),Se(U=>m(P,n,U)),P})()]}}),null),a(S,M(Ft,{get title(){return t("dashboard.netIncome")},get subtitle(){return`${t("dashboard.totalRevenue")} - ${t("dashboard.totalExpenses")}`},get children(){return[(()=>{var P=ia();return a(P,()=>i(c-u)),Se($=>m(P,{...r,color:c-u>=0?"#4caf50":"#f44336"},$)),P})(),(()=>{var P=ia();return a(P,()=>c-u>=0?t("dashboard.netIncome"):t("dashboard.netLoss")),Se($=>m(P,n,$)),P})()]}}),null),S})()};var L$=he("<div><div></div><div>"),R$=he("<h3>"),Qc=he("<div>");const D$=t=>{const{t:e}=sr();Gm();const r={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},n={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},i={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"},o={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},s={"font-size":"1.5rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},l={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem"},c={"font-size":"0.875rem",color:"var(--text-secondary)","line-height":"1.4"},u=g=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[g]||{bg:"#f5f5f5",color:"#666"},h=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g),y=u(t.account.accountType);return M(Ft,{get children(){return[(()=>{var g=L$(),f=g.firstChild,x=f.nextSibling;return m(g,n),m(f,i),a(f,()=>t.account.accountNumber),a(x,()=>e(`accounts.types.${t.account.accountType.toLowerCase()}`)),Se(S=>m(x,{...o,background:y.bg,color:y.color},S)),g})(),(()=>{var g=R$();return g.style.setProperty("margin","0 0 0.5rem 0"),g.style.setProperty("font-size","1.1rem"),a(g,()=>t.account.name),g})(),(()=>{var g=Qc();return m(g,l),a(g,()=>t.account.category),g})(),(()=>{var g=Qc();return m(g,s),a(g,()=>h(t.account.balance)),g})(),(()=>{var g=Qc();return m(g,c),a(g,()=>t.account.description),g})(),Ee(()=>Ee(()=>!t.account.isActive)()&&(()=>{var g=Qc();return g.style.setProperty("margin-top","0.5rem"),g.style.setProperty("padding","0.25rem 0.75rem"),g.style.setProperty("border-radius","9999px"),g.style.setProperty("font-size","0.75rem"),g.style.setProperty("font-weight","500"),g.style.setProperty("background","#ffebee"),g.style.setProperty("color","#d32f2f"),g.style.setProperty("text-align","center"),a(g,()=>e("common.inactive")),g})()),(()=>{var g=Qc();return m(g,r),a(g,M(dt,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.account),get children(){return[Ee(()=>e("common.view"))," ",Ee(()=>e("accounts.accountDetails"))]}})),g})()]}})};var M$=he("<div><div></div><div>"),F$=he("<div><div><div><div></div><h3>"),O$=he("<div>"),B$=he("<button>"),j$=he("<div><h4> (<!>)"),V$=he("<div><div><div></div><div> • </div></div><div>");const q$=t=>{const{t:e}=sr(),r=Gm(),[n,i]=Ce(!0),o={"margin-bottom":"1rem"},s={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},l={display:"flex","align-items":"center",gap:"1rem"},c={background:"none",border:"none",cursor:"pointer","font-size":"1.2rem",color:"var(--text-muted)",padding:"0.25rem","border-radius":"var(--border-radius-sm)",transition:"all 0.2s ease"},u={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},h={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)",margin:"0"},y={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},g={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},f={"margin-left":"1rem","border-left":"2px solid var(--border-color)","padding-left":"1rem","margin-top":"1rem"},x={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},S={flex:"1"},P={"font-weight":"500","margin-bottom":"0.25rem"},$={"font-size":"0.875rem",color:"var(--text-muted)"},U={"font-weight":"600",color:"var(--primary-color)"},se={display:"flex",gap:"0.5rem"},X=j=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[j]||{bg:"#f5f5f5",color:"#666"},Z=j=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(j),re=j=>{t.onViewDetails?t.onViewDetails(j):r(`/accounts/${j.id}`)},E=()=>{t.onAddSubAccount&&t.onAddSubAccount(t.account)},C=t.account.balance+t.account.subAccounts.reduce((j,b)=>j+b.balance,0),T=X(t.account.accountType);return M(Ft,{className:"account-hierarchy-card",style:o,get children(){return[(()=>{var j=F$(),b=j.firstChild,w=b.firstChild,_=w.firstChild,W=_.nextSibling;return m(j,s),m(b,l),a(b,(()=>{var K=Ee(()=>t.account.subAccounts.length>0);return()=>K()&&(()=>{var k=B$();return k.addEventListener("mouseleave",R=>R.target.style.background="none"),k.addEventListener("mouseenter",R=>R.target.style.background="var(--background-color)"),k.$$click=()=>i(!n()),m(k,c),a(k,()=>n()?"▼":"▶"),k})()})(),w),w.$$click=()=>re(t.account),w.style.setProperty("cursor","pointer"),m(_,u),a(_,()=>t.account.accountNumber),m(W,h),a(W,()=>t.account.name),a(j,M(Ge,{get when(){return t?.account?.accountType},get children(){var K=M$(),k=K.firstChild,R=k.nextSibling;return K.style.setProperty("text-align","right"),m(k,y),a(k,()=>Z(C||0)),a(R,()=>e(`accounts.types.${t?.account?.accountType?.toLowerCase()}`)),Se(Y=>m(R,{...g,background:T.bg,color:T.color},Y)),K}}),null),j})(),(()=>{var j=O$();return m(j,se),a(j,M(dt,{variant:"secondary",size:"sm",onClick:()=>re(t.account),get children(){return[Ee(()=>e("common.view"))," ",Ee(()=>e("accounts.accountDetails"))]}}),null),a(j,M(dt,{variant:"outline",size:"sm",onClick:E,get children(){return[Ee(()=>e("common.add"))," ",Ee(()=>e("accounts.subAccounts"))]}}),null),j})(),Ee(()=>Ee(()=>!!(n()&&t.account.subAccounts.length>0))()&&(()=>{var j=j$(),b=j.firstChild,w=b.firstChild,_=w.nextSibling;return _.nextSibling,m(j,f),b.style.setProperty("margin","0 0 1rem 0"),b.style.setProperty("font-size","1rem"),b.style.setProperty("color","var(--text-muted)"),a(b,()=>e("accounts.subAccounts"),w),a(b,()=>t.account.subAccounts.length,_),a(j,()=>t.account.subAccounts.map(W=>(()=>{var K=V$(),k=K.firstChild,R=k.firstChild,Y=R.nextSibling,q=Y.firstChild,O=k.nextSibling;return K.addEventListener("mouseleave",le=>{le.currentTarget.style.background="var(--background-color)",le.currentTarget.style.transform="translateY(0)"}),K.addEventListener("mouseenter",le=>{le.currentTarget.style.background="var(--surface-color)",le.currentTarget.style.transform="translateY(-1px)"}),K.$$click=()=>re(W),m(K,x),m(k,S),m(R,P),a(R,()=>W.name),m(Y,$),a(Y,()=>W.accountNumber,q),a(Y,()=>W.description,null),m(O,U),a(O,()=>Z(W.balance)),K})()),null),j})())]}})};yr(["click"]);var z$=he("<form><div>");const U$=t=>{const{t:e}=sr(),[r,n]=Ce({accountNumber:"",name:"",accountType:"",category:"",type:"",classification:"",description:"",balance:"0",isActive:"true"}),i=[{value:"Asset",label:e("accounts.types.asset"),type:"debit",classification:"real"},{value:"Liability",label:e("accounts.types.liability"),type:"credit",classification:"real"},{value:"Equity",label:e("accounts.types.equity"),type:"credit",classification:"real"},{value:"Revenue",label:e("accounts.types.revenue"),type:"credit",classification:"nominal"},{value:"Expense",label:e("accounts.types.expense"),type:"debit",classification:"nominal"}],o=()=>{const h=r().accountType;return h?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")},{value:"Sales Revenue",label:e("accounts.categories.salesRevenue")},{value:"Service Revenue",label:e("accounts.categories.servicesRevenue")},{value:"Subscription Revenue",label:e("accounts.categories.subscriptionRevenue")},{value:"Rental Revenue",label:e("accounts.categories.rentalRevenue")},{value:"Commission Revenue",label:e("accounts.categories.commissionRevenue")},{value:"Franchise Revenue",label:e("accounts.categories.franchiseRevenue")},{value:"Licensing Revenue",label:e("accounts.categories.licensingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[h]||[]:[]},s=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],l={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},c=h=>{h.preventDefault();const y=r();if(!y.accountNumber||!y.name||!y.accountType||!y.category){alert(e("forms.requiredField"));return}const g=Er.accounts.find(S=>S.accountNumber===y.accountNumber),f=i.find(S=>S.value===y.accountType);if(g){alert(e("forms.duplicateAccountNumber"));return}const x={accountNumber:y.accountNumber,name:y.name,accountType:"",classification:f?.classification,type:f?.type,category:y.category,description:y.description,balance:parseFloat(y.balance)||0,isActive:y.isActive==="true"};Er.addAccount(x),n({accountNumber:"",name:"",accountType:"",type:"",category:"",description:"",classification:"",balance:"0",isActive:"true"}),t.onClose()},u=(h,y)=>{n(g=>{const f={...g,[h]:y};return h==="type"&&(f.category=""),f})};return M(Fn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.addAccount")},get children(){var h=z$(),y=h.firstChild;return h.addEventListener("submit",c),a(h,M(Ar,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:g=>u("accountNumber",g),get placeholder(){return e("accounts.accountNumber")},required:!0}),y),a(h,M(Ar,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:g=>u("name",g),get placeholder(){return e("accounts.accountName")},required:!0}),y),a(h,M(_n,{get label(){return e("accounts.accountType")},get value(){return r().accountType},onChange:g=>u("accountType",g),options:i,required:!0}),y),a(h,M(_n,{get label(){return e("accounts.category")},get value(){return r().category},onChange:g=>u("category",g),get options(){return o()},required:!0}),y),a(h,M(Ar,{get label(){return e("common.description")},get value(){return r().description},onChange:g=>u("description",g),get placeholder(){return e("common.description")}}),y),a(h,M(Ar,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:g=>u("balance",g),get placeholder(){return e("accounts.balance")}}),y),a(h,M(_n,{get label(){return e("common.status")},get value(){return r().isActive},onChange:g=>u("isActive",g),options:s,required:!0}),y),m(y,l),a(y,M(dt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(y,M(dt,{variant:"primary",type:"submit",get children(){return e("accounts.addAccount")}}),null),h}})};var H$=he("<form><div>"),G$=he("<div><div></div><div> - </div><div> • ");const W$=t=>{const{t:e}=sr(),[r,n]=Ce({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"});e("accounts.types.asset"),e("accounts.types.liability"),e("accounts.types.equity"),e("accounts.types.revenue"),e("accounts.types.expense");const i=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},s={background:"var(--background-color)",padding:"1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1.5rem",border:"1px solid var(--border-color)"},l={"font-size":"0.875rem","font-weight":"500",color:"var(--text-muted)","margin-bottom":"0.5rem"},c={"font-weight":"600",color:"var(--text-primary)"},u={"font-size":"0.875rem",color:"var(--text-secondary)"},h=x=>{x.preventDefault();const S=r();if(console.log(S),!S.accountNumber||!S.name||!t.parentAccount){alert(e("forms.requiredField"));return}const P=Er.accounts.find(U=>U.accountNumber===S.accountNumber);if(console.log(P),P){alert(e("forms.duplicateAccountNumber"));return}const $={accountNumber:S.accountNumber,name:S.name,description:S.description,accountType:t.parentAccount.accountType,category:t.parentAccount.category,classification:t.parentAccount?.classification,type:t.parentAccount?.type,isActive:S.isActive==="true",parentAccountId:t.parentAccount.id,parentAccountNumber:t.parentAccount.accountId};Er.addAccount($),n({accountNumber:"",name:"",category:"",description:"",balance:"0",isActive:"true"}),t.onClose()},y=(x,S)=>{n(P=>({...P,[x]:S}))},g=()=>{if(!t.parentAccount)return"";const x=t.parentAccount.accountNumber,P=Er.getSubAccounts(t.parentAccount.id).length+1;return(parseInt(x)+P).toString()},f=()=>r().accountNumber===""&&t.parentAccount?g():r().accountNumber;return M(Fn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return`${e("common.add")} ${e("accounts.subAccounts")}`},get children(){return[Ee(()=>Ee(()=>!!t.parentAccount)()&&(()=>{var x=G$(),S=x.firstChild,P=S.nextSibling,$=P.firstChild,U=P.nextSibling,se=U.firstChild;return m(x,s),m(S,l),a(S,()=>e("accounts.parentAccount")),m(P,c),a(P,()=>t.parentAccount.accountNumber,$),a(P,()=>t.parentAccount.name,null),m(U,u),a(U,()=>e(`accounts.types.${t.parentAccount?.accountType?.toLowerCase()}`),se),a(U,()=>t.parentAccount.category,null),x})()),(()=>{var x=H$(),S=x.firstChild;return x.addEventListener("submit",h),a(x,M(Ar,{get label(){return e("accounts.accountNumber")},get value(){return f()},onChange:P=>y("accountNumber",P),get placeholder(){return`${e("common.suggested")}: ${g()}`},required:!0}),S),a(x,M(Ar,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:P=>y("name",P),get placeholder(){return e("accounts.accountName")},required:!0}),S),a(x,M(Ar,{get label(){return e("common.description")},get value(){return r().description},onChange:P=>y("description",P),get placeholder(){return e("common.description")}}),S),a(x,M(Ar,{get label(){return e("accounts.balance")},type:"number",get value(){return r().balance},onChange:P=>y("balance",P),get placeholder(){return e("accounts.balance")}}),S),a(x,M(_n,{get label(){return e("common.status")},get value(){return r().isActive},onChange:P=>y("isActive",P),options:i,required:!0}),S),m(S,o),a(S,M(dt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(S,M(dt,{variant:"primary",type:"submit",get children(){return[Ee(()=>e("common.add"))," ",Ee(()=>e("accounts.subAccounts"))]}}),null),x})()]}})};var Y$=he("<form><div>"),K$=he("<div>");const J$=t=>{const{t:e}=sr(),[r,n]=Ce({accountNumber:"",name:"",type:"",accountType:"",category:"",description:"",isActive:"true"}),[i,o]=Ce(null);yi(()=>{t.account&&(console.log(t.account),n({accountNumber:t.account.accountNumber,name:t.account.name,type:t.account.type,accountType:t.account.accountType,category:t.account.category,description:t.account.description,isActive:t.account.isActive.toString()}),o(null))});const s=[{value:"Asset",label:e("accounts.types.asset")},{value:"Liability",label:e("accounts.types.liability")},{value:"Equity",label:e("accounts.types.equity")},{value:"Revenue",label:e("accounts.types.revenue")},{value:"Expense",label:e("accounts.types.expense")}],l=()=>{const f=r().accountType;return f?{Asset:[{value:"Current Assets",label:e("accounts.categories.currentAssets")},{value:"Fixed Assets",label:e("accounts.categories.fixedAssets")}],Liability:[{value:"Current Liabilities",label:e("accounts.categories.currentLiabilities")},{value:"Long-term Liabilities",label:e("accounts.categories.longTermLiabilities")}],Equity:[{value:"Owner's Equity",label:e("accounts.categories.ownersEquity")}],Revenue:[{value:"Operating Revenue",label:e("accounts.categories.operatingRevenue")}],Expense:[{value:"Operating Expenses",label:e("accounts.categories.operatingExpenses")}]}[f]||[]:[]},c=[{value:"true",label:e("common.active")},{value:"false",label:e("common.inactive")}],u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},h=f=>{if(f.preventDefault(),o(null),!t.account)return;const x=r();if(!x.accountNumber||!x.name||!x.type||!x.category){o(e("forms.requiredField"));return}if(Er.accounts.find(U=>U.accountNumber===x.accountNumber&&U.id!==t.account.id)){o(e("forms.duplicateAccountNumber"));return}const P={accountNumber:x.accountNumber,name:x.name,type:x.type,accountType:x.accountType,category:x.category,description:x.description,isActive:x.isActive==="true"};console.log({data:x,updatedAccount:P});let $=PP(Object.keys(t.account),P,t.account,{accountId:1,id:1});try{Er.updateAccountServer(t.account?.accountId,$.data),t.onClose()}catch(U){o(U instanceof Error?U.message:e("forms.saveError"))}},y=()=>{if(!t.account)return;const f=Er.canDeleteAccount(t.account.id);if(!f.canDelete){o(f.reason||e("forms.deleteError"));return}const x=e("forms.confirmDelete");if(confirm(x))try{Er.deleteAccount(t.account.id),t.onClose()}catch(S){o(S instanceof Error?S.message:e("forms.deleteError"))}},g=(f,x)=>{n(S=>{const P={...S,[f]:x};return f==="type"&&(P.category=""),P}),i()&&o(null)};return t.account?M(Fn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.editAccount")},get children(){var f=Y$(),x=f.firstChild;return f.addEventListener("submit",h),a(f,M(Ar,{get label(){return e("accounts.accountNumber")},get value(){return r().accountNumber},onChange:S=>g("accountNumber",S),get placeholder(){return e("accounts.accountNumber")},required:!0}),x),a(f,M(Ar,{get label(){return e("accounts.accountName")},get value(){return r().name},onChange:S=>g("name",S),get placeholder(){return e("accounts.accountName")},required:!0}),x),a(f,M(_n,{get label(){return e("accounts.accountType")},get value(){return r().accountType},onChange:S=>g("accountType",S),options:s,required:!0}),x),a(f,M(_n,{get label(){return e("accounts.category")},get value(){return r().category},onChange:S=>g("category",S),get options(){return l()},required:!0}),x),a(f,M(Ar,{get label(){return e("common.description")},get value(){return r().description},onChange:S=>g("description",S),get placeholder(){return e("common.description")}}),x),a(f,M(_n,{get label(){return e("common.status")},get value(){return r().isActive},onChange:S=>g("isActive",S),options:c,required:!0}),x),a(f,(()=>{var S=Ee(()=>!!i());return()=>S()&&(()=>{var P=K$();return P.style.setProperty("padding","1rem"),P.style.setProperty("border-radius","var(--border-radius-sm)"),P.style.setProperty("margin-top","1rem"),P.style.setProperty("background","#f8d7da"),P.style.setProperty("color","#721c24"),P.style.setProperty("border","1px solid #f5c6cb"),a(P,i),P})()})(),x),m(x,u),a(x,M(dt,{variant:"outline",type:"button",onClick:y,style:{color:"#dc3545","border-color":"#dc3545","margin-right":"auto"},get children(){return e("accounts.deleteAccount")}}),null),a(x,M(dt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(x,M(dt,{variant:"primary",type:"submit",get children(){return e("common.save")}}),null),f}}):null};var Q$=he("<div><div>⚠️</div><div></div><div></div><div>"),Md=he("<div>"),X$=he("<div><div></div><div>"),Z$=he("<div><button></button><button> (<!>)"),eE=he("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),tE=he("<div><div><div></div><div> • </div></div><div>");const rE=t=>{const{t:e}=sr(),[r,n]=Ce("details"),[i,o]=Ce(!1),s=Dt(()=>t.account?Er.getAccountById(t.account.id)||t.account:null),l={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},c={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},u={"font-weight":"600",color:"var(--text-primary)"},h={"text-align":"center","margin-bottom":"2rem"},y={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},g={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},f={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem"},x={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},S=T=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:T?"var(--primary-color)":"var(--text-muted)","border-bottom":T?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),P={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},$={flex:"1"},U={"font-size":"0.875rem",color:"var(--text-muted)"},se={"font-weight":"500","margin-bottom":"0.25rem"},X=T=>({"font-weight":"600",color:T==="debit"?"#4caf50":"#f44336"}),Z={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},re=T=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[T]||{bg:"#f5f5f5",color:"#666"},E=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),C=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return M(Fn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("accounts.accountDetails")},get children(){return[Ee(()=>Ee(()=>!s())()?(()=>{var T=Q$(),j=T.firstChild,b=j.nextSibling,w=b.nextSibling,_=w.nextSibling;return T.style.setProperty("text-align","center"),T.style.setProperty("padding","3rem"),T.style.setProperty("color","var(--text-muted)"),j.style.setProperty("font-size","1.5rem"),j.style.setProperty("margin-bottom","1rem"),b.style.setProperty("font-size","1.1rem"),b.style.setProperty("margin-bottom","0.5rem"),a(b,()=>e("common.error")),w.style.setProperty("font-size","0.875rem"),a(w,()=>e("common.noDataFound")),_.style.setProperty("margin-top","2rem"),a(_,M(dt,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),T})():(()=>{const T=Dt(()=>re(s().accountType)),j=Dt(()=>Er.getAccountTransactions(s().id));return[(()=>{var b=X$(),w=b.firstChild,_=w.nextSibling;return m(b,h),m(w,y),a(w,()=>s().name),m(_,g),a(_,()=>E(s().balance||0)),a(b,M(Ge,{get when(){return s().accountType},get children(){var W=Md();return a(W,()=>e(`accounts.types.${s().accountType?.toLowerCase()}`)),Se(K=>m(W,{...f,background:T().bg,color:T().color},K)),W}}),null),b})(),(()=>{var b=Z$(),w=b.firstChild,_=w.nextSibling,W=_.firstChild,K=W.nextSibling;return K.nextSibling,m(b,x),w.$$click=()=>n("details"),a(w,()=>e("accounts.accountDetails")),_.$$click=()=>n("transactions"),a(_,()=>e("accounts.transactions"),W),a(_,()=>j().length,K),Se(k=>{var R=S(r()==="details"),Y=S(r()==="transactions");return k.e=m(w,R,k.e),k.t=m(_,Y,k.t),k},{e:void 0,t:void 0}),b})(),Ee(()=>Ee(()=>r()==="details")()&&(()=>{var b=eE(),w=b.firstChild,_=w.firstChild,W=_.nextSibling,K=w.nextSibling,k=K.firstChild,R=k.nextSibling,Y=K.nextSibling,q=Y.firstChild,O=q.nextSibling,le=Y.nextSibling,N=le.firstChild,D=N.nextSibling,V=le.nextSibling,I=V.firstChild,F=I.nextSibling,Q=V.nextSibling,H=Q.firstChild,J=H.nextSibling;return a(_,()=>e("accounts.accountNumber")),a(W,()=>s().accountNumber),a(k,()=>e("accounts.category")),a(R,()=>s().category),a(q,()=>e("common.description")),a(O,()=>s().description),a(N,()=>e("common.status")),a(D,(()=>{var te=Ee(()=>!!s().isActive);return()=>te()?e("common.active"):e("common.inactive")})()),a(I,()=>e("accounts.createdDate")),a(F,()=>C(s().createdDate)),a(H,()=>e("accounts.lastModified")),a(J,()=>C(s().lastModified)),Se(te=>{var ee=l,ne=c,G=u,ce=l,oe=c,z=u,de=l,fe=c,ue=u,ge=l,xe=c,pe=u,_e=l,Le=c,De=u,Te=l,$e=c,Ie=u;return te.e=m(w,ee,te.e),te.t=m(_,ne,te.t),te.a=m(W,G,te.a),te.o=m(K,ce,te.o),te.i=m(k,oe,te.i),te.n=m(R,z,te.n),te.s=m(Y,de,te.s),te.h=m(q,fe,te.h),te.r=m(O,ue,te.r),te.d=m(le,ge,te.d),te.l=m(N,xe,te.l),te.u=m(D,pe,te.u),te.c=m(V,_e,te.c),te.w=m(I,Le,te.w),te.m=m(F,De,te.m),te.f=m(Q,Te,te.f),te.y=m(H,$e,te.y),te.g=m(J,Ie,te.g),te},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),b})()),Ee(()=>Ee(()=>r()==="transactions")()&&(()=>{var b=Md();return a(b,(()=>{var w=Ee(()=>j().length===0);return()=>w()?(()=>{var _=Md();return _.style.setProperty("text-align","center"),_.style.setProperty("color","var(--text-muted)"),_.style.setProperty("padding","2rem"),a(_,()=>e("common.noDataFound")),_})():j().map(_=>(()=>{var W=tE(),K=W.firstChild,k=K.firstChild,R=k.nextSibling,Y=R.firstChild,q=K.nextSibling;return m(W,P),m(K,$),m(k,se),a(k,()=>_.description),m(R,U),a(R,()=>C(_.date),Y),a(R,()=>_.reference,null),a(q,()=>_.type==="debit"?"+":"-",null),a(q,()=>E(_.type==="debit"?_.debitAmount:_.creditAmount),null),Se(O=>m(q,X(_.type),O)),W})())})()),b})()),(()=>{var b=Md();return m(b,Z),a(b,M(dt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(b,M(dt,{variant:"primary",onClick:()=>o(!0),get children(){return e("accounts.editAccount")}}),null),b})()]})()),Ee(()=>Ee(()=>!!s())()&&M(J$,{get isOpen(){return i()},onClose:()=>{o(!1)},get account(){return s()}}))]}})};yr(["click"]);var nE=he("<div><h2></h2><div><span>:</span><button></button><button>"),iE=he("<div><span>:"),d0=he("<div>"),oE=he("<button>");const sE=()=>{const{t}=sr(),[e,r]=Ce(!1),[n,i]=Ce(!1),[o,s]=Ce(!1),[l,c]=Ce(null),[u,h]=Ce(null),[y,g]=Ce("All"),[f,x]=Ce("hierarchy"),S=T=>{c(T),s(!0)},P=T=>{h(T),i(!0)},$=()=>y()==="All"?f()==="hierarchy"?Er.getAccountHierarchy():Er.accounts:f()==="hierarchy"?Er.getAccountHierarchy().filter(T=>T.accountType===y()):Er.getAccountsByType(y()),U={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},se={display:"flex",gap:"1rem","margin-bottom":"2rem","align-items":"center"},X=T=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:T?"var(--primary-color)":"var(--surface-color)",color:T?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500",transition:"all 0.2s ease"}),Z={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},re={display:"flex",gap:"0.5rem","align-items":"center","margin-left":"auto","margin-right":"1rem"},E=T=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:T?"var(--primary-color)":"var(--surface-color)",color:T?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),C=async()=>{let T=await zh.getAlls("acc");Er.updAccount(Object.values(T))};return Sn(()=>{C()}),M(Qi,{get title(){return t("accounts.title")},get children(){return[M(N$,{}),(()=>{var T=nE(),j=T.firstChild,b=j.nextSibling,w=b.firstChild,_=w.firstChild,W=w.nextSibling,K=W.nextSibling;return m(T,Z),j.style.setProperty("margin","0"),j.style.setProperty("font-size","1.5rem"),a(j,()=>t("accounts.title")),m(b,re),w.style.setProperty("font-weight","500"),w.style.setProperty("color","var(--text-muted)"),w.style.setProperty("font-size","0.875rem"),a(w,()=>t("common.view"),_),W.$$click=()=>x("hierarchy"),a(W,()=>t("accounts.accountHierarchy")),K.$$click=()=>{x("flat"),zh.getAlls("iDP")},a(K,()=>t("common.all")),a(T,M(dt,{variant:"primary",onClick:()=>r(!0),get children(){return t("accounts.addAccount")}}),null),Se(k=>{var R=E(f()==="hierarchy"),Y=E(f()==="flat");return k.e=m(W,R,k.e),k.t=m(K,Y,k.t),k},{e:void 0,t:void 0}),T})(),(()=>{var T=iE(),j=T.firstChild,b=j.firstChild;return m(T,se),j.style.setProperty("font-weight","500"),j.style.setProperty("color","var(--text-muted)"),a(j,()=>t("common.filter"),b),a(T,()=>[t("common.all"),t("accounts.types.asset"),t("accounts.types.liability"),t("accounts.types.equity"),t("accounts.types.revenue"),t("accounts.types.expense")].map((w,_)=>{const K=["All","Asset","Liability","Equity","Revenue","Expense"][_];return(()=>{var k=oE();return k.$$click=()=>g(K),a(k,w),Se(R=>m(k,X(y()===K),R)),k})()}),null),T})(),(()=>{var T=d0();return a(T,(()=>{var j=Ee(()=>f()==="hierarchy");return()=>j()?$().map(b=>M(q$,{account:b,onAddSubAccount:P,onViewDetails:S})):$().map(b=>M(D$,{account:b,onViewDetails:S}))})()),Se(j=>m(T,f()==="hierarchy"?{display:"flex","flex-direction":"column",gap:"1rem"}:U,j)),T})(),Ee(()=>Ee(()=>$().length===0)()&&(()=>{var T=d0();return T.style.setProperty("text-align","center"),T.style.setProperty("color","var(--text-muted)"),T.style.setProperty("padding","3rem"),T.style.setProperty("font-size","1.1rem"),a(T,()=>t("common.noDataFound")),T})()),M(U$,{get isOpen(){return e()},onClose:()=>r(!1)}),M(W$,{get isOpen(){return n()},onClose:()=>i(!1),get parentAccount(){return u()}}),M(rE,{get isOpen(){return o()},onClose:()=>s(!1),get account(){return l()}})]}})};yr(["click"]);var aE=he("<div><h2>"),Ql=he("<div>"),lE=he("<div><div><div></div><h1></h1><div></div></div><div>"),cE=he("<div><button></button><button> (<!>)"),Fd=he("<div><span></span><span>"),uE=he("<p>"),dE=he("<div><div></div><div>"),hE=he("<div><div><div></div><div> • </div></div><div>");const pE=()=>{const{t}=sr(),e=JS(),r=Gm(),[n,i]=Ce(null),[o,s]=Ce("overview");Sn(()=>{const _=Er.getAccountById(e.id);_?i(_):r("/accounts")});const l={display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"1rem"},c={display:"flex","align-items":"center",gap:"1rem","margin-bottom":"2rem"},u={"font-size":"1rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},h={"font-size":"2.5rem","font-weight":"700",color:"var(--primary-color)"},y={padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},g={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},f=_=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:_?"var(--primary-color)":"var(--text-muted)","border-bottom":_?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),x={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},S={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},P={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},$={"font-weight":"500",color:"var(--text-muted)"},U={"font-weight":"600",color:"var(--text-primary)"},se={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem 0","border-bottom":"1px solid var(--border-color)"},X={flex:"1"},Z={"font-weight":"500","margin-bottom":"0.25rem"},re={"font-size":"0.875rem",color:"var(--text-muted)"},E=_=>({"font-weight":"600",color:_==="debit"?"#4caf50":"#f44336"});if(!n())return M(Qi,{get title(){return t("accounts.accountDetails")},get children(){var _=aE(),W=_.firstChild;return _.style.setProperty("text-align","center"),_.style.setProperty("padding","3rem"),a(W,()=>t("common.error")),a(_,M(dt,{variant:"primary",onClick:()=>r("/accounts"),get children(){return[Ee(()=>t("common.back"))," ",Ee(()=>t("navigation.accounts"))]}}),null),_}});const C=_=>({Asset:{bg:"#e8f5e8",color:"#2d7d32"},Liability:{bg:"#fff3e0",color:"#f57c00"},Equity:{bg:"#e3f2fd",color:"#1976d2"},Revenue:{bg:"#e8f5e8",color:"#388e3c"},Expense:{bg:"#ffebee",color:"#d32f2f"}})[_]||{bg:"#f5f5f5",color:"#666"},T=_=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(_),j=_=>new Date(_).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),b=C(n().accountType),w=Er.getAccountTransactions(n().id);return M(Qi,{get title(){return n().name},get children(){return[(()=>{var _=Ql();return m(_,l),a(_,M(dt,{variant:"secondary",onClick:()=>r("/accounts"),get children(){return["← ",Ee(()=>t("common.back"))," ",Ee(()=>t("navigation.accounts"))]}})),_})(),(()=>{var _=lE(),W=_.firstChild,K=W.firstChild,k=K.nextSibling,R=k.nextSibling,Y=W.nextSibling;return m(_,c),m(K,u),a(K,()=>n().accountNumber),k.style.setProperty("margin","0.5rem 0"),k.style.setProperty("font-size","2rem"),a(k,()=>n().name),m(R,h),a(R,()=>T(n().balance)),a(Y,()=>n().accountType),Se(q=>m(Y,{...y,background:b.bg,color:b.color},q)),_})(),(()=>{var _=cE(),W=_.firstChild,K=W.nextSibling,k=K.firstChild,R=k.nextSibling;return R.nextSibling,m(_,g),W.$$click=()=>s("overview"),a(W,()=>t("dashboard.overview")),K.$$click=()=>s("transactions"),a(K,()=>t("accounts.transactions"),k),a(K,()=>w.length,R),Se(Y=>{var q=f(o()==="overview"),O=f(o()==="transactions");return Y.e=m(W,q,Y.e),Y.t=m(K,O,Y.t),Y},{e:void 0,t:void 0}),_})(),Ee(()=>Ee(()=>o()==="overview")()&&(()=>{var _=dE(),W=_.firstChild,K=W.nextSibling;return m(W,x),a(W,M(Ft,{get title(){return t("accounts.balance")},get subtitle(){return t("dashboard.overview")},get children(){var k=Ql();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),a(k,()=>T(n().balance)),k}}),null),a(W,M(Ft,{get title(){return t("accounts.accountType")},get subtitle(){return t("accounts.category")},get children(){var k=Ql();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),a(k,()=>t(`accounts.types.${n().accountType?.toLowerCase()}`)),k}}),null),a(W,M(Ft,{get title(){return t("common.status")},get subtitle(){return t("accounts.accountDetails")},get children(){var k=Ql();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),a(k,(()=>{var R=Ee(()=>!!n().isActive);return()=>R()?t("common.active"):t("common.inactive")})()),Se(R=>(R=n().isActive?"#4caf50":"#f44336")!=null?k.style.setProperty("color",R):k.style.removeProperty("color")),k}}),null),a(W,M(Ft,{get title(){return t("accounts.transactions")},get subtitle(){return t("common.total")},get children(){var k=Ql();return k.style.setProperty("font-size","1.5rem"),k.style.setProperty("font-weight","600"),k.style.setProperty("color","var(--primary-color)"),a(k,()=>w.length),k}}),null),m(K,S),a(K,M(Ft,{get title(){return t("accounts.accountDetails")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var k=Fd(),R=k.firstChild,Y=R.nextSibling;return a(R,()=>t("accounts.accountNumber")),a(Y,()=>n().accountNumber),Se(q=>{var O=P,le=$,N=U;return q.e=m(k,O,q.e),q.t=m(R,le,q.t),q.a=m(Y,N,q.a),q},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Fd(),R=k.firstChild,Y=R.nextSibling;return a(R,()=>t("accounts.category")),a(Y,()=>n().category),Se(q=>{var O=P,le=$,N=U;return q.e=m(k,O,q.e),q.t=m(R,le,q.t),q.a=m(Y,N,q.a),q},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Fd(),R=k.firstChild,Y=R.nextSibling;return a(R,()=>t("common.date")),a(Y,()=>j(n().createdDate)),Se(q=>{var O=P,le=$,N=U;return q.e=m(k,O,q.e),q.t=m(R,le,q.t),q.a=m(Y,N,q.a),q},{e:void 0,t:void 0,a:void 0}),k})(),(()=>{var k=Fd(),R=k.firstChild,Y=R.nextSibling;return a(R,()=>t("common.date")),a(Y,()=>j(n().lastModified)),Se(q=>{var O=P,le=$,N=U;return q.e=m(k,O,q.e),q.t=m(R,le,q.t),q.a=m(Y,N,q.a),q},{e:void 0,t:void 0,a:void 0}),k})()]}}),null),a(K,M(Ft,{get title(){return t("common.description")},get subtitle(){return t("accounts.accountDetails")},get children(){var k=uE();return k.style.setProperty("margin","0"),k.style.setProperty("color","var(--text-secondary)"),a(k,()=>n().description||t("common.noDataFound")),k}}),null),_})()),Ee(()=>Ee(()=>o()==="transactions")()&&M(Ft,{get title(){return t("accounts.accountHistory")},get subtitle(){return t("accounts.transactions")},get children(){return Ee(()=>w.length===0)()?(()=>{var _=Ql();return _.style.setProperty("text-align","center"),_.style.setProperty("color","var(--text-muted)"),_.style.setProperty("padding","2rem"),a(_,()=>t("common.noDataFound")),_})():w.map(_=>(()=>{var W=hE(),K=W.firstChild,k=K.firstChild,R=k.nextSibling,Y=R.firstChild,q=K.nextSibling;return m(W,se),m(K,X),m(k,Z),a(k,()=>_.description),m(R,re),a(R,()=>j(_.date),Y),a(R,()=>_.reference,null),a(q,()=>_.type==="debit"?"+":"-",null),a(q,()=>T(_.type==="debit"?_.debitAmount:_.creditAmount),null),Se(O=>m(q,E(_.type),O)),W})())}}))]}})};yr(["click"]);var fE=he("<div><div><h1></h1><p> </p></div><div><input type=date>"),fs=he("<div><span></span><span>"),mE=he("<div><div></div><div>"),yE=he("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),gE=he("<div><div> (<!> = <!> + <!>)</div><div> = "),vE=he("<span>(<!>: <!>)");const bE=()=>{const{t}=sr(),[e,r]=Ce(new Date().toISOString().split("T")[0]),[n,i]=Ce(0),[o,s]=Ce(0),[l,c]=Ce(0);Sn(()=>{u()});const u=()=>{const x=Er.getAccountsByType("Asset"),S=Er.getAccountsByType("Liability"),P=Er.getAccountsByType("Equity"),$=x.reduce((X,Z)=>X+Z.balance,0),U=S.reduce((X,Z)=>X+Z.balance,0),se=P.reduce((X,Z)=>X+Z.balance,0);i($),s(U),c(se)},h=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),y={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},g={"margin-bottom":"2rem"},f={"font-weight":"bold","font-size":"1.1rem","border-top":"2px solid var(--border-color)","padding-top":"0.5rem","margin-top":"1rem"};return M(Qi,{get title(){return t("balanceSheet.title")},get children(){return[(()=>{var x=fE(),S=x.firstChild,P=S.firstChild,$=P.nextSibling,U=$.firstChild,se=S.nextSibling,X=se.firstChild;return m(x,y),P.style.setProperty("margin","0"),a(P,()=>t("balanceSheet.title")),$.style.setProperty("margin","0.5rem 0 0 0"),$.style.setProperty("color","var(--text-muted)"),a($,()=>t("balanceSheet.asOf"),U),a($,()=>new Date(e()).toLocaleDateString(),null),se.style.setProperty("display","flex"),se.style.setProperty("gap","1rem"),X.addEventListener("change",Z=>r(Z.target.value)),X.style.setProperty("padding","0.5rem"),X.style.setProperty("border","1px solid var(--border-color)"),X.style.setProperty("border-radius","var(--border-radius-sm)"),a(se,M(dt,{variant:"primary",onClick:u,get children(){return t("balanceSheet.generateReport")}}),null),Se(()=>X.value=e()),x})(),(()=>{var x=mE(),S=x.firstChild,P=S.nextSibling;return x.style.setProperty("display","grid"),x.style.setProperty("grid-template-columns","1fr 1fr"),x.style.setProperty("gap","2rem"),a(S,M(Ft,{get title(){return t("balanceSheet.assets")},style:g,get children(){return[(()=>{var $=fs(),U=$.firstChild,se=U.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),a(U,()=>t("balanceSheet.currentAssets")),a(se,()=>h(n()*.6)),$})(),(()=>{var $=fs(),U=$.firstChild,se=U.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),a(U,()=>t("balanceSheet.nonCurrentAssets")),a(se,()=>h(n()*.4)),$})(),(()=>{var $=fs(),U=$.firstChild,se=U.nextSibling;return a(U,()=>t("balanceSheet.totalAssets")),a(se,()=>h(n())),Se(X=>m($,{...f,display:"flex","justify-content":"space-between"},X)),$})()]}})),a(P,M(Ft,{get title(){return t("balanceSheet.liabilities")},style:g,get children(){return[(()=>{var $=fs(),U=$.firstChild,se=U.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),a(U,()=>t("balanceSheet.currentLiabilities")),a(se,()=>h(o()*.7)),$})(),(()=>{var $=fs(),U=$.firstChild,se=U.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),a(U,()=>t("balanceSheet.nonCurrentLiabilities")),a(se,()=>h(o()*.3)),$})(),(()=>{var $=fs(),U=$.firstChild,se=U.nextSibling;return a(U,()=>t("balanceSheet.totalLiabilities")),a(se,()=>h(o())),Se(X=>m($,{...f,display:"flex","justify-content":"space-between"},X)),$})()]}}),null),a(P,M(Ft,{get title(){return t("balanceSheet.equity")},get children(){return[(()=>{var $=fs(),U=$.firstChild,se=U.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),a(U,()=>t("balanceSheet.commonStock")),a(se,()=>h(l()*.8)),$})(),(()=>{var $=fs(),U=$.firstChild,se=U.nextSibling;return $.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),a(U,()=>t("balanceSheet.retainedEarnings")),a(se,()=>h(l()*.2)),$})(),(()=>{var $=fs(),U=$.firstChild,se=U.nextSibling;return a(U,()=>t("balanceSheet.totalEquity")),a(se,()=>h(l())),Se(X=>m($,{...f,display:"flex","justify-content":"space-between"},X)),$})()]}}),null),x})(),M(Ft,{get title(){return t("dashboard.overview")},style:{"margin-top":"2rem"},get children(){return[(()=>{var x=yE(),S=x.firstChild,P=S.firstChild,$=P.nextSibling,U=S.nextSibling,se=U.firstChild,X=se.nextSibling,Z=U.nextSibling,re=Z.firstChild,E=re.nextSibling;return x.style.setProperty("display","grid"),x.style.setProperty("grid-template-columns","repeat(3, 1fr)"),x.style.setProperty("gap","2rem"),S.style.setProperty("text-align","center"),P.style.setProperty("font-size","0.875rem"),P.style.setProperty("color","var(--text-muted)"),P.style.setProperty("margin-bottom","0.5rem"),a(P,()=>t("balanceSheet.totalAssets")),$.style.setProperty("font-size","1.5rem"),$.style.setProperty("font-weight","bold"),$.style.setProperty("color","var(--primary-color)"),a($,()=>h(n())),U.style.setProperty("text-align","center"),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("color","var(--text-muted)"),se.style.setProperty("margin-bottom","0.5rem"),a(se,()=>t("balanceSheet.totalLiabilities")),X.style.setProperty("font-size","1.5rem"),X.style.setProperty("font-weight","bold"),X.style.setProperty("color","#f44336"),a(X,()=>h(o())),Z.style.setProperty("text-align","center"),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),re.style.setProperty("margin-bottom","0.5rem"),a(re,()=>t("balanceSheet.totalEquity")),E.style.setProperty("font-size","1.5rem"),E.style.setProperty("font-weight","bold"),E.style.setProperty("color","#4caf50"),a(E,()=>h(l())),x})(),(()=>{var x=gE(),S=x.firstChild,P=S.firstChild,$=P.nextSibling,U=$.nextSibling,se=U.nextSibling,X=se.nextSibling,Z=X.nextSibling;Z.nextSibling;var re=S.nextSibling,E=re.firstChild;return x.style.setProperty("margin-top","2rem"),x.style.setProperty("text-align","center"),S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","var(--text-muted)"),S.style.setProperty("margin-bottom","0.5rem"),a(S,()=>t("common.total"),P),a(S,()=>t("balanceSheet.totalAssets"),$),a(S,()=>t("balanceSheet.totalLiabilities"),se),a(S,()=>t("balanceSheet.totalEquity"),Z),re.style.setProperty("font-size","1.2rem"),re.style.setProperty("font-weight","bold"),a(re,()=>h(n()),E),a(re,()=>h(o()+l()),null),a(re,(()=>{var C=Ee(()=>Math.abs(n()-(o()+l()))>.01);return()=>C()&&(()=>{var T=vE(),j=T.firstChild,b=j.nextSibling,w=b.nextSibling,_=w.nextSibling;return _.nextSibling,T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","#f44336"),T.style.setProperty("display","block"),a(T,()=>t("common.error"),b),a(T,()=>h(n()-(o()+l())),_),T})()})(),null),Se(C=>(C=Math.abs(n()-(o()+l()))<.01?"#4caf50":"#f44336")!=null?re.style.setProperty("color",C):re.style.removeProperty("color")),x})()]}})]}})};yr(["click"]);const _E="modulepreload",SE=function(t){return"/"+t},h0={},Oi=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let s=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");i=s(r.map(u=>{if(u=SE(u),u in h0)return;h0[u]=!0;const h=u.endsWith(".css"),y=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${y}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":_E,h||(g.as="script"),g.crossOrigin="",g.href=u,c&&g.setAttribute("nonce",c),document.head.appendChild(g),h)return new Promise((f,x)=>{g.addEventListener("load",f),g.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(s){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s}return i.then(s=>{for(const l of s||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})},PE=[{id:"YY_8802",code:"YY_8802",name:"CENTER",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8803",code:"YY_8803",name:"BISSONNET",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8804",code:"YY_8804",name:"IRVIN",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8805",code:"YY_8805",name:"KATTY",type:"store",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8816",code:"YY_8816",type:"store",name:"YABA GLOBAL",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8818",code:"YY_8818",type:"store",name:"YABASURAUSTIN",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8847",code:"YY_8847",type:"store",name:"YABAOFICINA AZ",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_3251",code:"YY_3251",type:"store",name:"YABA FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_32",code:"YY_32",type:"store",name:"YABA MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_76",code:"YY_76",type:"store",name:"YABA DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_2376",code:"YY_2376",type:"store",name:"YABA SAN ANTONIO",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2025-08-14"},{id:"YY_79",code:"YY_79",type:"warehouse",name:"ALMACEN DALLAS",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8635",code:"YY_8635",type:"store",name:"FASHION MESQUITE",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,createdDate:"2024-01-01"},{id:"YY_8665",code:"YY_8665",name:"IRVIN FASHION",bussinesId:"YB100423253156428",address:"321 Supply Ave, City, State 12345",isActive:!0,type:"store",createdDate:"2024-01-01"},{id:"YY_8901",code:"YY_8901",name:"ALMACEN CENTRAL YABA",bussinesId:"YB100423253156428",type:"warehouse",address:"123 Industrial Dr, City, State 12345",isActive:!0,createdDate:"2024-01-01"}],wE=[{id:"1",name:'MacBook Pro 16"',price:2399,quantity:75,category:"Electronics",description:"Apple MacBook Pro 16-inch with M2 Pro chip",sku:"MBP-16-M2P",supplier:"Apple Inc.",minStock:10,location:"Warehouse A",lastUpdated:"2024-01-15"},{id:"2",name:'Dell Monitor 27"',price:299,quantity:35,category:"Electronics",description:"Dell 27-inch 4K UHD Monitor",sku:"DELL-MON-27-4K",supplier:"Dell Technologies",minStock:15,location:"Warehouse B",lastUpdated:"2024-01-14"},{id:"3",name:"Wireless Mouse",price:49.99,quantity:12,category:"Accessories",description:"Ergonomic wireless mouse with precision tracking",sku:"MOUSE-WL-001",supplier:"Logitech",minStock:25,location:"Warehouse A",lastUpdated:"2024-01-13"}],Od=()=>{const t=new Map;return Li().forEach(e=>{const r=`${e.productId}-${e.locationId}`;let n=ct.getLocationById(e.locationId),i=t.get(r);i||(i={id:r,productId:e.productId,locationId:e.locationId,locationName:n?.name,quantity:0,reservedQuantity:0,availableQuantity:0,averageCost:0,lastMovementDate:e.createdDate,lastMovementType:e.movementType},t.set(r,i)),e.movementType==="in"||e.movementType==="transfer"?(e.locationId===e.toLocationId||e.movementType==="in")&&(i.quantity+=e.quantity*1):e.movementType==="out"?i.quantity-=e.quantity*1:e.movementType==="adjustment"&&(i.quantity=e.quantity*1),new Date(e.createdDate)>new Date(i.lastMovementDate)&&(i.lastMovementDate=e.createdDate,i.lastMovementType=e.movementType),i.averageCost=e.unitCost*1,i.availableQuantity=i.quantity*1-i.reservedQuantity*1}),Array.from(t.values())},[Xa,rf]=Ce([]),[oa,p0]=Ce(PE),[Li,Bd]=Ce([]),[sa,Xc]=Ce([]),[jd,nf]=Ce(wE),xE={TRANSFER:1,transfer:1},f0=173442384e4,ct={get products(){return Xa()},get locations(){return oa()},get movements(){return Li()},get stockLevels(){return sa()},parseInventoryData:t=>{const e=Object.keys(t).slice(0,900),r=[],n=i=>{let o=t;o[i]?.products&&o[i]?.products?.map(s=>{let l=_P(o[i]?.type),c=s?.price*1||s?.unitCost*1,u=s?.qty*1||s?.quantity*1;c=isNaN(c)?0:c,u=isNaN(u)?0:u;let h={id:o[i]?.ssg_inventory_key,productId:s?.product?.id,productName:s?.product?.label,productSku:s?.product?.code,locationId:o[i]?.store,locationName:o[i]?.store,location:o[i]?.store,movementType:l,quantity:u,unitCost:c,totalCost:c*1*u,minStock:10,referenceNumber:"PO-001",notes:o[i]?.description||o[i]?.notes,createdBy:"admin",createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(f0).toISOString(),invoiceId:o[i]?.invoice};if(r.push(h),xE[o[i].movementType]&&o[i]?.fromLocationId){let y=ct.getLocationById(o[i]?.fromLocationId);const g={id:o[i]?.ssg_inventory_key,productId:s?.product?.id,productName:s?.product?.label,productSku:s?.product?.code,locationId:o[i]?.fromLocationId,locationName:y?.name||"",movementType:"out",quantity:u*-1,unitCost:c,totalCost:c*-1*u,minStock:10,referenceNumber:o[i]?.referenceNumber,notes:`Transfer to ${o[i]?.locationName}`+(o[i].notes?` - ${o[i].notes}`:""),createdBy:o[i].createdBy,createdDate:o[i]?.createDate?new Date(o[i]?.createDate).toISOString():new Date(f0).toISOString(),invoiceId:o[i]?.invoiceId,toLocationId:o[i]?.locationId,toLocationName:o[i]?.locationName};r.push(g)}})};return e.map(n),r},fecthInventory:async t=>{const e=await gi.getInventory(t),r=ct.parseInventoryData(e);ct.updMovements(r)},getStockLevels:async t=>{const e=await qy.getStockLevels(t);Xc(e)},fecthProduct:async t=>{const e=await gi.getProducts(t),r=Object.keys(e),n=o=>{let s=e;return{id:o,name:s[o].name,businessId:s[o].businessId,sku:s[o].code,UPC:s[o].UPC,numCode:s[o].codeN,category:s[o].category,unitCost:s[o].unitCost||0,unitOfMeasure:s[o].unitOfMeasure||s[o].unit,minStockLevel:s[o].minStockLevel,maxStockLevel:s[o].maxStockLevel,isActive:s[o].isActive,productImageUrl:s[o].productImageUrl,description:s[o].description||"",createdDate:s[o].createdAt||new Date().toISOString(),lastModified:s[o].updatedAt||new Date().toISOString()}},i=r.map(n);return ct.updProduct(i),i},getProductById:t=>Xa().find(e=>e.id===t),updProduct:t=>{rf(t)},getProductsBySku:t=>Xa().filter(e=>e.sku.toLowerCase().includes(t.toLowerCase())),getProductsByCategory:t=>Xa().filter(e=>e.category===t),getActiveProducts:()=>Xa().filter(t=>t.name),getLocationById:t=>oa().find(e=>e.id===t),getLocationsByType:t=>oa().filter(e=>e.type===t),getActiveLocations:()=>{if(pr?.state?.profile?.isAdmin)return oa();let t=pr?.state?.profile?.stores;return oa().filter(e=>t?.[e?.id])},getMovementsByProduct:t=>Li().filter(e=>e.productId===t),updMovements:t=>{Bd([...t]),Xc(Od())},getMovementsByLocation:t=>Li()?.filter(e=>e.locationId===t),getMovementsByDateRange:(t,e)=>Li()?.filter(r=>r.createdDate>=t&&r.createdDate<=e),getStockByProduct:t=>sa()?.filter(e=>e.productId===t),getStockByLocation:t=>sa()?.filter(e=>e.locationId===t),getStockByProductAndLocation:(t,e)=>sa()?.find(r=>r.productId===t&&r.locationId===e),getTotalStockByProduct:t=>sa()?.filter(e=>e.productId===t).reduce((e,r)=>e*1+r.quantity*1,0),getLastLocationByProduct:t=>{const e=Li()?.filter(r=>r.productId===t).sort((r,n)=>new Date(n.createdDate).getTime()-new Date(r.createdDate).getTime());if(e.length>0)return oa().find(r=>r.id===e[0].locationId)},getLowStockProducts:()=>(Xa()||[])?.map(t=>{const e=sa()?.filter(r=>r.productId===t.id).reduce((r,n)=>r+n.quantity,0)||0;return{...t,currentStock:e}}).filter(t=>t.currentStock<=t.minStockLevel),generateMovementInvoice:async(t,e,r,n="compact")=>{try{const{getUserLanguage:i}=await Oi(async()=>{const{getUserLanguage:h}=await import("./languageUtils-BVmHbHaj.js");return{getUserLanguage:h}},[]),o=r||i();let s;switch(n){case"compact":const{generateCompactModernInvoicePDF:h}=await Oi(async()=>{const{generateCompactModernInvoicePDF:f}=await import("./compactModernInvoicePdfGenerator-BLPc1hH8.js");return{generateCompactModernInvoicePDF:f}},[]);s=h;break;case"modern":const{generateModernMovementInvoicePDF:y}=await Oi(async()=>{const{generateModernMovementInvoicePDF:f}=await import("./modernMovementInvoicePdfGenerator-JZtIfy1C.js");return{generateModernMovementInvoicePDF:f}},[]);s=y;break;case"classic":default:const{generateMovementInvoicePDF:g}=await Oi(async()=>{const{generateMovementInvoicePDF:f}=await import("./movementInvoicePdfGenerator-DfTWro6n.js");return{generateMovementInvoicePDF:f}},[]);s=g;break}const l=Li().filter(h=>h.invoiceId===t||h.id===t);if(l.length===0)throw new Error(`No movements found with ID: ${t}`);const c=l.reduce((h,y)=>{const g=y.invoiceId||y.id;return h[g]||(h[g]={invoiceId:g,movementType:y.movementType,referenceNumber:y.referenceNumber,createdBy:y.createdBy,createdDate:y.createdDate,locationName:y.locationName,fromLocationName:y.fromLocationName,toLocationName:y.toLocationName,notes:y.notes,items:[]}),h[g].items.push({productSku:y.productSku,productName:y.productName,quantity:y.quantity,unitCost:y.unitCost,totalCost:y.totalCost,receivedQuantity:y.movementType==="transfer"?null:void 0}),h},{}),u=[];for(const[h,y]of Object.entries(c)){const g=await s(y,e,o);u.push(g)}return u}catch(i){throw console.error("Error generating movement invoice:",i),i}},getMovementsByInvoiceId:t=>Li().filter(e=>e.invoiceId===t),generateCompactMovementInvoice:async(t,e,r)=>ct.generateMovementInvoice(t,e,r,"compact"),generateModernMovementInvoice:async(t,e,r)=>ct.generateMovementInvoice(t,e,r,"modern"),generateClassicMovementInvoice:async(t,e,r)=>ct.generateMovementInvoice(t,e,r,"classic"),getMovementInvoiceData:t=>{const e=Li().filter(i=>i.invoiceId===t||i.id===t);if(e.length===0)return null;const r=e[0],n=e.reduce((i,o)=>i+(o.totalCost||o.quantity*o.unitCost),0);return{invoiceId:r.invoiceId||r.id,movementType:r.movementType,referenceNumber:r.referenceNumber,createdBy:r.createdBy,createdDate:r.createdDate,locationName:r.locationName,fromLocationName:r.fromLocationName,toLocationName:r.toLocationName,notes:r.notes,totalValue:n,itemCount:e.length,items:e.map(i=>({productSku:i.productSku,productName:i.productName,quantity:i.quantity,unitCost:i.unitCost,totalCost:i.totalCost||i.quantity*i.unitCost}))}},addInventoryMovement:t=>{const e={...t,id:`mov-${Date.now()}`,createdDate:new Date().toISOString()};Bd(r=>[...r,e]),Xc(Od())},addBulkInventoryMovements:async t=>{const e=[],r=[],n=new Date().toISOString(),i=oa().find(l=>l.id===t.locationId);if(!i)return{success:!1,errors:["Invalid location"]};let o;if(t.movementType==="transfer"){if(!t.fromLocationId)return{success:!1,errors:["From location required for transfers"]};if(o=oa().find(l=>l.id===t.fromLocationId),!o)return{success:!1,errors:["Invalid from location"]};if(t.fromLocationId===t.locationId)return{success:!1,errors:["From and to locations cannot be the same"]}}if(t.items.forEach((l,c)=>{const u=Xa().find(f=>f.id===l.productId);if(!u){e.push(`Item ${c+1}: Product not found`);return}if(l.quantity<=0){e.push(`Item ${c+1}: Quantity must be greater than 0`);return}if(t.movementType==="out"){const f=sa().filter(x=>x.productId===l.productId&&x.locationId===t.locationId).reduce((x,S)=>x+S.quantity,0);if(l.quantity>f){e.push(`Item ${c+1}: Insufficient stock. Available: ${f}, Requested: ${l.quantity}`);return}}if(t.movementType==="transfer"){const f=sa().filter(x=>x.productId===l.productId&&x.locationId===t.fromLocationId).reduce((x,S)=>x+S.quantity,0);if(l.quantity>f){e.push(`Item ${c+1}: Insufficient stock at ${o?.name}. Available: ${f}, Requested: ${l.quantity}`);return}}const h=l.unitCost||u.unitCost,y=l.quantity*h,g={id:`mov-${Date.now()}-${c}`,productId:u.id,productName:u.name,productSku:u.sku,locationId:t.locationId,locationName:i.name,movementType:t.movementType,quantity:l.quantity,unitCost:h,totalCost:y,minStock:10,referenceNumber:t.referenceNumber||"",notes:l.notes||t.generalNotes||"",createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,fromLocationId:t.fromLocationId,fromLocationName:o?.name};if(r.push(g),t.movementType==="transfer"&&o){const f={id:`mov-${Date.now()}-${c}-out`,productId:u.id,productName:u.name,productSku:u.sku,locationId:t.fromLocationId,locationName:o.name,movementType:"out",quantity:l.quantity,unitCost:h,totalCost:y,minStock:10,referenceNumber:t.referenceNumber||"",notes:`Transfer to ${i.name}`+(l.notes?` - ${l.notes}`:""),createdBy:t.createdBy,createdDate:n,invoiceId:t.invoiceId,toLocationId:t.locationId,toLocationName:i.name};r.push(f)}}),e.length>0)return{success:!1,errors:e};Bd(l=>[...l,...r]),Xc(Od()),console.log({bulkRequest:t});const s=await gi.addInventory(t);return console.log({prodResults:s}),{success:!0,errors:[]}},getMovementsByInvoice:t=>Li().filter(e=>e.invoiceId===t),getInvoiceSummary:t=>{const e=Li().filter(o=>o.invoiceId===t);if(e.length===0)return null;const r=e.reduce((o,s)=>o+s.totalCost,0),n=new Set(e.map(o=>o.productId)).size,i=e[0];return{invoiceId:t,referenceNumber:i.referenceNumber,movementType:i.movementType,location:i.locationName,fromLocation:i.fromLocationName,productCount:n,totalItems:e.reduce((o,s)=>o+s.quantity,0),totalValue:r,createdDate:i.createdDate,createdBy:i.createdBy}},addProduct:t=>{const e={...t,id:`prod-${Date.now()}`,createdDate:new Date().toISOString(),lastModified:new Date().toISOString()};rf(r=>[...r,e])},addLocation:t=>{const e={...t,id:`loc-${Date.now()}`,createdDate:new Date().toISOString()};p0(r=>[...r,e])},updateProduct:(t,e)=>{rf(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n))},updateLocation:(t,e)=>{p0(r=>r.map(n=>n.id===t?{...n,...e}:n))},updateMovement:(t,e)=>{Bd(r=>r.map(n=>n.id===t?{...n,...e,lastModified:new Date().toISOString()}:n)),Xc(Od())},get inventory(){return jd()},addItem(t){const e={...t,id:Date.now().toString(),lastUpdated:new Date().toISOString().split("T")[0]};return nf([...jd(),e]),e},updateItem(t,e){nf(jd().map(r=>r.id===t?{...r,...e,lastUpdated:new Date().toISOString().split("T")[0]}:r))},deleteItem(t){nf(jd().filter(e=>e.id!==t))},getItemById(t){return Li().find(e=>e.id===t)},getLowStockItems(){return Li().filter(t=>t.quantity*1<=t.minStock*1)},getTotalValue(){return Li().reduce((t,e)=>t*1+e.unitCost*1*e.quantity*1,0)}};var m0=he("<div>"),AE=he("<div><div><input type=text autocomplete=off>"),CE=he("<button type=button>+"),IE=he("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>");const mp=t=>{const{t:e}=sr(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),c=Dt(()=>t.value?ct.getProductById(t.value):null),u=Dt(()=>{const K=i().toLowerCase();return K?ct.getActiveProducts().filter(k=>k.name.toLowerCase().includes(K)||k.sku.toLowerCase().includes(K)||k?.UPC?.toLowerCase().includes(K)||k.category.toLowerCase().includes(K)):ct.getActiveProducts()}),h=()=>{n(!0),o(""),l(-1)},y=K=>{const k=K.target;o(k.value),n(!0),l(-1)},g=K=>{t.onChange(K),n(!1),o(""),l(-1)},f=K=>{const k=u();switch(K.key){case"ArrowDown":K.preventDefault(),l(R=>Math.min(R+1,k.length-1));break;case"ArrowUp":K.preventDefault(),l(R=>Math.max(R-1,-1));break;case"Enter":K.preventDefault(),s()>=0&&k[s()]&&g(k[s()]);break;case"Escape":n(!1),o(""),l(-1);break}},x=K=>{setTimeout(()=>{n(!1),o(""),l(-1)},150)},S=K=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(K),P=K=>ct.stockLevels.filter(k=>k.productId===K).reduce((k,R)=>k+R.quantity,0),$={position:"relative",width:"100%",...t.style},U={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},se={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},X=K=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid "+K?"var(--primary-color)":"var(--border-color)",background:K?"var(--strip-color)":"transparent",color:K?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),Z={display:"flex","justify-content":"space-between","align-items":"center"},re={flex:"1"},E={"font-weight":"500","margin-bottom":"0.25rem"},C={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},T={"text-align":"right","font-size":"0.875rem"},j={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},b=()=>r()&&i()?i():c()?`${c().name} (${c().sku})`:"",w={display:"flex","align-items":"stretch",width:"100%"},_={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},W={...U,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"};return(()=>{var K=AE(),k=K.firstChild,R=k.firstChild;return m(k,w),R.addEventListener("blur",x),R.$$keydown=f,R.$$click=h,R.$$input=y,a(k,(()=>{var Y=Ee(()=>!!t.onAddNew);return()=>Y()&&(()=>{var q=CE();return q.addEventListener("mouseleave",O=>{O.currentTarget.style.background="var(--surface-color)",O.currentTarget.style.color="var(--primary-color)"}),q.addEventListener("mouseenter",O=>{O.currentTarget.style.background="var(--primary-color)",O.currentTarget.style.color="white"}),ts(q,"click",t.onAddNew,!0),m(q,_),Se(()=>nr(q,"title",e("inventory.addProduct","Add new product"))),q})()})(),null),a(K,M(Ge,{get when(){return r()},get children(){var Y=m0();return a(Y,M(Ge,{get when(){return u().length>0},get fallback(){return(()=>{var q=m0();return m(q,j),a(q,(()=>{var O=Ee(()=>!!i());return()=>O()?e("inventory.noProductsFound","No products found matching your search."):e("inventory.noProductsAvailable","No products available.")})()),q})()},get children(){return M(Ht,{get each(){return u()},children:(q,O)=>{const le=P(q.id),N=le<=q.minStockLevel;return(()=>{var D=IE(),V=D.firstChild,I=V.firstChild,F=I.firstChild,Q=F.nextSibling,H=Q.firstChild,J=H.firstChild,te=H.nextSibling,ee=te.nextSibling,ne=ee.nextSibling,G=ne.nextSibling,ce=I.nextSibling,oe=ce.firstChild,z=oe.firstChild,de=oe.nextSibling;return D.addEventListener("mouseenter",()=>l(O())),D.$$click=()=>g(q),m(V,Z),m(I,re),m(F,E),a(F,()=>q.name),m(Q,C),a(H,()=>e("inventory.sku","SKU"),J),a(H,()=>q.sku,null),a(ee,()=>q.category),a(G,()=>S(q.unitCost)),m(ce,T),oe.style.setProperty("font-weight","600"),(N?"#f44336":"var(--text-primary)")!=null?oe.style.setProperty("color",N?"#f44336":"var(--text-primary)"):oe.style.removeProperty("color"),a(oe,le,z),a(oe,()=>q.unitOfMeasure,null),de.style.setProperty("color","var(--text-muted)"),a(de,()=>N?e("inventory.lowStock","Low Stock"):e("inventory.inStock","In Stock")),Se(fe=>m(D,X(O()===s()),fe)),D})()}})}})),Se(q=>m(Y,se,q)),Y}}),null),Se(Y=>{var q=$,O=W,le=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),N=t.disabled,D=t.required;return Y.e=m(K,q,Y.e),Y.t=m(R,O,Y.t),le!==Y.a&&nr(R,"placeholder",Y.a=le),N!==Y.o&&(R.disabled=Y.o=N),D!==Y.i&&(R.required=Y.i=D),Y},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>R.value=b()),K})()};yr(["input","click","keydown"]);var y0=he("<div>"),$E=he("<div><div><input type=text autocomplete=off>"),EE=he("<button type=button>+"),TE=he("<div><div><div><div> </div><div><span>: </span><span></span></div><div>");const Vu=t=>{const{t:e}=sr(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),c=Dt(()=>t.value?ct.getLocationById(t.value):null),u=Dt(()=>{let K=ct.getActiveLocations();t.filterType&&(K=K.filter(R=>R.type===t.filterType));const k=i().toLowerCase();return k?K.filter(R=>R.name.toLowerCase().includes(k)||R?.code?.toLowerCase().includes(k)||R?.type?.toLowerCase().includes(k)||R?.address?.toLowerCase().includes(k)):K}),h=()=>{n(!0),o(""),l(-1)},y=K=>{const k=K.target;o(k.value),n(!0),l(-1)},g=K=>{t.onChange(K.id),n(!1),o(""),l(-1)},f=K=>{const k=u();switch(K.key){case"ArrowDown":K.preventDefault(),l(R=>Math.min(R+1,k.length-1));break;case"ArrowUp":K.preventDefault(),l(R=>Math.max(R-1,-1));break;case"Enter":K.preventDefault(),s()>=0&&k[s()]&&g(k[s()]);break;case"Escape":n(!1),o(""),l(-1);break}},x=K=>{setTimeout(()=>{n(!1),o(""),l(-1)},150)},S=K=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[K]||"📍",P=K=>({warehouse:"#2196F3",store:"#4CAF50",supplier:"#FF9800",customer:"#9C27B0"})[K]||"#757575",$={position:"relative",width:"100%",...t.style},U={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},se={display:"flex","align-items":"stretch",width:"100%"},X={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},Z={...U,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},re={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},E=K=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:K?"var(--strip-color)":"transparent",color:K?"var(--primary-dark)":"var(--text-primary)",transition:"all 0.2s ease"}),C={display:"flex","justify-content":"space-between","align-items":"center"},T={flex:"1"},j={"font-weight":"500","margin-bottom":"0.25rem"},b={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","align-items":"center"},w=K=>({padding:"0.2rem 0.5rem","border-radius":"var(--border-radius-sm)","font-size":"0.7rem","font-weight":"500",background:P(K),color:"white","text-transform":"uppercase"}),_={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},W=()=>r()&&i()?i():c()?`${c().name} (${c().code})`:"";return(()=>{var K=$E(),k=K.firstChild,R=k.firstChild;return m(k,se),R.addEventListener("blur",x),R.$$keydown=f,R.$$click=h,R.$$input=y,a(k,(()=>{var Y=Ee(()=>!!t.onAddNew);return()=>Y()&&(()=>{var q=EE();return q.addEventListener("mouseleave",O=>{O.currentTarget.style.background="var(--surface-color)",O.currentTarget.style.color="var(--primary-color)"}),q.addEventListener("mouseenter",O=>{O.currentTarget.style.background="var(--primary-color)",O.currentTarget.style.color="white"}),ts(q,"click",t.onAddNew,!0),m(q,X),Se(()=>nr(q,"title",e("inventory.addLocation","Add new location"))),q})()})(),null),a(K,M(Ge,{get when(){return r()},get children(){var Y=y0();return a(Y,M(Ge,{get when(){return u().length>0},get fallback(){return(()=>{var q=y0();return m(q,_),a(q,(()=>{var O=Ee(()=>!!i());return()=>O()?e("inventory.noLocationsFound","No locations found matching your search."):e("inventory.noLocationsAvailable","No locations available.")})()),q})()},get children(){return M(Ht,{get each(){return u()},children:(q,O)=>(()=>{var le=TE(),N=le.firstChild,D=N.firstChild,V=D.firstChild,I=V.firstChild,F=V.nextSibling,Q=F.firstChild,H=Q.firstChild,J=Q.nextSibling,te=F.nextSibling;return le.addEventListener("mouseenter",()=>l(O())),le.$$click=()=>g(q),m(N,C),m(D,T),m(V,j),a(V,()=>S(q.type),I),a(V,()=>q.name,null),m(F,b),a(Q,()=>e("inventory.locationCode","Code"),H),a(Q,()=>q.code,null),a(J,()=>q.type),te.style.setProperty("font-size","0.75rem"),te.style.setProperty("color","var(--text-muted)"),te.style.setProperty("margin-top","0.25rem"),a(te,()=>q.address),Se(ee=>{var ne=E(O()===s()),G=w(q.type);return ee.e=m(le,ne,ee.e),ee.t=m(J,G,ee.t),ee},{e:void 0,t:void 0}),le})()})}})),Se(q=>m(Y,re,q)),Y}}),null),Se(Y=>{var q=$,O=Z,le=t.placeholder||e("inventory.searchLocations","Search locations by name, code, or type..."),N=t.disabled,D=t.required;return Y.e=m(K,q,Y.e),Y.t=m(R,O,Y.t),le!==Y.a&&nr(R,"placeholder",Y.a=le),N!==Y.o&&(R.disabled=Y.o=N),D!==Y.i&&(R.required=Y.i=D),Y},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>R.value=W()),K})()};yr(["input","click","keydown"]);var kE=he("<form><div><label> *</label><input type=text required></div><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text list=categories required><datalist id=categories><option value=Electronics></option><option value=Accessories></option><option value=Office></option><option value=Furniture></option><option value=Software></option><option value=Hardware></option></datalist></div></div><div><label></label><textarea></textarea></div><div><div><label></label><select><option value=pcs></option><option value=kg></option><option value=lbs></option><option value=m></option><option value=ft></option><option value=l></option><option value=gal></option><option value=box></option><option value=pack></option></select></div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div></div><div><div><label></label><input type=number min=0 step=0.01 placeholder=0.00></div><div></div></div><div><div><label></label><input type=number min=0 step=1></div><div><label></label><input type=number min=1 step=1></div></div><div>"),NE=he("<div>");const zy=t=>{const{t:e}=sr(),[r,n]=Ce(""),[i,o]=Ce(""),[s,l]=Ce(""),[c,u]=Ce(""),[h,y]=Ce("pcs"),[g,f]=Ce(0),[x,S]=Ce(0),[P,$]=Ce(10),[U,se]=Ce(100),[X,Z]=Ce(""),re=()=>{n(""),o(""),l(""),u(""),y("pcs"),f(0),S(0),$(10),se(100),Z("")},E=k=>{if(k.preventDefault(),Z(""),!r().trim()){Z(e("forms.productNameRequired"));return}if(!i().trim()){Z(e("forms.skuRequired"));return}if(!c().trim()){Z(e("forms.categoryRequired"));return}if(g()<0){Z(e("forms.unitCostNotNegative"));return}if(x()<0){Z(e("forms.sellingPriceNotNegative"));return}if(P()<0){Z(e("forms.minStockNotNegative"));return}if(U()<=P()){Z(e("forms.maxStockGreaterThanMin"));return}if(ct.getProductsBySku(i()).length>0){Z(e("forms.skuAlreadyExists"));return}const Y={name:r().trim(),sku:i().trim().toUpperCase(),description:s().trim(),category:c().trim(),unitOfMeasure:h(),unitCost:g(),sellingPrice:x(),minStockLevel:P(),maxStockLevel:U(),isActive:!0,businessId:"default-business"};ct.addProduct(Y);const q=`prod-${Date.now()}`;t.onProductAdded&&t.onProductAdded(q),re(),t.onClose()},C=()=>{re(),t.onClose()},T={"margin-bottom":"1.5rem"},j={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},b={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},w={...b,cursor:"pointer"},_={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},W={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},K={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"};return M(Fn,{get isOpen(){return t.isOpen},onClose:C,get title(){return e("inventory.addNewProduct")},get children(){var k=kE(),R=k.firstChild,Y=R.firstChild,q=Y.firstChild,O=Y.nextSibling,le=R.nextSibling,N=le.firstChild,D=N.firstChild,V=D.firstChild,I=D.nextSibling,F=N.nextSibling,Q=F.firstChild,H=Q.firstChild,J=Q.nextSibling,te=le.nextSibling,ee=te.firstChild,ne=ee.nextSibling,G=te.nextSibling,ce=G.firstChild,oe=ce.firstChild,z=oe.nextSibling,de=z.firstChild,fe=de.nextSibling,ue=fe.nextSibling,ge=ue.nextSibling,xe=ge.nextSibling,pe=xe.nextSibling,_e=pe.nextSibling,Le=_e.nextSibling,De=Le.nextSibling,Te=ce.nextSibling,$e=Te.firstChild,Ie=$e.nextSibling,Re=G.nextSibling,Ke=Re.firstChild,je=Ke.firstChild,We=je.nextSibling,Qe=Re.nextSibling,at=Qe.firstChild,nt=at.firstChild,Ye=nt.nextSibling,ht=at.nextSibling,lt=ht.firstChild,$t=lt.nextSibling,_t=Qe.nextSibling;return k.addEventListener("submit",E),a(Y,()=>e("inventory.productName"),q),O.addEventListener("change",ze=>n(ze.target.value)),a(D,()=>e("inventory.sku"),V),I.addEventListener("change",ze=>o(ze.target.value)),a(Q,()=>e("inventory.category"),H),J.addEventListener("change",ze=>u(ze.target.value)),a(ee,()=>e("common.description")),ne.addEventListener("change",ze=>l(ze.target.value)),a(oe,()=>e("inventory.unitOfMeasure")),z.addEventListener("change",ze=>y(ze.target.value)),a(de,()=>e("inventory.pieces")),a(fe,()=>e("inventory.kilograms")),a(ue,()=>e("inventory.pounds")),a(ge,()=>e("inventory.meters")),a(xe,()=>e("inventory.feet")),a(pe,()=>e("inventory.liters")),a(_e,()=>e("inventory.gallons")),a(Le,()=>e("inventory.boxes")),a(De,()=>e("inventory.packs")),a($e,()=>e("inventory.unitCost")),Ie.addEventListener("change",ze=>f(Number(ze.target.value))),a(je,()=>e("inventory.sellingPrice")),We.addEventListener("change",ze=>S(Number(ze.target.value))),a(nt,()=>e("inventory.minimumStockLevel")),Ye.addEventListener("change",ze=>$(Number(ze.target.value))),a(lt,()=>e("inventory.maximumStockLevel")),$t.addEventListener("change",ze=>se(Number(ze.target.value))),a(k,(()=>{var ze=Ee(()=>!!X());return()=>ze()&&(()=>{var Lt=NE();return m(Lt,_),a(Lt,X),Lt})()})(),_t),m(_t,W),a(_t,M(dt,{variant:"secondary",type:"button",onClick:C,get children(){return e("common.cancel")}}),null),a(_t,M(dt,{variant:"primary",type:"submit",get children(){return e("inventory.addProduct")}}),null),Se(ze=>{var Lt=T,Nt=j,wt=b,Ot=e("inventory.enterProductName"),gr=K,Be=j,Pt=b,Ct=e("inventory.enterSkuCode"),tt=j,ft=b,Vt=e("inventory.enterCategory"),Rt=T,rr=j,it={...b,"min-height":"80px",resize:"vertical"},yt=e("inventory.enterProductDescription"),It=K,Jt=j,Je=w,Et=j,Wt=b,Yt=K,er=j,kt=b,Xt=K,tr=j,Zt=b,vt=j,ir=b;return ze.e=m(R,Lt,ze.e),ze.t=m(Y,Nt,ze.t),ze.a=m(O,wt,ze.a),Ot!==ze.o&&nr(O,"placeholder",ze.o=Ot),ze.i=m(le,gr,ze.i),ze.n=m(D,Be,ze.n),ze.s=m(I,Pt,ze.s),Ct!==ze.h&&nr(I,"placeholder",ze.h=Ct),ze.r=m(Q,tt,ze.r),ze.d=m(J,ft,ze.d),Vt!==ze.l&&nr(J,"placeholder",ze.l=Vt),ze.u=m(te,Rt,ze.u),ze.c=m(ee,rr,ze.c),ze.w=m(ne,it,ze.w),yt!==ze.m&&nr(ne,"placeholder",ze.m=yt),ze.f=m(G,It,ze.f),ze.y=m(oe,Jt,ze.y),ze.g=m(z,Je,ze.g),ze.p=m($e,Et,ze.p),ze.b=m(Ie,Wt,ze.b),ze.T=m(Re,Yt,ze.T),ze.A=m(je,er,ze.A),ze.O=m(We,kt,ze.O),ze.I=m(Qe,Xt,ze.I),ze.S=m(nt,tr,ze.S),ze.W=m(Ye,Zt,ze.W),ze.C=m(lt,vt,ze.C),ze.B=m($t,ir,ze.B),ze},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),Se(()=>O.value=r()),Se(()=>I.value=i()),Se(()=>J.value=c()),Se(()=>ne.value=s()),Se(()=>z.value=h()),Se(()=>Ie.value=g()),Se(()=>We.value=x()),Se(()=>Ye.value=P()),Se(()=>$t.value=U()),k}})};var LE=he('<form><div><label> *</label><input type=text required></div><div><div><label> *<button type=button title="Generate code automatically"></button></label><input type=text required><div></div></div><div><label> *</label><select required><option value=warehouse> </option><option value=store> </option><option value=supplier> </option><option value=customer> </option></select><div></div></div></div><div><label> *</label><textarea required></textarea></div><div>'),RE=he("<div><div>:</div><div><span></span><div><div></div><div>"),DE=he("<div>");const Uy=t=>{const{t:e}=sr(),[r,n]=Ce(""),[i,o]=Ce(""),[s,l]=Ce("warehouse"),[c,u]=Ce(""),[h,y]=Ce(""),g=()=>{n(""),o(""),l("warehouse"),u(""),y("")},f=()=>{if(r()){const b=s()==="warehouse"?"WH":s()==="store"?"ST":s()==="supplier"?"SUP":"CUST",w=r().toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,3),_=String(Math.floor(Math.random()*1e3)).padStart(3,"0");o(`${b}-${w}-${_}`)}},x=b=>{if(b.preventDefault(),y(""),!r().trim()){y(e("forms.locationNameRequired"));return}if(!i().trim()){y(e("forms.locationCodeRequired"));return}if(!c().trim()){y(e("forms.addressRequired"));return}if(ct.locations.filter(K=>K.code.toLowerCase()===i().toLowerCase()).length>0){y(e("forms.locationCodeExists"));return}const _={name:r().trim(),code:i().trim().toUpperCase(),type:s(),address:c().trim(),isActive:!0};ct.addLocation(_);const W=`loc-${Date.now()}`;t.onLocationAdded&&t.onLocationAdded(W),g(),t.onClose()},S=()=>{g(),t.onClose()},P={"margin-bottom":"1.5rem"},$={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},U={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},se={...U,cursor:"pointer"},X={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},Z={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},re={display:"grid","grid-template-columns":"2fr 1fr",gap:"1rem"},E={"font-size":"0.875rem",color:"var(--text-muted)","margin-top":"0.25rem"},C={padding:"0.25rem 0.5rem","font-size":"0.75rem","margin-left":"0.5rem",background:"var(--background-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",color:"var(--text-muted)"},T=b=>({warehouse:"🏭",store:"🏪",supplier:"🚚",customer:"👥"})[b]||"📍",j=b=>({warehouse:e("inventory.warehouseDescription"),store:e("inventory.storeDescription"),supplier:e("inventory.supplierDescription"),customer:e("inventory.customerDescription")})[b]||"";return M(Fn,{get isOpen(){return t.isOpen},onClose:S,get title(){return e("inventory.addNewLocation")},get children(){var b=LE(),w=b.firstChild,_=w.firstChild,W=_.firstChild,K=_.nextSibling,k=w.nextSibling,R=k.firstChild,Y=R.firstChild,q=Y.firstChild,O=q.nextSibling,le=Y.nextSibling,N=le.nextSibling,D=R.nextSibling,V=D.firstChild,I=V.firstChild,F=V.nextSibling,Q=F.firstChild,H=Q.firstChild,J=Q.nextSibling,te=J.firstChild,ee=J.nextSibling,ne=ee.firstChild,G=ee.nextSibling,ce=G.firstChild,oe=F.nextSibling,z=k.nextSibling,de=z.firstChild,fe=de.firstChild,ue=de.nextSibling,ge=z.nextSibling;return b.addEventListener("submit",x),a(_,()=>e("inventory.locationName"),W),K.addEventListener("change",xe=>n(xe.target.value)),m(k,re),a(Y,()=>e("inventory.locationCode"),q),O.$$click=f,m(O,C),a(O,()=>e("common.generate")),le.addEventListener("change",xe=>o(xe.target.value)),a(N,()=>e("inventory.uniqueIdentifierHelp")),a(V,()=>e("inventory.locationType"),I),F.addEventListener("change",xe=>l(xe.target.value)),a(Q,()=>T("warehouse"),H),a(Q,()=>e("inventory.warehouse"),null),a(J,()=>T("store"),te),a(J,()=>e("inventory.store"),null),a(ee,()=>T("supplier"),ne),a(ee,()=>e("inventory.supplier"),null),a(G,()=>T("customer"),ce),a(G,()=>e("inventory.customer"),null),a(oe,()=>j(s())),a(de,()=>e("common.address"),fe),ue.addEventListener("change",xe=>u(xe.target.value)),a(b,(()=>{var xe=Ee(()=>!!r());return()=>xe()&&(()=>{var pe=RE(),_e=pe.firstChild,Le=_e.firstChild,De=_e.nextSibling,Te=De.firstChild,$e=Te.nextSibling,Ie=$e.firstChild,Re=Ie.nextSibling;return pe.style.setProperty("padding","1rem"),pe.style.setProperty("background","var(--background-color)"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("margin-bottom","1rem"),_e.style.setProperty("font-weight","500"),_e.style.setProperty("margin-bottom","0.5rem"),a(_e,()=>e("common.preview"),Le),De.style.setProperty("display","flex"),De.style.setProperty("align-items","center"),De.style.setProperty("gap","0.5rem"),Te.style.setProperty("font-size","1.2rem"),a(Te,()=>T(s())),Ie.style.setProperty("font-weight","600"),a(Ie,r),Re.style.setProperty("font-size","0.875rem"),Re.style.setProperty("color","var(--text-muted)"),a(Re,(()=>{var Ke=Ee(()=>!!i());return()=>Ke()&&`${i()} • `})(),null),a(Re,s,null),pe})()})(),ge),a(b,(()=>{var xe=Ee(()=>!!h());return()=>xe()&&(()=>{var pe=DE();return m(pe,X),a(pe,h),pe})()})(),ge),m(ge,Z),a(ge,M(dt,{variant:"secondary",type:"button",onClick:S,get children(){return e("common.cancel")}}),null),a(ge,M(dt,{variant:"primary",type:"submit",get children(){return e("inventory.addLocation")}}),null),Se(xe=>{var pe=P,_e=$,Le=U,De=e("inventory.enterLocationName"),Te=$,$e=U,Ie=e("inventory.enterUniqueCode"),Re=E,Ke=$,je=se,We=E,Qe=P,at=$,nt={...U,"min-height":"100px",resize:"vertical"},Ye=e("inventory.enterCompleteAddress");return xe.e=m(w,pe,xe.e),xe.t=m(_,_e,xe.t),xe.a=m(K,Le,xe.a),De!==xe.o&&nr(K,"placeholder",xe.o=De),xe.i=m(Y,Te,xe.i),xe.n=m(le,$e,xe.n),Ie!==xe.s&&nr(le,"placeholder",xe.s=Ie),xe.h=m(N,Re,xe.h),xe.r=m(V,Ke,xe.r),xe.d=m(F,je,xe.d),xe.l=m(oe,We,xe.l),xe.u=m(z,Qe,xe.u),xe.c=m(de,at,xe.c),xe.w=m(ue,nt,xe.w),Ye!==xe.m&&nr(ue,"placeholder",xe.m=Ye),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),Se(()=>K.value=r()),Se(()=>le.value=i()),Se(()=>F.value=s()),Se(()=>ue.value=c()),b}})};yr(["click"]);var ME=he("<form><div>"),g0=he("<div><label> *"),FE=he("<div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment>"),OE=he("<div><label>"),BE=he("<div><label> *</label><input type=number min=0 step=1 required>"),jE=he("<div><label></label><input type=number min=0 step=0.01>"),VE=he("<div><label></label><input type=text>"),qE=he("<div><label></label><textarea>"),zE=he("<div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span>:</span><span> "),UE=he("<div><div><span>:</span><span>"),HE=he("<div>");const GE=t=>{const{t:e}=sr(),[r,n]=Ce({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""}),[i,o]=Ce(""),[s,l]=Ce(""),[c,u]=Ce("in"),[h,y]=Ce(0),[g,f]=Ce(0),[x,S]=Ce(""),[P,$]=Ce(""),[U,se]=Ce(""),[X,Z]=Ce(""),[re,E]=Ce(!1),[C,T]=Ce(!1),j=()=>t.mode==="movement",b=Dt(()=>i()?ct.getProductById(i()):null),w=Dt(()=>s()?ct.getLocationById(s()):null),_=Dt(()=>U()?ct.getLocationById(U()):null),W=Dt(()=>h()*g()),K=Dt(()=>!i()||!s()?0:ct.getStockByProductAndLocation(i(),s())?.quantity||0),k=[{value:"Electronics",label:"Electronics"},{value:"Accessories",label:"Accessories"},{value:"Furniture",label:"Furniture"},{value:"Office Supplies",label:"Office Supplies"},{value:"Software",label:"Software"},{value:"Hardware",label:"Hardware"},{value:"Consumables",label:"Consumables"}],R=[{value:"Warehouse A",label:"Warehouse A"},{value:"Warehouse B",label:"Warehouse B"},{value:"Warehouse C",label:"Warehouse C"},{value:"Storage Room",label:"Storage Room"},{value:"Main Office",label:"Main Office"}],Y={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},q=()=>{o(""),l(""),u("in"),y(0),f(0),S(""),$(""),se(""),Z("")},O=()=>{n({name:"",price:"",quantity:"",category:"",description:"",sku:"",supplier:"",minStock:"",location:""})},le=G=>{if(G.preventDefault(),j()){if(Z(""),!i()){Z(e("forms.selectProduct"));return}if(!s()){Z(e("forms.selectLocation"));return}if(h()<=0){Z(e("forms.quantityGreaterThanZero"));return}if(g()<0){Z(e("forms.unitCostNotNegative"));return}if(c()==="transfer"&&!U()){Z(e("forms.selectFromLocation"));return}if(c()==="transfer"&&U()===s()){Z(e("forms.sameLocationError"));return}if(c()==="out"&&h()>K()){Z(e("forms.insufficientStock",{currentStock:K()}));return}const ce=b(),oe=w(),z={productId:ce.id,productName:ce.name,productSku:ce.sku,locationId:oe.id,locationName:oe.name,movementType:c(),quantity:h(),unitCost:g()||ce.unitCost,totalCost:W()||h()*ce.unitCost,referenceNumber:x()||`AUTO-${Date.now()}`,notes:P(),createdBy:"admin",fromLocationId:c()==="transfer"?U():void 0,fromLocationName:c()==="transfer"?_()?.name:void 0};ct.addInventoryMovement(z),q()}else{const ce=r();if(!ce.name||!ce.price||!ce.quantity||!ce.category||!ce.sku||!ce.supplier||!ce.minStock||!ce.location){alert(e("forms.fillAllRequired"));return}const oe={name:ce.name,price:parseFloat(ce.price),quantity:parseInt(ce.quantity),category:ce.category,description:ce.description,sku:ce.sku,supplier:ce.supplier,minStock:parseInt(ce.minStock),location:ce.location};ct.addItem(oe),O()}t.onClose()},N=(G,ce)=>{n(oe=>({...oe,[G]:ce}))},D=()=>{j()?q():O(),t.onClose()},V=G=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(G),I={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},F={...I,cursor:"pointer"},Q={color:"#f44336","font-size":"0.875rem","margin-top":"0.5rem"},H={padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},J={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},te={"font-weight":"500",color:"var(--text-muted)"},ee={"font-weight":"600",color:"var(--text-primary)"},ne=()=>j()?e("inventory.addMovement"):e("inventory.addNewItem");return M(Fn,{get isOpen(){return t.isOpen},onClose:D,get title(){return ne()},get children(){return[(()=>{var G=ME(),ce=G.firstChild;return G.addEventListener("submit",le),a(G,(()=>{var oe=Ee(()=>!!j());return()=>oe()?[(()=>{var z=g0(),de=z.firstChild,fe=de.firstChild;return z.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("inventory.product"),fe),a(z,M(mp,{get value(){return i()},onChange:ue=>{o(ue);const ge=ct.getProductById(ue);ge&&f(ge.unitCost)},get placeholder(){return e("inventory.searchProductsPlaceholder")},onAddNew:()=>E(!0),required:!0}),null),z})(),(()=>{var z=FE(),de=z.firstChild,fe=de.firstChild,ue=de.nextSibling,ge=ue.firstChild,xe=ge.nextSibling,pe=xe.nextSibling,_e=pe.nextSibling;return z.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("inventory.movementType"),fe),ue.addEventListener("change",Le=>u(Le.target.value)),a(ge,()=>e("inventory.stockInPurchase")),a(xe,()=>e("inventory.stockOutSale")),a(pe,()=>e("inventory.transferBetween")),a(_e,()=>e("inventory.stockAdjustment")),Se(Le=>m(ue,F,Le)),Se(()=>ue.value=c()),z})(),Ee(()=>Ee(()=>c()==="transfer")()&&(()=>{var z=g0(),de=z.firstChild,fe=de.firstChild;return z.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("inventory.fromLocation"),fe),a(z,M(Vu,{get value(){return U()},onChange:ue=>se(ue),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>T(!0),required:!0}),null),z})()),(()=>{var z=OE(),de=z.firstChild;return z.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,(()=>{var fe=Ee(()=>c()==="transfer");return()=>fe()?e("inventory.toLocation")+" *":e("inventory.locationName")+" *"})()),a(z,M(Vu,{get value(){return s()},onChange:fe=>l(fe),get placeholder(){return Ee(()=>c()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>T(!0),required:!0}),null),z})(),Ee(()=>Ee(()=>!!(b()&&w()))()&&(()=>{var z=zE(),de=z.firstChild,fe=de.firstChild,ue=fe.firstChild,ge=fe.nextSibling,xe=ge.firstChild,pe=de.nextSibling,_e=pe.firstChild,Le=_e.firstChild,De=_e.nextSibling,Te=pe.nextSibling,$e=Te.firstChild,Ie=$e.firstChild,Re=$e.nextSibling,Ke=Re.firstChild;return a(fe,()=>e("inventory.currentStockAt",{location:w()?.name}),ue),a(ge,K,xe),a(ge,()=>b()?.unitOfMeasure,null),a(_e,()=>e("inventory.productCost"),Le),a(De,()=>V(b()?.unitCost||0)),a($e,()=>e("inventory.minStockLevel"),Ie),a(Re,()=>b()?.minStockLevel,Ke),a(Re,()=>b()?.unitOfMeasure,null),Se(je=>{var We=H,Qe=J,at=te,nt=ee,Ye=J,ht=te,lt=ee,$t=J,_t=te,ze=ee;return je.e=m(z,We,je.e),je.t=m(de,Qe,je.t),je.a=m(fe,at,je.a),je.o=m(ge,nt,je.o),je.i=m(pe,Ye,je.i),je.n=m(_e,ht,je.n),je.s=m(De,lt,je.s),je.h=m(Te,$t,je.h),je.r=m($e,_t,je.r),je.d=m(Re,ze,je.d),je},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),z})()),(()=>{var z=BE(),de=z.firstChild,fe=de.firstChild,ue=de.nextSibling;return z.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("inventory.quantity"),fe),ue.addEventListener("change",ge=>y(Number(ge.target.value))),Se(ge=>m(ue,I,ge)),Se(()=>ue.value=h()),z})(),(()=>{var z=jE(),de=z.firstChild,fe=de.nextSibling;return z.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("inventory.unitCost")),fe.addEventListener("change",ue=>f(Number(ue.target.value))),Se(ue=>{var ge=I,xe=e("inventory.willUseDefaultCost");return ue.e=m(fe,ge,ue.e),xe!==ue.t&&nr(fe,"placeholder",ue.t=xe),ue},{e:void 0,t:void 0}),Se(()=>fe.value=g()),z})(),Ee(()=>Ee(()=>h()>0&&g()>0)()&&(()=>{var z=UE(),de=z.firstChild,fe=de.firstChild,ue=fe.firstChild,ge=fe.nextSibling;return a(fe,()=>e("inventory.totalCost"),ue),a(ge,()=>V(W())),Se(xe=>{var pe=H,_e=J,Le=te,De={...ee,"font-size":"1.2rem",color:"var(--primary-color)"};return xe.e=m(z,pe,xe.e),xe.t=m(de,_e,xe.t),xe.a=m(fe,Le,xe.a),xe.o=m(ge,De,xe.o),xe},{e:void 0,t:void 0,a:void 0,o:void 0}),z})()),(()=>{var z=VE(),de=z.firstChild,fe=de.nextSibling;return z.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("common.referenceNumber")),fe.addEventListener("change",ue=>S(ue.target.value)),Se(ue=>{var ge=I,xe=e("common.referenceNumberPlaceholder");return ue.e=m(fe,ge,ue.e),xe!==ue.t&&nr(fe,"placeholder",ue.t=xe),ue},{e:void 0,t:void 0}),Se(()=>fe.value=x()),z})(),(()=>{var z=qE(),de=z.firstChild,fe=de.nextSibling;return z.style.setProperty("margin-bottom","1.5rem"),de.style.setProperty("display","block"),de.style.setProperty("margin-bottom","0.5rem"),de.style.setProperty("font-weight","500"),a(de,()=>e("common.notes")),fe.addEventListener("change",ue=>$(ue.target.value)),Se(ue=>{var ge={...I,"min-height":"100px",resize:"vertical"},xe=e("inventory.additionalNotesPlaceholder");return ue.e=m(fe,ge,ue.e),xe!==ue.t&&nr(fe,"placeholder",ue.t=xe),ue},{e:void 0,t:void 0}),Se(()=>fe.value=P()),z})(),Ee(()=>Ee(()=>!!X())()&&(()=>{var z=HE();return m(z,Q),a(z,X),z})())]:[M(Ar,{get label(){return e("inventory.itemName")},get value(){return r().name},onChange:z=>N("name",z),get placeholder(){return e("inventory.enterItemName")},required:!0}),M(Ar,{get label(){return e("inventory.sku")},get value(){return r().sku},onChange:z=>N("sku",z),get placeholder(){return e("inventory.enterSkuCode")},required:!0}),M(_n,{get label(){return e("inventory.category")},get value(){return r().category},onChange:z=>N("category",z),options:k,required:!0}),M(Ar,{get label(){return e("common.description")},get value(){return r().description},onChange:z=>N("description",z),get placeholder(){return e("inventory.enterItemDescription")}}),M(Ar,{get label(){return e("common.price")},type:"number",get value(){return r().price},onChange:z=>N("price",z),get placeholder(){return e("common.enterPrice")},required:!0}),M(Ar,{get label(){return e("inventory.quantity")},type:"number",get value(){return r().quantity},onChange:z=>N("quantity",z),get placeholder(){return e("inventory.enterQuantity")},required:!0}),M(Ar,{get label(){return e("inventory.minimumStock")},type:"number",get value(){return r().minStock},onChange:z=>N("minStock",z),get placeholder(){return e("inventory.enterMinStockLevel")},required:!0}),M(Ar,{get label(){return e("inventory.supplier")},get value(){return r().supplier},onChange:z=>N("supplier",z),get placeholder(){return e("inventory.enterSupplierName")},required:!0}),M(_n,{get label(){return e("inventory.location")},get value(){return r().location},onChange:z=>N("location",z),options:R,required:!0})]})(),ce),m(ce,Y),a(ce,M(dt,{variant:"secondary",type:"button",onClick:D,get children(){return e("common.cancel")}}),null),a(ce,M(dt,{variant:"primary",type:"submit",get children(){return Ee(()=>!!j())()?e("inventory.addMovement"):e("inventory.addItem")}}),null),G})(),M(zy,{get isOpen(){return re()},onClose:()=>E(!1),onProductAdded:G=>{o(G),E(!1)}}),M(Uy,{get isOpen(){return C()},onClose:()=>T(!1),onLocationAdded:G=>{c()==="transfer"&&!U()?se(G):l(G),T(!1)}})]}})};yr(["input","keydown"]);var WE=he("<form><div><div><label> *</label><input type=text required></div><div><label> *</label><input type=text required></div></div><div><label> *</label><select required><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><div><label></label></div></div><div><div><h3></h3></div></div><div><label></label><textarea></textarea></div><div>"),YE=he("<div><label> *"),KE=he("<div><div></div><div></div><div></div><div></div><div>"),of=he("<div>"),JE=he("<div><input type=number min=0 step=1 required><input type=number min=0 step=0.01><input type=text>"),QE=he("<div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span>"),XE=he("<div>• ");const ZE=t=>{const{t:e}=sr(),[r,n]=Ce(`INV-${Date.now()}`),[i,o]=Ce(""),[s,l]=Ce("in"),[c,u]=Ce(""),[h,y]=Ce(""),[g,f]=Ce(""),[x,S]=Ce([]),[P,$]=Ce([]),[U,se]=Ce(!1),[X,Z]=Ce(!1),re=()=>{S(H=>[...H,{productId:"",quantity:0,unitCost:0,notes:""}])},E=H=>{S(J=>J.filter((te,ee)=>ee!==H))},C=(H,J,te)=>{S(ee=>ee.map((ne,G)=>G===H?{...ne,[J]:te}:ne))},T=()=>{n(`INV-${Date.now()}`),o(""),l("in"),u(""),y(""),f(""),S([]),$([])},j=async H=>{H.preventDefault(),$([]);const J=[];if(i()||J.push(e("forms.referenceNumberRequired")),c()||J.push(e("forms.locationRequired")),s()==="transfer"&&!h()&&J.push(e("forms.fromLocationRequired")),x().length===0&&J.push(e("forms.atLeastOneProduct")),x().forEach((ne,G)=>{ne.productId||J.push(e("forms.itemProductRequired","Product is required for item {{index}}",{index:G+1})),ne.quantity<=0&&J.push(e("forms.itemQuantityRequired","Quantity must be greater than 0 for item {{index}}",{index:G+1}))}),J.length>0){$(J);return}const te={ssg_inventory_key:ku(),invoiceId:r(),referenceNumber:i(),movementType:s(),type:Yf(s()),locationId:c(),fromLocationId:s()==="transfer"?h():void 0,items:x(),products:x(),generalNotes:g(),description:g(),invoice:i(),store:c(),createdBy:"admin",createDate:new Date().toISOString()};console.log(te);const ee=await ct.addBulkInventoryMovements(te);console.log(ee),ee.success?t.onMovementComplete?t.onMovementComplete(i()):(T(),t.onClose()):$(ee.errors)},b=()=>{T(),t.onClose()},w=Dt(()=>x().reduce((H,J)=>{const te=ct.getProductById(J.productId),ee=J.unitCost||te?.unitCost||0;return H+J.quantity*ee},0)),_=Dt(()=>x().reduce((H,J)=>H+J.quantity,0)),W={"margin-bottom":"1.5rem"},K={display:"block","margin-bottom":"0.5rem","font-weight":"500",color:"var(--text-primary)"},k={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)"},R={...k,cursor:"pointer"},Y={display:"grid",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},q={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","align-items":"end","margin-bottom":"0.5rem",padding:"0.75rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},O={display:"grid","grid-template-columns":"2fr 1fr 1fr 2fr auto",gap:"0.5rem","font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.5rem","padding-left":"0.75rem"},le={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"1rem"},N={display:"flex","justify-content":"space-between","margin-bottom":"0.5rem"},D={color:"#f44336","font-size":"0.875rem","margin-bottom":"1rem"},V={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},I=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),F=H=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[H]||H,Q=async H=>{await ct.fecthInventory(H),await ct.fecthProduct(H)};return Sn(()=>{Q("prod")}),M(Fn,{get isOpen(){return t.isOpen},onClose:b,get title(){return e("inventory.bulkMovement")},get children(){return[(()=>{var H=WE(),J=H.firstChild,te=J.firstChild,ee=te.firstChild,ne=ee.firstChild,G=ee.nextSibling,ce=te.nextSibling,oe=ce.firstChild,z=oe.firstChild,de=oe.nextSibling,fe=J.nextSibling,ue=fe.firstChild,ge=ue.firstChild,xe=ue.nextSibling,pe=xe.firstChild,_e=pe.nextSibling,Le=_e.nextSibling,De=Le.nextSibling,Te=fe.nextSibling,$e=Te.firstChild,Ie=$e.firstChild,Re=Te.nextSibling,Ke=Re.firstChild,je=Ke.firstChild,We=Re.nextSibling,Qe=We.firstChild,at=Qe.nextSibling,nt=We.nextSibling;return H.addEventListener("submit",j),J.style.setProperty("display","grid"),J.style.setProperty("grid-template-columns","1fr 1fr"),J.style.setProperty("gap","1rem"),J.style.setProperty("margin-bottom","1.5rem"),a(ee,()=>e("common.invoiceDocumentId"),ne),G.addEventListener("change",Ye=>n(Ye.target.value)),a(oe,()=>e("common.referenceNumber"),z),de.addEventListener("change",Ye=>o(Ye.target.value)),a(ue,()=>e("inventory.movementType"),ge),xe.addEventListener("change",Ye=>l(Ye.target.value)),a(pe,()=>e("inventory.purchaseReceive")),a(_e,()=>e("inventory.saleIssue")),a(Le,()=>e("inventory.transfer")),a(De,()=>e("inventory.adjustment")),Te.style.setProperty("display","grid"),Te.style.setProperty("gap","1rem"),Te.style.setProperty("margin-bottom","1.5rem"),a(Te,(()=>{var Ye=Ee(()=>s()==="transfer");return()=>Ye()&&(()=>{var ht=YE(),lt=ht.firstChild,$t=lt.firstChild;return a(lt,()=>e("inventory.fromLocation"),$t),a(ht,M(Vu,{get value(){return h()},onChange:_t=>y(_t),get placeholder(){return e("inventory.searchSourceLocation")},onAddNew:()=>Z(!0),required:!0}),null),Se(_t=>m(lt,K,_t)),ht})()})(),$e),a(Ie,(()=>{var Ye=Ee(()=>s()==="transfer");return()=>Ye()?e("inventory.toLocation")+" *":e("inventory.location")+" *"})()),a($e,M(Vu,{get value(){return c()},onChange:Ye=>u(Ye),get placeholder(){return Ee(()=>s()==="transfer")()?e("inventory.searchDestinationLocation"):e("inventory.searchLocation")},onAddNew:()=>Z(!0),required:!0}),null),Ke.style.setProperty("display","flex"),Ke.style.setProperty("justify-content","space-between"),Ke.style.setProperty("align-items","center"),Ke.style.setProperty("margin-bottom","1rem"),je.style.setProperty("margin","0"),je.style.setProperty("font-size","1.1rem"),a(je,()=>e("inventory.products")),a(Ke,M(dt,{variant:"outline",type:"button",onClick:re,get children(){return e("inventory.addProduct")}}),null),a(Re,(()=>{var Ye=Ee(()=>x().length>0);return()=>Ye()&&[(()=>{var ht=KE(),lt=ht.firstChild,$t=lt.nextSibling,_t=$t.nextSibling,ze=_t.nextSibling;return m(ht,O),a(lt,()=>e("inventory.product")),a($t,()=>e("inventory.quantity")),a(_t,()=>e("inventory.unitCost")),a(ze,()=>e("common.notes")),ht})(),M(Ht,{get each(){return x()},children:(ht,lt)=>[(()=>{var $t=of();return m($t,Y),a($t,M(mp,{get value(){return ht.productId},onChange:_t=>{C(lt(),"productId",_t.id);let ze={id:_t.id,label:_t.name,code:_t.sku};C(lt(),"product",ze);const Lt=ct.getProductById(_t.id);Lt&&!ht.unitCost&&C(lt(),"unitCost",Lt.unitCost)},get placeholder(){return e("inventory.searchProduct")},onAddNew:()=>se(!0),required:!0})),$t})(),(()=>{var $t=JE(),_t=$t.firstChild,ze=_t.nextSibling,Lt=ze.nextSibling;return m($t,q),_t.addEventListener("change",Nt=>C(lt(),"quantity",Number(Nt.target.value))),ze.addEventListener("change",Nt=>C(lt(),"unitCost",Number(Nt.target.value))),Lt.addEventListener("change",Nt=>C(lt(),"notes",Nt.target.value)),a($t,M(dt,{variant:"outline",size:"sm",type:"button",onClick:()=>E(lt()),style:{color:"#f44336","border-color":"#f44336"},get children(){return e("common.remove")}}),null),Se(Nt=>{var wt=k,Ot=k,gr=e("common.auto"),Be=k,Pt=e("common.optionalNotes");return Nt.e=m(_t,wt,Nt.e),Nt.t=m(ze,Ot,Nt.t),gr!==Nt.a&&nr(ze,"placeholder",Nt.a=gr),Nt.o=m(Lt,Be,Nt.o),Pt!==Nt.i&&nr(Lt,"placeholder",Nt.i=Pt),Nt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>_t.value=ht.quantity),Se(()=>ze.value=ht.unitCost),Se(()=>Lt.value=ht.notes),$t})()]})]})(),null),a(Re,(()=>{var Ye=Ee(()=>x().length===0);return()=>Ye()&&(()=>{var ht=of();return ht.style.setProperty("text-align","center"),ht.style.setProperty("padding","2rem"),ht.style.setProperty("background","var(--background-color)"),ht.style.setProperty("border-radius","var(--border-radius-sm)"),ht.style.setProperty("border","1px solid var(--border-color)"),ht.style.setProperty("color","var(--text-muted)"),a(ht,()=>e("inventory.noProductsAdded")),ht})()})(),null),a(H,(()=>{var Ye=Ee(()=>x().length>0);return()=>Ye()&&(()=>{var ht=QE(),lt=ht.firstChild,$t=lt.nextSibling,_t=$t.firstChild,ze=_t.firstChild,Lt=_t.nextSibling,Nt=$t.nextSibling,wt=Nt.firstChild,Ot=wt.firstChild,gr=wt.nextSibling,Be=Nt.nextSibling,Pt=Be.firstChild,Ct=Pt.firstChild,tt=Pt.nextSibling,ft=Be.nextSibling,Vt=ft.firstChild,Rt=Vt.firstChild,rr=Vt.nextSibling;return m(ht,le),lt.style.setProperty("margin","0 0 1rem 0"),lt.style.setProperty("font-size","1rem"),a(lt,()=>e("common.summary")),a(_t,()=>e("inventory.totalProducts"),ze),Lt.style.setProperty("font-weight","600"),a(Lt,()=>x().length),a(wt,()=>e("inventory.totalItems"),Ot),gr.style.setProperty("font-weight","600"),a(gr,_),a(Pt,()=>e("inventory.totalValue"),Ct),tt.style.setProperty("font-weight","600"),tt.style.setProperty("color","var(--primary-color)"),a(tt,()=>I(w())),a(Vt,()=>e("inventory.movementType"),Rt),rr.style.setProperty("font-weight","600"),a(rr,()=>F(s())),Se(it=>{var yt=N,It=N,Jt=N,Je=N;return it.e=m($t,yt,it.e),it.t=m(Nt,It,it.t),it.a=m(Be,Jt,it.a),it.o=m(ft,Je,it.o),it},{e:void 0,t:void 0,a:void 0,o:void 0}),ht})()})(),We),a(Qe,()=>e("common.generalNotes")),at.addEventListener("change",Ye=>f(Ye.target.value)),a(H,(()=>{var Ye=Ee(()=>P().length>0);return()=>Ye()&&(()=>{var ht=of();return m(ht,D),a(ht,M(Ht,{get each(){return P()},children:lt=>(()=>{var $t=XE();return $t.firstChild,a($t,lt,null),$t})()})),ht})()})(),nt),m(nt,V),a(nt,M(dt,{variant:"secondary",type:"button",onClick:b,get children(){return e("common.cancel")}}),null),a(nt,M(dt,{variant:"primary",type:"submit",get children(){return e("inventory.createMovement")}}),null),Se(Ye=>{var ht=K,lt=k,$t=K,_t=k,ze=e("common.referenceNumberPlaceholder"),Lt=W,Nt=K,wt=R,Ot=s()==="transfer"?"1fr 1fr":"1fr",gr=K,Be=W,Pt=W,Ct=K,tt={...k,"min-height":"80px",resize:"vertical"},ft=e("inventory.generalNotesPlaceholder");return Ye.e=m(ee,ht,Ye.e),Ye.t=m(G,lt,Ye.t),Ye.a=m(oe,$t,Ye.a),Ye.o=m(de,_t,Ye.o),ze!==Ye.i&&nr(de,"placeholder",Ye.i=ze),Ye.n=m(fe,Lt,Ye.n),Ye.s=m(ue,Nt,Ye.s),Ye.h=m(xe,wt,Ye.h),Ot!==Ye.r&&((Ye.r=Ot)!=null?Te.style.setProperty("grid-template-columns",Ot):Te.style.removeProperty("grid-template-columns")),Ye.d=m(Ie,gr,Ye.d),Ye.l=m(Re,Be,Ye.l),Ye.u=m(We,Pt,Ye.u),Ye.c=m(Qe,Ct,Ye.c),Ye.w=m(at,tt,Ye.w),ft!==Ye.m&&nr(at,"placeholder",Ye.m=ft),Ye},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0}),Se(()=>G.value=r()),Se(()=>de.value=i()),Se(()=>xe.value=s()),Se(()=>at.value=g()),H})(),M(zy,{get isOpen(){return U()},onClose:()=>se(!1),onProductAdded:H=>{se(!1)}}),M(Uy,{get isOpen(){return X()},onClose:()=>Z(!1),onLocationAdded:H=>{s()==="transfer"&&!h()?y(H):u(H),Z(!1)}})]}})};var eT=he("<button>"),tT=he("<div><h3></h3><button>🖨️ "),rT=he("<div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),sf=he("<div><strong>:</strong> "),nT=he("<div>"),iT=he("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),oT=he("<div><div><h2></h2><div><select><option value=date></option><option value=quantity></option><option value=value></option></select></div></div><div>"),sT=he("<div><div><h3></h3><div></div></div><div><span></span><div>"),aT=he("<div><div><strong>:</strong> "),lT=he("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),cT=he("<div><button></button><button>🖨️"),uT=he("<tr><td></td><td></td><td></td><td></td><td></td><td>");const T5=t=>{const{t:e}=sr(),[r,n]=Ce(null),[i,o]=Ce("date"),s=Dt(()=>{const g=t.movements||ct.movements,f=new Map;return g.forEach(x=>{const S=x.referenceNumber||x.ssg_inventory_key||x.invoiceId||"UNKNOWN";if(!f.has(S)){const U=ct.getLocationById(x.locationId);f.set(S,{referenceNumber:x.referenceNumber||"",invoiceId:x.invoiceId||"",ssg_inventory_key:x.ssg_inventory_key||"",movementType:x.movementType||"unknown",locationId:x.locationId||"",locationName:U?.name||"Unknown Location",totalItems:0,totalQuantity:0,createDate:x.createDate||new Date().toISOString(),description:x.description||"",generalNotes:x.generalNotes||"",movements:[],totalValue:0})}const P=f.get(S);P.movements.push(x),P.totalItems++,P.totalQuantity+=Math.abs(x.quantity||0);const $=ct.getProductById(x.productId);$&&$.unitCost&&(P.totalValue+=Math.abs(x.quantity||0)*$.unitCost)}),Array.from(f.values()).sort((x,S)=>{switch(i()){case"quantity":return S.totalQuantity-x.totalQuantity;case"value":return S.totalValue-x.totalValue;case"date":default:return new Date(S.createDate).getTime()-new Date(x.createDate).getTime()}})}),l=g=>new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),c=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g),u=g=>{switch(g.toLowerCase()){case"in":case"stock_in":return"#22c55e";case"out":case"stock_out":return"#ef4444";case"transfer":return"#3b82f6";case"adjustment":return"#f59e0b";default:return"#6b7280"}},h=g=>{switch(g.toLowerCase()){case"in":case"stock_in":return"↗️";case"out":case"stock_out":return"↙️";case"transfer":return"↔️";case"adjustment":return"⚖️";default:return"📦"}},y=g=>{const f=g||r();if(!f)return;const x=window.open("","_blank");if(!x)return;const S=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Bulk Movement Report - ${f.referenceNumber||f.invoiceId}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
          .group-info { background: #f8f9fa; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
          .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
          table { width: 100%; border-collapse: collapse; margin-top: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f2f2f2; font-weight: bold; }
          .summary { background: #e8f4fd; padding: 15px; margin-top: 20px; border-radius: 5px; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>BULK MOVEMENT REPORT</h1>
          <h2>${f.referenceNumber||f.invoiceId}</h2>
          <p>Generated: ${l(new Date().toISOString())}</p>
        </div>
        
        <div class="group-info">
          <div class="info-grid">
            <div>
              <strong>Reference Number:</strong> ${f.referenceNumber||"N/A"}<br>
              <strong>Invoice ID:</strong> ${f.invoiceId||"N/A"}<br>
              <strong>Movement Type:</strong> ${f.movementType.toUpperCase()}<br>
              <strong>Location:</strong> ${f.locationName}
            </div>
            <div>
              <strong>Date:</strong> ${l(f.createDate)}<br>
              <strong>Total Items:</strong> ${f.totalItems}<br>
              <strong>Total Quantity:</strong> ${f.totalQuantity}<br>
              <strong>Estimated Value:</strong> ${c(f.totalValue)}
            </div>
          </div>
          ${f.description?`<p><strong>Description:</strong> ${f.description}</p>`:""}
          ${f.generalNotes?`<p><strong>Notes:</strong> ${f.generalNotes}</p>`:""}
        </div>
        
        <table>
          <thead>
            <tr>
              <th>Product Code</th>
              <th>Product Name</th>
              <th>Quantity</th>
              <th>Unit Cost</th>
              <th>Total Value</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            ${f.movements.map(P=>{const $=ct.getProductById(P.productId),U=$?.unitCost||0,se=Math.abs(P.quantity||0)*U;return`
                <tr>
                  <td>${$?.code||P.productId}</td>
                  <td>${$?.name||"Unknown Product"}</td>
                  <td>${P.quantity||0}</td>
                  <td>${c(U)}</td>
                  <td>${c(se)}</td>
                  <td>${P.notes||"-"}</td>
                </tr>
              `}).join("")}
          </tbody>
        </table>
        
        <div class="summary">
          <h3>SUMMARY</h3>
          <p><strong>Total Products:</strong> ${f.totalItems}</p>
          <p><strong>Total Quantity Moved:</strong> ${f.totalQuantity}</p>
          <p><strong>Total Estimated Value:</strong> ${c(f.totalValue)}</p>
          <p><strong>Movement Impact:</strong> ${f.movementType==="in"?"Increased":f.movementType==="out"?"Decreased":"Adjusted"} inventory</p>
        </div>
      </body>
      </html>
    `;x.document.write(S),x.document.close(),x.print()};return(()=>{var g=oT(),f=g.firstChild,x=f.firstChild,S=x.nextSibling,P=S.firstChild,$=P.firstChild,U=$.nextSibling,se=U.nextSibling,X=f.nextSibling;return g.style.setProperty("padding","1rem"),f.style.setProperty("display","flex"),f.style.setProperty("justify-content","space-between"),f.style.setProperty("align-items","center"),f.style.setProperty("margin-bottom","2rem"),a(x,()=>e("inventory.bulkMovementReport","Bulk Movement Report")),S.style.setProperty("display","flex"),S.style.setProperty("gap","1rem"),P.addEventListener("change",Z=>o(Z.currentTarget.value)),P.style.setProperty("padding","0.5rem"),a($,()=>e("common.sortByDate","Sort by Date")),a(U,()=>e("common.sortByQuantity","Sort by Quantity")),a(se,()=>e("common.sortByValue","Sort by Value")),a(S,M(Ge,{get when(){return t.onClose},get children(){var Z=eT();return ts(Z,"click",t.onClose,!0),Z.style.setProperty("padding","0.5rem 1rem"),Z.style.setProperty("background","#6c757d"),Z.style.setProperty("color","white"),Z.style.setProperty("border","none"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),Z.style.setProperty("cursor","pointer"),a(Z,()=>e("common.close","Close")),Z}}),null),X.style.setProperty("display","grid"),X.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(400px, 1fr))"),X.style.setProperty("gap","1rem"),X.style.setProperty("margin-bottom","2rem"),a(X,M(Ht,{get each(){return s()},children:Z=>M(Ft,{get style(){return{cursor:"pointer",border:r()===Z?"2px solid var(--primary-color)":"1px solid #e9ecef",transition:"all 0.2s"}},onClick:()=>n(Z),get children(){return[(()=>{var re=sT(),E=re.firstChild,C=E.firstChild,T=C.nextSibling,j=E.nextSibling,b=j.firstChild,w=b.nextSibling;return re.style.setProperty("display","flex"),re.style.setProperty("justify-content","space-between"),re.style.setProperty("align-items","flex-start"),re.style.setProperty("margin-bottom","1rem"),C.style.setProperty("margin","0 0 0.5rem 0"),C.style.setProperty("font-size","1.1rem"),a(C,()=>Z.referenceNumber||Z.invoiceId||"No Reference"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","#6c757d"),a(T,()=>l(Z.createDate)),j.style.setProperty("text-align","center"),b.style.setProperty("font-size","1.5rem"),a(b,()=>h(Z.movementType)),w.style.setProperty("font-size","0.75rem"),w.style.setProperty("font-weight","bold"),a(w,()=>Z.movementType.toUpperCase()),Se(_=>(_=u(Z.movementType))!=null?w.style.setProperty("color",_):w.style.removeProperty("color")),re})(),(()=>{var re=aT(),E=re.firstChild,C=E.firstChild,T=C.firstChild;return C.nextSibling,re.style.setProperty("margin-bottom","1rem"),E.style.setProperty("font-size","0.875rem"),E.style.setProperty("margin-bottom","0.25rem"),a(C,()=>e("inventory.location","Location"),T),a(E,()=>Z.locationName,null),a(re,M(Ge,{get when(){return Z.description},get children(){var j=sf(),b=j.firstChild,w=b.firstChild;return b.nextSibling,j.style.setProperty("font-size","0.875rem"),j.style.setProperty("margin-bottom","0.25rem"),a(b,()=>e("common.description","Description"),w),a(j,()=>Z.description,null),j}}),null),re})(),(()=>{var re=lT(),E=re.firstChild,C=E.firstChild,T=C.nextSibling,j=E.nextSibling,b=j.firstChild,w=b.nextSibling,_=j.nextSibling,W=_.firstChild,K=W.nextSibling;return re.style.setProperty("display","grid"),re.style.setProperty("grid-template-columns","repeat(3, 1fr)"),re.style.setProperty("gap","0.5rem"),re.style.setProperty("margin-bottom","1rem"),E.style.setProperty("text-align","center"),E.style.setProperty("padding","0.5rem"),E.style.setProperty("background","#f8f9fa"),E.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("font-weight","bold"),C.style.setProperty("color","#3b82f6"),a(C,()=>Z.totalItems),T.style.setProperty("font-size","0.75rem"),T.style.setProperty("color","#6c757d"),a(T,()=>e("inventory.items","Items")),j.style.setProperty("text-align","center"),j.style.setProperty("padding","0.5rem"),j.style.setProperty("background","#f8f9fa"),j.style.setProperty("border-radius","var(--border-radius-sm)"),b.style.setProperty("font-weight","bold"),b.style.setProperty("color","#22c55e"),a(b,()=>Z.totalQuantity),w.style.setProperty("font-size","0.75rem"),w.style.setProperty("color","#6c757d"),a(w,()=>e("inventory.quantity","Quantity")),_.style.setProperty("text-align","center"),_.style.setProperty("padding","0.5rem"),_.style.setProperty("background","#f8f9fa"),_.style.setProperty("border-radius","var(--border-radius-sm)"),W.style.setProperty("font-weight","bold"),W.style.setProperty("color","#f59e0b"),a(W,()=>c(Z.totalValue)),K.style.setProperty("font-size","0.75rem"),K.style.setProperty("color","#6c757d"),a(K,()=>e("common.value","Value")),re})(),(()=>{var re=cT(),E=re.firstChild,C=E.nextSibling;return re.style.setProperty("display","flex"),re.style.setProperty("gap","0.5rem"),E.$$click=T=>{T.stopPropagation(),n(Z)},E.style.setProperty("flex","1"),E.style.setProperty("padding","0.5rem"),E.style.setProperty("background","var(--primary-color)"),E.style.setProperty("color","white"),E.style.setProperty("border","none"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("cursor","pointer"),E.style.setProperty("font-size","0.875rem"),a(E,()=>e("common.viewDetails","View Details")),C.$$click=T=>{T.stopPropagation(),y(Z)},C.style.setProperty("padding","0.5rem"),C.style.setProperty("background","#22c55e"),C.style.setProperty("color","white"),C.style.setProperty("border","none"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("cursor","pointer"),C.style.setProperty("font-size","0.875rem"),re})()]}})})),a(g,M(Ge,{get when(){return r()},get children(){return M(Ft,{get children(){return[(()=>{var Z=tT(),re=Z.firstChild,E=re.nextSibling;return E.firstChild,Z.style.setProperty("display","flex"),Z.style.setProperty("justify-content","space-between"),Z.style.setProperty("align-items","center"),Z.style.setProperty("margin-bottom","1rem"),a(re,()=>e("inventory.movementDetails","Movement Details")),E.$$click=()=>y(),E.style.setProperty("padding","0.5rem 1rem"),E.style.setProperty("background","#22c55e"),E.style.setProperty("color","white"),E.style.setProperty("border","none"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("cursor","pointer"),a(E,()=>e("common.print","Print Report"),null),Z})(),(()=>{var Z=rT(),re=Z.firstChild,E=re.firstChild,C=E.firstChild,T=C.firstChild;C.nextSibling;var j=E.nextSibling,b=j.firstChild,w=b.firstChild;b.nextSibling;var _=j.nextSibling,W=_.firstChild,K=W.firstChild;W.nextSibling;var k=_.nextSibling,R=k.firstChild,Y=R.firstChild;R.nextSibling;var q=re.nextSibling,O=q.firstChild,le=O.firstChild,N=le.firstChild;le.nextSibling;var D=O.nextSibling,V=D.firstChild,I=V.firstChild;V.nextSibling;var F=D.nextSibling,Q=F.firstChild,H=Q.firstChild;Q.nextSibling;var J=F.nextSibling,te=J.firstChild,ee=te.firstChild;return te.nextSibling,Z.style.setProperty("display","grid"),Z.style.setProperty("grid-template-columns","repeat(2, 1fr)"),Z.style.setProperty("gap","1rem"),Z.style.setProperty("margin-bottom","2rem"),Z.style.setProperty("padding","1rem"),Z.style.setProperty("background","#f8f9fa"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),a(C,()=>e("inventory.referenceNumber","Reference"),T),a(E,()=>r()?.referenceNumber||"N/A",null),a(b,()=>e("inventory.invoiceId","Invoice ID"),w),a(j,()=>r()?.invoiceId||"N/A",null),a(W,()=>e("inventory.movementType","Type"),K),a(_,()=>r()?.movementType.toUpperCase(),null),a(R,()=>e("inventory.location","Location"),Y),a(k,()=>r()?.locationName,null),a(le,()=>e("common.date","Date"),N),a(O,(()=>{var ne=Ee(()=>!!r());return()=>ne()?l(r().createDate):""})(),null),a(V,()=>e("inventory.totalItems","Total Items"),I),a(D,()=>r()?.totalItems,null),a(Q,()=>e("inventory.totalQuantity","Total Quantity"),H),a(F,()=>r()?.totalQuantity,null),a(te,()=>e("common.estimatedValue","Estimated Value"),ee),a(J,(()=>{var ne=Ee(()=>!!r());return()=>ne()?c(r().totalValue):""})(),null),Z})(),M(Ge,{get when(){return r()?.description||r()?.generalNotes},get children(){var Z=nT();return Z.style.setProperty("margin-bottom","2rem"),Z.style.setProperty("padding","1rem"),Z.style.setProperty("background","#e8f4fd"),Z.style.setProperty("border-radius","var(--border-radius-sm)"),a(Z,M(Ge,{get when(){return r()?.description},get children(){var re=sf(),E=re.firstChild,C=E.firstChild;return E.nextSibling,a(E,()=>e("common.description","Description"),C),a(re,()=>r()?.description,null),re}}),null),a(Z,M(Ge,{get when(){return r()?.generalNotes},get children(){var re=sf(),E=re.firstChild,C=E.firstChild;return E.nextSibling,a(E,()=>e("common.notes","Notes"),C),a(re,()=>r()?.generalNotes,null),re}}),null),Z}}),(()=>{var Z=iT(),re=Z.firstChild,E=re.firstChild,C=E.firstChild,T=C.firstChild,j=T.nextSibling,b=j.nextSibling,w=b.nextSibling,_=w.nextSibling,W=_.nextSibling,K=E.nextSibling;return Z.style.setProperty("overflow-x","auto"),re.style.setProperty("width","100%"),re.style.setProperty("border-collapse","collapse"),C.style.setProperty("border-bottom","2px solid #dee2e6"),T.style.setProperty("padding","0.75rem"),T.style.setProperty("text-align","left"),a(T,()=>e("inventory.productCode","Code")),j.style.setProperty("padding","0.75rem"),j.style.setProperty("text-align","left"),a(j,()=>e("inventory.productName","Product")),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","center"),a(b,()=>e("inventory.quantity","Quantity")),w.style.setProperty("padding","0.75rem"),w.style.setProperty("text-align","right"),a(w,()=>e("inventory.unitCost","Unit Cost")),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","right"),a(_,()=>e("common.totalValue","Total Value")),W.style.setProperty("padding","0.75rem"),W.style.setProperty("text-align","left"),a(W,()=>e("common.notes","Notes")),a(K,M(Ht,{get each(){return r()?.movements||[]},children:k=>{const R=ct.getProductById(k.productId),Y=R?.unitCost||0,q=Math.abs(k.quantity||0)*Y;return(()=>{var O=uT(),le=O.firstChild,N=le.nextSibling,D=N.nextSibling,V=D.nextSibling,I=V.nextSibling,F=I.nextSibling;return O.style.setProperty("border-bottom","1px solid #dee2e6"),le.style.setProperty("padding","0.75rem"),le.style.setProperty("font-family","monospace"),a(le,()=>R?.code||k.productId),N.style.setProperty("padding","0.75rem"),a(N,()=>R?.name||"Unknown Product"),D.style.setProperty("padding","0.75rem"),D.style.setProperty("text-align","center"),D.style.setProperty("font-weight","bold"),a(D,()=>k.quantity||0),V.style.setProperty("padding","0.75rem"),V.style.setProperty("text-align","right"),a(V,()=>c(Y)),I.style.setProperty("padding","0.75rem"),I.style.setProperty("text-align","right"),I.style.setProperty("font-weight","bold"),a(I,()=>c(q)),F.style.setProperty("padding","0.75rem"),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","#6c757d"),a(F,()=>k.notes||"-"),Se(Q=>(Q=(k.quantity||0)>=0?"#22c55e":"#ef4444")!=null?D.style.setProperty("color",Q):D.style.removeProperty("color")),O})()}})),Z})()]}})}}),null),Se(()=>P.value=i()),g})()};yr(["click"]);var dT=he("<div><div><div><h2>Bulk Movement Report - </h2><button>×</button></div><div>");const hT=t=>{const[e,r]=Ce(!0),[n,i]=Ce(!1),[o,s]=Ce([]),[l,c]=Ce(""),u=g=>{const f=ct.movements.filter(x=>x.referenceNumber===g||x.invoiceId===g||x.ssg_inventory_key===g);s(f),c(g),r(!1),i(!0)},h=()=>{r(!1),t.onClose()},y=()=>{i(!1),t.onClose()};return[M(Ge,{get when(){return e()},get children(){return M(ZE,{get isOpen(){return Ee(()=>!!t.isOpen)()&&e()},onClose:h,onMovementComplete:u})}}),M(Ge,{get when(){return n()},get children(){var g=dT(),f=g.firstChild,x=f.firstChild,S=x.firstChild;S.firstChild;var P=S.nextSibling,$=x.nextSibling;return g.style.setProperty("position","fixed"),g.style.setProperty("top","0"),g.style.setProperty("left","0"),g.style.setProperty("right","0"),g.style.setProperty("bottom","0"),g.style.setProperty("background","rgba(0, 0, 0, 0.5)"),g.style.setProperty("z-index","1000"),g.style.setProperty("display","flex"),g.style.setProperty("align-items","center"),g.style.setProperty("justify-content","center"),g.style.setProperty("padding","2rem"),f.style.setProperty("background","white"),f.style.setProperty("border-radius","var(--border-radius)"),f.style.setProperty("width","95%"),f.style.setProperty("max-width","1200px"),f.style.setProperty("max-height","90vh"),f.style.setProperty("overflow-y","auto"),f.style.setProperty("position","relative"),x.style.setProperty("padding","1rem 2rem"),x.style.setProperty("border-bottom","1px solid #e9ecef"),x.style.setProperty("display","flex"),x.style.setProperty("justify-content","space-between"),x.style.setProperty("align-items","center"),x.style.setProperty("background","#f8f9fa"),S.style.setProperty("margin","0"),a(S,l,null),P.$$click=y,P.style.setProperty("background","none"),P.style.setProperty("border","none"),P.style.setProperty("font-size","1.5rem"),P.style.setProperty("cursor","pointer"),P.style.setProperty("padding","0.5rem"),P.style.setProperty("line-height","1"),$.style.setProperty("padding","1rem"),a($,M(T5,{get movements(){return o()},onClose:y})),g}})]};yr(["click"]);var pT=he("<div><div></div><div></div><div></div><div>"),fT=he("<div><strong>:</strong> "),mT=he("<div><div><span></span><span></span></div><div><span></span><span> </span></div><div><span></span><span> </span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),yT=he("<div>");const gT=t=>{const{t:e}=sr(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={"text-align":"center","margin-bottom":"2rem"},s={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},l={color:"var(--text-muted)","font-size":"1rem"},c={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"1rem"},u=(S,P)=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:S>P?"#d4edda":"#f8d7da",color:S>P?"#155724":"#721c24"}),h={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},y={"margin-bottom":"1.5rem",padding:"1rem",background:"var(--background-color)","border-radius":"var(--border-radius-sm)",color:"var(--text-secondary)"};if(!t.item)return null;const g=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(S),f=S=>new Date(S).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),x=t.item.price*t.item.quantity;return M(Fn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.itemDetails")},get children(){return[(()=>{var S=pT(),P=S.firstChild,$=P.nextSibling,U=$.nextSibling,se=U.nextSibling;return m(S,o),m(P,s),a(P,()=>t.item.name),m($,l),a($,()=>t.item.category),m(U,c),a(U,()=>g(t.item.price)),a(se,(()=>{var X=Ee(()=>t.item.quantity>t.item.minStock);return()=>X()?e("inventory.inStock"):e("inventory.lowStockAlert")})()),Se(X=>m(se,u(t.item.quantity,t.item.minStock),X)),S})(),(()=>{var S=fT(),P=S.firstChild,$=P.firstChild;return P.nextSibling,m(S,y),a(P,()=>e("common.description"),$),a(S,()=>t.item.description,null),S})(),(()=>{var S=mT(),P=S.firstChild,$=P.firstChild,U=$.nextSibling,se=P.nextSibling,X=se.firstChild,Z=X.nextSibling,re=Z.firstChild,E=se.nextSibling,C=E.firstChild,T=C.nextSibling,j=T.firstChild,b=E.nextSibling,w=b.firstChild,_=w.nextSibling,W=b.nextSibling,K=W.firstChild,k=K.nextSibling,R=W.nextSibling,Y=R.firstChild,q=Y.nextSibling,O=R.nextSibling,le=O.firstChild,N=le.nextSibling;return a($,()=>e("inventory.sku")),a(U,()=>t.item.sku),a(X,()=>e("inventory.quantity")),a(Z,()=>t.item.quantity,re),a(Z,()=>e("common.units"),null),a(C,()=>e("inventory.minimumStock")),a(T,()=>t.item.minStock,j),a(T,()=>e("common.units"),null),a(w,()=>e("inventory.totalValue")),a(_,()=>g(x)),a(K,()=>e("inventory.supplier")),a(k,()=>t.item.supplier),a(Y,()=>e("inventory.location")),a(q,()=>t.item.location),a(le,()=>e("common.lastUpdated")),a(N,()=>f(t.item.lastUpdated)),Se(D=>{var V=r,I=n,F=i,Q=r,H=n,J=i,te=r,ee=n,ne=i,G=r,ce=n,oe=i,z=r,de=n,fe=i,ue=r,ge=n,xe=i,pe=r,_e=n,Le=i;return D.e=m(P,V,D.e),D.t=m($,I,D.t),D.a=m(U,F,D.a),D.o=m(se,Q,D.o),D.i=m(X,H,D.i),D.n=m(Z,J,D.n),D.s=m(E,te,D.s),D.h=m(C,ee,D.h),D.r=m(T,ne,D.r),D.d=m(b,G,D.d),D.l=m(w,ce,D.l),D.u=m(_,oe,D.u),D.c=m(W,z,D.c),D.w=m(K,de,D.w),D.m=m(k,fe,D.m),D.f=m(R,ue,D.f),D.y=m(Y,ge,D.y),D.g=m(q,xe,D.g),D.p=m(O,pe,D.p),D.b=m(le,_e,D.b),D.T=m(N,Le,D.T),D},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),S})(),(()=>{var S=yT();return m(S,h),a(S,M(dt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(S,M(dt,{variant:"primary",onClick:()=>{console.log("Edit item:",t.item.id)},get children(){return e("common.editItem")}}),null),S})()]}})};var vT=he("<div>🔄"),bT=he("<button type=button>×"),_T=he("<div>⚠️ "),v0=he("<div>"),ST=he("<div><div><input type=text autocomplete=off>"),PT=he("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),wT=he("<span>⚠️ ");const xT=t=>{const{t:e}=sr(),[r,n]=Ce(""),[i,o]=Ce(!1),[s,l]=Ce(null),[c,u]=Ce([]),[h,y]=Ce(!1),[g,f]=Ce(-1),[x,S]=Ce(null),P=t.searchDelay||300;t.maxResults;const $=async V=>{if(!V.trim()||V.trim().length<3){u([]),t.onSearchResults?.([]);return}try{o(!0),l(null);try{console.log("apiResults",V),t.onSearchResults?.(V)}catch(I){console.warn("API search failed, using local fallback:",I),l("API search failed, showing local results")}}catch(I){const F=I instanceof Error?I.message:"Search failed";l(F),u([]),t.onSearchResults?.([])}finally{o(!1)}},U=V=>{const F=V.target.value;n(F),l(null),console.log(),t.showResults,x()&&clearTimeout(x());const Q=setTimeout(()=>{$(F)},P);S(Q)},se=V=>{n(V.name),y(!1),f(-1),t.onInventorySelect?.(V)},X=V=>{if(!(!h()||c().length===0))switch(V.key){case"ArrowDown":V.preventDefault(),f(I=>Math.min(I+1,c().length-1));break;case"ArrowUp":V.preventDefault(),f(I=>Math.max(I-1,-1));break;case"Enter":V.preventDefault(),g()>=0&&c()[g()]&&se(c()[g()]);break;case"Escape":y(!1),f(-1);break}},Z=()=>{t.showResults!==!1&&c().length>0&&y(!0)},re=()=>{setTimeout(()=>{y(!1),f(-1)},150)},E=()=>{n(""),u([]),l(null),y(!1),f(-1),t.onSearchResults?.([]),x()&&(clearTimeout(x()),S(null))},C=V=>ct.stockLevels.filter(I=>I.inventoryId===V).reduce((I,F)=>I+F.quantity,0),T=V=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(V),j={position:"relative",width:"100%",...t.style},b={position:"relative",display:"flex","align-items":"center"},w={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},_={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},W={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},K={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},k=V=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:V?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),R={display:"flex","justify-content":"space-between","align-items":"center"},Y={flex:"1"},q={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},O={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},le={"text-align":"right","font-size":"0.875rem"},N={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},D={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var V=ST(),I=V.firstChild,F=I.firstChild;return F.addEventListener("blur",re),F.addEventListener("focus",Z),F.$$keydown=X,F.$$input=U,a(I,M(Ge,{get when(){return i()},get children(){var Q=vT();return Se(H=>m(Q,W,H)),Q}}),null),a(I,M(Ge,{get when(){return Ee(()=>!!r())()&&!i()},get children(){var Q=bT();return Q.addEventListener("mouseleave",H=>{H.currentTarget.style.background="none",H.currentTarget.style.color="var(--text-muted)"}),Q.addEventListener("mouseenter",H=>{H.currentTarget.style.background="var(--border-color)",H.currentTarget.style.color="var(--text-primary)"}),Q.$$click=E,Se(H=>{var J=_,te=e("common.clear","Clear search");return H.e=m(Q,J,H.e),te!==H.t&&nr(Q,"title",H.t=te),H},{e:void 0,t:void 0}),Q}}),null),a(V,M(Ge,{get when(){return h()&&t.showResults!==!1},get children(){var Q=v0();return a(Q,M(Ge,{get when(){return s()},get children(){var H=_T();return H.firstChild,m(H,D),a(H,s,null),H}}),null),a(Q,M(Ge,{get when(){return c().length>0},get fallback(){return Ee(()=>!!(r()&&!i()))()&&(()=>{var H=v0();return m(H,N),a(H,()=>e("inventory.noInventorysFound","No inventorys found matching your search.")),H})()},get children(){return M(Ht,{get each(){return c()},children:(H,J)=>{const te=C(H.id),ee=te<=H.minStockLevel;return(()=>{var ne=PT(),G=ne.firstChild,ce=G.firstChild,oe=ce.firstChild,z=oe.nextSibling,de=z.firstChild,fe=de.firstChild,ue=de.nextSibling,ge=ue.nextSibling,xe=ge.nextSibling,pe=xe.nextSibling,_e=ce.nextSibling,Le=_e.firstChild,De=Le.firstChild,Te=Le.nextSibling;return ne.addEventListener("mouseenter",()=>f(J())),ne.$$click=()=>se(H),m(G,R),m(ce,Y),m(oe,q),a(oe,()=>H.name),m(z,O),a(de,()=>e("inventory.sku","SKU"),fe),a(de,()=>H.sku,null),a(ge,()=>H.category),a(pe,()=>T(H.unitCost)),m(_e,le),Le.style.setProperty("font-weight","600"),(ee?"#f44336":"var(--text-primary)")!=null?Le.style.setProperty("color",ee?"#f44336":"var(--text-primary)"):Le.style.removeProperty("color"),a(Le,te,De),a(Le,()=>H.unitOfMeasure,null),Te.style.setProperty("color","var(--text-muted)"),a(Te,()=>ee?(()=>{var $e=wT();return $e.firstChild,$e.style.setProperty("color","#f44336"),a($e,()=>e("inventory.lowStock","Low Stock"),null),$e})():e("inventory.inStock","In Stock")),Se($e=>m(ne,k(J()===g()),$e)),ne})()}})}}),null),Se(H=>m(Q,K,H)),Q}}),null),Se(Q=>{var H=j,J=b,te=w,ee=t.placeholder||e("inventory.searchInventorys","Search inventorys by name, SKU, or category..."),ne=t.disabled;return Q.e=m(V,H,Q.e),Q.t=m(I,J,Q.t),Q.a=m(F,te,Q.a),ee!==Q.o&&nr(F,"placeholder",Q.o=ee),ne!==Q.i&&(F.disabled=Q.i=ne),Q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>F.value=r()),V})()};yr(["input","keydown","click"]);var AT=he("<div>"),af=he("<div><span>:</span><span>"),CT=he("<div><button> "),IT=he("<div><div><div><h3></h3><div>: </div></div><div><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span> </span></div><div><span>:</span><span></span></div><div><span> <!>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div></div><div><h4></h4><div><span>:</span><span></span></div><div><span>:</span><span>");const $T=t=>{const{t:e}=sr(),r=f=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(f),n=f=>new Date(f).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),i=f=>({in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}})[f]||{bg:"#f5f5f5",color:"#666"},o=f=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[f]||"📋",s=()=>t.movement,l={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},c={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},u={"font-weight":"600",color:"var(--text-primary)","text-align":"right"},h={"margin-bottom":"1.5rem"},y={"font-weight":"600","margin-bottom":"0.75rem","padding-bottom":"0.5rem","border-bottom":"2px solid var(--border-color)"},g=f=>({display:"inline-flex","align-items":"center",gap:"0.5rem",padding:"0.5rem 1rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"600","text-transform":"uppercase","letter-spacing":"0.5px",background:i(f).bg,color:i(f).color});return M(Fn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("inventory.movementDetails")},size:"lg",get children(){return M(Ge,{get when(){return s()},get fallback(){return(()=>{var f=AT();return a(f,()=>e("common.noDataFound")),f})()},children:f=>(()=>{var x=IT(),S=x.firstChild,P=S.firstChild,$=P.firstChild,U=$.nextSibling,se=U.firstChild,X=P.nextSibling,Z=X.firstChild,re=S.nextSibling,E=re.firstChild,C=E.nextSibling,T=C.firstChild,j=T.firstChild,b=T.nextSibling,w=C.nextSibling,_=w.firstChild,W=_.firstChild,K=_.nextSibling,k=K.firstChild,R=w.nextSibling,Y=R.firstChild,q=Y.firstChild,O=Y.nextSibling,le=R.nextSibling,N=le.firstChild,D=N.firstChild,V=D.nextSibling;V.nextSibling;var I=N.nextSibling,F=re.nextSibling,Q=F.firstChild,H=Q.nextSibling,J=H.firstChild,te=J.firstChild,ee=J.nextSibling,ne=F.nextSibling,G=ne.firstChild,ce=G.nextSibling,oe=ce.firstChild,z=oe.firstChild,de=oe.nextSibling,fe=ce.nextSibling,ue=fe.firstChild,ge=ue.firstChild,xe=ue.nextSibling;return S.style.setProperty("display","flex"),S.style.setProperty("justify-content","space-between"),S.style.setProperty("align-items","center"),S.style.setProperty("margin-bottom","1.5rem"),S.style.setProperty("padding-bottom","1rem"),S.style.setProperty("border-bottom","2px solid var(--border-color)"),$.style.setProperty("margin","0 0 0.5rem 0"),$.style.setProperty("font-size","1.25rem"),a($,()=>f().productName),U.style.setProperty("font-size","0.875rem"),U.style.setProperty("color","var(--text-muted)"),a(U,()=>e("inventory.sku"),se),a(U,()=>f().productSku,null),X.$$click=()=>ct.generateMovementInvoice(f().id,e),Z.style.setProperty("font-size","1.2rem"),a(Z,()=>o(f().movementType)),a(X,()=>f().movementType,null),a(E,()=>e("inventory.movementInformation")),a(T,()=>e("inventory.referenceNumber"),j),a(b,()=>f().referenceNumber),a(_,()=>e("common.quantity"),W),a(K,()=>f().quantity,k),a(K,()=>e("common.units"),null),a(Y,()=>e("inventory.unitCost"),q),a(O,()=>r(f().unitCost)),a(N,()=>e("common.total"),D),a(N,()=>e("common.value"),V),a(I,()=>r(f().totalCost)),a(Q,()=>e("inventory.locationInformation")),a(J,()=>e("inventory.location"),te),a(ee,()=>f().locationName),a(F,M(Ge,{get when(){return f().fromLocationName},get children(){var pe=af(),_e=pe.firstChild,Le=_e.firstChild,De=_e.nextSibling;return a(_e,()=>e("common.from"),Le),a(De,()=>f().fromLocationName),Se(Te=>{var $e=l,Ie=c,Re=u;return Te.e=m(pe,$e,Te.e),Te.t=m(_e,Ie,Te.t),Te.a=m(De,Re,Te.a),Te},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(F,M(Ge,{get when(){return f().invoiceId},get children(){var pe=af(),_e=pe.firstChild,Le=_e.firstChild,De=_e.nextSibling;return a(_e,()=>e("common.invoice"),Le),a(De,()=>f().invoiceId),Se(Te=>{var $e=l,Ie=c,Re={...u,color:"var(--primary-color)"};return Te.e=m(pe,$e,Te.e),Te.t=m(_e,Ie,Te.t),Te.a=m(De,Re,Te.a),Te},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(G,()=>e("common.details")),a(oe,()=>e("common.createdBy"),z),a(de,()=>f().createdBy),a(ue,()=>e("common.created"),ge),a(xe,()=>n(f().createdDate)),a(ne,M(Ge,{get when(){return f().notes},get children(){var pe=af(),_e=pe.firstChild,Le=_e.firstChild,De=_e.nextSibling;return a(_e,()=>e("common.notes"),Le),a(De,()=>f().notes),Se(Te=>{var $e={...l,"border-bottom":"none"},Ie=c,Re={...u,"font-style":"italic","max-width":"60%","white-space":"pre-wrap"};return Te.e=m(pe,$e,Te.e),Te.t=m(_e,Ie,Te.t),Te.a=m(De,Re,Te.a),Te},{e:void 0,t:void 0,a:void 0}),pe}}),null),a(x,M(Ge,{get when(){return t.onEdit},get children(){var pe=CT(),_e=pe.firstChild,Le=_e.firstChild;return pe.style.setProperty("display","flex"),pe.style.setProperty("justify-content","flex-end"),pe.style.setProperty("margin-top","1.5rem"),pe.style.setProperty("padding-top","1rem"),pe.style.setProperty("border-top","1px solid var(--border-color)"),_e.addEventListener("mouseleave",De=>{De.currentTarget.style.transform="translateY(0)",De.currentTarget.style.boxShadow="none"}),_e.addEventListener("mouseenter",De=>{De.currentTarget.style.transform="translateY(-1px)",De.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)"}),_e.$$click=()=>t.onEdit?.(f()),_e.style.setProperty("padding","0.5rem 1.5rem"),_e.style.setProperty("border-radius","var(--border-radius-sm)"),_e.style.setProperty("border","1px solid var(--primary-color)"),_e.style.setProperty("background","var(--primary-color)"),_e.style.setProperty("color","white"),_e.style.setProperty("cursor","pointer"),_e.style.setProperty("font-weight","500"),_e.style.setProperty("transition","all 0.2s ease"),a(_e,()=>e("common.edit"),Le),a(_e,()=>e("inventory.movement"),null),pe}}),null),Se(pe=>{var _e=g(f().movementType),Le=h,De=y,Te=l,$e=c,Ie=u,Re=l,Ke=c,je={...u,"font-size":"1.1rem",color:"var(--primary-color)"},We=l,Qe=c,at=u,nt=l,Ye=c,ht={...u,"font-size":"1.1rem",color:"var(--primary-color)"},lt=h,$t=y,_t=l,ze=c,Lt=u,Nt=h,wt=y,Ot=l,gr=c,Be=u,Pt=l,Ct=c,tt=u;return pe.e=m(X,_e,pe.e),pe.t=m(re,Le,pe.t),pe.a=m(E,De,pe.a),pe.o=m(C,Te,pe.o),pe.i=m(T,$e,pe.i),pe.n=m(b,Ie,pe.n),pe.s=m(w,Re,pe.s),pe.h=m(_,Ke,pe.h),pe.r=m(K,je,pe.r),pe.d=m(R,We,pe.d),pe.l=m(Y,Qe,pe.l),pe.u=m(O,at,pe.u),pe.c=m(le,nt,pe.c),pe.w=m(N,Ye,pe.w),pe.m=m(I,ht,pe.m),pe.f=m(F,lt,pe.f),pe.y=m(Q,$t,pe.y),pe.g=m(H,_t,pe.g),pe.p=m(J,ze,pe.p),pe.b=m(ee,Lt,pe.b),pe.T=m(ne,Nt,pe.T),pe.A=m(G,wt,pe.A),pe.O=m(ce,Ot,pe.O),pe.I=m(oe,gr,pe.I),pe.S=m(de,Be,pe.S),pe.W=m(fe,Pt,pe.W),pe.C=m(ue,Ct,pe.C),pe.B=m(xe,tt,pe.B),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0}),x})()})}})};yr(["click"]);var Za=he("<div>"),ET=he("<div><label></label><select><option value>"),TT=he("<div><div><span>:</span><span>$"),kT=he("<form><div><label></label><select><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><input type=number min=0.01 step=0.01></div><div><label></label><input type=number min=0 step=0.01></div><div><label></label><input type=text></div><div><label> (<!>)</label><input type=text></div><div><label> (<!>)</label><textarea></textarea></div><div><button type=button></button><button type=submit>"),b0=he("<option> (<!>)");const NT=t=>{const{t:e}=sr(),[r,n]=Ce("in"),[i,o]=Ce(""),[s,l]=Ce(""),[c,u]=Ce(""),[h,y]=Ce(""),[g,f]=Ce(""),[x,S]=Ce(""),[P,$]=Ce(""),[U,se]=Ce(!1),[X,Z]=Ce({});yi(()=>{const W=t.movement;W&&t.isOpen&&(n(W.movementType),o(W.quantity.toString()),l(W.unitCost.toString()),u(W.referenceNumber),y(W.notes),S(W.locationId),f(W.fromLocationId||""),$(W.invoiceId||""),Z({}))});const re=()=>{const W={};return(!i()||parseFloat(i())<=0)&&(W.quantity=e("forms.requiredField")),(!s()||parseFloat(s())<0)&&(W.unitCost=e("forms.requiredField")),c().trim()||(W.referenceNumber=e("forms.requiredField")),x()||(W.locationId=e("forms.requiredField")),r()==="transfer"&&!g()&&(W.fromLocationId=e("forms.requiredField")),Z(W),Object.keys(W).length===0},E=async W=>{if(W.preventDefault(),!(!re()||!t.movement)){se(!0);try{const K=t.movement,k=ct.getProductById(K.productId),R=ct.getLocationById(x()),Y=g()?ct.getLocationById(g()):null;if(!k||!R)throw new Error("Product or location not found");const q={...K,movementType:r(),quantity:parseFloat(i()),unitCost:parseFloat(s()),totalCost:parseFloat(i())*parseFloat(s()),referenceNumber:c().trim(),notes:h().trim(),locationId:x(),locationName:R.name,fromLocationId:g()||void 0,fromLocationName:Y?.name,invoiceId:P().trim()||void 0,lastModified:new Date().toISOString()};ct.updateMovement(K.id,q),t.onMovementUpdated?.(),t.onClose(),C()}catch(K){console.error("Error updating movement:",K),Z({submit:e("forms.saveError")})}finally{se(!1)}}},C=()=>{n("in"),o(""),l(""),u(""),y(""),f(""),S(""),$(""),Z({})},T=()=>{C(),t.onClose()},j={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",transition:"border-color 0.2s ease"},b={display:"block","margin-bottom":"0.25rem","font-weight":"500","font-size":"0.875rem"},w={color:"#d32f2f","font-size":"0.75rem","margin-top":"0.25rem"},_={"margin-bottom":"1rem"};return M(Fn,{get isOpen(){return t.isOpen},onClose:T,get title(){return e("inventory.editMovement","Edit Movement")},get children(){return M(Ge,{get when(){return t.movement},get fallback(){return(()=>{var W=Za();return a(W,()=>e("common.loading")),W})()},get children(){var W=kT(),K=W.firstChild,k=K.firstChild,R=k.nextSibling,Y=R.firstChild,q=Y.nextSibling,O=q.nextSibling,le=O.nextSibling,N=K.nextSibling,D=N.firstChild,V=D.nextSibling,I=V.firstChild,F=N.nextSibling,Q=F.firstChild,H=Q.nextSibling,J=F.nextSibling,te=J.firstChild,ee=te.nextSibling,ne=J.nextSibling,G=ne.firstChild,ce=G.nextSibling,oe=ne.nextSibling,z=oe.firstChild,de=z.firstChild,fe=de.nextSibling;fe.nextSibling;var ue=z.nextSibling,ge=oe.nextSibling,xe=ge.firstChild,pe=xe.firstChild,_e=pe.nextSibling;_e.nextSibling;var Le=xe.nextSibling,De=ge.nextSibling,Te=De.firstChild,$e=Te.nextSibling;return W.addEventListener("submit",E),a(k,()=>e("inventory.movementType")),R.addEventListener("change",Ie=>n(Ie.target.value)),a(Y,()=>e("inventory.stockIn")),a(q,()=>e("inventory.stockOut")),a(O,()=>e("inventory.transfer")),a(le,()=>e("inventory.adjustment")),a(D,(()=>{var Ie=Ee(()=>r()==="transfer");return()=>Ie()?e("inventory.toLocation"):e("inventory.location")})()),V.addEventListener("change",Ie=>S(Ie.target.value)),a(I,()=>e("modals.selectLocation")),a(V,M(Ht,{get each(){return ct.getActiveLocations()},children:Ie=>(()=>{var Re=b0(),Ke=Re.firstChild,je=Ke.nextSibling;return je.nextSibling,a(Re,()=>Ie.name,Ke),a(Re,()=>Ie.type,je),Se(()=>Re.value=Ie.id),Re})()}),null),a(N,M(Ge,{get when(){return X().locationId},get children(){var Ie=Za();return a(Ie,()=>X().locationId),Se(Re=>m(Ie,w,Re)),Ie}}),null),a(W,M(Ge,{get when(){return r()==="transfer"},get children(){var Ie=ET(),Re=Ie.firstChild,Ke=Re.nextSibling,je=Ke.firstChild;return a(Re,()=>e("inventory.fromLocation")),Ke.addEventListener("change",We=>f(We.target.value)),a(je,()=>e("modals.selectLocation")),a(Ke,M(Ht,{get each(){return ct.getActiveLocations().filter(We=>We.id!==x())},children:We=>(()=>{var Qe=b0(),at=Qe.firstChild,nt=at.nextSibling;return nt.nextSibling,a(Qe,()=>We.name,at),a(Qe,()=>We.type,nt),Se(()=>Qe.value=We.id),Qe})()}),null),a(Ie,M(Ge,{get when(){return X().fromLocationId},get children(){var We=Za();return a(We,()=>X().fromLocationId),Se(Qe=>m(We,w,Qe)),We}}),null),Se(We=>{var Qe=_,at=b,nt={...j,"border-color":X().fromLocationId?"#d32f2f":"var(--border-color)"},Ye=U();return We.e=m(Ie,Qe,We.e),We.t=m(Re,at,We.t),We.a=m(Ke,nt,We.a),Ye!==We.o&&(Ke.disabled=We.o=Ye),We},{e:void 0,t:void 0,a:void 0,o:void 0}),Se(()=>Ke.value=g()),Ie}}),F),a(Q,()=>e("common.quantity")),H.$$input=Ie=>o(Ie.target.value),a(F,M(Ge,{get when(){return X().quantity},get children(){var Ie=Za();return a(Ie,()=>X().quantity),Se(Re=>m(Ie,w,Re)),Ie}}),null),a(te,()=>e("inventory.unitCost")),ee.$$input=Ie=>l(Ie.target.value),a(J,M(Ge,{get when(){return X().unitCost},get children(){var Ie=Za();return a(Ie,()=>X().unitCost),Se(Re=>m(Ie,w,Re)),Ie}}),null),a(W,M(Ge,{get when(){return Ee(()=>!!i())()&&s()},get children(){var Ie=TT(),Re=Ie.firstChild,Ke=Re.firstChild,je=Ke.firstChild,We=Ke.nextSibling;return We.firstChild,Re.style.setProperty("display","flex"),Re.style.setProperty("justify-content","space-between"),Ke.style.setProperty("font-weight","500"),a(Ke,()=>e("common.total"),je),We.style.setProperty("font-weight","600"),We.style.setProperty("color","var(--primary-color)"),a(We,()=>(parseFloat(i()||"0")*parseFloat(s()||"0")).toFixed(2),null),Se(Qe=>m(Ie,{..._,padding:"0.75rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)"},Qe)),Ie}}),ne),a(G,()=>e("inventory.referenceNumber")),ce.$$input=Ie=>u(Ie.target.value),a(ne,M(Ge,{get when(){return X().referenceNumber},get children(){var Ie=Za();return a(Ie,()=>X().referenceNumber),Se(Re=>m(Ie,w,Re)),Ie}}),null),a(z,()=>e("inventory.invoiceNumber"),de),a(z,()=>e("common.optional"),fe),ue.$$input=Ie=>$(Ie.target.value),a(xe,()=>e("common.notes"),pe),a(xe,()=>e("common.optional"),_e),Le.$$input=Ie=>y(Ie.target.value),a(W,M(Ge,{get when(){return X().submit},get children(){var Ie=Za();return a(Ie,()=>X().submit),Se(Re=>m(Ie,{...w,"margin-bottom":"1rem"},Re)),Ie}}),De),De.style.setProperty("display","flex"),De.style.setProperty("gap","1rem"),De.style.setProperty("justify-content","flex-end"),Te.$$click=T,Te.style.setProperty("padding","0.5rem 1rem"),Te.style.setProperty("border","1px solid var(--border-color)"),Te.style.setProperty("border-radius","var(--border-radius-sm)"),Te.style.setProperty("background","white"),Te.style.setProperty("cursor","pointer"),a(Te,()=>e("common.cancel")),$e.style.setProperty("padding","0.5rem 1rem"),$e.style.setProperty("border","none"),$e.style.setProperty("border-radius","var(--border-radius-sm)"),$e.style.setProperty("background","var(--primary-color)"),$e.style.setProperty("color","white"),$e.style.setProperty("cursor","pointer"),$e.style.setProperty("font-weight","500"),a($e,(()=>{var Ie=Ee(()=>!!U());return()=>Ie()?e("modals.processing"):e("inventory.updateMovement","Update Movement")})()),Se(Ie=>{var Re=_,Ke=b,je=j,We=U(),Qe=_,at=b,nt={...j,"border-color":X().locationId?"#d32f2f":"var(--border-color)"},Ye=U(),ht=_,lt=b,$t={...j,"border-color":X().quantity?"#d32f2f":"var(--border-color)"},_t=e("modals.enterQuantity"),ze=U(),Lt=_,Nt=b,wt={...j,"border-color":X().unitCost?"#d32f2f":"var(--border-color)"},Ot=e("modals.enterCost"),gr=U(),Be=_,Pt=b,Ct={...j,"border-color":X().referenceNumber?"#d32f2f":"var(--border-color)"},tt=e("modals.enterReference"),ft=U(),Vt=_,Rt=b,rr=j,it=e("inventory.invoiceNumber"),yt=U(),It=_,Jt=b,Je={...j,resize:"vertical","min-height":"80px"},Et=e("modals.addNotes"),Wt=U(),Yt=U(),er=U();return Ie.e=m(K,Re,Ie.e),Ie.t=m(k,Ke,Ie.t),Ie.a=m(R,je,Ie.a),We!==Ie.o&&(R.disabled=Ie.o=We),Ie.i=m(N,Qe,Ie.i),Ie.n=m(D,at,Ie.n),Ie.s=m(V,nt,Ie.s),Ye!==Ie.h&&(V.disabled=Ie.h=Ye),Ie.r=m(F,ht,Ie.r),Ie.d=m(Q,lt,Ie.d),Ie.l=m(H,$t,Ie.l),_t!==Ie.u&&nr(H,"placeholder",Ie.u=_t),ze!==Ie.c&&(H.disabled=Ie.c=ze),Ie.w=m(J,Lt,Ie.w),Ie.m=m(te,Nt,Ie.m),Ie.f=m(ee,wt,Ie.f),Ot!==Ie.y&&nr(ee,"placeholder",Ie.y=Ot),gr!==Ie.g&&(ee.disabled=Ie.g=gr),Ie.p=m(ne,Be,Ie.p),Ie.b=m(G,Pt,Ie.b),Ie.T=m(ce,Ct,Ie.T),tt!==Ie.A&&nr(ce,"placeholder",Ie.A=tt),ft!==Ie.O&&(ce.disabled=Ie.O=ft),Ie.I=m(oe,Vt,Ie.I),Ie.S=m(z,Rt,Ie.S),Ie.W=m(ue,rr,Ie.W),it!==Ie.C&&nr(ue,"placeholder",Ie.C=it),yt!==Ie.B&&(ue.disabled=Ie.B=yt),Ie.v=m(ge,It,Ie.v),Ie.k=m(xe,Jt,Ie.k),Ie.x=m(Le,Je,Ie.x),Et!==Ie.j&&nr(Le,"placeholder",Ie.j=Et),Wt!==Ie.q&&(Le.disabled=Ie.q=Wt),Yt!==Ie.z&&(Te.disabled=Ie.z=Yt),er!==Ie.P&&($e.disabled=Ie.P=er),Ie},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0,x:void 0,j:void 0,q:void 0,z:void 0,P:void 0}),Se(()=>R.value=r()),Se(()=>V.value=x()),Se(()=>H.value=i()),Se(()=>ee.value=s()),Se(()=>ce.value=c()),Se(()=>ue.value=P()),Se(()=>Le.value=h()),W}})}})};yr(["input","click"]);var LT=he("<div><div></div><div><div><label></label><select><option value=all></option><option value=in></option><option value=out></option><option value=transfer></option><option value=adjustment></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),RT=he("<div><h2>"),DT=he("<div><label>"),MT=he("<div><label></label><select><option value>"),FT=he("<option>"),OT=he("<div><div>📦</div><div></div><div>"),BT=he("<div><div><div><div><span></span><h3></h3><span></span></div><div> • </div></div><div><div></div><div> <!> @ </div></div></div><div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div><span>:</span><span>"),jT=he("<span>"),VT=he("<span>• <!>: "),_0=he("<div><span>:</span><span>"),qT=he("<div><div><span>:</span><select><option value=10>10</option><option value=25>25</option><option value=50>50</option><option value=100>100</option></select><span></span></div><div><div><span>:</span><input type=number min=1><span> "),zT=he("<span>..."),UT=he("<button>");const HT=t=>{const{t:e}=sr(),[r,n]=Ce(""),[i,o]=Ce(""),[s,l]=Ce("all"),[c,u]=Ce({start:"",end:""}),[h,y]=Ce(""),[g,f]=Ce(""),[x,S]=Ce(1),[P,$]=Ce(25),[U,se]=Ce(null),[X,Z]=Ce(!1),[re,E]=Ce(!1),C=Dt(()=>{let ue=ct.movements;if(t.filterBy==="product"&&t.filterId?ue=ue.filter(ge=>ge.productId===t.filterId):t.filterBy==="location"&&t.filterId&&(ue=ue.filter(ge=>ge.locationId===t.filterId)),r()&&(ue=ue.filter(ge=>ge.productId===r())),i()&&(ue=ue.filter(ge=>ge.locationId===i())),s()!=="all"&&(ue=ue.filter(ge=>ge.movementType===s())),c().start&&(ue=ue.filter(ge=>ge.createdDate>=c().start)),c().end&&(ue=ue.filter(ge=>ge.createdDate<=c().end+"T23:59:59Z")),h()){const ge=h().toLowerCase();ue=ue.filter(xe=>xe.productName.toLowerCase().includes(ge)||xe.productSku.toLowerCase().includes(ge)||xe.locationName.toLowerCase().includes(ge)||xe.referenceNumber.toLowerCase().includes(ge)||xe.notes.toLowerCase().includes(ge)||xe.createdBy.toLowerCase().includes(ge)||xe.invoiceId&&xe.invoiceId.toLowerCase().includes(ge)||xe.fromLocationName&&xe.fromLocationName.toLowerCase().includes(ge)||xe.movementType.toLowerCase().includes(ge))}return ue.sort((ge,xe)=>new Date(xe.createdDate).getTime()-new Date(ge.createdDate).getTime())});yi(()=>{r(),i(),s(),c(),h(),S(1)});const T=Dt(()=>{const ue=(x()-1)*P(),ge=ue+P();return C().slice(ue,ge)}),j=Dt(()=>Math.ceil(C().length/P())),b=Dt(()=>{const ue=C();return{total:ue.length,stockIn:ue.filter(ge=>ge.movementType==="in").length,stockOut:ue.filter(ge=>ge.movementType==="out").length,transfers:ue.filter(ge=>ge.movementType==="transfer").length,adjustments:ue.filter(ge=>ge.movementType==="adjustment").length,totalValue:ue.reduce((ge,xe)=>ge+xe.totalCost,0)}}),w={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},_={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},W={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)",cursor:"pointer"},K={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},k={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem","margin-bottom":"2rem"},R={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","text-align":"center"},Y={"font-size":"1.5rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},q={"font-size":"0.875rem",color:"var(--text-muted)","font-weight":"500"},O={padding:"1.5rem","margin-bottom":"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",transition:"all 0.2s ease"},le={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"1rem"};function N(ue){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[ue]||{bg:"#f5f5f5",color:"#666"}}const D=ue=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:N(ue).bg,color:N(ue).color}),V={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"1rem"},I={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},F={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},Q={"font-weight":"600",color:"var(--text-primary)"},H={display:"flex","justify-content":"space-between","align-items":"center","margin-top":"2rem",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},J=ue=>({padding:"0.25rem 0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:ue?"var(--primary-color)":"var(--surface-color)",color:ue?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),te=ue=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ue),ee=ue=>new Date(ue).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ne=ue=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[ue]||"📋",G=()=>{n(""),o(""),l("all"),u({start:"",end:""}),y(""),S(1)},ce=ue=>{se(ue),Z(!0)},oe=ue=>{se(ue),Z(!1),E(!0)},z=()=>{E(!1),se(null)},de=async ue=>{i()&&(ue+=" "+i()),Yf(s())&&(ue+=" "+Yf(s()));const ge=await gi.getInventory(ue),xe=ct.parseInventoryData(ge);ct.updMovements(xe)},fe=()=>{};return(()=>{var ue=LT(),ge=ue.firstChild,xe=ge.nextSibling,pe=xe.firstChild,_e=pe.firstChild,Le=_e.nextSibling,De=Le.firstChild,Te=De.nextSibling,$e=Te.nextSibling,Ie=$e.nextSibling,Re=Ie.nextSibling,Ke=pe.nextSibling,je=Ke.firstChild,We=je.nextSibling,Qe=Ke.nextSibling,at=Qe.firstChild,nt=at.nextSibling,Ye=xe.nextSibling,ht=Ye.firstChild,lt=ht.firstChild,$t=lt.nextSibling,_t=ht.nextSibling,ze=_t.firstChild,Lt=ze.nextSibling,Nt=_t.nextSibling,wt=Nt.firstChild,Ot=wt.nextSibling,gr=Nt.nextSibling,Be=gr.firstChild,Pt=Be.nextSibling,Ct=gr.nextSibling,tt=Ct.firstChild,ft=tt.nextSibling,Vt=Ct.nextSibling,Rt=Vt.firstChild,rr=Rt.nextSibling;return a(ue,(()=>{var it=Ee(()=>!t.filterBy);return()=>it()&&(()=>{var yt=RT(),It=yt.firstChild;return m(yt,w),It.style.setProperty("margin","0"),It.style.setProperty("font-size","1.5rem"),a(It,()=>e("inventory.movements")),a(yt,M(dt,{variant:"outline",onClick:G,get children(){return e("common.clearFilters")}}),null),yt})()})(),ge),a(ue,M(xT,{filters:{selectedLocation:i,movementType:s},onSearchResults:it=>{f(it),de(it)},get placeholder(){return e("inventory.searchProductsStock","Search inventories...")},showResults:!1,maxResults:20}),ge),ge.style.setProperty("margin","20px"),m(xe,_),a(xe,(()=>{var it=Ee(()=>!t.filterBy);return()=>it()&&[(()=>{var yt=DT(),It=yt.firstChild;return It.style.setProperty("display","block"),It.style.setProperty("margin-bottom","0.5rem"),It.style.setProperty("font-weight","500"),a(It,()=>e("inventory.product")),a(yt,M(mp,{onChange:Jt=>{console.log(Jt),n(Jt.id)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}}),null),yt})(),(()=>{var yt=MT(),It=yt.firstChild,Jt=It.nextSibling,Je=Jt.firstChild;return It.style.setProperty("display","block"),It.style.setProperty("margin-bottom","0.5rem"),It.style.setProperty("font-weight","500"),a(It,()=>e("inventory.location")),Jt.addEventListener("change",Et=>o(Et.target.value)),a(Je,()=>e("inventory.allLocations")),a(Jt,M(Ht,{get each(){return ct.locations},children:Et=>(()=>{var Wt=FT();return a(Wt,()=>Et.name),Se(()=>Wt.value=Et.id),Wt})()}),null),Se(Et=>m(Jt,W,Et)),Se(()=>Jt.value=i()),yt})()]})(),pe),_e.style.setProperty("display","block"),_e.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("font-weight","500"),a(_e,()=>e("inventory.movementType")),Le.addEventListener("change",it=>{l(it.target.value),de(g())}),a(De,()=>e("inventory.allTypes")),a(Te,()=>e("inventory.stockIn")),a($e,()=>e("inventory.stockOut")),a(Ie,()=>e("inventory.transfer")),a(Re,()=>e("inventory.adjustment")),je.style.setProperty("display","block"),je.style.setProperty("margin-bottom","0.5rem"),je.style.setProperty("font-weight","500"),a(je,()=>e("common.startDate")),We.addEventListener("change",it=>u(yt=>({...yt,start:it.target.value}))),at.style.setProperty("display","block"),at.style.setProperty("margin-bottom","0.5rem"),at.style.setProperty("font-weight","500"),a(at,()=>e("common.endDate")),nt.addEventListener("change",it=>u(yt=>({...yt,end:it.target.value}))),m(Ye,k),a(lt,()=>b().total),a($t,()=>e("inventory.totalMovements")),a(ze,()=>b().stockIn),a(Lt,()=>e("inventory.stockIn")),a(wt,()=>b().stockOut),a(Ot,()=>e("inventory.stockOut")),a(Be,()=>b().transfers),a(Pt,()=>e("inventory.transfers")),a(tt,()=>b().adjustments),a(ft,()=>e("inventory.adjustments")),Rt.$$click=fe,a(Rt,()=>te(b().totalValue)),a(rr,()=>e("inventory.totalValue")),a(ue,(()=>{var it=Ee(()=>T().length===0);return()=>it()?(()=>{var yt=OT(),It=yt.firstChild,Jt=It.nextSibling,Je=Jt.nextSibling;return yt.style.setProperty("text-align","center"),yt.style.setProperty("padding","3rem"),yt.style.setProperty("color","var(--text-muted)"),yt.style.setProperty("background","var(--surface-color)"),yt.style.setProperty("border-radius","var(--border-radius)"),yt.style.setProperty("border","1px solid var(--border-color)"),It.style.setProperty("font-size","1.5rem"),It.style.setProperty("margin-bottom","1rem"),Jt.style.setProperty("font-size","1.1rem"),Jt.style.setProperty("margin-bottom","0.5rem"),a(Jt,()=>e("inventory.noMovementsFound")),Je.style.setProperty("font-size","0.875rem"),a(Je,()=>e("inventory.tryAdjustingFilters")),yt})():[M(Ht,{get each(){return T()},children:yt=>(()=>{var It=BT(),Jt=It.firstChild,Je=Jt.firstChild,Et=Je.firstChild,Wt=Et.firstChild,Yt=Wt.nextSibling,er=Yt.nextSibling,kt=Et.nextSibling,Xt=kt.firstChild,tr=Je.nextSibling,Zt=tr.firstChild,vt=Zt.nextSibling,ir=vt.firstChild,Tt=ir.nextSibling;Tt.nextSibling;var Ir=Jt.nextSibling,or=Ir.firstChild,cr=or.firstChild,_r=cr.firstChild,Tr=_r.firstChild,kr=_r.nextSibling,lr=cr.nextSibling,Mt=lr.firstChild,yn=Mt.firstChild,gn=Mt.nextSibling,En=or.nextSibling,Nr=En.firstChild,On=Nr.firstChild,bi=On.firstChild,_i=On.nextSibling;return It.addEventListener("mouseleave",hr=>{hr.currentTarget.style.transform="translateY(0)",hr.currentTarget.style.boxShadow="none"}),It.addEventListener("mouseenter",hr=>{hr.currentTarget.style.transform="translateY(-2px)",hr.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),It.$$click=()=>ce(yt),m(Jt,le),Et.style.setProperty("display","flex"),Et.style.setProperty("align-items","center"),Et.style.setProperty("gap","0.5rem"),Et.style.setProperty("margin-bottom","0.5rem"),Wt.style.setProperty("font-size","1.2rem"),a(Wt,()=>ne(yt.movementType)),Yt.style.setProperty("margin","0"),Yt.style.setProperty("font-size","1.1rem"),a(Yt,()=>yt.productName),a(er,()=>yt.movementType),a(Et,(()=>{var hr=Ee(()=>!!yt.invoiceId);return()=>hr()&&(()=>{var Lr=jT();return Lr.style.setProperty("padding","0.2rem 0.5rem"),Lr.style.setProperty("border-radius","var(--border-radius-sm)"),Lr.style.setProperty("font-size","0.7rem"),Lr.style.setProperty("font-weight","500"),Lr.style.setProperty("background","var(--primary-color)"),Lr.style.setProperty("color","white"),a(Lr,()=>e("inventory.bulk")),Lr})()})(),null),kt.style.setProperty("font-size","0.875rem"),kt.style.setProperty("color","var(--text-muted)"),a(kt,()=>yt.productSku,Xt),a(kt,()=>ee(yt.createdDate),null),a(kt,(()=>{var hr=Ee(()=>!!yt.invoiceId);return()=>hr()&&(()=>{var Lr=VT(),jr=Lr.firstChild,fn=jr.nextSibling;return fn.nextSibling,Lr.style.setProperty("margin-left","0.5rem"),Lr.style.setProperty("font-weight","500"),a(Lr,()=>e("common.invoice"),fn),a(Lr,()=>yt.invoiceId,null),Lr})()})(),null),tr.style.setProperty("text-align","right"),Zt.style.setProperty("font-size","1.25rem"),Zt.style.setProperty("font-weight","700"),Zt.style.setProperty("color","var(--primary-color)"),a(Zt,()=>te(yt.totalCost)),vt.style.setProperty("font-size","0.875rem"),vt.style.setProperty("color","var(--text-muted)"),a(vt,()=>yt.quantity,ir),a(vt,()=>e("common.units"),Tt),a(vt,()=>te(yt.unitCost),null),m(Ir,V),a(_r,()=>e("inventory.location"),Tr),a(kr,()=>yt.locationName),a(or,(()=>{var hr=Ee(()=>!!yt.fromLocationName);return()=>hr()&&(()=>{var Lr=_0(),jr=Lr.firstChild,fn=jr.firstChild,Gr=jr.nextSibling;return a(jr,()=>e("common.from"),fn),a(Gr,()=>yt.fromLocationName),Se(Br=>{var Wn=I,ri=F,Si=Q;return Br.e=m(Lr,Wn,Br.e),Br.t=m(jr,ri,Br.t),Br.a=m(Gr,Si,Br.a),Br},{e:void 0,t:void 0,a:void 0}),Lr})()})(),lr),a(Mt,()=>e("common.reference"),yn),a(gn,()=>yt.referenceNumber),a(On,()=>e("common.createdBy"),bi),a(_i,()=>yt.createdBy),a(En,(()=>{var hr=Ee(()=>!!yt.notes);return()=>hr()&&(()=>{var Lr=_0(),jr=Lr.firstChild,fn=jr.firstChild,Gr=jr.nextSibling;return a(jr,()=>e("common.notes"),fn),a(Gr,()=>yt.notes),Se(Br=>{var Wn={...I,"border-bottom":"none"},ri=F,Si={...Q,"max-width":"200px","text-align":"right","font-style":"italic"};return Br.e=m(Lr,Wn,Br.e),Br.t=m(jr,ri,Br.t),Br.a=m(Gr,Si,Br.a),Br},{e:void 0,t:void 0,a:void 0}),Lr})()})(),null),Se(hr=>{var Lr={...O,"border-left":yt.invoiceId?"4px solid var(--primary-color)":"1px solid var(--border-color)",cursor:"pointer"},jr=D(yt.movementType),fn=I,Gr=F,Br=Q,Wn=I,ri=F,Si=Q,qr=I,Vi=F,Pi=Q;return hr.e=m(It,Lr,hr.e),hr.t=m(er,jr,hr.t),hr.a=m(cr,fn,hr.a),hr.o=m(_r,Gr,hr.o),hr.i=m(kr,Br,hr.i),hr.n=m(lr,Wn,hr.n),hr.s=m(Mt,ri,hr.s),hr.h=m(gn,Si,hr.h),hr.r=m(Nr,qr,hr.r),hr.d=m(On,Vi,hr.d),hr.l=m(_i,Pi,hr.l),hr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),It})()}),Ee(()=>Ee(()=>j()>1)()&&(()=>{var yt=qT(),It=yt.firstChild,Jt=It.firstChild,Je=Jt.firstChild,Et=Jt.nextSibling,Wt=Et.nextSibling,Yt=It.nextSibling,er=Yt.firstChild,kt=er.firstChild,Xt=kt.firstChild,tr=kt.nextSibling,Zt=tr.nextSibling,vt=Zt.firstChild;return m(yt,H),It.style.setProperty("display","flex"),It.style.setProperty("align-items","center"),It.style.setProperty("gap","0.5rem"),Jt.style.setProperty("font-size","0.875rem"),Jt.style.setProperty("color","var(--text-muted)"),a(Jt,()=>e("common.showPerPage","Show per page"),Je),Et.addEventListener("change",ir=>{$(Number(ir.target.value)),S(1)}),Et.style.setProperty("padding","0.25rem 0.5rem"),Et.style.setProperty("border","1px solid var(--border-color)"),Et.style.setProperty("border-radius","var(--border-radius-sm)"),Et.style.setProperty("background","var(--surface-color)"),Et.style.setProperty("cursor","pointer"),Et.style.setProperty("font-size","0.875rem"),Wt.style.setProperty("font-size","0.875rem"),Wt.style.setProperty("color","var(--text-muted)"),Wt.style.setProperty("margin-left","1rem"),a(Wt,()=>e("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:(x()-1)*P()+1,end:Math.min(x()*P(),C().length),total:C().length})),Yt.style.setProperty("display","flex"),Yt.style.setProperty("align-items","center"),Yt.style.setProperty("gap","0.5rem"),a(Yt,M(dt,{variant:"outline",size:"sm",onClick:()=>S(1),get disabled(){return x()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.first","First")}}),er),a(Yt,M(dt,{variant:"outline",size:"sm",onClick:()=>S(ir=>Math.max(1,ir-1)),get disabled(){return x()===1},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.previous")}}),er),a(Yt,()=>{const ir=[],Tt=j(),Ir=x();if(Tt<=7)for(let or=1;or<=Tt;or++)ir.push(or);else{ir.push(1),Ir>3&&ir.push("...");for(let or=Math.max(2,Ir-1);or<=Math.min(Tt-1,Ir+1);or++)ir.includes(or)||ir.push(or);Ir<Tt-2&&ir.push("..."),ir.includes(Tt)||ir.push(Tt)}return M(Ht,{each:ir,children:or=>or==="..."?(()=>{var cr=zT();return cr.style.setProperty("padding","0 0.5rem"),cr.style.setProperty("color","var(--text-muted)"),cr})():(()=>{var cr=UT();return cr.$$click=()=>S(or),a(cr,or),Se(_r=>m(cr,J(or===x()),_r)),cr})()})},er),a(Yt,M(dt,{variant:"outline",size:"sm",onClick:()=>S(ir=>Math.min(j(),ir+1)),get disabled(){return x()===j()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.next")}}),er),a(Yt,M(dt,{variant:"outline",size:"sm",onClick:()=>S(j()),get disabled(){return x()===j()},style:{padding:"0.25rem 0.5rem"},get children(){return e("common.last","Last")}}),er),er.style.setProperty("display","flex"),er.style.setProperty("align-items","center"),er.style.setProperty("gap","0.5rem"),er.style.setProperty("margin-left","1rem"),kt.style.setProperty("font-size","0.875rem"),kt.style.setProperty("color","var(--text-muted)"),a(kt,()=>e("common.page","Page"),Xt),tr.addEventListener("change",ir=>{const Tt=Number(ir.target.value);Tt>=1&&Tt<=j()&&S(Tt)}),tr.style.setProperty("width","4rem"),tr.style.setProperty("padding","0.25rem 0.5rem"),tr.style.setProperty("border","1px solid var(--border-color)"),tr.style.setProperty("border-radius","var(--border-radius-sm)"),tr.style.setProperty("background","var(--surface-color)"),tr.style.setProperty("text-align","center"),tr.style.setProperty("font-size","0.875rem"),Zt.style.setProperty("font-size","0.875rem"),Zt.style.setProperty("color","var(--text-muted)"),a(Zt,()=>e("common.of","of"),vt),a(Zt,j,null),Se(()=>nr(tr,"max",j())),Se(()=>Et.value=P()),Se(()=>tr.value=x()),yt})())]})(),null),a(ue,M($T,{get isOpen(){return X()},onClose:()=>{Z(!1),se(null)},get movement(){return U()},onEdit:oe}),null),a(ue,M(Ge,{get when(){return pr.hasPermission("read_write")},get children(){return M(NT,{get isOpen(){return re()},onClose:()=>{E(!1),se(null)},get movement(){return U()},onMovementUpdated:z})}}),null),Se(it=>{var yt=W,It=K,Jt=K,Je=R,Et=Y,Wt=q,Yt=R,er={...Y,color:"#2d7d32"},kt=q,Xt=R,tr={...Y,color:"#d32f2f"},Zt=q,vt=R,ir={...Y,color:"#1976d2"},Tt=q,Ir=R,or={...Y,color:"#f57c00"},cr=q,_r=R,Tr=Y,kr=q;return it.e=m(Le,yt,it.e),it.t=m(We,It,it.t),it.a=m(nt,Jt,it.a),it.o=m(ht,Je,it.o),it.i=m(lt,Et,it.i),it.n=m($t,Wt,it.n),it.s=m(_t,Yt,it.s),it.h=m(ze,er,it.h),it.r=m(Lt,kt,it.r),it.d=m(Nt,Xt,it.d),it.l=m(wt,tr,it.l),it.u=m(Ot,Zt,it.u),it.c=m(gr,vt,it.c),it.w=m(Be,ir,it.w),it.m=m(Pt,Tt,it.m),it.f=m(Ct,Ir,it.f),it.y=m(tt,or,it.y),it.g=m(ft,cr,it.g),it.p=m(Vt,_r,it.p),it.b=m(Rt,Tr,it.b),it.T=m(rr,kr,it.T),it},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),Se(()=>Le.value=s()),Se(()=>We.value=c().start),Se(()=>nt.value=c().end),ue})()};yr(["click"]);var GT=he("<div><p>📋 "),WT=he("<div>"),YT=he("<div><div>📊</div><h3></h3><p></p><div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=all></option></select></div><div><label>:</label><select><option value=name></option><option value=sku></option><option value=category>"),KT=he("<div><div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div>%</div><div></div></div></div><div></div><div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),JT=he("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),QT=he("<div><div>✅</div><h3></h3><p>"),XT=he("<div><div><h3>📋 </h3><p></p></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div></div><div>"),ZT=he("<div><div><div><h2>📋 </h2><button>×"),S0=he("<option>"),ek=he("<div>..."),tk=he("<tr><td><div></div><div> • </div></td><td><div></div></td><td><div></div></td><td><div></div></td><td><div>"),rk=he("<tr><td><div></div></td><td><div></div><div> • <!> • </div></td><td><div></div></td><td><input type=number placeholder=0 min=0 step=0.01></td><td><div></div></td><td><input type=text>");const nk=t=>{const{t:e}=sr(),[r,n]=Ce([]),[i,o]=Ce(!1),[s,l]=Ce(!1),[c,u]=Ce("all"),[h,y]=Ce("all"),[g,f]=Ce("name"),[x,S]=Ce([]),[P,$]=Ce("setup"),U=async()=>{try{o(!0);const q=await gi.getProducts("prod");if(!q||typeof q!="object"){console.warn("No API results, using local store"),n(ct.products);return}const O=Object.keys(q),le=D=>{let I=q[D];return{id:D,name:I.name||"Unknown Product",businessId:I.businessId||"",sku:I.code||I.sku||"",UPC:I.UPC||"",numCode:I.codeN||"",category:I.category||"General",unitCost:I.unitCost||0,unitOfMeasure:I.unitOfMeasure||"pcs",minStockLevel:I.minStockLevel||0,maxStockLevel:I.maxStockLevel||100,isActive:I.isActive!==!1,description:I.description||"",createdDate:I.createdAt||new Date().toISOString(),lastModified:I.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(I.sellingPrice||I.price||"0")}},N=O.map(le);n(N)}catch(q){console.error("Failed to load products from API:",q),n(ct.products)}finally{o(!1)}},se=Dt(()=>[...new Set(r().map(O=>O.category).filter(O=>O))].sort()),X=Dt(()=>{let q=r().filter(O=>O.isActive);return h()!=="all"&&(q=q.filter(O=>O.category===h())),q.sort((O,le)=>{switch(g()){case"name":return O.name.localeCompare(le.name);case"sku":return O.sku.localeCompare(le.sku);case"category":return O.category.localeCompare(le.category)||O.name.localeCompare(le.name);default:return 0}}),q}),Z=Dt(()=>ct.getActiveLocations()),re=(q,O)=>O&&O!=="all"?ct.getStockByProductAndLocation(q,O)?.quantity||0:ct.getTotalStockByProduct(q),E=()=>{const q=X().map(O=>{const le=re(O.id,c()!=="all"?c():void 0);return{productId:O.id,systemQuantity:le,physicalCount:null,notes:"",variance:0,product:O}});S(q),$("counting")},C=(q,O)=>{S(le=>le.map(N=>{if(N.productId===q){const D=O,V=D!==null?D-N.systemQuantity:0;return{...N,physicalCount:D,variance:V}}return N}))},T=(q,O)=>{S(le=>le.map(N=>N.productId===q?{...N,notes:O}:N))},j=Dt(()=>{const q=x(),O=q.length,le=q.filter(I=>I.physicalCount!==null).length,N=q.filter(I=>I.variance!==0).length,D=q.filter(I=>I.variance>0).length,V=q.filter(I=>I.variance<0).length;return{totalProducts:O,countedProducts:le,remainingProducts:O-le,variances:N,positiveVariances:D,negativeVariances:V,isComplete:le===O}}),b=()=>{const q=x().filter(D=>D.physicalCount!==null&&D.variance!==0);if(q.length===0)return null;const O=[e("inventory.product","Product"),e("inventory.sku","SKU"),e("inventory.category","Category"),e("inventory.location","Location"),e("inventory.systemQty","System Qty"),e("inventory.physicalCount","Physical Count"),e("inventory.variance","Variance"),e("inventory.adjustment","Adjustment"),e("common.notes","Notes"),e("common.date","Date")],le=q.map(D=>[`"${D.product.name}"`,`"${D.product.sku}"`,`"${D.product.category}"`,`"${W()}"`,D.systemQuantity,D.physicalCount,D.variance,D.variance>0?e("inventory.stockIncrease","Stock Increase"):e("inventory.stockDecrease","Stock Decrease"),`"${D.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")}"`,`"${K()}"`]);return[O.join(","),...le.map(D=>D.join(","))].join(`
`)},w=()=>{const q=b();if(!q){alert(e("inventory.noAdjustmentsToDownload","No adjustments to download"));return}const O=new Blob([q],{type:"text/csv;charset=utf-8;"}),le=document.createElement("a");if(le.download!==void 0){const N=URL.createObjectURL(O);le.setAttribute("href",N),le.setAttribute("download",`inventory-adjustments-${K().replace(/[/:,\s]/g,"-")}.csv`),le.style.visibility="hidden",document.body.appendChild(le),le.click(),document.body.removeChild(le)}},_=async(q=!0)=>{try{l(!0),console.log(x());const O=F=>{let Q=ct.getProductById(F.productId),H=ct.getStockByProductAndLocation(F.productId,c()),J=parseFloat(H?.averageCost+""),te=parseFloat(H?.quantity+"");return{product:{id:F.productId,label:Q?.name,code:Q?.code},productId:F?.productId,reason:"Physical Count Adjustment",notes:F?.notes||"Physical inventory adjustment",quantity:F?.variance,unitCost:J}},le=x().filter(F=>F.physicalCount!==null&&F.variance!==0).map(O);let N="ADJ_"+Tg();const D=new Date().toISOString(),V={ssg_inventory_key:ku(),invoiceId:N,referenceNumber:Tg(),movementType:"adjustment",type:"adjustment",locationId:c(),items:le,products:le,generalNotes:"Physical inventory adjustment",description:"Physical Count Adjustment",invoice:N,store:c(),createdBy:"admin",createDate:D};console.log("Saving inventory bulkRequest:",V);const I=await gi.addInventory(V);q&&le.length>0&&w(),console.log("Saving inventory adjustments:",le),await new Promise(F=>setTimeout(F,1e3)),t.onClose()}catch(O){console.error("Failed to save inventory adjustments:",O)}finally{l(!1)}},W=Dt(()=>c()==="all"?"All Locations":Z().find(O=>O.id===c())?.name||"Unknown Location"),K=()=>new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),k=async()=>{await ct.fecthInventory("prod"),await U()};Sn(async()=>{t.selectedLocationId&&u(t.selectedLocationId),k()});const R=()=>{const q=window.open("","_blank");if(!q){alert("Please allow pop-ups to print the counting sheet");return}const O=Y();q.document.write(O),q.document.close(),q.onload=()=>{q.print(),q.onafterprint=()=>{q.close()}}},Y=()=>{const q=X().map((O,le)=>{const N=re(O.id,c()!=="all"?c():void 0);return`
        <tr>
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${le+1}</td>
          <td style="border: 1px solid #000; padding: 8px; font-family: monospace;">${O.sku}</td>
          <td style="border: 1px solid #000; padding: 8px;">
            <div style="font-weight: 500;">${O.name}</div>
            ${O.UPC?`<div style="font-size: 0.8em; color: #666;">UPC: ${O.UPC}</div>`:""}
          </td>
         
          <td style="border: 1px solid #000; padding: 8px; text-align: center;">${O.unitOfMeasure}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${N}</td>
          <td style="border: 1px solid #000; padding: 8px; text-align: center; background-color: #f9f9f9;"></td>
          <td style="border: 1px solid #000; padding: 8px;"></td>
        </tr>
      `}).join("");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title> ${W()}_${h()}_${e("inventory.countingSheet","Inventory Counting Sheet")} - ${K()}</title>
        <style>
          @page {
            size: letter;
            margin: 0.5in 0.8in 0.5in 0.8in;
            @top-center {
              content: "${W()} | ${h()==="all"?e("inventory.allCategories","All Categories"):h()} | Page " counter(page);
              font-size: 10px;
              font-weight: bold;
              border-bottom: 1px solid #ccc;
              padding-bottom: 5px;
            }
          }
          body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            margin: 0;
            padding: 0;
            position: relative;
          }
          .page-identifier {
            position: fixed;
            left: 5px;
            top: 50%;
            transform: rotate(-90deg) translateX(-50%);
            transform-origin: left center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          .page-identifier-right {
            position: fixed;
            right: 5px;
            top: 50%;
            transform: rotate(90deg) translateX(50%);
            transform-origin: right center;
            background: #f0f0f0;
            padding: 5px 15px;
            border: 1px solid #ccc;
            font-weight: bold;
            font-size: 10px;
            color: #333;
            z-index: 100;
          }
          h1 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 22px;
            page-break-after: avoid;
          }
          .header-info {
            text-align: center;
            margin-bottom: 20px;
            background: #f8f8f8;
            padding: 10px;
            border: 2px solid #333;
            page-break-after: avoid;
          }
          .page-header {
            display: none;
            text-align: center;
            background: #e0e0e0;
            padding: 8px;
            border: 1px solid #333;
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 11px;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
          }
          th {
            background-color: #333;
            color: white;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            border: 1px solid #000;
          }
          .summary-table {
            width: 50%;
            margin: 20px auto;
            /*page-break-before: auto;*/
          }
          .signature-section {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
            page-break-before: auto;
          }
          .signature-box {
            width: 45%;
            text-align: center;
          }
          .signature-line {
            border-bottom: 1px solid #000;
            margin-bottom: 5px;
            height: 30px;
          }
          @media print {
            body { margin: 0; }
            .page-identifier, .page-identifier-right { display: block; }
            .page-header { display: block; }
            tr { page-break-inside: avoid; }
            thead { display: table-header-group; }
            tfoot { display: table-footer-group; }
            .header-info { page-break-after: avoid; }
            h1 { page-break-after: avoid; }
            table { page-break-before: auto; }
            /*.summary-table { page-break-before: always; }*/
            .signature-section { page-break-before: avoid; }
            
            /* Repeat headers on each page */
            @page :first {
              @top-center { content: none; }
            }
            
            /* Force page headers to show on continuation pages */
            tbody::before {
              content: "";
              display: block;
              height: 0;
            }
          }
        </style>
      </head>
      <body>
        <!-- Page identifiers for multi-page documents -->
        <div class="page-identifier-right">
          ${W()} - ${h()==="all"?e("inventory.allCategories","All Categories"):h()} - ${K()} 
        </div>
       
        
        <h1>${e("inventory.inventoryCountingSheetTitle","INVENTORY COUNTING SHEET")}</h1>
        <div class="header-info">
          <p><strong>${e("inventory.location","Location")}:</strong> ${W()}</p>
          <p><strong>${e("common.category","Category")}:</strong> ${h()==="all"?e("inventory.allCategories","All Categories"):h()}</p>
          <p><strong>${e("common.date","Date")}:</strong> ${K()}</p>
          <p style="margin-top: 10px;">
            <span style="margin-right: 30px;">${e("inventory.countedBy","Counted by")}: _________________________</span>
            <span>${e("inventory.verifiedBy","Verified by")}: _________________________</span>
          </p>
        </div>

        <!-- Page header for continuation pages (hidden on first page) -->
        <div class="page-header">
          ${W()} | ${h()==="all"?e("inventory.allCategories","All Categories"):h()} | ${K()} 
        </div>

        <table>
          <thead>
            <tr>
              <th style="width: 5%; text-align: center;">#</th>
              <th style="width: 12%;">${e("inventory.sku","SKU")}</th>
              <th style="width: 25%;">${e("inventory.productName","Product Name")}</th>
              <th style="width: 8%; text-align: center;">${e("inventory.unit","Unit")}</th>
              <th style="width: 10%; text-align: center;">${e("inventory.systemQty","System Qty")}</th>
              <th style="width: 12%; text-align: center; background-color: #f0f0f0;">${e("inventory.physicalCount","Physical Count")}</th>
              <th style="width: 28%;">${e("common.notes","Notes")}</th>
            </tr>
            <!-- Repeat header info row for clarity -->
            <tr style="background-color: #f8f8f8; font-size: 10px;">
              <td colspan="8" style="text-align: center; padding: 4px; border: 1px solid #000; font-weight: bold;">
                📍 ${W()} | 📂 ${h()==="all"?e("inventory.allCategories","All Categories"):h()} | 📅 ${K()}
              </td>
            </tr>
          </thead>
          <tbody>
            ${q}
          </tbody>
        </table>
        
        <!-- Summary section with location/category context -->
        <div style="margin: 30px 0; padding: 15px; background: #f8f8f8;">
          <h3 style="text-align: center; margin: 0 0 15px 0; font-size: 16px;">
            ${e("inventory.summaryFor","SUMMARY FOR")}: ${W()} - ${h()==="all"?e("inventory.allCategories","All Categories"):h()}
          </h3>
          
          <table class="summary-table">
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.totalProductsListed","Total Products Listed")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">
                ${X().length}
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.itemsCounted","Items Counted")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
            <tr>
              <td style="border: 1px solid #000; padding: 8px; font-weight: bold; background-color: #f0f0f0;">
                ${e("inventory.discrepanciesFound","Discrepancies Found")}:
              </td>
              <td style="border: 1px solid #000; padding: 8px; text-align: center;">
                ___________
              </td>
            </tr>
          </table>
        </div>
        
        <div class="signature-section">
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.counterSignature","Counter Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
          <div class="signature-box">
            <div class="signature-line"></div>
            <p>${e("inventory.supervisorSignature","Supervisor Signature")}</p>
            <p>${e("common.date","Date")}: _______________</p>
          </div>
        </div>
      </body>
      </html>
    `};return M(Ge,{get when(){return t.isOpen},get children(){var q=ZT(),O=q.firstChild,le=O.firstChild,N=le.firstChild;N.firstChild;var D=N.nextSibling;return q.style.setProperty("position","fixed"),q.style.setProperty("top","0"),q.style.setProperty("left","0"),q.style.setProperty("right","0"),q.style.setProperty("bottom","0"),q.style.setProperty("background","rgba(0, 0, 0, 0.5)"),q.style.setProperty("z-index","1000"),q.style.setProperty("display","flex"),q.style.setProperty("align-items","center"),q.style.setProperty("justify-content","center"),O.style.setProperty("background","white"),O.style.setProperty("border-radius","var(--border-radius)"),O.style.setProperty("padding","2rem"),O.style.setProperty("width","95%"),O.style.setProperty("height","95%"),O.style.setProperty("max-width","1400px"),O.style.setProperty("overflow-y","auto"),O.style.setProperty("position","relative"),le.style.setProperty("display","flex"),le.style.setProperty("justify-content","space-between"),le.style.setProperty("align-items","center"),le.style.setProperty("margin-bottom","2rem"),le.style.setProperty("border-bottom","1px solid var(--border-color)"),le.style.setProperty("padding-bottom","1rem"),N.style.setProperty("margin","0"),N.style.setProperty("font-size","1.5rem"),a(N,()=>e("inventory.physicalInventoryCount","Physical Inventory Count"),null),ts(D,"click",t.onClose,!0),D.style.setProperty("background","none"),D.style.setProperty("border","none"),D.style.setProperty("font-size","1.5rem"),D.style.setProperty("cursor","pointer"),D.style.setProperty("padding","0.5rem"),a(O,M(Ge,{get when(){return P()==="setup"},get children(){var V=YT(),I=V.firstChild,F=I.nextSibling,Q=F.nextSibling,H=Q.nextSibling,J=H.firstChild,te=J.firstChild,ee=te.firstChild,ne=te.nextSibling,G=ne.firstChild,ce=J.nextSibling,oe=ce.firstChild,z=oe.firstChild,de=oe.nextSibling,fe=de.firstChild,ue=ce.nextSibling,ge=ue.firstChild,xe=ge.firstChild,pe=ge.nextSibling,_e=pe.firstChild,Le=_e.nextSibling,De=Le.nextSibling;return V.style.setProperty("text-align","center"),V.style.setProperty("padding","2rem"),V.style.setProperty("max-width","600px"),V.style.setProperty("margin","0 auto"),I.style.setProperty("font-size","3rem"),I.style.setProperty("margin-bottom","1rem"),F.style.setProperty("margin-bottom","1rem"),a(F,()=>e("inventory.setupPhysicalCount","Setup Physical Inventory Count")),Q.style.setProperty("margin-bottom","2rem"),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>e("inventory.setupDescription","Configure your physical inventory count settings and begin the counting process.")),H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),H.style.setProperty("gap","1rem"),H.style.setProperty("margin-bottom","2rem"),H.style.setProperty("padding","1rem"),H.style.setProperty("background","var(--surface-color)"),H.style.setProperty("border-radius","var(--border-radius)"),H.style.setProperty("text-align","left"),te.style.setProperty("display","block"),te.style.setProperty("margin-bottom","0.5rem"),te.style.setProperty("font-weight","500"),a(te,()=>e("inventory.location","Location"),ee),ne.addEventListener("change",Te=>u(Te.target.value)),ne.style.setProperty("width","100%"),ne.style.setProperty("padding","0.5rem"),ne.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),a(G,()=>e("inventory.allLocations","All Locations")),a(ne,M(Ht,{get each(){return Z()},children:Te=>(()=>{var $e=S0();return a($e,()=>Te.name),Se(()=>$e.value=Te.id),$e})()}),null),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),a(oe,()=>e("inventory.category","Category"),z),de.addEventListener("change",Te=>y(Te.target.value)),de.style.setProperty("width","100%"),de.style.setProperty("padding","0.5rem"),de.style.setProperty("border","1px solid var(--border-color)"),de.style.setProperty("border-radius","var(--border-radius-sm)"),a(fe,()=>e("products.allCategories","All Categories")),a(de,M(Ht,{get each(){return se()},children:Te=>(()=>{var $e=S0();return $e.value=Te,a($e,Te),$e})()}),null),ge.style.setProperty("display","block"),ge.style.setProperty("margin-bottom","0.5rem"),ge.style.setProperty("font-weight","500"),a(ge,()=>e("inventory.sortBy","Sort By"),xe),pe.addEventListener("change",Te=>f(Te.target.value)),pe.style.setProperty("width","100%"),pe.style.setProperty("padding","0.5rem"),pe.style.setProperty("border","1px solid var(--border-color)"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),a(_e,()=>e("inventory.productName","Product Name")),a(Le,()=>e("inventory.sku","SKU")),a(De,()=>e("inventory.category","Category")),a(V,M(Ge,{get when(){return!i()},get fallback(){return(()=>{var Te=ek(),$e=Te.firstChild;return Te.style.setProperty("padding","2rem"),a(Te,()=>e("common.loading","Loading"),$e),Te})()},get children(){return[(()=>{var Te=GT(),$e=Te.firstChild;return $e.firstChild,Te.style.setProperty("padding","1rem"),Te.style.setProperty("background","#fff3cd"),Te.style.setProperty("border-radius","var(--border-radius-sm)"),Te.style.setProperty("margin-bottom","2rem"),$e.style.setProperty("margin","0"),$e.style.setProperty("color","#856404"),a($e,()=>e("inventory.countWillInclude","This count will include {{count}} products from {{location}} in {{category}} category.",{count:X().length,location:W(),category:h()==="all"?e("inventory.allCategories","all categories"):h()}),null),Te})(),M(Ge,{get when(){return Ee(()=>h()!=="all")()&&c()!=="all"},get children(){var Te=WT();return Te.style.setProperty("display","grid"),Te.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),Te.style.setProperty("gap","1rem"),Te.style.setProperty("margin-bottom","2rem"),Te.style.setProperty("padding","1rem"),Te.style.setProperty("background","var(--surface-color)"),Te.style.setProperty("border-radius","var(--border-radius)"),a(Te,M(Ge,{get when(){return pr.hasPermission("physicalInventoryCountingForm")},get children(){return M(dt,{variant:"primary",size:"large",onClick:E,get disabled(){return i()||X().length===0},get children(){return["🚀 ",Ee(()=>e("inventory.startCounting","Start Physical Count"))]}})}}),null),a(Te,M(dt,{variant:"primary",onClick:R,get disabled(){return i()},get children(){return["🖨️ ",Ee(()=>e("common.print","Print"))]}}),null),Te}})]}}),null),Se(()=>ne.value=c()),Se(()=>de.value=h()),Se(()=>pe.value=g()),V}}),null),a(O,M(Ge,{get when(){return P()==="counting"},get children(){var V=KT(),I=V.firstChild,F=I.nextSibling,Q=F.firstChild,H=Q.firstChild,J=H.nextSibling,te=Q.nextSibling,ee=te.firstChild,ne=ee.nextSibling,G=te.nextSibling,ce=G.firstChild,oe=ce.nextSibling,z=G.nextSibling,de=z.firstChild,fe=de.firstChild,ue=de.nextSibling,ge=F.nextSibling,xe=ge.nextSibling,pe=xe.firstChild,_e=pe.firstChild,Le=_e.firstChild,De=Le.firstChild,Te=De.nextSibling,$e=Te.nextSibling,Ie=$e.nextSibling,Re=Ie.nextSibling,Ke=Re.nextSibling,je=_e.nextSibling;return I.style.setProperty("display","grid"),I.style.setProperty("grid-template-columns","repeat(auto-fit)"),I.style.setProperty("gap","1rem"),I.style.setProperty("margin-bottom","2rem"),I.style.setProperty("padding","1rem"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius)"),a(I,W),F.style.setProperty("display","grid"),F.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),F.style.setProperty("gap","1rem"),F.style.setProperty("margin-bottom","2rem"),F.style.setProperty("padding","1rem"),F.style.setProperty("background","var(--surface-color)"),F.style.setProperty("border-radius","var(--border-radius)"),Q.style.setProperty("text-align","center"),H.style.setProperty("font-size","1.5rem"),H.style.setProperty("font-weight","700"),H.style.setProperty("color","var(--primary-color)"),a(H,()=>j().countedProducts),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-muted)"),a(J,()=>e("inventory.counted","Counted")),te.style.setProperty("text-align","center"),ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","700"),ee.style.setProperty("color","#ff9800"),a(ee,()=>j().remainingProducts),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),a(ne,()=>e("inventory.remaining","Remaining")),G.style.setProperty("text-align","center"),ce.style.setProperty("font-size","1.5rem"),ce.style.setProperty("font-weight","700"),ce.style.setProperty("color","#f44336"),a(ce,()=>j().variances),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),a(oe,()=>e("inventory.variances","Variances")),z.style.setProperty("text-align","center"),de.style.setProperty("font-size","1.5rem"),de.style.setProperty("font-weight","700"),a(de,()=>Math.round(j().countedProducts/j().totalProducts*100),fe),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),a(ue,()=>e("inventory.complete","Complete")),ge.style.setProperty("display","flex"),ge.style.setProperty("gap","1rem"),ge.style.setProperty("margin-bottom","2rem"),ge.style.setProperty("justify-content","center"),a(ge,M(dt,{variant:"outline",onClick:()=>$("setup"),get children(){return["⬅️ ",Ee(()=>e("common.back","Back to Setup"))]}}),null),a(ge,M(dt,{variant:"primary",onClick:()=>$("review"),get children(){return["📋 ",Ee(()=>e("inventory.reviewAdjustments","Review Adjustments"))]}}),null),xe.style.setProperty("border","1px solid var(--border-color)"),xe.style.setProperty("border-radius","var(--border-radius)"),xe.style.setProperty("overflow-x","auto"),pe.style.setProperty("width","100%"),pe.style.setProperty("border-collapse","collapse"),Le.style.setProperty("background","var(--surface-color)"),De.style.setProperty("padding","1rem"),De.style.setProperty("text-align","left"),De.style.setProperty("border-bottom","1px solid var(--border-color)"),a(De,()=>e("inventory.no","No")),Te.style.setProperty("padding","1rem"),Te.style.setProperty("text-align","left"),Te.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Te,()=>e("inventory.product","Product")),$e.style.setProperty("padding","1rem"),$e.style.setProperty("text-align","center"),$e.style.setProperty("border-bottom","1px solid var(--border-color)"),a($e,()=>e("inventory.systemQty","System Qty")),Ie.style.setProperty("padding","1rem"),Ie.style.setProperty("text-align","center"),Ie.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ie,()=>e("inventory.physicalCount","Physical Count")),Re.style.setProperty("padding","1rem"),Re.style.setProperty("text-align","center"),Re.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Re,()=>e("inventory.variance","Variance")),Ke.style.setProperty("padding","1rem"),Ke.style.setProperty("text-align","left"),Ke.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Ke,()=>e("common.notes","Notes")),a(je,M(Ht,{get each(){return x()},children:(We,Qe)=>M(ik,{get index(){return Qe()},updatePhysicalCount:C,entry:We,updateNotes:T})})),Se(We=>(We=j().isComplete?"#4caf50":"#ff9800")!=null?de.style.setProperty("color",We):de.style.removeProperty("color")),V}}),null),a(O,M(Ge,{get when(){return P()==="review"},get children(){var V=XT(),I=V.firstChild,F=I.firstChild;F.firstChild;var Q=F.nextSibling,H=I.nextSibling,J=H.firstChild,te=J.firstChild,ee=te.nextSibling,ne=J.nextSibling,G=ne.firstChild,ce=G.nextSibling,oe=ne.nextSibling,z=oe.firstChild,de=z.nextSibling,fe=H.nextSibling;return I.style.setProperty("text-align","center"),I.style.setProperty("margin-bottom","2rem"),F.style.setProperty("margin-bottom","1rem"),a(F,()=>e("inventory.reviewAndConfirm","Review and Confirm Adjustments"),null),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>e("inventory.reviewDescription","Review the inventory adjustments below and confirm to update your system.")),H.style.setProperty("display","grid"),H.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),H.style.setProperty("gap","1rem"),H.style.setProperty("margin-bottom","2rem"),H.style.setProperty("padding","1rem"),H.style.setProperty("background","var(--surface-color)"),H.style.setProperty("border-radius","var(--border-radius)"),J.style.setProperty("text-align","center"),te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","700"),te.style.setProperty("color","#4caf50"),a(te,()=>j().positiveVariances),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),a(ee,()=>e("inventory.stockIncreases","Stock Increases")),ne.style.setProperty("text-align","center"),G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","700"),G.style.setProperty("color","#f44336"),a(G,()=>j().negativeVariances),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),a(ce,()=>e("inventory.stockDecreases","Stock Decreases")),oe.style.setProperty("text-align","center"),z.style.setProperty("font-size","1.5rem"),z.style.setProperty("font-weight","700"),z.style.setProperty("color","var(--primary-color)"),a(z,()=>j().variances),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),a(de,()=>e("inventory.totalAdjustments","Total Adjustments")),fe.style.setProperty("display","flex"),fe.style.setProperty("gap","1rem"),fe.style.setProperty("margin-bottom","2rem"),fe.style.setProperty("justify-content","center"),fe.style.setProperty("flex-wrap","wrap"),a(fe,M(dt,{variant:"outline",onClick:()=>$("counting"),get children(){return["⬅️ ",Ee(()=>e("common.back","Back to Counting"))]}}),null),a(fe,M(dt,{variant:"outline",onClick:w,get disabled(){return j().variances===0},get children(){return["📥 ",Ee(()=>e("inventory.downloadCSV","Download CSV"))]}}),null),a(fe,M(dt,{variant:"primary",onClick:_,get disabled(){return s()||j().variances===0},get children(){return Ee(()=>!!s())()?"💾 "+e("common.saving","Saving")+"...":"✅ "+e("inventory.confirmAdjustments","Confirm Adjustments")}}),null),a(V,M(Ge,{get when(){return j().variances>0},get children(){var ue=JT(),ge=ue.firstChild,xe=ge.firstChild,pe=xe.firstChild,_e=pe.firstChild,Le=_e.nextSibling,De=Le.nextSibling,Te=De.nextSibling,$e=Te.nextSibling,Ie=xe.nextSibling;return ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius)"),ue.style.setProperty("overflow-x","auto"),ge.style.setProperty("width","100%"),ge.style.setProperty("border-collapse","collapse"),pe.style.setProperty("background","var(--surface-color)"),_e.style.setProperty("padding","1rem"),_e.style.setProperty("text-align","left"),_e.style.setProperty("border-bottom","1px solid var(--border-color)"),a(_e,()=>e("inventory.product","Product")),Le.style.setProperty("padding","1rem"),Le.style.setProperty("text-align","center"),Le.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Le,()=>e("inventory.systemQty","System Qty")),De.style.setProperty("padding","1rem"),De.style.setProperty("text-align","center"),De.style.setProperty("border-bottom","1px solid var(--border-color)"),a(De,()=>e("inventory.physicalCount","Physical Count")),Te.style.setProperty("padding","1rem"),Te.style.setProperty("text-align","center"),Te.style.setProperty("border-bottom","1px solid var(--border-color)"),a(Te,()=>e("inventory.adjustment","Adjustment")),$e.style.setProperty("padding","1rem"),$e.style.setProperty("text-align","left"),$e.style.setProperty("border-bottom","1px solid var(--border-color)"),a($e,()=>e("common.notes","Notes")),a(Ie,M(Ht,{get each(){return x().filter(Re=>Re.variance!==0)},children:Re=>(()=>{var Ke=tk(),je=Ke.firstChild,We=je.firstChild,Qe=We.nextSibling,at=Qe.firstChild,nt=je.nextSibling,Ye=nt.firstChild,ht=nt.nextSibling,lt=ht.firstChild,$t=ht.nextSibling,_t=$t.firstChild,ze=$t.nextSibling,Lt=ze.firstChild;return Ke.style.setProperty("border-bottom","1px solid var(--border-color)"),je.style.setProperty("padding","1rem"),We.style.setProperty("font-weight","500"),a(We,()=>Re.product.name),Qe.style.setProperty("font-size","0.875rem"),Qe.style.setProperty("color","var(--text-muted)"),a(Qe,()=>Re.product.sku,at),a(Qe,()=>Re.product.category,null),nt.style.setProperty("padding","1rem"),nt.style.setProperty("text-align","center"),Ye.style.setProperty("font-weight","600"),a(Ye,()=>Re.systemQuantity),ht.style.setProperty("padding","1rem"),ht.style.setProperty("text-align","center"),lt.style.setProperty("font-weight","600"),a(lt,()=>Re.physicalCount),$t.style.setProperty("padding","1rem"),$t.style.setProperty("text-align","center"),_t.style.setProperty("font-weight","700"),a(_t,()=>Re.variance>0?"+":"",null),a(_t,()=>Re.variance,null),ze.style.setProperty("padding","1rem"),Lt.style.setProperty("font-size","0.875rem"),a(Lt,()=>Re.notes||e("inventory.physicalCountAdjustment","Physical count adjustment")),Se(Nt=>{var wt=Re.variance>0?"#d4edda":"#f8d7da",Ot=Re.variance>0?"#4caf50":"#f44336";return wt!==Nt.e&&((Nt.e=wt)!=null?Ke.style.setProperty("background",wt):Ke.style.removeProperty("background")),Ot!==Nt.t&&((Nt.t=Ot)!=null?_t.style.setProperty("color",Ot):_t.style.removeProperty("color")),Nt},{e:void 0,t:void 0}),Ke})()})),ue}}),null),a(V,M(Ge,{get when(){return j().variances===0},get children(){var ue=QT(),ge=ue.firstChild,xe=ge.nextSibling,pe=xe.nextSibling;return ue.style.setProperty("text-align","center"),ue.style.setProperty("padding","3rem"),ue.style.setProperty("background","var(--surface-color)"),ue.style.setProperty("border-radius","var(--border-radius)"),ge.style.setProperty("font-size","3rem"),ge.style.setProperty("margin-bottom","1rem"),xe.style.setProperty("margin-bottom","0.5rem"),a(xe,()=>e("inventory.perfectCount","Perfect Count!")),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>e("inventory.noVariances","No variances found. Your physical count matches the system exactly.")),ue}}),null),V}}),null),q}})},ik=t=>{const{t:e}=sr(),[r,n]=Ce(""),[i,o]=Ce("");let{entry:s,updatePhysicalCount:l,updateNotes:c,index:u}=t;Sn(()=>{o(s?.notes),n(s?.physicalCount)});const h=()=>{let y=document.getElementById(`physicalCountInput_${u+2}`);if(console.log(pl(r()),!y),pl(r())&&!y){l(s?.productId,r()===""?null:parseFloat(r()));return}if(pl(r())&&y){y.focus(),l(s?.productId,r()===""?null:parseFloat(r()));return}};return(()=>{var y=rk(),g=y.firstChild,f=g.firstChild,x=g.nextSibling,S=x.firstChild,P=S.nextSibling,$=P.firstChild,U=$.nextSibling;U.nextSibling;var se=x.nextSibling,X=se.firstChild,Z=se.nextSibling,re=Z.firstChild,E=Z.nextSibling,C=E.firstChild,T=E.nextSibling,j=T.firstChild;return y.style.setProperty("border-bottom","1px solid var(--border-color)"),g.style.setProperty("padding","1rem"),g.style.setProperty("text-align","center"),f.style.setProperty("font-weight","600"),a(f,u+1),x.style.setProperty("padding","1rem"),S.style.setProperty("font-weight","500"),a(S,()=>s?.product.name),P.style.setProperty("font-size","0.875rem"),P.style.setProperty("color","var(--text-muted)"),a(P,()=>s?.product.sku,$),a(P,()=>s?.product.category,U),a(P,()=>s?.product.unitOfMeasure,null),se.style.setProperty("padding","1rem"),se.style.setProperty("text-align","center"),X.style.setProperty("font-weight","600"),a(X,()=>s?.systemQuantity),Z.style.setProperty("padding","1rem"),Z.style.setProperty("text-align","center"),re.addEventListener("blur",()=>{h()}),re.$$keydown=b=>{b.keyCode===13&&h(),b.keyCode===27&&h(),b.keyCode},re.$$input=b=>{const w=b.target.value;n(w)},nr(re,"id",`physicalCountInput_${u+1}`),nr(re,"tabindex",u),re.style.setProperty("width","100px"),re.style.setProperty("padding","0.5rem"),re.style.setProperty("border","1px solid var(--border-color)"),re.style.setProperty("border-radius","var(--border-radius-sm)"),re.style.setProperty("text-align","center"),E.style.setProperty("padding","1rem"),E.style.setProperty("text-align","center"),C.style.setProperty("font-weight","600"),a(C,()=>s?.variance>0?"+":"",null),a(C,()=>s?.variance||"—",null),T.style.setProperty("padding","1rem"),j.addEventListener("blur",b=>{c(s?.productId,i())}),j.$$keydown=b=>{b.keyCode===13&&c(s?.productId,i()),b.keyCode===27&&c(s?.productId,i()),b.keyCode===9&&c(s?.productId,i())},j.$$input=b=>{const w=b.target.value;o(w)},j.style.setProperty("width","200px"),j.style.setProperty("padding","0.5rem"),j.style.setProperty("border","1px solid var(--border-color)"),j.style.setProperty("border-radius","var(--border-radius-sm)"),Se(b=>{var w=s?.physicalCount!==null?s?.variance!==0?"#fff3cd":"#d4edda":"transparent",_=s?.variance>0?"#4caf50":s?.variance<0?"#f44336":"var(--text-muted)",W=e("inventory.addNotes","Add notes...");return w!==b.e&&((b.e=w)!=null?y.style.setProperty("background",w):y.style.removeProperty("background")),_!==b.t&&((b.t=_)!=null?C.style.setProperty("color",_):C.style.removeProperty("color")),W!==b.a&&nr(j,"placeholder",b.a=W),b},{e:void 0,t:void 0,a:void 0}),Se(()=>re.value=r()||""),Se(()=>j.value=i()||""),y})()};yr(["click","input","keydown"]);function ok(t,e=300,r=!1){let n,i;const o=()=>{n!==void 0&&(clearTimeout(n),n=void 0),i=void 0},s=()=>{n!==void 0&&i!==void 0&&(clearTimeout(n),n=void 0,t(...i),i=void 0)},l=(...c)=>{i=c,n!==void 0&&clearTimeout(n),r&&n===void 0&&t(...c),n=window.setTimeout(()=>{r||t(...c),n=void 0,i=void 0},e)};return xl(()=>{o()}),{debounced:l,cancel:o,flush:s}}function sk(t,e=300){const[r,n]=Ce(!1);let i;const o=async u=>{if(i&&i.abort(),!u.trim()){n(!1);return}i=new AbortController,n(!0);try{await t(u)}catch(h){h instanceof Error&&h.name!=="AbortError"&&console.error("Search error:",h)}finally{i.signal.aborted||n(!1)}},{debounced:s,cancel:l}=ok(o,e,!1),c=()=>{l(),i&&i.abort(),n(!1)};return xl(()=>{c()}),{search:s,isSearching:r,cancel:c}}var P0=he("<div>"),ak=he("<div><h3></h3><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),lk=he("<div><h3></h3><div><div><div><span></span><span></span></div><div><span></span><span></span></div></div><div><div><span></span><span></span></div><div><span></span><span>%"),ck=he("<div><h4>"),uk=he("<div><h3></h3><div><div><div><span></span><span> </span></div><div><span></span><span> </span></div></div><div><div><span></span><span> </span></div><div><span></span><span>"),dk=he("<div><h3></h3><div><span></span><span></span></div><div><span></span><span>"),w0=he("<div><h3>"),hk=he("<div><div><div><h2></h2><div>SKU: <!> • </div></div><div></div></div><div><button></button><button></button><button></button></div><div>"),pk=he("<span>✓ "),fk=he("<span>✗ "),mk=he("<div><div><span><span> • </span></span><span> </span></div><div>: <!> • <!>: "),yk=he("<div>📦 "),gk=he("<div>Ref: "),vk=he("<div><div><div><span></span><span></span><span></span></div><div><span></span></div></div><div><div> </div><div>"),bk=he("<div><h4></h4><div></div><div>"),_k=he("<div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div> <!> × </div></div><div><h4></h4><div></div><div></div></div><div><h4></h4><div></div><div>Min: <!> • Max: ");const Sk=t=>{const{t:e}=sr(),[r,n]=Ce("details"),i=Dt(()=>{if(!t.product)return null;const T=ct.getTotalStockByProduct(t.product.id),j=ct.getStockByProduct(t.product.id),b=T<=t.product.minStockLevel,w=T===0,_=T>=t.product.maxStockLevel;return{total:T,byLocation:j,status:w?"out":b?"low":_?"over":"good",statusText:w?e("products.outOfStock","Out of Stock"):b?e("products.lowStock","Low Stock"):_?e("products.overStock","Over Stock"):e("products.inStock","In Stock")}}),o=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T),s=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),l=Dt(()=>!t.product||t.product.unitCost===0?0:((t.product.sellingPrice-t.product.unitCost)/t.product.unitCost*100).toFixed(2)),c=Dt(()=>t.product?ct.movements.filter(T=>T.productId===t.product.id).sort((T,j)=>new Date(j.createdDate).getTime()-new Date(T.createdDate).getTime()):[]),u=Dt(()=>{if(!t.product)return null;const T=c(),j=i(),b=new Date;b.setDate(b.getDate()-30);const w=T.filter(W=>new Date(W.createdDate)>=b),_=T.reduce((W,K)=>{const k=K.productId===t.product.id?K:null;return W+(k?k.quantity*k.unitCost:0)},0);return{recentMovements:T.length,movements30Days:w.length,totalValue:(j?.total||0)*t.product.unitCost,averageMovementValue:T.length>0?_/T.length:0,lastMovementDate:T.length>0?T[0].createdDate:null}}),h={"margin-bottom":"2rem"},y={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},g={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},f={"font-weight":"400",color:"var(--text-primary)","font-size":"1rem"},x=T=>({in:"📦",out:"📤",transfer:"🔄",adjustment:"⚖️"})[T]||"📋";function S(T){return{in:{bg:"#e8f5e8",color:"#2d7d32"},out:{bg:"#ffebee",color:"#d32f2f"},transfer:{bg:"#e3f2fd",color:"#1976d2"},adjustment:{bg:"#fff3e0",color:"#f57c00"}}[T]||{bg:"#f5f5f5",color:"#666"}}const P=T=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:S(T).bg,color:S(T).color}),$=T=>{const j={good:{background:"#d4edda",color:"#155724"},low:{background:"#fff3cd",color:"#856404"},out:{background:"#f8d7da",color:"#721c24"},over:{background:"#cce5ff",color:"#004085"}};return{display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.875rem","font-weight":"500",...j[T]||j.good}},U={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"},se={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-bottom":"0.75rem"},X={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1.5rem","padding-bottom":"1rem","border-bottom":"2px solid var(--border-color)"},Z={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},re=T=>({padding:"0.75rem 1.5rem",background:"none",border:"none","border-bottom":T?"2px solid var(--primary-color)":"2px solid transparent",color:T?"var(--primary-color)":"var(--text-muted)","font-weight":T?"600":"400",cursor:"pointer",transition:"all 0.2s","font-size":"0.875rem"}),E={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-bottom":"0.5rem"},C={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1.5rem","margin-bottom":"1rem"};return M(Fn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("products.productDetails","Product Details")},size:"large",get children(){return M(Ge,{get when(){return t.product},get fallback(){return(()=>{var T=P0();return T.style.setProperty("text-align","center"),T.style.setProperty("padding","2rem"),T.style.setProperty("color","var(--text-muted)"),a(T,()=>e("products.noProductSelected","No product selected")),T})()},children:T=>(()=>{var j=hk(),b=j.firstChild,w=b.firstChild,_=w.firstChild,W=_.nextSibling,K=W.firstChild,k=K.nextSibling;k.nextSibling;var R=w.nextSibling,Y=b.nextSibling,q=Y.firstChild,O=q.nextSibling,le=O.nextSibling,N=Y.nextSibling;return a(j,()=>JSON.stringify(T),b),m(b,X),_.style.setProperty("margin","0"),_.style.setProperty("font-size","1.5rem"),_.style.setProperty("margin-bottom","0.25rem"),a(_,()=>T().name),W.style.setProperty("color","var(--text-muted)"),a(W,()=>T().sku,k),a(W,()=>T().category,null),a(R,()=>i()?.statusText),m(Y,Z),q.$$click=()=>n("details"),a(q,()=>e("products.details","Details")),O.$$click=()=>n("movements"),a(O,()=>e("products.movements","Movements")),le.$$click=()=>n("analytics"),a(le,()=>e("products.analytics","Analytics")),a(j,M(Ge,{get when(){return r()==="details"},get children(){return[(()=>{var D=ak(),V=D.firstChild,I=V.nextSibling,F=I.firstChild,Q=F.nextSibling,H=I.nextSibling,J=H.firstChild,te=J.nextSibling,ee=H.nextSibling,ne=ee.firstChild,G=ne.nextSibling;return V.style.setProperty("margin-bottom","1rem"),V.style.setProperty("font-size","1.1rem"),a(V,()=>e("products.basicInformation","Basic Information")),a(F,()=>e("products.description","Description")),a(Q,()=>T().description||e("common.notAvailable","N/A")),a(J,()=>e("products.unitOfMeasure","Unit of Measure")),a(te,()=>T().unitOfMeasure),a(ne,()=>e("products.status","Status")),a(G,(()=>{var ce=Ee(()=>!!T().isActive);return()=>ce()?(()=>{var oe=pk();return oe.firstChild,oe.style.setProperty("color","#2e7d32"),a(oe,()=>e("common.active","Active"),null),oe})():(()=>{var oe=fk();return oe.firstChild,oe.style.setProperty("color","#d32f2f"),a(oe,()=>e("common.inactive","Inactive"),null),oe})()})()),Se(ce=>{var oe=h,z=y,de=g,fe=f,ue=y,ge=g,xe=f,pe=y,_e=g,Le=f;return ce.e=m(D,oe,ce.e),ce.t=m(I,z,ce.t),ce.a=m(F,de,ce.a),ce.o=m(Q,fe,ce.o),ce.i=m(H,ue,ce.i),ce.n=m(J,ge,ce.n),ce.s=m(te,xe,ce.s),ce.h=m(ee,pe,ce.h),ce.r=m(ne,_e,ce.r),ce.d=m(G,Le,ce.d),ce},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),D})(),(()=>{var D=lk(),V=D.firstChild,I=V.nextSibling,F=I.firstChild,Q=F.firstChild,H=Q.firstChild,J=H.nextSibling,te=Q.nextSibling,ee=te.firstChild,ne=ee.nextSibling,G=F.nextSibling,ce=G.firstChild,oe=ce.firstChild,z=oe.nextSibling,de=ce.nextSibling,fe=de.firstChild,ue=fe.nextSibling,ge=ue.firstChild;return V.style.setProperty("margin-bottom","1rem"),V.style.setProperty("font-size","1.1rem"),a(V,()=>e("products.pricingInformation","Pricing Information")),a(H,()=>e("products.unitCost","Unit Cost")),a(J,()=>o(T().unitCost)),a(ee,()=>e("products.sellingPrice","Selling Price")),a(ne,()=>o(T().sellingPrice)),a(oe,()=>e("products.profit","Profit")),a(z,()=>o(T().sellingPrice-T().unitCost)),a(fe,()=>e("products.profitMargin","Profit Margin")),a(ue,l,ge),Se(xe=>{var pe=h,_e=U,Le=y,De=g,Te=f,$e=y,Ie=g,Re=f,Ke=y,je=g,We=f,Qe=y,at=g,nt=f;return xe.e=m(D,pe,xe.e),xe.t=m(I,_e,xe.t),xe.a=m(Q,Le,xe.a),xe.o=m(H,De,xe.o),xe.i=m(J,Te,xe.i),xe.n=m(te,$e,xe.n),xe.s=m(ee,Ie,xe.s),xe.h=m(ne,Re,xe.h),xe.r=m(ce,Ke,xe.r),xe.d=m(oe,je,xe.d),xe.l=m(z,We,xe.l),xe.u=m(de,Qe,xe.u),xe.c=m(fe,at,xe.c),xe.w=m(ue,nt,xe.w),xe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),D})(),(()=>{var D=uk(),V=D.firstChild,I=V.nextSibling,F=I.firstChild,Q=F.firstChild,H=Q.firstChild,J=H.nextSibling,te=J.firstChild,ee=Q.nextSibling,ne=ee.firstChild,G=ne.nextSibling,ce=G.firstChild,oe=F.nextSibling,z=oe.firstChild,de=z.firstChild,fe=de.nextSibling,ue=fe.firstChild,ge=z.nextSibling,xe=ge.firstChild,pe=xe.nextSibling;return V.style.setProperty("margin-bottom","1rem"),V.style.setProperty("font-size","1.1rem"),a(V,()=>e("products.stockInformation","Stock Information")),a(H,()=>e("products.totalStock","Total Stock")),a(J,()=>i()?.total||0,te),a(J,()=>T().unitOfMeasure,null),a(ne,()=>e("products.minStockLevel","Min Stock Level")),a(G,()=>T().minStockLevel,ce),a(G,()=>T().unitOfMeasure,null),a(de,()=>e("products.maxStockLevel","Max Stock Level")),a(fe,()=>T().maxStockLevel,ue),a(fe,()=>T().unitOfMeasure,null),a(xe,()=>e("products.stockValue","Stock Value")),a(pe,()=>o((i()?.total||0)*T().unitCost)),a(D,M(Ge,{get when(){return Ee(()=>!!i()?.byLocation)()&&i().byLocation.length>0},get children(){var _e=ck(),Le=_e.firstChild;return _e.style.setProperty("margin-top","1.5rem"),Le.style.setProperty("margin-bottom","1rem"),Le.style.setProperty("font-size","1rem"),a(Le,()=>e("products.stockByLocation","Stock by Location")),a(_e,()=>i().byLocation.map(De=>(()=>{var Te=mk(),$e=Te.firstChild,Ie=$e.firstChild,Re=Ie.firstChild;Re.firstChild;var Ke=Ie.nextSibling,je=Ke.firstChild,We=$e.nextSibling,Qe=We.firstChild,at=Qe.nextSibling,nt=at.nextSibling,Ye=nt.nextSibling;return Ye.nextSibling,m(Te,se),$e.style.setProperty("display","flex"),$e.style.setProperty("justify-content","space-between"),$e.style.setProperty("align-items","center"),Ie.style.setProperty("font-weight","500"),Ie.style.setProperty("color","var(--primary-color)"),a(Ie,()=>De.locationId,Re),Re.style.setProperty("font-weight","500"),Re.style.setProperty("color","var(--text-muted)"),a(Re,()=>De.locationName,null),Ke.style.setProperty("font-weight","600"),a(Ke,()=>De.quantity,je),a(Ke,()=>T().unitOfMeasure,null),We.style.setProperty("margin-top","0.5rem"),We.style.setProperty("font-size","0.875rem"),We.style.setProperty("color","var(--text-muted)"),a(We,()=>e("products.available","Available"),Qe),a(We,()=>De.availableQuantity,at),a(We,()=>e("products.reserved","Reserved"),Ye),a(We,()=>De.reservedQuantity,null),Se(ht=>(ht=De.quantity>0?"var(--primary-color)":"var(--text-muted)")!=null?Ke.style.setProperty("color",ht):Ke.style.removeProperty("color")),Te})()),null),_e}}),null),Se(_e=>{var Le=h,De=U,Te=y,$e=g,Ie=f,Re=y,Ke=g,je=f,We=y,Qe=g,at=f,nt=y,Ye=g,ht=f;return _e.e=m(D,Le,_e.e),_e.t=m(I,De,_e.t),_e.a=m(Q,Te,_e.a),_e.o=m(H,$e,_e.o),_e.i=m(J,Ie,_e.i),_e.n=m(ee,Re,_e.n),_e.s=m(ne,Ke,_e.s),_e.h=m(G,je,_e.h),_e.r=m(z,We,_e.r),_e.d=m(de,Qe,_e.d),_e.l=m(fe,at,_e.l),_e.u=m(ge,nt,_e.u),_e.c=m(xe,Ye,_e.c),_e.w=m(pe,ht,_e.w),_e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0}),D})(),(()=>{var D=dk(),V=D.firstChild,I=V.nextSibling,F=I.firstChild,Q=F.nextSibling,H=I.nextSibling,J=H.firstChild,te=J.nextSibling;return V.style.setProperty("margin-bottom","1rem"),V.style.setProperty("font-size","1.1rem"),a(V,()=>e("products.timestamps","Timestamps")),a(F,()=>e("common.createdDate","Created Date")),a(Q,()=>s(T().createdDate)),a(J,()=>e("common.lastModified","Last Modified")),a(te,()=>s(T().lastModified)),Se(ee=>{var ne=h,G=y,ce=g,oe=f,z=y,de=g,fe=f;return ee.e=m(D,ne,ee.e),ee.t=m(I,G,ee.t),ee.a=m(F,ce,ee.a),ee.o=m(Q,oe,ee.o),ee.i=m(H,z,ee.i),ee.n=m(J,de,ee.n),ee.s=m(te,fe,ee.s),ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),D})()]}}),N),a(j,M(Ge,{get when(){return r()==="movements"},get children(){var D=w0(),V=D.firstChild;return V.style.setProperty("margin-bottom","1rem"),V.style.setProperty("font-size","1.1rem"),a(V,()=>e("products.recentMovements","Recent Movements")),a(D,M(Ge,{get when(){return c().length>0},get fallback(){return(()=>{var I=yk();return I.firstChild,I.style.setProperty("text-align","center"),I.style.setProperty("padding","2rem"),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("border","1px solid var(--border-color)"),a(I,()=>e("products.noMovements","No movements found for this product"),null),I})()},get children(){return M(Ht,{get each(){return c()},children:I=>{const F=I.productId===T().id?I:null;if(!F)return null;let Q=ct.getLocationById(I.locationId);return(()=>{var H=vk(),J=H.firstChild,te=J.firstChild,ee=te.firstChild,ne=ee.nextSibling,G=ne.nextSibling,ce=te.nextSibling,oe=ce.firstChild,z=J.nextSibling,de=z.firstChild,fe=de.firstChild,ue=de.nextSibling;return m(H,E),te.style.setProperty("font-weight","600"),te.style.setProperty("margin-bottom","0.25rem"),ee.style.setProperty("font-size","1.2rem"),a(ee,()=>x(I.movementType)),ne.style.setProperty("padding","0 6px"),a(G,()=>I.movementType),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),a(ce,()=>` ${s(I?.createdDate)} • `,oe),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("font-weight","600"),oe.style.setProperty("color","var(--primary-color)"),a(oe,()=>I?.locationId),a(ce,()=>` • ${Q?.name}`,null),a(J,M(Ge,{get when(){return I.referenceNumber},get children(){var ge=gk();return ge.firstChild,ge.style.setProperty("font-size","0.75rem"),ge.style.setProperty("color","var(--text-muted)"),ge.style.setProperty("margin-top","0.25rem"),a(ge,()=>I?.referenceNumber,null),ge}}),null),z.style.setProperty("text-align","right"),de.style.setProperty("font-weight","600"),de.style.setProperty("font-size","1rem"),a(de,()=>I?.movementType==="in"?"+":"",fe),a(de,()=>F.quantity,fe),a(de,()=>T().unitOfMeasure,null),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),a(ue,()=>o(F.unitCost)),Se(ge=>{var xe=P(I.movementType),pe=I?.movementType==="in"?"#2e7d32":"#d32f2f";return ge.e=m(G,xe,ge.e),pe!==ge.t&&((ge.t=pe)!=null?de.style.setProperty("color",pe):de.style.removeProperty("color")),ge},{e:void 0,t:void 0}),H})()}})}}),null),Se(I=>m(D,h,I)),D}}),N),a(j,M(Ge,{get when(){return r()==="analytics"},get children(){var D=w0(),V=D.firstChild;return V.style.setProperty("margin-bottom","1rem"),V.style.setProperty("font-size","1.1rem"),a(V,()=>e("products.analytics","Analytics")),a(D,M(Ge,{get when(){return u()},get fallback(){return(()=>{var I=P0();return I.style.setProperty("text-align","center"),I.style.setProperty("padding","2rem"),I.style.setProperty("color","var(--text-muted)"),a(I,()=>e("products.noAnalytics","No analytics data available")),I})()},children:I=>(()=>{var F=_k(),Q=F.firstChild,H=Q.firstChild,J=H.nextSibling,te=J.nextSibling,ee=Q.nextSibling,ne=ee.firstChild,G=ne.nextSibling,ce=G.nextSibling,oe=ee.nextSibling,z=oe.firstChild,de=z.nextSibling,fe=de.nextSibling,ue=fe.firstChild,ge=ue.nextSibling;ge.nextSibling;var xe=oe.nextSibling,pe=xe.firstChild,_e=pe.nextSibling,Le=_e.nextSibling,De=xe.nextSibling,Te=De.firstChild,$e=Te.nextSibling,Ie=$e.nextSibling,Re=Ie.firstChild,Ke=Re.nextSibling;return Ke.nextSibling,H.style.setProperty("margin","0 0 0.5rem 0"),H.style.setProperty("color","var(--primary-color)"),a(H,()=>e("products.totalMovements","Total Movements")),J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),a(J,()=>I().recentMovements),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),te.style.setProperty("margin-top","0.25rem"),a(te,()=>e("products.allTime","All time")),ne.style.setProperty("margin","0 0 0.5rem 0"),ne.style.setProperty("color","var(--primary-color)"),a(ne,()=>e("products.last30Days","Last 30 Days")),G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","600"),a(G,()=>I().movements30Days),ce.style.setProperty("font-size","0.875rem"),ce.style.setProperty("color","var(--text-muted)"),ce.style.setProperty("margin-top","0.25rem"),a(ce,()=>e("products.movements","movements")),z.style.setProperty("margin","0 0 0.5rem 0"),z.style.setProperty("color","var(--primary-color)"),a(z,()=>e("products.currentValue","Current Stock Value")),de.style.setProperty("font-size","1.5rem"),de.style.setProperty("font-weight","600"),a(de,()=>o(I().totalValue)),fe.style.setProperty("font-size","0.875rem"),fe.style.setProperty("color","var(--text-muted)"),fe.style.setProperty("margin-top","0.25rem"),a(fe,()=>i()?.total||0,ue),a(fe,()=>T().unitOfMeasure,ge),a(fe,()=>o(T().unitCost),null),pe.style.setProperty("margin","0 0 0.5rem 0"),pe.style.setProperty("color","var(--primary-color)"),a(pe,()=>e("products.avgMovementValue","Avg Movement Value")),_e.style.setProperty("font-size","1.5rem"),_e.style.setProperty("font-weight","600"),a(_e,()=>o(I().averageMovementValue)),Le.style.setProperty("font-size","0.875rem"),Le.style.setProperty("color","var(--text-muted)"),Le.style.setProperty("margin-top","0.25rem"),a(Le,()=>e("products.perMovement","per movement")),a(F,M(Ge,{get when(){return I().lastMovementDate},get children(){var je=bk(),We=je.firstChild,Qe=We.nextSibling,at=Qe.nextSibling;return We.style.setProperty("margin","0 0 0.5rem 0"),We.style.setProperty("color","var(--primary-color)"),a(We,()=>e("products.lastMovement","Last Movement")),Qe.style.setProperty("font-size","1.25rem"),Qe.style.setProperty("font-weight","600"),a(Qe,()=>s(I().lastMovementDate)),at.style.setProperty("font-size","0.875rem"),at.style.setProperty("color","var(--text-muted)"),at.style.setProperty("margin-top","0.25rem"),a(at,()=>e("products.mostRecent","Most recent activity")),Se(nt=>m(je,C,nt)),je}}),De),Te.style.setProperty("margin","0 0 0.5rem 0"),Te.style.setProperty("color","var(--primary-color)"),a(Te,()=>e("products.stockStatus","Stock Status")),$e.style.setProperty("font-size","1.25rem"),$e.style.setProperty("font-weight","600"),a($e,()=>i()?.statusText),Ie.style.setProperty("font-size","0.875rem"),Ie.style.setProperty("color","var(--text-muted)"),Ie.style.setProperty("margin-top","0.25rem"),a(Ie,()=>T().minStockLevel,Ke),a(Ie,()=>T().maxStockLevel,null),Se(je=>{var We=U,Qe=C,at=C,nt=C,Ye=C,ht=C;return je.e=m(F,We,je.e),je.t=m(Q,Qe,je.t),je.a=m(ee,at,je.a),je.o=m(oe,nt,je.o),je.i=m(xe,Ye,je.i),je.n=m(De,ht,je.n),je},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),F})()}),null),Se(I=>m(D,h,I)),D}}),N),N.style.setProperty("display","flex"),N.style.setProperty("gap","1rem"),N.style.setProperty("justify-content","flex-end"),N.style.setProperty("margin-top","2rem"),a(N,M(dt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close","Close")}}),null),a(N,M(Ge,{get when(){return t.onEdit},get children(){return M(dt,{variant:"primary",get onClick(){return t.onEdit},get children(){return e("common.edit","Edit")}})}}),null),Se(D=>{var V=$(i()?.status||"good"),I=re(r()==="details"),F=re(r()==="movements"),Q=re(r()==="analytics");return D.e=m(R,V,D.e),D.t=m(q,I,D.t),D.a=m(O,F,D.a),D.o=m(le,Q,D.o),D},{e:void 0,t:void 0,a:void 0,o:void 0}),j})()})}})};yr(["click"]);var Pk=he("<div>🔄"),wk=he("<button type=button>×"),xk=he("<div>⚠️ "),x0=he("<div>"),Ak=he("<div><div><input type=text autocomplete=off>"),Ck=he("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div>"),Ik=he("<span>⚠️ ");const $k=t=>{const{t:e}=sr(),[r,n]=Ce(""),[i,o]=Ce(!1),[s,l]=Ce(null),[c,u]=Ce([]),[h,y]=Ce(!1),[g,f]=Ce(-1),[x,S]=Ce(null),P=t.searchDelay||300,$=t.maxResults||900,U=async I=>{if(!I.trim()||I.trim().length<3){u([]),t.onSearchResults?.([]);return}try{o(!0),l(null);try{const F=await gi.getProducts(I),Q=Object.keys(F),H=te=>{let ee=F;return{id:te,name:ee[te].name,businessId:ee[te].businessId,sku:ee[te].code,UPC:ee[te].UPC,numCode:ee[te].codeN,category:ee[te].category,unitCost:ee[te].unitCost||0,unitOfMeasure:ee[te].unitOfMeasure,minStockLevel:ee[te].minStockLevel,maxStockLevel:ee[te].maxStockLevel,isActive:ee[te].isActive,description:ee[te].description||"",createdDate:ee[te].createdAt||new Date().toISOString(),lastModified:ee[te].updatedAt||new Date().toISOString()}},J=Q.map(H);u(J),ct.updProduct(J),t.onSearchResults?.(J)}catch(F){console.warn("API search failed, using local fallback:",F),l("API search failed, showing local results");const Q=ct.getActiveProducts().filter(H=>H.name.toLowerCase().includes(I.toLowerCase())||H.sku.toLowerCase().includes(I.toLowerCase())||H.category.toLowerCase().includes(I.toLowerCase())).slice(0,$);u(Q),t.onSearchResults?.(Q)}}catch(F){const Q=F instanceof Error?F.message:"Search failed";l(Q),u([]),t.onSearchResults?.([])}finally{o(!1)}},se=I=>{const Q=I.target.value;n(Q),l(null),t.showResults!==!1&&y(!0),x()&&clearTimeout(x());const H=setTimeout(()=>{U(Q)},P);S(H)},X=I=>{n(I.name),y(!1),f(-1),t.onProductSelect?.(I)},Z=I=>{if(!(!h()||c().length===0))switch(I.key){case"ArrowDown":I.preventDefault(),f(F=>Math.min(F+1,c().length-1));break;case"ArrowUp":I.preventDefault(),f(F=>Math.max(F-1,-1));break;case"Enter":I.preventDefault(),g()>=0&&c()[g()]&&X(c()[g()]);break;case"Escape":y(!1),f(-1);break}},re=()=>{t.showResults!==!1&&c().length>0&&y(!0)},E=()=>{setTimeout(()=>{y(!1),f(-1)},150)},C=()=>{n(""),u([]),l(null),y(!1),f(-1),t.onSearchResults?.([]),x()&&(clearTimeout(x()),S(null))},T=I=>ct.stockLevels.filter(F=>F.productId===I).reduce((F,Q)=>F+Q.quantity,0),j=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),b={position:"relative",width:"100%",...t.style},w={position:"relative",display:"flex","align-items":"center"},_={width:"100%",padding:"0.75rem","padding-right":r()?"2.5rem":"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1",outline:"none",transition:"border-color 0.2s ease"},W={position:"absolute",right:"0.5rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)","font-size":"1.2rem","line-height":"1",padding:"0.25rem","border-radius":"50%",transition:"all 0.2s ease"},K={position:"absolute",right:r()?"2.5rem":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)"},k={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},R=I=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:I?"var(--strip-color)":"transparent",transition:"background-color 0.2s ease"}),Y={display:"flex","justify-content":"space-between","align-items":"center"},q={flex:"1"},O={"font-weight":"500","margin-bottom":"0.25rem",color:"var(--text-primary)"},le={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem"},N={"text-align":"right","font-size":"0.875rem"},D={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},V={padding:"0.5rem 1rem",background:"#fff3cd",color:"#856404","border-bottom":"1px solid var(--border-color)","font-size":"0.875rem"};return(()=>{var I=Ak(),F=I.firstChild,Q=F.firstChild;return Q.addEventListener("blur",E),Q.addEventListener("focus",re),Q.$$keydown=Z,Q.$$input=se,a(F,M(Ge,{get when(){return i()},get children(){var H=Pk();return Se(J=>m(H,K,J)),H}}),null),a(F,M(Ge,{get when(){return Ee(()=>!!r())()&&!i()},get children(){var H=wk();return H.addEventListener("mouseleave",J=>{J.currentTarget.style.background="none",J.currentTarget.style.color="var(--text-muted)"}),H.addEventListener("mouseenter",J=>{J.currentTarget.style.background="var(--border-color)",J.currentTarget.style.color="var(--text-primary)"}),H.$$click=C,Se(J=>{var te=W,ee=e("common.clear","Clear search");return J.e=m(H,te,J.e),ee!==J.t&&nr(H,"title",J.t=ee),J},{e:void 0,t:void 0}),H}}),null),a(I,M(Ge,{get when(){return h()&&t.showResults!==!1},get children(){var H=x0();return a(H,M(Ge,{get when(){return s()},get children(){var J=xk();return J.firstChild,m(J,V),a(J,s,null),J}}),null),a(H,M(Ge,{get when(){return c().length>0},get fallback(){return Ee(()=>!!(r()&&!i()))()&&(()=>{var J=x0();return m(J,D),a(J,()=>e("inventory.noProductsFound","No products found matching your search.")),J})()},get children(){return M(Ht,{get each(){return c()},children:(J,te)=>{const ee=T(J.id),ne=ee<=J.minStockLevel;return(()=>{var G=Ck(),ce=G.firstChild,oe=ce.firstChild,z=oe.firstChild,de=z.nextSibling,fe=de.firstChild,ue=fe.firstChild,ge=fe.nextSibling,xe=ge.nextSibling,pe=xe.nextSibling,_e=pe.nextSibling,Le=oe.nextSibling,De=Le.firstChild,Te=De.firstChild,$e=De.nextSibling;return G.addEventListener("mouseenter",()=>f(te())),G.$$click=()=>X(J),m(ce,Y),m(oe,q),m(z,O),a(z,()=>J.name),m(de,le),a(fe,()=>e("inventory.sku","SKU"),ue),a(fe,()=>J.sku,null),a(xe,()=>J.category),a(_e,()=>j(J.unitCost)),m(Le,N),De.style.setProperty("font-weight","600"),(ne?"#f44336":"var(--text-primary)")!=null?De.style.setProperty("color",ne?"#f44336":"var(--text-primary)"):De.style.removeProperty("color"),a(De,ee,Te),a(De,()=>J.unitOfMeasure,null),$e.style.setProperty("color","var(--text-muted)"),a($e,()=>ne?(()=>{var Ie=Ik();return Ie.firstChild,Ie.style.setProperty("color","#f44336"),a(Ie,()=>e("inventory.lowStock","Low Stock"),null),Ie})():e("inventory.inStock","In Stock")),Se(Ie=>m(G,R(te()===g()),Ie)),G})()}})}}),null),Se(J=>m(H,k,J)),H}}),null),Se(H=>{var J=b,te=w,ee=_,ne=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),G=t.disabled;return H.e=m(I,J,H.e),H.t=m(F,te,H.t),H.a=m(Q,ee,H.a),ne!==H.o&&nr(Q,"placeholder",H.o=ne),G!==H.i&&(Q.disabled=H.i=G),H},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>Q.value=r()),I})()};yr(["input","keydown","click"]);var Ek=he("<div><div><h2></h2><div><div>"),Tk=he("<div><span>"),kk=he("<span>🔍 "),Nk=he("<div><div><div><div><h3></h3><span></span></div><div></div><div>: </div></div><div><div></div><div> • <!>: </div><div>: "),Lk=he("<div><div>:</div><div>"),Rk=he("<div>: "),Dk=he("<div><div><span>:</span><select><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option></select></div><div><div><span></span><input type=number min=1><span> </span></div></div><div>");const k5=()=>{const{t}=sr(),[e,r]=Ce(""),[n,i]=Ce(""),[o,s]=Ce([]),[l,c]=Ce(!1),[u,h]=Ce(null),[y,g]=Ce(!1),[f,x]=Ce(!1),[S,P]=Ce(!1),[$,U]=Ce(null),[se,X]=Ce(!1),[Z,re]=Ce([]),[E,C]=Ce(!1),[T,j]=Ce(1),[b,w]=Ce(20);Sn(async()=>{await _()});const _=async()=>{try{c(!0),h(null);try{const I=await o0.getAll();s(I.map(F=>({id:F.id||`prod-${Date.now()}-${Math.random()}`,name:F.productName||F.name||"Unknown Product",sku:F.sku||F.productCode||"",description:F.description||"",category:F.category||"General",unitOfMeasure:F.unitOfMeasure||"pcs",unitCost:parseFloat(F.unitCost||F.cost||"0"),sellingPrice:parseFloat(F.sellingPrice||F.price||"0"),minStockLevel:parseInt(F.minStockLevel||"0"),maxStockLevel:parseInt(F.maxStockLevel||"100"),isActive:F.isActive!==!1,createdDate:F.createdDate||new Date().toISOString(),lastModified:F.lastModified||new Date().toISOString(),businessId:F.businessId||"YB100423253156428"})))}catch(I){console.warn("API failed, using local store:",I),s(ct.products)}}catch(I){h(I instanceof Error?I.message:"Failed to load products")}finally{c(!1)}},W=async()=>{try{c(!0),h(null);try{const I=await gi.getProducts("prod"),F=Object.keys(I),Q=J=>{let ee=I[J];return{id:ee.id,name:ee.name,businessId:ee.businessId,sku:ee.code,numCode:ee.codeN,category:ee.category,unitCost:ee.unitCost||0,unitOfMeasure:ee.unitOfMeasure,minStockLevel:ee.minStockLevel,maxStockLevel:ee.maxStockLevel,isActive:ee.isActive,description:ee.description||"",createdDate:ee.createdAt||new Date().toISOString(),lastModified:ee.updatedAt||new Date().toISOString(),sellingPrice:parseFloat(ee.sellingPrice||ee.price||"0")}},H=F.map(Q);s(H)}catch(I){console.warn("API failed, using local store:",I),s(ct.products)}}catch(I){h(I instanceof Error?I.message:"Failed to load products")}finally{c(!1)}},{cancel:K}=sk(async I=>{if(!I.trim()){await _();return}try{h(null);const F=await o0.getAll(I);s(F.map(Q=>({id:Q.id||`prod-${Date.now()}-${Math.random()}`,name:Q.productName||Q.name||"Unknown Product",sku:Q.sku||Q.productCode||"",description:Q.description||"",category:Q.category||"General",unitOfMeasure:Q.unitOfMeasure||"pcs",unitCost:parseFloat(Q.unitCost||Q.cost||"0"),sellingPrice:parseFloat(Q.sellingPrice||Q.price||"0"),minStockLevel:parseInt(Q.minStockLevel||"0"),maxStockLevel:parseInt(Q.maxStockLevel||"100"),isActive:Q.isActive!==!1,createdDate:Q.createdDate||new Date().toISOString(),lastModified:Q.lastModified||new Date().toISOString(),businessId:Q.businessId||"YB100423253156428"})))}catch(F){h(F instanceof Error?F.message:"Search failed");const Q=ct.products.filter(H=>H.name.toLowerCase().includes(I.toLowerCase())||H.sku.toLowerCase().includes(I.toLowerCase())||H.category.toLowerCase().includes(I.toLowerCase()));s(Q)}},300);xl(()=>{K()}),Dt(()=>{let I=o();return n()&&(I=I.filter(F=>F.category===n())),I}),Dt(()=>[...new Set(o().map(F=>F.category))].sort()),Dt(()=>{const I=o().filter(H=>H.isActive),F=o().length,Q=o().filter(H=>ct.getTotalStockByProduct(H.id)===0);return{total:F,active:I.length,outOfStock:Q.length}});const k=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),R={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.2s ease"},Y={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},q=I=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px",background:I?"#ffebee":"#e8f5e8",color:I?"#d32f2f":"#2d7d32"});Dt(()=>{const I=ct.products||[],F=ct.movements||[],Q=ct.stockLevels||[],H=ct.getLowStockProducts(),J=I?.length||0,te=I?.filter(G=>G.isActive).length,ee=Q.reduce((G,ce)=>G*1+ce.quantity*1*ce.averageCost*1,0),ne=F?.filter(G=>{const ce=new Date(G.createdDate),oe=new Date;return ce.getMonth()===oe.getMonth()&&ce.getFullYear()===oe.getFullYear()}).length;return{totalProducts:J,activeProducts:te,lowStockProducts:H.length,totalStockValue:ee,totalMovementsThisMonth:ne,totalLocations:ct.locations.length,activeLocations:ct.getActiveLocations().length}});const O=Dt(()=>ct.products.map(I=>{const F=ct.getStockByProduct(I.id),Q=ct.getTotalStockByProduct(I.id),H=ct.getLastLocationByProduct(I.id);return{...I,totalStock:Q,stockByLocation:F,lastLocation:H,isLowStock:Q<=I.minStockLevel}})),le=Dt(()=>Z().map(I=>{const F=ct.getStockByProduct(I.id),Q=ct.getTotalStockByProduct(I.id),H=ct.getLastLocationByProduct(I.id);return{...I,totalStock:Q,stockByLocation:F,lastLocation:H,isLowStock:Q<=I.minStockLevel}})),N=Dt(()=>{const I=E()?le():O(),F=(T()-1)*b(),Q=F+b();return I.slice(F,Q)}),D=Dt(()=>{const I=E()?le():O();return Math.ceil(I.length/b())}),V=I=>{U(I),x(!0)};return M(Qi,{get title(){return t("products.title","Products")},get children(){return[(()=>{var I=Ek(),F=I.firstChild,Q=F.firstChild,H=Q.nextSibling,J=H.firstChild;return I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","flex-start"),I.style.setProperty("margin-bottom","1.5rem"),I.style.setProperty("flex-wrap","wrap"),I.style.setProperty("gap","1rem"),F.style.setProperty("flex","1"),F.style.setProperty("min-width","300px"),Q.style.setProperty("margin","0 0 1rem 0"),Q.style.setProperty("font-size","1.5rem"),a(Q,()=>t("inventory.products")),H.style.setProperty("display","flex"),H.style.setProperty("gap","1rem"),H.style.setProperty("align-items","center"),H.style.setProperty("flex-wrap","wrap"),J.style.setProperty("flex","1"),J.style.setProperty("min-width","250px"),a(J,M($k,{onSearchResults:te=>{re(te),C(te.length>0)},get placeholder(){return t("inventory.searchProductsStock","Search products and check stock levels...")},showResults:!1,maxResults:20})),a(H,M(dt,{variant:"outline",onClick:()=>{W(),C(!1)},get children(){return["🔄 ",Ee(()=>t("common.showAll","Show All"))]}}),null),a(I,M(Ge,{get when(){return pr.hasPermission("read_write")},get children(){return M(dt,{variant:"primary",onClick:()=>X(!0),get children(){return["➕ ",Ee(()=>t("inventory.addProduct"))]}})}}),null),I})(),(()=>{var I=Tk(),F=I.firstChild;return I.style.setProperty("margin-bottom","1rem"),I.style.setProperty("font-size","0.875rem"),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),a(F,(()=>{var Q=Ee(()=>!!E());return()=>Q()?`${t("inventory.searchResults","Search Results")}: ${le().length} ${t("common.products","products")}`:`${t("inventory.totalProducts","Total Products")}: ${O().length} ${t("common.products","products")}`})()),a(I,(()=>{var Q=Ee(()=>!!E());return()=>Q()&&(()=>{var H=kk();return H.firstChild,H.style.setProperty("color","var(--primary-color)"),a(H,()=>t("inventory.filtered","Filtered view"),null),H})()})(),null),I})(),M(Ht,{get each(){return N()},children:I=>(()=>{var F=Nk(),Q=F.firstChild,H=Q.firstChild,J=H.firstChild,te=J.firstChild,ee=te.nextSibling,ne=J.nextSibling,G=ne.nextSibling,ce=G.firstChild,oe=H.nextSibling,z=oe.firstChild,de=z.nextSibling,fe=de.firstChild,ue=fe.nextSibling;ue.nextSibling;var ge=de.nextSibling,xe=ge.firstChild;return F.$$click=()=>V(I),F.addEventListener("mouseleave",pe=>{pe.currentTarget.style.transform="translateY(0)",pe.currentTarget.style.boxShadow="none"}),F.addEventListener("mouseenter",pe=>{pe.currentTarget.style.transform="translateY(-2px)",pe.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)"}),m(F,R),m(Q,Y),J.style.setProperty("display","flex"),J.style.setProperty("align-items","center"),J.style.setProperty("gap","0.5rem"),J.style.setProperty("margin-bottom","0.5rem"),te.style.setProperty("margin","0"),te.style.setProperty("font-size","1.1rem"),a(te,()=>I.name),a(ee,(()=>{var pe=Ee(()=>!!I.isLowStock);return()=>pe()?t("inventory.lowStockAlert"):t("inventory.inStock")})()),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-muted)"),a(ne,()=>I.sku,null),a(ne,()=>I.UPC?" • "+I.UPC:"",null),a(ne,()=>I.category?" • "+I.category:"",null),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),a(G,()=>t("inventory.lastSeen"),ce),a(G,()=>I.lastLocation?.name||t("inventory.noMovements"),null),oe.style.setProperty("text-align","right"),z.style.setProperty("font-size","1.25rem"),z.style.setProperty("font-weight","700"),z.style.setProperty("color","var(--primary-color)"),a(z,()=>I.totalStock),de.style.setProperty("font-size","0.875rem"),de.style.setProperty("color","var(--text-muted)"),a(de,()=>I.unitOfMeasure,fe),a(de,()=>t("inventory.min"),ue),a(de,()=>I.minStockLevel,null),ge.style.setProperty("font-size","0.875rem"),ge.style.setProperty("color","var(--text-muted)"),a(ge,()=>t("inventory.cost"),xe),a(ge,()=>k(I.unitCost),null),a(F,(()=>{var pe=Ee(()=>I?.stockByLocation?.length>0);return()=>pe()&&(()=>{var _e=Lk(),Le=_e.firstChild,De=Le.firstChild,Te=Le.nextSibling;return _e.style.setProperty("margin-top","1rem"),Le.style.setProperty("font-weight","500"),Le.style.setProperty("margin-bottom","0.5rem"),Le.style.setProperty("font-size","0.875rem"),a(Le,()=>t("inventory.stockByLocation"),De),Te.style.setProperty("display","flex"),Te.style.setProperty("flex-wrap","wrap"),Te.style.setProperty("gap","0.5rem"),a(Te,M(Ht,{get each(){return I.stockByLocation},children:$e=>{const Ie=ct.getLocationById($e.locationId);return(()=>{var Re=Rk(),Ke=Re.firstChild;return Re.style.setProperty("padding","0.25rem 0.5rem"),Re.style.setProperty("background","var(--background-color)"),Re.style.setProperty("border-radius","var(--border-radius-sm)"),Re.style.setProperty("font-size","0.75rem"),Re.style.setProperty("border","1px solid var(--border-color)"),a(Re,()=>Ie?.name,Ke),a(Re,()=>$e.quantity,null),Re})()}})),_e})()})(),null),Se(pe=>m(ee,q(I.isLowStock),pe)),F})()}),Ee(()=>Ee(()=>D()>1)()&&(()=>{var I=Dk(),F=I.firstChild,Q=F.firstChild,H=Q.firstChild,J=Q.nextSibling,te=F.nextSibling,ee=te.firstChild,ne=ee.firstChild,G=ne.nextSibling,ce=G.nextSibling,oe=ce.firstChild,z=te.nextSibling;return I.style.setProperty("display","flex"),I.style.setProperty("justify-content","space-between"),I.style.setProperty("align-items","center"),I.style.setProperty("margin-top","2rem"),I.style.setProperty("padding","1rem"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius)"),I.style.setProperty("border","1px solid var(--border-color)"),F.style.setProperty("display","flex"),F.style.setProperty("align-items","center"),F.style.setProperty("gap","0.5rem"),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>t("common.showPerPage","Show per page"),H),J.addEventListener("change",de=>{w(parseInt(de.target.value)),j(1)}),J.style.setProperty("padding","0.25rem 0.5rem"),J.style.setProperty("border","1px solid var(--border-color)"),J.style.setProperty("border-radius","var(--border-radius-sm)"),J.style.setProperty("background","var(--background-color)"),J.style.setProperty("cursor","pointer"),te.style.setProperty("display","flex"),te.style.setProperty("align-items","center"),te.style.setProperty("gap","0.5rem"),a(te,M(dt,{variant:"outline",size:"sm",onClick:()=>j(1),get disabled(){return T()===1},get children(){return t("common.first","First")}}),ee),a(te,M(dt,{variant:"outline",size:"sm",onClick:()=>j(de=>Math.max(1,de-1)),get disabled(){return T()===1},get children(){return t("common.previous","Previous")}}),ee),ee.style.setProperty("display","flex"),ee.style.setProperty("align-items","center"),ee.style.setProperty("gap","0.25rem"),ne.style.setProperty("font-size","0.875rem"),a(ne,()=>t("common.page","Page")),G.addEventListener("change",de=>{const fe=parseInt(de.target.value);fe>=1&&fe<=D()&&j(fe)}),G.style.setProperty("width","60px"),G.style.setProperty("padding","0.25rem 0.5rem"),G.style.setProperty("border","1px solid var(--border-color)"),G.style.setProperty("border-radius","var(--border-radius-sm)"),G.style.setProperty("text-align","center"),G.style.setProperty("font-size","0.875rem"),ce.style.setProperty("font-size","0.875rem"),a(ce,()=>t("common.of","of"),oe),a(ce,D,null),a(te,M(dt,{variant:"outline",size:"sm",onClick:()=>j(de=>Math.min(D(),de+1)),get disabled(){return T()===D()},get children(){return t("common.next","Next")}}),null),a(te,M(dt,{variant:"outline",size:"sm",onClick:()=>j(D()),get disabled(){return T()===D()},get children(){return t("common.last","Last")}}),null),z.style.setProperty("font-size","0.875rem"),z.style.setProperty("color","var(--text-muted)"),a(z,()=>{const de=E()?le():O(),fe=(T()-1)*b()+1,ue=Math.min(T()*b(),de.length);return t("common.showingXofY","Showing {{start}}-{{end}} of {{total}}",{start:fe,end:ue,total:de.length})}),Se(()=>nr(G,"max",D())),Se(()=>J.value=b()),Se(()=>G.value=T()),I})()),M(zy,{get isOpen(){return y()},onClose:()=>g(!1),onProductAdded:()=>{_()}}),M(Sk,{get isOpen(){return f()},onClose:()=>{x(!1),U(null)},get product(){return $()},onEdit:()=>{x(!1),P(!0)}})]}})};yr(["click"]);var Mk=he("<div><div></div><div>"),Fk=he("<div><div><img></div><div>X</div><div><div><h2></h2><div></div></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),Ok=he("<div>"),Bk=he("<div><div>📦</div><h3></h3><p>"),jk=he("<div><div>"),Vk=he("<div>✓"),qk=he("<div><div><img loading=lazy></div><div><div></div><div> • </div><div></div><div>",!0,!1,!1);const zk=t=>{const{t:e}=sr(),[r,n]=Ce(null),[i,o]=Ce([]),[s,l]=Ce(!1),c=R=>{n(R),t.onProductSelect?.(R)},u=()=>{n(null),t.onProductSelect?.(null),o([]),l(!1)},h=R=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(R),y=()=>"YABABYSSolution",g=()=>"https://qvamarkets.s3.us-east-2.amazonaws.com/V2_images/7258/",f=R=>{if(R.productImageUrl)return g()+y()+"/"+R?.productImageUrl;const Y={Electronics:"https://via.placeholder.com/400x300/4F46E5/FFFFFF?text=Electronics",Furniture:"https://via.placeholder.com/400x300/059669/FFFFFF?text=Furniture",Food:"https://via.placeholder.com/400x300/DC2626/FFFFFF?text=Food",Clothing:"https://via.placeholder.com/400x300/7C3AED/FFFFFF?text=Clothing",Tools:"https://via.placeholder.com/400x300/EA580C/FFFFFF?text=Tools",General:"https://via.placeholder.com/400x300/6B7280/FFFFFF?text=Product"};return Y[R.category]||Y.General},x={padding:"2rem"},S={"max-width":"600px",margin:"0 auto 2rem",position:"relative"},P={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},$={background:"var(--surface-color)","border-radius":"var(--border-radius)",overflow:"hidden","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)",cursor:"pointer",transition:"all 0.3s ease"},U={position:"relative",width:"100%",height:"200px",overflow:"hidden",background:"#f5f5f5"},se={width:"100%",height:"100%","object-fit":"cover",transition:"transform 0.3s ease"},X={padding:"1rem"},Z={"font-size":"1rem","font-weight":"600","margin-bottom":"0.5rem",color:"var(--text-primary)",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},re={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"0.25rem"},E={"font-size":"1.25rem","font-weight":"700",color:"var(--primary-color)","margin-top":"0.5rem"},C={display:"flex",gap:"2rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",padding:"2rem","box-shadow":"var(--shadow-md)","margin-bottom":"2rem",position:"relative"},T={width:"400px",height:"300px","border-radius":"var(--border-radius)",overflow:"hidden",background:"#f5f5f5"},j={flex:"1",display:"flex","flex-direction":"column",gap:"1rem"},b={display:"flex","justify-content":"space-between","padding-bottom":"0.5rem","border-bottom":"1px solid var(--border-light)"},w={"font-weight":"500",color:"var(--text-muted)"},_={"font-weight":"600",color:"var(--text-primary)"},W=R=>({display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600",background:"#d4edda",color:"#155724"}),K={"text-align":"center",padding:"4rem 2rem",color:"var(--text-muted)"},k={"font-size":"3rem","margin-bottom":"1rem",opacity:"0.5"};return(()=>{var R=jk(),Y=R.firstChild;return m(R,x),a(Y,M(mp,{onChange:q=>{console.log(q);let O=q;l(!0),c(O)},get placeholder(){return e("inventory.searchProductsImages","Search products to view images...")}})),a(R,M(Ge,{get when(){return r()&&t.showDetails!==!1},get children(){var q=Fk(),O=q.firstChild,le=O.firstChild,N=O.nextSibling,D=N.nextSibling,V=D.firstChild,I=V.firstChild,F=I.nextSibling,Q=V.nextSibling,H=Q.firstChild,J=H.nextSibling,te=Q.nextSibling,ee=te.firstChild,ne=ee.nextSibling,G=te.nextSibling,ce=G.firstChild,oe=ce.nextSibling,z=G.nextSibling,de=z.firstChild,fe=de.nextSibling,ue=z.nextSibling,ge=ue.firstChild,xe=ge.nextSibling;return m(q,C),m(O,T),le.style.setProperty("width","100%"),le.style.setProperty("height","100%"),le.style.setProperty("object-fit","contain"),le.style.setProperty("aspect-ratio","1 / 1"),N.$$click=()=>{u()},N.style.setProperty("position","absolute"),N.style.setProperty("top","0.5rem"),N.style.setProperty("right","0.5rem"),N.style.setProperty("color","#3d3d3d"),N.style.setProperty("border-radius","50%"),N.style.setProperty("width","2rem"),N.style.setProperty("height","2rem"),N.style.setProperty("display","flex"),N.style.setProperty("align-items","center"),N.style.setProperty("justify-content","center"),N.style.setProperty("font-size","1.25rem"),N.style.setProperty("box-shadow","var(--shadow-sm)"),N.style.setProperty("cursor","pointer"),m(D,j),I.style.setProperty("margin","0 0 0.5rem 0"),I.style.setProperty("font-size","1.5rem"),a(I,()=>r().name),a(F,()=>e("products.inStock","In Stock")),a(H,()=>e("products.sku","SKU")),a(J,()=>r().sku),a(ee,()=>e("inventory.category","Category")),a(ne,()=>r().category),a(ce,()=>e("inventory.unitOfMeasure","Unit")),a(oe,()=>r().unitOfMeasure),a(de,()=>e("inventory.unitCost","Cost")),a(fe,()=>h(r().unitCost)),a(ge,()=>e("inventory.UPC","UPC")),a(xe,()=>r().UPC),a(D,M(Ge,{get when(){return r().description},get children(){var pe=Mk(),_e=pe.firstChild,Le=_e.nextSibling;return pe.style.setProperty("margin-top","1rem"),a(_e,()=>e("common.description","Description")),Le.style.setProperty("margin-top","0.5rem"),Le.style.setProperty("color","var(--text-primary)"),a(Le,()=>r().description),Se(De=>m(_e,w,De)),pe}}),null),Se(pe=>{var _e=f(r()),Le=r().name,De=W(),Te=b,$e=w,Ie=_,Re=b,Ke=w,je=_,We=b,Qe=w,at=_,nt=b,Ye=w,ht=_,lt=b,$t=w,_t=_;return _e!==pe.e&&nr(le,"src",pe.e=_e),Le!==pe.t&&nr(le,"alt",pe.t=Le),pe.a=m(F,De,pe.a),pe.o=m(Q,Te,pe.o),pe.i=m(H,$e,pe.i),pe.n=m(J,Ie,pe.n),pe.s=m(te,Re,pe.s),pe.h=m(ee,Ke,pe.h),pe.r=m(ne,je,pe.r),pe.d=m(G,We,pe.d),pe.l=m(ce,Qe,pe.l),pe.u=m(oe,at,pe.u),pe.c=m(z,nt,pe.c),pe.w=m(de,Ye,pe.w),pe.m=m(fe,ht,pe.m),pe.f=m(ue,lt,pe.f),pe.y=m(ge,$t,pe.y),pe.g=m(xe,_t,pe.g),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),q}}),null),a(R,M(Ge,{get when(){return i().length>0},get children(){var q=Ok();return m(q,P),a(q,M(Ht,{get each(){return i()},children:O=>(()=>{var le=qk(),N=le.firstChild,D=N.firstChild,V=N.nextSibling,I=V.firstChild,F=I.nextSibling,Q=F.firstChild,H=F.nextSibling,J=H.nextSibling;return le.addEventListener("mouseleave",te=>{te.currentTarget.style.transform="translateY(0)",te.currentTarget.style.boxShadow="var(--shadow-sm)";const ee=te.currentTarget.querySelector("img");ee&&(ee.style.transform="scale(1)")}),le.addEventListener("mouseenter",te=>{te.currentTarget.style.transform="translateY(-4px)",te.currentTarget.style.boxShadow="var(--shadow-lg)";const ee=te.currentTarget.querySelector("img");ee&&(ee.style.transform="scale(1.05)")}),le.$$click=()=>c(O),m(le,$),a(N,M(Ge,{get when(){return O===r()},get children(){var te=Vk();return te.style.setProperty("position","absolute"),te.style.setProperty("top","0.5rem"),te.style.setProperty("right","0.5rem"),te.style.setProperty("background","var(--primary-color)"),te.style.setProperty("color","white"),te.style.setProperty("border-radius","50%"),te.style.setProperty("width","2rem"),te.style.setProperty("height","2rem"),te.style.setProperty("display","flex"),te.style.setProperty("align-items","center"),te.style.setProperty("justify-content","center"),te.style.setProperty("font-size","1.25rem"),te}}),null),m(V,X),a(I,()=>O.name),a(F,()=>O.sku,Q),a(F,()=>O.category,null),a(H,()=>O.unitOfMeasure),m(J,E),a(J,()=>h(O.sellingPrice)),Se(te=>{var ee=U,ne=f(O),G=O.name,ce=se,oe=Z,z=O.name,de=re,fe=re;return te.e=m(N,ee,te.e),ne!==te.t&&nr(D,"src",te.t=ne),G!==te.a&&nr(D,"alt",te.a=G),te.o=m(D,ce,te.o),te.i=m(I,oe,te.i),z!==te.n&&nr(I,"title",te.n=z),te.s=m(F,de,te.s),te.h=m(H,fe,te.h),te},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),le})()})),q}}),null),a(R,M(Ge,{get when(){return!r()},get children(){var q=Bk(),O=q.firstChild,le=O.nextSibling,N=le.nextSibling;return m(O,k),le.style.setProperty("margin-bottom","0.5rem"),a(le,()=>e("inventory.noProductsFound","No Products Found")),a(N,()=>e("inventory.tryDifferentSearch","Try a different search term")),Se(D=>m(q,K,D)),q}}),null),Se(q=>m(Y,S,q)),R})()};yr(["click"]);var Uk=he("<div><div>📊</div><div></div><div>"),A0=he("<div>"),Hk=he("<div><div><div><h2> - </h2><button>×</button></div><div>"),Gk=he("<div><div><div><div><h3></h3><span></span></div><div></div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const Wk=t=>{const{t:e}=sr(),[r,n]=Ce(""),[i,o]=Ce(!1),s=Dt(()=>{const x=ct.movements,S=new Map;return x.forEach(P=>{const $=P.referenceNumber||P.invoiceId||P.ssg_inventory_key||"UNKNOWN";S.has($)||S.set($,{referenceNumber:$,movements:[],totalItems:0,totalValue:0,createdDate:P.createdDate,movementType:P.movementType});const U=S.get($);U.movements.push(P),U.totalItems+=P.quantity,U.totalValue+=P.totalCost,new Date(P.createdDate)<new Date(U.createdDate)&&(U.createdDate=P.createdDate)}),Array.from(S.values()).filter(P=>P.movements.length>1).sort((P,$)=>new Date($.createdDate).getTime()-new Date(P.createdDate).getTime())}),l=Dt(()=>{const x=s().find(S=>S.referenceNumber===r());return x?x.movements:[]}),c=x=>{n(x),o(!0)},u=()=>{o(!1),n("")},h=x=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(x),y=x=>new Date(x).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),g=x=>({in:e("inventory.purchaseReceive"),out:e("inventory.saleIssue"),transfer:e("inventory.transfer"),adjustment:e("inventory.adjustment")})[x]||x,f=x=>({in:"#4caf50",out:"#f44336",transfer:"#2196f3",adjustment:"#ff9800"})[x]||"#666";return[M(Fn,{get isOpen(){return Ee(()=>!!t.isOpen)()&&!i()},get onClose(){return t.onClose},get title(){return e("inventory.viewHistoricalReports")},size:"large",get children(){var x=A0();return x.style.setProperty("max-height","70vh"),x.style.setProperty("overflow-y","auto"),a(x,M(Ge,{get when(){return s().length===0},get children(){var S=Uk(),P=S.firstChild,$=P.nextSibling,U=$.nextSibling;return S.style.setProperty("text-align","center"),S.style.setProperty("padding","3rem"),S.style.setProperty("color","var(--text-muted)"),P.style.setProperty("font-size","2rem"),P.style.setProperty("margin-bottom","1rem"),$.style.setProperty("font-size","1.1rem"),$.style.setProperty("margin-bottom","0.5rem"),a($,()=>e("inventory.noBulkReportsFound","No bulk movement reports found")),U.style.setProperty("font-size","0.9rem"),a(U,()=>e("inventory.bulkReportsAppearHere","Bulk movement reports will appear here after you create bulk movements")),S}}),null),a(x,M(Ge,{get when(){return s().length>0},get children(){var S=A0();return S.style.setProperty("display","grid"),S.style.setProperty("gap","1rem"),a(S,M(Ht,{get each(){return s()},children:P=>(()=>{var $=Gk(),U=$.firstChild,se=U.firstChild,X=se.firstChild,Z=X.firstChild,re=Z.nextSibling,E=X.nextSibling,C=U.nextSibling,T=C.firstChild,j=T.firstChild,b=j.nextSibling,w=T.nextSibling,_=w.firstChild,W=_.nextSibling,K=w.nextSibling,k=K.firstChild,R=k.nextSibling;return $.style.setProperty("padding","1.5rem"),$.style.setProperty("border","1px solid var(--border-color)"),$.style.setProperty("border-radius","var(--border-radius)"),$.style.setProperty("background","var(--surface-color)"),$.style.setProperty("transition","all 0.2s ease"),U.style.setProperty("display","flex"),U.style.setProperty("justify-content","space-between"),U.style.setProperty("align-items","flex-start"),U.style.setProperty("margin-bottom","1rem"),se.style.setProperty("flex","1"),X.style.setProperty("display","flex"),X.style.setProperty("align-items","center"),X.style.setProperty("gap","1rem"),X.style.setProperty("margin-bottom","0.5rem"),Z.style.setProperty("margin","0"),Z.style.setProperty("font-size","1.1rem"),Z.style.setProperty("color","var(--text-primary)"),a(Z,()=>P.referenceNumber),re.style.setProperty("padding","0.25rem 0.75rem"),re.style.setProperty("border-radius","1rem"),re.style.setProperty("font-size","0.75rem"),re.style.setProperty("font-weight","500"),a(re,()=>g(P.movementType)),E.style.setProperty("color","var(--text-muted)"),E.style.setProperty("font-size","0.875rem"),a(E,()=>y(P.createdDate)),a(U,M(dt,{variant:"outline",size:"sm",onClick:()=>c(P.referenceNumber),get children(){return e("common.view")}}),null),C.style.setProperty("display","grid"),C.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),C.style.setProperty("gap","1rem"),C.style.setProperty("margin-bottom","1rem"),j.style.setProperty("font-size","0.75rem"),j.style.setProperty("font-weight","500"),j.style.setProperty("text-transform","uppercase"),j.style.setProperty("color","var(--text-muted)"),j.style.setProperty("margin-bottom","0.25rem"),a(j,()=>e("inventory.totalProducts")),b.style.setProperty("font-size","1.25rem"),b.style.setProperty("font-weight","600"),b.style.setProperty("color","var(--primary-color)"),a(b,()=>P.movements.length),_.style.setProperty("font-size","0.75rem"),_.style.setProperty("font-weight","500"),_.style.setProperty("text-transform","uppercase"),_.style.setProperty("color","var(--text-muted)"),_.style.setProperty("margin-bottom","0.25rem"),a(_,()=>e("inventory.totalItems")),W.style.setProperty("font-size","1.25rem"),W.style.setProperty("font-weight","600"),W.style.setProperty("color","var(--primary-color)"),a(W,()=>P.totalItems),k.style.setProperty("font-size","0.75rem"),k.style.setProperty("font-weight","500"),k.style.setProperty("text-transform","uppercase"),k.style.setProperty("color","var(--text-muted)"),k.style.setProperty("margin-bottom","0.25rem"),a(k,()=>e("inventory.estimatedValue")),R.style.setProperty("font-size","1.25rem"),R.style.setProperty("font-weight","600"),R.style.setProperty("color","var(--primary-color)"),a(R,()=>h(P.totalValue)),Se(Y=>{var q=f(P.movementType)+"20",O=f(P.movementType);return q!==Y.e&&((Y.e=q)!=null?re.style.setProperty("background",q):re.style.removeProperty("background")),O!==Y.t&&((Y.t=O)!=null?re.style.setProperty("color",O):re.style.removeProperty("color")),Y},{e:void 0,t:void 0}),$})()})),S}}),null),x}}),M(Ge,{get when(){return i()},get children(){var x=Hk(),S=x.firstChild,P=S.firstChild,$=P.firstChild,U=$.firstChild,se=$.nextSibling,X=P.nextSibling;return x.style.setProperty("position","fixed"),x.style.setProperty("top","0"),x.style.setProperty("left","0"),x.style.setProperty("right","0"),x.style.setProperty("bottom","0"),x.style.setProperty("background","rgba(0, 0, 0, 0.5)"),x.style.setProperty("z-index","1000"),x.style.setProperty("display","flex"),x.style.setProperty("align-items","center"),x.style.setProperty("justify-content","center"),x.style.setProperty("padding","2rem"),S.style.setProperty("background","white"),S.style.setProperty("border-radius","var(--border-radius)"),S.style.setProperty("width","95%"),S.style.setProperty("max-width","1200px"),S.style.setProperty("max-height","90vh"),S.style.setProperty("overflow-y","auto"),S.style.setProperty("position","relative"),P.style.setProperty("padding","1rem 2rem"),P.style.setProperty("border-bottom","1px solid #e9ecef"),P.style.setProperty("display","flex"),P.style.setProperty("justify-content","space-between"),P.style.setProperty("align-items","center"),P.style.setProperty("background","#f8f9fa"),$.style.setProperty("margin","0"),a($,()=>e("inventory.bulkMovementReport"),U),a($,r,null),se.$$click=u,se.style.setProperty("background","none"),se.style.setProperty("border","none"),se.style.setProperty("font-size","1.5rem"),se.style.setProperty("cursor","pointer"),se.style.setProperty("padding","0.5rem"),se.style.setProperty("line-height","1"),X.style.setProperty("padding","1rem"),a(X,M(T5,{get movements(){return l()},onClose:u})),x}})]};yr(["click"]);var Yk=he("<div><h1></h1><div>"),Ii=he("<div>"),Kk=he("<div><h3></h3><div>"),Jk=he("<div>: <!> "),Qk=he("<div><button></button><button></button><button></button><button>"),Xk=he("<div><div>"),Zk=he("<div><span> (<!>)</span><span> / <!> "),eN=he("<div><div><h2></h2></div><div>"),tN=he("<div><div><div><span></span><h3></h3></div><div> • </div><div></div></div><div><div><span>:</span><span></span></div><div><span>:</span><span></span></div><div><span>:</span><span></span></div></div><div><div>:"),rN=he("<div><div><div><div></div><div></div></div><div><div> </div><div></div><div>Min: "),nN=he("<span>⚠️ LOW");const iN=()=>{const{t}=sr(),[e,r]=Ce(!1),[n,i]=Ce(!1),[o,s]=Ce(!1),[l,c]=Ce(null),[u,h]=Ce("overview"),[y,g]=Ce("new"),[f,x]=Ce([]),[S,P]=Ce(!1),[$,U]=Ce(!1),[se,X]=Ce(!1),[Z,re]=Ce(!1),[E,C]=Ce(1),T=H=>{c(H),s(!0)},j=Dt(()=>{const H=ct.products||[],J=ct.movements||[],te=ct.stockLevels||[],ee=ct.getLowStockProducts(),ne=H?.length||0,G=H?.filter(z=>z.isActive).length,ce=te.reduce((z,de)=>z*1+de.quantity*1*de.averageCost*1,0),oe=J?.filter(z=>{const de=new Date(z.createdDate),fe=new Date;return de.getMonth()===fe.getMonth()&&de.getFullYear()===fe.getFullYear()}).length;return{totalProducts:ne,activeProducts:G,lowStockProducts:ee.length,totalStockValue:ce,totalMovementsThisMonth:oe,totalLocations:ct.locations.length,activeLocations:ct.getActiveLocations().length}});Dt(()=>ct.products.map(H=>{const J=ct.getStockByProduct(H.id),te=ct.getTotalStockByProduct(H.id),ee=ct.getLastLocationByProduct(H.id);return{...H,totalStock:te,stockByLocation:J,lastLocation:ee,isLowStock:te<=H.minStockLevel}})),Dt(()=>{S(),C(1)});const b=(H,J)=>H<=J?t("inventory.lowStockAlert"):H<=J*2?t("inventory.normalStock"):t("inventory.inStock"),w=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),_=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),W=H=>{switch(H){case"warehouse":return t("inventory.warehouse");case"store":return t("inventory.store");case"supplier":return t("inventory.supplier");case"customer":return t("inventory.customer");default:return H}},K={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},k={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},R=H=>({padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500",background:H>50?"#d4edda":H>20?"#fff3cd":"#f8d7da",color:H>50?"#155724":H>20?"#856404":"#721c24"}),Y={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)","margin-bottom":"0.5rem"},q={color:"var(--text-muted)","font-size":"0.875rem"},O={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},le={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},N={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},D=H=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:H?"var(--primary-color)":"var(--text-muted)","border-bottom":H?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),V={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem","margin-bottom":"2rem"},I={padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},F=Dt(()=>{const H=ct.movements;return{total:H.length,stockIn:H.filter(J=>J.movementType==="in").length,stockOut:H.filter(J=>J.movementType==="out").length,transfers:H.filter(J=>J.movementType==="transfer").length,adjustments:H.filter(J=>J.movementType==="adjustment").length,totalValue:H.reduce((J,te)=>J+te.totalCost,0)}}),Q=async()=>{let H=pr.state?.profile?.businessId;setTimeout(async()=>{await ct.getStockLevels("YY_")},2300),qy.calcStockLevels(),await ct.fecthProduct(H),await ct.fecthInventory(H)};return Sn(()=>{Q()}),M(Qi,{get title(){return t("inventory.title")},get children(){return[(()=>{var H=Yk(),J=H.firstChild,te=J.nextSibling;return m(H,le),J.style.setProperty("margin","0"),J.style.setProperty("font-size","1.75rem"),te.style.setProperty("display","flex"),te.style.setProperty("align-items","center"),te.style.setProperty("gap","1rem"),a(te,(()=>{var ee=Ee(()=>y()==="new");return()=>ee()&&M(dt,{variant:"outline",onClick:()=>X(!0),get children(){return["🔢 ",Ee(()=>t("inventory.physicalCount","Physical Count"))]}})})(),null),a(te,M(Ge,{get when(){return pr.hasPermission("read_write")},get children(){return[M(dt,{variant:"outline",onClick:()=>re(!0),get children(){return["📊 ",Ee(()=>t("inventory.viewHistoricalReports"))]}}),M(dt,{variant:"primary",onClick:()=>i(!0),get children(){return Ee(()=>y()==="new")()?t("inventory.addMovement"):t("common.add")}})]}}),null),H})(),M(zk,{}),M(Ge,{get when(){return pr.hasPermission("inventoryDownsection")},get children(){return Ee(()=>y()==="legacy")()?[(()=>{var H=Ii();return a(H,M(Ft,{get title(){return t("inventory.totalItems")},get subtitle(){return t("inventory.inStock")},get children(){var J=Ii();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),a(J,()=>ct.inventory.length),J}}),null),a(H,M(Ft,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.itemsBelowThreshold")},get children(){var J=Ii();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),a(J,()=>ct.getLowStockItems().length),J}}),null),a(H,M(Ft,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.inventoryWorth")},get children(){var J=Ii();return J.style.setProperty("font-size","1.5rem"),J.style.setProperty("font-weight","600"),J.style.setProperty("color","var(--primary-color)"),a(J,()=>w(ct.getTotalValue())),J}}),null),Se(J=>m(H,O,J)),H})(),(()=>{var H=Ii();return m(H,K),a(H,M(Ht,{get each(){return ct.inventory},children:J=>{const te=b(J.quantity,J.minStock),ee=J.quantity<=J.minStock?8:J.quantity<=J.minStock*2?35:75;return M(Ft,{onClick:()=>T(J),get children(){return[(()=>{var ne=Kk(),G=ne.firstChild,ce=G.nextSibling;return m(ne,k),G.style.setProperty("margin","0"),G.style.setProperty("font-size","1.1rem"),a(G,()=>J.name),a(ce,te),Se(oe=>m(ce,R(ee),oe)),ne})(),(()=>{var ne=Ii();return m(ne,Y),a(ne,()=>w(J.price)),ne})(),(()=>{var ne=Jk(),G=ne.firstChild,ce=G.nextSibling;return ce.nextSibling,m(ne,q),a(ne,()=>t("inventory.quantity"),G),a(ne,()=>J.quantity,ce),a(ne,()=>t("common.units"),null),ne})()]}})}})),H})()]:[(()=>{var H=Qk(),J=H.firstChild,te=J.nextSibling,ee=te.nextSibling,ne=ee.nextSibling;return m(H,N),J.$$click=()=>h("overview"),a(J,()=>t("inventory.overview")),te.$$click=()=>h("products"),a(te,()=>t("inventory.products")),ee.$$click=()=>h("movements"),a(ee,()=>t("inventory.movements")),ne.$$click=()=>h("locations"),a(ne,()=>t("inventory.locations")),Se(G=>{var ce=D(u()==="overview"),oe=D(u()==="products"),z=D(u()==="movements"),de=D(u()==="locations");return G.e=m(J,ce,G.e),G.t=m(te,oe,G.t),G.a=m(ee,z,G.a),G.o=m(ne,de,G.o),G},{e:void 0,t:void 0,a:void 0,o:void 0}),H})(),Ee(()=>Ee(()=>u()==="overview")()&&(()=>{var H=Xk(),J=H.firstChild;return a(J,M(Ft,{get title(){return t("inventory.activeProducts")},get subtitle(){return t("inventory.currentlyManaged")},get children(){var te=Ii();return te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","600"),te.style.setProperty("color","var(--primary-color)"),a(te,()=>j().activeProducts),te}}),null),a(J,M(Ft,{get title(){return t("inventory.lowStockAlert")},get subtitle(){return t("inventory.needAttention")},get children(){var te=Ii();return te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","600"),te.style.setProperty("color","#d32f2f"),a(te,()=>j().lowStockProducts),te}}),null),a(J,M(Ft,{get title(){return t("inventory.totalValue")},get subtitle(){return t("inventory.currentWorth")},get children(){var te=Ii();return te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","600"),te.style.setProperty("color","var(--primary-color)"),a(te,()=>_(F().totalValue)),te}}),null),a(J,M(Ft,{get title(){return t("inventory.movements")},get subtitle(){return t("inventory.thisMonth")},get children(){var te=Ii();return te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","600"),te.style.setProperty("color","var(--primary-color)"),a(te,()=>j().totalMovementsThisMonth),te}}),null),a(J,M(Ft,{get title(){return t("inventory.activeLocations")},get subtitle(){return t("inventory.warehousesStores")},get children(){var te=Ii();return te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","600"),te.style.setProperty("color","var(--primary-color)"),a(te,()=>j().activeLocations),te}}),null),a(H,(()=>{var te=Ee(()=>j().lowStockProducts>0);return()=>te()&&M(Ft,{get title(){return`⚠️ ${t("inventory.lowStockAlert")}`},get subtitle(){return`${j().lowStockProducts} ${t("inventory.productsNeedRestocking")}`},style:{"margin-bottom":"2rem","border-color":"#ffcdd2",background:"#ffebee"},get children(){var ee=Ii();return ee.style.setProperty("margin-top","1rem"),a(ee,M(Ht,{get each(){return ct.getLowStockProducts().slice(0,9)},children:ne=>(()=>{var G=Zk(),ce=G.firstChild,oe=ce.firstChild,z=oe.nextSibling;z.nextSibling;var de=ce.nextSibling,fe=de.firstChild,ue=fe.nextSibling;return ue.nextSibling,G.style.setProperty("display","flex"),G.style.setProperty("justify-content","space-between"),G.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-size","0.875rem"),a(ce,()=>ne.name,oe),a(ce,()=>ne?.sku,z),de.style.setProperty("color","#d32f2f"),de.style.setProperty("font-weight","600"),a(de,()=>ne.currentStock,fe),a(de,()=>ne.minStockLevel,ue),a(de,()=>t("inventory.min"),null),G})()}),null),a(ee,(()=>{var ne=Ee(()=>ct.getLowStockProducts().length>5);return()=>ne()&&(()=>{var G=Ii();return G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-muted)"),G.style.setProperty("font-style","italic"),a(G,()=>t("common.andMore",{count:ct.getLowStockProducts().length-9})),G})()})(),null),ee}})})(),null),Se(te=>m(J,O,te)),H})()),Ee(()=>Ee(()=>u()==="products")()&&M(k5,{})),Ee(()=>Ee(()=>u()==="movements")()&&M(HT,{})),Ee(()=>Ee(()=>u()==="locations")()&&(()=>{var H=eN(),J=H.firstChild,te=J.firstChild,ee=J.nextSibling;return J.style.setProperty("display","flex"),J.style.setProperty("justify-content","space-between"),J.style.setProperty("align-items","center"),J.style.setProperty("margin-bottom","1.5rem"),te.style.setProperty("margin","0"),te.style.setProperty("font-size","1.5rem"),a(te,()=>t("inventory.locations")),a(J,M(Ge,{get when(){return pr.hasPermission("read_write")},get children(){return M(dt,{variant:"primary",onClick:()=>U(!0),get children(){return["🏭 ",Ee(()=>t("inventory.addLocation"))]}})}}),null),m(ee,V),a(ee,M(Ht,{get each(){return ct.getActiveLocations()},children:ne=>{const G=ct.getStockByLocation(ne.id),ce=G?.length,oe=G?.reduce((de,fe)=>de*1+fe.quantity*1,0),z=G?.reduce((de,fe)=>(ct?.getProductById(fe.productId),de+(fe?.averageCost||0)),0);return(()=>{var de=tN(),fe=de.firstChild,ue=fe.firstChild,ge=ue.firstChild,xe=ge.nextSibling,pe=ue.nextSibling,_e=pe.firstChild,Le=pe.nextSibling,De=fe.nextSibling,Te=De.firstChild,$e=Te.firstChild,Ie=$e.firstChild,Re=$e.nextSibling,Ke=Te.nextSibling,je=Ke.firstChild,We=je.firstChild,Qe=je.nextSibling,at=Ke.nextSibling,nt=at.firstChild,Ye=nt.firstChild,ht=nt.nextSibling,lt=De.nextSibling,$t=lt.firstChild,_t=$t.firstChild;return fe.style.setProperty("margin-bottom","1rem"),fe.style.setProperty("padding-bottom","1rem"),fe.style.setProperty("border-bottom","1px solid var(--border-color)"),ue.style.setProperty("display","flex"),ue.style.setProperty("align-items","center"),ue.style.setProperty("gap","0.5rem"),ue.style.setProperty("margin-bottom","0.5rem"),ge.style.setProperty("font-size","1.2rem"),a(ge,()=>ne.type==="warehouse"?"🏭":ne.type==="store"?"🏪":ne.type==="supplier"?"🚚":"👥"),xe.style.setProperty("margin","0"),xe.style.setProperty("font-size","1.1rem"),a(xe,()=>ne.name),pe.style.setProperty("font-size","0.875rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>ne.code,_e),a(pe,()=>W(ne.type),null),Le.style.setProperty("font-size","0.75rem"),Le.style.setProperty("color","var(--text-muted)"),Le.style.setProperty("margin-top","0.25rem"),a(Le,()=>ne.address),De.style.setProperty("margin-bottom","1rem"),Te.style.setProperty("display","flex"),Te.style.setProperty("justify-content","space-between"),Te.style.setProperty("margin-bottom","0.5rem"),$e.style.setProperty("font-size","0.875rem"),$e.style.setProperty("font-weight","500"),a($e,()=>t("inventory.products"),Ie),Re.style.setProperty("font-weight","600"),a(Re,ce),Ke.style.setProperty("display","flex"),Ke.style.setProperty("justify-content","space-between"),Ke.style.setProperty("margin-bottom","0.5rem"),je.style.setProperty("font-size","0.875rem"),je.style.setProperty("font-weight","500"),a(je,()=>t("inventory.totalItems"),We),Qe.style.setProperty("font-weight","600"),Qe.style.setProperty("color","var(--primary-color)"),a(Qe,oe),at.style.setProperty("display","flex"),at.style.setProperty("justify-content","space-between"),at.style.setProperty("margin-bottom","1rem"),nt.style.setProperty("font-size","0.875rem"),nt.style.setProperty("font-weight","500"),a(nt,()=>t("inventory.totalValue"),Ye),ht.style.setProperty("font-weight","600"),ht.style.setProperty("color","var(--primary-color)"),a(ht,()=>_(z)),$t.style.setProperty("font-weight","600"),$t.style.setProperty("margin-bottom","0.75rem"),$t.style.setProperty("font-size","0.875rem"),$t.style.setProperty("color","var(--text-primary)"),$t.style.setProperty("border-bottom","1px solid var(--border-color)"),$t.style.setProperty("padding-bottom","0.5rem"),a($t,()=>t("inventory.productDetails"),_t),a(lt,(()=>{var ze=Ee(()=>G?.length===0);return()=>ze()?(()=>{var Lt=Ii();return Lt.style.setProperty("text-align","center"),Lt.style.setProperty("color","var(--text-muted)"),Lt.style.setProperty("font-style","italic"),Lt.style.setProperty("padding","1rem"),a(Lt,()=>t("inventory.noProducts")),Lt})():(()=>{var Lt=Ii();return Lt.style.setProperty("max-height","200px"),Lt.style.setProperty("overflow-y","auto"),Lt.style.setProperty("border","1px solid var(--border-color)"),Lt.style.setProperty("border-radius","var(--border-radius-sm)"),a(Lt,M(Ht,{each:G,children:Nt=>{const wt=ct.getProductById(Nt.productId);if(!wt)return null;const Ot=Nt.quantity<=wt.minStockLevel,gr=Nt.averageCost;return Nt.quantity?(()=>{var Be=rN(),Pt=Be.firstChild,Ct=Pt.firstChild,tt=Ct.firstChild,ft=tt.nextSibling,Vt=Ct.nextSibling,Rt=Vt.firstChild,rr=Rt.firstChild,it=Rt.nextSibling,yt=it.nextSibling;return yt.firstChild,Be.style.setProperty("padding","0.75rem"),Be.style.setProperty("border-bottom","1px solid var(--border-color)"),(Ot?"#fff5f5":"transparent")!=null?Be.style.setProperty("background",Ot?"#fff5f5":"transparent"):Be.style.removeProperty("background"),Be.style.setProperty("transition","background-color 0.2s ease"),Pt.style.setProperty("display","flex"),Pt.style.setProperty("justify-content","space-between"),Pt.style.setProperty("align-items","flex-start"),Pt.style.setProperty("margin-bottom","0.25rem"),Ct.style.setProperty("flex","1"),tt.style.setProperty("font-weight","500"),tt.style.setProperty("font-size","0.875rem"),(Ot?"#d32f2f":"var(--text-primary)")!=null?tt.style.setProperty("color",Ot?"#d32f2f":"var(--text-primary)"):tt.style.removeProperty("color"),a(tt,()=>wt.name,null),a(tt,Ot&&(()=>{var It=nN();return It.style.setProperty("margin-left","0.5rem"),It.style.setProperty("font-size","0.7rem"),It.style.setProperty("color","#d32f2f"),It})(),null),ft.style.setProperty("font-size","0.75rem"),ft.style.setProperty("color","var(--text-muted)"),ft.style.setProperty("margin-top","0.1rem"),a(ft,()=>wt.sku,null),a(ft,()=>wt.UPC?" • "+wt.UPC:"",null),a(ft,()=>wt.category?" • "+wt.category:"",null),Vt.style.setProperty("text-align","right"),Rt.style.setProperty("font-weight","600"),Rt.style.setProperty("font-size","0.875rem"),(Ot?"#d32f2f":"var(--primary-color)")!=null?Rt.style.setProperty("color",Ot?"#d32f2f":"var(--primary-color)"):Rt.style.removeProperty("color"),a(Rt,()=>Nt.quantity,rr),a(Rt,()=>wt.unitOfMeasure,null),it.style.setProperty("font-size","0.75rem"),it.style.setProperty("color","var(--text-muted)"),a(it,()=>_(gr)),yt.style.setProperty("font-size","0.7rem"),yt.style.setProperty("color","var(--text-muted)"),yt.style.setProperty("margin-top","0.1rem"),a(yt,()=>wt.minStockLevel,null),Be})():null}})),Lt})()})(),null),Se(ze=>m(de,{...I,"min-height":"400px"},ze)),de})()}})),H})())]}}),M(Ge,{get when(){return pr.hasPermission("read_write")},get children(){return[M(GE,{get isOpen(){return e()},onClose:()=>r(!1),get mode(){return y()==="new"?"movement":"legacy"}}),M(hT,{get isOpen(){return n()},onClose:()=>i(!1)}),M(gT,{get isOpen(){return o()},onClose:()=>s(!1),get item(){return l()}}),M(Uy,{get isOpen(){return $()},onClose:()=>U(!1),onLocationAdded:()=>{U(!1)}})]}}),M(nk,{get isOpen(){return se()},onClose:()=>X(!1)}),M(Wk,{get isOpen(){return Z()},onClose:()=>re(!1)})]}})};yr(["click"]);const oN=[{id:"1",name:"John Doe",position:"Software Engineer",salary:85e3,email:"john.doe@company.com",phone:"+1 (555) 123-4567",department:"Engineering",startDate:"2023-01-15"},{id:"2",name:"Jane Smith",position:"Product Manager",salary:95e3,email:"jane.smith@company.com",phone:"+1 (555) 234-5678",department:"Product",startDate:"2022-08-20"},{id:"3",name:"Mike Brown",position:"Designer",salary:7e4,email:"mike.brown@company.com",phone:"+1 (555) 345-6789",department:"Design",startDate:"2023-03-10"},{id:"4",name:"Sarah Kim",position:"HR Manager",salary:78e3,email:"sarah.kim@company.com",phone:"+1 (555) 456-7890",department:"Human Resources",startDate:"2022-11-05"},{id:"5",name:"Alex Lee",position:"Data Analyst",salary:72e3,email:"alex.lee@company.com",phone:"+1 (555) 567-8901",department:"Analytics",startDate:"2023-02-28"},{id:"6",name:"Emma Wilson",position:"Marketing Manager",salary:82e3,email:"emma.wilson@company.com",phone:"+1 (555) 678-9012",department:"Marketing",startDate:"2022-09-15"}],[Zc,lf]=Ce(oN),N5={get employees(){return Zc()},addEmployee(t){const e={...t,id:Date.now().toString()};return lf([...Zc(),e]),e},updateEmployee(t,e){lf(Zc().map(r=>r.id===t?{...r,...e}:r))},deleteEmployee(t){lf(Zc().filter(e=>e.id!==t))},getEmployeeById(t){return Zc().find(e=>e.id===t)}};var sN=he("<form><div>");const aN=t=>{const{t:e}=sr(),[r,n]=Ce({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),i=[{value:"Engineering",label:e("employees.departments.engineering","Engineering")},{value:"Product",label:e("employees.departments.product","Product")},{value:"Design",label:e("employees.departments.design","Design")},{value:"Marketing",label:e("employees.departments.marketing","Marketing")},{value:"Sales",label:e("employees.departments.sales","Sales")},{value:"Human Resources",label:e("employees.departments.humanResources","Human Resources")},{value:"Finance",label:e("employees.departments.finance","Finance")},{value:"Operations",label:e("employees.departments.operations","Operations")},{value:"Analytics",label:e("employees.departments.analytics","Analytics")}],o={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},s=c=>{c.preventDefault();const u=r();if(!u.name||!u.position||!u.salary||!u.email||!u.department||!u.startDate){alert(e("forms.requiredField"));return}const h={name:u.name,position:u.position,salary:parseFloat(u.salary),email:u.email,phone:u.phone,department:u.department,startDate:u.startDate};N5.addEmployee(h),n({name:"",position:"",salary:"",email:"",phone:"",department:"",startDate:""}),t.onClose()},l=(c,u)=>{n(h=>({...h,[c]:u}))};return M(Fn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.addEmployee")},get children(){var c=sN(),u=c.firstChild;return c.addEventListener("submit",s),a(c,M(Ar,{get label(){return e("employees.fullName")},get value(){return r().name},onChange:h=>l("name",h),get placeholder(){return e("employees.enterFullName","Enter employee's full name")},required:!0}),u),a(c,M(Ar,{get label(){return e("employees.position")},get value(){return r().position},onChange:h=>l("position",h),get placeholder(){return e("employees.enterPosition","Enter job position")},required:!0}),u),a(c,M(_n,{get label(){return e("employees.department")},get value(){return r().department},onChange:h=>l("department",h),options:i,required:!0}),u),a(c,M(Ar,{get label(){return e("employees.email")},type:"email",get value(){return r().email},onChange:h=>l("email",h),get placeholder(){return e("employees.enterEmail","Enter email address")},required:!0}),u),a(c,M(Ar,{get label(){return e("employees.phone")},type:"tel",get value(){return r().phone},onChange:h=>l("phone",h),get placeholder(){return e("employees.enterPhone","Enter phone number")}}),u),a(c,M(Ar,{get label(){return e("employees.salary")},type:"number",get value(){return r().salary},onChange:h=>l("salary",h),get placeholder(){return e("employees.enterSalary","Enter annual salary")},required:!0}),u),a(c,M(Ar,{get label(){return e("employees.hireDate")},type:"date",get value(){return r().startDate},onChange:h=>l("startDate",h),required:!0}),u),m(u,o),a(u,M(dt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(u,M(dt,{variant:"primary",type:"submit",get children(){return e("employees.addEmployee")}}),null),c}})};var lN=he("<div><div></div><div></div><div>"),cN=he("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span>"),uN=he("<div>");const dN=t=>{const{t:e}=sr(),r={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},n={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},i={"font-weight":"600",color:"var(--text-primary)"},o={width:"80px",height:"80px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.5rem",margin:"0 auto 1.5rem auto"},s={"text-align":"center","margin-bottom":"2rem"},l={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},c={color:"var(--text-muted)","font-size":"1rem"},u={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"};if(!t.employee)return null;const h=f=>f.split(" ").map(x=>x[0]).join("").toUpperCase(),y=f=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(f),g=f=>new Date(f).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return M(Fn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("employees.employeeDetails")},get children(){return[(()=>{var f=lN(),x=f.firstChild,S=x.nextSibling,P=S.nextSibling;return m(f,s),m(x,o),a(x,()=>h(t.employee.name)),m(S,l),a(S,()=>t.employee.name),m(P,c),a(P,()=>t.employee.position),f})(),(()=>{var f=cN(),x=f.firstChild,S=x.firstChild,P=S.nextSibling,$=x.nextSibling,U=$.firstChild,se=U.nextSibling,X=$.nextSibling,Z=X.firstChild,re=Z.nextSibling,E=X.nextSibling,C=E.firstChild,T=C.nextSibling,j=E.nextSibling,b=j.firstChild,w=b.nextSibling,_=j.nextSibling,W=_.firstChild,K=W.nextSibling;return a(S,()=>e("employees.employeeId")),a(P,()=>t.employee.id),a(U,()=>e("employees.department")),a(se,()=>t.employee.department),a(Z,()=>e("employees.email")),a(re,()=>t.employee.email),a(C,()=>e("employees.phone")),a(T,()=>t.employee.phone),a(b,()=>e("employees.salary")),a(w,()=>y(t.employee.salary)),a(W,()=>e("employees.hireDate")),a(K,()=>g(t.employee.startDate)),Se(k=>{var R=r,Y=n,q=i,O=r,le=n,N=i,D=r,V=n,I=i,F=r,Q=n,H=i,J=r,te=n,ee=i,ne=r,G=n,ce=i;return k.e=m(x,R,k.e),k.t=m(S,Y,k.t),k.a=m(P,q,k.a),k.o=m($,O,k.o),k.i=m(U,le,k.i),k.n=m(se,N,k.n),k.s=m(X,D,k.s),k.h=m(Z,V,k.h),k.r=m(re,I,k.r),k.d=m(E,F,k.d),k.l=m(C,Q,k.l),k.u=m(T,H,k.u),k.c=m(j,J,k.c),k.w=m(b,te,k.w),k.m=m(w,ee,k.m),k.f=m(_,ne,k.f),k.y=m(W,G,k.y),k.g=m(K,ce,k.g),k},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0}),f})(),(()=>{var f=uN();return m(f,u),a(f,M(dt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(f,M(dt,{variant:"primary",onClick:()=>{console.log("Edit employee:",t.employee.id)},get children(){return e("employees.editEmployee")}}),null),f})()]}})};var C0=he("<div>"),hN=he("<div><div></div><div><div></div><div></div><div>/year");const pN=()=>{const{t}=sr(),[e,r]=Ce(!1),[n,i]=Ce(!1),[o,s]=Ce(null),l=S=>{s(S),i(!0)},c={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},u={display:"flex","align-items":"center",gap:"1rem"},h={width:"60px",height:"60px","border-radius":"50%",background:"linear-gradient(135deg, var(--primary-color), var(--secondary-color))",display:"flex","align-items":"center","justify-content":"center",color:"white","font-weight":"600","font-size":"1.2rem"},y={flex:"1"},g={"font-weight":"600","margin-bottom":"0.25rem"},f={color:"var(--text-muted)","font-size":"0.875rem","margin-bottom":"0.5rem"},x={color:"var(--primary-color)","font-weight":"500"};return M(Qi,{get title(){return t("employees.title")},get children(){return[(()=>{var S=C0();return S.style.setProperty("margin-bottom","2rem"),a(S,M(dt,{variant:"primary",onClick:()=>r(!0),get children(){return t("employees.addEmployee")}})),S})(),(()=>{var S=C0();return m(S,c),a(S,()=>N5.employees.map(P=>{const $=se=>se.split(" ").map(X=>X[0]).join("").toUpperCase(),U=se=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(se);return M(Ft,{onClick:()=>l(P),get children(){var se=hN(),X=se.firstChild,Z=X.nextSibling,re=Z.firstChild,E=re.nextSibling,C=E.nextSibling,T=C.firstChild;return m(se,u),m(X,h),a(X,()=>$(P.name)),m(Z,y),m(re,g),a(re,()=>P.name),m(E,f),a(E,()=>P.position),m(C,x),a(C,()=>U(P.salary),T),se}})})),S})(),M(aN,{get isOpen(){return e()},onClose:()=>r(!1)}),M(dN,{get isOpen(){return n()},onClose:()=>i(!1),get employee(){return o()}})]}})},fN=[{id:"1",accountId:"1002",bankName:"First National Bank",accountNumber:"****1234",accountType:"checking",currency:"USD",currentBalance:32730.5,lastReconciledDate:"2024-01-01",lastReconciledBalance:3e4,isActive:!0},{id:"2",accountId:"1003",bankName:"First National Bank",accountNumber:"****5678",accountType:"savings",currency:"USD",currentBalance:12e3,lastReconciledDate:"2024-01-01",lastReconciledBalance:1e4,isActive:!0}],mN=[{id:"1",accountId:"1002",date:"2024-01-15",description:"Customer Payment - ABC Corp",reference:"CHK001234",debitAmount:5e3,creditAmount:0,balance:35730.5,category:"Customer Payment",isReconciled:!0,reconciledWith:"eb1",importedAt:"2024-01-16",source:"csv_import"},{id:"2",accountId:"1002",date:"2024-01-14",description:"Office Supplies - Staples",reference:"CHK001235",debitAmount:0,creditAmount:250,balance:30730.5,category:"Office Expenses",isReconciled:!0,reconciledWith:"eb2",importedAt:"2024-01-16",source:"csv_import"},{id:"3",accountId:"1002",date:"2024-01-13",description:"Monthly Rent Payment",reference:"CHK001236",debitAmount:0,creditAmount:2e3,balance:28730.5,category:"Rent",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"},{id:"4",accountId:"1002",date:"2024-01-12",description:"Wire Transfer In",reference:"WIRE001",debitAmount:1e4,creditAmount:0,balance:38730.5,category:"Wire Transfer",isReconciled:!1,importedAt:"2024-01-16",source:"csv_import"}],yN=[{id:"eb1",accountId:"1002",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",debitAmount:5e3,creditAmount:0,category:"Accounts Receivable",isReconciled:!0,reconciledWith:"1",createdAt:"2024-01-15"},{id:"eb2",accountId:"1002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",debitAmount:0,creditAmount:250,category:"Office Expenses",isReconciled:!0,reconciledWith:"2",createdAt:"2024-01-14"},{id:"eb3",accountId:"1002",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",debitAmount:0,creditAmount:3500,category:"Salary Expense",isReconciled:!1,createdAt:"2024-01-11"}],gN=[{id:"1",bankAccountId:"1",periodStart:"2024-01-01",periodEnd:"2024-01-15",startingBalance:3e4,endingBalance:35730.5,status:"in_progress",totalBankTransactions:4,totalEntryBookRecords:3,reconciledTransactions:2,unreconciledTransactions:2,discrepancyAmount:1500,createdAt:"2024-01-16",notes:"Wire transfer and rent payment need investigation"}],[Vd,I0]=Ce(fN),[aa,cf]=Ce(mN),[eu,$0]=Ce(yN),[qd,E0]=Ce(gN),Vn={get bankAccounts(){return Vd()},addBankAccount(t){const e={...t,id:Date.now().toString()};return I0([...Vd(),e]),e},updateBankAccount(t,e){I0(Vd().map(r=>r.id===t?{...r,...e}:r))},getBankAccountById(t){return Vd().find(e=>e.id===t)},get bankStatements(){return aa()},addBankStatement(t){const e={...t,id:Date.now().toString(),importedAt:new Date().toISOString()};return cf([...aa(),e]),e},addBankStatementsFromCSV(t){const e=t.map(r=>({...r,id:`csv_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,importedAt:new Date().toISOString(),source:"csv_import",isReconciled:!1}));return cf([...aa(),...e]),e},updateBankStatement(t,e){cf(aa().map(r=>r.id===t?{...r,...e}:r))},getBankStatementsByAccount(t){return aa().filter(e=>e.accountId===t)},getUnreconciledBankStatements(t){return(t?this.getBankStatementsByAccount(t):aa()).filter(r=>!r.isReconciled)},get entryBookRecords(){return eu()},addEntryBookRecord(t){const e={...t,id:Date.now().toString(),createdAt:new Date().toISOString()};return $0([...eu(),e]),e},updateEntryBookRecord(t,e){$0(eu().map(r=>r.id===t?{...r,...e}:r))},getEntryBookRecordsByAccount(t){return eu().filter(e=>e.accountId===t)},getUnreconciledEntryBookRecords(t){return(t?this.getEntryBookRecordsByAccount(t):eu()).filter(r=>!r.isReconciled)},reconcileTransaction(t,e){this.updateBankStatement(t,{isReconciled:!0,reconciledWith:e}),this.updateEntryBookRecord(e,{isReconciled:!0,reconciledWith:t})},unreconciledTransaction(t){const e=aa().find(r=>r.id===t);e?.reconciledWith&&this.updateEntryBookRecord(e.reconciledWith,{isReconciled:!1,reconciledWith:void 0}),this.updateBankStatement(t,{isReconciled:!1,reconciledWith:void 0})},findPotentialMatches(t){const e=aa().find(n=>n.id===t);return e?this.getUnreconciledEntryBookRecords(e.accountId).filter(n=>{const i=Math.abs(e.debitAmount-n.debitAmount)<.01||Math.abs(e.creditAmount-n.creditAmount)<.01,o=new Date(e.date),s=new Date(n.date),c=Math.abs((o.getTime()-s.getTime())/(1e3*60*60*24))<=3,u=e.reference===n.reference||e.description.toLowerCase().includes(n.description.toLowerCase())||n.description.toLowerCase().includes(e.description.toLowerCase());return i&&(c||u)}).sort((n,i)=>{const o=(n.date===e.date?2:0)+(n.reference===e.reference?1:0);return(i.date===e.date?2:0)+(i.reference===e.reference?1:0)-o}):[]},get reconciliationSessions(){return qd()},startReconciliationSession(t,e,r){const n=this.getBankStatementsByAccount(t).filter(u=>u.date>=e&&u.date<=r),i=this.getEntryBookRecordsByAccount(t).filter(u=>u.date>=e&&u.date<=r),o=n.filter(u=>u.isReconciled).length,s=this.getBankAccountById(t)?.lastReconciledBalance||0,l=this.getBankAccountById(t)?.currentBalance||0,c={id:Date.now().toString(),bankAccountId:t,periodStart:e,periodEnd:r,startingBalance:s,endingBalance:l,status:"in_progress",totalBankTransactions:n.length,totalEntryBookRecords:i.length,reconciledTransactions:o,unreconciledTransactions:n.length-o,discrepancyAmount:0,createdAt:new Date().toISOString()};return E0([...qd(),c]),c},updateReconciliationSession(t,e){E0(qd().map(r=>r.id===t?{...r,...e}:r))},getReconciliationSessionsByAccount(t){return qd().filter(e=>e.bankAccountId===t)}};var uf=he("<div>"),vN=he("<div><strong>:</strong> <!> - "),bN=he("<div><div><div>📄</div><div></div><div></div></div><input id=csvFileInput type=file accept=.csv>"),_N=he("<div><h4></h4><div><div><label> *</label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label> *</label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value>"),Xl=he("<option>"),SN=he("<div><table><thead><tr></tr></thead><tbody>"),PN=he("<th>"),wN=he("<tr>"),xN=he("<td>");const AN=t=>{const{t:e}=sr(),[r,n]=Ce(!1),[i,o]=Ce(!1),[s,l]=Ce(null),[c,u]=Ce([]),[h,y]=Ce({date:"",description:"",reference:"",debit:"",credit:"",balance:""}),g={border:`2px dashed ${r()?"var(--primary-color)":"var(--border-color)"}`,"border-radius":"var(--border-radius)",padding:"2rem","text-align":"center","background-color":r()?"var(--background-color)":"transparent",transition:"all 0.2s ease",cursor:"pointer"},f={display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem","margin-top":"1.5rem"},x={width:"100%",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-family":"inherit"},S={"max-height":"200px","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},P={width:"100%","border-collapse":"collapse","font-size":"0.875rem"},$={padding:"0.5rem","border-bottom":"1px solid var(--border-color)","text-align":"left"},U={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},se=w=>{w.preventDefault(),n(!0)},X=w=>{w.preventDefault(),n(!1)},Z=w=>{w.preventDefault(),n(!1);const _=w.dataTransfer?.files;_&&_.length>0&&E(_[0])},re=w=>{const _=w.target;_.files&&_.files.length>0&&E(_.files[0])},E=w=>{if(!w.name.toLowerCase().endsWith(".csv")){l({success:!1,message:e("banking.pleaseUploadCSV")});return}o(!0);const _=new FileReader;_.onload=W=>{try{const k=(W.target?.result).split(`
`).filter(O=>O.trim());if(k.length<2){l({success:!1,message:e("banking.csvRequiresHeaderAndData")}),o(!1);return}const R=k[0].split(",").map(O=>O.trim().replace(/[\"\']/g,"")),Y=k.slice(1).map(O=>{const le=O.split(",").map(D=>D.trim().replace(/[\"\']/g,"")),N={};return R.forEach((D,V)=>{N[D]=le[V]||""}),N});u(Y),l({success:!0,message:e("banking.successfullyParsed").replace("{count}",Y.length.toString()),count:Y.length});const q={...h()};R.forEach(O=>{const le=O.toLowerCase();le.includes("date")&&(q.date=O),(le.includes("description")||le.includes("memo"))&&(q.description=O),(le.includes("reference")||le.includes("check")||le.includes("ref"))&&(q.reference=O),(le.includes("debit")||le.includes("deposit"))&&(q.debit=O),(le.includes("credit")||le.includes("withdrawal")||le.includes("amount"))&&(q.debit?q.credit=O:q.debit=O),le.includes("balance")&&(q.balance=O)}),y(q)}catch{l({success:!1,message:e("banking.errorParsingCSV")})}o(!1)},_.readAsText(w)},C=(w,_)=>{y(W=>({...W,[w]:_}))},T=()=>c().length===0?[]:Object.keys(c()[0]),j=()=>{if(!t.bankAccount||c().length===0)return;const w=h();if(!w.date||!w.description){l({success:!1,message:e("banking.dateDescriptionRequired")});return}o(!0);try{const _=c().map(K=>{const k=O=>O&&parseFloat(O.replace(/[^0-9.-]/g,""))||0,R=O=>{const le=new Date(O);if(isNaN(le.getTime())){const N=O.split("/");if(N.length===3)return new Date(parseInt(N[2]),parseInt(N[0])-1,parseInt(N[1])).toISOString().split("T")[0]}return le.toISOString().split("T")[0]};let Y=0,q=0;if(w.debit&&w.credit)Y=k(K[w.debit]),q=k(K[w.credit]);else if(w.debit){const O=k(K[w.debit]);O>0?Y=O:q=Math.abs(O)}return{accountId:t.bankAccount.accountId,date:R(K[w.date]),description:K[w.description]||e("banking.importedTransaction"),reference:K[w.reference]||"",debitAmount:Y,creditAmount:q,balance:w.balance?k(K[w.balance]):0,isReconciled:!1}}),W=Vn.addBankStatementsFromCSV(_);l({success:!0,message:e("banking.successfullyImported").replace("{count}",W.length.toString()),count:W.length}),u([]),y({date:"",description:"",reference:"",debit:"",credit:"",balance:""})}catch{l({success:!1,message:e("banking.errorImportingTransactions")})}o(!1)},b=()=>{u([]),l(null),y({date:"",description:"",reference:"",debit:"",credit:"",balance:""})};return M(Fn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("banking.importBankStatementCSV")},get children(){return[Ee(()=>Ee(()=>!!t.bankAccount)()&&(()=>{var w=vN(),_=w.firstChild,W=_.firstChild,K=_.nextSibling,k=K.nextSibling;return k.nextSibling,w.style.setProperty("margin-bottom","1.5rem"),w.style.setProperty("padding","1rem"),w.style.setProperty("background","var(--background-color)"),w.style.setProperty("border-radius","var(--border-radius-sm)"),w.style.setProperty("border","1px solid var(--border-color)"),a(_,()=>e("banking.bankAccount"),W),a(w,()=>t.bankAccount.bankName,k),a(w,()=>t.bankAccount.accountNumber,null),w})()),Ee(()=>Ee(()=>c().length===0)()?(()=>{var w=bN(),_=w.firstChild,W=_.firstChild,K=W.nextSibling,k=K.nextSibling,R=_.nextSibling;return _.$$click=()=>document.getElementById("csvFileInput")?.click(),_.addEventListener("drop",Z),_.addEventListener("dragleave",X),_.addEventListener("dragover",se),W.style.setProperty("font-size","2rem"),W.style.setProperty("margin-bottom","1rem"),K.style.setProperty("font-weight","500"),K.style.setProperty("margin-bottom","0.5rem"),a(K,(()=>{var Y=Ee(()=>!!r());return()=>Y()?e("banking.dropCSVHere"):e("banking.clickToUploadCSV")})()),k.style.setProperty("font-size","0.875rem"),k.style.setProperty("color","var(--text-muted)"),a(k,()=>e("banking.supportedFormat")),R.addEventListener("change",re),R.style.setProperty("display","none"),Se(Y=>m(_,g,Y)),w})():(()=>{var w=_N(),_=w.firstChild,W=_.nextSibling,K=W.firstChild,k=K.firstChild,R=k.firstChild,Y=k.nextSibling,q=Y.firstChild,O=K.nextSibling,le=O.firstChild,N=le.firstChild,D=le.nextSibling,V=D.firstChild,I=O.nextSibling,F=I.firstChild,Q=F.nextSibling,H=Q.firstChild,J=I.nextSibling,te=J.firstChild,ee=te.firstChild,ne=te.nextSibling,G=ne.firstChild,ce=J.nextSibling,oe=ce.firstChild,z=oe.nextSibling,de=z.firstChild,fe=ce.nextSibling,ue=fe.firstChild,ge=ue.nextSibling,xe=ge.firstChild;return _.style.setProperty("margin","0 0 1rem 0"),a(_,()=>e("banking.mapCSVColumns")),m(W,f),k.style.setProperty("display","block"),k.style.setProperty("margin-bottom","0.5rem"),k.style.setProperty("font-weight","500"),a(k,()=>e("banking.dateColumn"),R),Y.addEventListener("change",pe=>C("date",pe.target.value)),a(q,()=>e("banking.selectColumn")),a(Y,()=>T().map(pe=>(()=>{var _e=Xl();return _e.value=pe,a(_e,pe),_e})()),null),le.style.setProperty("display","block"),le.style.setProperty("margin-bottom","0.5rem"),le.style.setProperty("font-weight","500"),a(le,()=>e("banking.descriptionColumn"),N),D.addEventListener("change",pe=>C("description",pe.target.value)),a(V,()=>e("banking.selectColumn")),a(D,()=>T().map(pe=>(()=>{var _e=Xl();return _e.value=pe,a(_e,pe),_e})()),null),F.style.setProperty("display","block"),F.style.setProperty("margin-bottom","0.5rem"),F.style.setProperty("font-weight","500"),a(F,()=>e("banking.referenceColumn")),Q.addEventListener("change",pe=>C("reference",pe.target.value)),a(H,()=>e("banking.selectColumn")),a(Q,()=>T().map(pe=>(()=>{var _e=Xl();return _e.value=pe,a(_e,pe),_e})()),null),te.style.setProperty("display","block"),te.style.setProperty("margin-bottom","0.5rem"),te.style.setProperty("font-weight","500"),a(te,()=>e("banking.amountDebitColumn"),ee),ne.addEventListener("change",pe=>C("debit",pe.target.value)),a(G,()=>e("banking.selectColumn")),a(ne,()=>T().map(pe=>(()=>{var _e=Xl();return _e.value=pe,a(_e,pe),_e})()),null),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.5rem"),oe.style.setProperty("font-weight","500"),a(oe,()=>e("banking.creditColumn")),z.addEventListener("change",pe=>C("credit",pe.target.value)),a(de,()=>e("banking.selectColumn")),a(z,()=>T().map(pe=>(()=>{var _e=Xl();return _e.value=pe,a(_e,pe),_e})()),null),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),a(ue,()=>e("banking.balanceColumn")),ge.addEventListener("change",pe=>C("balance",pe.target.value)),a(xe,()=>e("banking.selectColumn")),a(ge,()=>T().map(pe=>(()=>{var _e=Xl();return _e.value=pe,a(_e,pe),_e})()),null),a(w,(()=>{var pe=Ee(()=>c().length>0);return()=>pe()&&(()=>{var _e=SN(),Le=_e.firstChild,De=Le.firstChild,Te=De.firstChild,$e=De.nextSibling;return m(_e,S),Te.style.setProperty("background-color","var(--background-color)"),a(Te,()=>T().slice(0,6).map(Ie=>(()=>{var Re=PN();return a(Re,Ie),Se(Ke=>m(Re,$,Ke)),Re})())),a($e,()=>c().slice(0,3).map(Ie=>(()=>{var Re=wN();return a(Re,()=>T().slice(0,6).map(Ke=>(()=>{var je=xN();return a(je,()=>Ie[Ke]),Se(We=>m(je,$,We)),je})())),Re})())),a(_e,(()=>{var Ie=Ee(()=>c().length>3);return()=>Ie()&&(()=>{var Re=uf();return Re.style.setProperty("padding","0.5rem"),Re.style.setProperty("text-align","center"),Re.style.setProperty("color","var(--text-muted)"),a(Re,()=>e("banking.andMoreRows").replace("{count}",(c().length-3).toString())),Re})()})(),null),Se(Ie=>m(Le,P,Ie)),_e})()})(),null),Se(pe=>{var _e=x,Le=x,De=x,Te=x,$e=x,Ie=x;return pe.e=m(Y,_e,pe.e),pe.t=m(D,Le,pe.t),pe.a=m(Q,De,pe.a),pe.o=m(ne,Te,pe.o),pe.i=m(z,$e,pe.i),pe.n=m(ge,Ie,pe.n),pe},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),Se(()=>Y.value=h().date),Se(()=>D.value=h().description),Se(()=>Q.value=h().reference),Se(()=>ne.value=h().debit),Se(()=>z.value=h().credit),Se(()=>ge.value=h().balance),w})()),Ee(()=>Ee(()=>!!s())()&&(()=>{var w=uf();return w.style.setProperty("padding","1rem"),w.style.setProperty("border-radius","var(--border-radius-sm)"),w.style.setProperty("margin-top","1rem"),a(w,()=>s().message),Se(_=>{var W=s().success?"#d4edda":"#f8d7da",K=s().success?"#155724":"#721c24",k=`1px solid ${s().success?"#c3e6cb":"#f5c6cb"}`;return W!==_.e&&((_.e=W)!=null?w.style.setProperty("background",W):w.style.removeProperty("background")),K!==_.t&&((_.t=K)!=null?w.style.setProperty("color",K):w.style.removeProperty("color")),k!==_.a&&((_.a=k)!=null?w.style.setProperty("border",k):w.style.removeProperty("border")),_},{e:void 0,t:void 0,a:void 0}),w})()),(()=>{var w=uf();return m(w,U),a(w,M(dt,{variant:"secondary",onClick:()=>{b(),t.onClose()},get children(){return e("common.cancel")}}),null),a(w,(()=>{var _=Ee(()=>c().length>0);return()=>_()&&M(dt,{variant:"outline",onClick:b,get children(){return e("common.reset")}})})(),null),a(w,(()=>{var _=Ee(()=>c().length>0);return()=>_()&&M(dt,{variant:"primary",onClick:j,get disabled(){return i()||!h().date||!h().description},get children(){return Ee(()=>!!i())()?e("banking.importing"):e("banking.importTransactions").replace("{count}",c().length.toString())}})})(),null),w})()]}})};yr(["click"]);var T0=he("<span>"),zd=he("<div>"),k0=he("<div> "),CN=he("<div><div><h3></h3><div><button></button><button></button><button></button></div></div><div></div><div><div><h4></h4><div></div></div><div><h4></h4><div>"),IN=he("<div><div><div></div><div> • </div></div><div><div>"),df=he("<span>✓ "),$N=he("<span>(<!>)"),EN=he("<div><strong>:</strong> "),N0=he("<div><div><div></div><div> • </div></div><div>"),TN=he("<div><div>:</div><div></div><div>");const kN=t=>{const{t:e}=sr(),[r,n]=Ce([]),[i,o]=Ce([]),[s,l]=Ce(null),[c,u]=Ce([]),[h,y]=Ce("unreconciled");yi(()=>{const k=Vn.getBankAccountById(t.bankAccountId);if(k){const R=Vn.getBankStatementsByAccount(k.accountId).filter(q=>q.date>=t.selectedPeriod.start&&q.date<=t.selectedPeriod.end),Y=Vn.getEntryBookRecordsByAccount(k.accountId).filter(q=>q.date>=t.selectedPeriod.start&&q.date<=t.selectedPeriod.end);n(R),o(Y)}});const g=()=>{const k=r();switch(h()){case"reconciled":return k.filter(R=>R.isReconciled);case"unreconciled":return k.filter(R=>!R.isReconciled);default:return k}},f=()=>{const k=i();switch(h()){case"reconciled":return k.filter(R=>R.isReconciled);case"unreconciled":return k.filter(R=>!R.isReconciled);default:return k}},x=k=>{if(l(k),k.isReconciled)u([]);else{const R=Vn.findPotentialMatches(k.id);u(R)}},S=k=>{const R=s();if(R){Vn.reconcileTransaction(R.id,k.id);const Y=Vn.getBankAccountById(t.bankAccountId);if(Y){const q=Vn.getBankStatementsByAccount(Y.accountId).filter(le=>le.date>=t.selectedPeriod.start&&le.date<=t.selectedPeriod.end),O=Vn.getEntryBookRecordsByAccount(Y.accountId).filter(le=>le.date>=t.selectedPeriod.start&&le.date<=t.selectedPeriod.end);n(q),o(O)}l(null),u([])}},P=k=>{Vn.unreconciledTransaction(k.id);const R=Vn.getBankAccountById(t.bankAccountId);if(R){const Y=Vn.getBankStatementsByAccount(R.accountId).filter(O=>O.date>=t.selectedPeriod.start&&O.date<=t.selectedPeriod.end),q=Vn.getEntryBookRecordsByAccount(R.accountId).filter(O=>O.date>=t.selectedPeriod.start&&O.date<=t.selectedPeriod.end);n(Y),o(q)}},$={display:"grid","grid-template-columns":"1fr 1fr",gap:"2rem","margin-top":"2rem"},U={height:"600px","overflow-y":"auto"},se={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},X=k=>({padding:"0.5rem 1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:k?"var(--primary-color)":"var(--surface-color)",color:k?"white":"var(--text-primary)",cursor:"pointer","font-weight":"500","font-size":"0.875rem",transition:"all 0.2s ease"}),Z=(k,R)=>({display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem","margin-bottom":"0.5rem",background:k?"var(--primary-color)":R?"#e8f5e8":"var(--surface-color)",color:k?"white":"var(--text-primary)","border-radius":"var(--border-radius-sm)",border:`1px solid ${k?"var(--primary-color)":R?"#c3e6cb":"var(--border-color)"}`,cursor:"pointer",transition:"all 0.2s ease"}),re={flex:"1"},E={"font-weight":"500","margin-bottom":"0.25rem"},C={"font-size":"0.875rem",opacity:"0.8"},T=k=>({"font-weight":"600",color:k?"#4caf50":"#f44336"}),j={padding:"0.25rem 0.5rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","margin-left":"0.5rem"},b=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k),w=k=>new Date(k).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),_=k=>{if(!s())return null;const R=s();return(Math.abs(R.debitAmount-k.debitAmount)<.01||Math.abs(R.creditAmount-k.creditAmount)<.01)&&R.date===k.date?(()=>{var O=T0();return a(O,()=>e("banking.exactMatch")),Se(le=>m(O,{...j,background:"#d4edda",color:"#155724"},le)),O})():c().includes(k)?(()=>{var O=T0();return a(O,()=>e("banking.possibleMatch")),Se(le=>m(O,{...j,background:"#fff3cd",color:"#856404"},le)),O})():null},K=(()=>{const k=r(),R=i(),Y=k.filter(O=>O.isReconciled).length,q=R.filter(O=>O.isReconciled).length;return{totalStatements:k.length,totalRecords:R.length,reconciledStatements:Y,reconciledRecords:q,unreconciledStatements:k.length-Y,unreconciledRecords:R.length-q}})();return(()=>{var k=CN(),R=k.firstChild,Y=R.firstChild,q=Y.nextSibling,O=q.firstChild,le=O.nextSibling,N=le.nextSibling,D=R.nextSibling,V=D.nextSibling,I=V.firstChild,F=I.firstChild,Q=F.nextSibling,H=I.nextSibling,J=H.firstChild,te=J.nextSibling;return m(R,se),Y.style.setProperty("margin","0"),Y.style.setProperty("font-size","1.25rem"),a(Y,()=>e("banking.reconciliationComparison")),q.style.setProperty("display","flex"),q.style.setProperty("gap","0.5rem"),O.$$click=()=>y("all"),a(O,()=>e("common.all")),le.$$click=()=>y("unreconciled"),a(le,()=>e("banking.unreconciled")),N.$$click=()=>y("reconciled"),a(N,()=>e("banking.reconciled")),D.style.setProperty("display","grid"),D.style.setProperty("grid-template-columns","repeat(4, 1fr)"),D.style.setProperty("gap","1rem"),D.style.setProperty("margin-bottom","2rem"),a(D,M(Ft,{get title(){return e("banking.bankStatements")},get subtitle(){return e("banking.totalTransactions")},get children(){return[(()=>{var ee=zd();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),a(ee,()=>K.totalStatements),ee})(),(()=>{var ee=k0(),ne=ee.firstChild;return ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),a(ee,()=>K.reconciledStatements,ne),a(ee,()=>e("banking.reconciled"),null),ee})()]}}),null),a(D,M(Ft,{get title(){return e("banking.entryBookRecords")},get subtitle(){return e("banking.totalEntries")},get children(){return[(()=>{var ee=zd();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","var(--primary-color)"),a(ee,()=>K.totalRecords),ee})(),(()=>{var ee=k0(),ne=ee.firstChild;return ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),a(ee,()=>K.reconciledRecords,ne),a(ee,()=>e("banking.reconciled"),null),ee})()]}}),null),a(D,M(Ft,{get title(){return e("banking.unreconciledBank")},get subtitle(){return e("banking.needAttention")},get children(){var ee=zd();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","#f44336"),a(ee,()=>K.unreconciledStatements),ee}}),null),a(D,M(Ft,{get title(){return e("banking.unreconciledBooks")},get subtitle(){return e("banking.needAttention")},get children(){var ee=zd();return ee.style.setProperty("font-size","1.5rem"),ee.style.setProperty("font-weight","600"),ee.style.setProperty("color","#f44336"),a(ee,()=>K.unreconciledRecords),ee}}),null),m(V,$),F.style.setProperty("margin","0 0 1rem 0"),a(F,()=>e("banking.bankStatements")),a(Q,()=>g().map(ee=>(()=>{var ne=IN(),G=ne.firstChild,ce=G.firstChild,oe=ce.nextSibling,z=oe.firstChild,de=G.nextSibling,fe=de.firstChild;return ne.$$click=()=>x(ee),a(ce,()=>ee.description),a(oe,()=>w(ee.date),z),a(oe,()=>ee.reference,null),a(oe,(()=>{var ue=Ee(()=>!!ee.isReconciled);return()=>ue()&&(()=>{var ge=df();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),a(ge,()=>e("banking.reconciled"),null),ge})()})(),null),a(fe,()=>ee.debitAmount>0?"+":"-",null),a(fe,()=>b(ee.debitAmount||ee.creditAmount),null),a(de,(()=>{var ue=Ee(()=>!!ee.isReconciled);return()=>ue()&&M(dt,{variant:"outline",size:"sm",onClick:ge=>{ge.stopPropagation(),P(ee)},style:{"margin-top":"0.5rem"},get children(){return e("banking.unreconcile")}})})(),null),Se(ue=>{var ge=Z(s()?.id===ee.id,ee.isReconciled),xe=re,pe=E,_e=C,Le=T(ee.debitAmount>0);return ue.e=m(ne,ge,ue.e),ue.t=m(G,xe,ue.t),ue.a=m(ce,pe,ue.a),ue.o=m(oe,_e,ue.o),ue.i=m(fe,Le,ue.i),ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),ne})())),J.style.setProperty("margin","0 0 1rem 0"),a(J,()=>e("banking.entryBookRecords"),null),a(J,(()=>{var ee=Ee(()=>!!(s()&&!s().isReconciled));return()=>ee()&&(()=>{var ne=$N(),G=ne.firstChild,ce=G.nextSibling;return ce.nextSibling,ne.style.setProperty("font-weight","400"),ne.style.setProperty("color","var(--text-muted)"),ne.style.setProperty("margin-left","0.5rem"),a(ne,()=>e("banking.clickToReconcile"),ce),ne})()})(),null),a(te,(()=>{var ee=Ee(()=>!!(s()&&!s().isReconciled));return()=>ee()?[Ee(()=>Ee(()=>c().length>0)()&&(()=>{var ne=EN(),G=ne.firstChild,ce=G.firstChild;return G.nextSibling,ne.style.setProperty("margin-bottom","1rem"),ne.style.setProperty("padding","0.75rem"),ne.style.setProperty("background","#fff3cd"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),a(G,()=>e("banking.potentialMatchesFound"),ce),a(ne,()=>e("banking.clickRecordToReconcile"),null),ne})()),Ee(()=>f().map(ne=>(c().includes(ne),(()=>{var G=N0(),ce=G.firstChild,oe=ce.firstChild,z=oe.nextSibling,de=z.firstChild,fe=ce.nextSibling;return G.$$click=()=>{ne.isReconciled||S(ne)},a(oe,()=>ne.description,null),a(oe,()=>_(ne),null),a(z,()=>w(ne.date),de),a(z,()=>ne.reference,null),a(z,(()=>{var ue=Ee(()=>!!ne.isReconciled);return()=>ue()&&(()=>{var ge=df();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),a(ge,()=>e("banking.reconciled"),null),ge})()})(),null),a(fe,()=>ne.debitAmount>0?"+":"-",null),a(fe,()=>b(ne.debitAmount||ne.creditAmount),null),Se(ue=>{var ge={...Z(!1,ne.isReconciled),opacity:ne.isReconciled?.6:1,cursor:ne.isReconciled?"not-allowed":"pointer"},xe=re,pe=E,_e=C,Le=T(ne.debitAmount>0);return ue.e=m(G,ge,ue.e),ue.t=m(ce,xe,ue.t),ue.a=m(oe,pe,ue.a),ue.o=m(z,_e,ue.o),ue.i=m(fe,Le,ue.i),ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),G})())))]:f().map(ne=>(()=>{var G=N0(),ce=G.firstChild,oe=ce.firstChild,z=oe.nextSibling,de=z.firstChild,fe=ce.nextSibling;return a(oe,()=>ne.description),a(z,()=>w(ne.date),de),a(z,()=>ne.reference,null),a(z,(()=>{var ue=Ee(()=>!!ne.isReconciled);return()=>ue()&&(()=>{var ge=df();return ge.firstChild,ge.style.setProperty("color","#4caf50"),ge.style.setProperty("margin-left","0.5rem"),a(ge,()=>e("banking.reconciled"),null),ge})()})(),null),a(fe,()=>ne.debitAmount>0?"+":"-",null),a(fe,()=>b(ne.debitAmount||ne.creditAmount),null),Se(ue=>{var ge=Z(!1,ne.isReconciled),xe=re,pe=E,_e=C,Le=T(ne.debitAmount>0);return ue.e=m(G,ge,ue.e),ue.t=m(ce,xe,ue.t),ue.a=m(oe,pe,ue.a),ue.o=m(z,_e,ue.o),ue.i=m(fe,Le,ue.i),ue},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),G})())})()),a(k,(()=>{var ee=Ee(()=>!!(s()&&!s().isReconciled));return()=>ee()&&(()=>{var ne=TN(),G=ne.firstChild,ce=G.firstChild,oe=G.nextSibling,z=oe.nextSibling;return ne.style.setProperty("position","fixed"),ne.style.setProperty("bottom","2rem"),ne.style.setProperty("right","2rem"),ne.style.setProperty("background","var(--surface-color)"),ne.style.setProperty("padding","1rem"),ne.style.setProperty("border-radius","var(--border-radius)"),ne.style.setProperty("box-shadow","var(--shadow-lg)"),ne.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("max-width","300px"),G.style.setProperty("font-weight","500"),G.style.setProperty("margin-bottom","0.5rem"),a(G,()=>e("banking.selected"),ce),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("margin-bottom","0.5rem"),a(oe,()=>s().description),z.style.setProperty("font-weight","600"),z.style.setProperty("color","var(--primary-color)"),a(z,()=>b(s().debitAmount||s().creditAmount)),a(ne,M(dt,{variant:"secondary",size:"sm",onClick:()=>{l(null),u([])},style:{"margin-top":"0.5rem"},get children(){return e("banking.clearSelection")}}),null),ne})()})(),null),Se(ee=>{var ne=X(h()==="all"),G=X(h()==="unreconciled"),ce=X(h()==="reconciled"),oe=U,z=U;return ee.e=m(O,ne,ee.e),ee.t=m(le,G,ee.t),ee.a=m(N,ce,ee.a),ee.o=m(Q,oe,ee.o),ee.i=m(te,z,ee.i),ee},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),k})()};yr(["click"]);var NN=he("<div><div><h2></h2><p></p></div><div>"),LN=he("<div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date>"),RN=he("<div><button></button><button>"),DN=he("<div><br>"),tu=he("<div>"),MN=he("<div><div></div><div> • </div><div>"),FN=he("<div>: "),ON=he("<div> <!> • <!> "),BN=he("<div>%"),jN=he("<div> of <!> transactions");const VN=()=>{const{t}=sr(),[e,r]=Ce(null),[n,i]=Ce({start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[o,s]=Ce(!1),[l,c]=Ce("overview");yi(()=>{!e()&&Vn.bankAccounts.length>0&&r(Vn.bankAccounts[0])});const u={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},h={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)"},y={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"2rem"},g=se=>({padding:"1rem 2rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:se?"var(--primary-color)":"var(--text-muted)","border-bottom":se?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),f={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},x=se=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(se),S=se=>new Date(se).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),P=()=>Vn.bankAccounts.map(se=>({value:se.id,label:`${se.bankName} - ${se.accountNumber} (${se.accountType})`})),U=(()=>{if(!e())return null;const se=Vn.getBankStatementsByAccount(e().accountId).filter(re=>re.date>=n().start&&re.date<=n().end),X=Vn.getEntryBookRecordsByAccount(e().accountId).filter(re=>re.date>=n().start&&re.date<=n().end),Z=se.filter(re=>re.isReconciled).length;return X.filter(re=>re.isReconciled).length,{totalBankTransactions:se.length,totalEntryBookRecords:X.length,reconciledTransactions:Z,unreconciledTransactions:se.length-Z,reconciliationRate:se.length>0?Z/se.length*100:0}})();return M(Qi,{get title(){return t("banking.title")},get children(){return[(()=>{var se=NN(),X=se.firstChild,Z=X.firstChild,re=Z.nextSibling,E=X.nextSibling;return m(se,u),Z.style.setProperty("margin","0 0 0.5rem 0"),Z.style.setProperty("font-size","1.5rem"),a(Z,()=>t("banking.reconciliation")),re.style.setProperty("margin","0"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>t("banking.compareStatements")),E.style.setProperty("display","flex"),E.style.setProperty("gap","1rem"),a(E,M(dt,{variant:"secondary",onClick:()=>s(!0),get disabled(){return!e()},get children(){return t("banking.importCSV")}}),null),a(E,M(dt,{variant:"primary",get children(){return t("banking.startNewReconciliation")}}),null),se})(),(()=>{var se=LN(),X=se.firstChild,Z=X.firstChild,re=X.nextSibling,E=re.firstChild,C=E.nextSibling,T=re.nextSibling,j=T.firstChild,b=j.nextSibling;return m(se,h),X.style.setProperty("flex","1"),Z.style.setProperty("display","block"),Z.style.setProperty("margin-bottom","0.5rem"),Z.style.setProperty("font-weight","500"),a(Z,()=>t("banking.bankAccount")),a(X,M(_n,{label:"",get value(){return e()?.id||""},onChange:w=>{const _=Vn.getBankAccountById(w);r(_||null)},get options(){return P()}}),null),E.style.setProperty("display","block"),E.style.setProperty("margin-bottom","0.5rem"),E.style.setProperty("font-weight","500"),a(E,()=>t("entryBooks.startDate")),C.addEventListener("change",w=>i(_=>({..._,start:w.target.value}))),C.style.setProperty("padding","0.75rem"),C.style.setProperty("border","1px solid var(--border-color)"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("font-family","inherit"),j.style.setProperty("display","block"),j.style.setProperty("margin-bottom","0.5rem"),j.style.setProperty("font-weight","500"),a(j,()=>t("entryBooks.endDate")),b.addEventListener("change",w=>i(_=>({..._,end:w.target.value}))),b.style.setProperty("padding","0.75rem"),b.style.setProperty("border","1px solid var(--border-color)"),b.style.setProperty("border-radius","var(--border-radius-sm)"),b.style.setProperty("font-family","inherit"),Se(()=>C.value=n().start),Se(()=>b.value=n().end),se})(),(()=>{var se=RN(),X=se.firstChild,Z=X.nextSibling;return m(se,y),X.$$click=()=>c("overview"),a(X,()=>t("common.overview")),Z.$$click=()=>c("reconciliation"),a(Z,()=>t("banking.reconciliation")),Se(re=>{var E=g(l()==="overview"),C=g(l()==="reconciliation");return re.e=m(X,E,re.e),re.t=m(Z,C,re.t),re},{e:void 0,t:void 0}),se})(),Ee(()=>Ee(()=>l()==="overview")()&&(()=>{var se=tu();return a(se,(()=>{var X=Ee(()=>!!e());return()=>X()&&(()=>{var Z=tu();return m(Z,f),a(Z,M(Ft,{get title(){return t("banking.bankAccountInfo")},get subtitle(){return t("banking.currentAccountDetails")},get children(){return[(()=>{var re=MN(),E=re.firstChild,C=E.nextSibling,T=C.firstChild,j=C.nextSibling;return re.style.setProperty("margin-bottom","1rem"),E.style.setProperty("font-weight","600"),E.style.setProperty("margin-bottom","0.5rem"),a(E,()=>e().bankName),C.style.setProperty("color","var(--text-muted)"),C.style.setProperty("margin-bottom","0.5rem"),a(C,()=>e().accountNumber,T),a(C,()=>e().accountType,null),j.style.setProperty("font-size","1.25rem"),j.style.setProperty("font-weight","600"),j.style.setProperty("color","var(--primary-color)"),a(j,()=>x(e().currentBalance)),re})(),Ee(()=>Ee(()=>!!e().lastReconciledDate)()&&(()=>{var re=FN(),E=re.firstChild;return re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>t("banking.lastReconciled"),E),a(re,()=>S(e().lastReconciledDate),null),re})())]}}),null),a(Z,U&&[M(Ft,{get title(){return t("banking.bankTransactions")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var re=tu();return re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("color","var(--primary-color)"),re.style.setProperty("margin-bottom","0.5rem"),a(re,()=>U.totalBankTransactions),re})(),(()=>{var re=ON(),E=re.firstChild,C=E.nextSibling,T=C.nextSibling,j=T.nextSibling;return j.nextSibling,re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>U.reconciledTransactions,E),a(re,()=>t("banking.reconciled"),C),a(re,()=>U.unreconciledTransactions,j),a(re,()=>t("banking.pending"),null),re})()]}}),M(Ft,{get title(){return t("entryBooks.entryBookRecords")},get subtitle(){return t("banking.selectedPeriod")},get children(){return[(()=>{var re=tu();return re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("color","var(--primary-color)"),re.style.setProperty("margin-bottom","0.5rem"),a(re,()=>U.totalEntryBookRecords),re})(),(()=>{var re=tu();return re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>t("banking.bookEntriesForComparison")),re})()]}}),M(Ft,{get title(){return t("banking.reconciliationRate")},get subtitle(){return t("banking.completionStatus")},get children(){return[(()=>{var re=BN(),E=re.firstChild;return re.style.setProperty("font-size","1.5rem"),re.style.setProperty("font-weight","600"),re.style.setProperty("margin-bottom","0.5rem"),a(re,()=>Math.round(U.reconciliationRate),E),Se(C=>(C=U.reconciliationRate>80?"#4caf50":U.reconciliationRate>50?"#ff9800":"#f44336")!=null?re.style.setProperty("color",C):re.style.removeProperty("color")),re})(),(()=>{var re=jN(),E=re.firstChild,C=E.nextSibling;return C.nextSibling,re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>U.reconciledTransactions,E),a(re,()=>U.totalBankTransactions,C),re})()]}})],null),Z})()})(),null),a(se,M(Ft,{get title(){return t("banking.recentReconciliationSessions")},get subtitle(){return t("banking.latestActivity")},get children(){var X=DN(),Z=X.firstChild;return X.style.setProperty("text-align","center"),X.style.setProperty("color","var(--text-muted)"),X.style.setProperty("padding","2rem"),a(X,()=>t("banking.noRecentSessions"),Z),a(X,M(dt,{variant:"primary",style:{"margin-top":"1rem"},onClick:()=>c("reconciliation"),get children(){return t("banking.startFirstReconciliation")}}),null),X}}),null),se})()),Ee(()=>Ee(()=>!!(l()==="reconciliation"&&e()))()&&M(kN,{get bankAccountId(){return e().id},get selectedPeriod(){return n()}})),M(AN,{get isOpen(){return o()},onClose:()=>s(!1),get bankAccount(){return e()}})]}})};yr(["click"]);yr(["input","click"]);var qN=he("<h2>Upload Bank Statement CSV"),zN=he("<input type=file accept=.csv>"),UN=he("<h3>Filters"),HN=he('<div><input type=text placeholder="Search transactions..."><input type=date placeholder="Start Date"><input type=date placeholder="End Date"><button>Download Detailed Report'),GN=he("<div><button>Summary</button><button>Deposits</button><button>Payments</button><button>Timeline"),WN=he("<h3>Total Deposits"),Ud=he("<p>"),L0=he("<p> transactions"),YN=he("<h3>Total Payments"),KN=he("<h3>Net Cash Flow"),JN=he("<h3>Check Payments"),QN=he("<p> checks"),ru=he("<div>"),XN=he("<h3>Accounts & Payment Methods Used"),ZN=he("<h3>Monthly Cash Flow Trend"),e6=he("<div><table><thead><tr><th>Month</th><th>Deposits</th><th>Payments</th><th>Net</th></tr></thead><tbody>"),t6=he("<h2>Deposits by Type"),r6=he("<h2>Top Depositors"),n6=he("<div><table><thead><tr><th>Depositor</th><th>Total Amount</th><th>Count</th><th>Actions</th></tr></thead><tbody>"),i6=he("<h2>Payments by Category"),o6=he("<h2>Top Payees"),s6=he("<div><table><thead><tr><th>Payee</th><th>Category</th><th>Total Amount</th><th>Count</th></tr></thead><tbody>"),a6=he("<h2>Transaction Timeline"),l6=he("<div><h1>Detailed Bank Statement Analyzer"),c6=he("<span>"),u6=he("<tr><td></td><td></td><td></td><td>"),R0=he("<div><h4></h4><p></p><p> transactions"),d6=he("<tr><td></td><td></td><td></td><td><details><summary>View</summary><div>"),h6=he("<div> - "),p6=he("<tr><td></td><td><span></span></td><td></td><td>"),f6=he("<div><div><div></div><div> • </div></div><div><div>");const m6=()=>{const[t,e]=Ce(""),[r,n]=Ce("summary"),[i,o]=Ce(""),[s,l]=Ce({start:"",end:""}),[c,u]=Gu({list:[]}),h={Utilities:["AT&T","METRO BY T-MOBILE","COMCAST","STREAM ENERGY","NETFLIX","SPECTRUM"],checks:["CHECK"],JPM:["JPM","POVBR"],Transportation:["DRIVE AWAY","TRANPORT","QUICKQUACK","EXXON","SHELL","CHEVRON","UBER","LYFT","U-HAUL","UHAL","LOVE'S"],Lodging:["HOLIDAY INN","MARRIOTT","HILTON","AIRBNB","HOTEL","MOTEL"],"Food & Dining":["GOLDEN CORRAL","MOCTEZUMA","CHINA STAR","RESTAURANT","CAFE","STARBUCKS","BUFFET","GRILL","MARKET","SEAFOOD"],Shopping:["BURLINGTON","WALMART","TARGET","AMAZON","ROSS","KROGER","PUBLIC","AMZN","AMZ"],Financial:["AMERICANFIRSTFIN","LOAN","CREDIT"],Insurance:["INSURANCE","GEICO","STATE FARM"],Rent:["SHAFAII INVESTME"],Medical:["PHARMACY","CVS","WALGREENS","HOSPITAL","CLINIC"],Entertainment:["CINEMA","THEATER","CONCERT"],"Other Services":["BARBER","SALON","SPA","GYM"],Return:["RETURN ITEM "]},y=X=>{const Z=X.toUpperCase();for(const[re,E]of Object.entries(h))for(const C of E)if(Z.includes(C.toUpperCase()))return re;return"Other"},g=X=>{const Z=X.match(/Zelle payment from ([^0-9]+)/i);if(Z)return Z[1].trim().replace(/[A-Z0-9]{10,}$/,"").trim();if(X.includes("CHECK"))return"Check Payment";const re=X.match(/^([^0-9]+)/);return re?re[1].trim():X.substring(0,30)},f=X=>{const Z=X.trim().split(`
`),re=[];console.log(Z);for(let E=1;E<Z.length;E++){const C=Z[E].split(",");if(console.log(C),C.length>=3){const T=parseFloat(C[2]);let j={postingDate:C[0],description:C[1],amount:T};re.push(j)}}return console.log({transactions:re}),u("list",re),re};Dt(()=>t()?f(t()):[]);const x=Dt(()=>{let X=c?.list;if((s().start||s().end)&&(X=X.filter(Z=>{const re=new Date(Z.postingDate),E=s().start?new Date(s().start):new Date("2024-01-01"),C=s().end?new Date(s().end):new Date("2024-12-31");return re>=E&&re<=C})),i()){const Z=i().toLowerCase();X=X.filter(re=>re.description.toLowerCase().includes(Z)||Math.abs(re.amount).toString().includes(Z))}return X}),S=Dt(()=>{const X={deposits:{total:0,count:0,byType:new Map,byPayee:new Map},payments:{total:0,count:0,byType:new Map,byPayee:new Map},checks:{total:0,count:0,transactions:[]},transfers:{total:0,count:0,transactions:[]},dailyBalances:new Map,accountsAffected:new Set};return x().forEach(Z=>{const re=g(Z.description);if(console.log({transaction:Z}),X.dailyBalances.set(Z.postingDate,Z.amount),(Z.description.includes("ZELLE")||Z.description.includes("QUICKPAY"))&&X.accountsAffected.add("Zelle Account"),Z.description.includes("ACH")&&X.accountsAffected.add("ACH Network"),Z?.description.includes("DEBIT_CARD")&&X.accountsAffected.add("Debit Card"),Z?.description.includes("CHECK")&&X.accountsAffected.add("Checking Account"),Z?.description.includes("TRANSFER")&&X.accountsAffected.add("Savings Account"),Z.amount>0){X.deposits.total+=Z.amount,X.deposits.count++,X.deposits.byType.has(Z.description)||X.deposits.byType.set(Z.description,{total:0,count:0,transactions:[]});const E=X.deposits.byType.get(Z.description);E.total+=Z.amount,E.count++,E.transactions.push(Z),X.deposits.byPayee.has(re)||X.deposits.byPayee.set(re,{name:re,totalAmount:0,transactionCount:0,transactions:[]});const C=X.deposits.byPayee.get(re);C.totalAmount+=Z.amount,C.transactionCount++,C.transactions.push(Z)}if(Z.amount<0){X.payments.total+=Math.abs(Z.amount),X.payments.count++,X.payments.byType.has(Z.description)||X.payments.byType.set(Z.description,{total:0,count:0,transactions:[]});const E=X.payments.byType.get(Z.description);E.total+=Math.abs(Z.amount),E.count++,E.transactions.push(Z);const C=y(Z.description);X.payments.byPayee.has(re)||X.payments.byPayee.set(re,{name:re,totalAmount:0,transactionCount:0,transactions:[],category:C});const T=X.payments.byPayee.get(re);T.totalAmount+=Math.abs(Z.amount),T.transactionCount++,T.transactions.push(Z)}(Z.type==="CHECK_PAID"||Z.checkNumber)&&(X.checks.total+=Math.abs(Z.amount),X.checks.count++,X.checks.transactions.push(Z)),(Z.description.includes("TRANSFER")||Z.description==="ACCT_XFER")&&(X.transfers.total+=Math.abs(Z.amount),X.transfers.count++,X.transfers.transactions.push(Z))}),console.log(X),X}),P=Dt(()=>{const X=new Map;return x().forEach(Z=>{const re=Z.postingDate.substring(0,7);X.has(re)||X.set(re,{deposits:0,payments:0,net:0});const E=X.get(re);Z.amount>0?E.deposits+=Z.amount:E.payments+=Math.abs(Z.amount),E.net=E.deposits-E.payments}),Array.from(X.entries()).sort((Z,re)=>Z[0].localeCompare(re[0]))}),$=X=>{const re=X.target.files?.[0];if(re){const E=new FileReader;E.onload=C=>{console.log(C.target?.result),f(C.target?.result)},E.readAsText(re)}},U=()=>{const X=S();let Z=`# DETAILED BANK STATEMENT ANALYSIS
`;Z+=`Generated: ${new Date().toLocaleDateString()}

`,Z+=`## EXECUTIVE SUMMARY

`,Z+=`- **Total Deposits:** $${X.deposits.total.toFixed(2)} (${X.deposits.count} transactions)
`,Z+=`- **Total Payments:** $${X.payments.total.toFixed(2)} (${X.payments.count} transactions)
`,Z+=`- **Net Cash Flow:** $${(X.deposits.total-X.payments.total).toFixed(2)}
`,Z+=`- **Check Payments:** $${X.checks.total.toFixed(2)} (${X.checks.count} checks)
`,Z+=`- **Transfers:** $${X.transfers.total.toFixed(2)} (${X.transfers.count} transfers)

`,Z+=`## ACCOUNTS AFFECTED

`,X.accountsAffected.forEach(w=>{Z+=`- ${w}
`}),Z+=`
`,Z+=`## DEPOSITS DETAIL

`,Z+=`### By Type
`,X.deposits.byType.forEach((w,_)=>{Z+=`- **${_}**: $${w.total.toFixed(2)} (${w.count} transactions)
`}),Z+=`
### Top Depositors
`,Array.from(X.deposits.byPayee.entries()).sort((w,_)=>_[1].totalAmount-w[1].totalAmount).slice(0,20).forEach(([w,_])=>{Z+=`- **${w}**: $${_.totalAmount.toFixed(2)} (${_.transactionCount} transactions)
`}),Z+=`
## PAYMENTS DETAIL

`,Z+=`### By Type
`,X.payments.byType.forEach((w,_)=>{Z+=`- **${_}**: $${w.total.toFixed(2)} (${w.count} transactions)
`}),Z+=`
### By Category
`;const E=new Map;X.payments.byPayee.forEach(w=>{const _=w.category||"Other";E.set(_,(E.get(_)||0)+w.totalAmount)}),Array.from(E.entries()).sort((w,_)=>_[1]-w[1]).forEach(([w,_])=>{Z+=`- **${w}**: $${_.toFixed(2)}
`}),Z+=`
### Top Payees
`,Array.from(X.payments.byPayee.entries()).sort((w,_)=>_[1].totalAmount-w[1].totalAmount).slice(0,20).forEach(([w,_])=>{Z+=`- **${w}** (${_.category}): $${_.totalAmount.toFixed(2)} (${_.transactionCount} transactions)
`}),Z+=`
## MONTHLY CASH FLOW TREND

`,P().forEach(([w,_])=>{Z+=`- **${w}**: Deposits: $${_.deposits.toFixed(2)} | Payments: $${_.payments.toFixed(2)} | Net: $${_.net.toFixed(2)}
`}),X.checks.transactions.length>0&&(Z+=`
## CHECK PAYMENTS DETAIL

`,X.checks.transactions.forEach(w=>{Z+=`- Check #${w.checkNumber||"N/A"} - ${w.postingDate} - $${Math.abs(w.amount).toFixed(2)}
`}));const T=new Blob([Z],{type:"text/markdown"}),j=URL.createObjectURL(T),b=document.createElement("a");b.href=j,b.download=`detailed_bank_analysis_${new Date().toISOString().split("T")[0]}.md`,b.click(),URL.revokeObjectURL(j)},se=X=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(X);return(()=>{var X=l6(),Z=X.firstChild;return X.style.setProperty("padding","2rem"),Z.style.setProperty("margin-bottom","2rem"),a(X,M(Ft,{style:{"margin-bottom":"2rem"},get children(){return[qN(),(()=>{var re=zN();return re.addEventListener("change",$),re.style.setProperty("margin-top","1rem"),re})()]}}),null),a(X,M(Ge,{get when(){return c?.list},get children(){return[M(Ft,{style:{"margin-bottom":"2rem"},get children(){return[UN(),(()=>{var re=HN(),E=re.firstChild,C=E.nextSibling,T=C.nextSibling,j=T.nextSibling;return re.style.setProperty("display","flex"),re.style.setProperty("gap","1rem"),re.style.setProperty("margin-top","1rem"),re.style.setProperty("flex-wrap","wrap"),E.$$input=b=>o(b.currentTarget.value),E.style.setProperty("flex","1"),E.style.setProperty("min-width","200px"),E.style.setProperty("padding","0.5rem"),C.$$input=b=>l({...s(),start:b.currentTarget.value}),T.$$input=b=>l({...s(),end:b.currentTarget.value}),j.$$click=U,j.style.setProperty("padding","0.5rem 1rem"),j.style.setProperty("background","var(--primary-color)"),j.style.setProperty("color","white"),j.style.setProperty("border","none"),j.style.setProperty("border-radius","var(--border-radius-sm)"),j.style.setProperty("cursor","pointer"),Se(()=>E.value=i()),Se(()=>C.value=s().start),Se(()=>T.value=s().end),re})()]}}),(()=>{var re=GN(),E=re.firstChild,C=E.nextSibling,T=C.nextSibling,j=T.nextSibling;return re.style.setProperty("display","flex"),re.style.setProperty("gap","1rem"),re.style.setProperty("margin-bottom","2rem"),E.$$click=()=>n("summary"),E.style.setProperty("padding","0.5rem 1rem"),E.style.setProperty("border","none"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("cursor","pointer"),C.$$click=()=>n("deposits"),C.style.setProperty("padding","0.5rem 1rem"),C.style.setProperty("border","none"),C.style.setProperty("border-radius","var(--border-radius-sm)"),C.style.setProperty("cursor","pointer"),T.$$click=()=>n("payments"),T.style.setProperty("padding","0.5rem 1rem"),T.style.setProperty("border","none"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("cursor","pointer"),j.$$click=()=>n("timeline"),j.style.setProperty("padding","0.5rem 1rem"),j.style.setProperty("border","none"),j.style.setProperty("border-radius","var(--border-radius-sm)"),j.style.setProperty("cursor","pointer"),Se(b=>{var w=r()==="summary"?"var(--primary-color)":"#e9ecef",_=r()==="summary"?"white":"black",W=r()==="deposits"?"var(--primary-color)":"#e9ecef",K=r()==="deposits"?"white":"black",k=r()==="payments"?"var(--primary-color)":"#e9ecef",R=r()==="payments"?"white":"black",Y=r()==="timeline"?"var(--primary-color)":"#e9ecef",q=r()==="timeline"?"white":"black";return w!==b.e&&((b.e=w)!=null?E.style.setProperty("background",w):E.style.removeProperty("background")),_!==b.t&&((b.t=_)!=null?E.style.setProperty("color",_):E.style.removeProperty("color")),W!==b.a&&((b.a=W)!=null?C.style.setProperty("background",W):C.style.removeProperty("background")),K!==b.o&&((b.o=K)!=null?C.style.setProperty("color",K):C.style.removeProperty("color")),k!==b.i&&((b.i=k)!=null?T.style.setProperty("background",k):T.style.removeProperty("background")),R!==b.n&&((b.n=R)!=null?T.style.setProperty("color",R):T.style.removeProperty("color")),Y!==b.s&&((b.s=Y)!=null?j.style.setProperty("background",Y):j.style.removeProperty("background")),q!==b.h&&((b.h=q)!=null?j.style.setProperty("color",q):j.style.removeProperty("color")),b},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),re})(),M(Ge,{get when(){return r()==="summary"},get children(){return[(()=>{var re=ru();return re.style.setProperty("display","grid"),re.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),re.style.setProperty("gap","1rem"),re.style.setProperty("margin-bottom","2rem"),a(re,M(Ft,{get children(){return[WN(),(()=>{var E=Ud();return E.style.setProperty("font-size","2rem"),E.style.setProperty("font-weight","bold"),E.style.setProperty("color","#22c55e"),a(E,()=>se(S().deposits.total)),E})(),(()=>{var E=L0(),C=E.firstChild;return E.style.setProperty("color","#6c757d"),a(E,()=>S().deposits.count,C),E})()]}}),null),a(re,M(Ft,{get children(){return[YN(),(()=>{var E=Ud();return E.style.setProperty("font-size","2rem"),E.style.setProperty("font-weight","bold"),E.style.setProperty("color","#ef4444"),a(E,()=>se(S().payments.total)),E})(),(()=>{var E=L0(),C=E.firstChild;return E.style.setProperty("color","#6c757d"),a(E,()=>S().payments.count,C),E})()]}}),null),a(re,M(Ft,{get children(){return[KN(),(()=>{var E=Ud();return E.style.setProperty("font-size","2rem"),E.style.setProperty("font-weight","bold"),a(E,()=>se(S().deposits.total-S().payments.total)),Se(C=>(C=S().deposits.total-S().payments.total>=0?"#22c55e":"#ef4444")!=null?E.style.setProperty("color",C):E.style.removeProperty("color")),E})()]}}),null),a(re,M(Ft,{get children(){return[JN(),(()=>{var E=Ud();return E.style.setProperty("font-size","2rem"),E.style.setProperty("font-weight","bold"),E.style.setProperty("color","#3b82f6"),a(E,()=>se(S().checks.total)),E})(),(()=>{var E=QN(),C=E.firstChild;return E.style.setProperty("color","#6c757d"),a(E,()=>S().checks.count,C),E})()]}}),null),re})(),M(Ft,{style:{"margin-bottom":"2rem"},get children(){return[XN(),(()=>{var re=ru();return re.style.setProperty("display","flex"),re.style.setProperty("flex-wrap","wrap"),re.style.setProperty("gap","0.5rem"),re.style.setProperty("margin-top","1rem"),a(re,M(Ht,{get each(){return Array.from(S().accountsAffected)},children:E=>(()=>{var C=c6();return C.style.setProperty("padding","0.25rem 0.75rem"),C.style.setProperty("background","#e9ecef"),C.style.setProperty("border-radius","9999px"),C.style.setProperty("font-size","0.875rem"),a(C,E),C})()})),re})()]}}),M(Ft,{get children(){return[ZN(),(()=>{var re=e6(),E=re.firstChild,C=E.firstChild,T=C.firstChild,j=T.firstChild,b=j.nextSibling,w=b.nextSibling,_=w.nextSibling,W=C.nextSibling;return re.style.setProperty("overflow-x","auto"),E.style.setProperty("width","100%"),E.style.setProperty("border-collapse","collapse"),E.style.setProperty("margin-top","1rem"),T.style.setProperty("border-bottom","2px solid #dee2e6"),j.style.setProperty("padding","0.75rem"),j.style.setProperty("text-align","left"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","right"),w.style.setProperty("padding","0.75rem"),w.style.setProperty("text-align","right"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","right"),a(W,M(Ht,{get each(){return P()},children:([K,k])=>(()=>{var R=u6(),Y=R.firstChild,q=Y.nextSibling,O=q.nextSibling,le=O.nextSibling;return R.style.setProperty("border-bottom","1px solid #dee2e6"),Y.style.setProperty("padding","0.75rem"),a(Y,K),q.style.setProperty("padding","0.75rem"),q.style.setProperty("text-align","right"),q.style.setProperty("color","#22c55e"),a(q,()=>se(isNaN(k.deposits)?0:k.deposits)),O.style.setProperty("padding","0.75rem"),O.style.setProperty("text-align","right"),O.style.setProperty("color","#ef4444"),a(O,()=>se(isNaN(k.payments)?0:k.payments)),le.style.setProperty("padding","0.75rem"),le.style.setProperty("text-align","right"),le.style.setProperty("font-weight","bold"),a(le,()=>se(k.net)),Se(N=>(N=k.net>=0?"#22c55e":"#ef4444")!=null?le.style.setProperty("color",N):le.style.removeProperty("color")),R})()})),re})()]}})]}}),M(Ge,{get when(){return r()==="deposits"},get children(){return[M(Ft,{style:{"margin-bottom":"2rem"},get children(){return[t6(),(()=>{var re=ru();return re.style.setProperty("display","grid"),re.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(300px, 1fr))"),re.style.setProperty("gap","1rem"),re.style.setProperty("margin-top","1rem"),a(re,M(Ht,{get each(){return Array.from(S().deposits.byType.entries())},children:([E,C])=>(()=>{var T=R0(),j=T.firstChild,b=j.nextSibling,w=b.nextSibling,_=w.firstChild;return T.style.setProperty("padding","1rem"),T.style.setProperty("background","#f8f9fa"),T.style.setProperty("border-radius","var(--border-radius-sm)"),T.style.setProperty("border","1px solid #e9ecef"),a(j,E),b.style.setProperty("font-size","1.5rem"),b.style.setProperty("font-weight","bold"),b.style.setProperty("color","#22c55e"),a(b,()=>se(C.total)),w.style.setProperty("color","#6c757d"),a(w,()=>C.count,_),T})()})),re})()]}}),M(Ft,{get children(){return[r6(),(()=>{var re=n6(),E=re.firstChild,C=E.firstChild,T=C.firstChild,j=T.firstChild,b=j.nextSibling,w=b.nextSibling,_=w.nextSibling,W=C.nextSibling;return re.style.setProperty("overflow-x","auto"),E.style.setProperty("width","100%"),E.style.setProperty("border-collapse","collapse"),E.style.setProperty("margin-top","1rem"),T.style.setProperty("border-bottom","2px solid #dee2e6"),j.style.setProperty("padding","0.75rem"),j.style.setProperty("text-align","left"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","right"),w.style.setProperty("padding","0.75rem"),w.style.setProperty("text-align","center"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","center"),a(W,M(Ht,{get each(){return Array.from(S().deposits.byPayee.entries()).sort((K,k)=>k[1].totalAmount-K[1].totalAmount).slice(0,20)},children:([K,k])=>(()=>{var R=d6(),Y=R.firstChild,q=Y.nextSibling,O=q.nextSibling,le=O.nextSibling,N=le.firstChild,D=N.firstChild,V=D.nextSibling;return R.style.setProperty("border-bottom","1px solid #dee2e6"),Y.style.setProperty("padding","0.75rem"),a(Y,K),q.style.setProperty("padding","0.75rem"),q.style.setProperty("text-align","right"),q.style.setProperty("color","#22c55e"),q.style.setProperty("font-weight","bold"),a(q,()=>se(k.totalAmount)),O.style.setProperty("padding","0.75rem"),O.style.setProperty("text-align","center"),a(O,()=>k.transactionCount),le.style.setProperty("padding","0.75rem"),le.style.setProperty("text-align","center"),D.style.setProperty("cursor","pointer"),V.style.setProperty("margin-top","0.5rem"),V.style.setProperty("font-size","0.875rem"),a(V,M(Ht,{get each(){return k.transactions.slice(0,5)},children:I=>(()=>{var F=h6(),Q=F.firstChild;return F.style.setProperty("padding","0.25rem"),a(F,()=>I.postingDate,Q),a(F,()=>se(I.amount),null),F})()})),R})()})),re})()]}})]}}),M(Ge,{get when(){return r()==="payments"},get children(){return[M(Ft,{style:{"margin-bottom":"2rem"},get children(){return[i6(),(()=>{var re=ru();return re.style.setProperty("display","grid"),re.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),re.style.setProperty("gap","1rem"),re.style.setProperty("margin-top","1rem"),a(re,()=>{const E=new Map;return S().payments.byPayee.forEach(C=>{const T=C.category||"Other";E.has(T)||E.set(T,{total:0,count:0});const j=E.get(T);j.total+=C.totalAmount,j.count+=C.transactionCount}),Array.from(E.entries()).sort((C,T)=>T[1].total-C[1].total).map(([C,T])=>(()=>{var j=R0(),b=j.firstChild,w=b.nextSibling,_=w.nextSibling,W=_.firstChild;return j.style.setProperty("padding","1rem"),j.style.setProperty("background","#f8f9fa"),j.style.setProperty("border-radius","var(--border-radius-sm)"),j.style.setProperty("border","1px solid #e9ecef"),a(b,C),w.style.setProperty("font-size","1.5rem"),w.style.setProperty("font-weight","bold"),w.style.setProperty("color","#ef4444"),a(w,()=>se(T.total)),_.style.setProperty("color","#6c757d"),a(_,()=>T.count,W),j})())}),re})()]}}),M(Ft,{get children(){return[o6(),(()=>{var re=s6(),E=re.firstChild,C=E.firstChild,T=C.firstChild,j=T.firstChild,b=j.nextSibling,w=b.nextSibling,_=w.nextSibling,W=C.nextSibling;return re.style.setProperty("overflow-x","auto"),E.style.setProperty("width","100%"),E.style.setProperty("border-collapse","collapse"),E.style.setProperty("margin-top","1rem"),T.style.setProperty("border-bottom","2px solid #dee2e6"),j.style.setProperty("padding","0.75rem"),j.style.setProperty("text-align","left"),b.style.setProperty("padding","0.75rem"),b.style.setProperty("text-align","left"),w.style.setProperty("padding","0.75rem"),w.style.setProperty("text-align","right"),_.style.setProperty("padding","0.75rem"),_.style.setProperty("text-align","center"),a(W,M(Ht,{get each(){return Array.from(S().payments.byPayee.entries()).sort((K,k)=>k[1].totalAmount-K[1].totalAmount).slice(0,130)},children:([K,k])=>(()=>{var R=p6(),Y=R.firstChild,q=Y.nextSibling,O=q.firstChild,le=q.nextSibling,N=le.nextSibling;return R.style.setProperty("border-bottom","1px solid #dee2e6"),Y.style.setProperty("padding","0.75rem"),a(Y,K),q.style.setProperty("padding","0.75rem"),O.style.setProperty("padding","0.25rem 0.5rem"),O.style.setProperty("background","#e9ecef"),O.style.setProperty("border-radius","4px"),O.style.setProperty("font-size","0.875rem"),a(O,()=>k.category),le.style.setProperty("padding","0.75rem"),le.style.setProperty("text-align","right"),le.style.setProperty("color","#ef4444"),le.style.setProperty("font-weight","bold"),a(le,()=>se(k.totalAmount)),N.style.setProperty("padding","0.75rem"),N.style.setProperty("text-align","center"),a(N,()=>k.transactionCount),R})()})),re})()]}})]}}),M(Ge,{get when(){return r()==="timeline"},get children(){return M(Ft,{get children(){return[a6(),(()=>{var re=ru();return re.style.setProperty("max-height","600px"),re.style.setProperty("overflow-y","auto"),re.style.setProperty("margin-top","1rem"),a(re,M(Ht,{get each(){return x().slice(0,100)},children:E=>(()=>{var C=f6(),T=C.firstChild,j=T.firstChild,b=j.nextSibling,w=b.firstChild,_=T.nextSibling,W=_.firstChild;return C.style.setProperty("padding","1rem"),C.style.setProperty("border-bottom","1px solid #e9ecef"),C.style.setProperty("display","flex"),C.style.setProperty("justify-content","space-between"),C.style.setProperty("align-items","center"),T.style.setProperty("flex","1"),j.style.setProperty("font-weight","bold"),a(j,()=>E.description),b.style.setProperty("font-size","0.875rem"),b.style.setProperty("color","#6c757d"),a(b,()=>E.postingDate,w),a(b,()=>E.type,null),a(b,()=>E.checkNumber&&` • Check #${E.checkNumber}`,null),_.style.setProperty("text-align","right"),W.style.setProperty("font-weight","bold"),W.style.setProperty("font-size","1.1rem"),a(W,()=>se(Math.abs(E.amount)),null),a(W,()=>E.amount>=0?" ↓":" ↑",null),Se(K=>(K=E.amount>=0?"#22c55e":"#ef4444")!=null?W.style.setProperty("color",K):W.style.removeProperty("color")),C})()})),re})()]}})}})]}}),null),X})()};yr(["input","click"]);var y6=he("<div><div></div><div>"),hf=he("<div>"),g6=he("<div> • <!> • <!> "),v6=he("<div><div><div></div><div></div></div><div><div></div><div>"),b6=he("<div><div>:"),_6=he("<div>⚠️ <!>: <!> <!>, <!> "),S6=he("<div><div><div></div><div></div></div><div>"),D0=he("<div> "),P6=he("<div>✓ ");const w6=t=>{const{t:e}=sr(),r={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},n={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase"},i={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px"},o={"font-size":"1.1rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"0.5rem"},s={"font-size":"0.875rem",color:"var(--text-muted)","margin-bottom":"1rem"},l={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"1rem"},c={"font-size":"1.25rem","font-weight":"600",color:"var(--primary-color)"},u={"max-height":"100px","overflow-y":"auto","border-top":"1px solid var(--border-color)","padding-top":"1rem"},h={display:"flex","justify-content":"space-between","align-items":"center","font-size":"0.875rem","margin-bottom":"0.5rem"},y={display:"flex","justify-content":"flex-end","margin-top":"1rem","padding-top":"1rem","border-top":"1px solid var(--border-color)"},g=$=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[$],f=$=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format($),x=$=>new Date($).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),S=g(t.entry.status),P=Math.abs(t.entry.totalDebit-t.entry.totalCredit)<.01;return M(Ft,{get children(){return[(()=>{var $=y6(),U=$.firstChild,se=U.nextSibling;return m($,r),m(U,n),a(U,()=>t.entry.entryNumber),a(se,()=>e(`journal.${t.entry.status}`,t.entry.status)),Se(X=>m(se,{...i,background:S.bg,color:S.color},X)),$})(),(()=>{var $=hf();return m($,o),a($,()=>t.entry.description),$})(),(()=>{var $=g6(),U=$.firstChild,se=U.nextSibling,X=se.nextSibling,Z=X.nextSibling;return Z.nextSibling,m($,s),a($,()=>x(t.entry.date),U),a($,()=>t.entry.reference||e("journal.noReference","No reference"),se),a($,()=>e("journal.createdBy","By"),Z),a($,()=>t.entry.createdBy,null),$})(),(()=>{var $=v6(),U=$.firstChild,se=U.firstChild,X=se.nextSibling,Z=U.nextSibling,re=Z.firstChild,E=re.nextSibling;return m($,l),se.style.setProperty("font-size","0.875rem"),se.style.setProperty("color","var(--text-muted)"),a(se,()=>e("journal.totalAmount","Total Amount")),m(X,c),a(X,()=>f(t.entry.totalDebit)),Z.style.setProperty("text-align","right"),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>e("journal.lines","Lines")),E.style.setProperty("font-weight","600"),a(E,()=>t.entry.lines.length),$})(),Ee(()=>!P&&(()=>{var $=_6(),U=$.firstChild,se=U.nextSibling,X=se.nextSibling,Z=X.nextSibling,re=Z.nextSibling,E=re.nextSibling,C=E.nextSibling,T=C.nextSibling;return T.nextSibling,$.style.setProperty("padding","0.5rem"),$.style.setProperty("border-radius","var(--border-radius-sm)"),$.style.setProperty("background","#f8d7da"),$.style.setProperty("color","#721c24"),$.style.setProperty("font-size","0.875rem"),$.style.setProperty("margin-bottom","1rem"),a($,()=>e("journal.entryNotBalancedShort","Entry is not balanced"),se),a($,()=>e("journal.debit"),Z),a($,()=>f(t.entry.totalDebit),E),a($,()=>e("journal.credit"),T),a($,()=>f(t.entry.totalCredit),null),$})()),(()=>{var $=b6(),U=$.firstChild,se=U.firstChild;return m($,u),U.style.setProperty("font-weight","500"),U.style.setProperty("margin-bottom","0.5rem"),U.style.setProperty("font-size","0.875rem"),a(U,()=>e("journal.accountLines","Account Lines"),se),a($,()=>t.entry.lines.slice(0,3).map(X=>(()=>{var Z=S6(),re=Z.firstChild,E=re.firstChild,C=E.nextSibling,T=re.nextSibling;return m(Z,h),re.style.setProperty("flex","1"),E.style.setProperty("font-weight","500"),a(E,()=>X.accountName),C.style.setProperty("font-size","0.75rem"),C.style.setProperty("color","var(--text-muted)"),a(C,()=>X.description||e("journal.noDescription","No description")),T.style.setProperty("text-align","right"),a(T,(()=>{var j=Ee(()=>X.debitAmount>0);return()=>j()&&(()=>{var b=D0(),w=b.firstChild;return b.style.setProperty("color","#4caf50"),b.style.setProperty("font-weight","500"),a(b,()=>e("journal.debitShort","Dr."),w),a(b,()=>f(X.debitAmount),null),b})()})(),null),a(T,(()=>{var j=Ee(()=>X.creditAmount>0);return()=>j()&&(()=>{var b=D0(),w=b.firstChild;return b.style.setProperty("color","#f44336"),b.style.setProperty("font-weight","500"),a(b,()=>e("journal.creditShort","Cr."),w),a(b,()=>f(X.creditAmount),null),b})()})(),null),a(T,(()=>{var j=Ee(()=>!!X.reconciled);return()=>j()&&(()=>{var b=P6();return b.firstChild,b.style.setProperty("font-size","0.75rem"),b.style.setProperty("color","#4caf50"),a(b,()=>e("banking.reconciled","Reconciled"),null),b})()})(),null),Z})()),null),a($,(()=>{var X=Ee(()=>t.entry.lines.length>3);return()=>X()&&(()=>{var Z=hf();return Z.style.setProperty("text-align","center"),Z.style.setProperty("color","var(--text-muted)"),Z.style.setProperty("font-size","0.875rem"),a(Z,()=>e("journal.andMoreLines","... and {count} more lines").replace("{count}",(t.entry.lines.length-3).toString())),Z})()})(),null),$})(),(()=>{var $=hf();return m($,y),a($,M(dt,{variant:"primary",size:"sm",onClick:()=>t.onViewDetails?.(t.entry),get children(){return e("journal.viewDetails","View Details")}})),$})()]}})},x6=[{id:"je1",entryNumber:"JE-2024-001",date:"2024-01-15",description:"Customer Payment Received - ABC Corp",reference:"INV-2024-001",status:"posted",createdBy:"John Doe",createdAt:"2024-01-15T09:00:00Z",postedAt:"2024-01-15T09:05:00Z",totalDebit:5e3,totalCredit:5e3,lines:[{id:"jel1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment from ABC Corp",debitAmount:5e3,creditAmount:0,reconciled:!0,reconciledWith:"eb1"},{id:"jel2",accountId:"2001",accountName:"Trade Receivables",description:"Payment received for INV-2024-001",debitAmount:0,creditAmount:5e3}]},{id:"je2",entryNumber:"JE-2024-002",date:"2024-01-14",description:"Office Supplies Purchase",reference:"PO-2024-001",status:"posted",createdBy:"Jane Smith",createdAt:"2024-01-14T10:00:00Z",postedAt:"2024-01-14T10:15:00Z",totalDebit:250,totalCredit:250,lines:[{id:"jel3",accountId:"5200",accountName:"Office Expenses",description:"Office supplies from Staples",debitAmount:250,creditAmount:0},{id:"jel4",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to Staples",debitAmount:0,creditAmount:250,reconciled:!0,reconciledWith:"eb2"}]},{id:"je3",entryNumber:"JE-2024-003",date:"2024-01-13",description:"Monthly Rent Payment",reference:"RENT-2024-01",status:"posted",createdBy:"John Doe",createdAt:"2024-01-13T08:00:00Z",postedAt:"2024-01-13T08:30:00Z",totalDebit:2e3,totalCredit:2e3,lines:[{id:"jel5",accountId:"5200",accountName:"Rent Expense",description:"January office rent",debitAmount:2e3,creditAmount:0},{id:"jel6",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",debitAmount:0,creditAmount:2e3,reconciled:!1}]},{id:"je4",entryNumber:"JE-2024-004",date:"2024-01-12",description:"Wire Transfer - Capital Investment",reference:"WIRE-001",status:"posted",createdBy:"Admin",createdAt:"2024-01-12T14:00:00Z",postedAt:"2024-01-12T14:30:00Z",totalDebit:1e4,totalCredit:1e4,lines:[{id:"jel7",accountId:"1002",accountName:"Bank - Checking Account",description:"Wire transfer received",debitAmount:1e4,creditAmount:0,reconciled:!1},{id:"jel8",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",debitAmount:0,creditAmount:1e4}]},{id:"je5",entryNumber:"JE-2024-005",date:"2024-01-11",description:"Salary Payment - John Doe",reference:"PAY-2024-001",status:"posted",createdBy:"HR Manager",createdAt:"2024-01-11T16:00:00Z",postedAt:"2024-01-11T16:30:00Z",totalDebit:3500,totalCredit:3500,lines:[{id:"jel9",accountId:"13",accountName:"Salaries Expense",description:"Monthly salary - John Doe",debitAmount:3500,creditAmount:0},{id:"jel10",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",debitAmount:0,creditAmount:3500,reconciled:!1}]},{id:"je6",entryNumber:"JE-2024-006",date:"2024-01-10",description:"Product Sales - Multiple Customers",reference:"SALES-2024-010",status:"posted",createdBy:"Sales Manager",createdAt:"2024-01-10T11:00:00Z",postedAt:"2024-01-10T11:30:00Z",totalDebit:8500,totalCredit:8500,lines:[{id:"jel11",accountId:"1001",accountName:"Petty Cash",description:"Cash sales",debitAmount:1500,creditAmount:0},{id:"jel12",accountId:"2001",accountName:"Trade Receivables",description:"Credit sales",debitAmount:7e3,creditAmount:0},{id:"jel13",accountId:"10",accountName:"Sales Revenue",description:"Product sales revenue",debitAmount:0,creditAmount:8500}]},{id:"je7",entryNumber:"JE-2024-007",date:"2024-01-09",description:"Inventory Purchase",reference:"PO-2024-002",status:"draft",createdBy:"Warehouse Manager",createdAt:"2024-01-09T15:00:00Z",totalDebit:15e3,totalCredit:15e3,lines:[{id:"jel14",accountId:"3",accountName:"Inventory",description:"Product inventory purchase",debitAmount:15e3,creditAmount:0},{id:"jel15",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",debitAmount:0,creditAmount:15e3}]},{id:"je8",entryNumber:"JE-2024-008",date:"2024-01-08",description:"Utility Bills Payment",reference:"UTIL-2024-01",status:"posted",createdBy:"Admin",createdAt:"2024-01-08T09:00:00Z",postedAt:"2024-01-08T09:30:00Z",totalDebit:450,totalCredit:450,lines:[{id:"jel16",accountId:"14",accountName:"Operating Expenses",description:"Electricity and water bills",debitAmount:450,creditAmount:0},{id:"jel17",accountId:"1003",accountName:"Bank - Savings Account",description:"Utility payment",debitAmount:0,creditAmount:450}]}],[Yi,pf]=Ce(x6),M0=()=>Yi().filter(e=>e.status==="posted").flatMap(e=>e.lines.filter(r=>["1001","1002","1003"].includes(r.accountId))).map(e=>{const r=Yi().find(n=>n.lines.some(i=>i.id===e.id));return r?{id:`eb_${e.id}`,accountId:e.accountId,date:r.date,description:r.description,reference:r.reference,debitAmount:e.debitAmount,creditAmount:e.creditAmount,category:e.accountName,isReconciled:e.reconciled||!1,reconciledWith:e.reconciledWith,createdAt:r.createdAt}:null}).filter(e=>e!==null),Co={get journalEntries(){return Yi()},addJournalEntry(t){const e={...t,id:Date.now().toString()};return pf([...Yi(),e]),e},updateJournalEntry(t,e){pf(Yi().map(r=>r.id===t?{...r,...e}:r))},deleteJournalEntry(t){const e=Yi().find(r=>r.id===t);if(e&&e.status==="posted")throw new Error("Cannot delete posted journal entries. Void them instead.");pf(Yi().filter(r=>r.id!==t))},voidJournalEntry(t){this.updateJournalEntry(t,{status:"void"})},postJournalEntry(t){const e=Yi().find(r=>r.id===t);if(!e)throw new Error("Journal entry not found");if(Math.abs(e.totalDebit-e.totalCredit)>.01)throw new Error("Journal entry is not balanced. Debits must equal credits.");this.updateJournalEntry(t,{status:"posted",postedAt:new Date().toISOString()}),M0()},getJournalEntryById(t){return Yi().find(e=>e.id===t)},getJournalEntriesByStatus(t){return Yi().filter(e=>e.status===t)},getJournalEntriesByDateRange(t,e){return Yi().filter(r=>r.date>=t&&r.date<=e)},getJournalEntriesByAccount(t){return Yi().filter(e=>e.lines.some(r=>r.accountId===t))},getNextEntryNumber(){const t=new Date().getFullYear(),r=Yi().filter(n=>n.entryNumber.includes(t.toString())).reduce((n,i)=>{const o=parseInt(i.entryNumber.split("-").pop()||"0");return o>n?o:n},0);return`JE-${t}-${String(r+1).padStart(3,"0")}`},validateJournalEntry(t){const e=[];if(t.date||e.push("Date is required"),t.description||e.push("Description is required"),(!t.lines||t.lines.length===0)&&e.push("At least one line item is required"),t.lines){const r=t.lines.reduce((i,o)=>i+(o.debitAmount||0),0),n=t.lines.reduce((i,o)=>i+(o.creditAmount||0),0);Math.abs(r-n)>.01&&e.push(`Entry is not balanced. Debit: ${r}, Credit: ${n}`),t.lines.forEach((i,o)=>{i.accountId||e.push(`Line ${o+1}: Account is required`),i.debitAmount===0&&i.creditAmount===0&&e.push(`Line ${o+1}: Either debit or credit amount must be provided`),i.debitAmount>0&&i.creditAmount>0&&e.push(`Line ${o+1}: Cannot have both debit and credit amounts`)})}return{isValid:e.length===0,errors:e}},getBankRelatedEntries(){return M0()}};var A6=he("<form><div></div><div><div><h4></h4></div><div><div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div><div><strong></strong></div></div></div><div><div><strong>: </strong></div><div><strong>: </strong></div><div></div></div></div><div>"),ff=he("<div>");const L5=t=>{const{t:e}=sr(),[r,n]=Ce({entryNumber:"",date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),[i,o]=Ce([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),[s,l]=Ce(null);yi(()=>{if(t.isOpen){if(t.editEntry)n({entryNumber:t.editEntry.entryNumber,date:t.editEntry.date,description:t.editEntry.description,reference:t.editEntry.reference,createdBy:t.editEntry.createdBy}),o(t.editEntry.lines.map((X,Z)=>({...X,tempId:`line_${Date.now()}_${Z}`})));else{const X=Co.getNextEntryNumber();n({entryNumber:X,date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])}l(null)}});const c={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},u={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr",gap:"1rem","align-items":"end","margin-bottom":"1rem",padding:"1rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",background:"var(--background-color)"},h={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},y=()=>Er.accounts.map(X=>({value:X.id,label:`${X.accountNumber} - ${X.name}`})),g=(X,Z)=>{n(re=>({...re,[X]:Z}))},f=(X,Z,re)=>{o(E=>E.map(C=>{if(C.tempId===X){const T={...C,[Z]:re};if(Z==="accountId"&&typeof re=="string"){const j=Er.getAccountById(re);j&&(T.accountName=j.name)}return T}return C}))},x=()=>{o(X=>[...X,{tempId:`line_${Date.now()}_${X.length}`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}])},S=X=>{i().length>2&&o(Z=>Z.filter(re=>re.tempId!==X))},P=()=>{const X=i().reduce((re,E)=>re+(E.debitAmount||0),0),Z=i().reduce((re,E)=>re+(E.creditAmount||0),0);return{totalDebit:X,totalCredit:Z,isBalanced:Math.abs(X-Z)<.01}},$=X=>{X.preventDefault(),l(null);const Z=r(),re=i(),{totalDebit:E,totalCredit:C,isBalanced:T}=P();if(!Z.description){l(e("forms.descriptionRequired","Description is required"));return}if(re.length<2){l(e("journal.minTwoLinesRequired","At least 2 line items are required"));return}if(!T){l(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${E.toFixed(2)}`).replace("${credit}",`$${C.toFixed(2)}`));return}for(let b=0;b<re.length;b++){const w=re[b];if(!w.accountId){l(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(b+1).toString()));return}if(w.debitAmount===0&&w.creditAmount===0){l(e("journal.lineAmountRequired","Line {lineNumber}: Either debit or credit amount must be provided").replace("{lineNumber}",(b+1).toString()));return}if((w.debitAmount||0)>0&&(w.creditAmount||0)>0){l(e("journal.lineBothAmounts","Line {lineNumber}: Cannot have both debit and credit amounts").replace("{lineNumber}",(b+1).toString()));return}}const j={entryNumber:Z.entryNumber,date:Z.date,description:Z.description,reference:Z.reference,status:"draft",createdBy:Z.createdBy,createdAt:new Date().toISOString(),totalDebit:E,totalCredit:C,lines:re.map((b,w)=>{const{tempId:_,...W}=b;return{id:`jel_${Date.now()}_${w}`,...W}})};try{t.editEntry?Co.updateJournalEntry(t.editEntry.id,j):Co.addJournalEntry(j),n({entryNumber:Co.getNextEntryNumber(),date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),o([{tempId:`line_${Date.now()}_0`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0},{tempId:`line_${Date.now()}_1`,accountId:"",accountName:"",description:"",debitAmount:0,creditAmount:0}]),t.onClose()}catch(b){l(b instanceof Error?b.message:e("forms.errorOccurred","An error occurred"))}},U=X=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(X),se=P();return M(Fn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return Ee(()=>!!t.editEntry)()?e("journal.editEntry"):e("journal.addEntry","Add Journal Entry")},get children(){var X=A6(),Z=X.firstChild,re=Z.nextSibling,E=re.firstChild,C=E.firstChild,T=E.nextSibling,j=T.firstChild,b=j.firstChild,w=b.firstChild,_=b.nextSibling,W=_.firstChild,K=_.nextSibling,k=K.firstChild,R=K.nextSibling,Y=R.firstChild,q=R.nextSibling,O=q.firstChild,le=T.nextSibling,N=le.firstChild,D=N.firstChild,V=D.firstChild,I=N.nextSibling,F=I.firstChild,Q=F.firstChild,H=I.nextSibling,J=re.nextSibling;return X.addEventListener("submit",$),Z.style.setProperty("display","grid"),Z.style.setProperty("grid-template-columns","1fr 1fr"),Z.style.setProperty("gap","1rem"),a(Z,M(Ar,{get label(){return e("journal.entryNumber")},get value(){return r().entryNumber},onChange:te=>g("entryNumber",te),get disabled(){return!!t.editEntry},required:!0}),null),a(Z,M(Ar,{get label(){return e("common.date")},type:"date",get value(){return r().date},onChange:te=>g("date",te),required:!0}),null),a(X,M(Ar,{get label(){return e("common.description")},get value(){return r().description},onChange:te=>g("description",te),get placeholder(){return e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),re),a(X,M(Ar,{get label(){return e("journal.reference")},get value(){return r().reference},onChange:te=>g("reference",te),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),re),re.style.setProperty("margin-top","2rem"),E.style.setProperty("display","flex"),E.style.setProperty("justify-content","space-between"),E.style.setProperty("align-items","center"),E.style.setProperty("margin-bottom","1rem"),C.style.setProperty("margin","0"),a(C,()=>e("journal.entryLines","Journal Entry Lines")),a(E,M(dt,{type:"button",variant:"secondary",size:"sm",onClick:x,get children(){return e("journal.addLine","Add Line")}}),null),T.style.setProperty("margin-bottom","1rem"),T.style.setProperty("font-size","0.875rem"),T.style.setProperty("color","var(--text-muted)"),j.style.setProperty("display","grid"),j.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr"),j.style.setProperty("gap","1rem"),a(w,()=>e("journal.account")),a(W,()=>e("common.description")),a(k,()=>e("journal.debit")),a(Y,()=>e("journal.credit")),a(O,()=>e("common.actions")),a(re,M(bS,{get each(){return i()},get fallback(){return(()=>{var te=ff();return a(te,()=>e("journal.noLines","No lines")),te})()},children:(te,ee)=>{const ne=te();return(()=>{var G=ff();return m(G,u),a(G,M(_n,{label:"",get value(){return ne.accountId||""},onChange:ce=>f(ne.tempId,"accountId",ce),get options(){return y()}}),null),a(G,M(Ar,{label:"",get value(){return ne.description||""},onChange:ce=>f(ne.tempId,"description",ce),get placeholder(){return e("journal.lineDescription","Line description")}}),null),a(G,M(Ar,{label:"",type:"number",get value(){return ne.debitAmount?.toString()||"0"},onChange:ce=>{f(ne.tempId,"debitAmount",parseFloat(ce)||0),parseFloat(ce)>0&&f(ne.tempId,"creditAmount",0)},placeholder:"0.00"}),null),a(G,M(Ar,{label:"",type:"number",get value(){return ne.creditAmount?.toString()||"0"},onChange:ce=>{f(ne.tempId,"creditAmount",parseFloat(ce)||0),parseFloat(ce)>0&&f(ne.tempId,"debitAmount",0)},placeholder:"0.00"}),null),a(G,M(dt,{type:"button",variant:"outline",size:"sm",onClick:()=>S(ne.tempId),get disabled(){return i().length<=2},get children(){return e("common.remove")}}),null),G})()}}),le),m(le,h),a(D,()=>e("journal.totalDebit","Total Debit"),V),a(D,()=>U(se.totalDebit),null),a(F,()=>e("journal.totalCredit","Total Credit"),Q),a(F,()=>U(se.totalCredit),null),H.style.setProperty("font-weight","600"),a(H,(()=>{var te=Ee(()=>!!se.isBalanced);return()=>te()?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`})()),a(X,(()=>{var te=Ee(()=>!!s());return()=>te()&&(()=>{var ee=ff();return ee.style.setProperty("padding","1rem"),ee.style.setProperty("border-radius","var(--border-radius-sm)"),ee.style.setProperty("margin-top","1rem"),ee.style.setProperty("background","#f8d7da"),ee.style.setProperty("color","#721c24"),ee.style.setProperty("border","1px solid #f5c6cb"),a(ee,s),ee})()})(),J),m(J,c),a(J,M(dt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(J,M(dt,{variant:"primary",type:"submit",get disabled(){return!se.isBalanced},get children(){return Ee(()=>!!t.editEntry)()?e("journal.updateEntry","Update Entry"):e("journal.saveAsDraft","Save as Draft")}}),null),Se(te=>(te=se.isBalanced?"#4caf50":"#f44336")!=null?H.style.setProperty("color",te):H.style.removeProperty("color")),X}})},C6={"Sale Amount":{en:"Sale Amount",es:"Monto de Venta"},"Payment Amount":{en:"Payment Amount",es:"Monto del Pago"},"Expense Amount":{en:"Expense Amount",es:"Monto del Gasto"},"Rent Amount":{en:"Rent Amount",es:"Monto del Alquiler"},"Salary Amount":{en:"Salary Amount",es:"Monto del Salario"},"Utility Amount":{en:"Utility Amount",es:"Monto de Servicios"},"Inventory Cost":{en:"Inventory Cost",es:"Costo del Inventario"},"Investment Amount":{en:"Investment Amount",es:"Monto de Inversión"},"Depreciation Amount":{en:"Depreciation Amount",es:"Monto de Depreciación"},"Interest Amount":{en:"Interest Amount",es:"Monto de Interés"},"Principal Amount":{en:"Principal Amount",es:"Monto Principal"},"Total Payment":{en:"Total Payment",es:"Pago Total"},Amount:{en:"Amount",es:"Monto"},Monto:{en:"Amount",es:"Monto"}},I6={"Cash Sale":{en:"Cash Sale",es:"Venta en Efectivo"},"Credit Sale":{en:"Credit Sale",es:"Venta a Crédito"},"Customer Payment Received":{en:"Customer Payment Received",es:"Pago Recibido del Cliente"},"Office Expenses":{en:"Office Expenses",es:"Gastos de Oficina"},"Rent Payment":{en:"Rent Payment",es:"Pago de Alquiler"},"Salary Payment":{en:"Salary Payment",es:"Pago de Salario"},"Utility Payment":{en:"Utility Payment",es:"Pago de Servicios"},"Inventory Purchase":{en:"Inventory Purchase",es:"Compra de Inventario"},"Supplier Payment":{en:"Supplier Payment",es:"Pago a Proveedor"},"Capital Investment":{en:"Capital Investment",es:"Inversión de Capital"},"Depreciation Expense":{en:"Depreciation Expense",es:"Gasto de Depreciación"},"Loan Payment":{en:"Loan Payment",es:"Pago de Préstamo"}},$6={"Record a cash sale transaction":{en:"Record a cash sale transaction",es:"Registrar una transacción de venta en efectivo"},"Record a sale on credit (accounts receivable)":{en:"Record a sale on credit (accounts receivable)",es:"Registrar una venta a crédito (cuentas por cobrar)"},"Record payment received from customer":{en:"Record payment received from customer",es:"Registrar pago recibido del cliente"},"Record office supplies and expenses":{en:"Record office supplies and expenses",es:"Registrar suministros y gastos de oficina"},"Record monthly rent payment":{en:"Record monthly rent payment",es:"Registrar pago mensual de alquiler"},"Record employee salary payment":{en:"Record employee salary payment",es:"Registrar pago de salario de empleado"},"Record utility bills payment":{en:"Record utility bills payment",es:"Registrar pago de servicios públicos"},"Record inventory purchase on credit":{en:"Record inventory purchase on credit",es:"Registrar compra de inventario a crédito"},"Record payment to supplier":{en:"Record payment to supplier",es:"Registrar pago a proveedor"},"Record owner capital investment":{en:"Record owner capital investment",es:"Registrar inversión de capital del propietario"},"Record monthly depreciation of assets":{en:"Record monthly depreciation of assets",es:"Registrar depreciación mensual de activos"},"Record loan principal and interest payment":{en:"Record loan principal and interest payment",es:"Registrar pago de capital e intereses del préstamo"}},E6={"Cash received from sale":{en:"Cash received from sale",es:"Efectivo recibido de venta"},"Sales revenue":{en:"Sales revenue",es:"Ingresos por ventas"},"Credit sale to customer":{en:"Credit sale to customer",es:"Venta a crédito al cliente"},"Payment received from customer":{en:"Payment received from customer",es:"Pago recibido del cliente"},"Payment applied to receivable":{en:"Payment applied to receivable",es:"Pago aplicado a cuenta por cobrar"},"Office supplies and expenses":{en:"Office supplies and expenses",es:"Suministros y gastos de oficina"},"Payment for office expenses":{en:"Payment for office expenses",es:"Pago por gastos de oficina"},"Monthly rent payment":{en:"Monthly rent payment",es:"Pago mensual de alquiler"},"Rent payment":{en:"Rent payment",es:"Pago de alquiler"},"Employee salary":{en:"Employee salary",es:"Salario de empleado"},"Salary payment":{en:"Salary payment",es:"Pago de salario"},"Utility bills payment":{en:"Utility bills payment",es:"Pago de servicios públicos"},"Utility payment":{en:"Utility payment",es:"Pago de servicios"},"Inventory purchase":{en:"Inventory purchase",es:"Compra de inventario"},"Amount owed to supplier":{en:"Amount owed to supplier",es:"Monto adeudado al proveedor"},"Payment to supplier":{en:"Payment to supplier",es:"Pago al proveedor"},"Capital investment received":{en:"Capital investment received",es:"Inversión de capital recibida"},"Capital investment":{en:"Capital investment",es:"Inversión de capital"},"Monthly depreciation expense":{en:"Monthly depreciation expense",es:"Gasto mensual de depreciación"},"Accumulated depreciation":{en:"Accumulated depreciation",es:"Depreciación acumulada"},"Interest expense":{en:"Interest expense",es:"Gasto por intereses"},"Principal payment":{en:"Principal payment",es:"Pago de capital"},"Total loan payment":{en:"Total loan payment",es:"Pago total del préstamo"}},T6=t=>C6[t]?.["es"]||t,k6=t=>I6[t]?.["es"]||t,N6=t=>$6[t]?.["es"]||t,L6=t=>E6[t]?.["es"]||t,R6=[{id:"cash_sale",name:"Cash Sale",description:"Record a cash sale transaction",category:"revenue",lines:[{id:"cs1",accountId:"1001",accountName:"Petty Cash",description:"Cash received from sale",type:"debit",isAmountField:!0,amountFieldName:"Sale Amount"},{id:"cs2",accountId:"10",accountName:"Sales Revenue",description:"Sales revenue",type:"credit",isAmountField:!0,amountFieldName:"Sale Amount"}]},{id:"credit_sale",name:"Credit Sale",description:"Record a sale on credit (accounts receivable)",category:"revenue",lines:[{id:"crs1",accountId:"2001",accountName:"Trade Receivables",description:"Credit sale to customer",type:"debit",isAmountField:!0,amountFieldName:"Sale Amount"},{id:"crs2",accountId:"10",accountName:"Sales Revenue",description:"Sales revenue",type:"credit",isAmountField:!0,amountFieldName:"Sale Amount"}]},{id:"customer_payment",name:"Customer Payment Received",description:"Record payment received from customer",category:"assets",lines:[{id:"cp1",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment received from customer",type:"debit",isAmountField:!0,amountFieldName:"Payment Amount"},{id:"cp2",accountId:"2001",accountName:"Trade Receivables",description:"Payment applied to receivable",type:"credit",isAmountField:!0,amountFieldName:"Payment Amount"}]},{id:"office_expenses",name:"Office Expenses",description:"Record office supplies and expenses",category:"expenses",lines:[{id:"oe1",accountId:"5200",accountName:"Office Expenses",description:"Office supplies and expenses",type:"debit",isAmountField:!0,amountFieldName:"Expense Amount"},{id:"oe2",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment for office expenses",type:"credit",isAmountField:!0,amountFieldName:"Expense Amount"}]},{id:"rent_payment",name:"Rent Payment",description:"Record monthly rent payment",category:"expenses",lines:[{id:"rp1",accountId:"5200",accountName:"Rent Expense",description:"Monthly rent payment",type:"debit",isAmountField:!0,amountFieldName:"Rent Amount"},{id:"rp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Rent payment",type:"credit",isAmountField:!0,amountFieldName:"Rent Amount"}]},{id:"salary_payment",name:"Salary Payment",description:"Record employee salary payment",category:"expenses",lines:[{id:"sp1",accountId:"13",accountName:"Salaries Expense",description:"Employee salary",type:"debit",isAmountField:!0,amountFieldName:"Salary Amount"},{id:"sp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Salary payment",type:"credit",isAmountField:!0,amountFieldName:"Salary Amount"}]},{id:"utility_payment",name:"Utility Payment",description:"Record utility bills payment",category:"expenses",lines:[{id:"up1",accountId:"14",accountName:"Operating Expenses",description:"Utility bills payment",type:"debit",isAmountField:!0,amountFieldName:"Utility Amount"},{id:"up2",accountId:"1002",accountName:"Bank - Checking Account",description:"Utility payment",type:"credit",isAmountField:!0,amountFieldName:"Utility Amount"}]},{id:"inventory_purchase",name:"Inventory Purchase",description:"Record inventory purchase on credit",category:"assets",lines:[{id:"ip1",accountId:"3",accountName:"Inventory",description:"Inventory purchase",type:"debit",isAmountField:!0,amountFieldName:"Inventory Cost"},{id:"ip2",accountId:"5",accountName:"Accounts Payable",description:"Amount owed to supplier",type:"credit",isAmountField:!0,amountFieldName:"Inventory Cost"}]},{id:"supplier_payment",name:"Supplier Payment",description:"Record payment to supplier",category:"liabilities",lines:[{id:"spp1",accountId:"5",accountName:"Accounts Payable",description:"Payment to supplier",type:"debit",isAmountField:!0,amountFieldName:"Payment Amount"},{id:"spp2",accountId:"1002",accountName:"Bank - Checking Account",description:"Payment to supplier",type:"credit",isAmountField:!0,amountFieldName:"Payment Amount"}]},{id:"capital_investment",name:"Capital Investment",description:"Record owner capital investment",category:"equity",lines:[{id:"ci1",accountId:"1002",accountName:"Bank - Checking Account",description:"Capital investment received",type:"debit",isAmountField:!0,amountFieldName:"Investment Amount"},{id:"ci2",accountId:"8",accountName:"Owner's Equity",description:"Capital investment",type:"credit",isAmountField:!0,amountFieldName:"Investment Amount"}]},{id:"depreciation",name:"Depreciation Expense",description:"Record monthly depreciation of assets",category:"expenses",lines:[{id:"dep1",accountId:"14",accountName:"Operating Expenses",description:"Monthly depreciation expense",type:"debit",isAmountField:!0,amountFieldName:"Depreciation Amount"},{id:"dep2",accountId:"15",accountName:"Accumulated Depreciation",description:"Accumulated depreciation",type:"credit",isAmountField:!0,amountFieldName:"Depreciation Amount"}]},{id:"loan_payment",name:"Loan Payment",description:"Record loan principal and interest payment",category:"liabilities",lines:[{id:"lp1",accountId:"14",accountName:"Operating Expenses",description:"Interest expense",type:"debit",isAmountField:!0,amountFieldName:"Interest Amount"},{id:"lp2",accountId:"6",accountName:"Loans Payable",description:"Principal payment",type:"debit",isAmountField:!0,amountFieldName:"Principal Amount"},{id:"lp3",accountId:"1002",accountName:"Bank - Checking Account",description:"Total loan payment",type:"credit",isAmountField:!0,amountFieldName:"Total Payment"}]}],R5="journal_custom_templates",D6=()=>{try{const t=localStorage.getItem(R5);if(t)return JSON.parse(t)}catch(t){console.warn("Failed to load custom templates:",t)}return[]},mf=t=>{try{localStorage.setItem(R5,JSON.stringify(t))}catch(e){console.warn("Failed to save custom templates:",e)}},M6=()=>{const t=D6();return[...R6,...t]},[yf,gf]=Ce(M6()),ui={get templates(){return yf()},getTemplatesByCategory(t){return yf().filter(e=>e.category===t)},getTemplateById(t){return yf().find(e=>e.id===t)},addTemplate(t){const e={...t,id:`custom_${Date.now()}`};return gf(r=>{const n=[...r,e],i=n.filter(o=>o.id.startsWith("custom_"));return mf(i),n}),e},updateTemplate(t,e){gf(r=>{const n=r.map(o=>o.id===t?{...o,...e}:o),i=n.filter(o=>o.id.startsWith("custom_"));return mf(i),n})},deleteTemplate(t){if(t.startsWith("custom_"))gf(e=>{const r=e.filter(i=>i.id!==t),n=r.filter(i=>i.id.startsWith("custom_"));return mf(n),r});else throw new Error("Cannot delete default templates")},getAllCategories(){return["revenue","expenses","assets","liabilities","equity"]},getCategoryDisplayName(t){const e="es",r={revenue:{en:"Revenue & Sales",es:"Ingresos y Ventas"},expenses:{en:"Expenses & Costs",es:"Gastos y Costos"},assets:{en:"Assets & Receipts",es:"Activos y Recibos"},liabilities:{en:"Liabilities & Payments",es:"Pasivos y Pagos"},equity:{en:"Equity & Capital",es:"Patrimonio y Capital"}};return r[t][e]||r[t].en},getTranslatedFieldName:T6,getTranslatedTemplateName:k6,getTranslatedTemplateDesc:N6,getTranslatedLineDesc:L6};var F0=he("<div>"),F6=he("<div><h4></h4><div><div><strong>: </strong><span>|</span><strong>: </strong></div><div>"),O6=he("<form><div></div><div>"),B6=he("<div><div><div></div><div></div><div></div></div><div></div><div><div> ");const j6=t=>{const{t:e}=sr(),[r,n]=Ce(""),[i,o]=Gu({form:{}}),[s,l]=Ce(""),[c,u]=Ce(""),[h,y]=Ce({}),[g,f]=Ce({date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),[x,S]=Ce(null);yi(()=>{t.isOpen&&(n(""),o("form",null),l(null),u(""),f({date:new Date().toISOString().split("T")[0],description:"",reference:"",createdBy:e("journal.currentUser","Current User")}),S(null))}),yi(()=>{});const P={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},$={background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",padding:"1rem","margin-top":"1rem"},U={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.5rem 0","border-bottom":"1px solid var(--border-color)"},se=W=>{if(n(W),W){const K=ui.getTemplateById(W);o("form",Jb(K)||null),l(K?.lines),K&&!g().description&&f(k=>({...k,description:K.description})),K&&K.lines.forEach((k,R)=>{k.fixedAmount||(o("form","lines",R,"fixedAmount",0),y(Y=>({...Y,[k.id]:0})))})}},X=()=>ui.getAllCategories().map(W=>({value:W,label:ui.getCategoryDisplayName(W)})),Z=()=>{const W=c();return W?ui.getTemplatesByCategory(W).map(K=>({value:K.id,label:ui.getTranslatedTemplateName(K.name)})):[]},re=(W,K)=>{f(k=>({...k,[W]:K}))},E=W=>h()?.[W]||0,C=(W,K)=>{const k=i.form;!k||!k.lines.find(Y=>Y.id===W)||(y(Y=>({...Y,[W]:K})),k.lines.findIndex(Y=>Y.id===W))},T=()=>{const W=i.form;if(!W)return{totalDebit:0,totalCredit:0,isBalanced:!1};let K=0,k=0;return W?.lines?.forEach(R=>{const Y=h()?.[R.id]||R.fixedAmount||0;R.type==="debit"?K+=Y:k+=Y}),{totalDebit:K,totalCredit:k,isBalanced:Math.abs(K-k)<.01}},j=()=>{const W=i.form;if(!W)return[];const K=new Map;return W?.lines?.forEach(k=>{k.isAmountField&&k.amountFieldName&&K.set(k.amountFieldName,k.id)}),Array.from(K.entries()).map(([k,R])=>({fieldName:k,lineId:R}))},b=W=>{W.preventDefault(),S(null);const K=i.form;if(!K){S(e("journal.templateRequired","Please select a template"));return}const k=g(),{totalDebit:R,totalCredit:Y,isBalanced:q}=T();if(!k.description){S(e("forms.descriptionRequired","Description is required"));return}if(!q){S(e("journal.entryNotBalanced","Entry is not balanced. Debit: ${debit}, Credit: ${credit}").replace("${debit}",`$${R.toFixed(2)}`).replace("${credit}",`$${Y.toFixed(2)}`));return}for(const le of K.lines){const N=h()?.[le.id]||0;if(le.isAmountField&&N<=0){S(e("journal.amountRequired","Amount is required for {field}").replace("{field}",le.amountFieldName||"line"));return}}const O={entryNumber:Co.getNextEntryNumber(),date:k.date,description:k.description,reference:k.reference,status:"draft",createdBy:k.createdBy,createdAt:new Date().toISOString(),totalDebit:R,totalCredit:Y,lines:K.lines.map((le,N)=>{const D=h()?.[le.id]||0;return{id:`jel_${Date.now()}_${N}`,accountId:le.accountId,accountName:le.accountName,description:le.description,debitAmount:le.type==="debit"?D:0,creditAmount:le.type==="credit"?D:0}})};try{Co.addJournalEntry(O),t.onClose()}catch(le){S(le instanceof Error?le.message:e("forms.errorOccurred","An error occurred"))}},w=W=>{const K="es-ES";return new Intl.NumberFormat(K,{style:"currency",currency:"USD"}).format(W)};j();const _=()=>i?.form?.lines||[];return M(Fn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.quickEntry","Quick Journal Entry")},get children(){var W=O6(),K=W.firstChild,k=K.nextSibling;return W.addEventListener("submit",b),K.style.setProperty("display","grid"),K.style.setProperty("grid-template-columns","1fr 1fr"),K.style.setProperty("gap","1rem"),K.style.setProperty("margin-bottom","1rem"),a(K,M(_n,{get label(){return e("journal.selectCategory","Select Category")},get value(){return c()},onChange:R=>{u(R),se("")},get options(){return[{value:"",label:e("journal.chooseCategory","Choose a category...")},...X()]},required:!0}),null),a(K,M(_n,{get label(){return e("journal.selectTemplate","Select Template")},get value(){return r()},onChange:se,get options(){return[{value:"",label:e("journal.chooseTemplate","Choose a template...")},...Z()]},get disabled(){return!c()},required:!0}),null),a(W,M(Ge,{get when(){return i.form},get children(){return[(()=>{var R=F0();return R.style.setProperty("display","grid"),R.style.setProperty("grid-template-columns","1fr 1fr"),R.style.setProperty("gap","1rem"),a(R,M(Ar,{get label(){return e("common.date")},type:"date",get value(){return g().date},onChange:Y=>re("date",Y),required:!0}),null),a(R,M(Ar,{get label(){return e("journal.reference")},get value(){return g().reference},onChange:Y=>re("reference",Y),get placeholder(){return e("journal.enterReferenceNumber","Enter reference number")}}),null),R})(),M(Ar,{get label(){return e("common.description")},get value(){return g().description},onChange:R=>re("description",R),get placeholder(){return i?.form?.description||e("journal.enterEntryDescription","Enter journal entry description")},required:!0}),(()=>{var R=F6(),Y=R.firstChild,q=Y.nextSibling,O=q.firstChild,le=O.firstChild,N=le.firstChild,D=le.nextSibling,V=D.nextSibling,I=V.firstChild,F=O.nextSibling;return m(R,$),Y.style.setProperty("margin","0 0 1rem 0"),Y.style.setProperty("color","var(--text-primary)"),a(Y,()=>e("journal.entryPreview","Entry Preview")),a(R,M(Ht,{get each(){return _()},children:Q=>(()=>{var H=B6(),J=H.firstChild,te=J.firstChild,ee=te.nextSibling,ne=ee.nextSibling,G=J.nextSibling,ce=G.nextSibling,oe=ce.firstChild,z=oe.firstChild;return te.style.setProperty("font-weight","500"),a(te,()=>Q.accountName),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),a(ee,()=>ui.getTranslatedLineDesc(Q.description)),ne.style.setProperty("font-size","0.75rem"),ne.style.setProperty("margin-top","0.25rem"),ne.style.setProperty("font-weight","500"),a(ne,(()=>{var de=Ee(()=>Q.type==="debit");return()=>de()?e("journal.debit"):e("journal.credit")})()),a(G,M(Ar,{label:"",type:"number",get value(){return E(Q.id).toString()},onChange:de=>C(Q.id,parseFloat(de)||0),placeholder:"0.00",step:"0.01",min:"0",style:{"font-size":"0.875rem"}})),ce.style.setProperty("text-align","right"),oe.style.setProperty("font-weight","600"),a(oe,()=>Q.type==="debit"?"DR":"CR",z),a(oe,()=>w(E(Q.id)),null),Se(de=>{var fe={...U,display:"grid","grid-template-columns":"2fr 1fr 1fr",gap:"1rem","align-items":"center"},ue=Q.type==="debit"?"#d32f2f":"#2e7d32",ge=Q.type==="debit"?"#d32f2f":"#2e7d32";return de.e=m(H,fe,de.e),ue!==de.t&&((de.t=ue)!=null?ne.style.setProperty("color",ue):ne.style.removeProperty("color")),ge!==de.a&&((de.a=ge)!=null?oe.style.setProperty("color",ge):oe.style.removeProperty("color")),de},{e:void 0,t:void 0,a:void 0}),H})()}),q),q.style.setProperty("margin-top","1rem"),q.style.setProperty("padding-top","1rem"),q.style.setProperty("border-top","2px solid var(--border-color)"),q.style.setProperty("display","flex"),q.style.setProperty("justify-content","space-between"),q.style.setProperty("align-items","center"),a(le,()=>e("journal.totalDebit"),N),a(le,()=>w(T().totalDebit),null),D.style.setProperty("margin","0 1rem"),D.style.setProperty("color","var(--text-muted)"),a(V,()=>e("journal.totalCredit"),I),a(V,()=>w(T().totalCredit),null),F.style.setProperty("font-weight","600"),a(F,(()=>{var Q=Ee(()=>!!T().isBalanced);return()=>Q()?`✓ ${e("journal.balanced","Balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`})()),Se(Q=>(Q=T().isBalanced?"#4caf50":"#f44336")!=null?F.style.setProperty("color",Q):F.style.removeProperty("color")),R})()]}}),k),a(W,(()=>{var R=Ee(()=>!!x());return()=>R()&&(()=>{var Y=F0();return Y.style.setProperty("padding","1rem"),Y.style.setProperty("border-radius","var(--border-radius-sm)"),Y.style.setProperty("margin-top","1rem"),Y.style.setProperty("background","#f8d7da"),Y.style.setProperty("color","#721c24"),Y.style.setProperty("border","1px solid #f5c6cb"),a(Y,x),Y})()})(),k),m(k,P),a(k,M(dt,{variant:"secondary",type:"button",get onClick(){return t.onClose},get children(){return e("common.cancel")}}),null),a(k,M(dt,{variant:"primary",type:"submit",get disabled(){return!i.form||!T().isBalanced},get children(){return e("journal.createQuickEntry","Create Quick Entry")}}),null),W}})};var V6=he("<div><h3></h3><div>"),q6=he("<div><div></div><div><div><h4></h4></div><div><div><div></div><div></div><div></div><div></div><div></div><div>"),z6=he("<div><p></p><p>"),O0=he("<div><div></div><div>"),U6=he("<h4>"),H6=he("<span>"),vf=he("<div>");const G6=t=>{const{t:e}=sr(),[r,n]=Ce(""),[i,o]=Ce(!1),[s,l]=Ce(!1),[c,u]=Ce({name:"",description:"",category:"expenses"}),[h,y]=Ce([{accountId:"",accountName:"",description:"",type:"debit",isAmountField:!0,amountFieldName:e("common.amount","Amount")},{accountId:"",accountName:"",description:"",type:"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}]),[g,f]=Ce(null);yi(()=>{t.isOpen&&(n(""),o(!1),l(!1),f(null),Z())});const x={display:"flex",gap:"1.5rem",height:"500px"},S={width:"300px","border-right":"1px solid var(--border-color)","padding-right":"1.5rem","overflow-y":"auto"},P={flex:"1","overflow-y":"auto"},$={padding:"0.75rem","margin-bottom":"0.5rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},U={display:"grid","grid-template-columns":"2fr 2fr 1fr 1fr 1fr 80px",gap:"0.5rem","align-items":"end","margin-bottom":"0.75rem",padding:"0.75rem",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)"},se=()=>Er.accounts.map(R=>({value:R.id,label:`${R.accountNumber} - ${R.name}`})),X=()=>ui.getAllCategories().map(R=>({value:R,label:ui.getCategoryDisplayName(R)})),Z=()=>{u({name:"",description:"",category:"expenses"}),y([{accountId:"",accountName:"",description:"",type:"debit",isAmountField:!0,amountFieldName:e("common.amount","Amount")},{accountId:"",accountName:"",description:"",type:"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}])},re=R=>{const Y=ui.getTemplateById(R);Y&&(u({name:Y.name,description:Y.description,category:Y.category}),y(Y.lines.map(q=>({accountId:q.accountId,accountName:q.accountName,description:q.description,type:q.type,isAmountField:q.isAmountField,amountFieldName:q.amountFieldName,fixedAmount:q.fixedAmount}))))},E=R=>{n(R),o(!1),l(!1),re(R)},C=()=>{n(""),o(!1),l(!0),Z()},T=()=>{r()&&r().startsWith("custom_")&&o(!0)},j=()=>{const R=r();if(R&&R.startsWith("custom_")&&confirm(e("journal.confirmDeleteTemplate","Are you sure you want to delete this template?")))try{ui.deleteTemplate(R),n(""),Z()}catch(Y){f(Y instanceof Error?Y.message:e("journal.errorDeletingTemplate","Error deleting template"))}},b=(R,Y)=>{u(q=>({...q,[R]:Y}))},w=(R,Y,q)=>{y(O=>O.map((le,N)=>{if(N===R){const D={...le,[Y]:q};if(Y==="accountId"&&typeof q=="string"){const V=Er.getAccountById(q);V&&(D.accountName=V.name)}return D}return le}))},_=()=>{y(R=>[...R,{accountId:"",accountName:"",description:"",type:R.length%2===0?"debit":"credit",isAmountField:!0,amountFieldName:e("common.amount","Amount")}])},W=R=>{h().length>2&&y(Y=>Y.filter((q,O)=>O!==R))},K=()=>{f(null);const R=c(),Y=h();if(!R.name.trim()){f(e("journal.templateNameRequired","Template name is required"));return}if(!R.description.trim()){f(e("journal.templateDescriptionRequired","Template description is required"));return}if(Y.length<2){f(e("journal.minTwoLinesRequired","At least 2 lines are required"));return}for(let O=0;O<Y.length;O++){const le=Y[O];if(!le.accountId){f(e("journal.lineAccountRequired","Line {lineNumber}: Account is required").replace("{lineNumber}",(O+1).toString()));return}if(!le.description){f(e("journal.lineDescriptionRequired","Line {lineNumber}: Description is required").replace("{lineNumber}",(O+1).toString()));return}if(le.isAmountField&&!le.amountFieldName){f(e("journal.amountFieldNameRequired","Line {lineNumber}: Amount field name is required").replace("{lineNumber}",(O+1).toString()));return}}const q={name:R.name,description:R.description,category:R.category,lines:Y.map((O,le)=>({id:`line_${Date.now()}_${le}`,...O}))};try{if(i()&&r())ui.updateTemplate(r(),q);else{const O=ui.addTemplate(q);n(O.id)}o(!1),l(!1)}catch(O){f(O instanceof Error?O.message:e("journal.errorSavingTemplate","Error saving template"))}},k=()=>{const R=ui.templates,Y={};return R.forEach(q=>{Y[q.category]||(Y[q.category]=[]),Y[q.category].push(q)}),Y};return M(Fn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.manageTemplates","Manage Journal Templates")},size:"large",get children(){var R=O0(),Y=R.firstChild,q=Y.nextSibling;return m(R,x),m(Y,S),a(Y,M(dt,{variant:"primary",onClick:C,style:{width:"100%","margin-bottom":"1rem"},get children(){return["+ ",Ee(()=>e("journal.addNewTemplate","Add New Template"))]}}),null),a(Y,M(Ht,{get each(){return Object.entries(k())},children:([O,le])=>[(()=>{var N=U6();return N.style.setProperty("margin","1rem 0 0.5rem 0"),N.style.setProperty("font-size","0.875rem"),N.style.setProperty("color","var(--text-muted)"),N.style.setProperty("text-transform","uppercase"),a(N,()=>ui.getCategoryDisplayName(O)),N})(),M(Ht,{each:le,children:N=>(()=>{var D=O0(),V=D.firstChild,I=V.nextSibling;return D.$$click=()=>E(N.id),V.style.setProperty("font-weight","500"),a(V,()=>ui.getTranslatedTemplateName(N.name)),I.style.setProperty("font-size","0.75rem"),I.style.setProperty("opacity","0.8"),I.style.setProperty("margin-top","0.25rem"),a(I,()=>ui.getTranslatedTemplateDesc(N.description)),a(D,(()=>{var F=Ee(()=>!!N.id.startsWith("custom_"));return()=>F()&&(()=>{var Q=H6();return Q.style.setProperty("font-size","0.625rem"),Q.style.setProperty("background","rgba(255,255,255,0.2)"),Q.style.setProperty("padding","0.125rem 0.5rem"),Q.style.setProperty("border-radius","10px"),Q.style.setProperty("margin-top","0.25rem"),Q.style.setProperty("display","inline-block"),a(Q,()=>e("journal.custom","Custom")),Q})()})(),null),Se(F=>m(D,{...$,background:r()===N.id?"var(--primary-color)":"var(--surface-color)",color:r()===N.id?"white":"inherit"},F)),D})()})]}),null),m(q,P),a(q,M(Ge,{get when(){return r()||s()},get children(){return[(()=>{var O=V6(),le=O.firstChild,N=le.nextSibling;return O.style.setProperty("display","flex"),O.style.setProperty("justify-content","space-between"),O.style.setProperty("align-items","center"),O.style.setProperty("margin-bottom","1rem"),le.style.setProperty("margin","0"),a(le,(()=>{var D=Ee(()=>!!s());return()=>D()?e("journal.newTemplate","New Template"):Ee(()=>!!i())()?e("journal.editTemplate","Edit Template"):e("journal.templateDetails","Template Details")})()),N.style.setProperty("display","flex"),N.style.setProperty("gap","0.5rem"),a(N,M(Ge,{get when(){return Ee(()=>!!(r()&&r().startsWith("custom_")))()&&!i()},get children(){return[M(dt,{variant:"outline",size:"sm",onClick:T,get children(){return e("common.edit")}}),M(dt,{variant:"outline",size:"sm",onClick:j,style:{color:"var(--danger-color)"},get children(){return e("common.delete")}})]}}),null),a(N,M(Ge,{get when(){return i()||s()},get children(){return[M(dt,{variant:"secondary",size:"sm",onClick:()=>{o(!1),l(!1),r()&&re(r())},get children(){return e("common.cancel")}}),M(dt,{variant:"primary",size:"sm",onClick:K,get children(){return e("common.save")}})]}}),null),O})(),(()=>{var O=q6(),le=O.firstChild,N=le.nextSibling,D=N.firstChild,V=D.firstChild,I=D.nextSibling,F=I.firstChild,Q=F.firstChild,H=Q.nextSibling,J=H.nextSibling,te=J.nextSibling,ee=te.nextSibling,ne=ee.nextSibling;return O.style.setProperty("background","var(--background-color)"),O.style.setProperty("padding","1rem"),O.style.setProperty("border-radius","var(--border-radius-sm)"),le.style.setProperty("display","grid"),le.style.setProperty("grid-template-columns","2fr 1fr"),le.style.setProperty("gap","1rem"),le.style.setProperty("margin-bottom","1rem"),a(le,M(Ar,{get label(){return e("journal.templateName","Template Name")},get value(){return c().name},onChange:G=>b("name",G),get disabled(){return Ee(()=>!i())()&&!s()},get placeholder(){return e("journal.enterTemplateName","Enter template name")}}),null),a(le,M(_n,{get label(){return e("journal.category","Category")},get value(){return c().category},onChange:G=>b("category",G),get options(){return X()},get disabled(){return Ee(()=>!i())()&&!s()}}),null),a(O,M(Ar,{get label(){return e("common.description")},get value(){return c().description},onChange:G=>b("description",G),get disabled(){return Ee(()=>!i())()&&!s()},get placeholder(){return e("journal.enterTemplateDescription","Enter template description")}}),N),N.style.setProperty("margin-top","2rem"),D.style.setProperty("display","flex"),D.style.setProperty("justify-content","space-between"),D.style.setProperty("align-items","center"),D.style.setProperty("margin-bottom","1rem"),V.style.setProperty("margin","0"),a(V,()=>e("journal.templateLines","Template Lines")),a(D,M(Ge,{get when(){return i()||s()},get children(){return M(dt,{variant:"secondary",size:"sm",onClick:_,get children(){return["+ ",Ee(()=>e("journal.addLine"))]}})}}),null),I.style.setProperty("margin-bottom","0.5rem"),I.style.setProperty("font-size","0.75rem"),I.style.setProperty("color","var(--text-muted)"),F.style.setProperty("display","grid"),F.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1fr 80px"),F.style.setProperty("gap","0.5rem"),a(Q,()=>e("journal.account")),a(H,()=>e("common.description")),a(J,()=>e("journal.type","Type")),a(te,()=>e("journal.amountType","Amount Type")),a(ee,()=>e("journal.fieldName","Field Name")),a(ne,()=>e("common.actions")),a(N,M(Ht,{get each(){return h()},get fallback(){return(()=>{var G=vf();return a(G,()=>e("journal.noTemplateLines","No template lines")),G})()},children:(G,ce)=>{const oe=G,z=ce();return(()=>{var de=vf();return m(de,U),a(de,M(_n,{label:"",get value(){return oe.accountId||""},onChange:fe=>w(z,"accountId",fe),get options(){return[{value:"",label:e("journal.selectAccount","Select account...")},...se()]},get disabled(){return Ee(()=>!i())()&&!s()}}),null),a(de,M(Ar,{label:"",get value(){return oe.description||""},onChange:fe=>w(z,"description",fe),get placeholder(){return e("journal.lineDescription")},get disabled(){return Ee(()=>!i())()&&!s()}}),null),a(de,M(_n,{label:"",get value(){return oe.type},onChange:fe=>w(z,"type",fe),get options(){return[{value:"debit",label:e("journal.debit")},{value:"credit",label:e("journal.credit")}]},get disabled(){return Ee(()=>!i())()&&!s()}}),null),a(de,M(_n,{label:"",get value(){return oe.isAmountField?"variable":"fixed"},onChange:fe=>{w(z,"isAmountField",fe==="variable"),fe==="fixed"&&w(z,"fixedAmount",0)},get options(){return[{value:"variable",label:e("journal.variable","Variable")},{value:"fixed",label:e("journal.fixed","Fixed")}]},get disabled(){return Ee(()=>!i())()&&!s()}}),null),a(de,M(Ge,{get when(){return oe.isAmountField},get fallback(){return M(Ar,{label:"",type:"number",get value(){return oe.fixedAmount?.toString()||"0"},onChange:fe=>w(z,"fixedAmount",parseFloat(fe)||0),placeholder:"0.00",get disabled(){return Ee(()=>!i())()&&!s()}})},get children(){return M(Ar,{label:"",get value(){return oe.amountFieldName||""},onChange:fe=>w(z,"amountFieldName",fe),get placeholder(){return e("journal.fieldNamePlaceholder","e.g., Monto")},get disabled(){return Ee(()=>!i())()&&!s()}})}}),null),a(de,M(Ge,{get when(){return i()||s()},get children(){return M(dt,{variant:"outline",size:"sm",onClick:()=>W(z),get disabled(){return h().length<=2},style:{color:"var(--danger-color)"},get children(){return e("common.remove")}})}}),null),de})()}}),null),O})(),Ee(()=>Ee(()=>!!g())()&&(()=>{var O=vf();return O.style.setProperty("padding","1rem"),O.style.setProperty("border-radius","var(--border-radius-sm)"),O.style.setProperty("margin-top","1rem"),O.style.setProperty("background","#f8d7da"),O.style.setProperty("color","#721c24"),O.style.setProperty("border","1px solid #f5c6cb"),a(O,g),O})())]}}),null),a(q,M(Ge,{get when(){return Ee(()=>!r())()&&!s()},get children(){var O=z6(),le=O.firstChild,N=le.nextSibling;return O.style.setProperty("text-align","center"),O.style.setProperty("padding","3rem"),O.style.setProperty("color","var(--text-muted)"),a(le,()=>e("journal.selectTemplateToView","Select a template from the list to view details")),a(N,()=>e("journal.orCreateNew","or create a new custom template")),O}}),null),R}})};yr(["click"]);var W6=he("<div><div>⚠️</div><div></div><div></div><div>"),Y6=he("<div><div></div><div></div><div></div><div></div><div>"),K6=he("<div><button></button><button> (<!>)</button><button> (<!>/<!>)"),bf=he("<div>"),J6=he("<div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><span></span><span></span></div><div><div><h4></h4><div></div></div><div>"),_f=he("<div><span></span><span>"),Hd=he("<div><strong>:</strong> "),Q6=he("<div><div><div></div><div></div><div></div><div></div><div></div></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div></div></div><div><div><strong>🔗 </strong></div><div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div></div><div><div><strong>:</strong> </div><div><strong>:</strong> "),X6=he("<div><div><div></div><div></div></div><div></div><div></div><div></div><div>"),Z6=he("<div><span>✓ "),eL=he("<span>(<!>)"),tL=he("<div><div>:"),rL=he("<div><div>⚠️ <!>:</div><div>"),nL=he("<div><div><div><span></span><h3></h3></div><div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),iL=he("<div><h4>✅ <!> (<!>)"),oL=he("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>✓ "),sL=he("<div>→ "),aL=he("<div><h4>⏳ <!> (<!>)"),lL=he("<div><div><div></div><div></div></div><div></div><div></div><div></div><div><div>⏳ "),cL=he("<div><div>💡 </div><div> ");const uL=t=>{const{t:e}=sr(),[r,n]=Ce("details"),[i,o]=Ce(!1),s=Dt(()=>t.entryId?Co.getJournalEntryById(t.entryId):null),l={"text-align":"center","margin-bottom":"2rem",position:"relative"},c={position:"absolute",top:"0",right:"0",display:"flex",gap:"0.5rem"},u={"font-size":"0.875rem","font-weight":"600",color:"var(--text-muted)","text-transform":"uppercase","margin-bottom":"0.5rem"},h={"font-size":"1.5rem","font-weight":"600",color:"var(--text-primary)",margin:"0.5rem 0"},y={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)","margin-bottom":"0.5rem"},g={padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"500","text-transform":"uppercase","letter-spacing":"0.5px","margin-bottom":"1rem",display:"inline-block"},f={display:"flex","justify-content":"space-between","align-items":"center",padding:"0.75rem 0","border-bottom":"1px solid var(--border-color)"},x={"font-weight":"500",color:"var(--text-muted)","font-size":"0.875rem"},S={"font-weight":"600",color:"var(--text-primary)"},P={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},$=_=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:_?"var(--primary-color)":"var(--text-muted)","border-bottom":_?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),U={display:"grid","grid-template-columns":"2fr 2.5fr 1fr 1fr 1.5fr",gap:"1rem",padding:"1rem 0","border-bottom":"1px solid var(--border-color)","align-items":"center"},se={...U,"font-weight":"600","font-size":"0.875rem",color:"var(--text-muted)","border-bottom":"2px solid var(--border-color)"},X={display:"flex","justify-content":"space-between","align-items":"center",padding:"1rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)","margin-top":"1rem"},Z={display:"flex",gap:"1rem","justify-content":"flex-end","margin-top":"2rem"},re=_=>({draft:{bg:"#fff3cd",color:"#856404"},posted:{bg:"#d4edda",color:"#155724"},void:{bg:"#f8d7da",color:"#721c24"}})[_],E=_=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(_),C=_=>new Date(_).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),T=_=>new Date(_).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),j=()=>{s()?.status==="posted"&&!confirm(e("journal.confirmEditPosted","This entry has been posted. Editing will create a new draft copy. Continue?"))||o(!0)},b=()=>{if(s()&&confirm(e("journal.confirmPost","Are you sure you want to post this journal entry? This action cannot be undone.")))try{Co.postJournalEntry(s().id)}catch(_){alert(_ instanceof Error?_.message:e("forms.errorPostingEntry","An error occurred while posting the entry"))}},w=()=>{s()&&confirm(e("journal.confirmVoid","Are you sure you want to void this journal entry?"))&&Co.voidJournalEntry(s().id)};return[M(Fn,{get isOpen(){return t.isOpen},get onClose(){return t.onClose},get title(){return e("journal.entryDetails","Journal Entry Details")},get children(){return Ee(()=>!s())()?(()=>{var _=W6(),W=_.firstChild,K=W.nextSibling,k=K.nextSibling,R=k.nextSibling;return _.style.setProperty("text-align","center"),_.style.setProperty("padding","3rem"),_.style.setProperty("color","var(--text-muted)"),W.style.setProperty("font-size","1.5rem"),W.style.setProperty("margin-bottom","1rem"),K.style.setProperty("font-size","1.1rem"),K.style.setProperty("margin-bottom","0.5rem"),a(K,()=>e("journal.entryNotFound","Entry Not Found")),k.style.setProperty("font-size","0.875rem"),a(k,()=>e("journal.entryNotFoundMessage","The journal entry you're looking for could not be found or may have been deleted.")),R.style.setProperty("margin-top","2rem"),a(R,M(dt,{variant:"primary",get onClick(){return t.onClose},get children(){return e("common.close")}})),_})():(()=>{const _=s(),W=re(_.status),K=Math.abs(_.totalDebit-_.totalCredit)<.01;return[(()=>{var k=Y6(),R=k.firstChild,Y=R.nextSibling,q=Y.nextSibling,O=q.nextSibling,le=O.nextSibling;return m(k,l),a(R,M(dt,{variant:"outline",size:"sm",onClick:j,get title(){return e("journal.editEntryTooltip","Edit this journal entry")},get children(){return e("common.edit")}}),null),a(R,(()=>{var N=Ee(()=>_.status==="draft");return()=>N()&&M(dt,{variant:"primary",size:"sm",onClick:b,disabled:!K,get title(){return K?e("journal.postEntryTooltip","Post this journal entry"):e("journal.entryMustBeBalanced","Entry must be balanced to post")},get children(){return e("journal.post","Post")}})})(),null),a(R,(()=>{var N=Ee(()=>_.status==="posted");return()=>N()&&M(dt,{variant:"outline",size:"sm",onClick:w,style:{color:"#dc3545","border-color":"#dc3545"},get title(){return e("journal.voidEntryTooltip","Void this journal entry")},get children(){return e("entryBooks.void","Void")}})})(),null),m(Y,u),a(Y,()=>_.entryNumber),m(q,h),a(q,()=>_.description),m(O,y),a(O,()=>E(_.totalDebit)),a(le,()=>e(`journal.${_.status}`,_.status)),Se(N=>{var D=c,V={...g,background:W.bg,color:W.color};return N.e=m(R,D,N.e),N.t=m(le,V,N.t),N},{e:void 0,t:void 0}),k})(),(()=>{var k=K6(),R=k.firstChild,Y=R.nextSibling,q=Y.firstChild,O=q.nextSibling;O.nextSibling;var le=Y.nextSibling,N=le.firstChild,D=N.nextSibling,V=D.nextSibling,I=V.nextSibling;return I.nextSibling,m(k,P),R.$$click=()=>n("details"),a(R,()=>e("common.details")),Y.$$click=()=>n("lines"),a(Y,()=>e("journal.journalLines","Journal Lines"),q),a(Y,()=>_.lines.length,O),le.$$click=()=>n("reconciliation"),a(le,()=>e("banking.reconciliation","Reconciliation"),N),a(le,()=>_.lines.filter(F=>F.reconciled).length,D),a(le,()=>_.lines.length,I),Se(F=>{var Q=$(r()==="details"),H=$(r()==="lines"),J=$(r()==="reconciliation");return F.e=m(R,Q,F.e),F.t=m(Y,H,F.t),F.a=m(le,J,F.a),F},{e:void 0,t:void 0,a:void 0}),k})(),Ee(()=>Ee(()=>r()==="details")()&&(()=>{var k=J6(),R=k.firstChild,Y=R.firstChild,q=Y.nextSibling,O=R.nextSibling,le=O.firstChild,N=le.nextSibling,D=O.nextSibling,V=D.firstChild,I=V.nextSibling,F=D.nextSibling,Q=F.firstChild,H=Q.nextSibling,J=F.nextSibling,te=J.firstChild,ee=te.nextSibling,ne=J.nextSibling,G=ne.firstChild,ce=G.nextSibling,oe=ne.nextSibling,z=oe.firstChild,de=z.nextSibling,fe=oe.nextSibling,ue=fe.firstChild,ge=ue.firstChild,xe=ge.nextSibling,pe=ue.nextSibling;return a(Y,()=>e("common.date")),a(q,()=>C(_.date)),a(le,()=>e("journal.reference")),a(N,()=>_.reference||e("common.notAvailable","N/A")),a(V,()=>e("journal.totalDebit")),a(I,()=>E(_.totalDebit)),a(Q,()=>e("journal.totalCredit")),a(H,()=>E(_.totalCredit)),a(te,()=>e("journal.balanceStatus","Balance Status")),a(ee,()=>K?`${e("journal.balanced")} ✓`:`${e("journal.unbalanced","Unbalanced")} (${E(Math.abs(_.totalDebit-_.totalCredit))} ${e("journal.difference","difference")})`),a(G,()=>e("journal.createdBy")),a(ce,()=>_.createdBy),a(z,()=>e("journal.createdAt","Created At")),a(de,()=>T(_.createdAt)),a(k,(()=>{var _e=Ee(()=>!!_.postedAt);return()=>_e()&&(()=>{var Le=_f(),De=Le.firstChild,Te=De.nextSibling;return a(De,()=>e("journal.postedAt","Posted At")),a(Te,()=>T(_.postedAt)),Se($e=>{var Ie=f,Re=x,Ke=S;return $e.e=m(Le,Ie,$e.e),$e.t=m(De,Re,$e.t),$e.a=m(Te,Ke,$e.a),$e},{e:void 0,t:void 0,a:void 0}),Le})()})(),fe),fe.style.setProperty("margin-top","2rem"),fe.style.setProperty("padding-top","1rem"),fe.style.setProperty("border-top","2px solid var(--border-color)"),ue.style.setProperty("display","flex"),ue.style.setProperty("justify-content","space-between"),ue.style.setProperty("align-items","center"),ue.style.setProperty("margin-bottom","1rem"),ge.style.setProperty("margin","0"),ge.style.setProperty("font-size","1rem"),a(ge,()=>e("journal.quickActions","Quick Actions")),xe.style.setProperty("display","flex"),xe.style.setProperty("gap","0.5rem"),a(xe,M(dt,{variant:"primary",size:"sm",onClick:j,get children(){return["✏️ ",Ee(()=>e("journal.editEntry"))]}}),null),a(xe,(()=>{var _e=Ee(()=>_.status==="draft");return()=>_e()&&M(dt,{variant:"outline",size:"sm",onClick:b,disabled:!K,style:{"border-color":K?"#4caf50":"#f44336",color:K?"#4caf50":"#f44336"},get children(){return K?`✓ ${e("journal.postEntry","Post Entry")}`:`⚠️ ${e("journal.fixBalance","Fix Balance")}`}})})(),null),a(xe,(()=>{var _e=Ee(()=>_.status==="posted");return()=>_e()&&M(dt,{variant:"outline",size:"sm",onClick:w,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return["🗑️ ",Ee(()=>e("journal.voidEntry","Void Entry"))]}})})(),null),pe.style.setProperty("padding","1rem"),pe.style.setProperty("border-radius","var(--border-radius-sm)"),pe.style.setProperty("font-size","0.875rem"),a(pe,(()=>{var _e=Ee(()=>_.status==="draft");return()=>_e()&&(()=>{var Le=Hd(),De=Le.firstChild,Te=De.firstChild;return De.nextSibling,a(De,()=>e("journal.draftEntry","Draft Entry"),Te),a(Le,()=>e("journal.draftEntryDescription","This entry can be edited and posted."),null),a(Le,()=>!K&&` ⚠️ ${e("journal.entryMustBeBalancedBeforePosting","Entry must be balanced before posting.")}`,null),Le})()})(),null),a(pe,(()=>{var _e=Ee(()=>_.status==="posted");return()=>_e()&&(()=>{var Le=Hd(),De=Le.firstChild,Te=De.firstChild;return De.nextSibling,a(De,()=>e("journal.postedEntry","Posted Entry"),Te),a(Le,()=>e("journal.postedEntryDescription","This entry has been posted to the general ledger. Editing will create a new draft copy."),null),Le})()})(),null),a(pe,(()=>{var _e=Ee(()=>_.status==="void");return()=>_e()&&(()=>{var Le=Hd(),De=Le.firstChild,Te=De.firstChild;return De.nextSibling,a(De,()=>e("journal.voidEntry"),Te),a(Le,()=>e("journal.voidEntryDescription","This entry has been voided and cannot be modified."),null),Le})()})(),null),Se(_e=>{var Le=f,De=x,Te=S,$e=f,Ie=x,Re=S,Ke=f,je=x,We=S,Qe=f,at=x,nt=S,Ye=f,ht=x,lt={...S,color:K?"#4caf50":"#f44336"},$t=f,_t=x,ze=S,Lt=f,Nt=x,wt=S,Ot=_.status==="draft"?"#fff3cd":_.status==="posted"?"#d4edda":"#f8d7da";return _e.e=m(R,Le,_e.e),_e.t=m(Y,De,_e.t),_e.a=m(q,Te,_e.a),_e.o=m(O,$e,_e.o),_e.i=m(le,Ie,_e.i),_e.n=m(N,Re,_e.n),_e.s=m(D,Ke,_e.s),_e.h=m(V,je,_e.h),_e.r=m(I,We,_e.r),_e.d=m(F,Qe,_e.d),_e.l=m(Q,at,_e.l),_e.u=m(H,nt,_e.u),_e.c=m(J,Ye,_e.c),_e.w=m(te,ht,_e.w),_e.m=m(ee,lt,_e.m),_e.f=m(ne,$t,_e.f),_e.y=m(G,_t,_e.y),_e.g=m(ce,ze,_e.g),_e.p=m(oe,Lt,_e.p),_e.b=m(z,Nt,_e.b),_e.T=m(de,wt,_e.T),Ot!==_e.A&&((_e.A=Ot)!=null?pe.style.setProperty("background",Ot):pe.style.removeProperty("background")),_e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0}),k})()),Ee(()=>Ee(()=>r()==="lines")()&&(()=>{var k=Q6(),R=k.firstChild,Y=R.firstChild,q=Y.nextSibling,O=q.nextSibling,le=O.nextSibling,N=le.nextSibling,D=R.nextSibling,V=D.firstChild,I=V.firstChild,F=I.firstChild;I.nextSibling;var Q=V.nextSibling,H=Q.firstChild,J=H.firstChild;H.nextSibling;var te=Q.nextSibling,ee=D.nextSibling,ne=ee.firstChild,G=ne.firstChild;G.firstChild;var ce=ne.nextSibling,oe=ce.firstChild,z=oe.firstChild,de=z.firstChild,fe=de.firstChild;de.nextSibling;var ue=z.nextSibling,ge=ue.firstChild,xe=ge.firstChild;ge.nextSibling;var pe=ue.nextSibling,_e=pe.firstChild,Le=_e.firstChild;_e.nextSibling;var De=oe.nextSibling,Te=De.firstChild,$e=Te.firstChild,Ie=$e.firstChild;$e.nextSibling;var Re=Te.nextSibling,Ke=Re.firstChild,je=Ke.firstChild;return Ke.nextSibling,a(Y,()=>e("journal.account")),a(q,()=>e("common.description")),a(O,()=>e("journal.debit")),a(le,()=>e("journal.credit")),a(N,()=>e("banking.reconciliation")),a(k,M(Ht,{get each(){return _.lines},children:We=>(()=>{var Qe=X6(),at=Qe.firstChild,nt=at.firstChild,Ye=nt.nextSibling,ht=at.nextSibling,lt=ht.nextSibling,$t=lt.nextSibling,_t=$t.nextSibling;return nt.style.setProperty("font-weight","500"),a(nt,()=>We.accountName),Ye.style.setProperty("font-size","0.75rem"),Ye.style.setProperty("color","var(--text-muted)"),a(Ye,()=>Er.getAccountById(We.accountId)?.accountNumber||We.accountId),ht.style.setProperty("font-size","0.875rem"),a(ht,()=>We.description||"-"),lt.style.setProperty("font-weight","600"),a(lt,(()=>{var ze=Ee(()=>We.debitAmount>0);return()=>ze()?E(We.debitAmount):"-"})()),$t.style.setProperty("font-weight","600"),a($t,(()=>{var ze=Ee(()=>We.creditAmount>0);return()=>ze()?E(We.creditAmount):"-"})()),a(_t,(()=>{var ze=Ee(()=>!!We.reconciled);return()=>ze()?(()=>{var Lt=Z6(),Nt=Lt.firstChild;return Nt.firstChild,Lt.style.setProperty("display","flex"),Lt.style.setProperty("align-items","center"),Lt.style.setProperty("gap","0.5rem"),Lt.style.setProperty("color","#4caf50"),Lt.style.setProperty("font-size","0.875rem"),Nt.style.setProperty("font-weight","600"),a(Nt,()=>e("banking.reconciled"),null),a(Lt,(()=>{var wt=Ee(()=>!!We.reconciledWith);return()=>wt()&&(()=>{var Ot=eL(),gr=Ot.firstChild,Be=gr.nextSibling;return Be.nextSibling,Ot.style.setProperty("font-size","0.75rem"),Ot.style.setProperty("color","var(--text-muted)"),Ot.style.setProperty("font-style","italic"),a(Ot,()=>We.reconciledWith,Be),Ot})()})(),null),Lt})():(()=>{var Lt=bf();return Lt.style.setProperty("color","var(--text-muted)"),Lt.style.setProperty("font-size","0.875rem"),a(Lt,()=>e("banking.notReconciled","Not Reconciled")),Lt})()})()),Se(ze=>{var Lt=U,Nt=We.debitAmount>0?"#4caf50":"var(--text-muted)",wt=We.creditAmount>0?"#f44336":"var(--text-muted)";return ze.e=m(Qe,Lt,ze.e),Nt!==ze.t&&((ze.t=Nt)!=null?lt.style.setProperty("color",Nt):lt.style.removeProperty("color")),wt!==ze.a&&((ze.a=wt)!=null?$t.style.setProperty("color",wt):$t.style.removeProperty("color")),ze},{e:void 0,t:void 0,a:void 0}),Qe})()}),D),m(D,X),a(I,()=>e("journal.totalDebit"),F),a(V,()=>E(_.totalDebit),null),a(H,()=>e("journal.totalCredit"),J),a(Q,()=>E(_.totalCredit),null),(K?"#4caf50":"#f44336")!=null?te.style.setProperty("color",K?"#4caf50":"#f44336"):te.style.removeProperty("color"),te.style.setProperty("font-weight","600"),a(te,()=>K?`✓ ${e("journal.balanced")}`:`⚠️ ${e("journal.notBalanced","Not Balanced")}`),ee.style.setProperty("margin-top","1rem"),ee.style.setProperty("padding","1rem"),ee.style.setProperty("border-radius","var(--border-radius-sm)"),ee.style.setProperty("font-size","0.875rem"),ne.style.setProperty("margin-bottom","0.5rem"),a(G,()=>e("journal.reconciliationSummary","Reconciliation Summary"),null),ce.style.setProperty("display","grid"),ce.style.setProperty("grid-template-columns","1fr 1fr"),ce.style.setProperty("gap","1rem"),z.style.setProperty("margin-bottom","0.25rem"),a(de,()=>e("journal.totalLines","Total Lines"),fe),a(z,()=>_.lines.length,null),ue.style.setProperty("margin-bottom","0.25rem"),ue.style.setProperty("color","#4caf50"),a(ge,()=>e("journal.reconciled","Reconciled"),xe),a(ue,()=>_.lines.filter(We=>We.reconciled).length,null),pe.style.setProperty("color","#f44336"),a(_e,()=>e("journal.unreconciled","Unreconciled"),Le),a(pe,()=>_.lines.filter(We=>!We.reconciled).length,null),Te.style.setProperty("margin-bottom","0.25rem"),a($e,()=>e("journal.bankAccounts","Bank Accounts"),Ie),a(Te,()=>_.lines.filter(We=>["1001","1002","1003"].includes(We.accountId)).length,null),Re.style.setProperty("margin-bottom","0.25rem"),Re.style.setProperty("color","#4caf50"),a(Ke,()=>e("journal.bankReconciled","Bank Reconciled"),je),a(Re,()=>_.lines.filter(We=>["1001","1002","1003"].includes(We.accountId)&&We.reconciled).length,null),a(De,(()=>{var We=Ee(()=>_.lines.filter(Qe=>["1001","1002","1003"].includes(Qe.accountId)&&!Qe.reconciled).length>0);return()=>We()&&(()=>{var Qe=Hd(),at=Qe.firstChild,nt=at.firstChild;return at.nextSibling,Qe.style.setProperty("color","#f44336"),a(at,()=>e("journal.bankPending","Bank Pending"),nt),a(Qe,()=>_.lines.filter(Ye=>["1001","1002","1003"].includes(Ye.accountId)&&!Ye.reconciled).length,null),Qe})()})(),null),a(ee,(()=>{var We=Ee(()=>_.lines.filter(Qe=>Qe.reconciled).length>0);return()=>We()&&(()=>{var Qe=tL(),at=Qe.firstChild,nt=at.firstChild;return Qe.style.setProperty("margin-top","0.75rem"),Qe.style.setProperty("padding-top","0.75rem"),Qe.style.setProperty("border-top","1px solid var(--border-color)"),at.style.setProperty("margin-bottom","0.5rem"),at.style.setProperty("font-weight","500"),a(at,()=>e("journal.reconciledLines","Reconciled Lines"),nt),a(Qe,()=>_.lines.filter(Ye=>Ye.reconciled).map(Ye=>(()=>{var ht=_f(),lt=ht.firstChild,$t=lt.nextSibling;return ht.style.setProperty("display","flex"),ht.style.setProperty("justify-content","space-between"),ht.style.setProperty("margin-bottom","0.25rem"),ht.style.setProperty("font-size","0.8rem"),a(lt,()=>Ye.accountName),$t.style.setProperty("color","var(--text-muted)"),a($t,(()=>{var _t=Ee(()=>!!Ye.reconciledWith);return()=>_t()?`→ ${Ye.reconciledWith}`:e("journal.manual","Manual")})()),ht})()),null),Qe})()})(),null),a(ee,(()=>{var We=Ee(()=>_.lines.filter(Qe=>!Qe.reconciled&&["1001","1002","1003"].includes(Qe.accountId)).length>0);return()=>We()&&(()=>{var Qe=rL(),at=Qe.firstChild,nt=at.firstChild,Ye=nt.nextSibling;Ye.nextSibling;var ht=at.nextSibling;return Qe.style.setProperty("margin-top","0.75rem"),Qe.style.setProperty("padding-top","0.75rem"),Qe.style.setProperty("border-top","1px solid var(--border-color)"),at.style.setProperty("margin-bottom","0.5rem"),at.style.setProperty("font-weight","500"),at.style.setProperty("color","#f44336"),a(at,()=>e("journal.pendingBankReconciliation","Pending Bank Reconciliation"),Ye),a(Qe,()=>_.lines.filter(lt=>!lt.reconciled&&["1001","1002","1003"].includes(lt.accountId)).map(lt=>(()=>{var $t=_f(),_t=$t.firstChild,ze=_t.nextSibling;return $t.style.setProperty("display","flex"),$t.style.setProperty("justify-content","space-between"),$t.style.setProperty("margin-bottom","0.25rem"),$t.style.setProperty("font-size","0.8rem"),$t.style.setProperty("color","#f44336"),a(_t,()=>lt.accountName),a(ze,()=>E(lt.debitAmount||lt.creditAmount)),$t})()),ht),ht.style.setProperty("margin-top","0.5rem"),ht.style.setProperty("font-size","0.75rem"),ht.style.setProperty("color","var(--text-muted)"),ht.style.setProperty("font-style","italic"),a(ht,()=>e("journal.visitBankConsolidations","Visit Bank Consolidations to reconcile these transactions")),Qe})()})(),null),Se(We=>{var Qe=se,at=_.lines.some(nt=>nt.reconciled)?"#e8f5e8":"#fff3cd";return We.e=m(R,Qe,We.e),at!==We.t&&((We.t=at)!=null?ee.style.setProperty("background",at):ee.style.removeProperty("background")),We},{e:void 0,t:void 0}),k})()),Ee(()=>Ee(()=>r()==="reconciliation")()&&(()=>{var k=nL(),R=k.firstChild,Y=R.firstChild,q=Y.firstChild,O=q.nextSibling,le=Y.nextSibling,N=le.firstChild,D=N.firstChild,V=D.nextSibling,I=N.nextSibling,F=I.firstChild,Q=F.nextSibling,H=I.nextSibling,J=H.firstChild,te=J.nextSibling;return R.style.setProperty("margin-bottom","1.5rem"),R.style.setProperty("padding","1rem"),R.style.setProperty("border-radius","var(--border-radius)"),R.style.setProperty("border","1px solid var(--border-color)"),Y.style.setProperty("display","flex"),Y.style.setProperty("align-items","center"),Y.style.setProperty("gap","0.5rem"),Y.style.setProperty("margin-bottom","1rem"),q.style.setProperty("font-size","1.5rem"),a(q,(()=>{var ee=Ee(()=>!!_.lines.every(ne=>ne.reconciled));return()=>ee()?"✅":_.lines.some(ne=>ne.reconciled)?"🔄":"⏳"})()),O.style.setProperty("margin","0"),O.style.setProperty("font-size","1.2rem"),a(O,(()=>{var ee=Ee(()=>!!_.lines.every(ne=>ne.reconciled));return()=>ee()?e("journal.fullyReconciled","Fully Reconciled"):Ee(()=>!!_.lines.some(ne=>ne.reconciled))()?e("journal.partiallyReconciled","Partially Reconciled"):e("journal.unreconciled","Unreconciled")})()),le.style.setProperty("display","grid"),le.style.setProperty("grid-template-columns","1fr 1fr 1fr"),le.style.setProperty("gap","1rem"),N.style.setProperty("text-align","center"),D.style.setProperty("font-size","2rem"),D.style.setProperty("font-weight","700"),D.style.setProperty("color","var(--primary-color)"),a(D,()=>_.lines.length),V.style.setProperty("font-size","0.875rem"),V.style.setProperty("color","var(--text-muted)"),a(V,()=>e("journal.totalLines","Total Lines")),I.style.setProperty("text-align","center"),F.style.setProperty("font-size","2rem"),F.style.setProperty("font-weight","700"),F.style.setProperty("color","#4caf50"),a(F,()=>_.lines.filter(ee=>ee.reconciled).length),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>e("journal.reconciled","Reconciled")),H.style.setProperty("text-align","center"),J.style.setProperty("font-size","2rem"),J.style.setProperty("font-weight","700"),J.style.setProperty("color","#f44336"),a(J,()=>_.lines.filter(ee=>!ee.reconciled).length),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-muted)"),a(te,()=>e("journal.pending","Pending")),a(k,(()=>{var ee=Ee(()=>_.lines.filter(ne=>ne.reconciled).length>0);return()=>ee()&&(()=>{var ne=iL(),G=ne.firstChild,ce=G.firstChild,oe=ce.nextSibling,z=oe.nextSibling,de=z.nextSibling;return de.nextSibling,ne.style.setProperty("margin-bottom","1.5rem"),G.style.setProperty("margin","0 0 1rem 0"),G.style.setProperty("font-size","1.1rem"),G.style.setProperty("color","#4caf50"),G.style.setProperty("display","flex"),G.style.setProperty("align-items","center"),G.style.setProperty("gap","0.5rem"),a(G,()=>e("journal.reconciledLines","Reconciled Lines"),oe),a(G,()=>_.lines.filter(fe=>fe.reconciled).length,de),a(ne,()=>_.lines.filter(fe=>fe.reconciled).map(fe=>(()=>{var ue=oL(),ge=ue.firstChild,xe=ge.firstChild,pe=xe.nextSibling,_e=ge.nextSibling,Le=_e.nextSibling,De=Le.nextSibling,Te=De.nextSibling,$e=Te.firstChild;return $e.firstChild,ue.style.setProperty("display","grid"),ue.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),ue.style.setProperty("gap","1rem"),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("background","#f0f9f0"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("align-items","center"),ue.style.setProperty("font-size","0.875rem"),xe.style.setProperty("font-weight","500"),a(xe,()=>fe.accountName),pe.style.setProperty("font-size","0.75rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>Er.getAccountById(fe.accountId)?.accountNumber),_e.style.setProperty("color","var(--text-muted)"),a(_e,()=>fe.description||e("journal.noDescription","No description")),Le.style.setProperty("font-weight","600"),a(Le,(()=>{var Ie=Ee(()=>fe.debitAmount>0);return()=>Ie()?E(fe.debitAmount):"-"})()),De.style.setProperty("font-weight","600"),a(De,(()=>{var Ie=Ee(()=>fe.creditAmount>0);return()=>Ie()?E(fe.creditAmount):"-"})()),Te.style.setProperty("color","#4caf50"),$e.style.setProperty("font-weight","500"),a($e,()=>e("journal.matched","Matched"),null),a(Te,(()=>{var Ie=Ee(()=>!!fe.reconciledWith);return()=>Ie()&&(()=>{var Re=sL();return Re.firstChild,Re.style.setProperty("font-size","0.75rem"),Re.style.setProperty("font-style","italic"),a(Re,()=>fe.reconciledWith,null),Re})()})(),null),Se(Ie=>{var Re=fe.debitAmount>0?"#4caf50":"var(--text-muted)",Ke=fe.creditAmount>0?"#f44336":"var(--text-muted)";return Re!==Ie.e&&((Ie.e=Re)!=null?Le.style.setProperty("color",Re):Le.style.removeProperty("color")),Ke!==Ie.t&&((Ie.t=Ke)!=null?De.style.setProperty("color",Ke):De.style.removeProperty("color")),Ie},{e:void 0,t:void 0}),ue})()),null),ne})()})(),null),a(k,(()=>{var ee=Ee(()=>_.lines.filter(ne=>!ne.reconciled).length>0);return()=>ee()&&(()=>{var ne=aL(),G=ne.firstChild,ce=G.firstChild,oe=ce.nextSibling,z=oe.nextSibling,de=z.nextSibling;return de.nextSibling,ne.style.setProperty("margin-bottom","1.5rem"),G.style.setProperty("margin","0 0 1rem 0"),G.style.setProperty("font-size","1.1rem"),G.style.setProperty("color","#f44336"),G.style.setProperty("display","flex"),G.style.setProperty("align-items","center"),G.style.setProperty("gap","0.5rem"),a(G,()=>e("journal.unreconciledLines","Unreconciled Lines"),oe),a(G,()=>_.lines.filter(fe=>!fe.reconciled).length,de),a(ne,()=>_.lines.filter(fe=>!fe.reconciled).map(fe=>(()=>{var ue=lL(),ge=ue.firstChild,xe=ge.firstChild,pe=xe.nextSibling,_e=ge.nextSibling,Le=_e.nextSibling,De=Le.nextSibling,Te=De.nextSibling,$e=Te.firstChild;return $e.firstChild,ue.style.setProperty("display","grid"),ue.style.setProperty("grid-template-columns","2fr 2fr 1fr 1fr 1.5fr"),ue.style.setProperty("gap","1rem"),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("background","#fff9f0"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("align-items","center"),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("border","1px solid #ffe0b3"),xe.style.setProperty("font-weight","500"),a(xe,()=>fe.accountName),pe.style.setProperty("font-size","0.75rem"),pe.style.setProperty("color","var(--text-muted)"),a(pe,()=>Er.getAccountById(fe.accountId)?.accountNumber),_e.style.setProperty("color","var(--text-muted)"),a(_e,()=>fe.description||e("journal.noDescription","No description")),Le.style.setProperty("font-weight","600"),a(Le,(()=>{var Ie=Ee(()=>fe.debitAmount>0);return()=>Ie()?E(fe.debitAmount):"-"})()),De.style.setProperty("font-weight","600"),a(De,(()=>{var Ie=Ee(()=>fe.creditAmount>0);return()=>Ie()?E(fe.creditAmount):"-"})()),Te.style.setProperty("color","#f44336"),$e.style.setProperty("font-weight","500"),a($e,()=>e("journal.pending","Pending"),null),a(Te,(()=>{var Ie=Ee(()=>!!["1001","1002","1003"].includes(fe.accountId));return()=>Ie()&&(()=>{var Re=bf();return Re.style.setProperty("font-size","0.75rem"),Re.style.setProperty("font-style","italic"),a(Re,()=>e("journal.bankAccount","Bank account")),Re})()})(),null),Se(Ie=>{var Re=fe.debitAmount>0?"#4caf50":"var(--text-muted)",Ke=fe.creditAmount>0?"#f44336":"var(--text-muted)";return Re!==Ie.e&&((Ie.e=Re)!=null?Le.style.setProperty("color",Re):Le.style.removeProperty("color")),Ke!==Ie.t&&((Ie.t=Ke)!=null?De.style.setProperty("color",Ke):De.style.removeProperty("color")),Ie},{e:void 0,t:void 0}),ue})()),null),a(ne,(()=>{var fe=Ee(()=>_.lines.filter(ue=>!ue.reconciled&&["1001","1002","1003"].includes(ue.accountId)).length>0);return()=>fe()&&(()=>{var ue=cL(),ge=ue.firstChild;ge.firstChild;var xe=ge.nextSibling,pe=xe.firstChild;return ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("background","#ffebee"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("margin-top","1rem"),ue.style.setProperty("border","1px solid #ffcdd2"),ge.style.setProperty("font-weight","500"),ge.style.setProperty("margin-bottom","0.5rem"),ge.style.setProperty("color","#f44336"),a(ge,()=>e("journal.reconciliationTip","Reconciliation Tip"),null),xe.style.setProperty("font-size","0.875rem"),xe.style.setProperty("color","var(--text-muted)"),a(xe,()=>e("journal.unreconciledBankTransactions","This entry has unreconciled bank account transactions."),pe),a(xe,()=>e("journal.visitBankConsolidations","Visit Bank Consolidations to reconcile these transactions"),null),ue})()})(),null),ne})()})(),null),Se(ee=>(ee=_.lines.every(ne=>ne.reconciled)?"#e8f5e8":_.lines.some(ne=>ne.reconciled)?"#fff3cd":"#ffebee")!=null?R.style.setProperty("background",ee):R.style.removeProperty("background")),k})()),(()=>{var k=bf();return m(k,Z),a(k,M(dt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("common.close")}}),null),a(k,M(dt,{variant:"primary",onClick:j,get children(){return e("journal.editEntry")}}),null),a(k,(()=>{var R=Ee(()=>_.status==="draft");return()=>R()&&M(dt,{variant:"outline",onClick:b,disabled:!K,style:{"border-color":"#4caf50",color:K?"#4caf50":"var(--text-muted)"},get children(){return K?e("journal.postEntry","Post Entry"):e("journal.entryNotBalanced","Entry Not Balanced")}})})(),null),a(k,(()=>{var R=Ee(()=>_.status==="posted");return()=>R()&&M(dt,{variant:"outline",onClick:w,style:{color:"#dc3545","border-color":"#dc3545"},get children(){return e("journal.voidEntry","Void Entry")}})})(),null),k})()]})()}}),Ee(()=>Ee(()=>!!s())()&&M(L5,{get isOpen(){return i()},onClose:()=>{o(!1)},get editEntry(){return s()}}))]};yr(["click"]);var dL=he("<div><div><h2></h2><p></p></div><div>"),ms=he("<div>"),hL=he("<div> <!> • <!> "),pL=he("<div><div><label></label></div><div><label></label></div><div><label></label></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label></div><div>"),fL=he("<div><span>:</span><span> "),Gd=he("<span>: "),mL=he("<div><br>");const yL=()=>{const{t}=sr(),[e,r]=Ce(!1),[n,i]=Ce(!1),[o,s]=Ce(!1),[l,c]=Ce(null),[u,h]=Ce(!1),[y,g]=Ce(null),[f,x]=Ce("all"),[S,P]=Ce("all"),[$,U]=Ce(""),[se,X]=Ce(""),[Z,re]=Ce("date"),[E,C]=Ce("desc"),T={display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"2rem"},j={display:"flex",gap:"1rem","align-items":"center","margin-bottom":"2rem",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)",border:"1px solid var(--border-color)","flex-wrap":"wrap"},b={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem","margin-bottom":"2rem"},w={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(400px, 1fr))",gap:"1.5rem"},_=()=>[{value:"all",label:t("journal.allEntries","All Entries")},{value:"draft",label:t("journal.draft")},{value:"posted",label:t("journal.posted")},{value:"void",label:t("entryBooks.void","Void")}],W=()=>[{value:"all",label:t("accounts.allAccounts","All Accounts")},...Er.accounts.map(I=>({value:I.id,label:`${I.accountNumber} - ${I.name}`}))],K=()=>[{value:"date",label:t("common.date")},{value:"entryNumber",label:t("journal.entryNumber")},{value:"amount",label:t("common.amount")}],k=()=>{let I=Co.journalEntries;return f()!=="all"&&(I=I.filter(F=>F.status===f())),S()!=="all"&&(I=I.filter(F=>F.lines.some(Q=>Q.accountId===S()))),$()&&(I=I.filter(F=>F.date>=$())),se()&&(I=I.filter(F=>F.date<=se())),I=[...I].sort((F,Q)=>{let H=0;switch(Z()){case"date":H=new Date(F.date).getTime()-new Date(Q.date).getTime();break;case"entryNumber":H=F.entryNumber.localeCompare(Q.entryNumber);break;case"amount":H=F.totalDebit-Q.totalDebit;break}return E()==="asc"?H:-H}),I},R=()=>{const I=Co.journalEntries,F=I.filter(ne=>ne.status==="draft"),Q=I.filter(ne=>ne.status==="posted"),H=I.filter(ne=>ne.status==="void"),J=Q.reduce((ne,G)=>ne+G.totalDebit,0),te=Q.reduce((ne,G)=>ne+G.totalCredit,0),ee=I.filter(ne=>ne.lines.some(G=>["1001","1002","1003"].includes(G.accountId)&&!G.reconciled)).length;return{totalEntries:I.length,draftEntries:F.length,postedEntries:Q.length,voidEntries:H.length,totalDebit:J,totalCredit:te,unreconciledEntries:ee}},Y=I=>{g(I.id),h(!0)},q=()=>{c(null),r(!0)},O=()=>{i(!0)},le=()=>{r(!1),c(null)},N=I=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(I),D=R(),V=k();return M(Qi,{get title(){return t("entryBooks.title")},get children(){return[(()=>{var I=dL(),F=I.firstChild,Q=F.firstChild,H=Q.nextSibling,J=F.nextSibling;return m(I,T),Q.style.setProperty("margin","0 0 0.5rem 0"),Q.style.setProperty("font-size","1.5rem"),a(Q,()=>t("journal.title")),H.style.setProperty("margin","0"),H.style.setProperty("color","var(--text-muted)"),a(H,()=>t("entryBooks.subtitle","Manage accounting entries and general ledger records")),J.style.setProperty("display","flex"),J.style.setProperty("gap","1rem"),a(J,M(dt,{variant:"secondary",onClick:()=>window.location.href="/bank-consolidations",get children(){return t("entryBooks.viewReconciliation","View Reconciliation")}}),null),a(J,M(dt,{variant:"outline",onClick:O,style:{background:"#4caf50",color:"white","border-color":"#4caf50"},get children(){return["⚡ ",Ee(()=>t("journal.quickEntry","Quick Entry"))]}}),null),a(J,M(dt,{variant:"outline",onClick:()=>s(!0),get title(){return t("journal.manageTemplates","Manage Templates")},get children(){return["⚙️ ",Ee(()=>t("journal.templates","Templates"))]}}),null),a(J,M(dt,{variant:"primary",onClick:q,get children(){return t("journal.addEntry","Add Journal Entry")}}),null),I})(),(()=>{var I=ms();return m(I,b),a(I,M(Ft,{get title(){return t("entryBooks.totalEntries","Total Entries")},get subtitle(){return t("entryBooks.allJournalEntries","All journal entries")},get children(){return[(()=>{var F=ms();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","var(--primary-color)"),F.style.setProperty("margin-bottom","0.5rem"),a(F,()=>D.totalEntries),F})(),(()=>{var F=hL(),Q=F.firstChild,H=Q.nextSibling,J=H.nextSibling,te=J.nextSibling;return te.nextSibling,F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),a(F,()=>D.postedEntries,Q),a(F,()=>t("journal.posted").toLowerCase(),H),a(F,()=>D.draftEntries,te),a(F,()=>t("journal.draft").toLowerCase(),null),a(F,(()=>{var ee=Ee(()=>D.voidEntries>0);return()=>ee()&&` • ${D.voidEntries} ${t("entryBooks.void","void").toLowerCase()}`})(),null),F})()]}}),null),a(I,M(Ft,{get title(){return t("journal.totalDebits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var F=ms();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","#4caf50"),F.style.setProperty("margin-bottom","0.5rem"),a(F,()=>N(D.totalDebit)),F})(),(()=>{var F=ms();return F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),a(F,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",D.postedEntries.toString())),F})()]}}),null),a(I,M(Ft,{get title(){return t("journal.totalCredits")},get subtitle(){return t("entryBooks.postedEntriesOnly","Posted entries only")},get children(){return[(()=>{var F=ms();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("color","#f44336"),F.style.setProperty("margin-bottom","0.5rem"),a(F,()=>N(D.totalCredit)),F})(),(()=>{var F=ms();return F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),a(F,()=>t("entryBooks.fromPostedEntries","From {count} posted entries").replace("{count}",D.postedEntries.toString())),F})()]}}),null),a(I,M(Ft,{get title(){return t("banking.unreconciled","Unreconciled")},get subtitle(){return t("banking.title")},get children(){return[(()=>{var F=ms();return F.style.setProperty("font-size","1.5rem"),F.style.setProperty("font-weight","600"),F.style.setProperty("margin-bottom","0.5rem"),a(F,()=>D.unreconciledEntries),Se(Q=>(Q=D.unreconciledEntries>0?"#ff9800":"#4caf50")!=null?F.style.setProperty("color",Q):F.style.removeProperty("color")),F})(),(()=>{var F=ms();return F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-muted)"),a(F,(()=>{var Q=Ee(()=>D.unreconciledEntries>0);return()=>Q()?t("entryBooks.needBankReconciliation","Need bank reconciliation"):t("entryBooks.allReconciled","All reconciled")})()),F})()]}}),null),I})(),(()=>{var I=pL(),F=I.firstChild,Q=F.firstChild,H=F.nextSibling,J=H.firstChild,te=H.nextSibling,ee=te.firstChild,ne=te.nextSibling,G=ne.firstChild,ce=G.nextSibling,oe=ne.nextSibling,z=oe.firstChild,de=z.nextSibling,fe=oe.nextSibling,ue=fe.firstChild,ge=fe.nextSibling;return m(I,j),F.style.setProperty("min-width","150px"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.5rem"),Q.style.setProperty("font-weight","500"),Q.style.setProperty("font-size","0.875rem"),a(Q,()=>t("common.status")),a(F,M(_n,{label:"",get value(){return f()},onChange:x,get options(){return _()}}),null),H.style.setProperty("min-width","200px"),J.style.setProperty("display","block"),J.style.setProperty("margin-bottom","0.5rem"),J.style.setProperty("font-weight","500"),J.style.setProperty("font-size","0.875rem"),a(J,()=>t("journal.account")),a(H,M(_n,{label:"",get value(){return S()},onChange:P,get options(){return W()}}),null),te.style.setProperty("min-width","120px"),ee.style.setProperty("display","block"),ee.style.setProperty("margin-bottom","0.5rem"),ee.style.setProperty("font-weight","500"),ee.style.setProperty("font-size","0.875rem"),a(ee,()=>t("entryBooks.sortBy","Sort By")),a(te,M(_n,{label:"",get value(){return Z()},onChange:re,get options(){return K()}}),null),ne.style.setProperty("min-width","130px"),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-weight","500"),G.style.setProperty("font-size","0.875rem"),a(G,()=>t("entryBooks.fromDate","From Date")),ce.addEventListener("change",xe=>U(xe.target.value)),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),ce.style.setProperty("font-family","inherit"),ce.style.setProperty("width","100%"),oe.style.setProperty("min-width","130px"),z.style.setProperty("display","block"),z.style.setProperty("margin-bottom","0.5rem"),z.style.setProperty("font-weight","500"),z.style.setProperty("font-size","0.875rem"),a(z,()=>t("entryBooks.toDate","To Date")),de.addEventListener("change",xe=>X(xe.target.value)),de.style.setProperty("padding","0.75rem"),de.style.setProperty("border","1px solid var(--border-color)"),de.style.setProperty("border-radius","var(--border-radius-sm)"),de.style.setProperty("font-family","inherit"),de.style.setProperty("width","100%"),fe.style.setProperty("min-width","100px"),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.5rem"),ue.style.setProperty("font-weight","500"),ue.style.setProperty("font-size","0.875rem"),a(ue,()=>t("entryBooks.order","Order")),a(fe,M(_n,{label:"",get value(){return E()},onChange:C,get options(){return[{value:"desc",label:t("entryBooks.newest","Newest")},{value:"asc",label:t("entryBooks.oldest","Oldest")}]}}),null),ge.style.setProperty("display","flex"),ge.style.setProperty("align-items","end"),ge.style.setProperty("gap","0.5rem"),a(ge,M(dt,{variant:"outline",size:"sm",onClick:()=>{x("all"),P("all"),U(""),X(""),re("date"),C("desc")},get children(){return t("entryBooks.resetFilters","Reset Filters")}})),Se(()=>ce.value=$()),Se(()=>de.value=se()),I})(),Ee(()=>Ee(()=>!!(f()!=="all"||S()!=="all"||$()||se()))()&&(()=>{var I=fL(),F=I.firstChild,Q=F.firstChild,H=F.nextSibling,J=H.firstChild;return I.style.setProperty("display","flex"),I.style.setProperty("gap","0.5rem"),I.style.setProperty("align-items","center"),I.style.setProperty("margin-bottom","1rem"),I.style.setProperty("padding","0.75rem"),I.style.setProperty("background","var(--surface-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),I.style.setProperty("border","1px solid var(--border-color)"),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("font-weight","500"),a(F,()=>t("entryBooks.activeFilters","Active filters"),Q),a(I,(()=>{var te=Ee(()=>f()!=="all");return()=>te()&&(()=>{var ee=Gd(),ne=ee.firstChild;return ee.style.setProperty("padding","0.25rem 0.5rem"),ee.style.setProperty("background","var(--primary-color)"),ee.style.setProperty("color","white"),ee.style.setProperty("border-radius","12px"),ee.style.setProperty("font-size","0.75rem"),a(ee,()=>t("common.status"),ne),a(ee,f,null),ee})()})(),H),a(I,(()=>{var te=Ee(()=>S()!=="all");return()=>te()&&(()=>{var ee=Gd(),ne=ee.firstChild;return ee.style.setProperty("padding","0.25rem 0.5rem"),ee.style.setProperty("background","var(--primary-color)"),ee.style.setProperty("color","white"),ee.style.setProperty("border-radius","12px"),ee.style.setProperty("font-size","0.75rem"),a(ee,()=>t("journal.account"),ne),a(ee,()=>Er.getAccountById(S())?.name||t("common.unknown","Unknown"),null),ee})()})(),H),a(I,(()=>{var te=Ee(()=>!!$());return()=>te()&&(()=>{var ee=Gd(),ne=ee.firstChild;return ee.style.setProperty("padding","0.25rem 0.5rem"),ee.style.setProperty("background","var(--primary-color)"),ee.style.setProperty("color","white"),ee.style.setProperty("border-radius","12px"),ee.style.setProperty("font-size","0.75rem"),a(ee,()=>t("entryBooks.from","From"),ne),a(ee,$,null),ee})()})(),H),a(I,(()=>{var te=Ee(()=>!!se());return()=>te()&&(()=>{var ee=Gd(),ne=ee.firstChild;return ee.style.setProperty("padding","0.25rem 0.5rem"),ee.style.setProperty("background","var(--primary-color)"),ee.style.setProperty("color","white"),ee.style.setProperty("border-radius","12px"),ee.style.setProperty("font-size","0.75rem"),a(ee,()=>t("entryBooks.to","To"),ne),a(ee,se,null),ee})()})(),H),H.style.setProperty("margin-left","auto"),H.style.setProperty("font-size","0.875rem"),H.style.setProperty("color","var(--text-muted)"),a(H,()=>V.length,J),a(H,()=>t("entryBooks.entriesFound","{count} entries found").replace("{count}",V.length.toString()),null),I})()),Ee(()=>Ee(()=>V.length===0)()?M(Ft,{get title(){return t("entryBooks.noJournalEntries","No Journal Entries")},get subtitle(){return t("entryBooks.startByCreating","Start by creating your first entry")},get children(){var I=mL(),F=I.firstChild;return I.style.setProperty("text-align","center"),I.style.setProperty("color","var(--text-muted)"),I.style.setProperty("padding","2rem"),a(I,()=>t("entryBooks.noEntriesMatch","No journal entries match your current filters."),F),a(I,M(dt,{variant:"primary",style:{"margin-top":"1rem"},onClick:q,get children(){return t("entryBooks.createFirstEntry","Create First Entry")}}),null),I}}):(()=>{var I=ms();return m(I,w),a(I,M(Ht,{each:V,children:F=>M(w6,{entry:F,onViewDetails:Y})})),I})()),M(L5,{get isOpen(){return e()},onClose:le,get editEntry(){return l()}}),M(j6,{get isOpen(){return n()},onClose:()=>i(!1)}),M(G6,{get isOpen(){return o()},onClose:()=>s(!1)}),M(uL,{get isOpen(){return u()},onClose:()=>{h(!1),g(null)},get entryId(){return y()}})]}})};function tn(t){"@babel/helpers - typeof";return tn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tn(t)}var fi=Uint8Array,Ji=Uint16Array,Hy=Int32Array,yp=new fi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),gp=new fi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),xm=new fi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),D5=function(t,e){for(var r=new Ji(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new Hy(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)i[o]=o-r[n]<<5|n;return{b:r,r:i}},M5=D5(yp,2),F5=M5.b,Am=M5.r;F5[28]=258,Am[258]=28;var O5=D5(gp,0),gL=O5.b,B0=O5.r,Cm=new Ji(32768);for(var pn=0;pn<32768;++pn){var la=(pn&43690)>>1|(pn&21845)<<1;la=(la&52428)>>2|(la&13107)<<2,la=(la&61680)>>4|(la&3855)<<4,Cm[pn]=((la&65280)>>8|(la&255)<<8)>>1}var Xo=function(t,e,r){for(var n=t.length,i=0,o=new Ji(e);i<n;++i)t[i]&&++o[t[i]-1];var s=new Ji(e);for(i=1;i<e;++i)s[i]=s[i-1]+o[i-1]<<1;var l;if(r){l=new Ji(1<<e);var c=15-e;for(i=0;i<n;++i)if(t[i])for(var u=i<<4|t[i],h=e-t[i],y=s[t[i]-1]++<<h,g=y|(1<<h)-1;y<=g;++y)l[Cm[y]>>c]=u}else for(l=new Ji(n),i=0;i<n;++i)t[i]&&(l[i]=Cm[s[t[i]-1]++]>>15-t[i]);return l},ka=new fi(288);for(var pn=0;pn<144;++pn)ka[pn]=8;for(var pn=144;pn<256;++pn)ka[pn]=9;for(var pn=256;pn<280;++pn)ka[pn]=7;for(var pn=280;pn<288;++pn)ka[pn]=8;var qu=new fi(32);for(var pn=0;pn<32;++pn)qu[pn]=5;var vL=Xo(ka,9,0),bL=Xo(ka,9,1),_L=Xo(qu,5,0),SL=Xo(qu,5,1),Sf=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},So=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Pf=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Gy=function(t){return(t+7)/8|0},B5=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new fi(t.subarray(e,r))},PL=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],xo=function(t,e,r){var n=new Error(e||PL[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,xo),!r)throw n;return n},wL=function(t,e,r,n){var i=t.length,o=0;if(!i||e.f&&!e.l)return r||new fi(0);var s=!r,l=s||e.i!=2,c=e.i;s&&(r=new fi(i*3));var u=function(ee){var ne=r.length;if(ee>ne){var G=new fi(Math.max(ne*2,ee));G.set(r),r=G}},h=e.f||0,y=e.p||0,g=e.b||0,f=e.l,x=e.d,S=e.m,P=e.n,$=i*8;do{if(!f){h=So(t,y,1);var U=So(t,y+1,3);if(y+=3,U)if(U==1)f=bL,x=SL,S=9,P=5;else if(U==2){var re=So(t,y,31)+257,E=So(t,y+10,15)+4,C=re+So(t,y+5,31)+1;y+=14;for(var T=new fi(C),j=new fi(19),b=0;b<E;++b)j[xm[b]]=So(t,y+b*3,7);y+=E*3;for(var w=Sf(j),_=(1<<w)-1,W=Xo(j,w,1),b=0;b<C;){var K=W[So(t,y,_)];y+=K&15;var se=K>>4;if(se<16)T[b++]=se;else{var k=0,R=0;for(se==16?(R=3+So(t,y,3),y+=2,k=T[b-1]):se==17?(R=3+So(t,y,7),y+=3):se==18&&(R=11+So(t,y,127),y+=7);R--;)T[b++]=k}}var Y=T.subarray(0,re),q=T.subarray(re);S=Sf(Y),P=Sf(q),f=Xo(Y,S,1),x=Xo(q,P,1)}else xo(1);else{var se=Gy(y)+4,X=t[se-4]|t[se-3]<<8,Z=se+X;if(Z>i){c&&xo(0);break}l&&u(g+X),r.set(t.subarray(se,Z),g),e.b=g+=X,e.p=y=Z*8,e.f=h;continue}if(y>$){c&&xo(0);break}}l&&u(g+131072);for(var O=(1<<S)-1,le=(1<<P)-1,N=y;;N=y){var k=f[Pf(t,y)&O],D=k>>4;if(y+=k&15,y>$){c&&xo(0);break}if(k||xo(2),D<256)r[g++]=D;else if(D==256){N=y,f=null;break}else{var V=D-254;if(D>264){var b=D-257,I=yp[b];V=So(t,y,(1<<I)-1)+F5[b],y+=I}var F=x[Pf(t,y)&le],Q=F>>4;F||xo(3),y+=F&15;var q=gL[Q];if(Q>3){var I=gp[Q];q+=Pf(t,y)&(1<<I)-1,y+=I}if(y>$){c&&xo(0);break}l&&u(g+131072);var H=g+V;if(g<q){var J=o-q,te=Math.min(q,H);for(J+g<0&&xo(3);g<te;++g)r[g]=n[J+g]}for(;g<H;++g)r[g]=r[g-q]}}e.l=f,e.p=N,e.b=g,e.f=h,f&&(h=1,e.m=S,e.d=x,e.n=P)}while(!h);return g!=r.length&&s?B5(r,0,g):r.subarray(0,g)},ys=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},nu=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},wf=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,o=r.slice();if(!i)return{t:V5,l:0};if(i==1){var s=new fi(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(Z,re){return Z.f-re.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,h=1,y=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};h!=i-1;)l=r[r[u].f<r[y].f?u++:y++],c=r[u!=h&&r[u].f<r[y].f?u++:y++],r[h++]={s:-1,f:l.f+c.f,l,r:c};for(var g=o[0].s,n=1;n<i;++n)o[n].s>g&&(g=o[n].s);var f=new Ji(g+1),x=Im(r[h-1],f,0);if(x>e){var n=0,S=0,P=x-e,$=1<<P;for(o.sort(function(re,E){return f[E.s]-f[re.s]||re.f-E.f});n<i;++n){var U=o[n].s;if(f[U]>e)S+=$-(1<<x-f[U]),f[U]=e;else break}for(S>>=P;S>0;){var se=o[n].s;f[se]<e?S-=1<<e-f[se]++-1:++n}for(;n>=0&&S;--n){var X=o[n].s;f[X]==e&&(--f[X],++S)}x=e}return{t:new fi(f),l:x}},Im=function(t,e,r){return t.s==-1?Math.max(Im(t.l,e,r+1),Im(t.r,e,r+1)):e[t.s]=r},j0=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new Ji(++e),n=0,i=t[0],o=1,s=function(c){r[n++]=c},l=1;l<=e;++l)if(t[l]==i&&l!=e)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=t[l]}return{c:r.subarray(0,n),n:e}},iu=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},j5=function(t,e,r){var n=r.length,i=Gy(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var o=0;o<n;++o)t[i+o+4]=r[o];return(i+4+n)*8},V0=function(t,e,r,n,i,o,s,l,c,u,h){ys(e,h++,r),++i[256];for(var y=wf(i,15),g=y.t,f=y.l,x=wf(o,15),S=x.t,P=x.l,$=j0(g),U=$.c,se=$.n,X=j0(S),Z=X.c,re=X.n,E=new Ji(19),C=0;C<U.length;++C)++E[U[C]&31];for(var C=0;C<Z.length;++C)++E[Z[C]&31];for(var T=wf(E,7),j=T.t,b=T.l,w=19;w>4&&!j[xm[w-1]];--w);var _=u+5<<3,W=iu(i,ka)+iu(o,qu)+s,K=iu(i,g)+iu(o,S)+s+14+3*w+iu(E,j)+2*E[16]+3*E[17]+7*E[18];if(c>=0&&_<=W&&_<=K)return j5(e,h,t.subarray(c,c+u));var k,R,Y,q;if(ys(e,h,1+(K<W)),h+=2,K<W){k=Xo(g,f,0),R=g,Y=Xo(S,P,0),q=S;var O=Xo(j,b,0);ys(e,h,se-257),ys(e,h+5,re-1),ys(e,h+10,w-4),h+=14;for(var C=0;C<w;++C)ys(e,h+3*C,j[xm[C]]);h+=3*w;for(var le=[U,Z],N=0;N<2;++N)for(var D=le[N],C=0;C<D.length;++C){var V=D[C]&31;ys(e,h,O[V]),h+=j[V],V>15&&(ys(e,h,D[C]>>5&127),h+=D[C]>>12)}}else k=vL,R=ka,Y=_L,q=qu;for(var C=0;C<l;++C){var I=n[C];if(I>255){var V=I>>18&31;nu(e,h,k[V+257]),h+=R[V+257],V>7&&(ys(e,h,I>>23&31),h+=yp[V]);var F=I&31;nu(e,h,Y[F]),h+=q[F],F>3&&(nu(e,h,I>>5&8191),h+=gp[F])}else nu(e,h,k[I]),h+=R[I]}return nu(e,h,k[256]),h+R[256]},xL=new Hy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),V5=new fi(0),AL=function(t,e,r,n,i,o){var s=o.z||t.length,l=new fi(n+s+5*(1+Math.ceil(s/7e3))+i),c=l.subarray(n,l.length-i),u=o.l,h=(o.r||0)&7;if(e){h&&(c[0]=o.r>>3);for(var y=xL[e-1],g=y>>13,f=y&8191,x=(1<<r)-1,S=o.p||new Ji(32768),P=o.h||new Ji(x+1),$=Math.ceil(r/3),U=2*$,se=function(ce){return(t[ce]^t[ce+1]<<$^t[ce+2]<<U)&x},X=new Hy(25e3),Z=new Ji(288),re=new Ji(32),E=0,C=0,T=o.i||0,j=0,b=o.w||0,w=0;T+2<s;++T){var _=se(T),W=T&32767,K=P[_];if(S[W]=K,P[_]=W,b<=T){var k=s-T;if((E>7e3||j>24576)&&(k>423||!u)){h=V0(t,c,0,X,Z,re,C,j,w,T-w,h),j=E=C=0,w=T;for(var R=0;R<286;++R)Z[R]=0;for(var R=0;R<30;++R)re[R]=0}var Y=2,q=0,O=f,le=W-K&32767;if(k>2&&_==se(T-le))for(var N=Math.min(g,k)-1,D=Math.min(32767,T),V=Math.min(258,k);le<=D&&--O&&W!=K;){if(t[T+Y]==t[T+Y-le]){for(var I=0;I<V&&t[T+I]==t[T+I-le];++I);if(I>Y){if(Y=I,q=le,I>N)break;for(var F=Math.min(le,I-2),Q=0,R=0;R<F;++R){var H=T-le+R&32767,J=S[H],te=H-J&32767;te>Q&&(Q=te,K=H)}}}W=K,K=S[W],le+=W-K&32767}if(q){X[j++]=268435456|Am[Y]<<18|B0[q];var ee=Am[Y]&31,ne=B0[q]&31;C+=yp[ee]+gp[ne],++Z[257+ee],++re[ne],b=T+Y,++E}else X[j++]=t[T],++Z[t[T]]}}for(T=Math.max(T,b);T<s;++T)X[j++]=t[T],++Z[t[T]];h=V0(t,c,u,X,Z,re,C,j,w,T-w,h),u||(o.r=h&7|c[h/8|0]<<3,h-=7,o.h=P,o.p=S,o.i=T,o.w=b)}else{for(var T=o.w||0;T<s+u;T+=65535){var G=T+65535;G>=s&&(c[h/8|0]=u,G=s),h=j5(c,h+1,t.subarray(T,G))}o.i=s}return B5(l,0,n+Gy(h)+i)},q5=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,o=r.length|0,s=0;s!=o;){for(var l=Math.min(s+2655,o);s<l;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},CL=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),s=new fi(o.length+t.length);s.set(o),s.set(t,o.length),t=s,i.w=o.length}return AL(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},z5=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},IL=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=q5();i.p(e.dictionary),z5(t,2,i.d())}},$L=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&xo(6,"invalid zlib data"),(t[1]>>5&1)==1&&xo(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function $m(t,e){e||(e={});var r=q5();r.p(t);var n=CL(t,e,e.dictionary?6:2,4);return IL(n,e),z5(n,n.length-4,r.d()),n}function EL(t,e){return wL(t.subarray($L(t),-4),{i:2},e,e)}var TL=typeof TextDecoder<"u"&&new TextDecoder,kL=0;try{TL.decode(V5,{stream:!0}),kL=1}catch{}var fr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function xf(){fr.console&&typeof fr.console.log=="function"&&fr.console.log.apply(fr.console,arguments)}var sn={log:xf,warn:function(t){fr.console&&(typeof fr.console.warn=="function"?fr.console.warn.apply(fr.console,arguments):xf.call(null,arguments))},error:function(t){fr.console&&(typeof fr.console.error=="function"?fr.console.error.apply(fr.console,arguments):xf(t))}};function Af(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){rl(n.response,e,r)},n.onerror=function(){sn.error("could not download file")},n.send()}function q0(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Wd(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var _u,Em,rl=fr.saveAs||((typeof window>"u"?"undefined":tn(window))!=="object"||window!==fr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=fr.URL||fr.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?q0(i.href)?Af(t,e,r):Wd(i,i.target="_blank"):Wd(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){Wd(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(q0(t))Af(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){Wd(n)})}else navigator.msSaveOrOpenBlob(function(i,o){return o===void 0?o={autoBom:!1}:tn(o)!=="object"&&(sn.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return Af(t,e,r);var i=t.type==="application/octet-stream",o=/constructor/i.test(fr.HTMLElement)||fr.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&o)&&(typeof FileReader>"u"?"undefined":tn(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var h=l.result;h=s?h:h.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=h:location=h,n=null},l.readAsDataURL(t)}else{var c=fr.URL||fr.webkitURL,u=c.createObjectURL(t);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function U5(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,o=r[n].process,s=i.exec(t);s&&(e=o(s),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Cf(t,e){var r=t[0],n=t[1],i=t[2],o=t[3];r=oi(r,n,i,o,e[0],7,-680876936),o=oi(o,r,n,i,e[1],12,-389564586),i=oi(i,o,r,n,e[2],17,606105819),n=oi(n,i,o,r,e[3],22,-1044525330),r=oi(r,n,i,o,e[4],7,-176418897),o=oi(o,r,n,i,e[5],12,1200080426),i=oi(i,o,r,n,e[6],17,-1473231341),n=oi(n,i,o,r,e[7],22,-45705983),r=oi(r,n,i,o,e[8],7,1770035416),o=oi(o,r,n,i,e[9],12,-1958414417),i=oi(i,o,r,n,e[10],17,-42063),n=oi(n,i,o,r,e[11],22,-1990404162),r=oi(r,n,i,o,e[12],7,1804603682),o=oi(o,r,n,i,e[13],12,-40341101),i=oi(i,o,r,n,e[14],17,-1502002290),r=si(r,n=oi(n,i,o,r,e[15],22,1236535329),i,o,e[1],5,-165796510),o=si(o,r,n,i,e[6],9,-1069501632),i=si(i,o,r,n,e[11],14,643717713),n=si(n,i,o,r,e[0],20,-373897302),r=si(r,n,i,o,e[5],5,-701558691),o=si(o,r,n,i,e[10],9,38016083),i=si(i,o,r,n,e[15],14,-660478335),n=si(n,i,o,r,e[4],20,-405537848),r=si(r,n,i,o,e[9],5,568446438),o=si(o,r,n,i,e[14],9,-1019803690),i=si(i,o,r,n,e[3],14,-187363961),n=si(n,i,o,r,e[8],20,1163531501),r=si(r,n,i,o,e[13],5,-1444681467),o=si(o,r,n,i,e[2],9,-51403784),i=si(i,o,r,n,e[7],14,1735328473),r=ai(r,n=si(n,i,o,r,e[12],20,-1926607734),i,o,e[5],4,-378558),o=ai(o,r,n,i,e[8],11,-2022574463),i=ai(i,o,r,n,e[11],16,1839030562),n=ai(n,i,o,r,e[14],23,-35309556),r=ai(r,n,i,o,e[1],4,-1530992060),o=ai(o,r,n,i,e[4],11,1272893353),i=ai(i,o,r,n,e[7],16,-155497632),n=ai(n,i,o,r,e[10],23,-1094730640),r=ai(r,n,i,o,e[13],4,681279174),o=ai(o,r,n,i,e[0],11,-358537222),i=ai(i,o,r,n,e[3],16,-722521979),n=ai(n,i,o,r,e[6],23,76029189),r=ai(r,n,i,o,e[9],4,-640364487),o=ai(o,r,n,i,e[12],11,-421815835),i=ai(i,o,r,n,e[15],16,530742520),r=li(r,n=ai(n,i,o,r,e[2],23,-995338651),i,o,e[0],6,-198630844),o=li(o,r,n,i,e[7],10,1126891415),i=li(i,o,r,n,e[14],15,-1416354905),n=li(n,i,o,r,e[5],21,-57434055),r=li(r,n,i,o,e[12],6,1700485571),o=li(o,r,n,i,e[3],10,-1894986606),i=li(i,o,r,n,e[10],15,-1051523),n=li(n,i,o,r,e[1],21,-2054922799),r=li(r,n,i,o,e[8],6,1873313359),o=li(o,r,n,i,e[15],10,-30611744),i=li(i,o,r,n,e[6],15,-1560198380),n=li(n,i,o,r,e[13],21,1309151649),r=li(r,n,i,o,e[4],6,-145523070),o=li(o,r,n,i,e[11],10,-1120210379),i=li(i,o,r,n,e[2],15,718787259),n=li(n,i,o,r,e[9],21,-343485551),t[0]=ya(r,t[0]),t[1]=ya(n,t[1]),t[2]=ya(i,t[2]),t[3]=ya(o,t[3])}function vp(t,e,r,n,i,o){return e=ya(ya(e,t),ya(n,o)),ya(e<<i|e>>>32-i,r)}function oi(t,e,r,n,i,o,s){return vp(e&r|~e&n,t,e,i,o,s)}function si(t,e,r,n,i,o,s){return vp(e&n|r&~n,t,e,i,o,s)}function ai(t,e,r,n,i,o,s){return vp(e^r^n,t,e,i,o,s)}function li(t,e,r,n,i,o,s){return vp(r^(e|~n),t,e,i,o,s)}function H5(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)Cf(n,NL(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(Cf(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,Cf(n,i),n}function NL(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}_u=fr.atob.bind(fr),Em=fr.btoa.bind(fr);var z0="0123456789abcdef".split("");function LL(t){for(var e="",r=0;r<4;r++)e+=z0[t>>8*r+4&15]+z0[t>>8*r&15];return e}function RL(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Tm(t){return H5(t).map(RL).join("")}var DL=function(t){for(var e=0;e<t.length;e++)t[e]=LL(t[e]);return t.join("")}(H5("hello"))!="5d41402abc4b2a76b9719d911017c592";function ya(t,e){if(DL){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function km(t,e){var r,n,i,o;if(t!==r){for(var s=(i=t,o=1+(256/t.length>>0),new Array(o+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var h=l[c];u=(u+h+s.charCodeAt(c))%256,l[c]=l[u],l[u]=h}r=t,n=l}else l=n;var y=e.length,g=0,f=0,x="";for(c=0;c<y;c++)f=(f+(h=l[g=(g+1)%256]))%256,l[g]=l[f],l[f]=h,s=l[(l[g]+l[f])%256],x+=String.fromCharCode(e.charCodeAt(c)^s);return x}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var U0={print:4,modify:8,copy:16,"annot-forms":32};function ac(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(l){if(U0.perm!==void 0)throw new Error("Invalid permission: "+l);i+=U0[l]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var o=(e+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,s),this.P=-(1+(255^i)),this.encryptionKey=Tm(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=km(this.encryptionKey,this.padding)}function lc(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?e+="#"+("0"+i.toString(16)).slice(-2):e+=t[n]}return e}function H0(t){if(tn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var o=Math.random().toString(35);return e[r][o]=[n,!!i],o},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var o in e[r]){var s=e[r][o];try{s[0].apply(t,n)}catch(l){fr.console&&sn.error("jsPDF PubSub Error",l.message,l)}s[1]&&i.push(o)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function zu(t){if(!(this instanceof zu))return new zu(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function G5(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function fa(t,e,r,n,i){if(!(this instanceof fa))return new fa(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,G5.call(this,n,i)}function ul(t,e,r,n,i){if(!(this instanceof ul))return new ul(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,G5.call(this,n,i)}function dr(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],o=arguments[3],s=[],l=1,c=16,u="S",h=null;tn(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,o=t.compress||t.compressPdf||o,(h=t.encryption||null)!==null&&(h.userPassword=h.userPassword||"",h.ownerPassword=h.ownerPassword||"",h.userPermissions=h.userPermissions||[]),l=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(c=t.floatPrecision),u=t.defaultPathOperation||"S"),s=t.filters||(o===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var y=t.putOnlyUsedFonts||!1,g={},f={internal:{},__private__:{}};f.__private__.PubSub=H0;var x="1.3",S=f.__private__.getPdfVersion=function(){return x};f.__private__.setPdfVersion=function(A){x=A};var P={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return P};var $=f.__private__.getPageFormat=function(A){return P[A]};i=i||"a4";var U={COMPAT:"compat",ADVANCED:"advanced"},se=U.COMPAT;function X(){this.saveGraphicsState(),z(new tt(je,0,0,-je,0,ni()*je).toString()+" cm"),this.setFontSize(this.getFontSize()/je),u="n",se=U.ADVANCED}function Z(){this.restoreGraphicsState(),u="S",se=U.COMPAT}var re=f.__private__.combineFontStyleAndFontWeight=function(A,me){if(A=="bold"&&me=="normal"||A=="bold"&&me==400||A=="normal"&&me=="italic"||A=="bold"&&me=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return me&&(A=me==400||me==="normal"?A==="italic"?"italic":"normal":me!=700&&me!=="bold"||A!=="normal"?(me==700?"bold":me)+""+A:"bold"),A};f.advancedAPI=function(A){var me=se===U.COMPAT;return me&&X.call(this),typeof A!="function"||(A(this),me&&Z.call(this)),this},f.compatAPI=function(A){var me=se===U.ADVANCED;return me&&Z.call(this),typeof A!="function"||(A(this),me&&X.call(this)),this},f.isAdvancedAPI=function(){return se===U.ADVANCED};var E,C=function(A){if(se!==U.ADVANCED)throw new Error(A+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},T=f.roundToPrecision=f.__private__.roundToPrecision=function(A,me){var Ne=e||me;if(isNaN(A)||isNaN(Ne))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return A.toFixed(Ne).replace(/0+$/,"")};E=f.hpf=f.__private__.hpf=typeof c=="number"?function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return T(A,c)}:c==="smart"?function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return T(A,A>-1&&A<1?16:5)}:function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.hpf");return T(A,16)};var j=f.f2=f.__private__.f2=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.f2");return T(A,2)},b=f.__private__.f3=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.f3");return T(A,3)},w=f.scale=f.__private__.scale=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.scale");return se===U.COMPAT?A*je:se===U.ADVANCED?A:void 0},_=function(A){return se===U.COMPAT?ni()-A:se===U.ADVANCED?A:void 0},W=function(A){return w(_(A))};f.__private__.setPrecision=f.setPrecision=function(A){typeof parseInt(A,10)=="number"&&(e=parseInt(A,10))};var K,k="00000000000000000000000000000000",R=f.__private__.getFileId=function(){return k},Y=f.__private__.setFileId=function(A){return k=A!==void 0&&/^[a-fA-F0-9]{32}$/.test(A)?A.toUpperCase():k.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),h!==null&&(dn=new ac(h.userPermissions,h.userPassword,h.ownerPassword,k)),k};f.setFileId=function(A){return Y(A),this},f.getFileId=function(){return R()};var q=f.__private__.convertDateToPDFDate=function(A){var me=A.getTimezoneOffset(),Ne=me<0?"+":"-",Me=Math.floor(Math.abs(me/60)),Ue=Math.abs(me%60),ot=[Ne,V(Me),"'",V(Ue),"'"].join("");return["D:",A.getFullYear(),V(A.getMonth()+1),V(A.getDate()),V(A.getHours()),V(A.getMinutes()),V(A.getSeconds()),ot].join("")},O=f.__private__.convertPDFDateToDate=function(A){var me=parseInt(A.substr(2,4),10),Ne=parseInt(A.substr(6,2),10)-1,Me=parseInt(A.substr(8,2),10),Ue=parseInt(A.substr(10,2),10),ot=parseInt(A.substr(12,2),10),xt=parseInt(A.substr(14,2),10);return new Date(me,Ne,Me,Ue,ot,xt,0)},le=f.__private__.setCreationDate=function(A){var me;if(A===void 0&&(A=new Date),A instanceof Date)me=q(A);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(A))throw new Error("Invalid argument passed to jsPDF.setCreationDate");me=A}return K=me},N=f.__private__.getCreationDate=function(A){var me=K;return A==="jsDate"&&(me=O(K)),me};f.setCreationDate=function(A){return le(A),this},f.getCreationDate=function(A){return N(A)};var D,V=f.__private__.padd2=function(A){return("0"+parseInt(A)).slice(-2)},I=f.__private__.padd2Hex=function(A){return("00"+(A=A.toString())).substr(A.length)},F=0,Q=[],H=[],J=0,te=[],ee=[],ne=!1,G=H,ce=function(){F=0,J=0,H=[],Q=[],te=[],Jt=it(),Je=it()};f.__private__.setCustomOutputDestination=function(A){ne=!0,G=A};var oe=function(A){ne||(G=A)};f.__private__.resetCustomOutputDestination=function(){ne=!1,G=H};var z=f.__private__.out=function(A){return A=A.toString(),J+=A.length+1,G.push(A),G},de=f.__private__.write=function(A){return z(arguments.length===1?A.toString():Array.prototype.join.call(arguments," "))},fe=f.__private__.getArrayBuffer=function(A){for(var me=A.length,Ne=new ArrayBuffer(me),Me=new Uint8Array(Ne);me--;)Me[me]=A.charCodeAt(me);return Ne},ue=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return ue};var ge=t.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(A){return ge=se===U.ADVANCED?A/je:A,this};var xe,pe=f.__private__.getFontSize=f.getFontSize=function(){return se===U.COMPAT?ge:ge*je},_e=t.R2L||!1;f.__private__.setR2L=f.setR2L=function(A){return _e=A,this},f.__private__.getR2L=f.getR2L=function(){return _e};var Le,De=f.__private__.setZoomMode=function(A){var me=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(A))xe=A;else if(isNaN(A)){if(me.indexOf(A)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+A+'" is not recognized.');xe=A}else xe=parseInt(A,10)};f.__private__.getZoomMode=function(){return xe};var Te,$e=f.__private__.setPageMode=function(A){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(A)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+A+'" is not recognized.');Le=A};f.__private__.getPageMode=function(){return Le};var Ie=f.__private__.setLayoutMode=function(A){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(A)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+A+'" is not recognized.');Te=A};f.__private__.getLayoutMode=function(){return Te},f.__private__.setDisplayMode=f.setDisplayMode=function(A,me,Ne){return De(A),Ie(me),$e(Ne),this};var Re={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(A){if(Object.keys(Re).indexOf(A)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Re[A]},f.__private__.getDocumentProperties=function(){return Re},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(A){for(var me in Re)Re.hasOwnProperty(me)&&A[me]&&(Re[me]=A[me]);return this},f.__private__.setDocumentProperty=function(A,me){if(Object.keys(Re).indexOf(A)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Re[A]=me};var Ke,je,We,Qe,at,nt={},Ye={},ht=[],lt={},$t={},_t={},ze={},Lt=null,Nt=0,wt=[],Ot=new H0(f),gr=t.hotfixes||[],Be={},Pt={},Ct=[],tt=function A(me,Ne,Me,Ue,ot,xt){if(!(this instanceof A))return new A(me,Ne,Me,Ue,ot,xt);isNaN(me)&&(me=1),isNaN(Ne)&&(Ne=0),isNaN(Me)&&(Me=0),isNaN(Ue)&&(Ue=1),isNaN(ot)&&(ot=0),isNaN(xt)&&(xt=0),this._matrix=[me,Ne,Me,Ue,ot,xt]};Object.defineProperty(tt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(A){this._matrix[0]=A}}),Object.defineProperty(tt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(A){this._matrix[1]=A}}),Object.defineProperty(tt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(A){this._matrix[2]=A}}),Object.defineProperty(tt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(A){this._matrix[3]=A}}),Object.defineProperty(tt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(A){this._matrix[4]=A}}),Object.defineProperty(tt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(A){this._matrix[5]=A}}),Object.defineProperty(tt.prototype,"a",{get:function(){return this._matrix[0]},set:function(A){this._matrix[0]=A}}),Object.defineProperty(tt.prototype,"b",{get:function(){return this._matrix[1]},set:function(A){this._matrix[1]=A}}),Object.defineProperty(tt.prototype,"c",{get:function(){return this._matrix[2]},set:function(A){this._matrix[2]=A}}),Object.defineProperty(tt.prototype,"d",{get:function(){return this._matrix[3]},set:function(A){this._matrix[3]=A}}),Object.defineProperty(tt.prototype,"e",{get:function(){return this._matrix[4]},set:function(A){this._matrix[4]=A}}),Object.defineProperty(tt.prototype,"f",{get:function(){return this._matrix[5]},set:function(A){this._matrix[5]=A}}),Object.defineProperty(tt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(tt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(tt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(tt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),tt.prototype.join=function(A){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(E).join(A)},tt.prototype.multiply=function(A){var me=A.sx*this.sx+A.shy*this.shx,Ne=A.sx*this.shy+A.shy*this.sy,Me=A.shx*this.sx+A.sy*this.shx,Ue=A.shx*this.shy+A.sy*this.sy,ot=A.tx*this.sx+A.ty*this.shx+this.tx,xt=A.tx*this.shy+A.ty*this.sy+this.ty;return new tt(me,Ne,Me,Ue,ot,xt)},tt.prototype.decompose=function(){var A=this.sx,me=this.shy,Ne=this.shx,Me=this.sy,Ue=this.tx,ot=this.ty,xt=Math.sqrt(A*A+me*me),jt=(A/=xt)*Ne+(me/=xt)*Me;Ne-=A*jt,Me-=me*jt;var p=Math.sqrt(Ne*Ne+Me*Me);return jt/=p,A*(Me/=p)<me*(Ne/=p)&&(A=-A,me=-me,jt=-jt,xt=-xt),{scale:new tt(xt,0,0,p,0,0),translate:new tt(1,0,0,1,Ue,ot),rotate:new tt(A,me,-me,A,0,0),skew:new tt(1,0,jt,1,0,0)}},tt.prototype.toString=function(A){return this.join(" ")},tt.prototype.inversed=function(){var A=this.sx,me=this.shy,Ne=this.shx,Me=this.sy,Ue=this.tx,ot=this.ty,xt=1/(A*Me-me*Ne),jt=Me*xt,p=-me*xt,B=-Ne*xt,ae=A*xt;return new tt(jt,p,B,ae,-jt*Ue-B*ot,-p*Ue-ae*ot)},tt.prototype.applyToPoint=function(A){var me=A.x*this.sx+A.y*this.shx+this.tx,Ne=A.x*this.shy+A.y*this.sy+this.ty;return new os(me,Ne)},tt.prototype.applyToRectangle=function(A){var me=this.applyToPoint(A),Ne=this.applyToPoint(new os(A.x+A.w,A.y+A.h));return new qs(me.x,me.y,Ne.x-me.x,Ne.y-me.y)},tt.prototype.clone=function(){var A=this.sx,me=this.shy,Ne=this.shx,Me=this.sy,Ue=this.tx,ot=this.ty;return new tt(A,me,Ne,Me,Ue,ot)},f.Matrix=tt;var ft=f.matrixMult=function(A,me){return me.multiply(A)},Vt=new tt(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Vt;var Rt=function(A,me){if(!$t[A]){var Ne=(me instanceof fa?"Sh":"P")+(Object.keys(lt).length+1).toString(10);me.id=Ne,$t[A]=Ne,lt[Ne]=me,Ot.publish("addPattern",me)}};f.ShadingPattern=fa,f.TilingPattern=ul,f.addShadingPattern=function(A,me){return C("addShadingPattern()"),Rt(A,me),this},f.beginTilingPattern=function(A){C("beginTilingPattern()"),zs(A.boundingBox[0],A.boundingBox[1],A.boundingBox[2]-A.boundingBox[0],A.boundingBox[3]-A.boundingBox[1],A.matrix)},f.endTilingPattern=function(A,me){C("endTilingPattern()"),me.stream=ee[D].join(`
`),Rt(A,me),Ot.publish("endTilingPattern",me),Ct.pop().restore()};var rr=f.__private__.newObject=function(){var A=it();return yt(A,!0),A},it=f.__private__.newObjectDeferred=function(){return F++,Q[F]=function(){return J},F},yt=function(A,me){return me=typeof me=="boolean"&&me,Q[A]=J,me&&z(A+" 0 obj"),A},It=f.__private__.newAdditionalObject=function(){var A={objId:it(),content:""};return te.push(A),A},Jt=it(),Je=it(),Et=f.__private__.decodeColorString=function(A){var me=A.split(" ");if(me.length!==2||me[1]!=="g"&&me[1]!=="G")me.length===5&&(me[4]==="k"||me[4]==="K")&&(me=[(1-me[0])*(1-me[3]),(1-me[1])*(1-me[3]),(1-me[2])*(1-me[3]),"r"]);else{var Ne=parseFloat(me[0]);me=[Ne,Ne,Ne,"r"]}for(var Me="#",Ue=0;Ue<3;Ue++)Me+=("0"+Math.floor(255*parseFloat(me[Ue])).toString(16)).slice(-2);return Me},Wt=f.__private__.encodeColorString=function(A){var me;typeof A=="string"&&(A={ch1:A});var Ne=A.ch1,Me=A.ch2,Ue=A.ch3,ot=A.ch4,xt=A.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ne=="string"&&Ne.charAt(0)!=="#"){var jt=new U5(Ne);if(jt.ok)Ne=jt.toHex();else if(!/^\d*\.?\d*$/.test(Ne))throw new Error('Invalid color "'+Ne+'" passed to jsPDF.encodeColorString.')}if(typeof Ne=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ne)&&(Ne="#"+Ne[1]+Ne[1]+Ne[2]+Ne[2]+Ne[3]+Ne[3]),typeof Ne=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ne)){var p=parseInt(Ne.substr(1),16);Ne=p>>16&255,Me=p>>8&255,Ue=255&p}if(Me===void 0||ot===void 0&&Ne===Me&&Me===Ue)if(typeof Ne=="string")me=Ne+" "+xt[0];else switch(A.precision){case 2:me=j(Ne/255)+" "+xt[0];break;case 3:default:me=b(Ne/255)+" "+xt[0]}else if(ot===void 0||tn(ot)==="object"){if(ot&&!isNaN(ot.a)&&ot.a===0)return me=["1.","1.","1.",xt[1]].join(" ");if(typeof Ne=="string")me=[Ne,Me,Ue,xt[1]].join(" ");else switch(A.precision){case 2:me=[j(Ne/255),j(Me/255),j(Ue/255),xt[1]].join(" ");break;default:case 3:me=[b(Ne/255),b(Me/255),b(Ue/255),xt[1]].join(" ")}}else if(typeof Ne=="string")me=[Ne,Me,Ue,ot,xt[2]].join(" ");else switch(A.precision){case 2:me=[j(Ne),j(Me),j(Ue),j(ot),xt[2]].join(" ");break;case 3:default:me=[b(Ne),b(Me),b(Ue),b(ot),xt[2]].join(" ")}return me},Yt=f.__private__.getFilters=function(){return s},er=f.__private__.putStream=function(A){var me=(A=A||{}).data||"",Ne=A.filters||Yt(),Me=A.alreadyAppliedFilters||[],Ue=A.addLength1||!1,ot=me.length,xt=A.objectId,jt=function(Pr){return Pr};if(h!==null&&xt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");h!==null&&(jt=dn.encryptor(xt,0));var p={};Ne===!0&&(Ne=["FlateEncode"]);var B=A.additionalKeyValues||[],ae=(p=dr.API.processDataByFilters!==void 0?dr.API.processDataByFilters(me,Ne):{data:me,reverseChain:[]}).reverseChain+(Array.isArray(Me)?Me.join(" "):Me.toString());if(p.data.length!==0&&(B.push({key:"Length",value:p.data.length}),Ue===!0&&B.push({key:"Length1",value:ot})),ae.length!=0)if(ae.split("/").length-1==1)B.push({key:"Filter",value:ae});else{B.push({key:"Filter",value:"["+ae+"]"});for(var Pe=0;Pe<B.length;Pe+=1)if(B[Pe].key==="DecodeParms"){for(var qe=[],et=0;et<p.reverseChain.split("/").length-1;et+=1)qe.push("null");qe.push(B[Pe].value),B[Pe].value="["+qe.join(" ")+"]"}}z("<<");for(var At=0;At<B.length;At++)z("/"+B[At].key+" "+B[At].value);z(">>"),p.data.length!==0&&(z("stream"),z(jt(p.data)),z("endstream"))},kt=f.__private__.putPage=function(A){var me=A.number,Ne=A.data,Me=A.objId,Ue=A.contentsObjId;yt(Me,!0),z("<</Type /Page"),z("/Parent "+A.rootDictionaryObjId+" 0 R"),z("/Resources "+A.resourceDictionaryObjId+" 0 R"),z("/MediaBox ["+parseFloat(E(A.mediaBox.bottomLeftX))+" "+parseFloat(E(A.mediaBox.bottomLeftY))+" "+E(A.mediaBox.topRightX)+" "+E(A.mediaBox.topRightY)+"]"),A.cropBox!==null&&z("/CropBox ["+E(A.cropBox.bottomLeftX)+" "+E(A.cropBox.bottomLeftY)+" "+E(A.cropBox.topRightX)+" "+E(A.cropBox.topRightY)+"]"),A.bleedBox!==null&&z("/BleedBox ["+E(A.bleedBox.bottomLeftX)+" "+E(A.bleedBox.bottomLeftY)+" "+E(A.bleedBox.topRightX)+" "+E(A.bleedBox.topRightY)+"]"),A.trimBox!==null&&z("/TrimBox ["+E(A.trimBox.bottomLeftX)+" "+E(A.trimBox.bottomLeftY)+" "+E(A.trimBox.topRightX)+" "+E(A.trimBox.topRightY)+"]"),A.artBox!==null&&z("/ArtBox ["+E(A.artBox.bottomLeftX)+" "+E(A.artBox.bottomLeftY)+" "+E(A.artBox.topRightX)+" "+E(A.artBox.topRightY)+"]"),typeof A.userUnit=="number"&&A.userUnit!==1&&z("/UserUnit "+A.userUnit),Ot.publish("putPage",{objId:Me,pageContext:wt[me],pageNumber:me,page:Ne}),z("/Contents "+Ue+" 0 R"),z(">>"),z("endobj");var ot=Ne.join(`
`);return se===U.ADVANCED&&(ot+=`
Q`),yt(Ue,!0),er({data:ot,filters:Yt(),objectId:Ue}),z("endobj"),Me},Xt=f.__private__.putPages=function(){var A,me,Ne=[];for(A=1;A<=Nt;A++)wt[A].objId=it(),wt[A].contentsObjId=it();for(A=1;A<=Nt;A++)Ne.push(kt({number:A,data:ee[A],objId:wt[A].objId,contentsObjId:wt[A].contentsObjId,mediaBox:wt[A].mediaBox,cropBox:wt[A].cropBox,bleedBox:wt[A].bleedBox,trimBox:wt[A].trimBox,artBox:wt[A].artBox,userUnit:wt[A].userUnit,rootDictionaryObjId:Jt,resourceDictionaryObjId:Je}));yt(Jt,!0),z("<</Type /Pages");var Me="/Kids [";for(me=0;me<Nt;me++)Me+=Ne[me]+" 0 R ";z(Me+"]"),z("/Count "+Nt),z(">>"),z("endobj"),Ot.publish("postPutPages")},tr=function(A){Ot.publish("putFont",{font:A,out:z,newObject:rr,putStream:er}),A.isAlreadyPutted!==!0&&(A.objectNumber=rr(),z("<<"),z("/Type /Font"),z("/BaseFont /"+lc(A.postScriptName)),z("/Subtype /Type1"),typeof A.encoding=="string"&&z("/Encoding /"+A.encoding),z("/FirstChar 32"),z("/LastChar 255"),z(">>"),z("endobj"))},Zt=function(){for(var A in nt)nt.hasOwnProperty(A)&&(y===!1||y===!0&&g.hasOwnProperty(A))&&tr(nt[A])},vt=function(A){A.objectNumber=rr();var me=[];me.push({key:"Type",value:"/XObject"}),me.push({key:"Subtype",value:"/Form"}),me.push({key:"BBox",value:"["+[E(A.x),E(A.y),E(A.x+A.width),E(A.y+A.height)].join(" ")+"]"}),me.push({key:"Matrix",value:"["+A.matrix.toString()+"]"});var Ne=A.pages[1].join(`
`);er({data:Ne,additionalKeyValues:me,objectId:A.objectNumber}),z("endobj")},ir=function(){for(var A in Be)Be.hasOwnProperty(A)&&vt(Be[A])},Tt=function(A,me){var Ne,Me=[],Ue=1/(me-1);for(Ne=0;Ne<1;Ne+=Ue)Me.push(Ne);if(Me.push(1),A[0].offset!=0){var ot={offset:0,color:A[0].color};A.unshift(ot)}if(A[A.length-1].offset!=1){var xt={offset:1,color:A[A.length-1].color};A.push(xt)}for(var jt="",p=0,B=0;B<Me.length;B++){for(Ne=Me[B];Ne>A[p+1].offset;)p++;var ae=A[p].offset,Pe=(Ne-ae)/(A[p+1].offset-ae),qe=A[p].color,et=A[p+1].color;jt+=I(Math.round((1-Pe)*qe[0]+Pe*et[0]).toString(16))+I(Math.round((1-Pe)*qe[1]+Pe*et[1]).toString(16))+I(Math.round((1-Pe)*qe[2]+Pe*et[2]).toString(16))}return jt.trim()},Ir=function(A,me){me||(me=21);var Ne=rr(),Me=Tt(A.colors,me),Ue=[];Ue.push({key:"FunctionType",value:"0"}),Ue.push({key:"Domain",value:"[0.0 1.0]"}),Ue.push({key:"Size",value:"["+me+"]"}),Ue.push({key:"BitsPerSample",value:"8"}),Ue.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ue.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),er({data:Me,additionalKeyValues:Ue,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ne}),z("endobj"),A.objectNumber=rr(),z("<< /ShadingType "+A.type),z("/ColorSpace /DeviceRGB");var ot="/Coords ["+E(parseFloat(A.coords[0]))+" "+E(parseFloat(A.coords[1]))+" ";A.type===2?ot+=E(parseFloat(A.coords[2]))+" "+E(parseFloat(A.coords[3])):ot+=E(parseFloat(A.coords[2]))+" "+E(parseFloat(A.coords[3]))+" "+E(parseFloat(A.coords[4]))+" "+E(parseFloat(A.coords[5])),z(ot+="]"),A.matrix&&z("/Matrix ["+A.matrix.toString()+"]"),z("/Function "+Ne+" 0 R"),z("/Extend [true true]"),z(">>"),z("endobj")},or=function(A,me){var Ne=it(),Me=rr();me.push({resourcesOid:Ne,objectOid:Me}),A.objectNumber=Me;var Ue=[];Ue.push({key:"Type",value:"/Pattern"}),Ue.push({key:"PatternType",value:"1"}),Ue.push({key:"PaintType",value:"1"}),Ue.push({key:"TilingType",value:"1"}),Ue.push({key:"BBox",value:"["+A.boundingBox.map(E).join(" ")+"]"}),Ue.push({key:"XStep",value:E(A.xStep)}),Ue.push({key:"YStep",value:E(A.yStep)}),Ue.push({key:"Resources",value:Ne+" 0 R"}),A.matrix&&Ue.push({key:"Matrix",value:"["+A.matrix.toString()+"]"}),er({data:A.stream,additionalKeyValues:Ue,objectId:A.objectNumber}),z("endobj")},cr=function(A){var me;for(me in lt)lt.hasOwnProperty(me)&&(lt[me]instanceof fa?Ir(lt[me]):lt[me]instanceof ul&&or(lt[me],A))},_r=function(A){for(var me in A.objectNumber=rr(),z("<<"),A)switch(me){case"opacity":z("/ca "+j(A[me]));break;case"stroke-opacity":z("/CA "+j(A[me]))}z(">>"),z("endobj")},Tr=function(){var A;for(A in _t)_t.hasOwnProperty(A)&&_r(_t[A])},kr=function(){for(var A in z("/XObject <<"),Be)Be.hasOwnProperty(A)&&Be[A].objectNumber>=0&&z("/"+A+" "+Be[A].objectNumber+" 0 R");Ot.publish("putXobjectDict"),z(">>")},lr=function(){dn.oid=rr(),z("<<"),z("/Filter /Standard"),z("/V "+dn.v),z("/R "+dn.r),z("/U <"+dn.toHexString(dn.U)+">"),z("/O <"+dn.toHexString(dn.O)+">"),z("/P "+dn.P),z(">>"),z("endobj")},Mt=function(){for(var A in z("/Font <<"),nt)nt.hasOwnProperty(A)&&(y===!1||y===!0&&g.hasOwnProperty(A))&&z("/"+A+" "+nt[A].objectNumber+" 0 R");z(">>")},yn=function(){if(Object.keys(lt).length>0){for(var A in z("/Shading <<"),lt)lt.hasOwnProperty(A)&&lt[A]instanceof fa&&lt[A].objectNumber>=0&&z("/"+A+" "+lt[A].objectNumber+" 0 R");Ot.publish("putShadingPatternDict"),z(">>")}},gn=function(A){if(Object.keys(lt).length>0){for(var me in z("/Pattern <<"),lt)lt.hasOwnProperty(me)&&lt[me]instanceof f.TilingPattern&&lt[me].objectNumber>=0&&lt[me].objectNumber<A&&z("/"+me+" "+lt[me].objectNumber+" 0 R");Ot.publish("putTilingPatternDict"),z(">>")}},En=function(){if(Object.keys(_t).length>0){var A;for(A in z("/ExtGState <<"),_t)_t.hasOwnProperty(A)&&_t[A].objectNumber>=0&&z("/"+A+" "+_t[A].objectNumber+" 0 R");Ot.publish("putGStateDict"),z(">>")}},Nr=function(A){yt(A.resourcesOid,!0),z("<<"),z("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Mt(),yn(),gn(A.objectOid),En(),kr(),z(">>"),z("endobj")},On=function(){var A=[];Zt(),Tr(),ir(),cr(A),Ot.publish("putResources"),A.forEach(Nr),Nr({resourcesOid:Je,objectOid:Number.MAX_SAFE_INTEGER}),Ot.publish("postPutResources")},bi=function(){Ot.publish("putAdditionalObjects");for(var A=0;A<te.length;A++){var me=te[A];yt(me.objId,!0),z(me.content),z("endobj")}Ot.publish("postPutAdditionalObjects")},_i=function(A){Ye[A.fontName]=Ye[A.fontName]||{},Ye[A.fontName][A.fontStyle]=A.id},hr=function(A,me,Ne,Me,Ue){var ot={id:"F"+(Object.keys(nt).length+1).toString(10),postScriptName:A,fontName:me,fontStyle:Ne,encoding:Me,isStandardFont:Ue||!1,metadata:{}};return Ot.publish("addFont",{font:ot,instance:this}),nt[ot.id]=ot,_i(ot),ot.id},Lr=function(A){for(var me=0,Ne=ue.length;me<Ne;me++){var Me=hr.call(this,A[me][0],A[me][1],A[me][2],ue[me][3],!0);y===!1&&(g[Me]=!0);var Ue=A[me][0].split("-");_i({id:Me,fontName:Ue[0],fontStyle:Ue[1]||""})}Ot.publish("addFonts",{fonts:nt,dictionary:Ye})},jr=function(A){return A.foo=function(){try{return A.apply(this,arguments)}catch(Me){var me=Me.stack||"";~me.indexOf(" at ")&&(me=me.split(" at ")[1]);var Ne="Error in function "+me.split(`
`)[0].split("<")[0]+": "+Me.message;if(!fr.console)throw new Error(Ne);fr.console.error(Ne,Me),fr.alert&&alert(Ne)}},A.foo.bar=A,A.foo},fn=function(A,me){var Ne,Me,Ue,ot,xt,jt,p,B,ae;if(Ue=(me=me||{}).sourceEncoding||"Unicode",xt=me.outputEncoding,(me.autoencode||xt)&&nt[Ke].metadata&&nt[Ke].metadata[Ue]&&nt[Ke].metadata[Ue].encoding&&(ot=nt[Ke].metadata[Ue].encoding,!xt&&nt[Ke].encoding&&(xt=nt[Ke].encoding),!xt&&ot.codePages&&(xt=ot.codePages[0]),typeof xt=="string"&&(xt=ot[xt]),xt)){for(p=!1,jt=[],Ne=0,Me=A.length;Ne<Me;Ne++)(B=xt[A.charCodeAt(Ne)])?jt.push(String.fromCharCode(B)):jt.push(A[Ne]),jt[Ne].charCodeAt(0)>>8&&(p=!0);A=jt.join("")}for(Ne=A.length;p===void 0&&Ne!==0;)A.charCodeAt(Ne-1)>>8&&(p=!0),Ne--;if(!p)return A;for(jt=me.noBOM?[]:[254,255],Ne=0,Me=A.length;Ne<Me;Ne++){if((ae=(B=A.charCodeAt(Ne))>>8)>>8)throw new Error("Character at position "+Ne+" of string '"+A+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");jt.push(ae),jt.push(B-(ae<<8))}return String.fromCharCode.apply(void 0,jt)},Gr=f.__private__.pdfEscape=f.pdfEscape=function(A,me){return fn(A,me).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Br=f.__private__.beginPage=function(A){ee[++Nt]=[],wt[Nt]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(A[0]),topRightY:Number(A[1])}},Si(Nt),oe(ee[D])},Wn=function(A,me){var Ne,Me,Ue;switch(r=me||r,typeof A=="string"&&(Ne=$(A.toLowerCase()),Array.isArray(Ne)&&(Me=Ne[0],Ue=Ne[1])),Array.isArray(A)&&(Me=A[0]*je,Ue=A[1]*je),isNaN(Me)&&(Me=i[0],Ue=i[1]),(Me>14400||Ue>14400)&&(sn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Me=Math.min(14400,Me),Ue=Math.min(14400,Ue)),i=[Me,Ue],r.substr(0,1)){case"l":Ue>Me&&(i=[Ue,Me]);break;case"p":Me>Ue&&(i=[Ue,Me])}Br(i),Va(ja),z(Yn),Ua!==0&&z(Ua+" J"),Vs!==0&&z(Vs+" j"),Ot.publish("addPage",{pageNumber:Nt})},ri=function(A){A>0&&A<=Nt&&(ee.splice(A,1),wt.splice(A,1),Nt--,D>Nt&&(D=Nt),this.setPage(D))},Si=function(A){A>0&&A<=Nt&&(D=A)},qr=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return ee.length-1},Vi=function(A,me,Ne){var Me,Ue=void 0;return Ne=Ne||{},A=A!==void 0?A:nt[Ke].fontName,me=me!==void 0?me:nt[Ke].fontStyle,Me=A.toLowerCase(),Ye[Me]!==void 0&&Ye[Me][me]!==void 0?Ue=Ye[Me][me]:Ye[A]!==void 0&&Ye[A][me]!==void 0?Ue=Ye[A][me]:Ne.disableWarning===!1&&sn.warn("Unable to look up font label for font '"+A+"', '"+me+"'. Refer to getFontList() for available fonts."),Ue||Ne.noFallback||(Ue=Ye.times[me])==null&&(Ue=Ye.times.normal),Ue},Pi=f.__private__.putInfo=function(){var A=rr(),me=function(Me){return Me};for(var Ne in h!==null&&(me=dn.encryptor(A,0)),z("<<"),z("/Producer ("+Gr(me("jsPDF "+dr.version))+")"),Re)Re.hasOwnProperty(Ne)&&Re[Ne]&&z("/"+Ne.substr(0,1).toUpperCase()+Ne.substr(1)+" ("+Gr(me(Re[Ne]))+")");z("/CreationDate ("+Gr(me(K))+")"),z(">>"),z("endobj")},wi=f.__private__.putCatalog=function(A){var me=(A=A||{}).rootDictionaryObjId||Jt;switch(rr(),z("<<"),z("/Type /Catalog"),z("/Pages "+me+" 0 R"),xe||(xe="fullwidth"),xe){case"fullwidth":z("/OpenAction [3 0 R /FitH null]");break;case"fullheight":z("/OpenAction [3 0 R /FitV null]");break;case"fullpage":z("/OpenAction [3 0 R /Fit]");break;case"original":z("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ne=""+xe;Ne.substr(Ne.length-1)==="%"&&(xe=parseInt(xe)/100),typeof xe=="number"&&z("/OpenAction [3 0 R /XYZ null null "+j(xe)+"]")}switch(Te||(Te="continuous"),Te){case"continuous":z("/PageLayout /OneColumn");break;case"single":z("/PageLayout /SinglePage");break;case"two":case"twoleft":z("/PageLayout /TwoColumnLeft");break;case"tworight":z("/PageLayout /TwoColumnRight")}Le&&z("/PageMode /"+Le),Ot.publish("putCatalog"),z(">>"),z("endobj")},Nc=f.__private__.putTrailer=function(){z("trailer"),z("<<"),z("/Size "+(F+1)),z("/Root "+F+" 0 R"),z("/Info "+(F-1)+" 0 R"),h!==null&&z("/Encrypt "+dn.oid+" 0 R"),z("/ID [ <"+k+"> <"+k+"> ]"),z(">>")},Tl=f.__private__.putHeader=function(){z("%PDF-"+x),z("%ºß¬à")},Lc=f.__private__.putXRef=function(){var A="0000000000";z("xref"),z("0 "+(F+1)),z("0000000000 65535 f ");for(var me=1;me<=F;me++)typeof Q[me]=="function"?z((A+Q[me]()).slice(-10)+" 00000 n "):Q[me]!==void 0?z((A+Q[me]).slice(-10)+" 00000 n "):z("0000000000 00000 n ")},ho=f.__private__.buildDocument=function(){ce(),oe(H),Ot.publish("buildDocument"),Tl(),Xt(),bi(),On(),h!==null&&lr(),Pi(),wi();var A=J;return Lc(),Nc(),z("startxref"),z(""+A),z("%%EOF"),oe(ee[D]),H.join(`
`)},Ns=f.__private__.getBlob=function(A){return new Blob([fe(A)],{type:"application/pdf"})},Ls=f.output=f.__private__.output=jr(function(A,me){switch(typeof(me=me||{})=="string"?me={filename:me}:me.filename=me.filename||"generated.pdf",A){case void 0:return ho();case"save":f.save(me.filename);break;case"arraybuffer":return fe(ho());case"blob":return Ns(ho());case"bloburi":case"bloburl":if(fr.URL!==void 0&&typeof fr.URL.createObjectURL=="function")return fr.URL&&fr.URL.createObjectURL(Ns(ho()))||void 0;sn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ne="",Me=ho();try{Ne=Em(Me)}catch{Ne=Em(unescape(encodeURIComponent(Me)))}return"data:application/pdf;filename="+me.filename+";base64,"+Ne;case"pdfobjectnewwindow":if(Object.prototype.toString.call(fr)==="[object Window]"){var Ue="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ot=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';me.pdfObjectUrl&&(Ue=me.pdfObjectUrl,ot="");var xt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ue+'"'+ot+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(me)+");<\/script></body></html>",jt=fr.open();return jt!==null&&jt.document.write(xt),jt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(fr)==="[object Window]"){var p='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(me.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+me.filename+'" width="500px" height="400px" /></body></html>',B=fr.open();if(B!==null){B.document.write(p);var ae=this;B.document.documentElement.querySelector("#pdfViewer").onload=function(){B.document.title=me.filename,B.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ae.output("bloburl"))}}return B}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(fr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Pe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",me)+'"></iframe></body></html>',qe=fr.open();if(qe!==null&&(qe.document.write(Pe),qe.document.title=me.filename),qe||typeof safari>"u")return qe;break;case"datauri":case"dataurl":return fr.document.location.href=this.output("datauristring",me);default:return null}}),No=function(A){return Array.isArray(gr)===!0&&gr.indexOf(A)>-1};switch(n){case"pt":je=1;break;case"mm":je=72/25.4;break;case"cm":je=72/2.54;break;case"in":je=72;break;case"px":je=No("px_scaling")==1?.75:96/72;break;case"pc":case"em":je=12;break;case"ex":je=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);je=n}var dn=null;le(),Y();var kl=function(A){return h!==null?dn.encryptor(A,0):function(me){return me}},Fa=f.__private__.getPageInfo=f.getPageInfo=function(A){if(isNaN(A)||A%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:wt[A].objId,pageNumber:A,pageContext:wt[A]}},vr=f.__private__.getPageInfoByObjId=function(A){if(isNaN(A)||A%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var me in wt)if(wt[me].objId===A)break;return Fa(me)},Lo=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:wt[D].objId,pageNumber:D,pageContext:wt[D]}};f.addPage=function(){return Wn.apply(this,arguments),this},f.setPage=function(){return Si.apply(this,arguments),oe.call(this,ee[D]),this},f.insertPage=function(A){return this.addPage(),this.movePage(D,A),this},f.movePage=function(A,me){var Ne,Me;if(A>me){Ne=ee[A],Me=wt[A];for(var Ue=A;Ue>me;Ue--)ee[Ue]=ee[Ue-1],wt[Ue]=wt[Ue-1];ee[me]=Ne,wt[me]=Me,this.setPage(me)}else if(A<me){Ne=ee[A],Me=wt[A];for(var ot=A;ot<me;ot++)ee[ot]=ee[ot+1],wt[ot]=wt[ot+1];ee[me]=Ne,wt[me]=Me,this.setPage(me)}return this},f.deletePage=function(){return ri.apply(this,arguments),this},f.__private__.text=f.text=function(A,me,Ne,Me,Ue){var ot,xt,jt,p,B,ae,Pe,qe,et,At=(Me=Me||{}).scope||this;if(typeof A=="number"&&typeof me=="number"&&(typeof Ne=="string"||Array.isArray(Ne))){var Pr=Ne;Ne=me,me=A,A=Pr}if(arguments[3]instanceof tt?(C("The transform parameter of text() with a Matrix value"),et=Ue):(jt=arguments[4],p=arguments[5],tn(Pe=arguments[3])==="object"&&Pe!==null||(typeof jt=="string"&&(p=jt,jt=null),typeof Pe=="string"&&(p=Pe,Pe=null),typeof Pe=="number"&&(jt=Pe,Pe=null),Me={flags:Pe,angle:jt,align:p})),isNaN(me)||isNaN(Ne)||A==null)throw new Error("Invalid arguments passed to jsPDF.text");if(A.length===0)return At;var Rr="",wr=!1,Qr=typeof Me.lineHeightFactor=="number"?Me.lineHeightFactor:Jr,nn=At.internal.scaleFactor;function go(ln){return ln=ln.split("	").join(Array(Me.TabLen||9).join(" ")),Gr(ln,Pe)}function Kn(ln){for(var cn,wn=ln.concat(),jn=[],us=wn.length;us--;)typeof(cn=wn.shift())=="string"?jn.push(cn):Array.isArray(ln)&&(cn.length===1||cn[1]===void 0&&cn[2]===void 0)?jn.push(cn[0]):jn.push([cn[0],cn[1],cn[2]]);return jn}function Fo(ln,cn){var wn;if(typeof ln=="string")wn=cn(ln)[0];else if(Array.isArray(ln)){for(var jn,us,qc=ln.concat(),Ul=[],cd=qc.length;cd--;)typeof(jn=qc.shift())=="string"?Ul.push(cn(jn)[0]):Array.isArray(jn)&&typeof jn[0]=="string"&&(us=cn(jn[0],jn[1],jn[2]),Ul.push([us[0],us[1],us[2]]));wn=Ul}return wn}var Oo=!1,Dc=!0;if(typeof A=="string")Oo=!0;else if(Array.isArray(A)){var Mc=A.concat();xt=[];for(var Ml,Jn=Mc.length;Jn--;)(typeof(Ml=Mc.shift())!="string"||Array.isArray(Ml)&&typeof Ml[0]!="string")&&(Dc=!1);Oo=Dc}if(Oo===!1)throw new Error('Type of text must be string or Array. "'+A+'" is not recognized.');typeof A=="string"&&(A=A.match(/[\r?\n]/)?A.split(/\r\n|\r|\n/g):[A]);var Fl=ge/At.internal.scaleFactor,Ol=Fl*(Qr-1);switch(Me.baseline){case"bottom":Ne-=Ol;break;case"top":Ne+=Fl-Ol;break;case"hanging":Ne+=Fl-2*Ol;break;case"middle":Ne+=Fl/2-Ol}if((ae=Me.maxWidth||0)>0&&(typeof A=="string"?A=At.splitTextToSize(A,ae):Object.prototype.toString.call(A)==="[object Array]"&&(A=A.reduce(function(ln,cn){return ln.concat(At.splitTextToSize(cn,ae))},[]))),ot={text:A,x:me,y:Ne,options:Me,mutex:{pdfEscape:Gr,activeFontKey:Ke,fonts:nt,activeFontSize:ge}},Ot.publish("preProcessText",ot),A=ot.text,jt=(Me=ot.options).angle,!(et instanceof tt)&&jt&&typeof jt=="number"){jt*=Math.PI/180,Me.rotationDirection===0&&(jt=-jt),se===U.ADVANCED&&(jt=-jt);var Bl=Math.cos(jt),Fc=Math.sin(jt);et=new tt(Bl,Fc,-Fc,Bl,0,0)}else jt&&jt instanceof tt&&(et=jt);se!==U.ADVANCED||et||(et=Vt),(B=Me.charSpace||is)!==void 0&&(Rr+=E(w(B))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(qe=Me.horizontalScale)!==void 0&&(Rr+=E(100*qe)+` Tz
`),Me.lang;var Ei=-1,_p=Me.renderingMode!==void 0?Me.renderingMode:Me.stroke,Oc=At.internal.getCurrentPageInfo().pageContext;switch(_p){case 0:case!1:case"fill":Ei=0;break;case 1:case!0:case"stroke":Ei=1;break;case 2:case"fillThenStroke":Ei=2;break;case 3:case"invisible":Ei=3;break;case 4:case"fillAndAddForClipping":Ei=4;break;case 5:case"strokeAndAddPathForClipping":Ei=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ei=6;break;case 7:case"addToPathForClipping":Ei=7}var od=Oc.usedRenderingMode!==void 0?Oc.usedRenderingMode:-1;Ei!==-1?Rr+=Ei+` Tr
`:od!==-1&&(Rr+=`0 Tr
`),Ei!==-1&&(Oc.usedRenderingMode=Ei),p=Me.align||"left";var Zi,jl=ge*Qr,sd=At.internal.pageSize.getWidth(),ad=nt[Ke];B=Me.charSpace||is,ae=Me.maxWidth||0,Pe=Object.assign({autoencode:!0,noBOM:!0},Me.flags);var Gs=[],Ha=function(ln){return At.getStringUnitWidth(ln,{font:ad,charSpace:B,fontSize:ge,doKerning:!1})*ge/nn};if(Object.prototype.toString.call(A)==="[object Array]"){var Ti;xt=Kn(A),p!=="left"&&(Zi=xt.map(Ha));var xi,Ws=0;if(p==="right"){me-=Zi[0],A=[],Jn=xt.length;for(var as=0;as<Jn;as++)as===0?(xi=Ui(me),Ti=Bn(Ne)):(xi=w(Ws-Zi[as]),Ti=-jl),A.push([xt[as],xi,Ti]),Ws=Zi[as]}else if(p==="center"){me-=Zi[0]/2,A=[],Jn=xt.length;for(var ls=0;ls<Jn;ls++)ls===0?(xi=Ui(me),Ti=Bn(Ne)):(xi=w((Ws-Zi[ls])/2),Ti=-jl),A.push([xt[ls],xi,Ti]),Ws=Zi[ls]}else if(p==="left"){A=[],Jn=xt.length;for(var Vl=0;Vl<Jn;Vl++)A.push(xt[Vl])}else if(p==="justify"&&ad.encoding==="Identity-H"){A=[],Jn=xt.length,ae=ae!==0?ae:sd;for(var cs=0,Pn=0;Pn<Jn;Pn++)if(Ti=Pn===0?Bn(Ne):-jl,xi=Pn===0?Ui(me):cs,Pn<Jn-1){var Bc=w((ae-Zi[Pn])/(xt[Pn].split(" ").length-1)),Ai=xt[Pn].split(" ");A.push([Ai[0]+" ",xi,Ti]),cs=0;for(var eo=1;eo<Ai.length;eo++){var ql=(Ha(Ai[eo-1]+" "+Ai[eo])-Ha(Ai[eo]))*nn+Bc;eo==Ai.length-1?A.push([Ai[eo],ql,0]):A.push([Ai[eo]+" ",ql,0]),cs-=ql}}else A.push([xt[Pn],xi,Ti]);A.push(["",cs,0])}else{if(p!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(A=[],Jn=xt.length,ae=ae!==0?ae:sd,Pn=0;Pn<Jn;Pn++)Ti=Pn===0?Bn(Ne):-jl,xi=Pn===0?Ui(me):0,Pn<Jn-1?Gs.push(E(w((ae-Zi[Pn])/(xt[Pn].split(" ").length-1)))):Gs.push(0),A.push([xt[Pn],xi,Ti])}}var ld=typeof Me.R2L=="boolean"?Me.R2L:_e;ld===!0&&(A=Fo(A,function(ln,cn,wn){return[ln.split("").reverse().join(""),cn,wn]})),ot={text:A,x:me,y:Ne,options:Me,mutex:{pdfEscape:Gr,activeFontKey:Ke,fonts:nt,activeFontSize:ge}},Ot.publish("postProcessText",ot),A=ot.text,wr=ot.mutex.isHex||!1;var jc=nt[Ke].encoding;jc!=="WinAnsiEncoding"&&jc!=="StandardEncoding"||(A=Fo(A,function(ln,cn,wn){return[go(ln),cn,wn]})),xt=Kn(A),A=[];for(var Ga,Wa,Ys,Ya=0,zl=1,Ka=Array.isArray(xt[0])?zl:Ya,Ks="",Vc=function(ln,cn,wn){var jn="";return wn instanceof tt?(wn=typeof Me.angle=="number"?ft(wn,new tt(1,0,0,1,ln,cn)):ft(new tt(1,0,0,1,ln,cn),wn),se===U.ADVANCED&&(wn=ft(new tt(1,0,0,-1,0,0),wn)),jn=wn.join(" ")+` Tm
`):jn=E(ln)+" "+E(cn)+` Td
`,jn},to=0;to<xt.length;to++){switch(Ks="",Ka){case zl:Ys=(wr?"<":"(")+xt[to][0]+(wr?">":")"),Ga=parseFloat(xt[to][1]),Wa=parseFloat(xt[to][2]);break;case Ya:Ys=(wr?"<":"(")+xt[to]+(wr?">":")"),Ga=Ui(me),Wa=Bn(Ne)}Gs!==void 0&&Gs[to]!==void 0&&(Ks=Gs[to]+` Tw
`),to===0?A.push(Ks+Vc(Ga,Wa,et)+Ys):Ka===Ya?A.push(Ks+Ys):Ka===zl&&A.push(Ks+Vc(Ga,Wa,et)+Ys)}A=Ka===Ya?A.join(` Tj
T* `):A.join(` Tj
`),A+=` Tj
`;var ro=`BT
/`;return ro+=Ke+" "+ge+` Tf
`,ro+=E(ge*Qr)+` TL
`,ro+=mo+`
`,ro+=Rr,ro+=A,z(ro+="ET"),g[Ke]=!0,At};var Rc=f.__private__.clip=f.clip=function(A){return z(A==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return Rc("evenodd")},f.__private__.discardPath=f.discardPath=function(){return z("n"),this};var Xi=f.__private__.isValidStyle=function(A){var me=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(A)!==-1&&(me=!0),me};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(A){return Xi(A)&&(u=A),this};var Nl=f.__private__.getStyle=f.getStyle=function(A){var me=u;switch(A){case"D":case"S":me="S";break;case"F":me="f";break;case"FD":case"DF":me="B";break;case"f":case"f*":case"B":case"B*":me=A}return me},qi=f.close=function(){return z("h"),this};f.stroke=function(){return z("S"),this},f.fill=function(A){return Rs("f",A),this},f.fillEvenOdd=function(A){return Rs("f*",A),this},f.fillStroke=function(A){return Rs("B",A),this},f.fillStrokeEvenOdd=function(A){return Rs("B*",A),this};var Rs=function(A,me){tn(me)==="object"?Ms(me,A):z(A)},Oa=function(A){A===null||se===U.ADVANCED&&A===void 0||(A=Nl(A),z(A))};function Ds(A,me,Ne,Me,Ue){var ot=new ul(me||this.boundingBox,Ne||this.xStep,Me||this.yStep,this.gState,Ue||this.matrix);ot.stream=this.stream;var xt=A+"$$"+this.cloneIndex+++"$$";return Rt(xt,ot),ot}var Ms=function(A,me){var Ne=$t[A.key],Me=lt[Ne];if(Me instanceof fa)z("q"),z(Ll(me)),Me.gState&&f.setGState(Me.gState),z(A.matrix.toString()+" cm"),z("/"+Ne+" sh"),z("Q");else if(Me instanceof ul){var Ue=new tt(1,0,0,-1,0,ni());A.matrix&&(Ue=Ue.multiply(A.matrix||Vt),Ne=Ds.call(Me,A.key,A.boundingBox,A.xStep,A.yStep,Ue).id),z("q"),z("/Pattern cs"),z("/"+Ne+" scn"),Me.gState&&f.setGState(Me.gState),z(me),z("Q")}},Ll=function(A){switch(A){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},po=f.moveTo=function(A,me){return z(E(w(A))+" "+E(W(me))+" m"),this},zi=f.lineTo=function(A,me){return z(E(w(A))+" "+E(W(me))+" l"),this},fo=f.curveTo=function(A,me,Ne,Me,Ue,ot){return z([E(w(A)),E(W(me)),E(w(Ne)),E(W(Me)),E(w(Ue)),E(W(ot)),"c"].join(" ")),this};f.__private__.line=f.line=function(A,me,Ne,Me,Ue){if(isNaN(A)||isNaN(me)||isNaN(Ne)||isNaN(Me)||!Xi(Ue))throw new Error("Invalid arguments passed to jsPDF.line");return se===U.COMPAT?this.lines([[Ne-A,Me-me]],A,me,[1,1],Ue||"S"):this.lines([[Ne-A,Me-me]],A,me,[1,1]).stroke()},f.__private__.lines=f.lines=function(A,me,Ne,Me,Ue,ot){var xt,jt,p,B,ae,Pe,qe,et,At,Pr,Rr,wr;if(typeof A=="number"&&(wr=Ne,Ne=me,me=A,A=wr),Me=Me||[1,1],ot=ot||!1,isNaN(me)||isNaN(Ne)||!Array.isArray(A)||!Array.isArray(Me)||!Xi(Ue)||typeof ot!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(po(me,Ne),xt=Me[0],jt=Me[1],B=A.length,Pr=me,Rr=Ne,p=0;p<B;p++)(ae=A[p]).length===2?(Pr=ae[0]*xt+Pr,Rr=ae[1]*jt+Rr,zi(Pr,Rr)):(Pe=ae[0]*xt+Pr,qe=ae[1]*jt+Rr,et=ae[2]*xt+Pr,At=ae[3]*jt+Rr,Pr=ae[4]*xt+Pr,Rr=ae[5]*jt+Rr,fo(Pe,qe,et,At,Pr,Rr));return ot&&qi(),Oa(Ue),this},f.path=function(A){for(var me=0;me<A.length;me++){var Ne=A[me],Me=Ne.c;switch(Ne.op){case"m":po(Me[0],Me[1]);break;case"l":zi(Me[0],Me[1]);break;case"c":fo.apply(this,Me);break;case"h":qi()}}return this},f.__private__.rect=f.rect=function(A,me,Ne,Me,Ue){if(isNaN(A)||isNaN(me)||isNaN(Ne)||isNaN(Me)||!Xi(Ue))throw new Error("Invalid arguments passed to jsPDF.rect");return se===U.COMPAT&&(Me=-Me),z([E(w(A)),E(W(me)),E(w(Ne)),E(w(Me)),"re"].join(" ")),Oa(Ue),this},f.__private__.triangle=f.triangle=function(A,me,Ne,Me,Ue,ot,xt){if(isNaN(A)||isNaN(me)||isNaN(Ne)||isNaN(Me)||isNaN(Ue)||isNaN(ot)||!Xi(xt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ne-A,Me-me],[Ue-Ne,ot-Me],[A-Ue,me-ot]],A,me,[1,1],xt,!0),this},f.__private__.roundedRect=f.roundedRect=function(A,me,Ne,Me,Ue,ot,xt){if(isNaN(A)||isNaN(me)||isNaN(Ne)||isNaN(Me)||isNaN(Ue)||isNaN(ot)||!Xi(xt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var jt=4/3*(Math.SQRT2-1);return Ue=Math.min(Ue,.5*Ne),ot=Math.min(ot,.5*Me),this.lines([[Ne-2*Ue,0],[Ue*jt,0,Ue,ot-ot*jt,Ue,ot],[0,Me-2*ot],[0,ot*jt,-Ue*jt,ot,-Ue,ot],[2*Ue-Ne,0],[-Ue*jt,0,-Ue,-ot*jt,-Ue,-ot],[0,2*ot-Me],[0,-ot*jt,Ue*jt,-ot,Ue,-ot]],A+Ue,me,[1,1],xt,!0),this},f.__private__.ellipse=f.ellipse=function(A,me,Ne,Me,Ue){if(isNaN(A)||isNaN(me)||isNaN(Ne)||isNaN(Me)||!Xi(Ue))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ot=4/3*(Math.SQRT2-1)*Ne,xt=4/3*(Math.SQRT2-1)*Me;return po(A+Ne,me),fo(A+Ne,me-xt,A+ot,me-Me,A,me-Me),fo(A-ot,me-Me,A-Ne,me-xt,A-Ne,me),fo(A-Ne,me+xt,A-ot,me+Me,A,me+Me),fo(A+ot,me+Me,A+Ne,me+xt,A+Ne,me),Oa(Ue),this},f.__private__.circle=f.circle=function(A,me,Ne,Me){if(isNaN(A)||isNaN(me)||isNaN(Ne)||!Xi(Me))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(A,me,Ne,Ne,Me)},f.setFont=function(A,me,Ne){return Ne&&(me=re(me,Ne)),Ke=Vi(A,me,{disableWarning:!1}),this};var Ba=f.__private__.getFont=f.getFont=function(){return nt[Vi.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var A,me,Ne={};for(A in Ye)if(Ye.hasOwnProperty(A))for(me in Ne[A]=[],Ye[A])Ye[A].hasOwnProperty(me)&&Ne[A].push(me);return Ne},f.addFont=function(A,me,Ne,Me,Ue){var ot=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ot.indexOf(arguments[3])!==-1?Ue=arguments[3]:arguments[3]&&ot.indexOf(arguments[3])==-1&&(Ne=re(Ne,Me)),Ue=Ue||"Identity-H",hr.call(this,A,me,Ne,Ue)};var Jr,ja=t.lineWidth||.200025,Fs=f.__private__.getLineWidth=f.getLineWidth=function(){return ja},Va=f.__private__.setLineWidth=f.setLineWidth=function(A){return ja=A,z(E(w(A))+" w"),this};f.__private__.setLineDash=dr.API.setLineDash=dr.API.setLineDashPattern=function(A,me){if(A=A||[],me=me||0,isNaN(me)||!Array.isArray(A))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return A=A.map(function(Ne){return E(w(Ne))}).join(" "),me=E(w(me)),z("["+A+"] "+me+" d"),this};var qa=f.__private__.getLineHeight=f.getLineHeight=function(){return ge*Jr};f.__private__.getLineHeight=f.getLineHeight=function(){return ge*Jr};var za=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(A){return typeof(A=A||1.15)=="number"&&(Jr=A),this},ns=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return Jr};za(t.lineHeight);var Ui=f.__private__.getHorizontalCoordinate=function(A){return w(A)},Bn=f.__private__.getVerticalCoordinate=function(A){return se===U.ADVANCED?A:wt[D].mediaBox.topRightY-wt[D].mediaBox.bottomLeftY-w(A)},Rl=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(A){return E(Ui(A))},Ro=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(A){return E(Bn(A))},Yn=t.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return Et(Yn)},f.__private__.setStrokeColor=f.setDrawColor=function(A,me,Ne,Me){return Yn=Wt({ch1:A,ch2:me,ch3:Ne,ch4:Me,pdfColorType:"draw",precision:2}),z(Yn),this};var Os=t.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return Et(Os)},f.__private__.setFillColor=f.setFillColor=function(A,me,Ne,Me){return Os=Wt({ch1:A,ch2:me,ch3:Ne,ch4:Me,pdfColorType:"fill",precision:2}),z(Os),this};var mo=t.textColor||"0 g",Bs=f.__private__.getTextColor=f.getTextColor=function(){return Et(mo)};f.__private__.setTextColor=f.setTextColor=function(A,me,Ne,Me){return mo=Wt({ch1:A,ch2:me,ch3:Ne,ch4:Me,pdfColorType:"text",precision:3}),this};var is=t.charSpace,js=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(is||0)};f.__private__.setCharSpace=f.setCharSpace=function(A){if(isNaN(A))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return is=A,this};var Ua=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(A){var me=f.CapJoinStyles[A];if(me===void 0)throw new Error("Line cap style of '"+A+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ua=me,z(me+" J"),this};var Vs=0;f.__private__.setLineJoin=f.setLineJoin=function(A){var me=f.CapJoinStyles[A];if(me===void 0)throw new Error("Line join style of '"+A+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Vs=me,z(me+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(A){if(A=A||0,isNaN(A))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return z(E(w(A))+" M"),this},f.GState=zu,f.setGState=function(A){(A=typeof A=="string"?_t[ze[A]]:Do(null,A)).equals(Lt)||(z("/"+A.id+" gs"),Lt=A)};var Do=function(A,me){if(!A||!ze[A]){var Ne=!1;for(var Me in _t)if(_t.hasOwnProperty(Me)&&_t[Me].equals(me)){Ne=!0;break}if(Ne)me=_t[Me];else{var Ue="GS"+(Object.keys(_t).length+1).toString(10);_t[Ue]=me,me.id=Ue}return A&&(ze[A]=me.id),Ot.publish("addGState",me),me}};f.addGState=function(A,me){return Do(A,me),this},f.saveGraphicsState=function(){return z("q"),ht.push({key:Ke,size:ge,color:mo}),this},f.restoreGraphicsState=function(){z("Q");var A=ht.pop();return Ke=A.key,ge=A.size,mo=A.color,Lt=null,this},f.setCurrentTransformationMatrix=function(A){return z(A.toString()+" cm"),this},f.comment=function(A){return z("#"+A),this};var os=function(A,me){var Ne=A||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ne},set:function(ot){isNaN(ot)||(Ne=parseFloat(ot))}});var Me=me||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Me},set:function(ot){isNaN(ot)||(Me=parseFloat(ot))}});var Ue="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ue},set:function(ot){Ue=ot.toString()}}),this},qs=function(A,me,Ne,Me){os.call(this,A,me),this.type="rect";var Ue=Ne||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ue},set:function(xt){isNaN(xt)||(Ue=parseFloat(xt))}});var ot=Me||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ot},set:function(xt){isNaN(xt)||(ot=parseFloat(xt))}}),this},ss=function(){this.page=Nt,this.currentPage=D,this.pages=ee.slice(0),this.pagesContext=wt.slice(0),this.x=We,this.y=Qe,this.matrix=at,this.width=Mo(D),this.height=ni(D),this.outputDestination=G,this.id="",this.objectNumber=-1};ss.prototype.restore=function(){Nt=this.page,D=this.currentPage,wt=this.pagesContext,ee=this.pages,We=this.x,Qe=this.y,at=this.matrix,Us(D,this.width),Hs(D,this.height),G=this.outputDestination};var zs=function(A,me,Ne,Me,Ue){Ct.push(new ss),Nt=D=0,ee=[],We=A,Qe=me,at=Ue,Br([Ne,Me])},Dl=function(A){if(Pt[A])Ct.pop().restore();else{var me=new ss,Ne="Xo"+(Object.keys(Be).length+1).toString(10);me.id=Ne,Pt[A]=Ne,Be[Ne]=me,Ot.publish("addFormObject",me),Ct.pop().restore()}};for(var yo in f.beginFormObject=function(A,me,Ne,Me,Ue){return zs(A,me,Ne,Me,Ue),this},f.endFormObject=function(A){return Dl(A),this},f.doFormObject=function(A,me){var Ne=Be[Pt[A]];return z("q"),z(me.toString()+" cm"),z("/"+Ne.id+" Do"),z("Q"),this},f.getFormObject=function(A){var me=Be[Pt[A]];return{x:me.x,y:me.y,width:me.width,height:me.height,matrix:me.matrix}},f.save=function(A,me){return A=A||"generated.pdf",(me=me||{}).returnPromise=me.returnPromise||!1,me.returnPromise===!1?(rl(Ns(ho()),A),typeof rl.unload=="function"&&fr.setTimeout&&setTimeout(rl.unload,911),this):new Promise(function(Ne,Me){try{var Ue=rl(Ns(ho()),A);typeof rl.unload=="function"&&fr.setTimeout&&setTimeout(rl.unload,911),Ne(Ue)}catch(ot){Me(ot.message)}})},dr.API)dr.API.hasOwnProperty(yo)&&(yo==="events"&&dr.API.events.length?function(A,me){var Ne,Me,Ue;for(Ue=me.length-1;Ue!==-1;Ue--)Ne=me[Ue][0],Me=me[Ue][1],A.subscribe.apply(A,[Ne].concat(typeof Me=="function"?[Me]:Me))}(Ot,dr.API.events):f[yo]=dr.API[yo]);var Mo=f.getPageWidth=function(A){return(wt[A=A||D].mediaBox.topRightX-wt[A].mediaBox.bottomLeftX)/je},Us=f.setPageWidth=function(A,me){wt[A].mediaBox.topRightX=me*je+wt[A].mediaBox.bottomLeftX},ni=f.getPageHeight=function(A){return(wt[A=A||D].mediaBox.topRightY-wt[A].mediaBox.bottomLeftY)/je},Hs=f.setPageHeight=function(A,me){wt[A].mediaBox.topRightY=me*je+wt[A].mediaBox.bottomLeftY};return f.internal={pdfEscape:Gr,getStyle:Nl,getFont:Ba,getFontSize:pe,getCharSpace:js,getTextColor:Bs,getLineHeight:qa,getLineHeightFactor:ns,getLineWidth:Fs,write:de,getHorizontalCoordinate:Ui,getVerticalCoordinate:Bn,getCoordinateString:Rl,getVerticalCoordinateString:Ro,collections:{},newObject:rr,newAdditionalObject:It,newObjectDeferred:it,newObjectDeferredBegin:yt,getFilters:Yt,putStream:er,events:Ot,scaleFactor:je,pageSize:{getWidth:function(){return Mo(D)},setWidth:function(A){Us(D,A)},getHeight:function(){return ni(D)},setHeight:function(A){Hs(D,A)}},encryptionOptions:h,encryption:dn,getEncryptor:kl,output:Ls,getNumberOfPages:qr,pages:ee,out:z,f2:j,f3:b,getPageInfo:Fa,getPageInfoByObjId:vr,getCurrentPageInfo:Lo,getPDFVersion:S,Point:os,Rectangle:qs,Matrix:tt,hasHotfix:No},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return Mo(D)},set:function(A){Us(D,A)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return ni(D)},set:function(A){Hs(D,A)},enumerable:!0,configurable:!0}),Lr.call(f,ue),Ke="F1",Wn(i,r),Ot.publish("initialized"),f}ac.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},ac.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},ac.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},ac.prototype.processOwnerPassword=function(t,e){return km(Tm(e).substr(0,5),t)},ac.prototype.encryptor=function(t,e){var r=Tm(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return km(r,n)}},zu.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||tn(t)!==tn(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},dr.API={events:[]},dr.version="3.0.1";var bn=dr.API,Wy=1,El=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Zl=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},xr=function(t){return t.toFixed(2)},ca=function(t){return t.toFixed(5)};bn.__acroform__={};var ji=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},G0=function(t){return t*Wy},qo=function(t){var e=new Y5,r=Qt.internal.getHeight(t)||0,n=Qt.internal.getWidth(t)||0;return e.BBox=[0,0,Number(xr(n)),Number(xr(r))],e},ML=bn.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},FL=bn.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},OL=bn.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(t&1<<e)==0?0:1},An=bn.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return OL(t,e-1)},Cn=bn.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return ML(t,e-1)},In=bn.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return FL(t,e-1)},BL=bn.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],o=t[1],s=t[2],l=t[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(o+l)||0,c.upperRight_X=r(i+s)||0,c.upperRight_Y=n(o)||0,[Number(xr(c.lowerLeft_X)),Number(xr(c.lowerLeft_Y)),Number(xr(c.upperRight_X)),Number(xr(c.upperRight_Y))]},jL=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=Nm(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+xr(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var o=qo(t);return o.scope=t.scope,o.stream=e.join(`
`),o}},Nm=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(b){return b.split(`
`)}):i.map(function(b){return[b]});var o=r,s=Qt.internal.getHeight(t)||0;s=s<0?-s:s;var l=Qt.internal.getWidth(t)||0;l=l<0?-l:l;var c=function(b,w,_){if(b+1<i.length){var W=w+" "+i[b+1][0];return Yd(W,t,_).width<=l-4}return!1};o++;e:for(;o>0;){e="",o--;var u,h,y=Yd("3",t,o).height,g=t.multiline?s-o:(s-y)/2,f=g+=2,x=0,S=0,P=0;if(o<=0){e=`(...) Tj
`,e+="% Width of Text: "+Yd(e,t,o=12).width+", FieldWidth:"+l+`
`;break}for(var $="",U=0,se=0;se<i.length;se++)if(i.hasOwnProperty(se)){var X=!1;if(i[se].length!==1&&P!==i[se].length-1){if((y+2)*(U+2)+2>s)continue e;$+=i[se][P],X=!0,S=se,se--}else{$=($+=i[se][P]+" ").substr($.length-1)==" "?$.substr(0,$.length-1):$;var Z=parseInt(se),re=c(Z,$,o),E=se>=i.length-1;if(re&&!E){$+=" ",P=0;continue}if(re||E){if(E)S=Z;else if(t.multiline&&(y+2)*(U+2)+2>s)continue e}else{if(!t.multiline||(y+2)*(U+2)+2>s)continue e;S=Z}}for(var C="",T=x;T<=S;T++){var j=i[T];if(t.multiline){if(T===S){C+=j[P]+" ",P=(P+1)%j.length;continue}if(T===x){C+=j[j.length-1]+" ";continue}}C+=j[0]+" "}switch(C=C.substr(C.length-1)==" "?C.substr(0,C.length-1):C,h=Yd(C,t,o).width,t.textAlign){case"right":u=l-h-2;break;case"center":u=(l-h)/2;break;case"left":default:u=2}e+=xr(u)+" "+xr(f)+` Td
`,e+="("+El(C)+`) Tj
`,e+=-xr(u)+` 0 Td
`,f=-(o+2),h=0,x=X?S:S+1,U++,$=""}break}return n.text=e,n.fontSize=o,n},Yd=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},VL={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},qL=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},zL=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var n=r,i=t[r];e.internal.newObjectDeferredBegin(i.objId,!0),tn(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete t[n]}},UL=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(To.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(VL)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Wy=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new K5,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];o.objId=void 0,o.hasAnnotation&&qL(o,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var o=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var l=n[s],c=[],u=l.Rect;if(l.Rect&&(l.Rect=BL(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Qt.createDefaultAppearanceStream(l),tn(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var h=jL(l);c.push({key:"AP",value:"<</N "+h+">>"}),i.internal.acroformPlugin.xForms.push(h)}if(l.appearanceStreamContent){var y="";for(var g in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(g)){var f=l.appearanceStreamContent[g];if(y+="/"+g+" ",y+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var s in f)if(f.hasOwnProperty(s)){var x=f[s];typeof x=="function"&&(x=x.call(i,l)),y+="/"+s+" "+x+" ",i.internal.acroformPlugin.xForms.indexOf(x)>=0||i.internal.acroformPlugin.xForms.push(x)}}else typeof(x=f)=="function"&&(x=x.call(i,l)),y+="/"+s+" "+x,i.internal.acroformPlugin.xForms.indexOf(x)>=0||i.internal.acroformPlugin.xForms.push(x);y+=">>"}c.push({key:"AP",value:`<<
`+y+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}o&&zL(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},W5=bn.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(s){return s};if(Array.isArray(t)){for(var i="[",o=0;o<t.length;o++)switch(o!==0&&(i+=" "),tn(t[o])){case"boolean":case"number":case"object":i+=t[o].toString();break;case"string":t[o].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+El(n(t[o].toString()))+")"):i+=t[o].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},If=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),t="("+El(n(t))+")"},Ho=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ho.prototype.toString=function(){return this.objId+" 0 R"},Ho.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},Ho.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:W5(i,this.objId,this.scope)}):i instanceof Ho?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var Y5=function(){Ho.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};ji(Y5,Ho);var K5=function(){Ho.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+El(r(t))+")"}},set:function(r){t=r}})};ji(K5,Ho);var To=function t(){Ho.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function($){if(isNaN($))throw new Error('Invalid value "'+$+'" for attribute F supplied.');e=$}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!An(e,3)},set:function($){$?this.F=Cn(e,3):this.F=In(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function($){if(isNaN($))throw new Error('Invalid value "'+$+'" for attribute Ff supplied.');r=$}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function($){n=$!==void 0?$:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function($){n[0]=$}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function($){n[1]=$}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function($){n[2]=$}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function($){n[3]=$}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function($){switch($){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=$;break;default:throw new Error('Invalid value "'+$+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof Uh)return;o="FieldObject"+t.FieldNum++}var $=function(U){return U};return this.scope&&($=this.scope.internal.getEncryptor(this.objId)),"("+El($(o))+")"},set:function($){o=$.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function($){o=$}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function($){s=$}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function($){l=$}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function($){c=$}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/Wy:u},set:function($){u=$}});var h="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return h},set:function($){h=$}});var y="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!y||this instanceof Uh||this instanceof xa))return If(y,this.objId,this.scope)},set:function($){$=$.toString(),y=$}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof qn?g:If(g,this.objId,this.scope)},set:function($){$=$.toString(),g=this instanceof qn?$:$.substr(0,1)==="("?Zl($.substr(1,$.length-2)):Zl($)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof qn?Zl(g.substr(1,g.length-1)):g},set:function($){$=$.toString(),g=this instanceof qn?"/"+$:$}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function($){this.V=$}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof qn?f:If(f,this.objId,this.scope)},set:function($){$=$.toString(),f=this instanceof qn?$:$.substr(0,1)==="("?Zl($.substr(1,$.length-2)):Zl($)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof qn?Zl(f.substr(1,f.length-1)):f},set:function($){$=$.toString(),f=this instanceof qn?"/"+$:$}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var x,S=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return S},set:function($){$=!!$,S=$}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(x)return x},set:function($){x=$}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,1)},set:function($){$?this.Ff=Cn(this.Ff,1):this.Ff=In(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,2)},set:function($){$?this.Ff=Cn(this.Ff,2):this.Ff=In(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,3)},set:function($){$?this.Ff=Cn(this.Ff,3):this.Ff=In(this.Ff,3)}});var P=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(P!==null)return P},set:function($){if([0,1,2].indexOf($)===-1)throw new Error('Invalid value "'+$+'" for attribute Q supplied.');P=$}}),Object.defineProperty(this,"textAlign",{get:function(){var $;switch(P){case 0:default:$="left";break;case 1:$="center";break;case 2:$="right"}return $},configurable:!0,enumerable:!0,set:function($){switch($){case"right":case 2:P=2;break;case"center":case 1:P=1;break;case"left":case 0:default:P=0}}})};ji(To,Ho);var ml=function(){To.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return W5(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(o,s,l){l||(l=1);for(var c,u=[];c=s.exec(o);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,18)},set:function(r){r?this.Ff=Cn(this.Ff,18):this.Ff=In(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Cn(this.Ff,19):this.Ff=In(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,20)},set:function(r){r?(this.Ff=Cn(this.Ff,20),e.sort()):this.Ff=In(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,22)},set:function(r){r?this.Ff=Cn(this.Ff,22):this.Ff=In(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,23)},set:function(r){r?this.Ff=Cn(this.Ff,23):this.Ff=In(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,27)},set:function(r){r?this.Ff=Cn(this.Ff,27):this.Ff=In(this.Ff,27)}}),this.hasAppearanceStream=!1};ji(ml,To);var yl=function(){ml.call(this),this.fontName="helvetica",this.combo=!1};ji(yl,ml);var gl=function(){yl.call(this),this.combo=!0};ji(gl,yl);var Su=function(){gl.call(this),this.edit=!0};ji(Su,gl);var qn=function(){To.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,15)},set:function(r){r?this.Ff=Cn(this.Ff,15):this.Ff=In(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,16)},set:function(r){r?this.Ff=Cn(this.Ff,16):this.Ff=In(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,17)},set:function(r){r?this.Ff=Cn(this.Ff,17):this.Ff=In(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,26)},set:function(r){r?this.Ff=Cn(this.Ff,26):this.Ff=In(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+El(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){tn(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};ji(qn,To);var Pu=function(){qn.call(this),this.pushButton=!0};ji(Pu,qn);var vl=function(){qn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};ji(vl,qn);var Uh=function(){var t,e;To.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var o,s=[];for(o in s.push("<<"),n)s.push("/"+o+" ("+El(i(n[o]))+")");return s.push(">>"),s.join(`
`)},set:function(i){tn(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Qt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ji(Uh,To),vl.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},vl.prototype.createOption=function(t){var e=new Uh;return e.Parent=this,e.optionName=t,this.Kids.push(e),HL.call(this.scope,e),e};var wu=function(){qn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Qt.CheckBox.createAppearanceStream()};ji(wu,qn);var xa=function(){To.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,13)},set:function(e){e?this.Ff=Cn(this.Ff,13):this.Ff=In(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,21)},set:function(e){e?this.Ff=Cn(this.Ff,21):this.Ff=In(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,23)},set:function(e){e?this.Ff=Cn(this.Ff,23):this.Ff=In(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,24)},set:function(e){e?this.Ff=Cn(this.Ff,24):this.Ff=In(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,25)},set:function(e){e?this.Ff=Cn(this.Ff,25):this.Ff=In(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,26)},set:function(e){e?this.Ff=Cn(this.Ff,26):this.Ff=In(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ji(xa,To);var xu=function(){xa.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!An(this.Ff,14)},set:function(t){t?this.Ff=Cn(this.Ff,14):this.Ff=In(this.Ff,14)}}),this.password=!0};ji(xu,xa);var Qt={CheckBox:{createAppearanceStream:function(){return{N:{On:Qt.CheckBox.YesNormal},D:{On:Qt.CheckBox.YesPushDown,Off:Qt.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=qo(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),o=Nm(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+xr(Qt.internal.getWidth(t))+" "+xr(Qt.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+xr(o.fontSize)+" Tf "+i),r.push("BT"),r.push(o.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=qo(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],o=Qt.internal.getHeight(t),s=Qt.internal.getWidth(t),l=Nm(t,t.caption);return i.push("1 g"),i.push("0 0 "+xr(s)+" "+xr(o)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+xr(s-1)+" "+xr(o-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+xr(l.fontSize)+" Tf "+n),i.push(l.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=qo(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+xr(Qt.internal.getWidth(t))+" "+xr(Qt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Qt.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Qt.RadioButton.Circle.YesNormal,e.D[t]=Qt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=qo(t);e.scope=t.scope;var r=[],n=Qt.internal.getWidth(t)<=Qt.internal.getHeight(t)?Qt.internal.getWidth(t)/4:Qt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Qt.internal.Bezier_C,o=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+ca(Qt.internal.getWidth(t)/2)+" "+ca(Qt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=qo(t);e.scope=t.scope;var r=[],n=Qt.internal.getWidth(t)<=Qt.internal.getHeight(t)?Qt.internal.getWidth(t)/4:Qt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*Qt.internal.Bezier_C).toFixed(5)),s=Number((n*Qt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ca(Qt.internal.getWidth(t)/2)+" "+ca(Qt.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+ca(Qt.internal.getWidth(t)/2)+" "+ca(Qt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=qo(t);e.scope=t.scope;var r=[],n=Qt.internal.getWidth(t)<=Qt.internal.getHeight(t)?Qt.internal.getWidth(t)/4:Qt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),o=Number((i*Qt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ca(Qt.internal.getWidth(t)/2)+" "+ca(Qt.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+o+" "+o+" "+i+" 0 "+i+" c"),r.push("-"+o+" "+i+" -"+i+" "+o+" -"+i+" 0 c"),r.push("-"+i+" -"+o+" -"+o+" -"+i+" 0 -"+i+" c"),r.push(o+" -"+i+" "+i+" -"+o+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Qt.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Qt.RadioButton.Cross.YesNormal,e.D[t]=Qt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=qo(t);e.scope=t.scope;var r=[],n=Qt.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+xr(Qt.internal.getWidth(t)-2)+" "+xr(Qt.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(xr(n.x1.x)+" "+xr(n.x1.y)+" m"),r.push(xr(n.x2.x)+" "+xr(n.x2.y)+" l"),r.push(xr(n.x4.x)+" "+xr(n.x4.y)+" m"),r.push(xr(n.x3.x)+" "+xr(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=qo(t);e.scope=t.scope;var r=Qt.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+xr(Qt.internal.getWidth(t))+" "+xr(Qt.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+xr(Qt.internal.getWidth(t)-2)+" "+xr(Qt.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(xr(r.x1.x)+" "+xr(r.x1.y)+" m"),n.push(xr(r.x2.x)+" "+xr(r.x2.y)+" l"),n.push(xr(r.x4.x)+" "+xr(r.x4.y)+" m"),n.push(xr(r.x3.x)+" "+xr(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=qo(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+xr(Qt.internal.getWidth(t))+" "+xr(Qt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};Qt.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Qt.internal.getWidth(t),r=Qt.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},Qt.internal.getWidth=function(t){var e=0;return tn(t)==="object"&&(e=G0(t.Rect[2])),e},Qt.internal.getHeight=function(t){var e=0;return tn(t)==="object"&&(e=G0(t.Rect[3])),e};var HL=bn.addField=function(t){if(UL(this,t),!(t instanceof To))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};bn.AcroFormChoiceField=ml,bn.AcroFormListBox=yl,bn.AcroFormComboBox=gl,bn.AcroFormEditBox=Su,bn.AcroFormButton=qn,bn.AcroFormPushButton=Pu,bn.AcroFormRadioButton=vl,bn.AcroFormCheckBox=wu,bn.AcroFormTextField=xa,bn.AcroFormPasswordField=xu,bn.AcroFormAppearance=Qt,bn.AcroForm={ChoiceField:ml,ListBox:yl,ComboBox:gl,EditBox:Su,Button:qn,PushButton:Pu,RadioButton:vl,CheckBox:wu,TextField:xa,PasswordField:xu,Appearance:Qt},dr.AcroForm={ChoiceField:ml,ListBox:yl,ComboBox:gl,EditBox:Su,Button:qn,PushButton:Pu,RadioButton:vl,CheckBox:wu,TextField:xa,PasswordField:xu,Appearance:Qt};var GL=dr.AcroForm;function J5(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(b,w){var _,W,K,k,R,Y=e;if((w=w||e)==="RGBA"||b.data!==void 0&&b.data instanceof Uint8ClampedArray&&"height"in b&&"width"in b)return"RGBA";if(re(b))for(R in r)for(K=r[R],_=0;_<K.length;_+=1){for(k=!0,W=0;W<K[_].length;W+=1)if(K[_][W]!==void 0&&K[_][W]!==b[W]){k=!1;break}if(k===!0){Y=R;break}}else for(R in r)for(K=r[R],_=0;_<K.length;_+=1){for(k=!0,W=0;W<K[_].length;W+=1)if(K[_][W]!==void 0&&K[_][W]!==b.charCodeAt(W)){k=!1;break}if(k===!0){Y=R;break}}return Y===e&&w!==e&&(Y=w),Y},i=function b(w){for(var _=this.internal.write,W=this.internal.putStream,K=(0,this.internal.getFilters)();K.indexOf("FlateEncode")!==-1;)K.splice(K.indexOf("FlateEncode"),1);w.objectId=this.internal.newObject();var k=[];if(k.push({key:"Type",value:"/XObject"}),k.push({key:"Subtype",value:"/Image"}),k.push({key:"Width",value:w.width}),k.push({key:"Height",value:w.height}),w.colorSpace===P.INDEXED?k.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(w.palette.length/3-1)+" "+("sMask"in w&&w.sMask!==void 0?w.objectId+2:w.objectId+1)+" 0 R]"}):(k.push({key:"ColorSpace",value:"/"+w.colorSpace}),w.colorSpace===P.DEVICE_CMYK&&k.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),k.push({key:"BitsPerComponent",value:w.bitsPerComponent}),"decodeParameters"in w&&w.decodeParameters!==void 0&&k.push({key:"DecodeParms",value:"<<"+w.decodeParameters+">>"}),"transparency"in w&&Array.isArray(w.transparency)){for(var R="",Y=0,q=w.transparency.length;Y<q;Y++)R+=w.transparency[Y]+" "+w.transparency[Y]+" ";k.push({key:"Mask",value:"["+R+"]"})}w.sMask!==void 0&&k.push({key:"SMask",value:w.objectId+1+" 0 R"});var O=w.filter!==void 0?["/"+w.filter]:void 0;if(W({data:w.data,additionalKeyValues:k,alreadyAppliedFilters:O,objectId:w.objectId}),_("endobj"),"sMask"in w&&w.sMask!==void 0){var le="/Predictor "+w.predictor+" /Colors 1 /BitsPerComponent "+w.bitsPerComponent+" /Columns "+w.width,N={width:w.width,height:w.height,colorSpace:"DeviceGray",bitsPerComponent:w.bitsPerComponent,decodeParameters:le,data:w.sMask};"filter"in w&&(N.filter=w.filter),b.call(this,N)}if(w.colorSpace===P.INDEXED){var D=this.internal.newObject();W({data:C(new Uint8Array(w.palette)),objectId:D}),_("endobj")}},o=function(){var b=this.internal.collections.addImage_images;for(var w in b)i.call(this,b[w])},s=function(){var b,w=this.internal.collections.addImage_images,_=this.internal.write;for(var W in w)_("/I"+(b=w[W]).index,b.objectId,"0","R")},l=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",s))},c=function(){var b=this.internal.collections.addImage_images;return l.call(this),b},u=function(){return Object.keys(this.internal.collections.addImage_images).length},h=function(b){return typeof t["process"+b.toUpperCase()]=="function"},y=function(b){return tn(b)==="object"&&b.nodeType===1},g=function(b,w){if(b.nodeName==="IMG"&&b.hasAttribute("src")){var _=""+b.getAttribute("src");if(_.indexOf("data:image/")===0)return _u(unescape(_).split("base64,").pop());var W=t.loadFile(_,!0);if(W!==void 0)return W}if(b.nodeName==="CANVAS"){if(b.width===0||b.height===0)throw new Error("Given canvas must have data. Canvas width: "+b.width+", height: "+b.height);var K;switch(w){case"PNG":K="image/png";break;case"WEBP":K="image/webp";break;case"JPEG":case"JPG":default:K="image/jpeg"}return _u(b.toDataURL(K,1).split("base64,").pop())}},f=function(b){var w=this.internal.collections.addImage_images;if(w){for(var _ in w)if(b===w[_].alias)return w[_]}},x=function(b,w,_){return b||w||(b=-96,w=-96),b<0&&(b=-1*_.width*72/b/this.internal.scaleFactor),w<0&&(w=-1*_.height*72/w/this.internal.scaleFactor),b===0&&(b=w*_.width/_.height),w===0&&(w=b*_.height/_.width),[b,w]},S=function(b,w,_,W,K,k){var R=x.call(this,_,W,K),Y=this.internal.getCoordinateString,q=this.internal.getVerticalCoordinateString,O=c.call(this);if(_=R[0],W=R[1],O[K.index]=K,k){k*=Math.PI/180;var le=Math.cos(k),N=Math.sin(k),D=function(I){return I.toFixed(4)},V=[D(le),D(N),D(-1*N),D(le),0,0,"cm"]}this.internal.write("q"),k?(this.internal.write([1,"0","0",1,Y(b),q(w+W),"cm"].join(" ")),this.internal.write(V.join(" ")),this.internal.write([Y(_),"0","0",Y(W),"0","0","cm"].join(" "))):this.internal.write([Y(_),"0","0",Y(W),Y(b),q(w+W),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+K.index+" Do"),this.internal.write("Q")},P=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var $=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},U=t.__addimage__.sHashCode=function(b){var w,_,W=0;if(typeof b=="string")for(_=b.length,w=0;w<_;w++)W=(W<<5)-W+b.charCodeAt(w),W|=0;else if(re(b))for(_=b.byteLength/2,w=0;w<_;w++)W=(W<<5)-W+b[w],W|=0;return W},se=t.__addimage__.validateStringAsBase64=function(b){(b=b||"").toString().trim();var w=!0;return b.length===0&&(w=!1),b.length%4!=0&&(w=!1),/^[A-Za-z0-9+/]+$/.test(b.substr(0,b.length-2))===!1&&(w=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(b.substr(-2))===!1&&(w=!1),w},X=t.__addimage__.extractImageFromDataUrl=function(b){if(b==null||!(b=b.trim()).startsWith("data:"))return null;var w=b.indexOf(",");return w<0?null:b.substring(0,w).trim().endsWith("base64")?b.substring(w+1):null},Z=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(b){return Z()&&b instanceof ArrayBuffer};var re=t.__addimage__.isArrayBufferView=function(b){return Z()&&typeof Uint32Array<"u"&&(b instanceof Int8Array||b instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&b instanceof Uint8ClampedArray||b instanceof Int16Array||b instanceof Uint16Array||b instanceof Int32Array||b instanceof Uint32Array||b instanceof Float32Array||b instanceof Float64Array)},E=t.__addimage__.binaryStringToUint8Array=function(b){for(var w=b.length,_=new Uint8Array(w),W=0;W<w;W++)_[W]=b.charCodeAt(W);return _},C=t.__addimage__.arrayBufferToBinaryString=function(b){for(var w="",_=re(b)?b:new Uint8Array(b),W=0;W<_.length;W+=8192)w+=String.fromCharCode.apply(null,_.subarray(W,W+8192));return w};t.addImage=function(){var b,w,_,W,K,k,R,Y,q;if(typeof arguments[1]=="number"?(w=e,_=arguments[1],W=arguments[2],K=arguments[3],k=arguments[4],R=arguments[5],Y=arguments[6],q=arguments[7]):(w=arguments[1],_=arguments[2],W=arguments[3],K=arguments[4],k=arguments[5],R=arguments[6],Y=arguments[7],q=arguments[8]),tn(b=arguments[0])==="object"&&!y(b)&&"imageData"in b){var O=b;b=O.imageData,w=O.format||w||e,_=O.x||_||0,W=O.y||W||0,K=O.w||O.width||K,k=O.h||O.height||k,R=O.alias||R,Y=O.compression||Y,q=O.rotation||O.angle||q}var le=this.internal.getFilters();if(Y===void 0&&le.indexOf("FlateEncode")!==-1&&(Y="SLOW"),isNaN(_)||isNaN(W))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var N=T.call(this,b,w,R,Y);return S.call(this,_,W,K,k,N,q),this};var T=function(b,w,_,W){var K,k,R;if(typeof b=="string"&&n(b)===e){b=unescape(b);var Y=j(b,!1);(Y!==""||(Y=t.loadFile(b,!0))!==void 0)&&(b=Y)}if(y(b)&&(b=g(b,w)),w=n(b,w),!h(w))throw new Error("addImage does not support files of type '"+w+"', please ensure that a plugin for '"+w+"' support is added.");if(((R=_)==null||R.length===0)&&(_=function(q){return typeof q=="string"||re(q)?U(q):re(q.data)?U(q.data):null}(b)),(K=f.call(this,_))||(Z()&&(b instanceof Uint8Array||w==="RGBA"||(k=b,b=E(b))),K=this["process"+w.toUpperCase()](b,u.call(this),_,function(q){return q&&typeof q=="string"&&(q=q.toUpperCase()),q in t.image_compression?q:$.NONE}(W),k)),!K)throw new Error("An unknown error occurred whilst processing the image.");return K},j=t.__addimage__.convertBase64ToBinaryString=function(b,w){w=typeof w!="boolean"||w;var _,W="";if(typeof b=="string"){var K;_=(K=X(b))!==null&&K!==void 0?K:b;try{W=_u(_)}catch(k){if(w)throw se(_)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+k.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return W};t.getImageProperties=function(b){var w,_,W="";if(y(b)&&(b=g(b)),typeof b=="string"&&n(b)===e&&((W=j(b,!1))===""&&(W=t.loadFile(b)||""),b=W),_=n(b),!h(_))throw new Error("addImage does not support files of type '"+_+"', please ensure that a plugin for '"+_+"' support is added.");if(!Z()||b instanceof Uint8Array||(b=E(b)),!(w=this["process"+_.toUpperCase()](b)))throw new Error("An unknown error occurred whilst processing the image");return w.fileType=_,w}})(dr.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};dr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,o,s=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,h=!1,y=0;y<u.length&&!h;y++)switch((n=u[y]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(h=!0);break;case"reference":case"text":case"freetext":h=!0}if(h!=0){this.internal.write("/Annots [");for(var g=0;g<u.length;g++){n=u[g];var f=this.internal.pdfEscape,x=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var S=this.internal.newAdditionalObject(),P=this.internal.newAdditionalObject(),$=this.internal.getEncryptor(S.objId),U=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+f($(n.contents))+")",o+=" /Popup "+P.objId+" 0 R",o+=" /P "+c.objId+" 0 R",o+=" /T ("+f($(U))+") >>",S.content=o;var se=S.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+se,n.open&&(o+=" /Open true"),o+=" >>",P.content=o,this.internal.write(S.objId,"0 R",P.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+l(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var X=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+f(x(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+X+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(n.options.name){var Z=this.annotations._nameMap[n.options.name];n.options.pageNumber=Z.page,n.options.top=Z.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+f(x(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var re=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+re+" "+n.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,o,s){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+i),h:u(n+o)},options:s,type:"link"})},t.textWithLink=function(r,n,i,o){var s,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){l=o.maxWidth;var h=this.splitTextToSize(r,l).length;s=Math.ceil(u*h)}else l=c,s=u;return this.text(r,n,i,o),i+=.2*u,o.align==="center"&&(n-=c/2),o.align==="right"&&(n-=c),this.link(n,i-u,l,s,o),c},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(dr.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var o=t.__arabicParser__.isInArabicSubstitutionA=function(S){return e[S.charCodeAt(0)]!==void 0},s=t.__arabicParser__.isArabicLetter=function(S){return typeof S=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(S)},l=t.__arabicParser__.isArabicEndLetter=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length<=2},c=t.__arabicParser__.isArabicAlfLetter=function(S){return s(S)&&i.indexOf(S.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length>=1};var u=t.__arabicParser__.arabicLetterHasFinalForm=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length>=3};var h=t.__arabicParser__.arabicLetterHasMedialForm=function(S){return s(S)&&o(S)&&e[S.charCodeAt(0)].length==4},y=t.__arabicParser__.resolveLigatures=function(S){var P=0,$=r,U="",se=0;for(P=0;P<S.length;P+=1)$[S.charCodeAt(P)]!==void 0?(se++,typeof($=$[S.charCodeAt(P)])=="number"&&(U+=String.fromCharCode($),$=r,se=0),P===S.length-1&&($=r,U+=S.charAt(P-(se-1)),P-=se-1,se=0)):($=r,U+=S.charAt(P-se),P-=se,se=0);return U};t.__arabicParser__.isArabicDiacritic=function(S){return S!==void 0&&n[S.charCodeAt(0)]!==void 0};var g=t.__arabicParser__.getCorrectForm=function(S,P,$){return s(S)?o(S)===!1?-1:!u(S)||!s(P)&&!s($)||!s($)&&l(P)||l(S)&&!s(P)||l(S)&&c(P)||l(S)&&l(P)?0:h(S)&&s(P)&&!l(P)&&s($)&&u($)?3:l(S)||!s($)?1:2:-1},f=function(S){var P=0,$=0,U=0,se="",X="",Z="",re=(S=S||"").split("\\s+"),E=[];for(P=0;P<re.length;P+=1){for(E.push(""),$=0;$<re[P].length;$+=1)se=re[P][$],X=re[P][$-1],Z=re[P][$+1],s(se)?(U=g(se,X,Z),E[P]+=U!==-1?String.fromCharCode(e[se.charCodeAt(0)][U]):se):E[P]+=se;E[P]=y(E[P])}return E.join(" ")},x=t.__arabicParser__.processArabic=t.processArabic=function(){var S,P=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,$=[];if(Array.isArray(P)){var U=0;for($=[],U=0;U<P.length;U+=1)Array.isArray(P[U])?$.push([f(P[U][0]),P[U][1],P[U][2]]):$.push([f(P[U])]);S=$}else S=f(P);return typeof arguments[0]=="string"?S:(arguments[0].text=S,arguments[0])};t.events.push(["preProcessText",x])}(dr.API),dr.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(l){o=l}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(l){s=l}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(dr.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(S){c=S}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(S){u=S}});var h=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return h},set:function(S){h=S}});var y=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return y},set:function(S){y=S}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(S){g=S}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(S){f=S}});var x=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return x},set:function(S){x=S}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},t.getTextDimensions=function(c,u){n.call(this);var h=(u=u||{}).fontSize||this.getFontSize(),y=u.font||this.getFont(),g=u.scaleFactor||this.internal.scaleFactor,f=0,x=0,S=0,P=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var $=u.maxWidth;$>0?typeof c=="string"?c=this.splitTextToSize(c,$):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(se,X){return se.concat(P.splitTextToSize(X,$))},[])):c=Array.isArray(c)?c:[c];for(var U=0;U<c.length;U++)f<(S=this.getStringUnitWidth(c[U],{font:y})*h)&&(f=S);return f!==0&&(x=c.length),{w:f/=g,h:Math.max((x*h*this.getLineHeightFactor()-h*(this.getLineHeightFactor()-1))/g,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new o(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=t.cell=function(){var c;c=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,h=this.internal.__cell__.padding,y=this.internal.__cell__.margins||e,g=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+y.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=y.top,f&&g&&(this.printHeaderRow(c.lineNumber,!0),c.y+=g[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-h,c.y+h,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+h,{align:"center",baseline:"top",maxWidth:c.width-h-h}):this.text(c.text,c.x+h,c.y+h,{align:"left",baseline:"top",maxWidth:c.width-h-h})),this.internal.__cell__.lastCell=c,this};t.table=function(c,u,h,y,g){if(n.call(this),!h)throw new Error("No data for PDF table.");var f,x,S,P,$=[],U=[],se=[],X={},Z={},re=[],E=[],C=(g=g||{}).autoSize||!1,T=g.printHeaders!==!1,j=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,b=g.margins||Object.assign({width:this.getPageWidth()},e),w=typeof g.padding=="number"?g.padding:3,_=g.headerBackgroundColor||"#c8c8c8",W=g.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=T,this.internal.__cell__.margins=b,this.internal.__cell__.table_font_size=j,this.internal.__cell__.padding=w,this.internal.__cell__.headerBackgroundColor=_,this.internal.__cell__.headerTextColor=W,this.setFontSize(j),y==null)U=$=Object.keys(h[0]),se=$.map(function(){return"left"});else if(Array.isArray(y)&&tn(y[0])==="object")for($=y.map(function(O){return O.name}),U=y.map(function(O){return O.prompt||O.name||""}),se=y.map(function(O){return O.align||"left"}),f=0;f<y.length;f+=1)Z[y[f].name]=y[f].width*(19.049976/25.4);else Array.isArray(y)&&typeof y[0]=="string"&&(U=$=y,se=$.map(function(){return"left"}));if(C||Array.isArray(y)&&typeof y[0]=="string")for(f=0;f<$.length;f+=1){for(X[P=$[f]]=h.map(function(O){return O[P]}),this.setFont(void 0,"bold"),re.push(this.getTextDimensions(U[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),x=X[P],this.setFont(void 0,"normal"),S=0;S<x.length;S+=1)re.push(this.getTextDimensions(x[S],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Z[P]=Math.max.apply(null,re)+w+w,re=[]}if(T){var K={};for(f=0;f<$.length;f+=1)K[$[f]]={},K[$[f]].text=U[f],K[$[f]].align=se[f];var k=l.call(this,K,Z);E=$.map(function(O){return new o(c,u,Z[O],k,K[O].text,void 0,K[O].align)}),this.setTableHeaderRow(E),this.printHeaderRow(1,!1)}var R=y.reduce(function(O,le){return O[le.name]=le.align,O},{});for(f=0;f<h.length;f+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:f,data:h[f]},this);var Y=l.call(this,h[f],Z);for(S=0;S<$.length;S+=1){var q=h[f][$[S]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:f,col:S,data:q},this),s.call(this,new o(c,u,Z[$[S]],Y,q,f+2,R[$[S]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var h=this.internal.__cell__.padding,y=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(c).map(function(f){var x=c[f];return this.splitTextToSize(x.hasOwnProperty("text")?x.text:x,u[f]-h-h)},this).map(function(f){return this.getLineHeightFactor()*f.length*y/g+h+h},this).reduce(function(f,x){return Math.max(f,x)},0)};t.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},t.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var h;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var y=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(y[0],y[1],y[2],y[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){h=this.internal.__cell__.tableHeaderRow[f].clone(),u&&(h.y=this.internal.__cell__.margins.top||0,g.push(h)),h.lineNumber=c;var x=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,h),this.setTextColor(x)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),r=!1}}(dr.API);var Q5={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},X5=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Lm=J5(X5),Z5=[100,200,300,400,500,600,700,800,900],WL=J5(Z5);function Rm(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(o){return Q5[o=o||"normal"]?o:"normal"}(t.style),n=function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}}(t.weight),i=function(o){return typeof Lm[o=o||"normal"]=="number"?o:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function W0(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var YL={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Y0={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function K0(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function KL(t,e,r){for(var n=(r=r||{}).defaultFontFamily||"times",i=Object.assign({},YL,r.genericFontFamilies||{}),o=null,s=null,l=0;l<e.length;++l)if(i[(o=Rm(e[l])).family]&&(o.family=i[o.family]),t.hasOwnProperty(o.family)){s=t[o.family];break}if(!(s=s||t[n]))throw new Error("Could not find a font-family for the rule '"+K0(o)+"' and default family '"+n+"'.");if(s=function(c,u){if(u[c])return u[c];var h=Lm[c],y=h<=Lm.normal?-1:1,g=W0(u,X5,h,y);if(!g)throw new Error("Could not find a matching font-stretch value for "+c);return g}(o.stretch,s),s=function(c,u){if(u[c])return u[c];for(var h=Q5[c],y=0;y<h.length;++y)if(u[h[y]])return u[h[y]];throw new Error("Could not find a matching font-style for "+c)}(o.style,s),!(s=function(c,u){if(u[c])return u[c];if(c===400&&u[500])return u[500];if(c===500&&u[400])return u[400];var h=WL[c],y=W0(u,Z5,h,c<400?-1:1);if(!y)throw new Error("Could not find a matching font-weight for value "+c);return y}(o.weight,s)))throw new Error("Failed to resolve a font for the rule '"+K0(o)+"'.");return s}function J0(t){return t.trimLeft()}function JL(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function QL(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Kd,Q0,X0,$f=["times"];(function(t){var e,r,n,i,o,s,l,c,u,h=function(N){return N=N||{},this.isStrokeTransparent=N.isStrokeTransparent||!1,this.strokeOpacity=N.strokeOpacity||1,this.strokeStyle=N.strokeStyle||"#000000",this.fillStyle=N.fillStyle||"#000000",this.isFillTransparent=N.isFillTransparent||!1,this.fillOpacity=N.fillOpacity||1,this.font=N.font||"10px sans-serif",this.textBaseline=N.textBaseline||"alphabetic",this.textAlign=N.textAlign||"left",this.lineWidth=N.lineWidth||1,this.lineJoin=N.lineJoin||"miter",this.lineCap=N.lineCap||"butt",this.path=N.path||[],this.transform=N.transform!==void 0?N.transform.clone():new c,this.globalCompositeOperation=N.globalCompositeOperation||"normal",this.globalAlpha=N.globalAlpha||1,this.clip_path=N.clip_path||[],this.currentPoint=N.currentPoint||new s,this.miterLimit=N.miterLimit||10,this.lastPoint=N.lastPoint||new s,this.lineDashOffset=N.lineDashOffset||0,this.lineDash=N.lineDash||[],this.margin=N.margin||[0,0,0,0],this.prevPageLastElemOffset=N.prevPageLastElemOffset||0,this.ignoreClearRect=typeof N.ignoreClearRect!="boolean"||N.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new y(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,s=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new h}]);var y=function(N){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var D=N;Object.defineProperty(this,"pdf",{get:function(){return D}});var V=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return V},set:function(oe){V=!!oe}});var I=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return I},set:function(oe){I=!!oe}});var F=0;Object.defineProperty(this,"posX",{get:function(){return F},set:function(oe){isNaN(oe)||(F=oe)}});var Q=0;Object.defineProperty(this,"posY",{get:function(){return Q},set:function(oe){isNaN(oe)||(Q=oe)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(oe){var z;typeof oe=="number"?z=[oe,oe,oe,oe]:((z=new Array(4))[0]=oe[0],z[1]=oe.length>=2?oe[1]:z[0],z[2]=oe.length>=3?oe[2]:z[0],z[3]=oe.length>=4?oe[3]:z[1]),u.margin=z}});var H=!1;Object.defineProperty(this,"autoPaging",{get:function(){return H},set:function(oe){H=oe}});var J=0;Object.defineProperty(this,"lastBreak",{get:function(){return J},set:function(oe){J=oe}});var te=[];Object.defineProperty(this,"pageBreaks",{get:function(){return te},set:function(oe){te=oe}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(oe){oe instanceof h&&(u=oe)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(oe){u.path=oe}});var ee=[];Object.defineProperty(this,"ctxStack",{get:function(){return ee},set:function(oe){ee=oe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(oe){var z;z=g(oe),this.ctx.fillStyle=z.style,this.ctx.isFillTransparent=z.a===0,this.ctx.fillOpacity=z.a,this.pdf.setFillColor(z.r,z.g,z.b,{a:z.a}),this.pdf.setTextColor(z.r,z.g,z.b,{a:z.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(oe){var z=g(oe);this.ctx.strokeStyle=z.style,this.ctx.isStrokeTransparent=z.a===0,this.ctx.strokeOpacity=z.a,z.a===0?this.pdf.setDrawColor(255,255,255):(z.a,this.pdf.setDrawColor(z.r,z.g,z.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(oe){["butt","round","square"].indexOf(oe)!==-1&&(this.ctx.lineCap=oe,this.pdf.setLineCap(oe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(oe){isNaN(oe)||(this.ctx.lineWidth=oe,this.pdf.setLineWidth(oe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(oe){["bevel","round","miter"].indexOf(oe)!==-1&&(this.ctx.lineJoin=oe,this.pdf.setLineJoin(oe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(oe){isNaN(oe)||(this.ctx.miterLimit=oe,this.pdf.setMiterLimit(oe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(oe){this.ctx.textBaseline=oe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(oe){["right","end","center","left","start"].indexOf(oe)!==-1&&(this.ctx.textAlign=oe)}});var ne=null;function G(oe,z){if(ne===null){var de=function(fe){var ue=[];return Object.keys(fe).forEach(function(ge){fe[ge].forEach(function(xe){var pe=null;switch(xe){case"bold":pe={family:ge,weight:"bold"};break;case"italic":pe={family:ge,style:"italic"};break;case"bolditalic":pe={family:ge,weight:"bold",style:"italic"};break;case"":case"normal":pe={family:ge}}pe!==null&&(pe.ref={name:ge,style:xe},ue.push(pe))})}),ue}(oe.getFontList());ne=function(fe){for(var ue={},ge=0;ge<fe.length;++ge){var xe=Rm(fe[ge]),pe=xe.family,_e=xe.stretch,Le=xe.style,De=xe.weight;ue[pe]=ue[pe]||{},ue[pe][_e]=ue[pe][_e]||{},ue[pe][_e][Le]=ue[pe][_e][Le]||{},ue[pe][_e][Le][De]=xe}return ue}(de.concat(z))}return ne}var ce=null;Object.defineProperty(this,"fontFaces",{get:function(){return ce},set:function(oe){ne=null,ce=oe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(oe){var z;if(this.ctx.font=oe,(z=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(oe))!==null){var de=z[1];z[2];var fe=z[3],ue=z[4];z[5];var ge=z[6],xe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ue)[2];ue=Math.floor(xe==="px"?parseFloat(ue)*this.pdf.internal.scaleFactor:xe==="em"?parseFloat(ue)*this.pdf.getFontSize():parseFloat(ue)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ue);var pe=function(Re){var Ke,je,We=[],Qe=Re.trim();if(Qe==="")return $f;if(Qe in Y0)return[Y0[Qe]];for(;Qe!=="";){switch(je=null,Ke=(Qe=J0(Qe)).charAt(0)){case'"':case"'":je=JL(Qe.substring(1),Ke);break;default:je=QL(Qe)}if(je===null||(We.push(je[0]),(Qe=J0(je[1]))!==""&&Qe.charAt(0)!==","))return $f;Qe=Qe.replace(/^,/,"")}return We}(ge);if(this.fontFaces){var _e=KL(G(this.pdf,this.fontFaces),pe.map(function(Re){return{family:Re,stretch:"normal",weight:fe,style:de}}));this.pdf.setFont(_e.ref.name,_e.ref.style)}else{var Le="";(fe==="bold"||parseInt(fe,10)>=700||de==="bold")&&(Le="bold"),de==="italic"&&(Le+="italic"),Le.length===0&&(Le="normal");for(var De="",Te={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},$e=0;$e<pe.length;$e++){if(this.pdf.internal.getFont(pe[$e],Le,{noFallback:!0,disableWarning:!0})!==void 0){De=pe[$e];break}if(Le==="bolditalic"&&this.pdf.internal.getFont(pe[$e],"bold",{noFallback:!0,disableWarning:!0})!==void 0)De=pe[$e],Le="bold";else if(this.pdf.internal.getFont(pe[$e],"normal",{noFallback:!0,disableWarning:!0})!==void 0){De=pe[$e],Le="normal";break}}if(De===""){for(var Ie=0;Ie<pe.length;Ie++)if(Te[pe[Ie]]){De=Te[pe[Ie]];break}}De=De===""?"Times":De,this.pdf.setFont(De,Le)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(oe){this.ctx.globalCompositeOperation=oe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(oe){this.ctx.globalAlpha=oe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(oe){this.ctx.lineDashOffset=oe,le.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(oe){this.ctx.lineDash=oe,le.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(oe){this.ctx.ignoreClearRect=!!oe}})};y.prototype.setLineDash=function(N){this.lineDash=N},y.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},y.prototype.fill=function(){X.call(this,"fill",!1)},y.prototype.stroke=function(){X.call(this,"stroke",!1)},y.prototype.beginPath=function(){this.path=[{type:"begin"}]},y.prototype.moveTo=function(N,D){if(isNaN(N)||isNaN(D))throw sn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var V=this.ctx.transform.applyToPoint(new s(N,D));this.path.push({type:"mt",x:V.x,y:V.y}),this.ctx.lastPoint=new s(N,D)},y.prototype.closePath=function(){var N=new s(0,0),D=0;for(D=this.path.length-1;D!==-1;D--)if(this.path[D].type==="begin"&&tn(this.path[D+1])==="object"&&typeof this.path[D+1].x=="number"){N=new s(this.path[D+1].x,this.path[D+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(N.x,N.y)},y.prototype.lineTo=function(N,D){if(isNaN(N)||isNaN(D))throw sn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var V=this.ctx.transform.applyToPoint(new s(N,D));this.path.push({type:"lt",x:V.x,y:V.y}),this.ctx.lastPoint=new s(V.x,V.y)},y.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),X.call(this,null,!0)},y.prototype.quadraticCurveTo=function(N,D,V,I){if(isNaN(V)||isNaN(I)||isNaN(N)||isNaN(D))throw sn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var F=this.ctx.transform.applyToPoint(new s(V,I)),Q=this.ctx.transform.applyToPoint(new s(N,D));this.path.push({type:"qct",x1:Q.x,y1:Q.y,x:F.x,y:F.y}),this.ctx.lastPoint=new s(F.x,F.y)},y.prototype.bezierCurveTo=function(N,D,V,I,F,Q){if(isNaN(F)||isNaN(Q)||isNaN(N)||isNaN(D)||isNaN(V)||isNaN(I))throw sn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var H=this.ctx.transform.applyToPoint(new s(F,Q)),J=this.ctx.transform.applyToPoint(new s(N,D)),te=this.ctx.transform.applyToPoint(new s(V,I));this.path.push({type:"bct",x1:J.x,y1:J.y,x2:te.x,y2:te.y,x:H.x,y:H.y}),this.ctx.lastPoint=new s(H.x,H.y)},y.prototype.arc=function(N,D,V,I,F,Q){if(isNaN(N)||isNaN(D)||isNaN(V)||isNaN(I)||isNaN(F))throw sn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Q=!!Q,!this.ctx.transform.isIdentity){var H=this.ctx.transform.applyToPoint(new s(N,D));N=H.x,D=H.y;var J=this.ctx.transform.applyToPoint(new s(0,V)),te=this.ctx.transform.applyToPoint(new s(0,0));V=Math.sqrt(Math.pow(J.x-te.x,2)+Math.pow(J.y-te.y,2))}Math.abs(F-I)>=2*Math.PI&&(I=0,F=2*Math.PI),this.path.push({type:"arc",x:N,y:D,radius:V,startAngle:I,endAngle:F,counterclockwise:Q})},y.prototype.arcTo=function(N,D,V,I,F){throw new Error("arcTo not implemented.")},y.prototype.rect=function(N,D,V,I){if(isNaN(N)||isNaN(D)||isNaN(V)||isNaN(I))throw sn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(N,D),this.lineTo(N+V,D),this.lineTo(N+V,D+I),this.lineTo(N,D+I),this.lineTo(N,D),this.lineTo(N+V,D),this.lineTo(N,D)},y.prototype.fillRect=function(N,D,V,I){if(isNaN(N)||isNaN(D)||isNaN(V)||isNaN(I))throw sn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var F={};this.lineCap!=="butt"&&(F.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(F.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(N,D,V,I),this.fill(),F.hasOwnProperty("lineCap")&&(this.lineCap=F.lineCap),F.hasOwnProperty("lineJoin")&&(this.lineJoin=F.lineJoin)}},y.prototype.strokeRect=function(N,D,V,I){if(isNaN(N)||isNaN(D)||isNaN(V)||isNaN(I))throw sn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");x.call(this)||(this.beginPath(),this.rect(N,D,V,I),this.stroke())},y.prototype.clearRect=function(N,D,V,I){if(isNaN(N)||isNaN(D)||isNaN(V)||isNaN(I))throw sn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(N,D,V,I))},y.prototype.save=function(N){N=typeof N!="boolean"||N;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("q");if(this.pdf.setPage(D),N){this.ctx.fontSize=this.pdf.internal.getFontSize();var I=new h(this.ctx);this.ctxStack.push(this.ctx),this.ctx=I}},y.prototype.restore=function(N){N=typeof N!="boolean"||N;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("Q");this.pdf.setPage(D),N&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},y.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(N){var D,V,I,F;if(N.isCanvasGradient===!0&&(N=N.getColor()),!N)return{r:0,g:0,b:0,a:0,style:N};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(N))D=0,V=0,I=0,F=0;else{var Q=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(N);if(Q!==null)D=parseInt(Q[1]),V=parseInt(Q[2]),I=parseInt(Q[3]),F=1;else if((Q=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(N))!==null)D=parseInt(Q[1]),V=parseInt(Q[2]),I=parseInt(Q[3]),F=parseFloat(Q[4]);else{if(F=1,typeof N=="string"&&N.charAt(0)!=="#"){var H=new U5(N);N=H.ok?H.toHex():"#000000"}N.length===4?(D=N.substring(1,2),D+=D,V=N.substring(2,3),V+=V,I=N.substring(3,4),I+=I):(D=N.substring(1,3),V=N.substring(3,5),I=N.substring(5,7)),D=parseInt(D,16),V=parseInt(V,16),I=parseInt(I,16)}}return{r:D,g:V,b:I,a:F,style:N}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},x=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};y.prototype.fillText=function(N,D,V,I){if(isNaN(D)||isNaN(V)||typeof N!="string")throw sn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(I=isNaN(I)?void 0:I,!f.call(this)){var F=Y(this.ctx.transform.rotation),Q=this.ctx.transform.scaleX;w.call(this,{text:N,x:D,y:V,scale:Q,angle:F,align:this.textAlign,maxWidth:I})}},y.prototype.strokeText=function(N,D,V,I){if(isNaN(D)||isNaN(V)||typeof N!="string")throw sn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!x.call(this)){I=isNaN(I)?void 0:I;var F=Y(this.ctx.transform.rotation),Q=this.ctx.transform.scaleX;w.call(this,{text:N,x:D,y:V,scale:Q,renderingMode:"stroke",angle:F,align:this.textAlign,maxWidth:I})}},y.prototype.measureText=function(N){if(typeof N!="string")throw sn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var D=this.pdf,V=this.pdf.internal.scaleFactor,I=D.internal.getFontSize(),F=D.getStringUnitWidth(N)*I/D.internal.scaleFactor,Q=function(H){var J=(H=H||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return J}}),this};return new Q({width:F*=Math.round(96*V/72*1e4)/1e4})},y.prototype.scale=function(N,D){if(isNaN(N)||isNaN(D))throw sn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var V=new c(N,0,0,D,0,0);this.ctx.transform=this.ctx.transform.multiply(V)},y.prototype.rotate=function(N){if(isNaN(N))throw sn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var D=new c(Math.cos(N),Math.sin(N),-Math.sin(N),Math.cos(N),0,0);this.ctx.transform=this.ctx.transform.multiply(D)},y.prototype.translate=function(N,D){if(isNaN(N)||isNaN(D))throw sn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var V=new c(1,0,0,1,N,D);this.ctx.transform=this.ctx.transform.multiply(V)},y.prototype.transform=function(N,D,V,I,F,Q){if(isNaN(N)||isNaN(D)||isNaN(V)||isNaN(I)||isNaN(F)||isNaN(Q))throw sn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var H=new c(N,D,V,I,F,Q);this.ctx.transform=this.ctx.transform.multiply(H)},y.prototype.setTransform=function(N,D,V,I,F,Q){N=isNaN(N)?1:N,D=isNaN(D)?0:D,V=isNaN(V)?0:V,I=isNaN(I)?1:I,F=isNaN(F)?0:F,Q=isNaN(Q)?0:Q,this.ctx.transform=new c(N,D,V,I,F,Q)};var S=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};y.prototype.drawImage=function(N,D,V,I,F,Q,H,J,te){var ee=this.pdf.getImageProperties(N),ne=1,G=1,ce=1,oe=1;I!==void 0&&J!==void 0&&(ce=J/I,oe=te/F,ne=ee.width/I*J/I,G=ee.height/F*te/F),Q===void 0&&(Q=D,H=V,D=0,V=0),I!==void 0&&J===void 0&&(J=I,te=F),I===void 0&&J===void 0&&(J=ee.width,te=ee.height);for(var z,de=this.ctx.transform.decompose(),fe=Y(de.rotate.shx),ue=new c,ge=(ue=(ue=(ue=ue.multiply(de.translate)).multiply(de.skew)).multiply(de.scale)).applyToRectangle(new l(Q-D*ce,H-V*oe,I*ne,F*G)),xe=P.call(this,ge),pe=[],_e=0;_e<xe.length;_e+=1)pe.indexOf(xe[_e])===-1&&pe.push(xe[_e]);if(se(pe),this.autoPaging)for(var Le=pe[0],De=pe[pe.length-1],Te=Le;Te<De+1;Te++){this.pdf.setPage(Te);var $e=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ie=Te===1?this.posY+this.margin[0]:this.margin[0],Re=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ke=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],je=Te===1?0:Re+(Te-2)*Ke;if(this.ctx.clip_path.length!==0){var We=this.path;z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=U(z,this.posX+this.margin[3],-je+Ie+this.ctx.prevPageLastElemOffset),Z.call(this,"fill",!0),this.path=We}var Qe=JSON.parse(JSON.stringify(ge));Qe=U([Qe],this.posX+this.margin[3],-je+Ie+this.ctx.prevPageLastElemOffset)[0];var at=(Te>Le||Te<De)&&S.call(this);at&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],$e,Ke,null).clip().discardPath()),this.pdf.addImage(N,"JPEG",Qe.x,Qe.y,Qe.w,Qe.h,null,null,fe),at&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(N,"JPEG",ge.x,ge.y,ge.w,ge.h,null,null,fe)};var P=function(N,D,V){var I=[];D=D||this.pdf.internal.pageSize.width,V=V||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var F=this.posY+this.ctx.prevPageLastElemOffset;switch(N.type){default:case"mt":case"lt":I.push(Math.floor((N.y+F)/V)+1);break;case"arc":I.push(Math.floor((N.y+F-N.radius)/V)+1),I.push(Math.floor((N.y+F+N.radius)/V)+1);break;case"qct":var Q=q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,N.x1,N.y1,N.x,N.y);I.push(Math.floor((Q.y+F)/V)+1),I.push(Math.floor((Q.y+Q.h+F)/V)+1);break;case"bct":var H=O(this.ctx.lastPoint.x,this.ctx.lastPoint.y,N.x1,N.y1,N.x2,N.y2,N.x,N.y);I.push(Math.floor((H.y+F)/V)+1),I.push(Math.floor((H.y+H.h+F)/V)+1);break;case"rect":I.push(Math.floor((N.y+F)/V)+1),I.push(Math.floor((N.y+N.h+F)/V)+1)}for(var J=0;J<I.length;J+=1)for(;this.pdf.internal.getNumberOfPages()<I[J];)$.call(this);return I},$=function(){var N=this.fillStyle,D=this.strokeStyle,V=this.font,I=this.lineCap,F=this.lineWidth,Q=this.lineJoin;this.pdf.addPage(),this.fillStyle=N,this.strokeStyle=D,this.font=V,this.lineCap=I,this.lineWidth=F,this.lineJoin=Q},U=function(N,D,V){for(var I=0;I<N.length;I++)switch(N[I].type){case"bct":N[I].x2+=D,N[I].y2+=V;case"qct":N[I].x1+=D,N[I].y1+=V;case"mt":case"lt":case"arc":default:N[I].x+=D,N[I].y+=V}return N},se=function(N){return N.sort(function(D,V){return D-V})},X=function(N,D){for(var V,I,F=this.fillStyle,Q=this.strokeStyle,H=this.lineCap,J=this.lineWidth,te=Math.abs(J*this.ctx.transform.scaleX),ee=this.lineJoin,ne=JSON.parse(JSON.stringify(this.path)),G=JSON.parse(JSON.stringify(this.path)),ce=[],oe=0;oe<G.length;oe++)if(G[oe].x!==void 0)for(var z=P.call(this,G[oe]),de=0;de<z.length;de+=1)ce.indexOf(z[de])===-1&&ce.push(z[de]);for(var fe=0;fe<ce.length;fe++)for(;this.pdf.internal.getNumberOfPages()<ce[fe];)$.call(this);if(se(ce),this.autoPaging)for(var ue=ce[0],ge=ce[ce.length-1],xe=ue;xe<ge+1;xe++){this.pdf.setPage(xe),this.fillStyle=F,this.strokeStyle=Q,this.lineCap=H,this.lineWidth=te,this.lineJoin=ee;var pe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],_e=xe===1?this.posY+this.margin[0]:this.margin[0],Le=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],De=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Te=xe===1?0:Le+(xe-2)*De;if(this.ctx.clip_path.length!==0){var $e=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=U(V,this.posX+this.margin[3],-Te+_e+this.ctx.prevPageLastElemOffset),Z.call(this,N,!0),this.path=$e}if(I=JSON.parse(JSON.stringify(ne)),this.path=U(I,this.posX+this.margin[3],-Te+_e+this.ctx.prevPageLastElemOffset),D===!1||xe===0){var Ie=(xe>ue||xe<ge)&&S.call(this);Ie&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],pe,De,null).clip().discardPath()),Z.call(this,N,D),Ie&&this.pdf.restoreGraphicsState()}this.lineWidth=J}else this.lineWidth=te,Z.call(this,N,D),this.lineWidth=J;this.path=ne},Z=function(N,D){if((N!=="stroke"||D||!x.call(this))&&(N==="stroke"||D||!f.call(this))){for(var V,I,F=[],Q=this.path,H=0;H<Q.length;H++){var J=Q[H];switch(J.type){case"begin":F.push({begin:!0});break;case"close":F.push({close:!0});break;case"mt":F.push({start:J,deltas:[],abs:[]});break;case"lt":var te=F.length;if(Q[H-1]&&!isNaN(Q[H-1].x)&&(V=[J.x-Q[H-1].x,J.y-Q[H-1].y],te>0)){for(;te>=0;te--)if(F[te-1].close!==!0&&F[te-1].begin!==!0){F[te-1].deltas.push(V),F[te-1].abs.push(J);break}}break;case"bct":V=[J.x1-Q[H-1].x,J.y1-Q[H-1].y,J.x2-Q[H-1].x,J.y2-Q[H-1].y,J.x-Q[H-1].x,J.y-Q[H-1].y],F[F.length-1].deltas.push(V);break;case"qct":var ee=Q[H-1].x+2/3*(J.x1-Q[H-1].x),ne=Q[H-1].y+2/3*(J.y1-Q[H-1].y),G=J.x+2/3*(J.x1-J.x),ce=J.y+2/3*(J.y1-J.y),oe=J.x,z=J.y;V=[ee-Q[H-1].x,ne-Q[H-1].y,G-Q[H-1].x,ce-Q[H-1].y,oe-Q[H-1].x,z-Q[H-1].y],F[F.length-1].deltas.push(V);break;case"arc":F.push({deltas:[],abs:[],arc:!0}),Array.isArray(F[F.length-1].abs)&&F[F.length-1].abs.push(J)}}I=D?null:N==="stroke"?"stroke":"fill";for(var de=!1,fe=0;fe<F.length;fe++)if(F[fe].arc)for(var ue=F[fe].abs,ge=0;ge<ue.length;ge++){var xe=ue[ge];xe.type==="arc"?C.call(this,xe.x,xe.y,xe.radius,xe.startAngle,xe.endAngle,xe.counterclockwise,void 0,D,!de):_.call(this,xe.x,xe.y),de=!0}else if(F[fe].close===!0)this.pdf.internal.out("h"),de=!1;else if(F[fe].begin!==!0){var pe=F[fe].start.x,_e=F[fe].start.y;W.call(this,F[fe].deltas,pe,_e),de=!0}I&&T.call(this,I),D&&j.call(this)}},re=function(N){var D=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,V=D*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return N-V;case"top":return N+D-V;case"hanging":return N+D-2*V;case"middle":return N+D/2-V;case"ideographic":return N;case"alphabetic":default:return N}},E=function(N){return N+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};y.prototype.createLinearGradient=function(){var N=function(){};return N.colorStops=[],N.addColorStop=function(D,V){this.colorStops.push([D,V])},N.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},N.isCanvasGradient=!0,N},y.prototype.createPattern=function(){return this.createLinearGradient()},y.prototype.createRadialGradient=function(){return this.createLinearGradient()};var C=function(N,D,V,I,F,Q,H,J,te){for(var ee=k.call(this,V,I,F,Q),ne=0;ne<ee.length;ne++){var G=ee[ne];ne===0&&(te?b.call(this,G.x1+N,G.y1+D):_.call(this,G.x1+N,G.y1+D)),K.call(this,N,D,G.x2,G.y2,G.x3,G.y3,G.x4,G.y4)}J?j.call(this):T.call(this,H)},T=function(N){switch(N){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},j=function(){this.pdf.clip(),this.pdf.discardPath()},b=function(N,D){this.pdf.internal.out(r(N)+" "+n(D)+" m")},w=function(N){var D;switch(N.align){case"right":case"end":D="right";break;case"center":D="center";break;case"left":case"start":default:D="left"}var V=this.pdf.getTextDimensions(N.text),I=re.call(this,N.y),F=E.call(this,I)-V.h,Q=this.ctx.transform.applyToPoint(new s(N.x,I)),H=this.ctx.transform.decompose(),J=new c;J=(J=(J=J.multiply(H.translate)).multiply(H.skew)).multiply(H.scale);for(var te,ee,ne,G=this.ctx.transform.applyToRectangle(new l(N.x,I,V.w,V.h)),ce=J.applyToRectangle(new l(N.x,F,V.w,V.h)),oe=P.call(this,ce),z=[],de=0;de<oe.length;de+=1)z.indexOf(oe[de])===-1&&z.push(oe[de]);if(se(z),this.autoPaging)for(var fe=z[0],ue=z[z.length-1],ge=fe;ge<ue+1;ge++){this.pdf.setPage(ge);var xe=ge===1?this.posY+this.margin[0]:this.margin[0],pe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_e=this.pdf.internal.pageSize.height-this.margin[2],Le=_e-this.margin[0],De=this.pdf.internal.pageSize.width-this.margin[1],Te=De-this.margin[3],$e=ge===1?0:pe+(ge-2)*Le;if(this.ctx.clip_path.length!==0){var Ie=this.path;te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=U(te,this.posX+this.margin[3],-1*$e+xe),Z.call(this,"fill",!0),this.path=Ie}var Re=U([JSON.parse(JSON.stringify(ce))],this.posX+this.margin[3],-$e+xe+this.ctx.prevPageLastElemOffset)[0];N.scale>=.01&&(ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ee*N.scale),ne=this.lineWidth,this.lineWidth=ne*N.scale);var Ke=this.autoPaging!=="text";if(Ke||Re.y+Re.h<=_e){if(Ke||Re.y>=xe&&Re.x<=De){var je=Ke?N.text:this.pdf.splitTextToSize(N.text,N.maxWidth||De-Re.x)[0],We=U([JSON.parse(JSON.stringify(G))],this.posX+this.margin[3],-$e+xe+this.ctx.prevPageLastElemOffset)[0],Qe=Ke&&(ge>fe||ge<ue)&&S.call(this);Qe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Te,Le,null).clip().discardPath()),this.pdf.text(je,We.x,We.y,{angle:N.angle,align:D,renderingMode:N.renderingMode}),Qe&&this.pdf.restoreGraphicsState()}}else Re.y<_e&&(this.ctx.prevPageLastElemOffset+=_e-Re.y);N.scale>=.01&&(this.pdf.setFontSize(ee),this.lineWidth=ne)}else N.scale>=.01&&(ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ee*N.scale),ne=this.lineWidth,this.lineWidth=ne*N.scale),this.pdf.text(N.text,Q.x+this.posX,Q.y+this.posY,{angle:N.angle,align:D,renderingMode:N.renderingMode,maxWidth:N.maxWidth}),N.scale>=.01&&(this.pdf.setFontSize(ee),this.lineWidth=ne)},_=function(N,D,V,I){V=V||0,I=I||0,this.pdf.internal.out(r(N+V)+" "+n(D+I)+" l")},W=function(N,D,V){return this.pdf.lines(N,D,V,null,null)},K=function(N,D,V,I,F,Q,H,J){this.pdf.internal.out([e(i(V+N)),e(o(I+D)),e(i(F+N)),e(o(Q+D)),e(i(H+N)),e(o(J+D)),"c"].join(" "))},k=function(N,D,V,I){for(var F=2*Math.PI,Q=Math.PI/2;D>V;)D-=F;var H=Math.abs(V-D);H<F&&I&&(H=F-H);for(var J=[],te=I?-1:1,ee=D;H>1e-5;){var ne=ee+te*Math.min(H,Q);J.push(R.call(this,N,ee,ne)),H-=Math.abs(ne-ee),ee=ne}return J},R=function(N,D,V){var I=(V-D)/2,F=N*Math.cos(I),Q=N*Math.sin(I),H=F,J=-Q,te=H*H+J*J,ee=te+H*F+J*Q,ne=4/3*(Math.sqrt(2*te*ee)-ee)/(H*Q-J*F),G=H-ne*J,ce=J+ne*H,oe=G,z=-ce,de=I+D,fe=Math.cos(de),ue=Math.sin(de);return{x1:N*Math.cos(D),y1:N*Math.sin(D),x2:G*fe-ce*ue,y2:G*ue+ce*fe,x3:oe*fe-z*ue,y3:oe*ue+z*fe,x4:N*Math.cos(V),y4:N*Math.sin(V)}},Y=function(N){return 180*N/Math.PI},q=function(N,D,V,I,F,Q){var H=N+.5*(V-N),J=D+.5*(I-D),te=F+.5*(V-F),ee=Q+.5*(I-Q),ne=Math.min(N,F,H,te),G=Math.max(N,F,H,te),ce=Math.min(D,Q,J,ee),oe=Math.max(D,Q,J,ee);return new l(ne,ce,G-ne,oe-ce)},O=function(N,D,V,I,F,Q,H,J){var te,ee,ne,G,ce,oe,z,de,fe,ue,ge,xe,pe,_e,Le=V-N,De=I-D,Te=F-V,$e=Q-I,Ie=H-F,Re=J-Q;for(ee=0;ee<41;ee++)fe=(z=(ne=N+(te=ee/40)*Le)+te*((ce=V+te*Te)-ne))+te*(ce+te*(F+te*Ie-ce)-z),ue=(de=(G=D+te*De)+te*((oe=I+te*$e)-G))+te*(oe+te*(Q+te*Re-oe)-de),ee==0?(ge=fe,xe=ue,pe=fe,_e=ue):(ge=Math.min(ge,fe),xe=Math.min(xe,ue),pe=Math.max(pe,fe),_e=Math.max(_e,ue));return new l(Math.round(ge),Math.round(xe),Math.round(pe-ge),Math.round(_e-xe))},le=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var N,D,V=(N=this.ctx.lineDash,D=this.ctx.lineDashOffset,JSON.stringify({lineDash:N,lineDashOffset:D}));this.prevLineDash!==V&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=V)}}})(dr.API),function(t){var e=function(o){var s,l,c,u,h,y,g,f,x,S;for(l=[],c=0,u=(o+=s="\0\0\0\0".slice(o.length%4||4)).length;u>c;c+=4)(h=(o.charCodeAt(c)<<24)+(o.charCodeAt(c+1)<<16)+(o.charCodeAt(c+2)<<8)+o.charCodeAt(c+3))!==0?(y=(h=((h=((h=((h=(h-(S=h%85))/85)-(x=h%85))/85)-(f=h%85))/85)-(g=h%85))/85)%85,l.push(y+33,g+33,f+33,x+33,S+33)):l.push(122);return function(P,$){for(var U=$;U>0;U--)P.pop()}(l,s.length),String.fromCharCode.apply(String,l)+"~>"},r=function(o){var s,l,c,u,h,y=String,g="length",f=255,x="charCodeAt",S="slice",P="replace";for(o[S](-2),o=o[S](0,-2)[P](/\s/g,"")[P]("z","!!!!!"),c=[],u=0,h=(o+=s="uuuuu"[S](o[g]%5||5))[g];h>u;u+=5)l=52200625*(o[x](u)-33)+614125*(o[x](u+1)-33)+7225*(o[x](u+2)-33)+85*(o[x](u+3)-33)+(o[x](u+4)-33),c.push(f&l>>24,f&l>>16,f&l>>8,f&l);return function($,U){for(var se=U;se>0;se--)$.pop()}(c,s[g]),y.fromCharCode.apply(y,c)},n=function(o){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),s.test(o)===!1)return"";for(var l="",c=0;c<o.length;c+=2)l+=String.fromCharCode("0x"+(o[c]+o[c+1]));return l},i=function(o){for(var s=new Uint8Array(o.length),l=o.length;l--;)s[l]=o.charCodeAt(l);return o=(s=$m(s)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};t.processDataByFilters=function(o,s){var l=0,c=o||"",u=[];for(typeof(s=s||[])=="string"&&(s=[s]),l=0;l<s.length;l+=1)switch(s[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=e(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=n(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=c.split("").map(function(h){return("0"+h.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[l]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}}(dr.API),function(t){t.loadFile=function(e,r,n){return function(i,o,s){o=o!==!1,s=typeof s=="function"?s:function(){};var l=void 0;try{l=function(c,u,h){var y=new XMLHttpRequest,g=0,f=function(x){var S=x.length,P=[],$=String.fromCharCode;for(g=0;g<S;g+=1)P.push($(255&x.charCodeAt(g)));return P.join("")};if(y.open("GET",c,!u),y.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(y.onload=function(){y.status===200?h(f(this.responseText)):h(void 0)}),y.send(null),u&&y.status===200)return f(y.responseText)}(i,o,s)}catch{}return l}(e,r,n)},t.loadImageFile=t.loadFile}(dr.API),function(t){function e(){return(fr.html2canvas?Promise.resolve(fr.html2canvas):Oi(()=>import("./html2canvas.esm-BfxBtG_O.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function r(){return(fr.DOMPurify?Promise.resolve(fr.DOMPurify):Oi(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var l=tn(s);return l==="undefined"?"undefined":l==="string"||s instanceof String?"string":l==="number"||s instanceof Number?"number":l==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":l==="object"?"object":"unknown"},i=function(s,l){var c=document.createElement(s);for(var u in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[u]=l.style[u];return c},o=function s(l){var c=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),u=s.convert(Promise.resolve(),c);return u=(u=u.setProgress(1,s,1,[s])).set(l)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(s,l){return s.__proto__=l||o.prototype,s},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(s,l){return this.then(function(){switch(l=l||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(r).then(function(c){return this.set({src:i("div",{innerHTML:s,dompurify:c})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},o.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=function c(u,h){for(var y=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),g=u.firstChild;g;g=g.nextSibling)h!==!0&&g.nodeType===1&&g.nodeName==="SCRIPT"||y.appendChild(c(g,h));return u.nodeType===1&&(u.nodeName==="CANVAS"?(y.width=u.width,y.height=u.height,y.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(y.value=u.value),y.addEventListener("load",function(){y.scrollTop=u.scrollTop,y.scrollLeft=u.scrollLeft},!0)),y}(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(e).then(function(l){var c=this.opt.jsPDF,u=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,y=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete y.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var g=0;g<u.length;++g){var f=u[g],x=f.src.find(function(S){return S.format==="truetype"});x&&c.addFont(x.url,f.ref.name,f.ref.style)}return y.windowHeight=y.windowHeight||0,y.windowHeight=y.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):y.windowHeight,c.context2d.save(!0),l(this.prop.container,y)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(s,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(s,l):this.outputPdf(s,l)},o.prototype.outputPdf=function(s,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,l)})},o.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},o.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(s){if(n(s)!=="object")return this;var l=Object.keys(s||{}).map(function(c){if(c in o.template.prop)return function(){this.prop[c]=s[c]};switch(c){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[c]=s[c]}}},this);return this.then(function(){return this.thenList(l)})},o.prototype.get=function(s,l){return this.then(function(){var c=s in o.template.prop?this.prop[s]:this.opt[s];return l?l(c):c})},o.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},o.prototype.setPageSize=function(s){function l(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(s=s||dr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:l(s.inner.width,s.k),height:l(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},o.prototype.setProgress=function(s,l,c,u){return s!=null&&(this.progress.val=s),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(s,l,c,u){return this.setProgress(s?this.progress.val+s:null,l||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(s,l){var c=this;return this.thenCore(s,l,function(u,h){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(y){return c.updateProgress(null,u),y}).then(u,h).then(function(y){return c.updateProgress(1),y})})},o.prototype.thenCore=function(s,l,c){c=c||Promise.prototype.then,s&&(s=s.bind(this)),l&&(l=l.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),h=c.call(u,s,l);return o.convert(h,this.__proto__)},o.prototype.thenExternal=function(s,l){return Promise.prototype.then.call(this,s,l)},o.prototype.thenList=function(s){var l=this;return s.forEach(function(c){l=l.thenCore(c)}),l},o.prototype.catch=function(s){s&&(s=s.bind(this));var l=Promise.prototype.catch.call(this,s);return o.convert(l,this)},o.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},o.prototype.error=function(s){return this.then(function(){throw new Error(s)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,dr.getPageSize=function(s,l,c){if(tn(s)==="object"){var u=s;s=u.orientation,l=u.unit||l,c=u.format||c}l=l||"mm",c=c||"a4",s=(""+(s||"P")).toLowerCase();var h,y=(""+c).toLowerCase(),g={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+l}var f,x=0,S=0;if(g.hasOwnProperty(y))x=g[y][1]/h,S=g[y][0]/h;else try{x=c[1],S=c[0]}catch{throw new Error("Invalid format: "+c)}if(s==="p"||s==="portrait")s="p",S>x&&(f=S,S=x,x=f);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",x>S&&(f=S,S=x,x=f)}return{width:S,height:x,unit:l,k:h,orientation:s}},t.html=function(s,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(Rm):null;var c=new o(l);return l.worker?c:c.from(s).doCallback()}}(dr.API),dr.API.addJS=function(t){return X0=t,this.internal.events.subscribe("postPutResources",function(){Kd=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Kd+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Q0=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+X0+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Kd!==void 0&&Q0!==void 0&&this.internal.out("/Names <</JavaScript "+Kd+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),o=0;o<i.length;o++){var s=i[o],l=n.exec(s);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,h=[];for(o=0;o<u;o++){var y=r.internal.newObject();h.push(y);var g=r.internal.getPageInfo(o+1);r.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var f=r.internal.newObject();for(r.internal.write("<< /Names [ "),o=0;o<h.length;o++)r.internal.write("(page_"+(o+1)+")"+h[o]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+f+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,o){var s={title:i,options:o,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var s=n.children[o];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var l=this.count=this.count_r({count:0},s);if(l>0&&this.line("/Count "+l),s.options&&s.options.pageNumber){var c=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var o=0;o<i.children.length;o++)n.count++,this.count_r(n,i.children[o]);return n.count}}])}(dr.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,o,s,l){var c,u=this.decode.DCT_DECODE,h=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(c=function(y){for(var g,f=256*y.charCodeAt(4)+y.charCodeAt(5),x=y.length,S={width:0,height:0,numcomponents:1},P=4;P<x;P+=2){if(P+=f,e.indexOf(y.charCodeAt(P+1))!==-1){g=256*y.charCodeAt(P+5)+y.charCodeAt(P+6),S={width:256*y.charCodeAt(P+7)+y.charCodeAt(P+8),height:g,numcomponents:y.charCodeAt(P+9)};break}f=256*y.charCodeAt(P+2)+y.charCodeAt(P+3)}return S}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}h={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:i}}return h}}(dr.API);var ec,Jd,Z0,eb,tb,XL=function(){var t,e,r;function n(o){var s,l,c,u,h,y,g,f,x,S,P,$,U,se;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},y=null;;){switch(s=this.readUInt32(),x=function(){var X,Z;for(Z=[],X=0;X<4;++X)Z.push(String.fromCharCode(this.data[this.pos++]));return Z}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":y&&this.animation.frames.push(y),this.pos+=4,y={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},h=this.readUInt16(),u=this.readUInt16()||100,y.delay=1e3*h/u,y.disposeOp=this.data[this.pos++],y.blendOp=this.data[this.pos++],y.data=[];break;case"IDAT":case"fdAT":for(x==="fdAT"&&(this.pos+=4,s-=4),o=y?.data||this.imgData,$=0;0<=s?$<s:$>s;0<=s?++$:--$)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(c=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>c)throw new Error("More transparent colors than palette size");if((S=c-this.transparency.indexed.length)>0)for(U=0;0<=S?U<S:U>S;0<=S?++U:--U)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":g=(P=this.read(s)).indexOf(0),f=String.fromCharCode.apply(String,P.slice(0,g)),this.text[f]=String.fromCharCode.apply(String,P.slice(g+1));break;case"IEND":return y&&this.animation.frames.push(y),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(se=this.colorType)===4||se===6,l=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*l,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(o){var s,l;for(l=[],s=0;0<=o?s<o:s>o;0<=o?++s:--s)l.push(this.data[this.pos++]);return l},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(o){var s=this.pixelBitlength/8,l=new Uint8Array(this.width*this.height*s),c=0,u=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function h(y,g,f,x){var S,P,$,U,se,X,Z,re,E,C,T,j,b,w,_,W,K,k,R,Y,q,O=Math.ceil((u.width-y)/f),le=Math.ceil((u.height-g)/x),N=u.width==O&&u.height==le;for(w=s*O,j=N?l:new Uint8Array(w*le),X=o.length,b=0,P=0;b<le&&c<X;){switch(o[c++]){case 0:for(U=K=0;K<w;U=K+=1)j[P++]=o[c++];break;case 1:for(U=k=0;k<w;U=k+=1)S=o[c++],se=U<s?0:j[P-s],j[P++]=(S+se)%256;break;case 2:for(U=R=0;R<w;U=R+=1)S=o[c++],$=(U-U%s)/s,_=b&&j[(b-1)*w+$*s+U%s],j[P++]=(_+S)%256;break;case 3:for(U=Y=0;Y<w;U=Y+=1)S=o[c++],$=(U-U%s)/s,se=U<s?0:j[P-s],_=b&&j[(b-1)*w+$*s+U%s],j[P++]=(S+Math.floor((se+_)/2))%256;break;case 4:for(U=q=0;q<w;U=q+=1)S=o[c++],$=(U-U%s)/s,se=U<s?0:j[P-s],b===0?_=W=0:(_=j[(b-1)*w+$*s+U%s],W=$&&j[(b-1)*w+($-1)*s+U%s]),Z=se+_-W,re=Math.abs(Z-se),C=Math.abs(Z-_),T=Math.abs(Z-W),E=re<=C&&re<=T?se:C<=T?_:W,j[P++]=(S+E)%256;break;default:throw new Error("Invalid filter algorithm: "+o[c-1])}if(!N){var D=((g+b*x)*u.width+y)*s,V=b*w;for(U=0;U<O;U+=1){for(var I=0;I<s;I+=1)l[D++]=j[V++];D+=(f-1)*s}}b++}}return o=EL(o),u.interlaceMethod==1?(h(0,0,8,8),h(4,0,8,8),h(0,4,4,8),h(2,0,4,4),h(0,2,2,4),h(1,0,2,2),h(0,1,1,2)):h(0,0,1,1),l},n.prototype.decodePalette=function(){var o,s,l,c,u,h,y,g,f;for(l=this.palette,h=this.transparency.indexed||[],u=new Uint8Array((h.length||0)+l.length),c=0,o=0,s=y=0,g=l.length;y<g;s=y+=3)u[c++]=l[s],u[c++]=l[s+1],u[c++]=l[s+2],u[c++]=(f=h[o++])!=null?f:255;return u},n.prototype.copyToImageData=function(o,s){var l,c,u,h,y,g,f,x,S,P,$;if(c=this.colors,S=null,l=this.hasAlphaChannel,this.palette.length&&(S=($=this._decodedPalette)!=null?$:this._decodedPalette=this.decodePalette(),c=4,l=!0),x=(u=o.data||o).length,y=S||s,h=g=0,c===1)for(;h<x;)f=S?4*s[h/4]:g,P=y[f++],u[h++]=P,u[h++]=P,u[h++]=P,u[h++]=l?y[f++]:255,g=f;else for(;h<x;)f=S?4*s[h/4]:g,u[h++]=y[f++],u[h++]=y[f++],u[h++]=y[f++],u[h++]=l?y[f++]:255,g=f},n.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var i=function(){if(Object.prototype.toString.call(fr)==="[object Window]"){try{e=fr.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return i(),t=function(o){var s;if(i()===!0)return r.width=o.width,r.height=o.height,r.clearRect(0,0,o.width,o.height),r.putImageData(o,0,0),(s=new Image).src=e.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(o){var s,l,c,u,h,y,g,f;if(this.animation){for(f=[],l=h=0,y=(g=this.animation.frames).length;h<y;l=++h)s=g[l],c=o.createImageData(s.width,s.height),u=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(c,u),s.imageData=c,f.push(s.image=t(c));return f}},n.prototype.renderFrame=function(o,s){var l,c,u;return l=(c=this.animation.frames)[s],u=c[s-1],s===0&&o.clearRect(0,0,this.width,this.height),u?.disposeOp===1?o.clearRect(u.xOffset,u.yOffset,u.width,u.height):u?.disposeOp===2&&o.putImageData(u.imageData,u.xOffset,u.yOffset),l.blendOp===0&&o.clearRect(l.xOffset,l.yOffset,l.width,l.height),o.drawImage(l.image,l.xOffset,l.yOffset)},n.prototype.animate=function(o){var s,l,c,u,h,y,g=this;return l=0,y=this.animation,u=y.numFrames,c=y.frames,h=y.numPlays,(s=function(){var f,x;if(f=l++%u,x=c[f],g.renderFrame(o,f),u>1&&l/u<h)return g.animation._timeout=setTimeout(s,x.delay)})()},n.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},n.prototype.render=function(o){var s,l;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,s=o.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(l=s.createImageData(this.width,this.height),this.copyToImageData(l,this.decodePixels()),s.putImageData(l,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function ZL(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],o=i>>7,s=1<<(7&i)+1;t[e++],t[e++];var l=null,c=null;o&&(l=e,c=s,e+=3*s);var u=!0,h=[],y=0,g=null,f=0,x=null;for(this.width=r,this.height=n;u&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,x=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((b=t[e++])>=0))throw Error("Invalid block size");if(b===0)break;e+=b}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var S=t[e++];y=t[e++]|t[e++]<<8,g=t[e++],(1&S)==0&&(g=null),f=S>>2&7,e++;break;case 254:for(;;){if(!((b=t[e++])>=0))throw Error("Invalid block size");if(b===0)break;e+=b}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var P=t[e++]|t[e++]<<8,$=t[e++]|t[e++]<<8,U=t[e++]|t[e++]<<8,se=t[e++]|t[e++]<<8,X=t[e++],Z=X>>6&1,re=1<<(7&X)+1,E=l,C=c,T=!1;X>>7&&(T=!0,E=e,C=re,e+=3*re);var j=e;for(e++;;){var b;if(!((b=t[e++])>=0))throw Error("Invalid block size");if(b===0)break;e+=b}h.push({x:P,y:$,width:U,height:se,has_local_palette:T,palette_offset:E,palette_size:C,data_offset:j,data_length:e-j,transparent_index:g,interlaced:!!Z,delay:y,disposal:f});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return x},this.frameInfo=function(w){if(w<0||w>=h.length)throw new Error("Frame index out of range.");return h[w]},this.decodeAndBlitFrameBGRA=function(w,_){var W=this.frameInfo(w),K=W.width*W.height,k=new Uint8Array(K);rb(t,W.data_offset,k,K);var R=W.palette_offset,Y=W.transparent_index;Y===null&&(Y=256);var q=W.width,O=r-q,le=q,N=4*(W.y*r+W.x),D=4*((W.y+W.height)*r+W.x),V=N,I=4*O;W.interlaced===!0&&(I+=4*r*7);for(var F=8,Q=0,H=k.length;Q<H;++Q){var J=k[Q];if(le===0&&(le=q,(V+=I)>=D&&(I=4*O+4*r*(F-1),V=N+(q+O)*(F<<1),F>>=1)),J===Y)V+=4;else{var te=t[R+3*J],ee=t[R+3*J+1],ne=t[R+3*J+2];_[V++]=ne,_[V++]=ee,_[V++]=te,_[V++]=255}--le}},this.decodeAndBlitFrameRGBA=function(w,_){var W=this.frameInfo(w),K=W.width*W.height,k=new Uint8Array(K);rb(t,W.data_offset,k,K);var R=W.palette_offset,Y=W.transparent_index;Y===null&&(Y=256);var q=W.width,O=r-q,le=q,N=4*(W.y*r+W.x),D=4*((W.y+W.height)*r+W.x),V=N,I=4*O;W.interlaced===!0&&(I+=4*r*7);for(var F=8,Q=0,H=k.length;Q<H;++Q){var J=k[Q];if(le===0&&(le=q,(V+=I)>=D&&(I=4*O+4*r*(F-1),V=N+(q+O)*(F<<1),F>>=1)),J===Y)V+=4;else{var te=t[R+3*J],ee=t[R+3*J+1],ne=t[R+3*J+2];_[V++]=te,_[V++]=ee,_[V++]=ne,_[V++]=255}--le}}}function rb(t,e,r,n){for(var i=t[e++],o=1<<i,s=o+1,l=s+1,c=i+1,u=(1<<c)-1,h=0,y=0,g=0,f=t[e++],x=new Int32Array(4096),S=null;;){for(;h<16&&f!==0;)y|=t[e++]<<h,h+=8,f===1?f=t[e++]:--f;if(h<c)break;var P=y&u;if(y>>=c,h-=c,P!==o){if(P===s)break;for(var $=P<l?P:S,U=0,se=$;se>o;)se=x[se]>>8,++U;var X=se;if(g+U+($!==P?1:0)>n)return void sn.log("Warning, gif stream longer than expected.");r[g++]=X;var Z=g+=U;for($!==P&&(r[g++]=X),se=$;U--;)se=x[se],r[--Z]=255&se,se>>=8;S!==null&&l<4096&&(x[l++]=S<<8|X,l>=u+1&&c<12&&(++c,u=u<<1|1)),S=P}else l=s+1,u=(1<<(c=i+1))-1,S=null}return g!==n&&sn.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Ef(t){var e,r,n,i,o,s=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),h=new Array(64),y=new Array(65535),g=new Array(65535),f=new Array(64),x=new Array(64),S=[],P=0,$=7,U=new Array(64),se=new Array(64),X=new Array(64),Z=new Array(256),re=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],C=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],j=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],b=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],w=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],_=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],K=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function k(N,D){for(var V=0,I=0,F=new Array,Q=1;Q<=16;Q++){for(var H=1;H<=N[Q];H++)F[D[I]]=[],F[D[I]][0]=V,F[D[I]][1]=Q,I++,V++;V*=2}return F}function R(N){for(var D=N[0],V=N[1]-1;V>=0;)D&1<<V&&(P|=1<<$),V--,--$<0&&(P==255?(Y(255),Y(0)):Y(P),$=7,P=0)}function Y(N){S.push(N)}function q(N){Y(N>>8&255),Y(255&N)}function O(N,D,V,I,F){for(var Q,H=F[0],J=F[240],te=function(ue,ge){var xe,pe,_e,Le,De,Te,$e,Ie,Re,Ke,je=0;for(Re=0;Re<8;++Re){xe=ue[je],pe=ue[je+1],_e=ue[je+2],Le=ue[je+3],De=ue[je+4],Te=ue[je+5],$e=ue[je+6];var We=xe+(Ie=ue[je+7]),Qe=xe-Ie,at=pe+$e,nt=pe-$e,Ye=_e+Te,ht=_e-Te,lt=Le+De,$t=Le-De,_t=We+lt,ze=We-lt,Lt=at+Ye,Nt=at-Ye;ue[je]=_t+Lt,ue[je+4]=_t-Lt;var wt=.707106781*(Nt+ze);ue[je+2]=ze+wt,ue[je+6]=ze-wt;var Ot=.382683433*((_t=$t+ht)-(Nt=nt+Qe)),gr=.5411961*_t+Ot,Be=1.306562965*Nt+Ot,Pt=.707106781*(Lt=ht+nt),Ct=Qe+Pt,tt=Qe-Pt;ue[je+5]=tt+gr,ue[je+3]=tt-gr,ue[je+1]=Ct+Be,ue[je+7]=Ct-Be,je+=8}for(je=0,Re=0;Re<8;++Re){xe=ue[je],pe=ue[je+8],_e=ue[je+16],Le=ue[je+24],De=ue[je+32],Te=ue[je+40],$e=ue[je+48];var ft=xe+(Ie=ue[je+56]),Vt=xe-Ie,Rt=pe+$e,rr=pe-$e,it=_e+Te,yt=_e-Te,It=Le+De,Jt=Le-De,Je=ft+It,Et=ft-It,Wt=Rt+it,Yt=Rt-it;ue[je]=Je+Wt,ue[je+32]=Je-Wt;var er=.707106781*(Yt+Et);ue[je+16]=Et+er,ue[je+48]=Et-er;var kt=.382683433*((Je=Jt+yt)-(Yt=rr+Vt)),Xt=.5411961*Je+kt,tr=1.306562965*Yt+kt,Zt=.707106781*(Wt=yt+rr),vt=Vt+Zt,ir=Vt-Zt;ue[je+40]=ir+Xt,ue[je+24]=ir-Xt,ue[je+8]=vt+tr,ue[je+56]=vt-tr,je++}for(Re=0;Re<64;++Re)Ke=ue[Re]*ge[Re],f[Re]=Ke>0?Ke+.5|0:Ke-.5|0;return f}(N,D),ee=0;ee<64;++ee)x[E[ee]]=te[ee];var ne=x[0]-V;V=x[0],ne==0?R(I[0]):(R(I[g[Q=32767+ne]]),R(y[Q]));for(var G=63;G>0&&x[G]==0;)G--;if(G==0)return R(H),V;for(var ce,oe=1;oe<=G;){for(var z=oe;x[oe]==0&&oe<=G;)++oe;var de=oe-z;if(de>=16){ce=de>>4;for(var fe=1;fe<=ce;++fe)R(J);de&=15}Q=32767+x[oe],R(F[(de<<4)+g[Q]]),R(y[Q]),oe++}return G!=63&&R(H),V}function le(N){N=Math.min(Math.max(N,1),100),o!=N&&(function(D){for(var V=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],I=0;I<64;I++){var F=s((V[I]*D+50)/100);F=Math.min(Math.max(F,1),255),l[E[I]]=F}for(var Q=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],H=0;H<64;H++){var J=s((Q[H]*D+50)/100);J=Math.min(Math.max(J,1),255),c[E[H]]=J}for(var te=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ee=0,ne=0;ne<8;ne++)for(var G=0;G<8;G++)u[ee]=1/(l[E[ee]]*te[ne]*te[G]*8),h[ee]=1/(c[E[ee]]*te[ne]*te[G]*8),ee++}(N<50?Math.floor(5e3/N):Math.floor(200-2*N)),o=N)}this.encode=function(N,D){D&&le(D),S=new Array,P=0,$=7,q(65496),q(65504),q(16),Y(74),Y(70),Y(73),Y(70),Y(0),Y(1),Y(1),Y(0),q(1),q(1),Y(0),Y(0),function(){q(65499),q(132),Y(0);for(var pe=0;pe<64;pe++)Y(l[pe]);Y(1);for(var _e=0;_e<64;_e++)Y(c[_e])}(),function(pe,_e){q(65472),q(17),Y(8),q(_e),q(pe),Y(3),Y(1),Y(17),Y(0),Y(2),Y(17),Y(1),Y(3),Y(17),Y(1)}(N.width,N.height),function(){q(65476),q(418),Y(0);for(var pe=0;pe<16;pe++)Y(C[pe+1]);for(var _e=0;_e<=11;_e++)Y(T[_e]);Y(16);for(var Le=0;Le<16;Le++)Y(j[Le+1]);for(var De=0;De<=161;De++)Y(b[De]);Y(1);for(var Te=0;Te<16;Te++)Y(w[Te+1]);for(var $e=0;$e<=11;$e++)Y(_[$e]);Y(17);for(var Ie=0;Ie<16;Ie++)Y(W[Ie+1]);for(var Re=0;Re<=161;Re++)Y(K[Re])}(),q(65498),q(12),Y(3),Y(1),Y(0),Y(2),Y(17),Y(3),Y(17),Y(0),Y(63),Y(0);var V=0,I=0,F=0;P=0,$=7,this.encode.displayName="_encode_";for(var Q,H,J,te,ee,ne,G,ce,oe,z=N.data,de=N.width,fe=N.height,ue=4*de,ge=0;ge<fe;){for(Q=0;Q<ue;){for(ee=ue*ge+Q,G=-1,ce=0,oe=0;oe<64;oe++)ne=ee+(ce=oe>>3)*ue+(G=4*(7&oe)),ge+ce>=fe&&(ne-=ue*(ge+1+ce-fe)),Q+G>=ue&&(ne-=Q+G-ue+4),H=z[ne++],J=z[ne++],te=z[ne++],U[oe]=(re[H]+re[J+256>>0]+re[te+512>>0]>>16)-128,se[oe]=(re[H+768>>0]+re[J+1024>>0]+re[te+1280>>0]>>16)-128,X[oe]=(re[H+1280>>0]+re[J+1536>>0]+re[te+1792>>0]>>16)-128;V=O(U,u,V,e,n),I=O(se,h,I,r,i),F=O(X,h,F,r,i),Q+=32}ge+=8}if($>=0){var xe=[];xe[1]=$+1,xe[0]=(1<<$+1)-1,R(xe)}return q(65497),new Uint8Array(S)},t=t||50,function(){for(var N=String.fromCharCode,D=0;D<256;D++)Z[D]=N(D)}(),e=k(C,T),r=k(w,_),n=k(j,b),i=k(W,K),function(){for(var N=1,D=2,V=1;V<=15;V++){for(var I=N;I<D;I++)g[32767+I]=V,y[32767+I]=[],y[32767+I][1]=V,y[32767+I][0]=I;for(var F=-(D-1);F<=-N;F++)g[32767+F]=V,y[32767+F]=[],y[32767+F][1]=V,y[32767+F][0]=D-1+F;N<<=1,D<<=1}}(),function(){for(var N=0;N<256;N++)re[N]=19595*N,re[N+256>>0]=38470*N,re[N+512>>0]=7471*N+32768,re[N+768>>0]=-11059*N,re[N+1024>>0]=-21709*N,re[N+1280>>0]=32768*N+8421375,re[N+1536>>0]=-27439*N,re[N+1792>>0]=-5329*N}(),le(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Po(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function nb(t){function e(C){if(!C)throw Error("assert :P")}function r(C,T,j){for(var b=0;4>b;b++)if(C[T+b]!=j.charCodeAt(b))return!0;return!1}function n(C,T,j,b,w){for(var _=0;_<w;_++)C[T+_]=j[b+_]}function i(C,T,j,b){for(var w=0;w<b;w++)C[T+w]=j}function o(C){return new Int32Array(C)}function s(C,T){for(var j=[],b=0;b<C;b++)j.push(new T);return j}function l(C,T){var j=[];return function b(w,_,W){for(var K=W[_],k=0;k<K&&(w.push(W.length>_+1?[]:new T),!(W.length<_+1));k++)b(w[k],_+1,W)}(j,0,C),j}var c=function(){var C=this;function T(d,v){for(var L=1<<v-1>>>0;d&L;)L>>>=1;return L?(d&L-1)+L:d}function j(d,v,L,ie,ye){e(!(ie%L));do d[v+(ie-=L)]=ye;while(0<ie)}function b(d,v,L,ie,ye){if(e(2328>=ye),512>=ye)var ve=o(512);else if((ve=o(ye))==null)return 0;return function(be,we,Ae,ke,Fe,Xe){var Ze,He,gt=we,rt=1<<Ae,Oe=o(16),Ve=o(16);for(e(Fe!=0),e(ke!=null),e(be!=null),e(0<Ae),He=0;He<Fe;++He){if(15<ke[He])return 0;++Oe[ke[He]]}if(Oe[0]==Fe)return 0;for(Ve[1]=0,Ze=1;15>Ze;++Ze){if(Oe[Ze]>1<<Ze)return 0;Ve[Ze+1]=Ve[Ze]+Oe[Ze]}for(He=0;He<Fe;++He)Ze=ke[He],0<ke[He]&&(Xe[Ve[Ze]++]=He);if(Ve[15]==1)return(ke=new w).g=0,ke.value=Xe[0],j(be,gt,1,rt,ke),rt;var pt,St=-1,mt=rt-1,Gt=0,Bt=1,ur=1,qt=1<<Ae;for(He=0,Ze=1,Fe=2;Ze<=Ae;++Ze,Fe<<=1){if(Bt+=ur<<=1,0>(ur-=Oe[Ze]))return 0;for(;0<Oe[Ze];--Oe[Ze])(ke=new w).g=Ze,ke.value=Xe[He++],j(be,gt+Gt,Fe,qt,ke),Gt=T(Gt,Ze)}for(Ze=Ae+1,Fe=2;15>=Ze;++Ze,Fe<<=1){if(Bt+=ur<<=1,0>(ur-=Oe[Ze]))return 0;for(;0<Oe[Ze];--Oe[Ze]){if(ke=new w,(Gt&mt)!=St){for(gt+=qt,pt=1<<(St=Ze)-Ae;15>St&&!(0>=(pt-=Oe[St]));)++St,pt<<=1;rt+=qt=1<<(pt=St-Ae),be[we+(St=Gt&mt)].g=pt+Ae,be[we+St].value=gt-we-St}ke.g=Ze-Ae,ke.value=Xe[He++],j(be,gt+(Gt>>Ae),Fe,qt,ke),Gt=T(Gt,Ze)}}return Bt!=2*Ve[15]-1?0:rt}(d,v,L,ie,ye,ve)}function w(){this.value=this.g=0}function _(){this.value=this.g=0}function W(){this.G=s(5,w),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Jn,_)}function K(d,v,L,ie){e(d!=null),e(v!=null),e(2147483648>ie),d.Ca=254,d.I=0,d.b=-8,d.Ka=0,d.oa=v,d.pa=L,d.Jd=v,d.Yc=L+ie,d.Zc=4<=ie?L+ie-4+1:L,Q(d)}function k(d,v){for(var L=0;0<v--;)L|=J(d,128)<<v;return L}function R(d,v){var L=k(d,v);return H(d)?-L:L}function Y(d,v,L,ie){var ye,ve=0;for(e(d!=null),e(v!=null),e(4294967288>ie),d.Sb=ie,d.Ra=0,d.u=0,d.h=0,4<ie&&(ie=4),ye=0;ye<ie;++ye)ve+=v[L+ye]<<8*ye;d.Ra=ve,d.bb=ie,d.oa=v,d.pa=L}function q(d){for(;8<=d.u&&d.bb<d.Sb;)d.Ra>>>=8,d.Ra+=d.oa[d.pa+d.bb]<<Bl-8>>>0,++d.bb,d.u-=8;V(d)&&(d.h=1,d.u=0)}function O(d,v){if(e(0<=v),!d.h&&v<=Ol){var L=D(d)&Fl[v];return d.u+=v,q(d),L}return d.h=1,d.u=0}function le(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function N(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function D(d){return d.Ra>>>(d.u&Bl-1)>>>0}function V(d){return e(d.bb<=d.Sb),d.h||d.bb==d.Sb&&d.u>Bl}function I(d,v){d.u=v,d.h=V(d)}function F(d){d.u>=Fc&&(e(d.u>=Fc),q(d))}function Q(d){e(d!=null&&d.oa!=null),d.pa<d.Zc?(d.I=(d.oa[d.pa++]|d.I<<8)>>>0,d.b+=8):(e(d!=null&&d.oa!=null),d.pa<d.Yc?(d.b+=8,d.I=d.oa[d.pa++]|d.I<<8):d.Ka?d.b=0:(d.I<<=8,d.b+=8,d.Ka=1))}function H(d){return k(d,1)}function J(d,v){var L=d.Ca;0>d.b&&Q(d);var ie=d.b,ye=L*v>>>8,ve=(d.I>>>ie>ye)+0;for(ve?(L-=ye,d.I-=ye+1<<ie>>>0):L=ye+1,ie=L,ye=0;256<=ie;)ye+=8,ie>>=8;return ie=7^ye+Ei[ie],d.b-=ie,d.Ca=(L<<ie)-1,ve}function te(d,v,L){d[v+0]=L>>24&255,d[v+1]=L>>16&255,d[v+2]=L>>8&255,d[v+3]=L>>0&255}function ee(d,v){return d[v+0]<<0|d[v+1]<<8}function ne(d,v){return ee(d,v)|d[v+2]<<16}function G(d,v){return ee(d,v)|ee(d,v+2)<<16}function ce(d,v){var L=1<<v;return e(d!=null),e(0<v),d.X=o(L),d.X==null?0:(d.Mb=32-v,d.Xa=v,1)}function oe(d,v){e(d!=null),e(v!=null),e(d.Xa==v.Xa),n(v.X,0,d.X,0,1<<v.Xa)}function z(){this.X=[],this.Xa=this.Mb=0}function de(d,v,L,ie){e(L!=null),e(ie!=null);var ye=L[0],ve=ie[0];return ye==0&&(ye=(d*ve+v/2)/v),ve==0&&(ve=(v*ye+d/2)/d),0>=ye||0>=ve?0:(L[0]=ye,ie[0]=ve,1)}function fe(d,v){return d+(1<<v)-1>>>v}function ue(d,v){return((4278255360&d)+(4278255360&v)>>>0&4278255360)+((16711935&d)+(16711935&v)>>>0&16711935)>>>0}function ge(d,v){C[v]=function(L,ie,ye,ve,be,we,Ae){var ke;for(ke=0;ke<be;++ke){var Fe=C[d](we[Ae+ke-1],ye,ve+ke);we[Ae+ke]=ue(L[ie+ke],Fe)}}}function xe(){this.ud=this.hd=this.jd=0}function pe(d,v){return((4278124286&(d^v))>>>1)+(d&v)>>>0}function _e(d){return 0<=d&&256>d?d:0>d?0:255<d?255:void 0}function Le(d,v){return _e(d+(d-v+.5>>1))}function De(d,v,L){return Math.abs(v-L)-Math.abs(d-L)}function Te(d,v,L,ie,ye,ve,be){for(ie=ve[be-1],L=0;L<ye;++L)ve[be+L]=ie=ue(d[v+L],ie)}function $e(d,v,L,ie,ye){var ve;for(ve=0;ve<L;++ve){var be=d[v+ve],we=be>>8&255,Ae=16711935&(Ae=(Ae=16711935&be)+((we<<16)+we));ie[ye+ve]=(4278255360&be)+Ae>>>0}}function Ie(d,v){v.jd=d>>0&255,v.hd=d>>8&255,v.ud=d>>16&255}function Re(d,v,L,ie,ye,ve){var be;for(be=0;be<ie;++be){var we=v[L+be],Ae=we>>>8,ke=we,Fe=255&(Fe=(Fe=we>>>16)+((d.jd<<24>>24)*(Ae<<24>>24)>>>5));ke=255&(ke=(ke=ke+((d.hd<<24>>24)*(Ae<<24>>24)>>>5))+((d.ud<<24>>24)*(Fe<<24>>24)>>>5)),ye[ve+be]=(4278255360&we)+(Fe<<16)+ke}}function Ke(d,v,L,ie,ye){C[v]=function(ve,be,we,Ae,ke,Fe,Xe,Ze,He){for(Ae=Xe;Ae<Ze;++Ae)for(Xe=0;Xe<He;++Xe)ke[Fe++]=ye(we[ie(ve[be++])])},C[d]=function(ve,be,we,Ae,ke,Fe,Xe){var Ze=8>>ve.b,He=ve.Ea,gt=ve.K[0],rt=ve.w;if(8>Ze)for(ve=(1<<ve.b)-1,rt=(1<<Ze)-1;be<we;++be){var Oe,Ve=0;for(Oe=0;Oe<He;++Oe)Oe&ve||(Ve=ie(Ae[ke++])),Fe[Xe++]=ye(gt[Ve&rt]),Ve>>=Ze}else C["VP8LMapColor"+L](Ae,ke,gt,rt,Fe,Xe,be,we,He)}}function je(d,v,L,ie,ye){for(L=v+L;v<L;){var ve=d[v++];ie[ye++]=ve>>16&255,ie[ye++]=ve>>8&255,ie[ye++]=ve>>0&255}}function We(d,v,L,ie,ye){for(L=v+L;v<L;){var ve=d[v++];ie[ye++]=ve>>16&255,ie[ye++]=ve>>8&255,ie[ye++]=ve>>0&255,ie[ye++]=ve>>24&255}}function Qe(d,v,L,ie,ye){for(L=v+L;v<L;){var ve=(be=d[v++])>>16&240|be>>12&15,be=be>>0&240|be>>28&15;ie[ye++]=ve,ie[ye++]=be}}function at(d,v,L,ie,ye){for(L=v+L;v<L;){var ve=(be=d[v++])>>16&248|be>>13&7,be=be>>5&224|be>>3&31;ie[ye++]=ve,ie[ye++]=be}}function nt(d,v,L,ie,ye){for(L=v+L;v<L;){var ve=d[v++];ie[ye++]=ve>>0&255,ie[ye++]=ve>>8&255,ie[ye++]=ve>>16&255}}function Ye(d,v,L,ie,ye,ve){if(ve==0)for(L=v+L;v<L;)te(ie,((ve=d[v++])[0]>>24|ve[1]>>8&65280|ve[2]<<8&16711680|ve[3]<<24)>>>0),ye+=32;else n(ie,ye,d,v,L)}function ht(d,v){C[v][0]=C[d+"0"],C[v][1]=C[d+"1"],C[v][2]=C[d+"2"],C[v][3]=C[d+"3"],C[v][4]=C[d+"4"],C[v][5]=C[d+"5"],C[v][6]=C[d+"6"],C[v][7]=C[d+"7"],C[v][8]=C[d+"8"],C[v][9]=C[d+"9"],C[v][10]=C[d+"10"],C[v][11]=C[d+"11"],C[v][12]=C[d+"12"],C[v][13]=C[d+"13"],C[v][14]=C[d+"0"],C[v][15]=C[d+"0"]}function lt(d){return d==wp||d==xp||d==md||d==Ap}function $t(){this.eb=[],this.size=this.A=this.fb=0}function _t(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ze(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new $t,this.f.kb=new _t,this.sd=null}function Lt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Nt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function wt(d){return alert("todo:WebPSamplerProcessPlane"),d.T}function Ot(d,v){var L=d.T,ie=v.ba.f.RGBA,ye=ie.eb,ve=ie.fb+d.ka*ie.A,be=io[v.ba.S],we=d.y,Ae=d.O,ke=d.f,Fe=d.N,Xe=d.ea,Ze=d.W,He=v.cc,gt=v.dc,rt=v.Mc,Oe=v.Nc,Ve=d.ka,pt=d.ka+d.T,St=d.U,mt=St+1>>1;for(Ve==0?be(we,Ae,null,null,ke,Fe,Xe,Ze,ke,Fe,Xe,Ze,ye,ve,null,null,St):(be(v.ec,v.fc,we,Ae,He,gt,rt,Oe,ke,Fe,Xe,Ze,ye,ve-ie.A,ye,ve,St),++L);Ve+2<pt;Ve+=2)He=ke,gt=Fe,rt=Xe,Oe=Ze,Fe+=d.Rc,Ze+=d.Rc,ve+=2*ie.A,be(we,(Ae+=2*d.fa)-d.fa,we,Ae,He,gt,rt,Oe,ke,Fe,Xe,Ze,ye,ve-ie.A,ye,ve,St);return Ae+=d.fa,d.j+pt<d.o?(n(v.ec,v.fc,we,Ae,St),n(v.cc,v.dc,ke,Fe,mt),n(v.Mc,v.Nc,Xe,Ze,mt),L--):1&pt||be(we,Ae,null,null,ke,Fe,Xe,Ze,ke,Fe,Xe,Ze,ye,ve+ie.A,null,null,St),L}function gr(d,v,L){var ie=d.F,ye=[d.J];if(ie!=null){var ve=d.U,be=v.ba.S,we=be==fd||be==md;v=v.ba.f.RGBA;var Ae=[0],ke=d.ka;Ae[0]=d.T,d.Kb&&(ke==0?--Ae[0]:(--ke,ye[0]-=d.width),d.j+d.ka+d.T==d.o&&(Ae[0]=d.o-d.j-ke));var Fe=v.eb;ke=v.fb+ke*v.A,d=cn(ie,ye[0],d.width,ve,Ae,Fe,ke+(we?0:3),v.A),e(L==Ae),d&&lt(be)&&ro(Fe,ke,we,ve,Ae,v.A)}return 0}function Be(d){var v=d.ma,L=v.ba.S,ie=11>L,ye=L==hd||L==pd||L==fd||L==Pp||L==12||lt(L);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!Dc(v.Oa,d,ye?11:12))return 0;if(ye&&lt(L)&&xt(),d.da)alert("todo:use_scaling");else{if(ie){if(v.Ib=wt,d.Kb){if(L=d.U+1>>1,v.memory=o(d.U+2*L),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+d.U,v.Mc=v.cc,v.Nc=v.dc+L,v.Ib=Ot,xt()}}else alert("todo:EmitYUV");ye&&(v.Jb=gr,ie&&Ue())}if(ie&&!ag){for(d=0;256>d;++d)j_[d]=89858*(d-128)+gd>>yd,z_[d]=-22014*(d-128)+gd,q_[d]=-45773*(d-128),V_[d]=113618*(d-128)+gd>>yd;for(d=Uc;d<$p;++d)v=76283*(d-16)+gd>>yd,U_[d-Uc]=Qr(v,255),H_[d-Uc]=Qr(v+8>>4,15);ag=1}return 1}function Pt(d){var v=d.ma,L=d.U,ie=d.T;return e(!(1&d.ka)),0>=L||0>=ie?0:(L=v.Ib(d,v),v.Jb!=null&&v.Jb(d,v,L),v.Dc+=L,1)}function Ct(d){d.ma.memory=null}function tt(d,v,L,ie){return O(d,8)!=47?0:(v[0]=O(d,14)+1,L[0]=O(d,14)+1,ie[0]=O(d,1),O(d,3)!=0?0:!d.h)}function ft(d,v){if(4>d)return d+1;var L=d-2>>1;return(2+(1&d)<<L)+O(v,L)+1}function Vt(d,v){return 120<v?v-120:1<=(L=((L=C_[v-1])>>4)*d+(8-(15&L)))?L:1;var L}function Rt(d,v,L){var ie=D(L),ye=d[v+=255&ie].g-8;return 0<ye&&(I(L,L.u+8),ie=D(L),v+=d[v].value,v+=ie&(1<<ye)-1),I(L,L.u+d[v].g),d[v].value}function rr(d,v,L){return L.g+=d.g,L.value+=d.value<<v>>>0,e(8>=L.g),d.g}function it(d,v,L){var ie=d.xc;return e((v=ie==0?0:d.vc[d.md*(L>>ie)+(v>>ie)])<d.Wb),d.Ya[v]}function yt(d,v,L,ie){var ye=d.ab,ve=d.c*v,be=d.C;v=be+v;var we=L,Ae=ie;for(ie=d.Ta,L=d.Ua;0<ye--;){var ke=d.gc[ye],Fe=be,Xe=v,Ze=we,He=Ae,gt=(Ae=ie,we=L,ke.Ea);switch(e(Fe<Xe),e(Xe<=ke.nc),ke.hc){case 2:od(Ze,He,(Xe-Fe)*gt,Ae,we);break;case 0:var rt=Fe,Oe=Xe,Ve=Ae,pt=we,St=(qt=ke).Ea;rt==0&&(_p(Ze,He,null,null,1,Ve,pt),Te(Ze,He+1,0,0,St-1,Ve,pt+1),He+=St,pt+=St,++rt);for(var mt=1<<qt.b,Gt=mt-1,Bt=fe(St,qt.b),ur=qt.K,qt=qt.w+(rt>>qt.b)*Bt;rt<Oe;){var Wr=ur,Zr=qt,zr=1;for(Oc(Ze,He,Ve,pt-St,1,Ve,pt);zr<St;){var Dr=(zr&~Gt)+mt;Dr>St&&(Dr=St),(0,Gs[Wr[Zr++]>>8&15])(Ze,He+ +zr,Ve,pt+zr-St,Dr-zr,Ve,pt+zr),zr=Dr}He+=St,pt+=St,++rt&Gt||(qt+=Bt)}Xe!=ke.nc&&n(Ae,we-gt,Ae,we+(Xe-Fe-1)*gt,gt);break;case 1:for(gt=Ze,Oe=He,St=(Ze=ke.Ea)-(pt=Ze&~(Ve=(He=1<<ke.b)-1)),rt=fe(Ze,ke.b),mt=ke.K,ke=ke.w+(Fe>>ke.b)*rt;Fe<Xe;){for(Gt=mt,Bt=ke,ur=new xe,qt=Oe+pt,Wr=Oe+Ze;Oe<qt;)Ie(Gt[Bt++],ur),Ha(ur,gt,Oe,He,Ae,we),Oe+=He,we+=He;Oe<Wr&&(Ie(Gt[Bt++],ur),Ha(ur,gt,Oe,St,Ae,we),Oe+=St,we+=St),++Fe&Ve||(ke+=rt)}break;case 3:if(Ze==Ae&&He==we&&0<ke.b){for(Oe=Ae,Ze=gt=we+(Xe-Fe)*gt-(pt=(Xe-Fe)*fe(ke.Ea,ke.b)),He=Ae,Ve=we,rt=[],pt=(St=pt)-1;0<=pt;--pt)rt[pt]=He[Ve+pt];for(pt=St-1;0<=pt;--pt)Oe[Ze+pt]=rt[pt];Zi(ke,Fe,Xe,Ae,gt,Ae,we)}else Zi(ke,Fe,Xe,Ze,He,Ae,we)}we=ie,Ae=L}Ae!=L&&n(ie,L,we,Ae,ve)}function It(d,v){var L=d.V,ie=d.Ba+d.c*d.C,ye=v-d.C;if(e(v<=d.l.o),e(16>=ye),0<ye){var ve=d.l,be=d.Ta,we=d.Ua,Ae=ve.width;if(yt(d,ye,L,ie),ye=we=[we],e((L=d.C)<(ie=v)),e(ve.v<ve.va),ie>ve.o&&(ie=ve.o),L<ve.j){var ke=ve.j-L;L=ve.j,ye[0]+=ke*Ae}if(L>=ie?L=0:(ye[0]+=4*ve.v,ve.ka=L-ve.j,ve.U=ve.va-ve.v,ve.T=ie-L,L=1),L){if(we=we[0],11>(L=d.ca).S){var Fe=L.f.RGBA,Xe=(ie=L.S,ye=ve.U,ve=ve.T,ke=Fe.eb,Fe.A),Ze=ve;for(Fe=Fe.fb+d.Ma*Fe.A;0<Ze--;){var He=be,gt=we,rt=ye,Oe=ke,Ve=Fe;switch(ie){case dd:Ti(He,gt,rt,Oe,Ve);break;case hd:xi(He,gt,rt,Oe,Ve);break;case wp:xi(He,gt,rt,Oe,Ve),ro(Oe,Ve,0,rt,1,0);break;case Xy:ls(He,gt,rt,Oe,Ve);break;case pd:Ye(He,gt,rt,Oe,Ve,1);break;case xp:Ye(He,gt,rt,Oe,Ve,1),ro(Oe,Ve,0,rt,1,0);break;case fd:Ye(He,gt,rt,Oe,Ve,0);break;case md:Ye(He,gt,rt,Oe,Ve,0),ro(Oe,Ve,1,rt,1,0);break;case Pp:Ws(He,gt,rt,Oe,Ve);break;case Ap:Ws(He,gt,rt,Oe,Ve),ln(Oe,Ve,rt,1,0);break;case Zy:as(He,gt,rt,Oe,Ve);break;default:e(0)}we+=Ae,Fe+=Xe}d.Ma+=ve}else alert("todo:EmitRescaledRowsYUVA");e(d.Ma<=L.height)}}d.C=v,e(d.C<=d.i)}function Jt(d){var v;if(0<d.ua)return 0;for(v=0;v<d.Wb;++v){var L=d.Ya[v].G,ie=d.Ya[v].H;if(0<L[1][ie[1]+0].g||0<L[2][ie[2]+0].g||0<L[3][ie[3]+0].g)return 0}return 1}function Je(d,v,L,ie,ye,ve){if(d.Z!=0){var be=d.qd,we=d.rd;for(e(Qs[d.Z]!=null);v<L;++v)Qs[d.Z](be,we,ie,ye,ie,ye,ve),be=ie,we=ye,ye+=ve;d.qd=be,d.rd=we}}function Et(d,v){var L=d.l.ma,ie=L.Z==0||L.Z==1?d.l.j:d.C;if(ie=d.C<ie?ie:d.C,e(v<=d.l.o),v>ie){var ye=d.l.width,ve=L.ca,be=L.tb+ye*ie,we=d.V,Ae=d.Ba+d.c*ie,ke=d.gc;e(d.ab==1),e(ke[0].hc==3),sd(ke[0],ie,v,we,Ae,ve,be),Je(L,ie,v,ve,be,ye)}d.C=d.Ma=v}function Wt(d,v,L,ie,ye,ve,be){var we=d.$/ie,Ae=d.$%ie,ke=d.m,Fe=d.s,Xe=L+d.$,Ze=Xe;ye=L+ie*ye;var He=L+ie*ve,gt=280+Fe.ua,rt=d.Pb?we:16777216,Oe=0<Fe.ua?Fe.Wa:null,Ve=Fe.wc,pt=Xe<He?it(Fe,Ae,we):null;e(d.C<ve),e(He<=ye);var St=!1;e:for(;;){for(;St||Xe<He;){var mt=0;if(we>=rt){var Gt=Xe-L;e((rt=d).Pb),rt.wd=rt.m,rt.xd=Gt,0<rt.s.ua&&oe(rt.s.Wa,rt.s.vb),rt=we+$_}if(Ae&Ve||(pt=it(Fe,Ae,we)),e(pt!=null),pt.Qb&&(v[Xe]=pt.qb,St=!0),!St)if(F(ke),pt.jc){mt=ke,Gt=v;var Bt=Xe,ur=pt.pd[D(mt)&Jn-1];e(pt.jc),256>ur.g?(I(mt,mt.u+ur.g),Gt[Bt]=ur.value,mt=0):(I(mt,mt.u+ur.g-256),e(256<=ur.value),mt=ur.value),mt==0&&(St=!0)}else mt=Rt(pt.G[0],pt.H[0],ke);if(ke.h)break;if(St||256>mt){if(!St)if(pt.nd)v[Xe]=(pt.qb|mt<<8)>>>0;else{if(F(ke),St=Rt(pt.G[1],pt.H[1],ke),F(ke),Gt=Rt(pt.G[2],pt.H[2],ke),Bt=Rt(pt.G[3],pt.H[3],ke),ke.h)break;v[Xe]=(Bt<<24|St<<16|mt<<8|Gt)>>>0}if(St=!1,++Xe,++Ae>=ie&&(Ae=0,++we,be!=null&&we<=ve&&!(we%16)&&be(d,we),Oe!=null))for(;Ze<Xe;)mt=v[Ze++],Oe.X[(506832829*mt&4294967295)>>>Oe.Mb]=mt}else if(280>mt){if(mt=ft(mt-256,ke),Gt=Rt(pt.G[4],pt.H[4],ke),F(ke),Gt=Vt(ie,Gt=ft(Gt,ke)),ke.h)break;if(Xe-L<Gt||ye-Xe<mt)break e;for(Bt=0;Bt<mt;++Bt)v[Xe+Bt]=v[Xe+Bt-Gt];for(Xe+=mt,Ae+=mt;Ae>=ie;)Ae-=ie,++we,be!=null&&we<=ve&&!(we%16)&&be(d,we);if(e(Xe<=ye),Ae&Ve&&(pt=it(Fe,Ae,we)),Oe!=null)for(;Ze<Xe;)mt=v[Ze++],Oe.X[(506832829*mt&4294967295)>>>Oe.Mb]=mt}else{if(!(mt<gt))break e;for(St=mt-280,e(Oe!=null);Ze<Xe;)mt=v[Ze++],Oe.X[(506832829*mt&4294967295)>>>Oe.Mb]=mt;mt=Xe,e(!(St>>>(Gt=Oe).Xa)),v[mt]=Gt.X[St],St=!0}St||e(ke.h==V(ke))}if(d.Pb&&ke.h&&Xe<ye)e(d.m.h),d.a=5,d.m=d.wd,d.$=d.xd,0<d.s.ua&&oe(d.s.vb,d.s.Wa);else{if(ke.h)break e;be?.(d,we>ve?ve:we),d.a=0,d.$=Xe-L}return 1}return d.a=3,0}function Yt(d){e(d!=null),d.vc=null,d.yc=null,d.Ya=null;var v=d.Wa;v!=null&&(v.X=null),d.vb=null,e(d!=null)}function er(){var d=new Dl;return d==null?null:(d.a=0,d.xb=rg,ht("Predictor","VP8LPredictors"),ht("Predictor","VP8LPredictors_C"),ht("PredictorAdd","VP8LPredictorsAdd"),ht("PredictorAdd","VP8LPredictorsAdd_C"),od=$e,Ha=Re,Ti=je,xi=We,Ws=Qe,as=at,ls=nt,C.VP8LMapColor32b=jl,C.VP8LMapColor8b=ad,d)}function kt(d,v,L,ie,ye){var ve=1,be=[d],we=[v],Ae=ie.m,ke=ie.s,Fe=null,Xe=0;e:for(;;){if(L)for(;ve&&O(Ae,1);){var Ze=be,He=we,gt=ie,rt=1,Oe=gt.m,Ve=gt.gc[gt.ab],pt=O(Oe,2);if(gt.Oc&1<<pt)ve=0;else{switch(gt.Oc|=1<<pt,Ve.hc=pt,Ve.Ea=Ze[0],Ve.nc=He[0],Ve.K=[null],++gt.ab,e(4>=gt.ab),pt){case 0:case 1:Ve.b=O(Oe,3)+2,rt=kt(fe(Ve.Ea,Ve.b),fe(Ve.nc,Ve.b),0,gt,Ve.K),Ve.K=Ve.K[0];break;case 3:var St,mt=O(Oe,8)+1,Gt=16<mt?0:4<mt?1:2<mt?2:3;if(Ze[0]=fe(Ve.Ea,Gt),Ve.b=Gt,St=rt=kt(mt,1,0,gt,Ve.K)){var Bt,ur=mt,qt=Ve,Wr=1<<(8>>qt.b),Zr=o(Wr);if(Zr==null)St=0;else{var zr=qt.K[0],Dr=qt.w;for(Zr[0]=qt.K[0][0],Bt=1;Bt<1*ur;++Bt)Zr[Bt]=ue(zr[Dr+Bt],Zr[Bt-1]);for(;Bt<4*Wr;++Bt)Zr[Bt]=0;qt.K[0]=null,qt.K[0]=Zr,St=1}}rt=St;break;case 2:break;default:e(0)}ve=rt}}if(be=be[0],we=we[0],ve&&O(Ae,1)&&!(ve=1<=(Xe=O(Ae,4))&&11>=Xe)){ie.a=3;break e}var on;if(on=ve)t:{var rn,$r,Tn,ki=ie,kn=be,Ni=we,en=Xe,Gi=L,Wi=ki.m,Un=ki.s,Qn=[null],Ci=1,oo=0,Bo=I_[en];r:for(;;){if(Gi&&O(Wi,1)){var Hn=O(Wi,3)+2,hs=fe(kn,Hn),Ja=fe(Ni,Hn),Hl=hs*Ja;if(!kt(hs,Ja,0,ki,Qn))break r;for(Qn=Qn[0],Un.xc=Hn,rn=0;rn<Hl;++rn){var Xs=Qn[rn]>>8&65535;Qn[rn]=Xs,Xs>=Ci&&(Ci=Xs+1)}}if(Wi.h)break r;for($r=0;5>$r;++$r){var vn=eg[$r];!$r&&0<en&&(vn+=1<<en),oo<vn&&(oo=vn)}var Ep=s(Ci*Bo,w),ug=Ci,dg=s(ug,W);if(dg==null)var bd=null;else e(65536>=ug),bd=dg;var Hc=o(oo);if(bd==null||Hc==null||Ep==null){ki.a=1;break r}var _d=Ep;for(rn=Tn=0;rn<Ci;++rn){var bo=bd[rn],Gl=bo.G,Wl=bo.H,hg=0,Sd=1,pg=0;for($r=0;5>$r;++$r){vn=eg[$r],Gl[$r]=_d,Wl[$r]=Tn,!$r&&0<en&&(vn+=1<<en);i:{var Pd,Tp=vn,wd=ki,Gc=Hc,Y_=_d,K_=Tn,kp=0,Zs=wd.m,J_=O(Zs,1);if(i(Gc,0,0,Tp),J_){var Q_=O(Zs,1)+1,X_=O(Zs,1),fg=O(Zs,X_==0?1:8);Gc[fg]=1,Q_==2&&(Gc[fg=O(Zs,8)]=1);var xd=1}else{var mg=o(19),yg=O(Zs,4)+4;if(19<yg){wd.a=3;var Ad=0;break i}for(Pd=0;Pd<yg;++Pd)mg[A_[Pd]]=O(Zs,3);var Np=void 0,Wc=void 0,gg=wd,Z_=mg,Cd=Tp,vg=Gc,Lp=0,ea=gg.m,bg=8,_g=s(128,w);n:for(;b(_g,0,7,Z_,19);){if(O(ea,1)){var eS=2+2*O(ea,3);if((Np=2+O(ea,eS))>Cd)break n}else Np=Cd;for(Wc=0;Wc<Cd&&Np--;){F(ea);var Sg=_g[0+(127&D(ea))];I(ea,ea.u+Sg.g);var Yl=Sg.value;if(16>Yl)vg[Wc++]=Yl,Yl!=0&&(bg=Yl);else{var tS=Yl==16,Pg=Yl-16,rS=w_[Pg],wg=O(ea,P_[Pg])+rS;if(Wc+wg>Cd)break n;for(var nS=tS?bg:0;0<wg--;)vg[Wc++]=nS}}Lp=1;break n}Lp||(gg.a=3),xd=Lp}(xd=xd&&!Zs.h)&&(kp=b(Y_,K_,8,Gc,Tp)),xd&&kp!=0?Ad=kp:(wd.a=3,Ad=0)}if(Ad==0)break r;if(Sd&&x_[$r]==1&&(Sd=_d[Tn].g==0),hg+=_d[Tn].g,Tn+=Ad,3>=$r){var Yc,Rp=Hc[0];for(Yc=1;Yc<vn;++Yc)Hc[Yc]>Rp&&(Rp=Hc[Yc]);pg+=Rp}}if(bo.nd=Sd,bo.Qb=0,Sd&&(bo.qb=(Gl[3][Wl[3]+0].value<<24|Gl[1][Wl[1]+0].value<<16|Gl[2][Wl[2]+0].value)>>>0,hg==0&&256>Gl[0][Wl[0]+0].value&&(bo.Qb=1,bo.qb+=Gl[0][Wl[0]+0].value<<8)),bo.jc=!bo.Qb&&6>pg,bo.jc){var Id,ps=bo;for(Id=0;Id<Jn;++Id){var ta=Id,ra=ps.pd[ta],$d=ps.G[0][ps.H[0]+ta];256<=$d.value?(ra.g=$d.g+256,ra.value=$d.value):(ra.g=0,ra.value=0,ta>>=rr($d,8,ra),ta>>=rr(ps.G[1][ps.H[1]+ta],16,ra),ta>>=rr(ps.G[2][ps.H[2]+ta],0,ra),rr(ps.G[3][ps.H[3]+ta],24,ra))}}}Un.vc=Qn,Un.Wb=Ci,Un.Ya=bd,Un.yc=Ep,on=1;break t}on=0}if(!(ve=on)){ie.a=3;break e}if(0<Xe){if(ke.ua=1<<Xe,!ce(ke.Wa,Xe)){ie.a=1,ve=0;break e}}else ke.ua=0;var Dp=ie,xg=be,iS=we,Mp=Dp.s,Fp=Mp.xc;if(Dp.c=xg,Dp.i=iS,Mp.md=fe(xg,Fp),Mp.wc=Fp==0?-1:(1<<Fp)-1,L){ie.xb=D_;break e}if((Fe=o(be*we))==null){ie.a=1,ve=0;break e}ve=(ve=Wt(ie,Fe,0,be,we,we,null))&&!Ae.h;break e}return ve?(ye!=null?ye[0]=Fe:(e(Fe==null),e(L)),ie.$=0,L||Yt(ke)):Yt(ke),ve}function Xt(d,v){var L=d.c*d.i,ie=L+v+16*v;return e(d.c<=v),d.V=o(ie),d.V==null?(d.Ta=null,d.Ua=0,d.a=1,0):(d.Ta=d.V,d.Ua=d.Ba+L+v,1)}function tr(d,v){var L=d.C,ie=v-L,ye=d.V,ve=d.Ba+d.c*L;for(e(v<=d.l.o);0<ie;){var be=16<ie?16:ie,we=d.l.ma,Ae=d.l.width,ke=Ae*be,Fe=we.ca,Xe=we.tb+Ae*L,Ze=d.Ta,He=d.Ua;yt(d,be,ye,ve),wn(Ze,He,Fe,Xe,ke),Je(we,L,L+be,Fe,Xe,Ae),ie-=be,ye+=be*d.c,L+=be}e(L==v),d.C=d.Ma=v}function Zt(){this.ub=this.yd=this.td=this.Rb=0}function vt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ir(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function Tt(){this.Yb=function(){var d=[];return function v(L,ie,ye){for(var ve=ye[ie],be=0;be<ve&&(L.push(ye.length>ie+1?[]:0),!(ye.length<ie+1));be++)v(L[be],ie+1,ye)}(d,0,[3,11]),d}()}function Ir(){this.jb=o(3),this.Wc=l([4,8],Tt),this.Xc=l([4,17],Tt)}function or(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function cr(){this.ld=this.La=this.dd=this.tc=0}function _r(){this.Na=this.la=0}function Tr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function kr(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function lr(){this.uc=this.M=this.Nb=0,this.wa=Array(new cr),this.Y=0,this.ya=Array(new kr),this.aa=0,this.l=new gn}function Mt(){this.y=o(16),this.f=o(8),this.ea=o(8)}function yn(){this.cb=this.a=0,this.sc="",this.m=new le,this.Od=new Zt,this.Kc=new vt,this.ed=new or,this.Qa=new ir,this.Ic=this.$c=this.Aa=0,this.D=new lr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,le),this.ia=0,this.pb=s(4,Tr),this.Pa=new Ir,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Mt),this.Hd=0,this.rb=Array(new _r),this.sb=0,this.wa=Array(new cr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new kr),this.L=this.aa=0,this.gd=l([4,2],cr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function gn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function En(){var d=new yn;return d!=null&&(d.a=0,d.sc="OK",d.cb=0,d.Xb=0,zc||(zc=_i)),d}function Nr(d,v,L){return d.a==0&&(d.a=v,d.sc=L,d.cb=0),0}function On(d,v,L){return 3<=L&&d[v+0]==157&&d[v+1]==1&&d[v+2]==42}function bi(d,v){if(d==null)return 0;if(d.a=0,d.sc="OK",v==null)return Nr(d,2,"null VP8Io passed to VP8GetHeaders()");var L=v.data,ie=v.w,ye=v.ha;if(4>ye)return Nr(d,7,"Truncated header.");var ve=L[ie+0]|L[ie+1]<<8|L[ie+2]<<16,be=d.Od;if(be.Rb=!(1&ve),be.td=ve>>1&7,be.yd=ve>>4&1,be.ub=ve>>5,3<be.td)return Nr(d,3,"Incorrect keyframe parameters.");if(!be.yd)return Nr(d,4,"Frame not displayable.");ie+=3,ye-=3;var we=d.Kc;if(be.Rb){if(7>ye)return Nr(d,7,"cannot parse picture header");if(!On(L,ie,ye))return Nr(d,3,"Bad code word");we.c=16383&(L[ie+4]<<8|L[ie+3]),we.Td=L[ie+4]>>6,we.i=16383&(L[ie+6]<<8|L[ie+5]),we.Ud=L[ie+6]>>6,ie+=7,ye-=7,d.za=we.c+15>>4,d.Ub=we.i+15>>4,v.width=we.c,v.height=we.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,i((ve=d.Pa).jb,0,255,ve.jb.length),e((ve=d.Qa)!=null),ve.Cb=0,ve.Bb=0,ve.Fb=1,i(ve.Zb,0,0,ve.Zb.length),i(ve.Lb,0,0,ve.Lb)}if(be.ub>ye)return Nr(d,7,"bad partition length");K(ve=d.m,L,ie,be.ub),ie+=be.ub,ye-=be.ub,be.Rb&&(we.Ld=H(ve),we.Kd=H(ve)),we=d.Qa;var Ae,ke=d.Pa;if(e(ve!=null),e(we!=null),we.Cb=H(ve),we.Cb){if(we.Bb=H(ve),H(ve)){for(we.Fb=H(ve),Ae=0;4>Ae;++Ae)we.Zb[Ae]=H(ve)?R(ve,7):0;for(Ae=0;4>Ae;++Ae)we.Lb[Ae]=H(ve)?R(ve,6):0}if(we.Bb)for(Ae=0;3>Ae;++Ae)ke.jb[Ae]=H(ve)?k(ve,8):255}else we.Bb=0;if(ve.Ka)return Nr(d,3,"cannot parse segment header");if((we=d.ed).zd=H(ve),we.Tb=k(ve,6),we.wb=k(ve,3),we.Pc=H(ve),we.Pc&&H(ve)){for(ke=0;4>ke;++ke)H(ve)&&(we.vd[ke]=R(ve,6));for(ke=0;4>ke;++ke)H(ve)&&(we.od[ke]=R(ve,6))}if(d.L=we.Tb==0?0:we.zd?1:2,ve.Ka)return Nr(d,3,"cannot parse filter header");var Fe=ye;if(ye=Ae=ie,ie=Ae+Fe,we=Fe,d.Xb=(1<<k(d.m,2))-1,Fe<3*(ke=d.Xb))L=7;else{for(Ae+=3*ke,we-=3*ke,Fe=0;Fe<ke;++Fe){var Xe=L[ye+0]|L[ye+1]<<8|L[ye+2]<<16;Xe>we&&(Xe=we),K(d.Jc[+Fe],L,Ae,Xe),Ae+=Xe,we-=Xe,ye+=3}K(d.Jc[+ke],L,Ae,we),L=Ae<ie?0:5}if(L!=0)return Nr(d,L,"cannot parse partitions");for(L=k(Ae=d.m,7),ye=H(Ae)?R(Ae,4):0,ie=H(Ae)?R(Ae,4):0,we=H(Ae)?R(Ae,4):0,ke=H(Ae)?R(Ae,4):0,Ae=H(Ae)?R(Ae,4):0,Fe=d.Qa,Xe=0;4>Xe;++Xe){if(Fe.Cb){var Ze=Fe.Zb[Xe];Fe.Fb||(Ze+=L)}else{if(0<Xe){d.pb[Xe]=d.pb[0];continue}Ze=L}var He=d.pb[Xe];He.Sc[0]=Cp[Qr(Ze+ye,127)],He.Sc[1]=Ip[Qr(Ze+0,127)],He.Eb[0]=2*Cp[Qr(Ze+ie,127)],He.Eb[1]=101581*Ip[Qr(Ze+we,127)]>>16,8>He.Eb[1]&&(He.Eb[1]=8),He.Qc[0]=Cp[Qr(Ze+ke,117)],He.Qc[1]=Ip[Qr(Ze+Ae,127)],He.lc=Ze+Ae}if(!be.Rb)return Nr(d,4,"Not a key frame.");for(H(ve),be=d.Pa,L=0;4>L;++L){for(ye=0;8>ye;++ye)for(ie=0;3>ie;++ie)for(we=0;11>we;++we)ke=J(ve,L_[L][ye][ie][we])?k(ve,8):k_[L][ye][ie][we],be.Wc[L][ye].Yb[ie][we]=ke;for(ye=0;17>ye;++ye)be.Xc[L][ye]=be.Wc[L][R_[ye]]}return d.kc=H(ve),d.kc&&(d.Bd=k(ve,8)),d.cb=1}function _i(d,v,L,ie,ye,ve,be){var we=v[ye].Yb[L];for(L=0;16>ye;++ye){if(!J(d,we[L+0]))return ye;for(;!J(d,we[L+1]);)if(we=v[++ye].Yb[0],L=0,ye==16)return 16;var Ae=v[ye+1].Yb;if(J(d,we[L+2])){var ke=d,Fe=0;if(J(ke,(Ze=we)[(Xe=L)+3]))if(J(ke,Ze[Xe+6])){for(we=0,Xe=2*(Fe=J(ke,Ze[Xe+8]))+(Ze=J(ke,Ze[Xe+9+Fe])),Fe=0,Ze=E_[Xe];Ze[we];++we)Fe+=Fe+J(ke,Ze[we]);Fe+=3+(8<<Xe)}else J(ke,Ze[Xe+7])?(Fe=7+2*J(ke,165),Fe+=J(ke,145)):Fe=5+J(ke,159);else Fe=J(ke,Ze[Xe+4])?3+J(ke,Ze[Xe+5]):2;we=Ae[2]}else Fe=1,we=Ae[1];Ae=be+T_[ye],0>(ke=d).b&&Q(ke);var Xe,Ze=ke.b,He=(Xe=ke.Ca>>1)-(ke.I>>Ze)>>31;--ke.b,ke.Ca+=He,ke.Ca|=1,ke.I-=(Xe+1&He)<<Ze,ve[Ae]=((Fe^He)-He)*ie[(0<ye)+0]}return 16}function hr(d){var v=d.rb[d.sb-1];v.la=0,v.Na=0,i(d.zc,0,0,d.zc.length),d.ja=0}function Lr(d,v){if(d==null)return 0;if(v==null)return Nr(d,2,"NULL VP8Io parameter in VP8Decode().");if(!d.cb&&!bi(d,v))return 0;if(e(d.cb),v.ac==null||v.ac(v)){v.ob&&(d.L=0);var L=vd[d.L];if(d.L==2?(d.yb=0,d.zb=0):(d.yb=v.v-L>>4,d.zb=v.j-L>>4,0>d.yb&&(d.yb=0),0>d.zb&&(d.zb=0)),d.Va=v.o+15+L>>4,d.Hb=v.va+15+L>>4,d.Hb>d.za&&(d.Hb=d.za),d.Va>d.Ub&&(d.Va=d.Ub),0<d.L){var ie=d.ed;for(L=0;4>L;++L){var ye;if(d.Qa.Cb){var ve=d.Qa.Lb[L];d.Qa.Fb||(ve+=ie.Tb)}else ve=ie.Tb;for(ye=0;1>=ye;++ye){var be=d.gd[L][ye],we=ve;if(ie.Pc&&(we+=ie.vd[0],ye&&(we+=ie.od[0])),0<(we=0>we?0:63<we?63:we)){var Ae=we;0<ie.wb&&(Ae=4<ie.wb?Ae>>2:Ae>>1)>9-ie.wb&&(Ae=9-ie.wb),1>Ae&&(Ae=1),be.dd=Ae,be.tc=2*we+Ae,be.ld=40<=we?2:15<=we?1:0}else be.tc=0;be.La=ye}}}L=0}else Nr(d,6,"Frame setup failed"),L=d.a;if(L=L==0){if(L){d.$c=0,0<d.Aa||(d.Ic=W_);e:{L=d.Ic,ie=4*(Ae=d.za);var ke=32*Ae,Fe=Ae+1,Xe=0<d.L?Ae*(0<d.Aa?2:1):0,Ze=(d.Aa==2?2:1)*Ae;if((be=ie+832+(ye=3*(16*L+vd[d.L])/2*ke)+(ve=d.Fa!=null&&0<d.Fa.length?d.Kc.c*d.Kc.i:0))!=be)L=0;else{if(be>d.Vb){if(d.Vb=0,d.Ec=o(be),d.Fc=0,d.Ec==null){L=Nr(d,1,"no memory during frame initialization.");break e}d.Vb=be}be=d.Ec,we=d.Fc,d.Ac=be,d.Bc=we,we+=ie,d.Gd=s(ke,Mt),d.Hd=0,d.rb=s(Fe+1,_r),d.sb=1,d.wa=Xe?s(Xe,cr):null,d.Y=0,d.D.Nb=0,d.D.wa=d.wa,d.D.Y=d.Y,0<d.Aa&&(d.D.Y+=Ae),e(!0),d.oc=be,d.pc=we,we+=832,d.ya=s(Ze,kr),d.aa=0,d.D.ya=d.ya,d.D.aa=d.aa,d.Aa==2&&(d.D.aa+=Ae),d.R=16*Ae,d.B=8*Ae,Ae=(ke=vd[d.L])*d.R,ke=ke/2*d.B,d.sa=be,d.ta=we+Ae,d.qa=d.sa,d.ra=d.ta+16*L*d.R+ke,d.Ha=d.qa,d.Ia=d.ra+8*L*d.B+ke,d.$c=0,we+=ye,d.mb=ve?be:null,d.nb=ve?we:null,e(we+ve<=d.Fc+d.Vb),hr(d),i(d.Ac,d.Bc,0,ie),L=1}}if(L){if(v.ka=0,v.y=d.sa,v.O=d.ta,v.f=d.qa,v.N=d.ra,v.ea=d.Ha,v.Vd=d.Ia,v.fa=d.R,v.Rc=d.B,v.F=null,v.J=0,!cd){for(L=-255;255>=L;++L)jn[255+L]=0>L?-L:L;for(L=-1020;1020>=L;++L)us[1020+L]=-128>L?-128:127<L?127:L;for(L=-112;112>=L;++L)qc[112+L]=-16>L?-16:15<L?15:L;for(L=-255;510>=L;++L)Ul[255+L]=0>L?0:255<L?255:L;cd=1}Vl=Pi,cs=ri,Bc=Si,Ai=qr,eo=Vi,Pn=Wn,ql=Os,ld=mo,jc=js,Ga=Ua,Wa=Bs,Ys=is,Ya=Vs,zl=Do,Ka=ns,Ks=Ui,Vc=Bn,to=Rl,vo[0]=Xi,vo[1]=Nc,vo[2]=Lo,vo[3]=Rc,vo[4]=Nl,vo[5]=Rs,vo[6]=qi,vo[7]=Oa,vo[8]=Ms,vo[9]=Ds,Js[0]=No,Js[1]=Lc,Js[2]=ho,Js[3]=Ns,Js[4]=dn,Js[5]=kl,Js[6]=Fa,ds[0]=fo,ds[1]=Tl,ds[2]=Ll,ds[3]=po,ds[4]=Jr,ds[5]=Ba,ds[6]=ja,L=1}else L=0}L&&(L=function(He,gt){for(He.M=0;He.M<He.Va;++He.M){var rt,Oe=He.Jc[He.M&He.Xb],Ve=He.m,pt=He;for(rt=0;rt<pt.za;++rt){var St=Ve,mt=pt,Gt=mt.Ac,Bt=mt.Bc+4*rt,ur=mt.zc,qt=mt.ya[mt.aa+rt];if(mt.Qa.Bb?qt.$b=J(St,mt.Pa.jb[0])?2+J(St,mt.Pa.jb[2]):J(St,mt.Pa.jb[1]):qt.$b=0,mt.kc&&(qt.Ad=J(St,mt.Bd)),qt.Za=!J(St,145)+0,qt.Za){var Wr=qt.Ob,Zr=0;for(mt=0;4>mt;++mt){var zr,Dr=ur[0+mt];for(zr=0;4>zr;++zr){Dr=N_[Gt[Bt+zr]][Dr];for(var on=tg[J(St,Dr[0])];0<on;)on=tg[2*on+J(St,Dr[on])];Dr=-on,Gt[Bt+zr]=Dr}n(Wr,Zr,Gt,Bt,4),Zr+=4,ur[0+mt]=Dr}}else Dr=J(St,156)?J(St,128)?1:3:J(St,163)?2:0,qt.Ob[0]=Dr,i(Gt,Bt,Dr,4),i(ur,0,Dr,4);qt.Dd=J(St,142)?J(St,114)?J(St,183)?1:3:2:0}if(pt.m.Ka)return Nr(He,7,"Premature end-of-partition0 encountered.");for(;He.ja<He.za;++He.ja){if(pt=Oe,St=(Ve=He).rb[Ve.sb-1],Gt=Ve.rb[Ve.sb+Ve.ja],rt=Ve.ya[Ve.aa+Ve.ja],Bt=Ve.kc?rt.Ad:0)St.la=Gt.la=0,rt.Za||(St.Na=Gt.Na=0),rt.Hc=0,rt.Gc=0,rt.ia=0;else{var rn,$r;if(St=Gt,Gt=pt,Bt=Ve.Pa.Xc,ur=Ve.ya[Ve.aa+Ve.ja],qt=Ve.pb[ur.$b],mt=ur.ad,Wr=0,Zr=Ve.rb[Ve.sb-1],Dr=zr=0,i(mt,Wr,0,384),ur.Za)var Tn=0,ki=Bt[3];else{on=o(16);var kn=St.Na+Zr.Na;if(kn=zc(Gt,Bt[1],kn,qt.Eb,0,on,0),St.Na=Zr.Na=(0<kn)+0,1<kn)Vl(on,0,mt,Wr);else{var Ni=on[0]+3>>3;for(on=0;256>on;on+=16)mt[Wr+on]=Ni}Tn=1,ki=Bt[0]}var en=15&St.la,Gi=15&Zr.la;for(on=0;4>on;++on){var Wi=1&Gi;for(Ni=$r=0;4>Ni;++Ni)en=en>>1|(Wi=(kn=zc(Gt,ki,kn=Wi+(1&en),qt.Sc,Tn,mt,Wr))>Tn)<<7,$r=$r<<2|(3<kn?3:1<kn?2:mt[Wr+0]!=0),Wr+=16;en>>=4,Gi=Gi>>1|Wi<<7,zr=(zr<<8|$r)>>>0}for(ki=en,Tn=Gi>>4,rn=0;4>rn;rn+=2){for($r=0,en=St.la>>4+rn,Gi=Zr.la>>4+rn,on=0;2>on;++on){for(Wi=1&Gi,Ni=0;2>Ni;++Ni)kn=Wi+(1&en),en=en>>1|(Wi=0<(kn=zc(Gt,Bt[2],kn,qt.Qc,0,mt,Wr)))<<3,$r=$r<<2|(3<kn?3:1<kn?2:mt[Wr+0]!=0),Wr+=16;en>>=2,Gi=Gi>>1|Wi<<5}Dr|=$r<<4*rn,ki|=en<<4<<rn,Tn|=(240&Gi)<<rn}St.la=ki,Zr.la=Tn,ur.Hc=zr,ur.Gc=Dr,ur.ia=43690&Dr?0:qt.ia,Bt=!(zr|Dr)}if(0<Ve.L&&(Ve.wa[Ve.Y+Ve.ja]=Ve.gd[rt.$b][rt.Za],Ve.wa[Ve.Y+Ve.ja].La|=!Bt),pt.Ka)return Nr(He,7,"Premature end-of-file encountered.")}if(hr(He),Ve=gt,pt=1,rt=(Oe=He).D,St=0<Oe.L&&Oe.M>=Oe.zb&&Oe.M<=Oe.Va,Oe.Aa==0)e:{if(rt.M=Oe.M,rt.uc=St,Fo(Oe,rt),pt=1,rt=($r=Oe.D).Nb,St=(Dr=vd[Oe.L])*Oe.R,Gt=Dr/2*Oe.B,on=16*rt*Oe.R,Ni=8*rt*Oe.B,Bt=Oe.sa,ur=Oe.ta-St+on,qt=Oe.qa,mt=Oe.ra-Gt+Ni,Wr=Oe.Ha,Zr=Oe.Ia-Gt+Ni,Gi=(en=$r.M)==0,zr=en>=Oe.Va-1,Oe.Aa==2&&Fo(Oe,$r),$r.uc)for(Wi=(kn=Oe).D.M,e(kn.D.uc),$r=kn.yb;$r<kn.Hb;++$r){Tn=$r,ki=Wi;var Un=(Qn=(vn=kn).D).Nb;rn=vn.R;var Qn=Qn.wa[Qn.Y+Tn],Ci=vn.sa,oo=vn.ta+16*Un*rn+16*Tn,Bo=Qn.dd,Hn=Qn.tc;if(Hn!=0)if(e(3<=Hn),vn.L==1)0<Tn&&Ks(Ci,oo,rn,Hn+4),Qn.La&&to(Ci,oo,rn,Hn),0<ki&&Ka(Ci,oo,rn,Hn+4),Qn.La&&Vc(Ci,oo,rn,Hn);else{var hs=vn.B,Ja=vn.qa,Hl=vn.ra+8*Un*hs+8*Tn,Xs=vn.Ha,vn=vn.Ia+8*Un*hs+8*Tn;Un=Qn.ld,0<Tn&&(ld(Ci,oo,rn,Hn+4,Bo,Un),Ga(Ja,Hl,Xs,vn,hs,Hn+4,Bo,Un)),Qn.La&&(Ys(Ci,oo,rn,Hn,Bo,Un),zl(Ja,Hl,Xs,vn,hs,Hn,Bo,Un)),0<ki&&(ql(Ci,oo,rn,Hn+4,Bo,Un),jc(Ja,Hl,Xs,vn,hs,Hn+4,Bo,Un)),Qn.La&&(Wa(Ci,oo,rn,Hn,Bo,Un),Ya(Ja,Hl,Xs,vn,hs,Hn,Bo,Un))}}if(Oe.ia&&alert("todo:DitherRow"),Ve.put!=null){if($r=16*en,en=16*(en+1),Gi?(Ve.y=Oe.sa,Ve.O=Oe.ta+on,Ve.f=Oe.qa,Ve.N=Oe.ra+Ni,Ve.ea=Oe.Ha,Ve.W=Oe.Ia+Ni):($r-=Dr,Ve.y=Bt,Ve.O=ur,Ve.f=qt,Ve.N=mt,Ve.ea=Wr,Ve.W=Zr),zr||(en-=Dr),en>Ve.o&&(en=Ve.o),Ve.F=null,Ve.J=null,Oe.Fa!=null&&0<Oe.Fa.length&&$r<en&&(Ve.J=Hs(Oe,Ve,$r,en-$r),Ve.F=Oe.mb,Ve.F==null&&Ve.F.length==0)){pt=Nr(Oe,3,"Could not decode alpha data.");break e}$r<Ve.j&&(Dr=Ve.j-$r,$r=Ve.j,e(!(1&Dr)),Ve.O+=Oe.R*Dr,Ve.N+=Oe.B*(Dr>>1),Ve.W+=Oe.B*(Dr>>1),Ve.F!=null&&(Ve.J+=Ve.width*Dr)),$r<en&&(Ve.O+=Ve.v,Ve.N+=Ve.v>>1,Ve.W+=Ve.v>>1,Ve.F!=null&&(Ve.J+=Ve.v),Ve.ka=$r-Ve.j,Ve.U=Ve.va-Ve.v,Ve.T=en-$r,pt=Ve.put(Ve))}rt+1!=Oe.Ic||zr||(n(Oe.sa,Oe.ta-St,Bt,ur+16*Oe.R,St),n(Oe.qa,Oe.ra-Gt,qt,mt+8*Oe.B,Gt),n(Oe.Ha,Oe.Ia-Gt,Wr,Zr+8*Oe.B,Gt))}if(!pt)return Nr(He,6,"Output aborted.")}return 1}(d,v)),v.bc!=null&&v.bc(v),L&=1}return L?(d.cb=0,L):0}function jr(d,v,L,ie,ye){ye=d[v+L+32*ie]+(ye>>3),d[v+L+32*ie]=-256&ye?0>ye?0:255:ye}function fn(d,v,L,ie,ye,ve){jr(d,v,0,L,ie+ye),jr(d,v,1,L,ie+ve),jr(d,v,2,L,ie-ve),jr(d,v,3,L,ie-ye)}function Gr(d){return(20091*d>>16)+d}function Br(d,v,L,ie){var ye,ve=0,be=o(16);for(ye=0;4>ye;++ye){var we=d[v+0]+d[v+8],Ae=d[v+0]-d[v+8],ke=(35468*d[v+4]>>16)-Gr(d[v+12]),Fe=Gr(d[v+4])+(35468*d[v+12]>>16);be[ve+0]=we+Fe,be[ve+1]=Ae+ke,be[ve+2]=Ae-ke,be[ve+3]=we-Fe,ve+=4,v++}for(ye=ve=0;4>ye;++ye)we=(d=be[ve+0]+4)+be[ve+8],Ae=d-be[ve+8],ke=(35468*be[ve+4]>>16)-Gr(be[ve+12]),jr(L,ie,0,0,we+(Fe=Gr(be[ve+4])+(35468*be[ve+12]>>16))),jr(L,ie,1,0,Ae+ke),jr(L,ie,2,0,Ae-ke),jr(L,ie,3,0,we-Fe),ve++,ie+=32}function Wn(d,v,L,ie){var ye=d[v+0]+4,ve=35468*d[v+4]>>16,be=Gr(d[v+4]),we=35468*d[v+1]>>16;fn(L,ie,0,ye+be,d=Gr(d[v+1]),we),fn(L,ie,1,ye+ve,d,we),fn(L,ie,2,ye-ve,d,we),fn(L,ie,3,ye-be,d,we)}function ri(d,v,L,ie,ye){Br(d,v,L,ie),ye&&Br(d,v+16,L,ie+4)}function Si(d,v,L,ie){cs(d,v+0,L,ie,1),cs(d,v+32,L,ie+128,1)}function qr(d,v,L,ie){var ye;for(d=d[v+0]+4,ye=0;4>ye;++ye)for(v=0;4>v;++v)jr(L,ie,v,ye,d)}function Vi(d,v,L,ie){d[v+0]&&Ai(d,v+0,L,ie),d[v+16]&&Ai(d,v+16,L,ie+4),d[v+32]&&Ai(d,v+32,L,ie+128),d[v+48]&&Ai(d,v+48,L,ie+128+4)}function Pi(d,v,L,ie){var ye,ve=o(16);for(ye=0;4>ye;++ye){var be=d[v+0+ye]+d[v+12+ye],we=d[v+4+ye]+d[v+8+ye],Ae=d[v+4+ye]-d[v+8+ye],ke=d[v+0+ye]-d[v+12+ye];ve[0+ye]=be+we,ve[8+ye]=be-we,ve[4+ye]=ke+Ae,ve[12+ye]=ke-Ae}for(ye=0;4>ye;++ye)be=(d=ve[0+4*ye]+3)+ve[3+4*ye],we=ve[1+4*ye]+ve[2+4*ye],Ae=ve[1+4*ye]-ve[2+4*ye],ke=d-ve[3+4*ye],L[ie+0]=be+we>>3,L[ie+16]=ke+Ae>>3,L[ie+32]=be-we>>3,L[ie+48]=ke-Ae>>3,ie+=64}function wi(d,v,L){var ie,ye=v-32,ve=Hi,be=255-d[ye-1];for(ie=0;ie<L;++ie){var we,Ae=ve,ke=be+d[v-1];for(we=0;we<L;++we)d[v+we]=Ae[ke+d[ye+we]];v+=32}}function Nc(d,v){wi(d,v,4)}function Tl(d,v){wi(d,v,8)}function Lc(d,v){wi(d,v,16)}function ho(d,v){var L;for(L=0;16>L;++L)n(d,v+32*L,d,v-32,16)}function Ns(d,v){var L;for(L=16;0<L;--L)i(d,v,d[v-1],16),v+=32}function Ls(d,v,L){var ie;for(ie=0;16>ie;++ie)i(v,L+32*ie,d,16)}function No(d,v){var L,ie=16;for(L=0;16>L;++L)ie+=d[v-1+32*L]+d[v+L-32];Ls(ie>>5,d,v)}function dn(d,v){var L,ie=8;for(L=0;16>L;++L)ie+=d[v-1+32*L];Ls(ie>>4,d,v)}function kl(d,v){var L,ie=8;for(L=0;16>L;++L)ie+=d[v+L-32];Ls(ie>>4,d,v)}function Fa(d,v){Ls(128,d,v)}function vr(d,v,L){return d+2*v+L+2>>2}function Lo(d,v){var L,ie=v-32;for(ie=new Uint8Array([vr(d[ie-1],d[ie+0],d[ie+1]),vr(d[ie+0],d[ie+1],d[ie+2]),vr(d[ie+1],d[ie+2],d[ie+3]),vr(d[ie+2],d[ie+3],d[ie+4])]),L=0;4>L;++L)n(d,v+32*L,ie,0,ie.length)}function Rc(d,v){var L=d[v-1],ie=d[v-1+32],ye=d[v-1+64],ve=d[v-1+96];te(d,v+0,16843009*vr(d[v-1-32],L,ie)),te(d,v+32,16843009*vr(L,ie,ye)),te(d,v+64,16843009*vr(ie,ye,ve)),te(d,v+96,16843009*vr(ye,ve,ve))}function Xi(d,v){var L,ie=4;for(L=0;4>L;++L)ie+=d[v+L-32]+d[v-1+32*L];for(ie>>=3,L=0;4>L;++L)i(d,v+32*L,ie,4)}function Nl(d,v){var L=d[v-1+0],ie=d[v-1+32],ye=d[v-1+64],ve=d[v-1-32],be=d[v+0-32],we=d[v+1-32],Ae=d[v+2-32],ke=d[v+3-32];d[v+0+96]=vr(ie,ye,d[v-1+96]),d[v+1+96]=d[v+0+64]=vr(L,ie,ye),d[v+2+96]=d[v+1+64]=d[v+0+32]=vr(ve,L,ie),d[v+3+96]=d[v+2+64]=d[v+1+32]=d[v+0+0]=vr(be,ve,L),d[v+3+64]=d[v+2+32]=d[v+1+0]=vr(we,be,ve),d[v+3+32]=d[v+2+0]=vr(Ae,we,be),d[v+3+0]=vr(ke,Ae,we)}function qi(d,v){var L=d[v+1-32],ie=d[v+2-32],ye=d[v+3-32],ve=d[v+4-32],be=d[v+5-32],we=d[v+6-32],Ae=d[v+7-32];d[v+0+0]=vr(d[v+0-32],L,ie),d[v+1+0]=d[v+0+32]=vr(L,ie,ye),d[v+2+0]=d[v+1+32]=d[v+0+64]=vr(ie,ye,ve),d[v+3+0]=d[v+2+32]=d[v+1+64]=d[v+0+96]=vr(ye,ve,be),d[v+3+32]=d[v+2+64]=d[v+1+96]=vr(ve,be,we),d[v+3+64]=d[v+2+96]=vr(be,we,Ae),d[v+3+96]=vr(we,Ae,Ae)}function Rs(d,v){var L=d[v-1+0],ie=d[v-1+32],ye=d[v-1+64],ve=d[v-1-32],be=d[v+0-32],we=d[v+1-32],Ae=d[v+2-32],ke=d[v+3-32];d[v+0+0]=d[v+1+64]=ve+be+1>>1,d[v+1+0]=d[v+2+64]=be+we+1>>1,d[v+2+0]=d[v+3+64]=we+Ae+1>>1,d[v+3+0]=Ae+ke+1>>1,d[v+0+96]=vr(ye,ie,L),d[v+0+64]=vr(ie,L,ve),d[v+0+32]=d[v+1+96]=vr(L,ve,be),d[v+1+32]=d[v+2+96]=vr(ve,be,we),d[v+2+32]=d[v+3+96]=vr(be,we,Ae),d[v+3+32]=vr(we,Ae,ke)}function Oa(d,v){var L=d[v+0-32],ie=d[v+1-32],ye=d[v+2-32],ve=d[v+3-32],be=d[v+4-32],we=d[v+5-32],Ae=d[v+6-32],ke=d[v+7-32];d[v+0+0]=L+ie+1>>1,d[v+1+0]=d[v+0+64]=ie+ye+1>>1,d[v+2+0]=d[v+1+64]=ye+ve+1>>1,d[v+3+0]=d[v+2+64]=ve+be+1>>1,d[v+0+32]=vr(L,ie,ye),d[v+1+32]=d[v+0+96]=vr(ie,ye,ve),d[v+2+32]=d[v+1+96]=vr(ye,ve,be),d[v+3+32]=d[v+2+96]=vr(ve,be,we),d[v+3+64]=vr(be,we,Ae),d[v+3+96]=vr(we,Ae,ke)}function Ds(d,v){var L=d[v-1+0],ie=d[v-1+32],ye=d[v-1+64],ve=d[v-1+96];d[v+0+0]=L+ie+1>>1,d[v+2+0]=d[v+0+32]=ie+ye+1>>1,d[v+2+32]=d[v+0+64]=ye+ve+1>>1,d[v+1+0]=vr(L,ie,ye),d[v+3+0]=d[v+1+32]=vr(ie,ye,ve),d[v+3+32]=d[v+1+64]=vr(ye,ve,ve),d[v+3+64]=d[v+2+64]=d[v+0+96]=d[v+1+96]=d[v+2+96]=d[v+3+96]=ve}function Ms(d,v){var L=d[v-1+0],ie=d[v-1+32],ye=d[v-1+64],ve=d[v-1+96],be=d[v-1-32],we=d[v+0-32],Ae=d[v+1-32],ke=d[v+2-32];d[v+0+0]=d[v+2+32]=L+be+1>>1,d[v+0+32]=d[v+2+64]=ie+L+1>>1,d[v+0+64]=d[v+2+96]=ye+ie+1>>1,d[v+0+96]=ve+ye+1>>1,d[v+3+0]=vr(we,Ae,ke),d[v+2+0]=vr(be,we,Ae),d[v+1+0]=d[v+3+32]=vr(L,be,we),d[v+1+32]=d[v+3+64]=vr(ie,L,be),d[v+1+64]=d[v+3+96]=vr(ye,ie,L),d[v+1+96]=vr(ve,ye,ie)}function Ll(d,v){var L;for(L=0;8>L;++L)n(d,v+32*L,d,v-32,8)}function po(d,v){var L;for(L=0;8>L;++L)i(d,v,d[v-1],8),v+=32}function zi(d,v,L){var ie;for(ie=0;8>ie;++ie)i(v,L+32*ie,d,8)}function fo(d,v){var L,ie=8;for(L=0;8>L;++L)ie+=d[v+L-32]+d[v-1+32*L];zi(ie>>4,d,v)}function Ba(d,v){var L,ie=4;for(L=0;8>L;++L)ie+=d[v+L-32];zi(ie>>3,d,v)}function Jr(d,v){var L,ie=4;for(L=0;8>L;++L)ie+=d[v-1+32*L];zi(ie>>3,d,v)}function ja(d,v){zi(128,d,v)}function Fs(d,v,L){var ie=d[v-L],ye=d[v+0],ve=3*(ye-ie)+Sp[1020+d[v-2*L]-d[v+L]],be=ud[112+(ve+4>>3)];d[v-L]=Hi[255+ie+ud[112+(ve+3>>3)]],d[v+0]=Hi[255+ye-be]}function Va(d,v,L,ie){var ye=d[v+0],ve=d[v+L];return no[255+d[v-2*L]-d[v-L]]>ie||no[255+ve-ye]>ie}function qa(d,v,L,ie){return 4*no[255+d[v-L]-d[v+0]]+no[255+d[v-2*L]-d[v+L]]<=ie}function za(d,v,L,ie,ye){var ve=d[v-3*L],be=d[v-2*L],we=d[v-L],Ae=d[v+0],ke=d[v+L],Fe=d[v+2*L],Xe=d[v+3*L];return 4*no[255+we-Ae]+no[255+be-ke]>ie?0:no[255+d[v-4*L]-ve]<=ye&&no[255+ve-be]<=ye&&no[255+be-we]<=ye&&no[255+Xe-Fe]<=ye&&no[255+Fe-ke]<=ye&&no[255+ke-Ae]<=ye}function ns(d,v,L,ie){var ye=2*ie+1;for(ie=0;16>ie;++ie)qa(d,v+ie,L,ye)&&Fs(d,v+ie,L)}function Ui(d,v,L,ie){var ye=2*ie+1;for(ie=0;16>ie;++ie)qa(d,v+ie*L,1,ye)&&Fs(d,v+ie*L,1)}function Bn(d,v,L,ie){var ye;for(ye=3;0<ye;--ye)ns(d,v+=4*L,L,ie)}function Rl(d,v,L,ie){var ye;for(ye=3;0<ye;--ye)Ui(d,v+=4,L,ie)}function Ro(d,v,L,ie,ye,ve,be,we){for(ve=2*ve+1;0<ye--;){if(za(d,v,L,ve,be))if(Va(d,v,L,we))Fs(d,v,L);else{var Ae=d,ke=v,Fe=L,Xe=Ae[ke-2*Fe],Ze=Ae[ke-Fe],He=Ae[ke+0],gt=Ae[ke+Fe],rt=Ae[ke+2*Fe],Oe=27*(pt=Sp[1020+3*(He-Ze)+Sp[1020+Xe-gt]])+63>>7,Ve=18*pt+63>>7,pt=9*pt+63>>7;Ae[ke-3*Fe]=Hi[255+Ae[ke-3*Fe]+pt],Ae[ke-2*Fe]=Hi[255+Xe+Ve],Ae[ke-Fe]=Hi[255+Ze+Oe],Ae[ke+0]=Hi[255+He-Oe],Ae[ke+Fe]=Hi[255+gt-Ve],Ae[ke+2*Fe]=Hi[255+rt-pt]}v+=ie}}function Yn(d,v,L,ie,ye,ve,be,we){for(ve=2*ve+1;0<ye--;){if(za(d,v,L,ve,be))if(Va(d,v,L,we))Fs(d,v,L);else{var Ae=d,ke=v,Fe=L,Xe=Ae[ke-Fe],Ze=Ae[ke+0],He=Ae[ke+Fe],gt=ud[112+((rt=3*(Ze-Xe))+4>>3)],rt=ud[112+(rt+3>>3)],Oe=gt+1>>1;Ae[ke-2*Fe]=Hi[255+Ae[ke-2*Fe]+Oe],Ae[ke-Fe]=Hi[255+Xe+rt],Ae[ke+0]=Hi[255+Ze-gt],Ae[ke+Fe]=Hi[255+He-Oe]}v+=ie}}function Os(d,v,L,ie,ye,ve){Ro(d,v,L,1,16,ie,ye,ve)}function mo(d,v,L,ie,ye,ve){Ro(d,v,1,L,16,ie,ye,ve)}function Bs(d,v,L,ie,ye,ve){var be;for(be=3;0<be;--be)Yn(d,v+=4*L,L,1,16,ie,ye,ve)}function is(d,v,L,ie,ye,ve){var be;for(be=3;0<be;--be)Yn(d,v+=4,1,L,16,ie,ye,ve)}function js(d,v,L,ie,ye,ve,be,we){Ro(d,v,ye,1,8,ve,be,we),Ro(L,ie,ye,1,8,ve,be,we)}function Ua(d,v,L,ie,ye,ve,be,we){Ro(d,v,1,ye,8,ve,be,we),Ro(L,ie,1,ye,8,ve,be,we)}function Vs(d,v,L,ie,ye,ve,be,we){Yn(d,v+4*ye,ye,1,8,ve,be,we),Yn(L,ie+4*ye,ye,1,8,ve,be,we)}function Do(d,v,L,ie,ye,ve,be,we){Yn(d,v+4,1,ye,8,ve,be,we),Yn(L,ie+4,1,ye,8,ve,be,we)}function os(){this.ba=new ze,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Nt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function qs(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ss(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function zs(){this.ua=0,this.Wa=new z,this.vb=new z,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new W,this.yc=new w}function Dl(){this.xb=this.a=0,this.l=new gn,this.ca=new ze,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new N,this.Pb=0,this.wd=new N,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new zs,this.ab=0,this.gc=s(4,ss),this.Oc=0}function yo(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new gn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Mo(d,v,L,ie,ye,ve,be){for(d=d==null?0:d[v+0],v=0;v<be;++v)ye[ve+v]=d+L[ie+v]&255,d=ye[ve+v]}function Us(d,v,L,ie,ye,ve,be){var we;if(d==null)Mo(null,null,L,ie,ye,ve,be);else for(we=0;we<be;++we)ye[ve+we]=d[v+we]+L[ie+we]&255}function ni(d,v,L,ie,ye,ve,be){if(d==null)Mo(null,null,L,ie,ye,ve,be);else{var we,Ae=d[v+0],ke=Ae,Fe=Ae;for(we=0;we<be;++we)ke=Fe+(Ae=d[v+we])-ke,Fe=L[ie+we]+(-256&ke?0>ke?0:255:ke)&255,ke=Ae,ye[ve+we]=Fe}}function Hs(d,v,L,ie){var ye=v.width,ve=v.o;if(e(d!=null&&v!=null),0>L||0>=ie||L+ie>ve)return null;if(!d.Cc){if(d.ga==null){var be;if(d.ga=new yo,(be=d.ga==null)||(be=v.width*v.o,e(d.Gb.length==0),d.Gb=o(be),d.Uc=0,d.Gb==null?be=0:(d.mb=d.Gb,d.nb=d.Uc,d.rc=null,be=1),be=!be),!be){be=d.ga;var we=d.Fa,Ae=d.P,ke=d.qc,Fe=d.mb,Xe=d.nb,Ze=Ae+1,He=ke-1,gt=be.l;if(e(we!=null&&Fe!=null&&v!=null),Qs[0]=null,Qs[1]=Mo,Qs[2]=Us,Qs[3]=ni,be.ca=Fe,be.tb=Xe,be.c=v.width,be.i=v.height,e(0<be.c&&0<be.i),1>=ke)v=0;else if(be.$a=we[Ae+0]>>0&3,be.Z=we[Ae+0]>>2&3,be.Lc=we[Ae+0]>>4&3,Ae=we[Ae+0]>>6&3,0>be.$a||1<be.$a||4<=be.Z||1<be.Lc||Ae)v=0;else if(gt.put=Pt,gt.ac=Be,gt.bc=Ct,gt.ma=be,gt.width=v.width,gt.height=v.height,gt.Da=v.Da,gt.v=v.v,gt.va=v.va,gt.j=v.j,gt.o=v.o,be.$a)e:{e(be.$a==1),v=er();t:for(;;){if(v==null){v=0;break e}if(e(be!=null),be.mc=v,v.c=be.c,v.i=be.i,v.l=be.l,v.l.ma=be,v.l.width=be.c,v.l.height=be.i,v.a=0,Y(v.m,we,Ze,He),!kt(be.c,be.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&Jt(v.s)?(be.ic=1,we=v.c*v.i,v.Ta=null,v.Ua=0,v.V=o(we),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(be.ic=0,v=Xt(v,be.c)),!v))break t;v=1;break e}be.mc=null,v=0}else v=He>=be.c*be.i;be=!v}if(be)return null;d.ga.Lc!=1?d.Ga=0:ie=ve-L}e(d.ga!=null),e(L+ie<=ve);e:{if(v=(we=d.ga).c,ve=we.l.o,we.$a==0){if(Ze=d.rc,He=d.Vc,gt=d.Fa,Ae=d.P+1+L*v,ke=d.mb,Fe=d.nb+L*v,e(Ae<=d.P+d.qc),we.Z!=0)for(e(Qs[we.Z]!=null),be=0;be<ie;++be)Qs[we.Z](Ze,He,gt,Ae,ke,Fe,v),Ze=ke,He=Fe,Fe+=v,Ae+=v;else for(be=0;be<ie;++be)n(ke,Fe,gt,Ae,v),Ze=ke,He=Fe,Fe+=v,Ae+=v;d.rc=Ze,d.Vc=He}else{if(e(we.mc!=null),v=L+ie,e((be=we.mc)!=null),e(v<=be.i),be.C>=v)v=1;else if(we.ic||Ue(),we.ic){we=be.V,Ze=be.Ba,He=be.c;var rt=be.i,Oe=(gt=1,Ae=be.$/He,ke=be.$%He,Fe=be.m,Xe=be.s,be.$),Ve=He*rt,pt=He*v,St=Xe.wc,mt=Oe<pt?it(Xe,ke,Ae):null;e(Oe<=Ve),e(v<=rt),e(Jt(Xe));t:for(;;){for(;!Fe.h&&Oe<pt;){if(ke&St||(mt=it(Xe,ke,Ae)),e(mt!=null),F(Fe),256>(rt=Rt(mt.G[0],mt.H[0],Fe)))we[Ze+Oe]=rt,++Oe,++ke>=He&&(ke=0,++Ae<=v&&!(Ae%16)&&Et(be,Ae));else{if(!(280>rt)){gt=0;break t}rt=ft(rt-256,Fe);var Gt,Bt=Rt(mt.G[4],mt.H[4],Fe);if(F(Fe),!(Oe>=(Bt=Vt(He,Bt=ft(Bt,Fe)))&&Ve-Oe>=rt)){gt=0;break t}for(Gt=0;Gt<rt;++Gt)we[Ze+Oe+Gt]=we[Ze+Oe+Gt-Bt];for(Oe+=rt,ke+=rt;ke>=He;)ke-=He,++Ae<=v&&!(Ae%16)&&Et(be,Ae);Oe<pt&&ke&St&&(mt=it(Xe,ke,Ae))}e(Fe.h==V(Fe))}Et(be,Ae>v?v:Ae);break t}!gt||Fe.h&&Oe<Ve?(gt=0,be.a=Fe.h?5:3):be.$=Oe,v=gt}else v=Wt(be,be.V,be.Ba,be.c,be.i,v,tr);if(!v){ie=0;break e}}L+ie>=ve&&(d.Cc=1),ie=1}if(!ie)return null;if(d.Cc&&((ie=d.ga)!=null&&(ie.mc=null),d.ga=null,0<d.Ga))return alert("todo:WebPDequantizeLevels"),null}return d.nb+L*ye}function A(d,v,L,ie,ye,ve){for(;0<ye--;){var be,we=d,Ae=v+(L?1:0),ke=d,Fe=v+(L?0:3);for(be=0;be<ie;++be){var Xe=ke[Fe+4*be];Xe!=255&&(Xe*=32897,we[Ae+4*be+0]=we[Ae+4*be+0]*Xe>>23,we[Ae+4*be+1]=we[Ae+4*be+1]*Xe>>23,we[Ae+4*be+2]=we[Ae+4*be+2]*Xe>>23)}v+=ve}}function me(d,v,L,ie,ye){for(;0<ie--;){var ve;for(ve=0;ve<L;++ve){var be=d[v+2*ve+0],we=15&(ke=d[v+2*ve+1]),Ae=4369*we,ke=(240&ke|ke>>4)*Ae>>16;d[v+2*ve+0]=(240&be|be>>4)*Ae>>16&240|(15&be|be<<4)*Ae>>16>>4&15,d[v+2*ve+1]=240&ke|we}v+=ye}}function Ne(d,v,L,ie,ye,ve,be,we){var Ae,ke,Fe=255;for(ke=0;ke<ye;++ke){for(Ae=0;Ae<ie;++Ae){var Xe=d[v+Ae];ve[be+4*Ae]=Xe,Fe&=Xe}v+=L,be+=we}return Fe!=255}function Me(d,v,L,ie,ye){var ve;for(ve=0;ve<ye;++ve)L[ie+ve]=d[v+ve]>>8}function Ue(){ro=A,ln=me,cn=Ne,wn=Me}function ot(d,v,L){C[d]=function(ie,ye,ve,be,we,Ae,ke,Fe,Xe,Ze,He,gt,rt,Oe,Ve,pt,St){var mt,Gt=St-1>>1,Bt=we[Ae+0]|ke[Fe+0]<<16,ur=Xe[Ze+0]|He[gt+0]<<16;e(ie!=null);var qt=3*Bt+ur+131074>>2;for(v(ie[ye+0],255&qt,qt>>16,rt,Oe),ve!=null&&(qt=3*ur+Bt+131074>>2,v(ve[be+0],255&qt,qt>>16,Ve,pt)),mt=1;mt<=Gt;++mt){var Wr=we[Ae+mt]|ke[Fe+mt]<<16,Zr=Xe[Ze+mt]|He[gt+mt]<<16,zr=Bt+Wr+ur+Zr+524296,Dr=zr+2*(Wr+ur)>>3;qt=Dr+Bt>>1,Bt=(zr=zr+2*(Bt+Zr)>>3)+Wr>>1,v(ie[ye+2*mt-1],255&qt,qt>>16,rt,Oe+(2*mt-1)*L),v(ie[ye+2*mt-0],255&Bt,Bt>>16,rt,Oe+(2*mt-0)*L),ve!=null&&(qt=zr+ur>>1,Bt=Dr+Zr>>1,v(ve[be+2*mt-1],255&qt,qt>>16,Ve,pt+(2*mt-1)*L),v(ve[be+2*mt+0],255&Bt,Bt>>16,Ve,pt+(2*mt+0)*L)),Bt=Wr,ur=Zr}1&St||(qt=3*Bt+ur+131074>>2,v(ie[ye+St-1],255&qt,qt>>16,rt,Oe+(St-1)*L),ve!=null&&(qt=3*ur+Bt+131074>>2,v(ve[be+St-1],255&qt,qt>>16,Ve,pt+(St-1)*L)))}}function xt(){io[dd]=M_,io[hd]=ng,io[Xy]=F_,io[pd]=ig,io[fd]=og,io[Pp]=sg,io[Zy]=O_,io[wp]=ng,io[xp]=ig,io[md]=og,io[Ap]=sg}function jt(d){return d&-16384?0>d?0:255:d>>B_}function p(d,v){return jt((19077*d>>8)+(26149*v>>8)-14234)}function B(d,v,L){return jt((19077*d>>8)-(6419*v>>8)-(13320*L>>8)+8708)}function ae(d,v){return jt((19077*d>>8)+(33050*v>>8)-17685)}function Pe(d,v,L,ie,ye){ie[ye+0]=p(d,L),ie[ye+1]=B(d,v,L),ie[ye+2]=ae(d,v)}function qe(d,v,L,ie,ye){ie[ye+0]=ae(d,v),ie[ye+1]=B(d,v,L),ie[ye+2]=p(d,L)}function et(d,v,L,ie,ye){var ve=B(d,v,L);v=ve<<3&224|ae(d,v)>>3,ie[ye+0]=248&p(d,L)|ve>>5,ie[ye+1]=v}function At(d,v,L,ie,ye){var ve=240&ae(d,v)|15;ie[ye+0]=240&p(d,L)|B(d,v,L)>>4,ie[ye+1]=ve}function Pr(d,v,L,ie,ye){ie[ye+0]=255,Pe(d,v,L,ie,ye+1)}function Rr(d,v,L,ie,ye){qe(d,v,L,ie,ye),ie[ye+3]=255}function wr(d,v,L,ie,ye){Pe(d,v,L,ie,ye),ie[ye+3]=255}function Qr(d,v){return 0>d?0:d>v?v:d}function nn(d,v,L){C[d]=function(ie,ye,ve,be,we,Ae,ke,Fe,Xe){for(var Ze=Fe+(-2&Xe)*L;Fe!=Ze;)v(ie[ye+0],ve[be+0],we[Ae+0],ke,Fe),v(ie[ye+1],ve[be+0],we[Ae+0],ke,Fe+L),ye+=2,++be,++Ae,Fe+=2*L;1&Xe&&v(ie[ye+0],ve[be+0],we[Ae+0],ke,Fe)}}function go(d,v,L){return L==0?d==0?v==0?6:5:v==0?4:0:L}function Kn(d,v,L,ie,ye){switch(d>>>30){case 3:cs(v,L,ie,ye,0);break;case 2:Pn(v,L,ie,ye);break;case 1:Ai(v,L,ie,ye)}}function Fo(d,v){var L,ie,ye=v.M,ve=v.Nb,be=d.oc,we=d.pc+40,Ae=d.oc,ke=d.pc+584,Fe=d.oc,Xe=d.pc+600;for(L=0;16>L;++L)be[we+32*L-1]=129;for(L=0;8>L;++L)Ae[ke+32*L-1]=129,Fe[Xe+32*L-1]=129;for(0<ye?be[we-1-32]=Ae[ke-1-32]=Fe[Xe-1-32]=129:(i(be,we-32-1,127,21),i(Ae,ke-32-1,127,9),i(Fe,Xe-32-1,127,9)),ie=0;ie<d.za;++ie){var Ze=v.ya[v.aa+ie];if(0<ie){for(L=-1;16>L;++L)n(be,we+32*L-4,be,we+32*L+12,4);for(L=-1;8>L;++L)n(Ae,ke+32*L-4,Ae,ke+32*L+4,4),n(Fe,Xe+32*L-4,Fe,Xe+32*L+4,4)}var He=d.Gd,gt=d.Hd+ie,rt=Ze.ad,Oe=Ze.Hc;if(0<ye&&(n(be,we-32,He[gt].y,0,16),n(Ae,ke-32,He[gt].f,0,8),n(Fe,Xe-32,He[gt].ea,0,8)),Ze.Za){var Ve=be,pt=we-32+16;for(0<ye&&(ie>=d.za-1?i(Ve,pt,He[gt].y[15],4):n(Ve,pt,He[gt+1].y,0,4)),L=0;4>L;L++)Ve[pt+128+L]=Ve[pt+256+L]=Ve[pt+384+L]=Ve[pt+0+L];for(L=0;16>L;++L,Oe<<=2)Ve=be,pt=we+lg[L],vo[Ze.Ob[L]](Ve,pt),Kn(Oe,rt,16*+L,Ve,pt)}else if(Ve=go(ie,ye,Ze.Ob[0]),Js[Ve](be,we),Oe!=0)for(L=0;16>L;++L,Oe<<=2)Kn(Oe,rt,16*+L,be,we+lg[L]);for(L=Ze.Gc,Ve=go(ie,ye,Ze.Dd),ds[Ve](Ae,ke),ds[Ve](Fe,Xe),Oe=rt,Ve=Ae,pt=ke,255&(Ze=L>>0)&&(170&Ze?Bc(Oe,256,Ve,pt):eo(Oe,256,Ve,pt)),Ze=Fe,Oe=Xe,255&(L>>=8)&&(170&L?Bc(rt,320,Ze,Oe):eo(rt,320,Ze,Oe)),ye<d.Ub-1&&(n(He[gt].y,0,be,we+480,16),n(He[gt].f,0,Ae,ke+224,8),n(He[gt].ea,0,Fe,Xe+224,8)),L=8*ve*d.B,He=d.sa,gt=d.ta+16*ie+16*ve*d.R,rt=d.qa,Ze=d.ra+8*ie+L,Oe=d.Ha,Ve=d.Ia+8*ie+L,L=0;16>L;++L)n(He,gt+L*d.R,be,we+32*L,16);for(L=0;8>L;++L)n(rt,Ze+L*d.B,Ae,ke+32*L,8),n(Oe,Ve+L*d.B,Fe,Xe+32*L,8)}}function Oo(d,v,L,ie,ye,ve,be,we,Ae){var ke=[0],Fe=[0],Xe=0,Ze=Ae!=null?Ae.kd:0,He=Ae??new qs;if(d==null||12>L)return 7;He.data=d,He.w=v,He.ha=L,v=[v],L=[L],He.gb=[He.gb];e:{var gt=v,rt=L,Oe=He.gb;if(e(d!=null),e(rt!=null),e(Oe!=null),Oe[0]=0,12<=rt[0]&&!r(d,gt[0],"RIFF")){if(r(d,gt[0]+8,"WEBP")){Oe=3;break e}var Ve=G(d,gt[0]+4);if(12>Ve||4294967286<Ve){Oe=3;break e}if(Ze&&Ve>rt[0]-8){Oe=7;break e}Oe[0]=Ve,gt[0]+=12,rt[0]-=12}Oe=0}if(Oe!=0)return Oe;for(Ve=0<He.gb[0],L=L[0];;){e:{var pt=d;rt=v,Oe=L;var St=ke,mt=Fe,Gt=gt=[0];if((qt=Xe=[Xe])[0]=0,8>Oe[0])Oe=7;else{if(!r(pt,rt[0],"VP8X")){if(G(pt,rt[0]+4)!=10){Oe=3;break e}if(18>Oe[0]){Oe=7;break e}var Bt=G(pt,rt[0]+8),ur=1+ne(pt,rt[0]+12);if(2147483648<=ur*(pt=1+ne(pt,rt[0]+15))){Oe=3;break e}Gt!=null&&(Gt[0]=Bt),St!=null&&(St[0]=ur),mt!=null&&(mt[0]=pt),rt[0]+=18,Oe[0]-=18,qt[0]=1}Oe=0}}if(Xe=Xe[0],gt=gt[0],Oe!=0)return Oe;if(rt=!!(2&gt),!Ve&&Xe)return 3;if(ve!=null&&(ve[0]=!!(16&gt)),be!=null&&(be[0]=rt),we!=null&&(we[0]=0),be=ke[0],gt=Fe[0],Xe&&rt&&Ae==null){Oe=0;break}if(4>L){Oe=7;break}if(Ve&&Xe||!Ve&&!Xe&&!r(d,v[0],"ALPH")){L=[L],He.na=[He.na],He.P=[He.P],He.Sa=[He.Sa];e:{Bt=d,Oe=v,Ve=L;var qt=He.gb;St=He.na,mt=He.P,Gt=He.Sa,ur=22,e(Bt!=null),e(Ve!=null),pt=Oe[0];var Wr=Ve[0];for(e(St!=null),e(Gt!=null),St[0]=null,mt[0]=null,Gt[0]=0;;){if(Oe[0]=pt,Ve[0]=Wr,8>Wr){Oe=7;break e}var Zr=G(Bt,pt+4);if(4294967286<Zr){Oe=3;break e}var zr=8+Zr+1&-2;if(ur+=zr,0<qt&&ur>qt){Oe=3;break e}if(!r(Bt,pt,"VP8 ")||!r(Bt,pt,"VP8L")){Oe=0;break e}if(Wr[0]<zr){Oe=7;break e}r(Bt,pt,"ALPH")||(St[0]=Bt,mt[0]=pt+8,Gt[0]=Zr),pt+=zr,Wr-=zr}}if(L=L[0],He.na=He.na[0],He.P=He.P[0],He.Sa=He.Sa[0],Oe!=0)break}L=[L],He.Ja=[He.Ja],He.xa=[He.xa];e:if(qt=d,Oe=v,Ve=L,St=He.gb[0],mt=He.Ja,Gt=He.xa,Bt=Oe[0],pt=!r(qt,Bt,"VP8 "),ur=!r(qt,Bt,"VP8L"),e(qt!=null),e(Ve!=null),e(mt!=null),e(Gt!=null),8>Ve[0])Oe=7;else{if(pt||ur){if(qt=G(qt,Bt+4),12<=St&&qt>St-12){Oe=3;break e}if(Ze&&qt>Ve[0]-8){Oe=7;break e}mt[0]=qt,Oe[0]+=8,Ve[0]-=8,Gt[0]=ur}else Gt[0]=5<=Ve[0]&&qt[Bt+0]==47&&!(qt[Bt+4]>>5),mt[0]=Ve[0];Oe=0}if(L=L[0],He.Ja=He.Ja[0],He.xa=He.xa[0],v=v[0],Oe!=0)break;if(4294967286<He.Ja)return 3;if(we==null||rt||(we[0]=He.xa?2:1),be=[be],gt=[gt],He.xa){if(5>L){Oe=7;break}we=be,Ze=gt,rt=ve,d==null||5>L?d=0:5<=L&&d[v+0]==47&&!(d[v+4]>>5)?(Ve=[0],qt=[0],St=[0],Y(mt=new N,d,v,L),tt(mt,Ve,qt,St)?(we!=null&&(we[0]=Ve[0]),Ze!=null&&(Ze[0]=qt[0]),rt!=null&&(rt[0]=St[0]),d=1):d=0):d=0}else{if(10>L){Oe=7;break}we=gt,d==null||10>L||!On(d,v+3,L-3)?d=0:(Ze=d[v+0]|d[v+1]<<8|d[v+2]<<16,rt=16383&(d[v+7]<<8|d[v+6]),d=16383&(d[v+9]<<8|d[v+8]),1&Ze||3<(Ze>>1&7)||!(Ze>>4&1)||Ze>>5>=He.Ja||!rt||!d?d=0:(be&&(be[0]=rt),we&&(we[0]=d),d=1))}if(!d||(be=be[0],gt=gt[0],Xe&&(ke[0]!=be||Fe[0]!=gt)))return 3;Ae!=null&&(Ae[0]=He,Ae.offset=v-Ae.w,e(4294967286>v-Ae.w),e(Ae.offset==Ae.ha-L));break}return Oe==0||Oe==7&&Xe&&Ae==null?(ve!=null&&(ve[0]|=He.na!=null&&0<He.na.length),ie!=null&&(ie[0]=be),ye!=null&&(ye[0]=gt),0):Oe}function Dc(d,v,L){var ie=v.width,ye=v.height,ve=0,be=0,we=ie,Ae=ye;if(v.Da=d!=null&&0<d.Da,v.Da&&(we=d.cd,Ae=d.bd,ve=d.v,be=d.j,11>L||(ve&=-2,be&=-2),0>ve||0>be||0>=we||0>=Ae||ve+we>ie||be+Ae>ye))return 0;if(v.v=ve,v.j=be,v.va=ve+we,v.o=be+Ae,v.U=we,v.T=Ae,v.da=d!=null&&0<d.da,v.da){if(!de(we,Ae,L=[d.ib],ve=[d.hb]))return 0;v.ib=L[0],v.hb=ve[0]}return v.ob=d!=null&&d.ob,v.Kb=d==null||!d.Sd,v.da&&(v.ob=v.ib<3*ie/4&&v.hb<3*ye/4,v.Kb=0),1}function Mc(d){if(d==null)return 2;if(11>d.S){var v=d.f.RGBA;v.fb+=(d.height-1)*v.A,v.A=-v.A}else v=d.f.kb,d=d.height,v.O+=(d-1)*v.fa,v.fa=-v.fa,v.N+=(d-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(d-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(d-1)*v.lb,v.lb=-v.lb);return 0}function Ml(d,v,L,ie){if(ie==null||0>=d||0>=v)return 2;if(L!=null){if(L.Da){var ye=L.cd,ve=L.bd,be=-2&L.v,we=-2&L.j;if(0>be||0>we||0>=ye||0>=ve||be+ye>d||we+ve>v)return 2;d=ye,v=ve}if(L.da){if(!de(d,v,ye=[L.ib],ve=[L.hb]))return 2;d=ye[0],v=ve[0]}}ie.width=d,ie.height=v;e:{var Ae=ie.width,ke=ie.height;if(d=ie.S,0>=Ae||0>=ke||!(d>=dd&&13>d))d=2;else{if(0>=ie.Rd&&ie.sd==null){be=ve=ye=v=0;var Fe=(we=Ae*cg[d])*ke;if(11>d||(ve=(ke+1)/2*(v=(Ae+1)/2),d==12&&(be=(ye=Ae)*ke)),(ke=o(Fe+2*ve+be))==null){d=1;break e}ie.sd=ke,11>d?((Ae=ie.f.RGBA).eb=ke,Ae.fb=0,Ae.A=we,Ae.size=Fe):((Ae=ie.f.kb).y=ke,Ae.O=0,Ae.fa=we,Ae.Fd=Fe,Ae.f=ke,Ae.N=0+Fe,Ae.Ab=v,Ae.Cd=ve,Ae.ea=ke,Ae.W=0+Fe+ve,Ae.Db=v,Ae.Ed=ve,d==12&&(Ae.F=ke,Ae.J=0+Fe+2*ve),Ae.Tc=be,Ae.lb=ye)}if(v=1,ye=ie.S,ve=ie.width,be=ie.height,ye>=dd&&13>ye)if(11>ye)d=ie.f.RGBA,v&=(we=Math.abs(d.A))*(be-1)+ve<=d.size,v&=we>=ve*cg[ye],v&=d.eb!=null;else{d=ie.f.kb,we=(ve+1)/2,Fe=(be+1)/2,Ae=Math.abs(d.fa),ke=Math.abs(d.Ab);var Xe=Math.abs(d.Db),Ze=Math.abs(d.lb),He=Ze*(be-1)+ve;v&=Ae*(be-1)+ve<=d.Fd,v&=ke*(Fe-1)+we<=d.Cd,v=(v&=Xe*(Fe-1)+we<=d.Ed)&Ae>=ve&ke>=we&Xe>=we,v&=d.y!=null,v&=d.f!=null,v&=d.ea!=null,ye==12&&(v&=Ze>=ve,v&=He<=d.Tc,v&=d.F!=null)}else v=0;d=v?0:2}}return d!=0||L!=null&&L.fd&&(d=Mc(ie)),d}var Jn=64,Fl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ol=24,Bl=32,Fc=8,Ei=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ge("Predictor0","PredictorAdd0"),C.Predictor0=function(){return 4278190080},C.Predictor1=function(d){return d},C.Predictor2=function(d,v,L){return v[L+0]},C.Predictor3=function(d,v,L){return v[L+1]},C.Predictor4=function(d,v,L){return v[L-1]},C.Predictor5=function(d,v,L){return pe(pe(d,v[L+1]),v[L+0])},C.Predictor6=function(d,v,L){return pe(d,v[L-1])},C.Predictor7=function(d,v,L){return pe(d,v[L+0])},C.Predictor8=function(d,v,L){return pe(v[L-1],v[L+0])},C.Predictor9=function(d,v,L){return pe(v[L+0],v[L+1])},C.Predictor10=function(d,v,L){return pe(pe(d,v[L-1]),pe(v[L+0],v[L+1]))},C.Predictor11=function(d,v,L){var ie=v[L+0];return 0>=De(ie>>24&255,d>>24&255,(v=v[L-1])>>24&255)+De(ie>>16&255,d>>16&255,v>>16&255)+De(ie>>8&255,d>>8&255,v>>8&255)+De(255&ie,255&d,255&v)?ie:d},C.Predictor12=function(d,v,L){var ie=v[L+0];return(_e((d>>24&255)+(ie>>24&255)-((v=v[L-1])>>24&255))<<24|_e((d>>16&255)+(ie>>16&255)-(v>>16&255))<<16|_e((d>>8&255)+(ie>>8&255)-(v>>8&255))<<8|_e((255&d)+(255&ie)-(255&v)))>>>0},C.Predictor13=function(d,v,L){var ie=v[L-1];return(Le((d=pe(d,v[L+0]))>>24&255,ie>>24&255)<<24|Le(d>>16&255,ie>>16&255)<<16|Le(d>>8&255,ie>>8&255)<<8|Le(d>>0&255,ie>>0&255))>>>0};var _p=C.PredictorAdd0;C.PredictorAdd1=Te,ge("Predictor2","PredictorAdd2"),ge("Predictor3","PredictorAdd3"),ge("Predictor4","PredictorAdd4"),ge("Predictor5","PredictorAdd5"),ge("Predictor6","PredictorAdd6"),ge("Predictor7","PredictorAdd7"),ge("Predictor8","PredictorAdd8"),ge("Predictor9","PredictorAdd9"),ge("Predictor10","PredictorAdd10"),ge("Predictor11","PredictorAdd11"),ge("Predictor12","PredictorAdd12"),ge("Predictor13","PredictorAdd13");var Oc=C.PredictorAdd2;Ke("ColorIndexInverseTransform","MapARGB","32b",function(d){return d>>8&255},function(d){return d}),Ke("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(d){return d},function(d){return d>>8&255});var od,Zi=C.ColorIndexInverseTransform,jl=C.MapARGB,sd=C.VP8LColorIndexInverseTransformAlpha,ad=C.MapAlpha,Gs=C.VP8LPredictorsAdd=[];Gs.length=16,(C.VP8LPredictors=[]).length=16,(C.VP8LPredictorsAdd_C=[]).length=16,(C.VP8LPredictors_C=[]).length=16;var Ha,Ti,xi,Ws,as,ls,Vl,cs,Pn,Bc,Ai,eo,ql,ld,jc,Ga,Wa,Ys,Ya,zl,Ka,Ks,Vc,to,ro,ln,cn,wn,jn=o(511),us=o(2041),qc=o(225),Ul=o(767),cd=0,Sp=us,ud=qc,Hi=Ul,no=jn,dd=0,hd=1,Xy=2,pd=3,fd=4,Pp=5,Zy=6,wp=7,xp=8,md=9,Ap=10,P_=[2,3,7],w_=[3,3,11],eg=[280,256,256,256,40],x_=[0,1,1,1,0],A_=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],C_=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],I_=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],$_=8,Cp=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ip=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],zc=null,E_=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],T_=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],tg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],k_=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],N_=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],L_=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],R_=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Js=[],vo=[],ds=[],D_=1,rg=2,Qs=[],io=[];ot("UpsampleRgbLinePair",Pe,3),ot("UpsampleBgrLinePair",qe,3),ot("UpsampleRgbaLinePair",wr,4),ot("UpsampleBgraLinePair",Rr,4),ot("UpsampleArgbLinePair",Pr,4),ot("UpsampleRgba4444LinePair",At,2),ot("UpsampleRgb565LinePair",et,2);var M_=C.UpsampleRgbLinePair,F_=C.UpsampleBgrLinePair,ng=C.UpsampleRgbaLinePair,ig=C.UpsampleBgraLinePair,og=C.UpsampleArgbLinePair,sg=C.UpsampleRgba4444LinePair,O_=C.UpsampleRgb565LinePair,yd=16,gd=1<<yd-1,Uc=-227,$p=482,B_=6,ag=0,j_=o(256),V_=o(256),q_=o(256),z_=o(256),U_=o($p-Uc),H_=o($p-Uc);nn("YuvToRgbRow",Pe,3),nn("YuvToBgrRow",qe,3),nn("YuvToRgbaRow",wr,4),nn("YuvToBgraRow",Rr,4),nn("YuvToArgbRow",Pr,4),nn("YuvToRgba4444Row",At,2),nn("YuvToRgb565Row",et,2);var lg=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],vd=[0,2,8],G_=[8,7,6,4,4,2,2,2,1,1,1,1],W_=1;this.WebPDecodeRGBA=function(d,v,L,ie,ye){var ve=hd,be=new os,we=new ze;be.ba=we,we.S=ve,we.width=[we.width],we.height=[we.height];var Ae=we.width,ke=we.height,Fe=new Lt;if(Fe==null||d==null)var Xe=2;else e(Fe!=null),Xe=Oo(d,v,L,Fe.width,Fe.height,Fe.Pd,Fe.Qd,Fe.format,null);if(Xe!=0?Ae=0:(Ae!=null&&(Ae[0]=Fe.width[0]),ke!=null&&(ke[0]=Fe.height[0]),Ae=1),Ae){we.width=we.width[0],we.height=we.height[0],ie!=null&&(ie[0]=we.width),ye!=null&&(ye[0]=we.height);e:{if(ie=new gn,(ye=new qs).data=d,ye.w=v,ye.ha=L,ye.kd=1,v=[0],e(ye!=null),((d=Oo(ye.data,ye.w,ye.ha,null,null,null,v,null,ye))==0||d==7)&&v[0]&&(d=4),(v=d)==0){if(e(be!=null),ie.data=ye.data,ie.w=ye.w+ye.offset,ie.ha=ye.ha-ye.offset,ie.put=Pt,ie.ac=Be,ie.bc=Ct,ie.ma=be,ye.xa){if((d=er())==null){be=1;break e}if(function(Ze,He){var gt=[0],rt=[0],Oe=[0];t:for(;;){if(Ze==null)return 0;if(He==null)return Ze.a=2,0;if(Ze.l=He,Ze.a=0,Y(Ze.m,He.data,He.w,He.ha),!tt(Ze.m,gt,rt,Oe)){Ze.a=3;break t}if(Ze.xb=rg,He.width=gt[0],He.height=rt[0],!kt(gt[0],rt[0],1,Ze,null))break t;return 1}return e(Ze.a!=0),0}(d,ie)){if(ie=(v=Ml(ie.width,ie.height,be.Oa,be.ba))==0){t:{ie=d;r:for(;;){if(ie==null){ie=0;break t}if(e(ie.s.yc!=null),e(ie.s.Ya!=null),e(0<ie.s.Wb),e((L=ie.l)!=null),e((ye=L.ma)!=null),ie.xb!=0){if(ie.ca=ye.ba,ie.tb=ye.tb,e(ie.ca!=null),!Dc(ye.Oa,L,pd)){ie.a=2;break r}if(!Xt(ie,L.width)||L.da)break r;if((L.da||lt(ie.ca.S))&&Ue(),11>ie.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ie.ca.f.kb.F!=null&&Ue()),ie.Pb&&0<ie.s.ua&&ie.s.vb.X==null&&!ce(ie.s.vb,ie.s.Wa.Xa)){ie.a=1;break r}ie.xb=0}if(!Wt(ie,ie.V,ie.Ba,ie.c,ie.i,L.o,It))break r;ye.Dc=ie.Ma,ie=1;break t}e(ie.a!=0),ie=0}ie=!ie}ie&&(v=d.a)}else v=d.a}else{if((d=new En)==null){be=1;break e}if(d.Fa=ye.na,d.P=ye.P,d.qc=ye.Sa,bi(d,ie)){if((v=Ml(ie.width,ie.height,be.Oa,be.ba))==0){if(d.Aa=0,L=be.Oa,e((ye=d)!=null),L!=null){if(0<(Ae=0>(Ae=L.Md)?0:100<Ae?255:255*Ae/100)){for(ke=Fe=0;4>ke;++ke)12>(Xe=ye.pb[ke]).lc&&(Xe.ia=Ae*G_[0>Xe.lc?0:Xe.lc]>>3),Fe|=Xe.ia;Fe&&(alert("todo:VP8InitRandom"),ye.ia=1)}ye.Ga=L.Id,100<ye.Ga?ye.Ga=100:0>ye.Ga&&(ye.Ga=0)}Lr(d,ie)||(v=d.a)}}else v=d.a}v==0&&be.Oa!=null&&be.Oa.fd&&(v=Mc(be.ba))}be=v}ve=be!=0?null:11>ve?we.f.RGBA.eb:we.f.kb.y}else ve=null;return ve};var cg=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(C,T){for(var j="",b=0;b<4;b++)j+=String.fromCharCode(C[T++]);return j}function h(C,T){return(C[T+0]<<0|C[T+1]<<8|C[T+2]<<16)>>>0}function y(C,T){return(C[T+0]<<0|C[T+1]<<8|C[T+2]<<16|C[T+3]<<24)>>>0}new c;var g=[0],f=[0],x=[],S=new c,P=t,$=function(C,T){var j={},b=0,w=!1,_=0,W=0;if(j.frames=[],!function(D,V,I,F){for(var Q=0;Q<F;Q++)if(D[V+Q]!=I.charCodeAt(Q))return!0;return!1}(C,T,"RIFF",4)){for(y(C,T+=4),T+=8;T<C.length;){var K=u(C,T),k=y(C,T+=4);T+=4;var R=k+(1&k);switch(K){case"VP8 ":case"VP8L":j.frames[b]===void 0&&(j.frames[b]={}),(O=j.frames[b]).src_off=w?W:T-8,O.src_size=_+k+8,b++,w&&(w=!1,_=0,W=0);break;case"VP8X":(O=j.header={}).feature_flags=C[T];var Y=T+4;O.canvas_width=1+h(C,Y),Y+=3,O.canvas_height=1+h(C,Y),Y+=3;break;case"ALPH":w=!0,_=R+8,W=T-8;break;case"ANIM":(O=j.header).bgcolor=y(C,T),Y=T+4,O.loop_count=(le=C)[(N=Y)+0]<<0|le[N+1]<<8,Y+=2;break;case"ANMF":var q,O;(O=j.frames[b]={}).offset_x=2*h(C,T),T+=3,O.offset_y=2*h(C,T),T+=3,O.width=1+h(C,T),T+=3,O.height=1+h(C,T),T+=3,O.duration=h(C,T),T+=3,q=C[T++],O.dispose=1&q,O.blend=q>>1&1}K!="ANMF"&&(T+=R)}var le,N;return j}}(P,0);$.response=P,$.rgbaoutput=!0,$.dataurl=!1;var U=$.header?$.header:null,se=$.frames?$.frames:null;if(U){U.loop_counter=U.loop_count,g=[U.canvas_height],f=[U.canvas_width];for(var X=0;X<se.length&&se[X].blend!=0;X++);}var Z=se[0],re=S.WebPDecodeRGBA(P,Z.src_off,Z.src_size,f,g);Z.rgba=re,Z.imgwidth=f[0],Z.imgheight=g[0];for(var E=0;E<f[0]*g[0]*4;E++)x[E]=re[E];return this.width=f,this.height=g,this.data=x,this}(function(t){var e=function(){return typeof $m=="function"},r=function(g,f,x,S){var P=4,$=s;switch(S){case t.image_compression.FAST:P=1,$=o;break;case t.image_compression.MEDIUM:P=6,$=l;break;case t.image_compression.SLOW:P=9,$=c}g=n(g,f,x,$);var U=$m(g,{level:P});return t.__addimage__.arrayBufferToBinaryString(U)},n=function(g,f,x,S){for(var P,$,U,se=g.length/f,X=new Uint8Array(g.length+se),Z=h(),re=0;re<se;re+=1){if(U=re*f,P=g.subarray(U,U+f),S)X.set(S(P,x,$),U+re);else{for(var E,C=Z.length,T=[];E<C;E+=1)T[E]=Z[E](P,x,$);var j=y(T.concat());X.set(T[j],U+re)}$=P}return X},i=function(g){var f=Array.apply([],g);return f.unshift(0),f},o=function(g,f){var x,S=[],P=g.length;S[0]=1;for(var $=0;$<P;$+=1)x=g[$-f]||0,S[$+1]=g[$]-x+256&255;return S},s=function(g,f,x){var S,P=[],$=g.length;P[0]=2;for(var U=0;U<$;U+=1)S=x&&x[U]||0,P[U+1]=g[U]-S+256&255;return P},l=function(g,f,x){var S,P,$=[],U=g.length;$[0]=3;for(var se=0;se<U;se+=1)S=g[se-f]||0,P=x&&x[se]||0,$[se+1]=g[se]+256-(S+P>>>1)&255;return $},c=function(g,f,x){var S,P,$,U,se=[],X=g.length;se[0]=4;for(var Z=0;Z<X;Z+=1)S=g[Z-f]||0,P=x&&x[Z]||0,$=x&&x[Z-f]||0,U=u(S,P,$),se[Z+1]=g[Z]-U+256&255;return se},u=function(g,f,x){if(g===f&&f===x)return g;var S=Math.abs(f-x),P=Math.abs(g-x),$=Math.abs(g+f-x-x);return S<=P&&S<=$?g:P<=$?f:x},h=function(){return[i,o,s,l,c]},y=function(g){var f=g.map(function(x){return x.reduce(function(S,P){return S+Math.abs(P)},0)});return f.indexOf(Math.min.apply(null,f))};t.processPNG=function(g,f,x,S){var P,$,U,se,X,Z,re,E,C,T,j,b,w,_,W,K=this.decode.FLATE_DECODE,k="";if(this.__addimage__.isArrayBuffer(g)&&(g=new Uint8Array(g)),this.__addimage__.isArrayBufferView(g)){if(g=(U=new XL(g)).imgData,$=U.bits,P=U.colorSpace,X=U.colors,[4,6].indexOf(U.colorType)!==-1){if(U.bits===8){C=(E=U.pixelBitlength==32?new Uint32Array(U.decodePixels().buffer):U.pixelBitlength==16?new Uint16Array(U.decodePixels().buffer):new Uint8Array(U.decodePixels().buffer)).length,j=new Uint8Array(C*U.colors),T=new Uint8Array(C);var R,Y=U.pixelBitlength-U.bits;for(_=0,W=0;_<C;_++){for(w=E[_],R=0;R<Y;)j[W++]=w>>>R&255,R+=U.bits;T[_]=w>>>R&255}}if(U.bits===16){C=(E=new Uint32Array(U.decodePixels().buffer)).length,j=new Uint8Array(C*(32/U.pixelBitlength)*U.colors),T=new Uint8Array(C*(32/U.pixelBitlength)),b=U.colors>1,_=0,W=0;for(var q=0;_<C;)w=E[_++],j[W++]=w>>>0&255,b&&(j[W++]=w>>>16&255,w=E[_++],j[W++]=w>>>0&255),T[q++]=w>>>16&255;$=8}S!==t.image_compression.NONE&&e()?(g=r(j,U.width*U.colors,U.colors,S),re=r(T,U.width,1,S)):(g=j,re=T,K=void 0)}if(U.colorType===3&&(P=this.color_spaces.INDEXED,Z=U.palette,U.transparency.indexed)){var O=U.transparency.indexed,le=0;for(_=0,C=O.length;_<C;++_)le+=O[_];if((le/=255)===C-1&&O.indexOf(0)!==-1)se=[O.indexOf(0)];else if(le!==C){for(E=U.decodePixels(),T=new Uint8Array(E.length),_=0,C=E.length;_<C;_++)T[_]=O[E[_]];re=r(T,U.width,1)}}var N=function(D){var V;switch(D){case t.image_compression.FAST:V=11;break;case t.image_compression.MEDIUM:V=13;break;case t.image_compression.SLOW:V=14;break;default:V=12}return V}(S);return K===this.decode.FLATE_DECODE&&(k="/Predictor "+N+" "),k+="/Colors "+X+" /BitsPerComponent "+$+" /Columns "+U.width,(this.__addimage__.isArrayBuffer(g)||this.__addimage__.isArrayBufferView(g))&&(g=this.__addimage__.arrayBufferToBinaryString(g)),(re&&this.__addimage__.isArrayBuffer(re)||this.__addimage__.isArrayBufferView(re))&&(re=this.__addimage__.arrayBufferToBinaryString(re)),{alias:x,data:g,index:f,filter:K,decodeParameters:k,transparency:se,palette:Z,sMask:re,predictor:N,width:U.width,height:U.height,bitsPerComponent:$,colorSpace:P}}}})(dr.API),function(t){t.processGIF89A=function(e,r,n,i){var o=new ZL(e),s=o.width,l=o.height,c=[];o.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:s,height:l},h=new Ef(100).encode(u,100);return t.processJPEG.call(this,h,r,n,i)},t.processGIF87A=t.processGIF89A}(dr.API),Po.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Po.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){sn.log("bit decode error:"+r)}},Po.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[o>>7-l&1];this.data[s+4*l]=c.blue,this.data[s+4*l+1]=c.green,this.data[s+4*l+2]=c.red,this.data[s+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Po.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var o=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,l=o>>4,c=15&o,u=this.palette[l];if(this.data[s]=u.blue,this.data[s+1]=u.green,this.data[s+2]=u.red,this.data[s+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[s+4]=u.blue,this.data[s+4+1]=u.green,this.data[s+4+2]=u.red,this.data[s+4+3]=255}e!==0&&(this.pos+=4-e)}},Po.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[o]=s.red,this.data[o+1]=s.green,this.data[o+2]=s.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}t!==0&&(this.pos+=4-t)}},Po.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&e)/e*255|0,l=(o>>5&e)/e*255|0,c=(o>>10&e)/e*255|0,u=o>>15?255:0,h=n*this.width*4+4*i;this.data[h]=c,this.data[h+1]=l,this.data[h+2]=s,this.data[h+3]=u}this.pos+=t}},Po.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&e)/e*255|0,c=(s>>5&r)/r*255|0,u=(s>>11)/e*255|0,h=i*this.width*4+4*o;this.data[h]=u,this.data[h+1]=c,this.data[h+2]=l,this.data[h+3]=255}this.pos+=t}},Po.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*r;this.data[s]=o,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Po.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=e*this.width*4+4*r;this.data[l]=o,this.data[l+1]=i,this.data[l+2]=n,this.data[l+3]=s}},Po.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,i){var o=new Po(e,!1),s=o.width,l=o.height,c={data:o.getData(),width:s,height:l},u=new Ef(100).encode(c,100);return t.processJPEG.call(this,u,r,n,i)}}(dr.API),nb.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,i){var o=new nb(e),s=o.width,l=o.height,c={data:o.getData(),width:s,height:l},u=new Ef(100).encode(c,100);return t.processJPEG.call(this,u,r,n,i)}}(dr.API),dr.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,o=new Uint8Array(i/4*3),s=new Uint8Array(i/4),l=0,c=0,u=0;u<i;u+=4){var h=n[u],y=n[u+1],g=n[u+2],f=n[u+3];o[l++]=h,o[l++]=y,o[l++]=g,s[c++]=f}var x=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:x,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},dr.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},ec=dr.API,Jd=ec.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),o=e.fontSize||this.internal.getFontSize(),s=e.charSpace||this.internal.getCharSpace(),l=e.widths?e.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,u=e.kerning?e.kerning:i.metadata.Unicode.kerning,h=u.fof?u.fof:1,y=e.doKerning!==!1,g=0,f=t.length,x=0,S=l[0]||c,P=[];for(r=0;r<f;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?P.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/o)||0)/1e3):(g=y&&tn(u[n])==="object"&&!isNaN(parseInt(u[n][x],10))?u[n][x]/h:0,P.push((l[n]||S)/c+g)),x=n;return P},Z0=ec.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return ec.processArabic&&(t=ec.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:Jd.apply(this,arguments).reduce(function(o,s){return o+s},0)},eb=function(t,e,r,n){for(var i=[],o=0,s=t.length,l=0;o!==s&&l+e[o]<r;)l+=e[o],o++;i.push(t.slice(0,o));var c=o;for(l=0;o!==s;)l+e[o]>n&&(i.push(t.slice(c,o)),l=0,c=o),l+=e[o],o++;return c!==o&&i.push(t.slice(c,o)),i},tb=function(t,e,r){r||(r={});var n,i,o,s,l,c,u,h=[],y=[h],g=r.textIndent||0,f=0,x=0,S=t.split(" "),P=Jd.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?S[0].length+2:r.lineIndent||0){var $=Array(c).join(" "),U=[];S.map(function(X){(X=X.split(/\s*\n/)).length>1?U=U.concat(X.map(function(Z,re){return(re&&Z.length?`
`:"")+Z})):U.push(X[0])}),S=U,c=Z0.apply(this,[$,r])}for(o=0,s=S.length;o<s;o++){var se=0;if(n=S[o],c&&n[0]==`
`&&(n=n.substr(1),se=1),g+f+(x=(i=Jd.apply(this,[n,r])).reduce(function(X,Z){return X+Z},0))>e||se){if(x>e){for(l=eb.apply(this,[n,i,e-(g+f),e]),h.push(l.shift()),h=[l.pop()];l.length;)y.push([l.shift()]);x=i.slice(n.length-(h[0]?h[0].length:0)).reduce(function(X,Z){return X+Z},0)}else h=[n];y.push(h),g=x+c,f=P}else h.push(n),g+=f+x,f=P}return u=c?function(X,Z){return(Z?$:"")+X.join(" ")}:function(X){return X.join(" ")},y.map(u)},ec.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),o=function(h){if(h.widths&&h.kerning)return{widths:h.widths,kerning:h.kerning};var y=this.internal.getFont(h.fontName,h.fontStyle);return y.metadata.Unicode?{widths:y.metadata.Unicode.widths||{0:1},kerning:y.metadata.Unicode.kerning||{}}:{font:y.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var s=1*this.internal.scaleFactor*e/i;o.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,o.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(tb.apply(this,[n[l],s,o]));return u},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},n={},i=0;i<e.length;i++)r[e[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=e[i];var o=function(y){return"0x"+parseInt(y,10).toString(16)},s=t.__fontmetrics__.compress=function(y){var g,f,x,S,P=["{"];for(var $ in y){if(g=y[$],isNaN(parseInt($,10))?f="'"+$+"'":($=parseInt($,10),f=(f=o($).slice(2)).slice(0,-1)+n[f.slice(-1)]),typeof g=="number")g<0?(x=o(g).slice(3),S="-"):(x=o(g).slice(2),S=""),x=S+x.slice(0,-1)+n[x.slice(-1)];else{if(tn(g)!=="object")throw new Error("Don't know what to do with value type "+tn(g)+".");x=s(g)}P.push(f+x)}return P.push("}"),P.join("")},l=t.__fontmetrics__.uncompress=function(y){if(typeof y!="string")throw new Error("Invalid argument passed to uncompress.");for(var g,f,x,S,P={},$=1,U=P,se=[],X="",Z="",re=y.length-1,E=1;E<re;E+=1)(S=y[E])=="'"?g?(x=g.join(""),g=void 0):g=[]:g?g.push(S):S=="{"?(se.push([U,x]),U={},x=void 0):S=="}"?((f=se.pop())[0][f[1]]=U,x=void 0,U=f[0]):S=="-"?$=-1:x===void 0?r.hasOwnProperty(S)?(X+=r[S],x=parseInt(X,16)*$,$=1,X=""):X+=S:r.hasOwnProperty(S)?(Z+=r[S],U[x]=parseInt(Z,16)*$,$=1,x=void 0,Z=""):Z+=S;return P},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(y){var g=y.font,f=h.Unicode[g.postScriptName];f&&(g.metadata.Unicode={},g.metadata.Unicode.widths=f.widths,g.metadata.Unicode.kerning=f.kerning);var x=u.Unicode[g.postScriptName];x&&(g.metadata.Unicode.encoding=x,g.encoding=x.codePages[0])}])}(dr.API),function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),o=0;o<n;o++)i[o]=r.charCodeAt(o);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,o=r.instance;if(!i.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=o.existsFileInVFS(i.postScriptName)===!1?o.loadFile(i.postScriptName):o.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,l){l=/^\x00\x01\x00\x00/.test(l)?e(l):e(_u(l)),s.metadata=t.API.TTFFont.open(l),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])}(dr),function(t){function e(){return(fr.canvg?Promise.resolve(fr.canvg):Oi(()=>import("./index.es-CuC8qcGR.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}dr.API.addSvgAsImage=function(r,n,i,o,s,l,c,u){if(isNaN(n)||isNaN(i))throw sn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(s))throw sn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var h=document.createElement("canvas");h.width=o,h.height=s;var y=h.getContext("2d");y.fillStyle="#fff",y.fillRect(0,0,h.width,h.height);var g={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return e().then(function(x){return x.fromString(y,r,g)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(x){return x.render(g)}).then(function(){f.addImage(h.toDataURL("image/jpeg",1),n,i,o,s,c,u)})}}(),dr.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},dr.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,o,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(s),c=[],u=0,h=0,y=0;function g(x,S){var P,$=!1;for(P=0;P<x.length;P+=1)x[P]===S&&($=!0);return $}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var f=l.length;for(y=0;y<f;y+=1)r[l[y]].value=r[l[y]].defaultValue,r[l[y]].explicitSet=!1}if(tn(t)==="object"){for(i in t)if(o=t[i],g(l,i)&&o!==void 0){if(r[i].type==="boolean"&&typeof o=="boolean")r[i].value=o;else if(r[i].type==="name"&&g(r[i].valueSet,o))r[i].value=o;else if(r[i].type==="integer"&&Number.isInteger(o))r[i].value=o;else if(r[i].type==="array"){for(u=0;u<o.length;u+=1)if(n=!0,o[u].length===1&&typeof o[u][0]=="number")c.push(String(o[u]-1));else if(o[u].length>1){for(h=0;h<o[u].length;h+=1)typeof o[u][h]!="number"&&(n=!1);n===!0&&c.push([o[u][0]-1,o[u][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var x,S=[];for(x in r)r[x].explicitSet===!0&&(r[x].type==="name"?S.push("/"+x+" /"+r[x].value):S.push("/"+x+" "+r[x].value));S.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+S.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=o.length+s.length+l.length+i.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+o+s+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(dr.API),function(t){var e=t.API,r=e.pdfEscape16=function(o,s){for(var l,c=s.metadata.Unicode.widths,u=["","0","00","000","0000"],h=[""],y=0,g=o.length;y<g;++y){if(l=s.metadata.characterToGlyph(o.charCodeAt(y)),s.metadata.glyIdsUsed.push(l),s.metadata.toUnicode[l]=o.charCodeAt(y),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(s.metadata.widthOfGlyph(l),10)])),l=="0")return h.join("");l=l.toString(16),h.push(u[4-l.length],l)}return h.join("")},n=function(o){var s,l,c,u,h,y,g;for(h=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],y=0,g=(l=Object.keys(o).sort(function(f,x){return f-x})).length;y<g;y++)s=l[y],c.length>=100&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),o[s]!==void 0&&o[s]!==null&&typeof o[s].toString=="function"&&(u=("0000"+o[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+u+">"));return c.length&&(h+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),h+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(o){(function(s){var l=s.font,c=s.out,u=s.newObject,h=s.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="Identity-H"){for(var y=l.metadata.Unicode.widths,g=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),f="",x=0;x<g.length;x++)f+=String.fromCharCode(g[x]);var S=u();h({data:f,addLength1:!0,objectId:S}),c("endobj");var P=u();h({data:n(l.metadata.toUnicode),addLength1:!0,objectId:P}),c("endobj");var $=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+lc(l.fontName)),c("/FontFile2 "+S+" 0 R"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var U=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+lc(l.fontName)),c("/FontDescriptor "+$+" 0 R"),c("/W "+t.API.PDFObject.convert(y)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+P+" 0 R"),c("/BaseFont /"+lc(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+U+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(o)}]),e.events.push(["putFont",function(o){(function(s){var l=s.font,c=s.out,u=s.newObject,h=s.putStream;if(l.metadata instanceof t.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var y=l.metadata.rawData,g="",f=0;f<y.length;f++)g+=String.fromCharCode(y[f]);var x=u();h({data:g,addLength1:!0,objectId:x}),c("endobj");var S=u();h({data:n(l.metadata.toUnicode),addLength1:!0,objectId:S}),c("endobj");var P=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+x+" 0 R"),c("/Flags 96"),c("/FontBBox "+t.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+lc(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var $=0;$<l.metadata.hmtx.widths.length;$++)l.metadata.hmtx.widths[$]=parseInt(l.metadata.hmtx.widths[$]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+S+" 0 R/BaseFont/"+lc(l.fontName)+"/FontDescriptor "+P+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(o)}]);var i=function(o){var s,l=o.text||"",c=o.x,u=o.y,h=o.options||{},y=o.mutex||{},g=y.pdfEscape,f=y.activeFontKey,x=y.fonts,S=f,P="",$=0,U="",se=x[S].encoding;if(x[S].encoding!=="Identity-H")return{text:l,x:c,y:u,options:h,mutex:y};for(U=l,S=f,Array.isArray(l)&&(U=l[0]),$=0;$<U.length;$+=1)x[S].metadata.hasOwnProperty("cmap")&&(s=x[S].metadata.cmap.unicode.codeMap[U[$].charCodeAt(0)]),s||U[$].charCodeAt(0)<256&&x[S].metadata.hasOwnProperty("Unicode")?P+=U[$]:P+="";var X="";return parseInt(S.slice(1))<14||se==="WinAnsiEncoding"?X=g(P,S).split("").map(function(Z){return Z.charCodeAt(0).toString(16)}).join(""):se==="Identity-H"&&(X=r(P,x[S])),y.isHex=!0,{text:X,x:c,y:u,options:h,mutex:y}};e.events.push(["postProcessText",function(o){var s=o.text||"",l=[],c={text:s,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(s)){var u=0;for(u=0;u<s.length;u+=1)Array.isArray(s[u])&&s[u].length===3?l.push([i(Object.assign({},c,{text:s[u][0]})).text,s[u][1],s[u][2]]):l.push(i(Object.assign({},c,{text:s[u]})).text);o.text=l}else o.text=i(Object.assign({},c,{text:s})).text}])}(dr),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(dr.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,o,s,l,c,u,h,y=e,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],x={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},S={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},P=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],$=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),U=!1,se=0;this.__bidiEngine__={};var X=function(b){var w=b.charCodeAt(),_=w>>8,W=S[_];return W!==void 0?y[256*W+(255&w)]:_===252||_===253?"AL":$.test(_)?"L":_===8?"R":"N"},Z=function(b){for(var w,_=0;_<b.length;_++){if((w=X(b.charAt(_)))==="L")return!1;if(w==="R")return!0}return!1},re=function(b,w,_,W){var K,k,R,Y,q=w[W];switch(q){case"L":case"R":U=!1;break;case"N":case"AN":break;case"EN":U&&(q="AN");break;case"AL":U=!0,q="R";break;case"WS":q="N";break;case"CS":W<1||W+1>=w.length||(K=_[W-1])!=="EN"&&K!=="AN"||(k=w[W+1])!=="EN"&&k!=="AN"?q="N":U&&(k="AN"),q=k===K?k:"N";break;case"ES":q=(K=W>0?_[W-1]:"B")==="EN"&&W+1<w.length&&w[W+1]==="EN"?"EN":"N";break;case"ET":if(W>0&&_[W-1]==="EN"){q="EN";break}if(U){q="N";break}for(R=W+1,Y=w.length;R<Y&&w[R]==="ET";)R++;q=R<Y&&w[R]==="EN"?"EN":"N";break;case"NSM":if(s&&!l){for(Y=w.length,R=W+1;R<Y&&w[R]==="NSM";)R++;if(R<Y){var O=b[W],le=O>=1425&&O<=2303||O===64286;if(K=w[R],le&&(K==="R"||K==="AL")){q="R";break}}}q=W<1||(K=w[W-1])==="B"?"N":_[W-1];break;case"B":U=!1,i=!0,q=se;break;case"S":o=!0,q="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":U=!1;break;case"BN":q="N"}return q},E=function(b,w,_){var W=b.split("");return _&&C(W,_,{hiLevel:se}),W.reverse(),w&&w.reverse(),W.join("")},C=function(b,w,_){var W,K,k,R,Y,q=-1,O=b.length,le=0,N=[],D=se?f:g,V=[];for(U=!1,i=!1,o=!1,K=0;K<O;K++)V[K]=X(b[K]);for(k=0;k<O;k++){if(Y=le,N[k]=re(b,V,N,k),W=240&(le=D[Y][x[N[k]]]),le&=15,w[k]=R=D[le][5],W>0)if(W===16){for(K=q;K<k;K++)w[K]=1;q=-1}else q=-1;if(D[le][6])q===-1&&(q=k);else if(q>-1){for(K=q;K<k;K++)w[K]=R;q=-1}V[k]==="B"&&(w[k]=0),_.hiLevel|=R}o&&function(I,F,Q){for(var H=0;H<Q;H++)if(I[H]==="S"){F[H]=se;for(var J=H-1;J>=0&&I[J]==="WS";J--)F[J]=se}}(V,w,O)},T=function(b,w,_,W,K){if(!(K.hiLevel<b)){if(b===1&&se===1&&!i)return w.reverse(),void(_&&_.reverse());for(var k,R,Y,q,O=w.length,le=0;le<O;){if(W[le]>=b){for(Y=le+1;Y<O&&W[Y]>=b;)Y++;for(q=le,R=Y-1;q<R;q++,R--)k=w[q],w[q]=w[R],w[R]=k,_&&(k=_[q],_[q]=_[R],_[R]=k);le=Y}le++}}},j=function(b,w,_){var W=b.split(""),K={hiLevel:se};return _||(_=[]),C(W,_,K),function(k,R,Y){if(Y.hiLevel!==0&&h)for(var q,O=0;O<k.length;O++)R[O]===1&&(q=P.indexOf(k[O]))>=0&&(k[O]=P[q+1])}(W,_,K),T(2,W,w,_,K),T(1,W,w,_,K),W.join("")};return this.__bidiEngine__.doBidiReorder=function(b,w,_){if(function(K,k){if(k)for(var R=0;R<K.length;R++)k[R]=R;l===void 0&&(l=Z(K)),u===void 0&&(u=Z(K))}(b,w),s||!c||u)if(s&&c&&l^u)se=l?1:0,b=E(b,w,_);else if(!s&&c&&u)se=l?1:0,b=j(b,w,_),b=E(b,w);else if(!s||l||c||u){if(s&&!c&&l^u)b=E(b,w),l?(se=0,b=j(b,w,_)):(se=1,b=j(b,w,_),b=E(b,w));else if(s&&l&&!c&&u)se=1,b=j(b,w,_),b=E(b,w);else if(!s&&!c&&l^u){var W=h;l?(se=1,b=j(b,w,_),se=0,h=!1,b=j(b,w,_),h=W):(se=0,b=j(b,w,_),b=E(b,w),se=1,h=!1,b=j(b,w,_),h=W,b=E(b,w))}}else se=0,b=j(b,w,_);else se=l?1:0,b=j(b,w,_);return b},this.__bidiEngine__.setOptions=function(b){b&&(s=b.isInputVisual,c=b.isOutputVisual,l=b.isInputRtl,u=b.isOutputRtl,h=b.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var o=n.options||{};n.mutex,o.lang;var s=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,r.setOptions(o),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(s=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?s.push([r.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):s.push([r.doBidiReorder(i[l])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(dr),dr.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Na(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new f7(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new e7(this.contents),this.head=new r7(this),this.name=new a7(this),this.cmap=new e_(this),this.toUnicode={},this.hhea=new n7(this),this.maxp=new l7(this),this.hmtx=new c7(this),this.post=new o7(this),this.os2=new i7(this),this.loca=new p7(this),this.glyf=new u7(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var s,l,c,u;for(u=[],s=0,l=(c=this.bbox).length;s<l;s++)e=c[s],u.push(Math.round(e*this.scaleFactor));return u}.call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),(32768&(r=i>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,o,s,l;for(s=0,o=0,l=(e=""+e).length;0<=l?o<l:o>l;o=0<=l?++o:--o)i=e.charCodeAt(o),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var ko,Na=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,o,s,l,c;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),l=this.readByte(),c=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^o)+65536*(255^s)+256*(255^l)+(255^c)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*o+65536*s+256*l+c},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,o;for(o=[],n=0,i=e.length;n<i;n++)r=e[n],o.push(this.writeByte(r));return o},t}(),e7=function(){var t;function e(r){var n,i,o;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,o=this.tableCount;0<=o?i<o:i>o;i=0<=o?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,o,s,l,c,u,h,y,g,f,x,S;for(S in f=Object.keys(r).length,c=Math.log(2),y=16*Math.floor(Math.log(f)/c),s=Math.floor(y/c),h=16*f-y,(i=new Na).writeInt(this.scalarType),i.writeShort(f),i.writeShort(y),i.writeShort(s),i.writeShort(h),o=16*f,u=i.pos+o,l=null,x=[],r)for(g=r[S],i.writeString(S),i.writeInt(t(g)),i.writeInt(u),i.writeInt(g.length),x=x.concat(g),S==="head"&&(l=u),u+=g.length;u%4;)x.push(0),u++;return i.write(x),n=2981146554-t(i.data),i.pos=l+8,i.writeUInt32(n),i.data},t=function(r){var n,i,o,s;for(r=t_.call(r);r.length%4;)r.push(0);for(o=new Na(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=o.readUInt32();return 4294967295&i},e}(),t7={}.hasOwnProperty,rs=function(t,e){for(var r in e)t7.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};ko=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var r7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return rs(e,ko),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var n;return(n=new Na).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},e}(),ib=function(){function t(e,r){var n,i,o,s,l,c,u,h,y,g,f,x,S,P,$,U,se;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),y=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=e.readByte();break;case 4:for(f=e.readUInt16(),g=f/2,e.pos+=6,o=function(){var X,Z;for(Z=[],c=X=0;0<=g?X<g:X>g;c=0<=g?++X:--X)Z.push(e.readUInt16());return Z}(),e.pos+=2,S=function(){var X,Z;for(Z=[],c=X=0;0<=g?X<g:X>g;c=0<=g?++X:--X)Z.push(e.readUInt16());return Z}(),u=function(){var X,Z;for(Z=[],c=X=0;0<=g?X<g:X>g;c=0<=g?++X:--X)Z.push(e.readUInt16());return Z}(),h=function(){var X,Z;for(Z=[],c=X=0;0<=g?X<g:X>g;c=0<=g?++X:--X)Z.push(e.readUInt16());return Z}(),i=(this.length-e.pos+this.offset)/2,l=function(){var X,Z;for(Z=[],c=X=0;0<=i?X<i:X>i;c=0<=i?++X:--X)Z.push(e.readUInt16());return Z}(),c=$=0,se=o.length;$<se;c=++$)for(P=o[c],n=U=x=S[c];x<=P?U<=P:U>=P;n=x<=P?++U:--U)h[c]===0?s=n+u[c]:(s=l[h[c]/2+(n-x)-(g-c)]||0)!==0&&(s+=u[c]),this.codeMap[n]=65535&s}e.pos=y}return t.encode=function(e,r){var n,i,o,s,l,c,u,h,y,g,f,x,S,P,$,U,se,X,Z,re,E,C,T,j,b,w,_,W,K,k,R,Y,q,O,le,N,D,V,I,F,Q,H,J,te,ee,ne;switch(W=new Na,s=Object.keys(e).sort(function(G,ce){return G-ce}),r){case"macroman":for(S=0,P=function(){var G=[];for(x=0;x<256;++x)G.push(0);return G}(),U={0:0},o={},K=0,q=s.length;K<q;K++)U[J=e[i=s[K]]]==null&&(U[J]=++S),o[i]={old:e[i],new:U[e[i]]},P[i]=U[e[i]];return W.writeUInt16(1),W.writeUInt16(0),W.writeUInt32(12),W.writeUInt16(0),W.writeUInt16(262),W.writeUInt16(0),W.write(P),{charMap:o,subtable:W.data,maxGlyphID:S+1};case"unicode":for(w=[],y=[],se=0,U={},n={},$=u=null,k=0,O=s.length;k<O;k++)U[Z=e[i=s[k]]]==null&&(U[Z]=++se),n[i]={old:Z,new:U[Z]},l=U[Z]-i,$!=null&&l===u||($&&y.push($),w.push(i),u=l),$=i;for($&&y.push($),y.push(65535),w.push(65535),j=2*(T=w.length),C=2*Math.pow(Math.log(T)/Math.LN2,2),g=Math.log(C/2)/Math.LN2,E=2*T-C,c=[],re=[],f=[],x=R=0,le=w.length;R<le;x=++R){if(b=w[x],h=y[x],b===65535){c.push(0),re.push(0);break}if(b-(_=n[b].new)>=32768)for(c.push(0),re.push(2*(f.length+T-x)),i=Y=b;b<=h?Y<=h:Y>=h;i=b<=h?++Y:--Y)f.push(n[i].new);else c.push(_-b),re.push(0)}for(W.writeUInt16(3),W.writeUInt16(1),W.writeUInt32(12),W.writeUInt16(4),W.writeUInt16(16+8*T+2*f.length),W.writeUInt16(0),W.writeUInt16(j),W.writeUInt16(C),W.writeUInt16(g),W.writeUInt16(E),Q=0,N=y.length;Q<N;Q++)i=y[Q],W.writeUInt16(i);for(W.writeUInt16(0),H=0,D=w.length;H<D;H++)i=w[H],W.writeUInt16(i);for(te=0,V=c.length;te<V;te++)l=c[te],W.writeUInt16(l);for(ee=0,I=re.length;ee<I;ee++)X=re[ee],W.writeUInt16(X);for(ne=0,F=f.length;ne<F;ne++)S=f[ne],W.writeUInt16(S);return{charMap:n,subtable:W.data,maxGlyphID:se+1}}},t}(),e_=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return rs(e,ko),e.prototype.tag="cmap",e.prototype.parse=function(r){var n,i,o;for(r.pos=this.offset,this.version=r.readUInt16(),o=r.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=o?i<o:i>o;i=0<=o?++i:--i)n=new ib(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(r,n){var i,o;return n==null&&(n="macroman"),i=ib.encode(r,n),(o=new Na).writeUInt16(0),o.writeUInt16(1),i.table=o.data.concat(i.subtable),i},e}(),n7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return rs(e,ko),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e}(),i7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return rs(e,ko),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(r.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(r.readInt());return i}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(r.readInt());return i}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e}(),o7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return rs(e,ko),e.prototype.tag="post",e.prototype.parse=function(r){var n,i,o;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var s;for(i=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],o=[];r.pos<this.offset+this.length;)n=r.readByte(),o.push(this.names.push(r.readString(n)));return o;case 151552:return i=r.readUInt16(),this.offsets=r.read(i);case 196608:break;case 262144:return this.map=function(){var l,c,u;for(u=[],s=l=0,c=this.file.maxp.numGlyphs;0<=c?l<c:l>c;s=0<=c?++l:--l)u.push(r.readUInt32());return u}.call(this)}},e}(),s7=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},a7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return rs(e,ko),e.prototype.tag="name",e.prototype.parse=function(r){var n,i,o,s,l,c,u,h,y,g,f;for(r.pos=this.offset,r.readShort(),n=r.readShort(),c=r.readShort(),i=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)i.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+c+r.readShort()});for(u={},s=y=0,g=i.length;y<g;s=++y)o=i[s],r.pos=o.offset,h=r.readString(o.length),l=new s7(h,o),u[f=o.nameID]==null&&(u[f]=[]),u[o.nameID].push(l);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},e}(),l7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return rs(e,ko),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e}(),c7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return rs(e,ko),e.prototype.tag="hmtx",e.prototype.parse=function(r){var n,i,o,s,l,c,u;for(r.pos=this.offset,this.metrics=[],n=0,c=this.file.hhea.numberOfMetrics;0<=c?n<c:n>c;n=0<=c?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var h,y;for(y=[],n=h=0;0<=o?h<o:h>o;n=0<=o?++h:--h)y.push(r.readInt16());return y}(),this.widths=function(){var h,y,g,f;for(f=[],h=0,y=(g=this.metrics).length;h<y;h++)s=g[h],f.push(s.advance);return f}.call(this),i=this.widths[this.widths.length-1],u=[],n=l=0;0<=o?l<o:l>o;n=0<=o?++l:--l)u.push(this.widths.push(i));return u},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e}(),t_=[].slice,u7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return rs(e,ko),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var n,i,o,s,l,c,u,h,y,g;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,i=s.indexOf(r),(o=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+i,l=(c=new Na(n.read(o))).readShort(),h=c.readShort(),g=c.readShort(),u=c.readShort(),y=c.readShort(),this.cache[r]=l===-1?new h7(c,h,g,u,y):new d7(c,l,h,g,u,y),this.cache[r]))},e.prototype.encode=function(r,n,i){var o,s,l,c,u;for(l=[],s=[],c=0,u=n.length;c<u;c++)o=r[n[c]],s.push(l.length),o&&(l=l.concat(o.encode(i)));return s.push(l.length),{table:l,offsets:s}},e}(),d7=function(){function t(e,r,n,i,o,s){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=o,this.yMax=s,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),h7=function(){function t(e,r,n,i,o){var s,l;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;l=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&l;)s.pos+=1&l?4:2,128&l?s.pos+=8:64&l?s.pos+=4:8&l&&(s.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Na(t_.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),p7=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return rs(e,ko),e.prototype.tag="loca",e.prototype.parse=function(r){var n,i;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=2)s.push(2*r.readUInt16());return s}.call(this):function(){var o,s;for(s=[],i=0,o=this.length;i<o;i+=4)s.push(r.readUInt32());return s}.call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,n){for(var i=new Uint32Array(this.offsets.length),o=0,s=0,l=0;l<i.length;++l)if(i[l]=o,s<n.length&&n[s]==l){++s,i[l]=o;var c=this.offsets[l],u=this.offsets[l+1]-c;u>0&&(o+=u)}for(var h=new Array(4*i.length),y=0;y<i.length;++y)h[4*y+3]=255&i[y],h[4*y+2]=(65280&i[y])>>8,h[4*y+1]=(16711680&i[y])>>16,h[4*y]=(4278190080&i[y])>>24;return h},e}(),f7=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,o;for(r in i=this.font.cmap.tables[0].codeMap,e={},o=this.subset)n=o[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,o,s,l,c;for(i={},s=0,l=e.length;s<l;s++)i[o=e[s]]=this.font.glyf.glyphFor(o);for(o in r=[],i)(n=i[o])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(o in c=this.glyphsFor(r))n=c[o],i[o]=n;return i},t.prototype.encode=function(e,r){var n,i,o,s,l,c,u,h,y,g,f,x,S,P,$;for(i in n=e_.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),f={0:0},$=n.charMap)f[(c=$[i]).old]=c.new;for(x in g=n.maxGlyphID,s)x in f||(f[x]=g++);return h=function(U){var se,X;for(se in X={},U)X[U[se]]=se;return X}(f),y=Object.keys(h).sort(function(U,se){return U-se}),S=function(){var U,se,X;for(X=[],U=0,se=y.length;U<se;U++)l=y[U],X.push(h[l]);return X}(),o=this.font.glyf.encode(s,S,f),u=this.font.loca.encode(o.offsets,S),P={cmap:this.font.cmap.raw(),glyf:o.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(P["OS/2"]=this.font.os2.raw()),this.font.directory.encode(P)},t}();dr.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,o,s;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in o=["<<"],r)s=r[i],o.push("/"+i+" "+e.convert(s));return o.push(">>"),o.join(`
`)}return""+r},e}();const r_=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:GL,AcroFormAppearance:Qt,AcroFormButton:qn,AcroFormCheckBox:wu,AcroFormChoiceField:ml,AcroFormComboBox:gl,AcroFormEditBox:Su,AcroFormListBox:yl,AcroFormPasswordField:xu,AcroFormPushButton:Pu,AcroFormRadioButton:vl,AcroFormTextField:xa,GState:zu,ShadingPattern:fa,TilingPattern:ul,default:dr,jsPDF:dr},Symbol.toStringTag,{value:"Module"}));function n_(t,e,r,n,i){n=n||{};var o=1.15,s=i.internal.scaleFactor,l=i.internal.getFontSize()/s,c=i.getLineHeightFactor?i.getLineHeightFactor():o,u=l*c,h=/\r\n|\r|\n/g,y="",g=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(y=typeof t=="string"?t.split(h):t,g=y.length||1),r+=l*(2-o),n.valign==="middle"?r-=g/2*u:n.valign==="bottom"&&(r-=g*u),n.halign==="center"||n.halign==="right"){var f=l;if(n.halign==="center"&&(f*=.5),y&&g>=1){for(var x=0;x<y.length;x++)i.text(y[x],e-i.getStringUnitWidth(y[x])*f,r),r+=u;return i}e-=i.getStringUnitWidth(t)*f}return n.halign==="justify"?i.text(t,e,r,{maxWidth:n.maxWidth||100,align:"justify"}):i.text(t,e,r),i}var ob={},mc=function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=e:ob=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,r){var n,i,o;r===void 0&&(r=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var s=this.jsPDFDocument.internal.getFont(),l=s.fontStyle,c=s.fontName;if(e.font&&(c=e.font),e.fontStyle){l=e.fontStyle;var u=this.getFontList()[c];u&&u.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),l=u[0])}if(this.jsPDFDocument.setFont(c,l),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!r){var h=t.unifyColor(e.fillColor);h&&(n=this.jsPDFDocument).setFillColor.apply(n,h),h=t.unifyColor(e.textColor),h&&(i=this.jsPDFDocument).setTextColor.apply(i,h),h=t.unifyColor(e.lineColor),h&&(o=this.jsPDFDocument).setDrawColor.apply(o,h),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,r,n){return this.jsPDFDocument.splitTextToSize(e,r,n)},t.prototype.rect=function(e,r,n,i,o){return this.jsPDFDocument.rect(e,r,n,i,o)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return ob||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t}(),Dm=function(t,e){return Dm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Dm(t,e)};function i_(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Dm(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var o_=function(t){i_(e,t);function e(r){var n=t.call(this)||this;return n._element=r,n}return e}(Array);function m7(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function y7(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function Hh(t,e,r){r.applyStyles(e,!0);var n=Array.isArray(t)?t:[t],i=n.map(function(o){return r.getTextWidth(o)}).reduce(function(o,s){return Math.max(o,s)},0);return i}function s_(t,e,r,n){var i=e.settings.tableLineWidth,o=e.settings.tableLineColor;t.applyStyles({lineWidth:i,lineColor:o});var s=a_(i,!1);s&&t.rect(r.x,r.y,e.getWidth(t.pageSize().width),n.y-r.y,s)}function a_(t,e){var r=t>0,n=e||e===0;return r&&n?"DF":r?"S":n?"F":null}function bp(t,e){var r,n,i,o;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(r=t.left)!==null&&r!==void 0?r:e,top:(n=t.top)!==null&&n!==void 0?n:e,right:(i=t.right)!==null&&i!==void 0?i:e,bottom:(o=t.bottom)!==null&&o!==void 0?o:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function l_(t,e){var r=bp(e.settings.margin,0);return t.pageSize().width-(r.left+r.right)}function g7(t,e,r,n,i){var o={},s=1.3333333333333333,l=Tf(e,function(se){return i.getComputedStyle(se).backgroundColor});l!=null&&(o.fillColor=l);var c=Tf(e,function(se){return i.getComputedStyle(se).color});c!=null&&(o.textColor=c);var u=b7(n,r);u&&(o.cellPadding=u);var h="borderTopColor",y=s*r,g=n.borderTopWidth;if(n.borderBottomWidth===g&&n.borderRightWidth===g&&n.borderLeftWidth===g){var f=(parseFloat(g)||0)/y;f&&(o.lineWidth=f)}else o.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/y,right:(parseFloat(n.borderRightWidth)||0)/y,bottom:(parseFloat(n.borderBottomWidth)||0)/y,left:(parseFloat(n.borderLeftWidth)||0)/y},o.lineWidth.top||(o.lineWidth.right?h="borderRightColor":o.lineWidth.bottom?h="borderBottomColor":o.lineWidth.left&&(h="borderLeftColor"));var x=Tf(e,function(se){return i.getComputedStyle(se)[h]});x!=null&&(o.lineColor=x);var S=["left","right","center","justify"];S.indexOf(n.textAlign)!==-1&&(o.halign=n.textAlign),S=["middle","bottom","top"],S.indexOf(n.verticalAlign)!==-1&&(o.valign=n.verticalAlign);var P=parseInt(n.fontSize||"");isNaN(P)||(o.fontSize=P/s);var $=v7(n);$&&(o.fontStyle=$);var U=(n.fontFamily||"").toLowerCase();return t.indexOf(U)!==-1&&(o.font=U),o}function v7(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function Tf(t,e){var r=c_(t,e);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var i=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],o=parseInt(n[4]);return o===0||isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function c_(t,e){var r=e(t);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?t.parentElement==null?null:c_(t.parentElement,e):r}function b7(t,e){var r=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],n=96/(72/e),i=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,o=r.map(function(l){return parseInt(l||"0")/n}),s=bp(o,0);return i>s.top&&(s.top=i),i>s.bottom&&(s.bottom=i),s}function u_(t,e,r,n,i){var o,s;n===void 0&&(n=!1),i===void 0&&(i=!1);var l;typeof e=="string"?l=r.document.querySelector(e):l=e;var c=Object.keys(t.getFontList()),u=t.scaleFactor(),h=[],y=[],g=[];if(!l)return console.error("Html table could not be found with input: ",e),{head:h,body:y,foot:g};for(var f=0;f<l.rows.length;f++){var x=l.rows[f],S=(s=(o=x?.parentElement)===null||o===void 0?void 0:o.tagName)===null||s===void 0?void 0:s.toLowerCase(),P=_7(c,u,r,x,n,i);P&&(S==="thead"?h.push(P):S==="tfoot"?g.push(P):y.push(P))}return{head:h,body:y,foot:g}}function _7(t,e,r,n,i,o){for(var s=new o_(n),l=0;l<n.cells.length;l++){var c=n.cells[l],u=r.getComputedStyle(c);if(i||u.display!=="none"){var h=void 0;o&&(h=g7(t,c,e,u,r)),s.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:h,_element:c,content:S7(c)})}}var y=r.getComputedStyle(n);if(s.length>0&&(i||y.display!=="none"))return s}function S7(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),e.innerText||e.textContent||""}function P7(t,e,r){for(var n=0,i=[t,e,r];n<i.length;n++){var o=i[n];o&&typeof o!="object"&&console.error("The options parameter should be of type object, is: "+typeof o),o.startY&&typeof o.startY!="number"&&(console.error("Invalid value for startY option",o.startY),delete o.startY)}}function Ps(t,e,r,n,i){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),s=1;s<arguments.length;s++){var l=arguments[s];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(o[c]=l[c])}return o}function d_(t,e){var r=new mc(t),n=r.getDocumentOptions(),i=r.getGlobalOptions();P7(i,n,e);var o=Ps({},i,n,e),s;typeof window<"u"&&(s=window);var l=w7(i,n,e),c=x7(i,n,e),u=A7(r,o),h=I7(r,o,s);return{id:e.tableId,content:h,hooks:c,styles:l,settings:u}}function w7(t,e,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},i=function(c){if(c==="columnStyles"){var u=t[c],h=e[c],y=r[c];n.columnStyles=Ps({},u,h,y)}else{var g=[t,e,r],f=g.map(function(x){return x[c]||{}});n[c]=Ps({},f[0],f[1],f[2])}},o=0,s=Object.keys(n);o<s.length;o++){var l=s[o];i(l)}return n}function x7(t,e,r){for(var n=[t,e,r],i={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},o=0,s=n;o<s.length;o++){var l=s[o];l.didParseCell&&i.didParseCell.push(l.didParseCell),l.willDrawCell&&i.willDrawCell.push(l.willDrawCell),l.didDrawCell&&i.didDrawCell.push(l.didDrawCell),l.willDrawPage&&i.willDrawPage.push(l.willDrawPage),l.didDrawPage&&i.didDrawPage.push(l.didDrawPage)}return i}function A7(t,e){var r,n,i,o,s,l,c,u,h,y,g,f,x=bp(e.margin,40/t.scaleFactor()),S=(r=C7(t,e.startY))!==null&&r!==void 0?r:x.top,P;e.showFoot===!0?P="everyPage":e.showFoot===!1?P="never":P=(n=e.showFoot)!==null&&n!==void 0?n:"everyPage";var $;e.showHead===!0?$="everyPage":e.showHead===!1?$="never":$=(i=e.showHead)!==null&&i!==void 0?i:"everyPage";var U=(o=e.useCss)!==null&&o!==void 0?o:!1,se=e.theme||(U?"plain":"striped"),X=!!e.horizontalPageBreak,Z=(s=e.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(l=e.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:U,theme:se,startY:S,margin:x,pageBreak:(c=e.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(u=e.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(h=e.tableWidth)!==null&&h!==void 0?h:"auto",showHead:$,showFoot:P,tableLineWidth:(y=e.tableLineWidth)!==null&&y!==void 0?y:0,tableLineColor:(g=e.tableLineColor)!==null&&g!==void 0?g:200,horizontalPageBreak:X,horizontalPageBreakRepeat:Z,horizontalPageBreakBehaviour:(f=e.horizontalPageBreakBehaviour)!==null&&f!==void 0?f:"afterAllRows"}}function C7(t,e){var r=t.getLastAutoTable(),n=t.scaleFactor(),i=t.pageNumber(),o=!1;if(r&&r.startPageNumber){var s=r.startPageNumber+r.pageNumber-1;o=s===i}return typeof e=="number"?e:(e==null||e===!1)&&o&&r?.finalY!=null?r.finalY+20/n:null}function I7(t,e,r){var n=e.head||[],i=e.body||[],o=e.foot||[];if(e.html){var s=e.includeHiddenHtml;if(r){var l=u_(t,e.html,r,s,e.useCss)||{};n=l.head||n,i=l.body||n,o=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=e.columns||$7(n,i,o);return{columns:c,head:n,body:i,foot:o}}function $7(t,e,r){var n=t[0]||e[0]||r[0]||[],i=[];return Object.keys(n).filter(function(o){return o!=="_element"}).forEach(function(o){var s=1,l;Array.isArray(n)?l=n[parseInt(o)]:l=n[o],typeof l=="object"&&!Array.isArray(l)&&(s=l?.colSpan||1);for(var c=0;c<s;c++){var u=void 0;Array.isArray(n)?u=i.length:u=o+(c>0?"_".concat(c):"");var h={dataKey:u};i.push(h)}}),i}var Mm=function(){function t(e,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=e.getDocument()}return t}(),E7=function(t){i_(e,t);function e(r,n,i,o,s,l){var c=t.call(this,r,n,l)||this;return c.cell=i,c.row=o,c.column=s,c.section=o.section,c}return e}(Mm),T7=function(){function t(e,r){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,r,n,i,o,s){for(var l=0,c=r;l<c.length;l++){var u=c[l],h=new E7(e,this,n,i,o,s),y=u(h)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],y)return!1}return!0},t.prototype.callEndPageHooks=function(e,r){e.applyStyles(e.userStyles);for(var n=0,i=this.hooks.didDrawPage;n<i.length;n++){var o=i[n];o(new Mm(e,this,r))}},t.prototype.callWillDrawPageHooks=function(e,r){for(var n=0,i=this.hooks.willDrawPage;n<i.length;n++){var o=i[n];o(new Mm(e,this,r))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(i,o){return i+o.wrappedWidth},0);return r}else{var n=this.settings.margin;return e-n.left-n.right}},t}(),h_=function(){function t(e,r,n,i,o){o===void 0&&(o=!1),this.height=0,this.raw=e,e instanceof o_&&(this.raw=e._element,this.element=e._element),this.index=r,this.section=n,this.cells=i,this.spansMultiplePages=o}return t.prototype.getMaxCellHeight=function(e){var r=this;return e.reduce(function(n,i){var o;return Math.max(n,((o=r.cells[i.index])===null||o===void 0?void 0:o.height)||0)},0)},t.prototype.hasRowSpan=function(e){var r=this;return e.filter(function(n){var i=r.cells[n.index];return i?i.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,r){return this.getMaxCellHeight(r)<=e},t.prototype.getMinimumRowHeight=function(e,r){var n=this;return e.reduce(function(i,o){var s=n.cells[o.index];if(!s)return 0;var l=r.getLineHeight(s.styles.fontSize),c=s.padding("vertical"),u=c+l;return u>i?u:i},0)},t}(),p_=function(){function t(e,r,n){var i;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=e;var o=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,o=(i=e.content)!==null&&i!==void 0?i:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var s=o!=null?""+o:"",l=/\r\n|\r|\n/g;this.text=s.split(l)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");e=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var i=this.width-this.padding("horizontal");n=this.x+i/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},t.prototype.getContentHeight=function(e,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,i=this.styles.fontSize/e*r,o=n*i+this.padding("vertical");return Math.max(o,this.styles.minCellHeight)},t.prototype.padding=function(e){var r=bp(this.styles.cellPadding,0);return e==="vertical"?r.top+r.bottom:e==="horizontal"?r.left+r.right:r[e]},t}(),k7=function(){function t(e,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=r,this.index=n}return t.prototype.getMaxCustomCellWidth=function(e){for(var r=0,n=0,i=e.allRows();n<i.length;n++){var o=i[n],s=o.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(r=Math.max(r,s.styles.cellWidth))}return r},t}();function N7(t,e){L7(t,e);var r=[],n=0;e.columns.forEach(function(o){var s=o.getMaxCustomCellWidth(e);s?o.width=s:(o.width=o.wrappedWidth,r.push(o)),n+=o.width});var i=e.getWidth(t.pageSize().width)-n;i&&(i=Fm(r,i,function(o){return Math.max(o.minReadableWidth,o.minWidth)})),i&&(i=Fm(r,i,function(o){return o.minWidth})),i=Math.abs(i),!e.settings.horizontalPageBreak&&i>.1/t.scaleFactor()&&(i=i<1?i:Math.round(i),console.warn("Of the table content, ".concat(i," units width could not fit page"))),D7(e),M7(e,t),R7(e)}function L7(t,e){var r=t.scaleFactor(),n=e.settings.horizontalPageBreak,i=l_(t,e);e.allRows().forEach(function(o){for(var s=0,l=e.columns;s<l.length;s++){var c=l[s],u=o.cells[c.index];if(u){var h=e.hooks.didParseCell;e.callCellHooks(t,h,u,o,c,null);var y=u.padding("horizontal");u.contentWidth=Hh(u.text,u.styles,t)+y;var g=Hh(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,t);if(u.minReadableWidth=g+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>i?(u.minWidth=i,u.wrappedWidth=i):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var f=10/r;u.minWidth=u.styles.minCellWidth||f,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),e.allRows().forEach(function(o){for(var s=0,l=e.columns;s<l.length;s++){var c=l[s],u=o.cells[c.index];if(u&&u.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,u.wrappedWidth),c.minWidth=Math.max(c.minWidth,u.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,u.minReadableWidth);else{var h=e.styles.columnStyles[c.dataKey]||e.styles.columnStyles[c.index]||{},y=h.cellWidth||h.minCellWidth;y&&typeof y=="number"&&(c.minWidth=y,c.wrappedWidth=y)}u&&(u.colSpan>1&&!c.minWidth&&(c.minWidth=u.minWidth),u.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=u.minWidth))}})}function Fm(t,e,r){for(var n=e,i=t.reduce(function(f,x){return f+x.wrappedWidth},0),o=0;o<t.length;o++){var s=t[o],l=s.wrappedWidth/i,c=n*l,u=s.width+c,h=r(s),y=u<h?h:u;e-=y-s.width,s.width=y}if(e=Math.round(e*1e10)/1e10,e){var g=t.filter(function(f){return e<0?f.width>r(f):!0});g.length&&(e=Fm(g,e,r))}return e}function R7(t){for(var e={},r=1,n=t.allRows(),i=0;i<n.length;i++)for(var o=n[i],s=0,l=t.columns;s<l.length;s++){var c=l[s],u=e[c.index];if(r>1)r--,delete o.cells[c.index];else if(u)u.cell.height+=o.height,r=u.cell.colSpan,delete o.cells[c.index],u.left--,u.left<=1&&delete e[c.index];else{var h=o.cells[c.index];if(!h)continue;if(h.height=o.height,h.rowSpan>1){var y=n.length-i,g=h.rowSpan>y?y:h.rowSpan;e[c.index]={cell:h,left:g,row:o}}}}}function D7(t){for(var e=t.allRows(),r=0;r<e.length;r++)for(var n=e[r],i=null,o=0,s=0,l=0;l<t.columns.length;l++){var c=t.columns[l];if(s-=1,s>1&&t.columns[l+1])o+=c.width,delete n.cells[c.index];else if(i){var u=i;delete n.cells[c.index],i=null,u.width=c.width+o}else{var u=n.cells[c.index];if(!u)continue;if(s=u.colSpan,o=0,u.colSpan>1){i=u,o+=c.width;continue}u.width=c.width+o}}}function M7(t,e){for(var r={count:0,height:0},n=0,i=t.allRows();n<i.length;n++){for(var o=i[n],s=0,l=t.columns;s<l.length;s++){var c=l[s],u=o.cells[c.index];if(u){e.applyStyles(u.styles,!0);var h=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=e.splitTextToSize(u.text,h+1/e.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=sb(u.text,h,u.styles,e,"...");else if(u.styles.overflow==="hidden")u.text=sb(u.text,h,u.styles,e,"");else if(typeof u.styles.overflow=="function"){var y=u.styles.overflow(u.text,h);typeof y=="string"?u.text=[y]:u.text=y}u.contentHeight=u.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var g=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<g*u.rowSpan?r={height:g,count:u.rowSpan}:r&&r.count>0&&r.height>g&&(g=r.height),g>o.height&&(o.height=g)}}r.count--}}function sb(t,e,r,n,i){return t.map(function(o){return F7(o,e,r,n,i)})}function F7(t,e,r,n,i){var o=1e4*n.scaleFactor();if(e=Math.ceil(e*o)/o,e>=Hh(t,r,n))return t;for(;e<Hh(t+i,r,n)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+i}function f_(t,e){var r=new mc(t),n=O7(e,r.scaleFactor()),i=new T7(e,n);return N7(r,i),r.applyStyles(r.userStyles),i}function O7(t,e){var r=t.content,n=j7(r.columns);if(r.head.length===0){var i=ab(n,"head");i&&r.head.push(i)}if(r.foot.length===0){var i=ab(n,"foot");i&&r.foot.push(i)}var o=t.settings.theme,s=t.styles;return{columns:n,head:kf("head",r.head,n,s,o,e),body:kf("body",r.body,n,s,o,e),foot:kf("foot",r.foot,n,s,o,e)}}function kf(t,e,r,n,i,o){var s={},l=e.map(function(c,u){for(var h=0,y={},g=0,f=0,x=0,S=r;x<S.length;x++){var P=S[x];if(s[P.index]==null||s[P.index].left===0)if(f===0){var $=void 0;Array.isArray(c)?$=c[P.index-g-h]:$=c[P.dataKey];var U={};typeof $=="object"&&!Array.isArray($)&&(U=$?.styles||{});var se=V7(t,P,u,i,n,o,U),X=new p_($,se,t);y[P.dataKey]=X,y[P.index]=X,f=X.colSpan-1,s[P.index]={left:X.rowSpan-1,times:f}}else f--,g++;else s[P.index].left--,f=s[P.index].times,h++}return new h_(c,u,t,y)});return l}function ab(t,e){var r={};return t.forEach(function(n){if(n.raw!=null){var i=B7(e,n.raw);i!=null&&(r[n.dataKey]=i)}}),Object.keys(r).length>0?r:null}function B7(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function j7(t){return t.map(function(e,r){var n,i;return typeof e=="object"?i=(n=e.dataKey)!==null&&n!==void 0?n:r:i=r,new k7(i,e,r)})}function V7(t,e,r,n,i,o,s){var l=y7(n),c;t==="head"?c=i.headStyles:t==="body"?c=i.bodyStyles:t==="foot"&&(c=i.footStyles);var u=Ps({},l.table,l[t],i.styles,c),h=i.columnStyles[e.dataKey]||i.columnStyles[e.index]||{},y=t==="body"?h:{},g=t==="body"&&r%2===0?Ps({},l.alternateRow,i.alternateRowStyles):{},f=m7(o),x=Ps({},f,u,g,y);return Ps(x,s)}function q7(t,e,r){var n;r===void 0&&(r={});var i=l_(t,e),o=new Map,s=[],l=[],c=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?c=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(c=[e.settings.horizontalPageBreakRepeat]),c.forEach(function(g){var f=e.columns.find(function(x){return x.dataKey===g||x.index===g});f&&!o.has(f.index)&&(o.set(f.index,!0),s.push(f.index),l.push(e.columns[f.index]),i-=f.wrappedWidth)});for(var u=!0,h=(n=r?.start)!==null&&n!==void 0?n:0;h<e.columns.length;){if(o.has(h)){h++;continue}var y=e.columns[h].wrappedWidth;if(u||i>=y)u=!1,s.push(h),l.push(e.columns[h]),i-=y;else break;h++}return{colIndexes:s,columns:l,lastIndex:h-1}}function z7(t,e){for(var r=[],n=0;n<e.columns.length;n++){var i=q7(t,e,{start:n});i.columns.length&&(r.push(i),n=i.lastIndex)}return r}function m_(t,e){var r=e.settings,n=r.startY,i=r.margin,o={x:i.left,y:n},s=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),l=n+i.bottom+s;if(r.pageBreak==="avoid"){var c=e.body,u=c.reduce(function(g,f){return g+f.height},0);l+=u}var h=new mc(t);(r.pageBreak==="always"||r.startY!=null&&l>h.pageSize().height)&&(g_(h),o.y=i.top),e.callWillDrawPageHooks(h,o);var y=Ps({},o);e.startPageNumber=h.pageNumber(),r.horizontalPageBreak?U7(h,e,y,o):(h.applyStyles(h.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(g){return Ts(h,e,g,o,e.columns)}),h.applyStyles(h.userStyles),e.body.forEach(function(g,f){var x=f===e.body.length-1;Gh(h,e,g,x,y,o,e.columns)}),h.applyStyles(h.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(g){return Ts(h,e,g,o,e.columns)})),s_(h,e,y,o),e.callEndPageHooks(h,o),e.finalY=o.y,t.lastAutoTable=e,h.applyStyles(h.userStyles)}function U7(t,e,r,n){var i=z7(t,e),o=e.settings;if(o.horizontalPageBreakBehaviour==="afterAllRows")i.forEach(function(u,h){t.applyStyles(t.userStyles),h>0?Au(t,e,r,n,u.columns,!0):lb(t,e,n,u.columns),H7(t,e,r,n,u.columns),Nf(t,e,n,u.columns)});else for(var s=-1,l=i[0],c=function(){var u=s;if(l){t.applyStyles(t.userStyles);var h=l.columns;s>=0?Au(t,e,r,n,h,!0):lb(t,e,n,h),u=cb(t,e,s+1,n,h),Nf(t,e,n,h)}var y=u-s;i.slice(1).forEach(function(g){t.applyStyles(t.userStyles),Au(t,e,r,n,g.columns,!0),cb(t,e,s+1,n,g.columns,y),Nf(t,e,n,g.columns)}),s=u};s<e.body.length-1;)c()}function lb(t,e,r,n){var i=e.settings;t.applyStyles(t.userStyles),(i.showHead==="firstPage"||i.showHead==="everyPage")&&e.head.forEach(function(o){return Ts(t,e,o,r,n)})}function H7(t,e,r,n,i){t.applyStyles(t.userStyles),e.body.forEach(function(o,s){var l=s===e.body.length-1;Gh(t,e,o,l,r,n,i)})}function cb(t,e,r,n,i,o){t.applyStyles(t.userStyles),o=o??e.body.length;var s=Math.min(r+o,e.body.length),l=-1;return e.body.slice(r,s).forEach(function(c,u){var h=r+u===e.body.length-1,y=y_(t,e,h,n);c.canEntireRowFit(y,i)&&(Ts(t,e,c,n,i),l=r+u)}),l}function Nf(t,e,r,n){var i=e.settings;t.applyStyles(t.userStyles),(i.showFoot==="lastPage"||i.showFoot==="everyPage")&&e.foot.forEach(function(o){return Ts(t,e,o,r,n)})}function G7(t,e,r){var n=r.getLineHeight(t.styles.fontSize),i=t.padding("vertical"),o=Math.floor((e-i)/n);return Math.max(0,o)}function W7(t,e,r,n){var i={};t.spansMultiplePages=!0,t.height=0;for(var o=0,s=0,l=r.columns;s<l.length;s++){var c=l[s],u=t.cells[c.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var h=new p_(u.raw,u.styles,u.section);h=Ps(h,u),h.text=[];var y=G7(u,e,n);u.text.length>y&&(h.text=u.text.splice(y,u.text.length));var g=n.scaleFactor(),f=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(g,f),u.contentHeight>=e&&(u.contentHeight=e,h.styles.minCellHeight-=e),u.contentHeight>t.height&&(t.height=u.contentHeight),h.contentHeight=h.getContentHeight(g,f),h.contentHeight>o&&(o=h.contentHeight),i[c.index]=h}}var x=new h_(t.raw,-1,t.section,i,!0);x.height=o;for(var S=0,P=r.columns;S<P.length;S++){var c=P[S],h=x.cells[c.index];h&&(h.height=x.height);var u=t.cells[c.index];u&&(u.height=t.height)}return x}function Y7(t,e,r,n){var i=t.pageSize().height,o=n.settings.margin,s=o.top+o.bottom,l=i-s;e.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=e.getMinimumRowHeight(n.columns,t),u=c<r;if(c>l)return console.error("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var h=e.hasRowSpan(n.columns),y=e.getMaxCellHeight(n.columns)>l;return y?(h&&console.error("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(h||n.settings.rowPageBreak==="avoid")}function Gh(t,e,r,n,i,o,s){var l=y_(t,e,n,o);if(r.canEntireRowFit(l,s))Ts(t,e,r,o,s);else if(Y7(t,r,l,e)){var c=W7(r,l,e,t);Ts(t,e,r,o,s),Au(t,e,i,o,s),Gh(t,e,c,n,i,o,s)}else Au(t,e,i,o,s),Gh(t,e,r,n,i,o,s)}function Ts(t,e,r,n,i){n.x=e.settings.margin.left;for(var o=0,s=i;o<s.length;o++){var l=s[o],c=r.cells[l.index];if(!c){n.x+=l.width;continue}t.applyStyles(c.styles),c.x=n.x,c.y=n.y;var u=e.callCellHooks(t,e.hooks.willDrawCell,c,r,l,n);if(u===!1){n.x+=l.width;continue}K7(t,c,n);var h=c.getTextPos();n_(c.text,h.x,h.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function K7(t,e,r){var n=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof n.lineWidth=="number"){var i=a_(n.lineWidth,n.fillColor);i&&t.rect(e.x,r.y,e.width,e.height,i)}else typeof n.lineWidth=="object"&&(n.fillColor&&t.rect(e.x,r.y,e.width,e.height,"F"),J7(t,e,r,n.lineWidth))}function J7(t,e,r,n){var i,o,s,l;n.top&&(i=r.x,o=r.y,s=r.x+e.width,l=r.y,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),c(n.top,i,o,s,l)),n.bottom&&(i=r.x,o=r.y+e.height,s=r.x+e.width,l=r.y+e.height,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),c(n.bottom,i,o,s,l)),n.left&&(i=r.x,o=r.y,s=r.x,l=r.y+e.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,i,o,s,l)),n.right&&(i=r.x+e.width,o=r.y,s=r.x+e.width,l=r.y+e.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,i,o,s,l));function c(u,h,y,g,f){t.getDocument().setLineWidth(u),t.getDocument().line(h,y,g,f,"S")}}function y_(t,e,r,n){var i=e.settings.margin.bottom,o=e.settings.showFoot;return(o==="everyPage"||o==="lastPage"&&r)&&(i+=e.getFootHeight(e.columns)),t.pageSize().height-n.y-i}function Au(t,e,r,n,i,o){i===void 0&&(i=[]),o===void 0&&(o=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!o&&e.foot.forEach(function(l){return Ts(t,e,l,n,i)}),e.callEndPageHooks(t,n);var s=e.settings.margin;s_(t,e,r,n),g_(t),e.pageNumber++,n.x=s.left,n.y=s.top,r.y=s.top,e.callWillDrawPageHooks(t,n),e.settings.showHead==="everyPage"&&(e.head.forEach(function(l){return Ts(t,e,l,n,i)}),t.applyStyles(t.userStyles))}function g_(t){var e=t.pageNumber();t.setPage(e+1);var r=t.pageNumber();return r===e?(t.addPage(),!0):!1}function Q7(t){t.API.autoTable=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e[0],i=d_(this,n),o=f_(this,i);return m_(this,o),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,r,n,i){n_(e,r,n,i,this)},t.API.autoTableSetDefaults=function(e){return mc.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,r){mc.setDefaults(e,r)},t.API.autoTableHtmlToJson=function(e,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var i=new mc(this),o=u_(i,e,window,r,!1),s=o.head,l=o.body,c=((n=s[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:c,rows:l,data:l}}}var Lf;function D8(t,e){var r=d_(t,e),n=f_(t,r);m_(t,n)}try{if(typeof window<"u"&&window){var ub=window,db=ub.jsPDF||((Lf=ub.jspdf)===null||Lf===void 0?void 0:Lf.jsPDF);db&&Q7(db)}}catch(t){console.error("Could not apply autoTable plugin",t)}var X7=he("<div><div><label></label><select><option value=all></option></select></div><div><label></label><select><option value=all></option></select></div><div><label></label><select><option value></option></select></div><div><label></label><select><option value></option></select></div><div><label></label></div><div><label>"),Z7=he("<div><div><div></div></div><div><div> <!> <!> <!> </div><div>"),eR=he("<div><div>"),Qd=he("<option>"),tR=he("<div><div><div><div></div><div></div></div><div><div><div></div><div></div></div><div><div></div><div></div></div></div><div><div></div><div></div></div></div><div><div><span>: </span><span></span></div><div><span>: </span><span></span></div><div><span>: </span><span></span></div><div><span>: </span><span> kg</span></div><div><span>: </span><span></span></div><div><span>: </span><span>");const rR=t=>{const{t:e}=sr(),[r,n]=Ce(""),[i,o]=Ce("all"),[s,l]=Ce({start:"",end:""}),[c,u]=Ce(""),[h,y]=Ce(""),[g,f]=Ce(!1),[x,S]=Ce("all"),P=Dt(()=>{let b=t.hbls;var w="";if(r()&&(w+=r().toLowerCase()),r()){const _=r().toLowerCase();b=b.filter(W=>W.hbl.toLowerCase().includes(_)||W.idairguide.toLowerCase().includes(_)||W.nameshipper.toLowerCase().includes(_)||W.consigneeName.toLowerCase().includes(_)||W.namegood.toLowerCase().includes(_)||W.bagnumber.toLowerCase().includes(_)||W.cidentity.toLowerCase().includes(_))}return i()!=="all"&&(b=b.filter(_=>_.idguidestate===i())),x()!=="all"&&(b=b.filter(_=>_.idclasification===x())),(s().start||s().end)&&(b=b.filter(_=>{const W=new Date(_.datereserve),K=s().start?new Date(s().start):new Date("1900-01-01"),k=s().end?new Date(s().end):new Date("2100-12-31");return W>=K&&W<=k})),c()&&(b=b?.filter(_=>_.nameshipper.toLowerCase().includes(c().toLowerCase()))),h()&&(b=b?.filter(_=>_.consigneeName.toLowerCase().includes(h().toLowerCase()))),b=b?.sort((_,W)=>new Date(W.datereserve).getTime()-new Date(_.datereserve).getTime()),t.onFilterChange?.(b),b}),$=Dt(()=>{const b=new Set(t.hbls.map(w=>w.nameshipper));return Array.from(b).sort()}),U=Dt(()=>{const b=new Set(t.hbls.map(w=>w.consigneeName));return Array.from(b).sort()}),se=Dt(()=>{const b=new Set(t.hbls.map(w=>w.idguidestate));return Array.from(b).sort()}),X=Dt(()=>{const b=new Set(t.hbls.map(w=>w.idclasification));return Array.from(b).sort()}),Z=()=>{n(""),o("all"),l({start:"",end:""}),u(""),y(""),S("all")},re=()=>{const b=["HBL Number","Air Guide","Status","Classification","Shipper","Consignee","Identity","Phone","City","Commodity","Weight (kg)","Quantity","Bag Number","Reserve Date"],w=P().map(R=>[R.hbl,R.idairguide,R.idguidestate,R.idclasification,R.nameshipper,R.consigneeName,R.cidentity,R.phoneshipper,R.address.city,R.namegood,R.weight,R.quantity,R.bagnumber,new Date(R.datereserve).toLocaleDateString()]),_=[b.join(","),...w.map(R=>R.map(Y=>`"${Y}"`).join(","))].join(`
`),W=new Blob([_],{type:"text/csv"}),K=URL.createObjectURL(W),k=document.createElement("a");k.href=K,k.download=`HBL_List_${new Date().toISOString().split("T")[0]}.csv`,k.click(),URL.revokeObjectURL(K)},E=()=>{const b=["HBL Number","Air Guide","Air Number","Status","Classification","Shipper","Consignee","Identity","Shipper Phone","Consignee Phone","Street","City","State","Commodity","Weight (kg)","Quantity","Bag Number","Agency","Guide","Reserve Date"];P().map(R=>[R.hbl,R.idairguide,R.idairnumber,R.idguidestate,R.idclasification,R.nameshipper,R.consigneeName,R.cidentity,R.phoneshipper,R.ctelephone,R.street,R.address.city,R.address.estate,R.namegood,R.weight,R.quantity,R.bagnumber,R.agency,R.guia,new Date(R.datereserve).toLocaleDateString()]);const w=P().map(R=>[R.hbl,R.idclasification,R.idairguide,R.idairnumber,R.idguidestate,R.nameshipper,R.consigneeName,R.cidentity,R.phoneshipper,R.ctelephone,R.street,R.address.city,R.address.estate,R.namegood,R.weight,R.quantity,R.bagnumber,R.agency,R.guia,new Date(R.datereserve).toLocaleDateString()]),_=[b.join("	"),...w.map(R=>R.join("	"))].join(`
`),W=new Blob([_],{type:"application/vnd.ms-excel"}),K=URL.createObjectURL(W),k=document.createElement("a");k.href=K,k.download=`HBL_List_${new Date().toISOString().split("T")[0]}.xls`,k.click(),URL.revokeObjectURL(K)},C=()=>{const b=new dr;b.setFontSize(16),b.text("House Bill of Lading List",14,15),b.setFontSize(10),b.text(`Generated: ${new Date().toLocaleString()}`,14,25),b.setFontSize(10);let w=35;r()&&(b.text(`Search: ${r()}`,14,w),w+=5),i()!=="all"&&(b.text(`Status: ${i()}`,14,w),w+=5);const _=["HBL#","Status","Shipper","Consignee","City","Weight","Commodity"],W=P().map(K=>[K.hbl,K.idguidestate,K.nameshipper.substring(0,20)+(K.nameshipper.length>20?"...":""),K.consigneeName.substring(0,20)+(K.consigneeName.length>20?"...":""),K.address.city,K.weight+" kg",K.namegood.substring(0,15)+(K.namegood.length>15?"...":"")]);b.autoTable({head:[_],body:W,startY:w+5,styles:{fontSize:8},headStyles:{fillColor:[0,123,255]}}),b.save(`HBL_List_${new Date().toISOString().split("T")[0]}.pdf`)},T=b=>b?new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",j=b=>({"EN BODEGA":"#17a2b8",ENVIADO:"#007bff",ENTREGADO:"#28a745",CANCELADO:"#dc3545",PENDIENTE:"#ffc107"})[b]||"#6c757d";return(()=>{var b=eR(),w=b.firstChild;return a(b,M(Ft,{get children(){var _=Z7(),W=_.firstChild,K=W.firstChild,k=W.nextSibling,R=k.firstChild,Y=R.firstChild,q=Y.nextSibling,O=q.nextSibling,le=O.nextSibling,N=le.nextSibling,D=N.nextSibling;D.nextSibling;var V=R.nextSibling;return _.style.setProperty("padding","1rem"),W.style.setProperty("display","grid"),W.style.setProperty("grid-template-columns","1fr auto"),W.style.setProperty("gap","1rem"),W.style.setProperty("margin-bottom","1rem"),a(W,M(Ar,{type:"text",get placeholder(){return e("hbl.searchPlaceholder","Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...")},get value(){return r()},onInput:I=>n(I.currentTarget.value)}),K),K.style.setProperty("display","flex"),K.style.setProperty("gap","0.5rem"),a(K,M(dt,{variant:"outline",size:"sm",onClick:()=>f(!g()),get children(){return Ee(()=>!!g())()?e("common.hideFilters","Hide Filters"):e("common.showFilters","Show Filters")}}),null),a(K,M(dt,{variant:"outline",size:"sm",onClick:Z,get children(){return e("common.clearFilters","Clear Filters")}}),null),a(_,M(Ge,{get when(){return g()},get children(){var I=X7(),F=I.firstChild,Q=F.firstChild,H=Q.nextSibling,J=H.firstChild,te=F.nextSibling,ee=te.firstChild,ne=ee.nextSibling,G=ne.firstChild,ce=te.nextSibling,oe=ce.firstChild,z=oe.nextSibling,de=z.firstChild,fe=ce.nextSibling,ue=fe.firstChild,ge=ue.nextSibling,xe=ge.firstChild,pe=fe.nextSibling,_e=pe.firstChild,Le=pe.nextSibling,De=Le.firstChild;return I.style.setProperty("display","grid"),I.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),I.style.setProperty("gap","1rem"),I.style.setProperty("margin-bottom","1rem"),I.style.setProperty("padding","1rem"),I.style.setProperty("background","var(--background-color)"),I.style.setProperty("border-radius","var(--border-radius-sm)"),Q.style.setProperty("display","block"),Q.style.setProperty("margin-bottom","0.25rem"),Q.style.setProperty("font-size","0.875rem"),Q.style.setProperty("color","var(--text-muted)"),a(Q,()=>e("common.status","Status")),H.addEventListener("change",Te=>o(Te.currentTarget.value)),H.style.setProperty("width","100%"),H.style.setProperty("padding","0.5rem"),H.style.setProperty("border","1px solid var(--border-color)"),H.style.setProperty("border-radius","var(--border-radius-sm)"),H.style.setProperty("background","var(--surface-color)"),a(J,()=>e("common.all","All")),a(H,M(Ht,{get each(){return se()},children:Te=>(()=>{var $e=Qd();return $e.value=Te,a($e,Te),$e})()}),null),ee.style.setProperty("display","block"),ee.style.setProperty("margin-bottom","0.25rem"),ee.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),a(ee,()=>e("hbl.classification","Classification")),ne.addEventListener("change",Te=>S(Te.currentTarget.value)),ne.style.setProperty("width","100%"),ne.style.setProperty("padding","0.5rem"),ne.style.setProperty("border","1px solid var(--border-color)"),ne.style.setProperty("border-radius","var(--border-radius-sm)"),ne.style.setProperty("background","var(--surface-color)"),a(G,()=>e("common.all","All")),a(ne,M(Ht,{get each(){return X()},children:Te=>(()=>{var $e=Qd();return $e.value=Te,a($e,Te),$e})()}),null),oe.style.setProperty("display","block"),oe.style.setProperty("margin-bottom","0.25rem"),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-muted)"),a(oe,()=>e("hbl.shipper","Shipper")),z.addEventListener("change",Te=>u(Te.currentTarget.value)),z.style.setProperty("width","100%"),z.style.setProperty("padding","0.5rem"),z.style.setProperty("border","1px solid var(--border-color)"),z.style.setProperty("border-radius","var(--border-radius-sm)"),z.style.setProperty("background","var(--surface-color)"),a(de,()=>e("common.all","All")),a(z,M(Ht,{get each(){return $()},children:Te=>(()=>{var $e=Qd();return $e.value=Te,a($e,Te),$e})()}),null),ue.style.setProperty("display","block"),ue.style.setProperty("margin-bottom","0.25rem"),ue.style.setProperty("font-size","0.875rem"),ue.style.setProperty("color","var(--text-muted)"),a(ue,()=>e("hbl.consignee","Consignee")),ge.addEventListener("change",Te=>y(Te.currentTarget.value)),ge.style.setProperty("width","100%"),ge.style.setProperty("padding","0.5rem"),ge.style.setProperty("border","1px solid var(--border-color)"),ge.style.setProperty("border-radius","var(--border-radius-sm)"),ge.style.setProperty("background","var(--surface-color)"),a(xe,()=>e("common.all","All")),a(ge,M(Ht,{get each(){return U()},children:Te=>(()=>{var $e=Qd();return $e.value=Te,a($e,Te),$e})()}),null),_e.style.setProperty("display","block"),_e.style.setProperty("margin-bottom","0.25rem"),_e.style.setProperty("font-size","0.875rem"),_e.style.setProperty("color","var(--text-muted)"),a(_e,()=>e("common.dateFrom","Date From")),a(pe,M(Ar,{type:"date",get value(){return s().start},onInput:Te=>l({...s(),start:Te.currentTarget.value})}),null),De.style.setProperty("display","block"),De.style.setProperty("margin-bottom","0.25rem"),De.style.setProperty("font-size","0.875rem"),De.style.setProperty("color","var(--text-muted)"),a(De,()=>e("common.dateTo","Date To")),a(Le,M(Ar,{type:"date",get value(){return s().end},onInput:Te=>l({...s(),end:Te.currentTarget.value})}),null),Se(()=>H.value=i()),Se(()=>ne.value=x()),Se(()=>z.value=c()),Se(()=>ge.value=h()),I}}),k),k.style.setProperty("display","flex"),k.style.setProperty("justify-content","space-between"),k.style.setProperty("align-items","center"),k.style.setProperty("margin-bottom","1rem"),R.style.setProperty("font-size","0.875rem"),R.style.setProperty("color","var(--text-muted)"),a(R,()=>e("common.showing","Showing"),Y),a(R,()=>P().length,q),a(R,()=>e("common.of","of"),le),a(R,()=>t.hbls.length,D),a(R,()=>e("hbl.records","records"),null),V.style.setProperty("display","flex"),V.style.setProperty("gap","0.5rem"),a(V,M(dt,{variant:"outline",size:"sm",onClick:C,get children(){return e("common.print","Print")}}),null),a(V,M(dt,{variant:"outline",size:"sm",onClick:re,get children(){return e("common.exportCSV","Export CSV")}}),null),a(V,M(dt,{variant:"outline",size:"sm",onClick:E,get children(){return e("common.exportExcel","Export Excel")}}),null),_}}),w),w.style.setProperty("margin-top","1rem"),a(w,M(Ht,{get each(){return P()},children:_=>M(Ft,{style:{"margin-bottom":"0.5rem"},get children(){var W=tR(),K=W.firstChild,k=K.firstChild,R=k.firstChild,Y=R.nextSibling,q=k.nextSibling,O=q.firstChild,le=O.firstChild,N=le.nextSibling,D=O.nextSibling,V=D.firstChild,I=V.nextSibling,F=q.nextSibling,Q=F.firstChild,H=Q.nextSibling,J=K.nextSibling,te=J.firstChild,ee=te.firstChild,ne=ee.firstChild,G=ee.nextSibling,ce=te.nextSibling,oe=ce.firstChild,z=oe.firstChild,de=oe.nextSibling,fe=ce.nextSibling,ue=fe.firstChild,ge=ue.firstChild,xe=ue.nextSibling,pe=fe.nextSibling,_e=pe.firstChild,Le=_e.firstChild,De=_e.nextSibling,Te=De.firstChild,$e=pe.nextSibling,Ie=$e.firstChild,Re=Ie.firstChild,Ke=Ie.nextSibling,je=$e.nextSibling,We=je.firstChild,Qe=We.firstChild,at=We.nextSibling;return W.addEventListener("mouseleave",nt=>{nt.currentTarget.style.backgroundColor="transparent"}),W.addEventListener("mouseenter",nt=>{nt.currentTarget.style.backgroundColor="var(--strip-color)"}),W.$$click=()=>t.onHBLSelect?.(_),W.style.setProperty("padding","1rem"),W.style.setProperty("cursor","pointer"),W.style.setProperty("transition","background-color 0.2s"),K.style.setProperty("display","grid"),K.style.setProperty("grid-template-columns","150px 1fr auto"),K.style.setProperty("gap","1rem"),K.style.setProperty("align-items","center"),R.style.setProperty("font-weight","600"),R.style.setProperty("color","var(--primary-color)"),a(R,()=>_.hbl),Y.style.setProperty("font-size","0.75rem"),Y.style.setProperty("color","var(--text-muted)"),a(Y,()=>_.idairguide),q.style.setProperty("display","grid"),q.style.setProperty("grid-template-columns","1fr 1fr"),q.style.setProperty("gap","1rem"),le.style.setProperty("font-size","0.75rem"),le.style.setProperty("color","var(--text-muted)"),a(le,()=>e("hbl.shipper","Shipper")),N.style.setProperty("font-weight","500"),a(N,()=>_.nameshipper),V.style.setProperty("font-size","0.75rem"),V.style.setProperty("color","var(--text-muted)"),a(V,()=>e("hbl.consignee","Consignee")),I.style.setProperty("font-weight","500"),a(I,()=>_.consigneeName),F.style.setProperty("text-align","right"),Q.style.setProperty("display","inline-block"),Q.style.setProperty("padding","0.25rem 0.75rem"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),Q.style.setProperty("font-size","0.75rem"),Q.style.setProperty("font-weight","500"),Q.style.setProperty("color","white"),a(Q,()=>_.idguidestate),H.style.setProperty("font-size","0.75rem"),H.style.setProperty("color","var(--text-muted)"),H.style.setProperty("margin-top","0.25rem"),a(H,()=>T(_.datereserve)),J.style.setProperty("margin-top","0.75rem"),J.style.setProperty("display","grid"),J.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(150px, 1fr))"),J.style.setProperty("gap","0.5rem"),J.style.setProperty("font-size","0.875rem"),ee.style.setProperty("color","var(--text-muted)"),a(ee,()=>e("hbl.city","City"),ne),G.style.setProperty("font-weight","500"),a(G,()=>_.address.city),oe.style.setProperty("color","var(--text-muted)"),a(oe,()=>e("hbl.classification","Class"),z),de.style.setProperty("font-weight","500"),a(de,()=>_.idclasification),ue.style.setProperty("color","var(--text-muted)"),a(ue,()=>e("hbl.commodity","Commodity"),ge),xe.style.setProperty("font-weight","500"),a(xe,()=>_.namegood),_e.style.setProperty("color","var(--text-muted)"),a(_e,()=>e("hbl.weight","Weight"),Le),De.style.setProperty("font-weight","500"),a(De,()=>_.weight,Te),Ie.style.setProperty("color","var(--text-muted)"),a(Ie,()=>e("hbl.bagNumber","Bag#"),Re),Ke.style.setProperty("font-weight","500"),a(Ke,()=>_.bagnumber),We.style.setProperty("color","var(--text-muted)"),a(We,()=>e("hbl.guideNo","Guide No."),Qe),at.style.setProperty("font-weight","500"),a(at,()=>_.guia),Se(nt=>(nt=j(_.idguidestate))!=null?Q.style.setProperty("background-color",nt):Q.style.removeProperty("background-color")),W}})})),b})()};yr(["click"]);var nR=he("<div><div><label></label><select><option value=all>"),iR=he("<div><div><h2>HBL: </h2><button>×</button></div><div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong><span></span></div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> <!>, </div><div><strong>:</strong> </div><div><strong>:</strong> <!> kg</div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),oR=he("<div>"),sR=he("<div><div><h1></h1><button>"),aR=he("<option> ");const lR=()=>{const{t}=sr(),[e,r]=Ce([]),[n,i]=Ce(null),[o,s]=Ce([]),[l,c]=Ce("all"),[u,h]=Ce(""),y=P=>{i(P)},g=P=>{s(P)},f=P=>{c(P),x()},x=async()=>{if(!u().trim())return null;let P=await gi.getHBLS(u().trim(),{guia:l()});P?.error?r([]):r(Object.values(P))};Sn(()=>{});const S=Dt(()=>{const P=new Set([2516,2517,2518,2519,2520,2521].map($=>$));return Array.from(P).sort(($,U)=>$-U)});return(()=>{var P=sR(),$=P.firstChild,U=$.firstChild,se=U.nextSibling;return P.style.setProperty("padding","1rem"),$.style.setProperty("margin-bottom","2rem"),$.style.setProperty("display","flex"),$.style.setProperty("justify-content","space-between"),$.style.setProperty("align-items","center"),U.style.setProperty("font-size","1.5rem"),U.style.setProperty("font-weight","600"),U.style.setProperty("color","var(--text-primary)"),a(U,()=>t("hbl.title","House Bill of Lading Management")),se.style.setProperty("padding","0.75rem 1.5rem"),se.style.setProperty("background","var(--primary-color)"),se.style.setProperty("color","white"),se.style.setProperty("border","none"),se.style.setProperty("border-radius","var(--border-radius-sm)"),se.style.setProperty("cursor","pointer"),se.style.setProperty("font-weight","500"),a(se,()=>t("hbl.addNew","Add New HBL")),a(P,M(Ft,{get children(){var X=nR(),Z=X.firstChild,re=Z.firstChild,E=re.nextSibling,C=E.firstChild;return X.style.setProperty("padding","1rem"),Z.style.setProperty("width","13rem"),re.style.setProperty("display","block"),re.style.setProperty("margin-bottom","0.25rem"),re.style.setProperty("font-size","0.875rem"),re.style.setProperty("color","var(--text-muted)"),a(re,()=>t("hbl.guideNumber","Guide Number")),E.addEventListener("change",T=>f(T.currentTarget.value)),E.style.setProperty("width","100%"),E.style.setProperty("padding","0.5rem"),E.style.setProperty("border","1px solid var(--border-color)"),E.style.setProperty("border-radius","var(--border-radius-sm)"),E.style.setProperty("background","var(--surface-color)"),a(C,()=>t("common.all","All")),a(E,M(Ht,{get each(){return S()},children:T=>(()=>{var j=aR(),b=j.firstChild;return j.value=T,a(j,()=>t("hbl.guideNo","Guide No."),b),a(j,T,null),j})()}),null),a(X,M(Ar,{type:"text",get placeholder(){return t("hbl.searchPlaceholder","Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...")},get value(){return u()},onChange:T=>h(T)}),null),Se(()=>E.value=l()),X}}),null),a(P,M(rR,{get hbls(){return e()},onFilterChange:g,onHBLSelect:y}),null),a(P,M(Ge,{get when(){return n()},get children(){var X=oR();return X.style.setProperty("position","fixed"),X.style.setProperty("top","0"),X.style.setProperty("left","0"),X.style.setProperty("right","0"),X.style.setProperty("bottom","0"),X.style.setProperty("background","rgba(0, 0, 0, 0.5)"),X.style.setProperty("display","flex"),X.style.setProperty("align-items","center"),X.style.setProperty("justify-content","center"),X.style.setProperty("z-index","1000"),a(X,M(Ft,{style:{width:"90%","max-width":"600px","max-height":"90vh","overflow-y":"auto"},get children(){var Z=iR(),re=Z.firstChild,E=re.firstChild;E.firstChild;var C=E.nextSibling,T=re.nextSibling,j=T.firstChild,b=j.firstChild,w=b.firstChild;b.nextSibling;var _=j.nextSibling,W=_.firstChild,K=W.firstChild;W.nextSibling;var k=_.nextSibling,R=k.firstChild,Y=R.firstChild,q=R.nextSibling,O=k.nextSibling,le=O.firstChild,N=le.firstChild;le.nextSibling;var D=O.nextSibling,V=D.firstChild,I=V.firstChild;V.nextSibling;var F=D.nextSibling,Q=F.firstChild,H=Q.firstChild;Q.nextSibling;var J=F.nextSibling,te=J.firstChild,ee=te.firstChild;te.nextSibling;var ne=J.nextSibling,G=ne.firstChild,ce=G.firstChild;G.nextSibling;var oe=ne.nextSibling,z=oe.firstChild,de=z.firstChild;z.nextSibling;var fe=oe.nextSibling,ue=fe.firstChild,ge=ue.firstChild;ue.nextSibling;var xe=fe.nextSibling,pe=xe.firstChild,_e=pe.firstChild,Le=pe.nextSibling,De=Le.nextSibling;De.nextSibling;var Te=xe.nextSibling,$e=Te.firstChild,Ie=$e.firstChild;$e.nextSibling;var Re=Te.nextSibling,Ke=Re.firstChild,je=Ke.firstChild,We=Ke.nextSibling,Qe=We.nextSibling;Qe.nextSibling;var at=Re.nextSibling,nt=at.firstChild,Ye=nt.firstChild;nt.nextSibling;var ht=at.nextSibling,lt=ht.firstChild,$t=lt.firstChild;lt.nextSibling;var _t=ht.nextSibling,ze=_t.firstChild,Lt=ze.firstChild;ze.nextSibling;var Nt=_t.nextSibling,wt=Nt.firstChild,Ot=wt.firstChild;wt.nextSibling;var gr=Nt.nextSibling,Be=gr.firstChild,Pt=Be.firstChild;return Be.nextSibling,Z.style.setProperty("padding","2rem"),re.style.setProperty("display","flex"),re.style.setProperty("justify-content","space-between"),re.style.setProperty("align-items","center"),re.style.setProperty("margin-bottom","1.5rem"),E.style.setProperty("font-size","1.25rem"),E.style.setProperty("font-weight","600"),a(E,()=>n().hbl,null),C.$$click=()=>i(null),C.style.setProperty("background","none"),C.style.setProperty("border","none"),C.style.setProperty("font-size","1.5rem"),C.style.setProperty("cursor","pointer"),C.style.setProperty("color","var(--text-muted)"),T.style.setProperty("display","grid"),T.style.setProperty("gap","1rem"),a(b,()=>t("hbl.airGuide","Air Guide"),w),a(j,()=>n().idairguide,null),a(W,()=>t("hbl.airNumber","Air Number"),K),a(_,()=>n().idairnumber,null),a(R,()=>t("hbl.status","Status"),Y),q.style.setProperty("margin-left","0.5rem"),q.style.setProperty("padding","0.25rem 0.75rem"),q.style.setProperty("border-radius","var(--border-radius-sm)"),q.style.setProperty("font-size","0.875rem"),q.style.setProperty("color","white"),a(q,()=>n().idguidestate),a(le,()=>t("hbl.classification","Classification"),N),a(O,()=>n().idclasification,null),a(V,()=>t("hbl.shipper","Shipper"),I),a(D,()=>n().nameshipper,null),a(Q,()=>t("hbl.shipperPhone","Shipper Phone"),H),a(F,()=>n().phoneshipper,null),a(te,()=>t("hbl.consignee","Consignee"),ee),a(J,()=>n().consigneeName,null),a(G,()=>t("hbl.consigneePhone","Consignee Phone"),ce),a(ne,()=>n().ctelephone,null),a(z,()=>t("hbl.identity","Identity"),de),a(oe,()=>n().cidentity,null),a(ue,()=>t("hbl.address","Address"),ge),a(fe,()=>n().street,null),a(pe,()=>t("hbl.city","City"),_e),a(xe,()=>n().address.city,De),a(xe,()=>n().address.estate,null),a($e,()=>t("hbl.commodity","Commodity"),Ie),a(Te,()=>n().namegood,null),a(Ke,()=>t("hbl.weight","Weight"),je),a(Re,()=>n().weight,Qe),a(nt,()=>t("hbl.quantity","Quantity"),Ye),a(at,()=>n().quantity,null),a(lt,()=>t("hbl.bagNumber","Bag Number"),$t),a(ht,()=>n().bagnumber,null),a(ze,()=>t("hbl.agency","Agency"),Lt),a(_t,()=>n().agency,null),a(wt,()=>t("hbl.guide","Guide"),Ot),a(Nt,()=>n().guia,null),a(Be,()=>t("hbl.reserveDate","Reserve Date"),Pt),a(gr,()=>new Date(n().datereserve).toLocaleDateString(),null),Se(Ct=>(Ct=n().idguidestate==="ENTREGADO"?"#28a745":n().idguidestate==="ENVIADO"?"#17a2b8":n().idguidestate==="EN BODEGA"?"#007bff":"#6c757d")!=null?q.style.setProperty("background-color",Ct):q.style.removeProperty("background-color")),Z}})),X}}),null),P})()};yr(["click"]);var cR=he("<div>$124,350"),uR=he("<div>+12% from last month"),dR=he("<div>247"),tc=he("<div>"),hR=he("<div>18"),pR=he("<div>$89,250"),fR=he("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>");const mR=()=>{const{t}=sr(),e={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},r={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},n={"font-size":"2rem","font-weight":"700",color:"var(--primary-color)",margin:"0.5rem 0"},i={"font-size":"0.875rem",color:"var(--text-muted)","text-transform":"uppercase","letter-spacing":"0.5px"};return M(Qi,{get title(){return t("dashboard.title")},get children(){return[(()=>{var o=tc();return m(o,e),a(o,M(Ft,{get title(){return t("dashboard.totalRevenue")},get subtitle(){return t("dashboard.overview")},get children(){return[(()=>{var s=cR();return Se(l=>m(s,n,l)),s})(),(()=>{var s=uR();return Se(l=>m(s,i,l)),s})()]}}),null),a(o,M(Ft,{get title(){return t("dashboard.employeeCount")},get subtitle(){return t("dashboard.current")},get children(){return[(()=>{var s=dR();return Se(l=>m(s,n,l)),s})(),(()=>{var s=tc();return a(s,()=>t("dashboard.newHires")),Se(l=>m(s,i,l)),s})()]}}),null),a(o,M(Ft,{get title(){return t("dashboard.pendingInvoices")},get subtitle(){return t("dashboard.outstanding")},get children(){return[(()=>{var s=hR();return Se(l=>m(s,n,l)),s})(),(()=>{var s=tc();return a(s,()=>t("dashboard.totalOutstanding")),Se(l=>m(s,i,l)),s})()]}}),null),a(o,M(Ft,{get title(){return t("dashboard.cashBalance")},get subtitle(){return t("accounts.title")},get children(){return[(()=>{var s=pR();return Se(l=>m(s,n,l)),s})(),(()=>{var s=tc();return a(s,()=>t("dashboard.lastUpdatedToday")),Se(l=>m(s,i,l)),s})()]}}),null),o})(),(()=>{var o=tc();return m(o,r),a(o,M(Ft,{get title(){return t("dashboard.quickActions")},get subtitle(){return t("dashboard.commonTasks")},get children(){var s=tc();return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","1rem"),a(s,M(dt,{variant:"primary",get children(){return t("invoices.createNew")}}),null),a(s,M(dt,{variant:"secondary",get children(){return t("employees.addEmployee")}}),null),a(s,M(dt,{variant:"outline",get children(){return t("dashboard.generateReport")}}),null),s}}),null),a(o,M(Ft,{get title(){return t("dashboard.recentActivity")},get subtitle(){return t("dashboard.latestUpdates")},get children(){var s=fR(),l=s.firstChild,c=l.firstChild,u=c.nextSibling,h=l.nextSibling,y=h.firstChild,g=y.nextSibling,f=h.nextSibling,x=f.firstChild,S=x.nextSibling;return s.style.setProperty("display","flex"),s.style.setProperty("flex-direction","column"),s.style.setProperty("gap","0.75rem"),l.style.setProperty("border-bottom","1px solid var(--border-color)"),l.style.setProperty("padding-bottom","0.5rem"),c.style.setProperty("font-weight","500"),a(c,()=>t("dashboard.invoicePaid")),u.style.setProperty("font-size","0.875rem"),u.style.setProperty("color","var(--text-muted)"),a(u,()=>t("dashboard.hoursAgo")),h.style.setProperty("border-bottom","1px solid var(--border-color)"),h.style.setProperty("padding-bottom","0.5rem"),y.style.setProperty("font-weight","500"),a(y,()=>t("dashboard.newEmployeeOnboarded")),g.style.setProperty("font-size","0.875rem"),g.style.setProperty("color","var(--text-muted)"),a(g,()=>t("dashboard.dayAgo")),x.style.setProperty("font-weight","500"),a(x,()=>t("dashboard.monthlyReportGenerated")),S.style.setProperty("font-size","0.875rem"),S.style.setProperty("color","var(--text-muted)"),a(S,()=>t("dashboard.daysAgo")),s}}),null),o})(),M(Ge,{get when(){return pr.hasPermission("invoiceAccess")},get children(){return M(m6,{})}})]}})};var hb=he("<div>"),yR=he("<div><div><div><strong>Display Name:</strong> </div><div><strong>UID:</strong> </div></div><div><strong>Created:</strong> "),gR=he("<div><h3>Store Access</h3><div></div><div>No store access granted"),vR=he("<div><select><option value=all>"),bR=he("<div><h3>Permissions</h3><div>"),_R=he('<div><div><input type=text placeholder="Search users..."></div><div>'),SR=he("<div>⚠️ You need administrator privileges to access this page."),PR=he("<div>Loading users..."),wR=he("<div><div></div><div></div><div> stores"),xR=he("<div>Select a user to view and edit their profile"),AR=he("<div><input type=checkbox><label>"),CR=he("<option>"),IR=he("<div><input type=checkbox><div><div></div><div>");const $R=()=>{const{t}=sr(),[e,r]=Ce([]),[n,i]=Ce(null),[o,s]=Ce(!1),[l,c]=Ce(!1),[u,h]=Ce(""),[y,g]=Ce(null),f=[{id:"YY_8802",name:"Store 8802"},{id:"YY_8803",name:"Store 8803"},{id:"YY_8804",name:"Store 8804"},{id:"YY_8805",name:"Store 8805"},{id:"YY_8816",name:"Store 8816"},{id:"YY_8818",name:"Store 8818"},{id:"YY_8847",name:"Store 8847"},{id:"YY_3251",name:"Store 3251"},{id:"YY_32",name:"Store 32"},{id:"YY_76",name:"Store 76"},{id:"YY_2376",name:"Store 2376"},{id:"YY_79",name:"Store 79"},{id:"YY_8635",name:"Store 8635"},{id:"YY_8665",name:"Store 8665"},{id:"YY_8901",name:"Store 8901"}],x=[{key:"AccountAccess",label:"Account Access",description:"Access to accounting features"},{key:"BankingAccess",label:"Banking Access",description:"Access to banking operations"},{key:"InventoryAccess",label:"Inventory Access",description:"Access to inventory management"},{key:"JournalAccess",label:"Journal Access",description:"Access to journal entries"},{key:"invoiceAccess",label:"invoice Access",description:"Access to Invoices"},{key:"inventoryDownsection",label:"Inventory Downsection",description:"Access to inventory downsection"},{key:"onlyRead",label:"Read Only",description:"Limited to read-only access"},{key:"read_write",label:"Read/Write",description:"Full read and write permissions"},{key:"isAdmin",label:"Administrator",description:"Full system administration rights"}];let S={stores:{YY_8802:!1,YY_8803:!1,YY_8804:!1,YY_8805:!1,YY_8816:!1,YY_8818:!1,YY_8847:!1,YY_3251:!1,YY_32:!1,YY_76:!1,YY_79:!1,YY_2376:!1,YY_8635:!1,YY_8665:!1,YY_8901:!1},businessId:"YB100423253156428",AccountAccess:!1,BankingAccess:!1,InventoryAccess:!1,JournalAccess:!1,invoiceAccess:!1,inventoryDownsection:!1,onlyRead:!1,read_write:!1},P=[{label:"Stephanie S",id:"SS695841584167881"},{label:"YABA",id:"YB100423253156428"},{label:"GUANCHO",id:"JJCM23753J15918M"},{label:"LUISCUETO",id:"LMR470531564CT28"}];Sn(async()=>{await $()});const $=async()=>{try{s(!0);const k=oI(Pm,"users"),R=vI(k,bI("createdAt","desc")),Y=await xI(R),q=[];Y.forEach(O=>{let le=O.data();Object.keys(S).map(N=>{let D=S?.[N];le.hasOwnProperty(N)||(le[N]=D)}),q.push({uid:O.id,...le})}),r(q)}catch(k){console.error("Error loading users:",k),g({type:"error",text:"Failed to load users"})}finally{s(!1)}},U=Dt(()=>{const k=u().toLowerCase();return k?e().filter(R=>R.email?.toLowerCase().includes(k)||R.displayName?.toLowerCase().includes(k)||R.uid?.toLowerCase().includes(k)):e()}),se=k=>{n()&&i(R=>({...R,stores:{...R.stores,[k]:!R.stores[k]}}))},X=k=>{n()&&i(R=>({...R,businessId:k}))},Z=k=>{n()&&i(R=>({...R,[k]:!R[k]}))};Dt(()=>n()?n().stores&&Object.values(n().stores).some(k=>k):!1);const re=async()=>{if(n())try{c(!0),g(null);const k=y5(Pm,"users",n().uid);let R={stores:n().stores,AccountAccess:n().AccountAccess,BankingAccess:n().BankingAccess,InventoryAccess:n().InventoryAccess,invoiceAccess:n().invoiceAccess,JournalAccess:n().JournalAccess,inventoryDownsection:n().inventoryDownsection,onlyRead:n().onlyRead,read_write:n().read_write,businessId:n().businessId,isAdmin:n().isAdmin||!1};await C5(k,R),r(Y=>Y.map(q=>q.uid===n().uid?n():q)),g({type:"success",text:"User profile updated successfully"})}catch(k){console.error("Error saving user profile:",k),g({type:"error",text:"Failed to save user profile"})}finally{c(!1)}},E={display:"grid","grid-template-columns":"350px 1fr",gap:"2rem",height:"calc(100vh - 200px)"},C={"max-height":"100%","overflow-y":"auto",border:"1px solid var(--border-color)","border-radius":"var(--border-radius)",background:"var(--surface-color)"},T=k=>({padding:"1rem","border-bottom":"1px solid var(--border-color)",cursor:"pointer",background:k?"var(--primary-color-light)":"transparent",transition:"background 0.2s"}),j={padding:"0.75rem",border:"none","border-bottom":"1px solid var(--border-color)",background:"var(--surface-color)",width:"100%","font-size":"1rem"},b={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},w={display:"grid","grid-template-columns":"repeat(auto-fill, minmax(200px, 1fr))",gap:"0.75rem"},_={display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)",cursor:"pointer",transition:"all 0.2s"},W=k=>({padding:"1rem","margin-bottom":"1rem","border-radius":"var(--border-radius)",background:k==="success"?"#d4edda":"#f8d7da",color:k==="success"?"#155724":"#721c24",border:`1px solid ${k==="success"?"#c3e6cb":"#f5c6cb"}`}),K=Dt(()=>pr.state.profile?.isAdmin===!0);return M(Qi,{title:"User Profile Administration",get children(){return M(Ge,{get when(){return K()},get fallback(){return M(Ft,{get children(){var k=SR();return k.style.setProperty("text-align","center"),k.style.setProperty("padding","2rem"),k.style.setProperty("color","var(--text-muted)"),k}})},get children(){var k=_R(),R=k.firstChild,Y=R.firstChild,q=R.nextSibling;return m(k,E),m(R,C),Y.$$input=O=>h(O.currentTarget.value),m(Y,j),a(R,M(Ge,{get when(){return!o()},get fallback(){return(()=>{var O=PR();return O.style.setProperty("padding","2rem"),O.style.setProperty("text-align","center"),O})()},get children(){return M(Ht,{get each(){return U()},children:O=>(()=>{var le=wR(),N=le.firstChild,D=N.nextSibling,V=D.nextSibling,I=V.firstChild;return le.$$click=()=>i(O),N.style.setProperty("font-weight","600"),a(N,()=>O.displayName||"No Name"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),a(D,()=>O.email),V.style.setProperty("font-size","0.75rem"),V.style.setProperty("color","var(--text-muted)"),V.style.setProperty("margin-top","0.25rem"),a(V,()=>O.isAdmin&&"👑 Admin • ",I),a(V,()=>Object.values(O.stores||{}).filter(Boolean).length,I),Se(F=>m(le,T(n()?.uid===O.uid),F)),le})()})}}),null),a(q,M(Ge,{get when(){return n()},get fallback(){return M(Ft,{get children(){var O=xR();return O.style.setProperty("text-align","center"),O.style.setProperty("padding","2rem"),O.style.setProperty("color","var(--text-muted)"),O}})},get children(){return[M(Ge,{get when(){return y()},get children(){var O=hb();return a(O,()=>y().text),Se(le=>m(O,W(y().type),le)),O}}),M(Ft,{title:"User Information",get subtitle(){return n().email},get children(){return[(()=>{var O=yR(),le=O.firstChild,N=le.firstChild,D=N.firstChild;D.nextSibling;var V=N.nextSibling,I=V.firstChild;I.nextSibling;var F=le.nextSibling,Q=F.firstChild;return Q.nextSibling,O.style.setProperty("margin-bottom","2rem"),le.style.setProperty("display","flex"),le.style.setProperty("justify-content","space-between"),le.style.setProperty("margin-bottom","1rem"),a(N,()=>n().displayName||"Not set",null),a(V,()=>n().uid,null),a(F,()=>new Date(n().createdAt?.toDate?.()||n().createdAt).toLocaleDateString(),null),O})(),(()=>{var O=gR(),le=O.firstChild,N=le.nextSibling,D=N.nextSibling;return O.style.setProperty("margin-bottom","2rem"),le.style.setProperty("margin-bottom","1rem"),m(N,w),a(N,M(Ht,{each:f,children:V=>{let I=ct.getLocationById(V?.id);return(()=>{var F=AR(),Q=F.firstChild,H=Q.nextSibling;return F.$$click=()=>se(V?.id),Q.style.setProperty("cursor","pointer"),H.style.setProperty("cursor","pointer"),H.style.setProperty("user-select","none"),a(H,()=>I?.name),Se(J=>m(F,{..._,background:n().stores?.[V?.id]?"var(--primary-color-light)":"transparent"},J)),Se(()=>Q.checked=n().stores?.[V?.id]||!1),F})()}})),D.style.setProperty("margin-top","0.5rem"),D.style.setProperty("font-size","0.875rem"),D.style.setProperty("color","var(--text-muted)"),O})(),(()=>{var O=vR(),le=O.firstChild,N=le.firstChild;return O.style.setProperty("margin-bottom","2rem"),le.addEventListener("change",D=>X(D.currentTarget.value)),le.style.setProperty("width","100%"),le.style.setProperty("padding","0.5rem"),le.style.setProperty("border","1px solid var(--border-color)"),le.style.setProperty("border-radius","var(--border-radius-sm)"),le.style.setProperty("background","var(--surface-color)"),a(N,()=>t("common.all","All")),a(le,M(Ht,{each:P,children:D=>(()=>{var V=CR();return a(V,()=>D?.label),Se(()=>V.value=D.id),V})()}),null),Se(()=>le.value=n()?.businessId),O})(),(()=>{var O=bR(),le=O.firstChild,N=le.nextSibling;return O.style.setProperty("margin-bottom","2rem"),le.style.setProperty("margin-bottom","1rem"),m(N,b),a(N,M(Ht,{each:x,children:D=>(()=>{var V=IR(),I=V.firstChild,F=I.nextSibling,Q=F.firstChild,H=Q.nextSibling;return V.$$click=()=>Z(D.key),I.style.setProperty("cursor","pointer"),F.style.setProperty("flex","1"),F.style.setProperty("cursor","pointer"),F.style.setProperty("user-select","none"),Q.style.setProperty("font-weight","500"),a(Q,()=>D.label),H.style.setProperty("font-size","0.75rem"),H.style.setProperty("color","var(--text-muted)"),a(H,()=>D.description),Se(J=>m(V,{..._,background:n()[D.key]?"var(--primary-color-light)":"transparent"},J)),Se(()=>I.checked=!!n()[D.key]),V})()})),O})(),(()=>{var O=hb();return O.style.setProperty("display","flex"),O.style.setProperty("gap","1rem"),O.style.setProperty("justify-content","flex-end"),a(O,M(dt,{variant:"secondary",onClick:()=>i(null),children:"Cancel"}),null),a(O,M(dt,{variant:"primary",onClick:re,get disabled(){return l()},get children(){return l()?"Saving...":"Save Changes"}}),null),O})()]}})]}})),Se(()=>Y.value=u()),k}})}})};yr(["input","click"]);const ER=async()=>{try{console.log("Testing PDF generation...");const e=(await Oi(()=>Promise.resolve().then(()=>r_),void 0)).default;console.log("jsPDF imported successfully");const r=new e;console.log("PDF document created"),r.setFontSize(20),r.text("Test PDF",20,20),r.setFontSize(12),r.text("This is a test PDF to verify the library works.",20,40),console.log("Text added to PDF"),r.save("test.pdf"),console.log("PDF saved successfully"),alert("Test PDF generated successfully!")}catch(t){console.error("Test PDF generation failed:",t),alert(`Test PDF failed: ${t.message}`)}},Rf=(t,e)=>{try{console.log("Generating printable PDF..."),console.log(t);const r=window.open("","_blank","width=800,height=600");if(!r){alert("Please allow popups to generate PDF");return}const n=t.shipper_consignee||{};let i=ct.getLocationById(t?.store);const o=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Invoice ${t.invoice||"N/A"}</title>
        <style>
          body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
          }
          .header {
            display: flex;
            justify-content: space-between;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 20px;
          }
          .company {
            font-size: 24px;
            font-weight: bold;
            color: #2563eb;
          }
          .invoice-info {
            text-align: right;
          }
          .section {
            margin: 20px 0;
          }
          .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
          }
          .customer-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
             font-size: 13px;
          }
          .flex{
            display: flex;
          }
          table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
          }
          th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
          }
          th {
            background-color: #f2f2f2;
            font-weight: bold;
            font-size: 13px;
          }
          td{
           font-size: 12px;
          }
          .total-row {
            font-weight: bold;
            font-size: 16px;
            background-color: #e8f4fd;
          }
          .certification-section {
            page-break-inside: avoid;
            break-inside: avoid;
            orphans: 3;
            widows: 3;
          }
          .page-break-before {
            page-break-before: always;
            break-before: page;
          }
          @media print {
            body { margin: 0; }
            .no-print { display: none; }
            .certification-section {
              page-break-inside: avoid !important;
              break-inside: avoid !important;
              orphans: 3;
              widows: 3;
            }
            .page-break-before {
              page-break-before: always !important;
              break-before: page !important;
            }
            /* Force page break if certification section would be split */
            @page {
              margin: 0.5in;
              orphans: 3;
              widows: 3;
            }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div>
            <div class="company">HRM FINANCE</div>
            <div>${e("common.store")}: ${i?.name||t?.store||"N/A"}</div>
            <div>${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}</div>
            ${t.shippingMethod?`<div>${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}</div>`:""}
          </div>
          <div class="invoice-info">
            <div style="font-size: 18px; font-weight: bold;">${e("common.invoice").toUpperCase()}</div>
            <div style="font-size: 16px; margin: 5px 0;">${t.invoice||"N/A"}</div>
            <div>${t.createDate?new Date(t.createDate).toLocaleDateString():"N/A"}</div>
            <div style="margin-top: 10px;">
              <span style="padding: 4px 8px; background: ${t.isCompleted?"#d4edda":"#fff3cd"}; border-radius: 10px; font-size: 12px;">
                ${t.isCompleted?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()}
              </span>
            </div>
          </div>
        </div>

        <div class="section">
          <div class="customer-info">
            <div><strong>${e("invoices.senderInformation")}:</strong> ${n.name||"N/A"}</div>
            ${n.phoneNumberS?`<div><strong>${e("invoices.phoneNumber")}:</strong> ${n.phoneNumberS}</div>`:""}
          
          </div>
          <div class="customer-info">
            <div><strong>${e("invoices.receiptInformation")}:</strong> ${[n.firstName,n.middleName,n.lastName,n.lastName2].filter(Boolean).join(" ")||"N/A"}</div>
            <div><strong>${e("invoices.phoneNumber")}:</strong> ${n.phoneNumber||"N/A"}</div>
            <div><strong>${e("invoices.id")}:</strong> ${n.cid||"N/A"}</div>
            ${n.address?`<div><strong>${e("invoices.address")}:</strong> ${n.address}</div>`:""}
          </div>
        </div>

        ${t.products&&t.products.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.products")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.code")}</th>
                <th>${e("invoices.description")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.products.map(s=>`
                <tr>
                  <td>${s.product?.code||"N/A"}</td>
                  <td>${s.product?.label||"N/A"}</td>
                  <td>${Math.abs(s.qty||0)}</td>
                  <td>$${parseFloat(s.salePrice||0).toFixed(2)}</td>
                  <td>$${(s.total||Math.abs(s.qty||0)*parseFloat(s.salePrice||0)).toFixed(2)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        ${t.reservas&&t.reservas.length>0?`
        <div class="section">
          <div class="section-title">${e("invoices.reservations")}</div>
          <table>
            <thead>
              <tr>
                <th>${e("invoices.type")}</th>
                <th>${e("invoices.qty")}</th>
                <th>${e("invoices.unitPrice")}</th>
                <th>${e("invoices.arancel")}</th>
                <th>${e("invoices.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${t.reservas.map(s=>{const l=parseFloat(s.qty||0),c=parseFloat(s.price||0),u=parseFloat(s.arancel||0),h=s.total||l*c+u;return`
                  <tr>
                    <td>${s.type||"N/A"}</td>
                    <td>${l.toFixed(2)}</td>
                    <td>$${c.toFixed(2)}</td>
                    <td>$${u.toFixed(2)}</td>
                    <td>$${h.toFixed(2)}</td>
                  </tr>
                `}).join("")}
            </tbody>
          </table>
        </div>
        `:""}

        <div class="section flex">
          ${t.paymentMethods?`
        <div class="section" style="margin-right: auto; width: 48%">
          <div class="section-title">${e("common.paymentMethods")}</div>
          <div class="customer-info">
            ${t.paymentMethods.cash>0?`<div><strong>💵 ${e("common.cash")}:</strong> $${t.paymentMethods.cash.toFixed(2)}</div>`:""}
            ${t.paymentMethods.zelle>0?`<div><strong>📱 Zelle:</strong> $${t.paymentMethods.zelle.toFixed(2)}</div>`:""}
            ${t.paymentMethods.creditCard>0?`<div><strong>💳 ${e("common.creditCard")}:</strong> $${t.paymentMethods.creditCard.toFixed(2)}</div>`:""}
            ${t.paymentMethods.exemptTaxOnCash&&t.paymentMethods.cash>0&&t.taxSavings>0?`
              <div style="margin-top: 10px; padding: 8px; background-color: #e7f5ff; border-radius: 4px; font-size: 12px; font-style: italic;">
                * ${e("common.taxExemptNote")} ${e("common.youSaved")} $${t.taxSavings.toFixed(2)}!
              </div>
            `:""}
          </div>
        </div>
        `:""}
        <div class="section ">
          <table style="margin-left: auto; width: width: 48%">
            ${t.productSubtotal?`
            <tr>
              <td><strong>${e("invoices.productsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.productSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.reservaSubtotal?`
            <tr>
              <td><strong>${e("invoices.reservationsSubtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${t.reservaSubtotal.toFixed(2)}</strong></td>
            </tr>
            `:""}
            ${t.taxAmount&&t.taxAmount>0?`
            <tr>
              <td><strong>${e("common.subtotal")}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.subtotalBeforeTax||0).toFixed(2)}</strong></td>
            </tr>
            <tr>
              <td><strong>${e("common.tax")} (${t.paymentMethods?.taxPercent||7}%):</strong></td>
              <td style="text-align: right;"><strong>$${t.taxAmount.toFixed(2)}</strong></td>
            </tr>
            `:""}
            <tr class="total-row">
              <td><strong>${e("invoices.total").toUpperCase()}:</strong></td>
              <td style="text-align: right;"><strong>$${(t.total||0).toFixed(2)}</strong></td>
            </tr>
          </table>
        </div>
        </div>
        
       

        <!-- Certification Section -->
        <div class="certification-section" style="margin-top: 40px; padding: 20px; border: 2px solid #333; background: #f9f9f9;">
          <div style="text-align: center; font-weight: bold; font-size: 14px; margin-bottom: 15px; text-transform: uppercase;">
            CERTIFICACIÓN DEL EMBARCADOR
          </div>
          <div style="font-size: 11px; line-height: 1.4; text-align: justify; margin-bottom: 20px;">
            <p><strong>Certifico que no envío sustancias ni productos prohibidos por las leyes y las aduanas de USA y Cuba, como por ejemplo:</strong> drogas, armas, explosivos, cigarrillos electrónicos, drones profesionales, joyas, prendas, dinero en efectivo, semillas, narcóticos, fármacos controlados, productos agrícolas de tipo herbicidas o antifúngicidas, ningún tipo de producto perecedero que necesite refrigeración.</p>
            
            <p><strong>Entiendo que al llenar este formulario, al enviar alguna de las sustancias o productos antes descritos mi carga puede ser decamisada completa o parcialmente por las aduanas de Cuba o USA sin derecho a reclamo ni compensación,</strong> de parte mía como embarcador, ni de la persona a quien envío (consignatario).</p>
            
           </div>
          
          <!-- Signature Section -->
          <div style="display: flex; justify-content: space-between; margin-top: 30px;">
            <div style="width: 45%; text-align: center;">
              <div style="border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px;"></div>
              <div style="font-size: 10px; font-weight: bold;">FIRMA DEL EMBARCADOR / SHIPPER SIGNATURE</div>
              <div style="font-size: 10px; margin-top: 5px;">${n.name||"N/A"}</div>
            </div>
            <div style="width: 45%; text-align: center;">
              <div style="border-bottom: 2px solid #333; margin-bottom: 10px; height: 40px;"></div>
              <div style="font-size: 10px; font-weight: bold;">FECHA / DATE</div>
              <div style="font-size: 10px; margin-top: 5px;">${new Date().toLocaleDateString()}</div>
            </div>
          </div>
        </div>

        <div style="margin-top: 40px; text-align: center; color: #666; font-size: 12px;">
          <p>${e("common.thankForChoosingUs")}</p>
          <p>${e("common.generatedOn")} ${new Date().toLocaleDateString()}</p>
        </div>

        <script>
          // Check if certification section needs page break
          function checkCertificationPageBreak() {
            const certSection = document.querySelector('.certification-section');
            if (!certSection) return;
            
            // Reset any previous page break class to get accurate measurements
            certSection.classList.remove('page-break-before');
            
            // Force a layout recalculation
            certSection.offsetHeight;
            
            const rect = certSection.getBoundingClientRect();
            const certHeight = rect.height;
            const certTop = rect.top;
            
            // Estimate print page height (assuming standard letter size at 96 DPI)
            // Standard letter: 11 inches - 1 inch margins = 10 inches usable
            // At 96 DPI: 10 * 96 = 960px usable height per page
            const printPageHeight = 960;
            const pageMargin = 48; // 0.5 inch margins
            
            // Calculate current position on the page
            const currentPagePosition = certTop % printPageHeight;
            const remainingPageSpace = printPageHeight - currentPagePosition - pageMargin;
            
            // Add some buffer space (50px) to ensure comfortable fit
            const requiredSpace = certHeight + 50;
            
            false && console.log('Certification section analysis:', {
              certHeight,
              certTop,
              currentPagePosition,
              remainingPageSpace,
              requiredSpace,
              needsPageBreak: requiredSpace > remainingPageSpace
            });
            
            // Only add page break if certification truly won't fit
            if (requiredSpace > remainingPageSpace && remainingPageSpace < printPageHeight * 0.4) {
              // console.log('Adding page break for certification section');
              certSection.classList.add('page-break-before');
            }
          }
          
          // Run check when page loads and before printing
          document.addEventListener('DOMContentLoaded', function() {
            // Delay to ensure all content is rendered
            setTimeout(checkCertificationPageBreak, 100);
          });
          window.addEventListener('beforeprint', checkCertificationPageBreak);
        <\/script>

        <div class="no-print" style="margin-top: 30px; text-align: center;">
          <button onclick="window.print()" style="padding: 10px 20px; font-size: 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
            ${e("common.printSavePDF")}
          </button>
          <button onclick="window.close()" style="padding: 10px 20px; font-size: 16px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px;">
            ${e("common.close")}
          </button>
        </div>
      </body>
      </html>
    `;r.document.write(o),r.document.close(),r.focus(),console.log("Printable PDF window opened")}catch(r){console.error("Error generating printable PDF:",r),alert("Error generating printable PDF: "+r.message)}},TR=async(t,e)=>{try{console.log("Starting professional PDF generation...");const n=(await Oi(()=>Promise.resolve().then(()=>r_),void 0)).default,i=new n,o=210,s=297,l=15,c=o-l*2,u={r:180,g:180,b:180},h={r:80,g:80,b:80},y={r:130,g:130,b:130},g={r:248,g:248,b:248},f={r:252,g:252,b:252},x={r:120,g:120,b:120},S={r:150,g:150,b:150};let P=l;const $=ne=>{i.setTextColor(ne.r,ne.g,ne.b)},U=ne=>{i.setFillColor(ne.r,ne.g,ne.b)},se=(ne,G,ce,oe,z,de=!1)=>{i.roundedRect(ne,G,ce,oe,z,z,de?"F":"S")};U(f),i.rect(0,0,o,50,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.5),i.line(0,50,o,50),$(h),i.setFontSize(32),i.setFont("helvetica","bold"),i.text("HRM",l,25),$(y),i.setFontSize(32),i.setFont("helvetica","normal");const X=i.getTextWidth("HRM ");i.text("FINANCE",l+X,25),$(y),i.setFontSize(9),i.setFont("helvetica","normal"),i.text("Professional Business Solutions",l,35);const Z=70,re=o-l-Z;i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.5),se(re,12,Z,26,2,!1),$(h),i.setFontSize(14),i.setFont("helvetica","bold");const E=e("common.invoice").toUpperCase(),C=i.getTextWidth(E);i.text(E,re+(Z-C)/2,22),i.setFontSize(11),i.setFont("helvetica","normal");const T=t.invoice||"N/A",j=i.getTextWidth(T);i.text(T,re+(Z-j)/2,32),P=60,U(f),i.rect(0,50,o,20,"F");const b=t.isCompleted,w=b?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase();$(b?h:y),i.setFontSize(8),i.setFont("helvetica","bold"),i.text(`STATUS: ${w}`,l,58),$(y),i.setFontSize(9),i.setFont("helvetica","normal");const W=t.createDate?new Date(t.createDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";i.text(W,o-l-i.getTextWidth(W),58),P=58,i.text(`${e("common.store")}: ${t.store||"N/A"}`,l+60,P),P+=5,i.text(`${e("common.orderId")}: ${t.ssg_sorder_key||"N/A"}`,l+60,P),t.shippingMethod&&i.text(`${e("common.shipping")}: ${t.shippingMethod==="aereo"?e("common.air"):e("common.sea")}`,o-l-50,P),P=80,$(h),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.customerInformation"),l,P),P+=10;const K=45,k=10,R=(c-k)/2;U(f),se(l,P,R,K,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),se(l,P,R,K,3);const Y=t.shipper_consignee||{};let q=P+8;$(y),i.setFontSize(9),i.text(e("invoices.senderInformation"),l+5,q),q+=7,$(h),i.setFontSize(11),i.setFont("helvetica","bold"),i.text(Y.name||"N/A",l+5,q),Y.phoneNumberS&&(q+=6,i.setFont("helvetica","normal"),i.setFontSize(9),$(y),i.text(`${e("invoices.altPhone")}: ${Y.phoneNumberS}`,l+5,q)),U(f),se(l+R+k,P,R,K,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),se(l+R+k,P,R,K,3),q=P+8,$(y),i.setFontSize(9),i.text(e("invoices.receiptInformation"),l+R+k+5,q),q+=7;const O=[Y.firstName,Y.middleName,Y.lastName,Y.lastName2].filter(Boolean).join(" ")||"N/A";if($(h),i.setFontSize(11),i.setFont("helvetica","bold"),i.text(O,l+R+k+5,q),q+=6,i.setFont("helvetica","normal"),i.setFontSize(9),$(y),i.text(`${e("invoices.phoneNumber")}: ${Y.phoneNumber||"N/A"}`,l+R+k+5,q),q+=5,i.text(`${e("invoices.id")}: ${Y.cid||"N/A"}`,l+R+k+5,q),Y.address)q+=5,Y.address.split(",").map(G=>G.trim()).forEach((G,ce)=>{ce<2&&G&&(i.text(G,l+R+k+5,q),q+=5)});else{let ne=`${Y.ybstreet||""} #${Y.ybstreetNo||""} ${e("invoices.between")} ${Y.ybbetwen1||""} ${e("invoices.and")} ${Y.ybbetwen2||""}`,G=`${Y.ybreparto||""}, ${Y.ybcity||""}, ${Y.ybestate||""}`;q+=5,i.text(ne,l+R+k+5,q),q+=5,i.text(G,l+R+k+5,q)}if(P+=K+15,t?.products&&t?.products?.length>0){$(h),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.products"),l,P),P+=10,U(g),i.rect(l,P-6,c,10,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(l,P+4,o-l,P+4),i.setFontSize(9),i.setFont("helvetica","bold"),$(h);const ne={code:l+5,description:l+35,qty:l+115,price:l+135,total:l+160};i.text(e("invoices.code"),ne.code,P),i.text(e("invoices.description"),ne.description,P),i.text(e("invoices.qty"),ne.qty,P),i.text(e("invoices.unitPrice"),ne.price,P),i.text(e("invoices.total"),ne.total,P),P+=10,i.setFont("helvetica","normal"),i.setFontSize(9),t.products.forEach((G,ce)=>{P>250&&(i.addPage(),P=l),ce%2===0&&(U(f),i.rect(l,P-4,c,8,"F")),$(h),i.text(G.product?.code||"N/A",ne.code,P);let oe=G.product?.label||"N/A";i.getTextWidth(oe)>70&&(oe=oe.substring(0,40)+"..."),i.text(oe,ne.description,P);const z=Math.abs(G.qty||0),de=parseFloat(G.salePrice||0),fe=G.total||z*de;i.text(z.toString(),ne.qty,P),i.text(`$${de.toFixed(2)}`,ne.price,P),i.setFont("helvetica","bold"),i.text(`$${fe.toFixed(2)}`,ne.total,P),i.setFont("helvetica","normal"),P+=8}),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(l,P,o-l,P),P+=15}if(t.reservas&&t.reservas.length>0){P>200&&(i.addPage(),P=l),$(h),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(e("invoices.reservations"),l,P),P+=10,U(g),i.rect(l,P-6,c,10,"F"),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(l,P+4,o-l,P+4),i.setFontSize(9),i.setFont("helvetica","bold"),$(h);const ne={type:l+5,qty:l+65,price:l+95,arancel:l+125,total:l+160};i.text(e("invoices.type"),ne.type,P),i.text(e("invoices.qty"),ne.qty,P),i.text(e("invoices.unitPrice"),ne.price,P),i.text(e("invoices.arancel"),ne.arancel,P),i.text(e("invoices.total"),ne.total,P),P+=10,i.setFont("helvetica","normal"),i.setFontSize(9),t.reservas.forEach((G,ce)=>{P>250&&(i.addPage(),P=l),ce%2===0&&(U(f),i.rect(l,P-4,c,8,"F")),$(h),i.text(G.type||"N/A",ne.type,P);const oe=parseFloat(G.qty||0),z=parseFloat(G.price||0),de=parseFloat(G.arancel||0),fe=G.total||oe*z+de;i.text(oe.toString(),ne.qty,P),i.text(`$${z.toFixed(2)}`,ne.price,P),i.text(`$${de.toFixed(2)}`,ne.arancel,P),i.setFont("helvetica","bold"),i.text(`$${fe.toFixed(2)}`,ne.total,P),i.setFont("helvetica","normal"),P+=8}),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(l,P,o-l,P),P+=15}P>210&&(i.addPage(),P=l);const le=o-l-80,N=80;let D=60;t.taxAmount&&t.taxAmount>0&&(D+=16),U(f),se(le-10,P,N+10,D,3,!0),i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),se(le-10,P,N+10,D,3);let V=P+10;if(i.setFontSize(10),$(y),t.productSubtotal!==void 0&&t.productSubtotal>0&&(i.text(e("invoices.productsSubtotal"),le,V),i.text(`$${t.productSubtotal.toFixed(2)}`,le+N-15,V,{align:"right"}),V+=8),t.reservaSubtotal!==void 0&&t.reservaSubtotal>0&&(i.text(e("invoices.reservationsSubtotal"),le,V),i.text(`$${t.reservaSubtotal.toFixed(2)}`,le+N-15,V,{align:"right"}),V+=8),t.taxAmount&&t.taxAmount>0){i.text(e("common.subtotal"),le,V),i.text(`$${(t.subtotalBeforeTax||0).toFixed(2)}`,le+N-15,V,{align:"right"}),V+=8;const ne=t.paymentMethods?.taxPercent||7;i.text(`${e("common.tax")} (${ne}%)`,le,V),i.text(`$${t.taxAmount.toFixed(2)}`,le+N-15,V,{align:"right"}),V+=8}if(i.setDrawColor(u.r,u.g,u.b),i.setLineWidth(.3),i.line(le,V+2,le+N-10,V+2),V+=10,i.setFontSize(14),i.setFont("helvetica","bold"),$(h),i.text(e("invoices.total"),le,V),i.text(`$${(t.total||0).toFixed(2)}`,le+N-15,V,{align:"right"}),t.paymentMethods){P+=D+20,$(h),i.setFontSize(12),i.setFont("helvetica","bold"),i.text(e("common.paymentMethods"),l,P),P+=10,i.setFontSize(10),i.setFont("helvetica","normal"),$(y);const ne=t.paymentMethods;let G=P;ne.cash&&ne.cash>0&&(i.text(`${e("common.cash")}:`,l+5,G),i.text(`$${ne.cash.toFixed(2)}`,l+50,G),G+=6),ne.zelle&&ne.zelle>0&&(i.text("Zelle:",l+5,G),i.text(`$${ne.zelle.toFixed(2)}`,l+50,G),G+=6),ne.creditCard&&ne.creditCard>0&&(i.text(`${e("common.creditCard")}:`,l+5,G),i.text(`$${ne.creditCard.toFixed(2)}`,l+50,G),G+=6),ne.exemptTaxOnCash&&ne.cash>0&&t.taxSavings>0&&(G+=4,i.setFontSize(9),i.setFont("helvetica","italic"),i.text(`* Tax exempted on cash payment. You saved $${t.taxSavings.toFixed(2)}!`,l+5,G)),P=G+10}P=s-30,U(f),i.rect(0,P-10,o,40,"F"),i.setFontSize(12),i.setFont("helvetica","italic"),$(y);const I=e("common.thankYouBusiness"),F=i.getTextWidth(I);i.text(I,(o-F)/2,P),P+=8,i.setFontSize(9),i.setFont("helvetica","normal");const Q="www.hrmfinance.com | info@hrmfinance.com | +1 (555) 123-4567",H=i.getTextWidth(Q);i.text(Q,(o-H)/2,P),P+=8,i.setFontSize(8);const J=`Generated on ${new Date().toLocaleString("en-US")}`,te=i.getTextWidth(J);i.text(J,(o-te)/2,P);const ee=`invoice-${t.invoice||"unknown"}.pdf`;i.save(ee),console.log("Professional PDF saved successfully:",ee)}catch(r){throw console.error("Error in generateProfessionalInvoicePDF:",r),r}},ga=t=>parseFloat(t?.toString()||"0")||0,kR=t=>{if(t?.includes("/")){const[e,r,n]=t.split("/");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}if(t?.includes("-")){const[e,r,n]=t.split("-");return`${n}-${e.padStart(2,"0")}-${r.padStart(2,"0")}`}return t},NR=t=>{const e=[];return t.ybstreet&&(e.push(t.ybstreet),t.ybstreetNo&&e.push(`# ${t.ybstreetNo}`)),t.ybbetwen1&&t.ybbetwen2&&e.push(`/ ${t.ybbetwen1} y ${t.ybbetwen2}`),t.ybreparto&&e.push(`, Rpto ${t.ybreparto}`),t.ybcity&&e.push(`, ${t.ybcity}`),t.ybestate&&e.push(`, ${t.ybestate}`),e.join(" ")},pb=t=>{const e=ga(t.qty),r=ga(t.price),n=ga(t.arancel);return t.onlyTariff?n:e*r+n},fb=t=>{const e=Math.abs(t.qty),r=ga(t.salePrice);return e*r},LR=(t,e)=>{const r=t.split("-");if(r.length>=3){const n=r[0];return{YY_8803:"BISSONNET"}[n]||e}return e},Wh=t=>{const e=t?.products?.reduce((S,P)=>S+fb(P),0),r=t?.reservas?.reduce((S,P)=>S+pb(P),0);var n=e+r,i=t?.TaxPercent||0,o=n*i/100,s=0,l=n+o,c=0;t?.paymentMethods&&(i=t?.paymentMethods?.taxPercent||0,o=t.taxAmount||0,l=t.total||0,n=t.subtotalBeforeTax||0,s=t?.taxSavings);const h=(t?.products||[])?.map((S,P)=>({id:Date.now().toString()+P,product:{id:S.product.id,code:S.product.code,label:S.product.label,price:0},qty:Math.abs(S.qty),salePrice:ga(S.salePrice),total:fb(S)})),y=t?.reservas?.map((S,P)=>({id:Date.now().toString()+P+1e3,type:S.type,qty:ga(S.qty),price:ga(S.price),arancel:ga(S.arancel),total:pb(S)})),g={name:t.shipper_consignee.name,firstName:t.shipper_consignee.firstName,middleName:t.shipper_consignee.middleName||"",lastName:t.shipper_consignee.lastName,lastName2:t.shipper_consignee.lastName2||"",phoneNumber:t.shipper_consignee.phoneNumber,cid:t.shipper_consignee.cid,passport:t.shipper_consignee.passport||"",address:NR(t.shipper_consignee),phoneNumberS:t.shipper_consignee.phoneNumberS,dob:kR(t.shipper_consignee.dob)},f=LR(t.invoice,t.store),x=t.shippingMethod?.toLowerCase()==="aereo"?"aereo":"maritimo";return{invoice:t.invoice,description:t.description||"",store:f,shipper_consignee:g,products:h,reservas:y,packagesOrder:t.packagesOrder,shippingMethod:x,paymentMethods:t?.paymentMethods,type:t.type,ssg_inventory_key:t.ssg_inventory_key,ssg_sorder_key:t.ssg_sorder_key,createDate:t.createDate,businessId:t.businessId,isCompleted:t.isCompleted,productSubtotal:e,reservaSubtotal:r,subtotalBeforeTax:n,taxAmount:o,taxSavings:s,total:l,taxCalculationMethod:"subtotal",cashPaymentRatio:c}},[ou,Ur]=Gu({invoices:[],selectedInvoice:null,loading:!1,error:null,lastUpdated:null}),[RR,ao]=Ce({fetchAll:!1,fetchById:!1,create:!1,update:!1,delete:!1,generatePDF:!1}),Ri={get state(){return ou},get loadingStates(){return RR()},async fetchInvoices(t){try{ao(s=>({...s,fetchAll:!0})),Ur("loading",!0),Ur("error",null);let e="SALES";if(t?.search&&(e+=" "+t.search),t?.store&&t.store!=="all")e+=" "+t.store;else if(!pr.state?.profile?.isAdmin)return e+=" "+ku(32),Ur("invoices",[]),Ur("lastUpdated",new Date),[];t?.status&&t.status!=="all"&&(e+=" "+t.status);const r=e.toString(),n=await gi.getInvoice(r);let i=[];if(t?.dateFrom&&t?.dateTo){const s=l=>{let c=new Date(n[l].createDate).getTime(),u=new Date(t?.dateFrom).getTime(),h=new Date(t?.dateTo).getTime();c>=u&&c<=h&&i.push(n[l])};Object.keys(n).map(s)}else i=Kf(n);const o=Array.isArray(i)?i:i||[];return Ur("invoices",o),Ur("lastUpdated",new Date),o}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoices";throw Ur("error",r),console.error("Error fetching invoices:",e),e}finally{Ur("loading",!1),ao(e=>({...e,fetchAll:!1}))}},fecthInventory:async t=>{},async fetchInvoiceById(t){try{ao(n=>({...n,fetchById:!0})),Ur("error",null);const e=await gi.getInvoice(t),r=Kf(e);return Ur("selectedInvoice",r[0]),r}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice";throw Ur("error",r),console.error("Error fetching invoice:",e),e}finally{ao(e=>({...e,fetchById:!1}))}},async createInvoice(t){try{ao(r=>({...r,create:!0})),Ur("error",null);const e={type:t.type||"SALES",invoice:t.invoice,description:t.description||"",store:t.store||"",ssg_inventory_key:t.ssg_inventory_key||`INV-${Date.now()}`,ssg_sorder_key:t.ssg_sorder_key||`SO-${Date.now()}`,createDate:t.createDate||Date.now(),shipper_consignee:t.shipper_consignee,packagesOrder:t.packagesOrder||!1,businessId:t.businessId||"YB100423253156428",userId:t.userId||"current-user",reservas:t.reservas||[],products:t.products||[],isCompleted:t.isCompleted||!0};return e.products&&e.products.length>0&&(e.productSubtotal=e.products.reduce((r,n)=>r+n.qty*n.salePrice,0)),e.reservas&&e.reservas.length>0&&(e.reservaSubtotal=e.reservas.reduce((r,n)=>r+n.total,0)),e.total=(e.productSubtotal||0)+(e.reservaSubtotal||0),Ur("invoices",r=>[e,...r]),Ur("lastUpdated",new Date),e}catch(e){const r=e instanceof Error?e.message:"Failed to create invoice";throw Ur("error",r),console.error("Error creating invoice:",e),e}finally{ao(e=>({...e,create:!1}))}},async generateInvoicePDF(t,e="compact",r="es"){try{ao(l=>({...l,generatePDF:!0})),Ur("error",null);const n=ou.invoices.find(l=>l.invoice===t);if(!n)throw new Error("Invoice not found");let i;switch(e){case"compact":const{generateCompactModernInvoicePDF:l}=await Oi(async()=>{const{generateCompactModernInvoicePDF:h}=await import("./compactModernInvoicePdfGenerator-BLPc1hH8.js");return{generateCompactModernInvoicePDF:h}},[]);i=l;break;case"modern":const{generateModernMovementInvoicePDF:c}=await Oi(async()=>{const{generateModernMovementInvoicePDF:h}=await import("./modernMovementInvoicePdfGenerator-JZtIfy1C.js");return{generateModernMovementInvoicePDF:h}},[]);i=c;break;case"classic":default:const{generateWorkingInvoicePDF:u}=await Oi(async()=>{const{generateWorkingInvoicePDF:h}=await import("./workingPdfGenerator-BO9NA6IU.js");return{generateWorkingInvoicePDF:h}},[]);i=u;break}const o={...n,movementType:"sales",items:n.products||[],invoiceId:n.invoice,id:n.invoice};return await i(o,null,r)}catch(n){const i=n instanceof Error?n.message:"Failed to generate PDF";throw Ur("error",i),console.error("Error generating invoice PDF:",n),n}finally{ao(n=>({...n,generatePDF:!1}))}},async updateInvoice(t,e){try{ao(n=>({...n,update:!0})),Ur("error",null);const r={};return Ur("invoices",n=>n.map(i=>i.invoice===t?r:i)),ou.selectedInvoice?.invoice===t&&Ur("selectedInvoice",r),Ur("lastUpdated",new Date),r}catch(r){const n=r instanceof Error?r.message:"Failed to update invoice";throw Ur("error",n),console.error("Error updating invoice:",r),r}finally{ao(r=>({...r,update:!1}))}},async deleteInvoice(t){try{ao(i=>({...i,delete:!0})),Ur("error",null),Ur("invoices",i=>i.filter(o=>o.invoice!==t)),ou.selectedInvoice?.invoice===t&&Ur("selectedInvoice",null),Ur("lastUpdated",new Date);const n=await di({query:"deleteYabaSalesOrders",params:{businessId:"YB100423253156428",id:t}});return!0}catch(e){const r=e instanceof Error?e.message:"Failed to delete invoice";throw Ur("error",r),console.error("Error deleting invoice:",e),e}finally{ao(e=>({...e,delete:!1}))}},async fetchInvoiceStats(t){try{Ur("error",null);const e=new URLSearchParams;t?.store&&t.store!=="all"&&e.append("store",t.store),t?.dateFrom&&e.append("dateFrom",t.dateFrom),t?.dateTo&&e.append("dateTo",t.dateTo);const r=e.toString();return[]}catch(e){const r=e instanceof Error?e.message:"Failed to fetch invoice statistics";throw Ur("error",r),console.error("Error fetching invoice stats:",e),e}},async fetchStores(){try{return Ur("error",null),[]}catch(t){const e=t instanceof Error?t.message:"Failed to fetch stores";throw Ur("error",e),console.error("Error fetching stores:",t),t}},setSelectedInvoice(t){Ur("selectedInvoice",t)},clearError(){Ur("error",null)},getFilteredInvoices(t){let e=ou.invoices;if(t.store&&t.store!=="all"&&(e=e.filter(r=>r.store===t.store)),t.dateFrom){const r=new Date(t.dateFrom).getTime();e=e.filter(n=>n.createDate>=r)}if(t.dateTo){const r=new Date(t.dateTo).setHours(23,59,59,999);e=e.filter(n=>n.createDate<=r)}if(t.status&&t.status!=="all"){const r=t.status==="completed";e=e.filter(n=>n.isCompleted===r)}return e},calculateSummary(t){let e=t.length,r=t.filter(g=>g.isCompleted).length,n=0,i=0,o=0,s=0,l=0,c=0,u=new Set,h=new Set;t?.forEach(g=>{u.add(g?.shipper_consignee?.cid),h.add(g.store),g?.products?.length>0&&g?.products?.forEach(f=>{const x=Math.abs(f?.qty);n+=x,o+=x*(parseFloat(f?.salePrice)||1)}),g?.reservas?.length>0&&g?.reservas?.forEach(f=>{let x=parseInt(f?.qty);isNaN(x)&&(x=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[f.type]||f?.onlyTariff?(x=parseFloat(f.arancel)||parseFloat(f.qty)*parseFloat(f.price),c+=x):(f?.arancel&&(l+=parseFloat(f?.arancel)),i+=x,s+=x*parseFloat(f?.price))})});const y=o+s+c;return{totalInvoices:e,completedInvoices:r,pendingInvoices:e-r,totalProducts:n,totalReservas:i,totalProductAmount:o,totalReservaAmount:s,totalAranceles:l,grandTotal:y,totalOther:c,uniqueCustomers:u.size,uniqueStores:h.size,avgInvoiceValue:e>0?y/e:0}},async refreshData(t){return this.fetchInvoices(t)}};var DR=he("<br>"),mb=he("<div><h3></h3><table><thead><tr><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),Df=he("<div><span>:</span><span>"),MR=he("<div><span> ($<!>%):</span><span>"),FR=he("<button>remove"),OR=he("<div class=invoice-display><div><div><div>:<span></span></div><div>: <span></span></div></div><div><div></div><h2></h2><div></div><div></div></div></div><div><h3></h3><div><div><div></div><div></div></div></div><div></div><h3></h3><div><div><div></div><div> <!> <!> </div><div></div><div></div><div></div><div></div></div><div><div></div><div></div><div></div><div></div><div> #<br> <!> <!> <br>, <br>, </div></div></div></div><div><div><div></div><div><span>:</span><span></span></div></div></div><div></div><div><button>🖨️ </button><button>🧪 Test PDF</button><button>📥 </button></div><style>"),yb=he("<tr><td></td><td></td><td></td><td></td><td>");const BR=t=>{const{t:e}=sr(),[r,n]=Ce(""),[i,o]=Ce(!1),s=K=>new Date(K).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),l=K=>{const k=typeof K=="string"?parseFloat(K):K;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k)},c=Dt(()=>{let K=0,k=0,R=0,Y=0;t.invoice?.products?.forEach(N=>{const D=Math.abs(N?.qty),V=parseFloat(N?.salePrice?.toString())||1;K+=D*V}),t.invoice?.reservas?.forEach(N=>{let D=parseFloat(N?.qty?.toString());isNaN(D)&&(D=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[N.type]||N?.onlyTariff?(D=parseFloat(N.arancel?.toString())||parseFloat(N.qty?.toString())*parseFloat(N.price?.toString()),R+=D):(N?.arancel&&(Y+=parseFloat(N?.arancel?.toString())),k+=D*parseFloat(N?.price?.toString()))});var q=K+k+Y+R,O=0,le=q+O;return t.invoice?.paymentMethods&&(O=t.invoice?.taxAmount,le=t.invoice?.total,q=t.invoice?.subtotalBeforeTax),{productSubtotal:K,reservaSubtotal:k,tariffSubtotal:Y,subtotal:q,tax:O,total:le}}),u={"max-width":"800px",margin:"0 auto",padding:"2rem",background:"white","box-shadow":"0 0 20px rgba(0,0,0,0.1)","border-radius":"var(--border-radius)"},h={display:"flex","justify-content":"space-between","align-items":"flex-start","margin-bottom":"2rem","padding-bottom":"2rem","border-bottom":"2px solid #e0e0e0"},y={"text-align":"right",flex:"1"},g={display:"inline-block",padding:"0.25rem 0.75rem","border-radius":"9999px","font-size":"0.75rem","font-weight":"600","text-transform":"uppercase",background:t.invoice.isCompleted?"#d4edda":"#fff3cd",color:t.invoice.isCompleted?"#155724":"#856404","margin-bottom":"0.5rem"},f={"margin-bottom":"2rem"},x={"font-size":"1.1rem","font-weight":"600","margin-bottom":"1rem",color:"#333"},S={display:"grid","grid-template-columns":"1fr 1fr",gap:"1.5rem"},P={background:"#f8f9fa",padding:"1rem","border-radius":"var(--border-radius-sm)",border:"1px solid #e9ecef"},$={"font-size":"0.875rem",color:"#666","margin-bottom":"0.25rem"},U={"font-size":"1rem",color:"#333","font-weight":"500"},se={width:"100%","border-collapse":"collapse","margin-top":"1rem"},X={"text-align":"left",padding:"0.75rem","border-bottom":"2px solid #dee2e6","font-weight":"600",color:"#495057","font-size":"0.875rem","text-transform":"uppercase"},Z={padding:"0.75rem","border-bottom":"1px solid #dee2e6",color:"#212529"},re={"font-weight":"600","font-size":"1.1rem"},E={display:"flex",gap:"1rem","justify-content":"center","margin-top":"2rem","padding-top":"2rem","border-top":"2px solid #e0e0e0"},C={padding:"0.75rem 1.5rem","border-radius":"var(--border-radius-sm)",border:"none","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"flex","align-items":"center",gap:"0.5rem"},T={...C,background:"var(--primary-color)",color:"white"},j={...C,background:"white",color:"var(--primary-color)",border:"2px solid var(--primary-color)"},b=Dt(()=>ct.getLocationById(t.invoice.store)),w=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}let K=Wh(t.invoice);console.log("Using minimal ink PDF generator...");try{await TR(K,e),console.log("Minimal ink PDF generation completed successfully")}catch(k){console.error("PDF generation failed:",k),console.log("Trying printable PDF fallback..."),Rf(K,e),console.log("Printable PDF fallback completed")}}catch(K){console.error("Error in handleExportPDF:",K),console.error("Error stack:",K.stack),alert(`Error generating PDF: ${K.message}`)}},_=async()=>{console.log("Starting PDF export...");try{if(!t.invoice){console.error("No invoice data available"),alert("No invoice data available");return}const K={...t.invoice,storeName:b()?.name||t.invoice.store,storeType:b()?.type,productSubtotal:c().productSubtotal,reservaSubtotal:c().reservaSubtotal,total:c().total};let k=Wh(t.invoice);console.log("Using minimal ink PDF generator...");try{Rf(k,e),console.log("Minimal ink PDF generation completed successfully")}catch(R){console.error("PDF generation failed:",R),console.log("Trying printable PDF fallback..."),Rf(k,e),console.log("Printable PDF fallback completed")}}catch(K){console.error("Error in handleExportPDF:",K),console.error("Error stack:",K.stack),alert(`Error generating PDF: ${K.message}`)}},W=K=>{Ri.deleteInvoice(t.invoice.ssg_sorder_key),t.goBack()};return(()=>{var K=OR(),k=K.firstChild,R=k.firstChild,Y=R.firstChild,q=Y.firstChild,O=q.nextSibling,le=Y.nextSibling,N=le.firstChild,D=N.nextSibling,V=R.nextSibling,I=V.firstChild,F=I.nextSibling,Q=F.nextSibling,H=Q.nextSibling,J=k.nextSibling,te=J.firstChild,ee=te.nextSibling,ne=ee.firstChild,G=ne.firstChild,ce=G.nextSibling,oe=ee.nextSibling,z=oe.nextSibling,de=z.nextSibling,fe=de.firstChild,ue=fe.firstChild,ge=ue.nextSibling,xe=ge.firstChild,pe=xe.nextSibling,_e=pe.nextSibling,Le=_e.nextSibling;Le.nextSibling;var De=ge.nextSibling,Te=De.nextSibling,$e=Te.nextSibling,Ie=$e.nextSibling,Re=fe.nextSibling,Ke=Re.firstChild,je=Ke.nextSibling,We=je.nextSibling,Qe=We.nextSibling,at=Qe.nextSibling,nt=at.firstChild,Ye=nt.nextSibling,ht=Ye.nextSibling,lt=ht.nextSibling,$t=lt.nextSibling,_t=$t.nextSibling,ze=_t.nextSibling,Lt=ze.nextSibling,Nt=Lt.nextSibling,wt=Nt.nextSibling,Ot=wt.nextSibling,gr=J.nextSibling,Be=gr.firstChild,Pt=Be.firstChild,Ct=Pt.nextSibling,tt=Ct.firstChild,ft=tt.firstChild,Vt=tt.nextSibling,Rt=gr.nextSibling,rr=Rt.nextSibling,it=rr.firstChild;it.firstChild;var yt=it.nextSibling,It=yt.nextSibling;It.firstChild;var Jt=rr.nextSibling;return m(K,u),m(k,h),Y.style.setProperty("color","#666"),Y.style.setProperty("margin-top","0.25rem"),a(Y,()=>e(`inventory.${b()?.type}Type`),q),O.style.setProperty("font-size","1.1rem"),O.style.setProperty("font-weight","600"),O.style.setProperty("color","#444"),a(O,()=>b()?.name),le.style.setProperty("font-size",".91rem"),le.style.setProperty("font-weight","400"),le.style.setProperty("color","#666"),a(le,()=>e("invoices.id"),N),D.style.setProperty("font-size","1.1rem"),D.style.setProperty("font-weight","600"),D.style.setProperty("color","#444"),a(D,()=>t.invoice.ssg_sorder_key),m(V,y),a(I,(()=>{var Je=Ee(()=>!!t.invoice.isCompleted);return()=>Je()?e("invoices.completed").toUpperCase():e("invoices.pending").toUpperCase()})()),F.style.setProperty("margin","0 0 0.5rem 0"),F.style.setProperty("font-size","1.5rem"),a(F,()=>e("common.invoice").toUpperCase()),Q.style.setProperty("font-size","1.1rem"),Q.style.setProperty("font-weight","600"),Q.style.setProperty("color","#333"),a(Q,()=>t.invoice.invoice),H.style.setProperty("color","#666"),H.style.setProperty("margin-top","0.5rem"),a(H,()=>s(t.invoice.createDate)),a(te,()=>e("invoices.senderInformation")),a(G,()=>e("invoices.customerName")),a(ce,()=>t.invoice.shipper_consignee.name),a(ne,M(Ge,{get when(){return t.invoice.shipper_consignee.phoneNumberS},get children(){return[DR(),Ee(()=>e("invoices.altPhone")),": ",Ee(()=>t.invoice.shipper_consignee.phoneNumberS)]}}),null),oe.style.setProperty("margin","20px"),a(z,()=>e("invoices.receiptInformation")),a(ue,()=>e("invoices.customerName")),a(ge,()=>t.invoice.shipper_consignee.firstName,xe),a(ge,()=>t.invoice.shipper_consignee.middleName,pe),a(ge,()=>t.invoice.shipper_consignee.lastName,Le),a(ge,()=>t.invoice.shipper_consignee.lastName2,null),a(De,()=>e("invoices.id")),a(Te,()=>t.invoice.shipper_consignee.cid),a($e,()=>e("invoices.passport")),a(Ie,()=>t.invoice.shipper_consignee.passport),a(Ke,()=>e("invoices.contactInformation")),a(je,()=>e("invoices.phoneNumber")),a(We,()=>t.invoice.shipper_consignee.phoneNumber),a(Qe,()=>e("invoices.address")),a(at,()=>t.invoice.shipper_consignee.ybstreet,nt),a(at,()=>t.invoice.shipper_consignee.ybstreetNo,Ye),a(at,()=>e("invoices.between"),ht),a(at,()=>t.invoice.shipper_consignee.ybbetwen1,lt),a(at,()=>e("invoices.and"),_t),a(at,()=>t.invoice.shipper_consignee.ybbetwen2,Lt),a(at,()=>t.invoice.shipper_consignee.ybreparto,Nt),a(at,()=>t.invoice.shipper_consignee.ybcity,wt),a(at,()=>t.invoice.shipper_consignee.ybestate,Ot),a(at,()=>t.invoice.shipper_consignee.nacionality,null),a(K,M(Ge,{get when(){return t.invoice?.products?.length>0},get children(){var Je=mb(),Et=Je.firstChild,Wt=Et.nextSibling,Yt=Wt.firstChild,er=Yt.firstChild,kt=er.firstChild,Xt=kt.nextSibling,tr=Xt.nextSibling,Zt=tr.nextSibling,vt=Zt.nextSibling,ir=Yt.nextSibling;return a(Et,()=>e("invoices.products")),a(kt,()=>e("invoices.code")),a(Xt,()=>e("invoices.description")),a(tr,()=>e("invoices.qty")),a(Zt,()=>e("invoices.unitPrice")),a(vt,()=>e("invoices.total")),a(ir,M(Ht,{get each(){return t.invoice?.products},children:Tt=>(()=>{var Ir=yb(),or=Ir.firstChild,cr=or.nextSibling,_r=cr.nextSibling,Tr=_r.nextSibling,kr=Tr.nextSibling;return a(or,()=>Tt.product.code),a(cr,()=>Tt.product.label),a(_r,()=>Math.abs(Tt.qty)),a(Tr,()=>l(Tt.salePrice)),a(kr,()=>l(Math.abs(Tt.qty)*parseFloat(Tt.salePrice))),Se(lr=>{var Mt=Z,yn=Z,gn={...Z,"text-align":"center"},En={...Z,"text-align":"right"},Nr={...Z,"text-align":"right"};return lr.e=m(or,Mt,lr.e),lr.t=m(cr,yn,lr.t),lr.a=m(_r,gn,lr.a),lr.o=m(Tr,En,lr.o),lr.i=m(kr,Nr,lr.i),lr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Ir})()})),Se(Tt=>{var Ir=f,or=x,cr=se,_r=X,Tr=X,kr={...X,"text-align":"center"},lr={...X,"text-align":"right"},Mt={...X,"text-align":"right"};return Tt.e=m(Je,Ir,Tt.e),Tt.t=m(Et,or,Tt.t),Tt.a=m(Wt,cr,Tt.a),Tt.o=m(kt,_r,Tt.o),Tt.i=m(Xt,Tr,Tt.i),Tt.n=m(tr,kr,Tt.n),Tt.s=m(Zt,lr,Tt.s),Tt.h=m(vt,Mt,Tt.h),Tt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),Je}}),gr),a(K,M(Ge,{get when(){return t.invoice?.reservas?.length>0},get children(){var Je=mb(),Et=Je.firstChild,Wt=Et.nextSibling,Yt=Wt.firstChild,er=Yt.firstChild,kt=er.firstChild,Xt=kt.nextSibling,tr=Xt.nextSibling,Zt=tr.nextSibling,vt=Zt.nextSibling,ir=Yt.nextSibling;return a(Et,()=>e("invoices.reservations")),a(kt,()=>e("invoices.type")),a(Xt,()=>e("invoices.qty")),a(tr,()=>e("invoices.unitPrice")),a(Zt,()=>e("invoices.arancel")),a(vt,()=>e("invoices.total")),a(ir,M(Ht,{get each(){return t.invoice?.reservas},children:Tt=>(()=>{var Ir=yb(),or=Ir.firstChild,cr=or.nextSibling,_r=cr.nextSibling,Tr=_r.nextSibling,kr=Tr.nextSibling;return a(or,()=>Tt.type),a(cr,()=>Tt.qty),a(_r,()=>l(Tt.price)),a(Tr,()=>Tt.arancel||"-"),a(kr,()=>l(parseInt(Tt.qty)*parseFloat(Tt.price)+(Tt.arancel?parseFloat(Tt.arancel):0))),Se(lr=>{var Mt=Z,yn={...Z,"text-align":"center"},gn={...Z,"text-align":"right"},En={...Z,"text-align":"right"},Nr={...Z,"text-align":"right"};return lr.e=m(or,Mt,lr.e),lr.t=m(cr,yn,lr.t),lr.a=m(_r,gn,lr.a),lr.o=m(Tr,En,lr.o),lr.i=m(kr,Nr,lr.i),lr},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Ir})()})),Se(Tt=>{var Ir=f,or=x,cr=se,_r=X,Tr={...X,"text-align":"center"},kr={...X,"text-align":"right"},lr={...X,"text-align":"right"},Mt={...X,"text-align":"right"};return Tt.e=m(Je,Ir,Tt.e),Tt.t=m(Et,or,Tt.t),Tt.a=m(Wt,cr,Tt.a),Tt.o=m(kt,_r,Tt.o),Tt.i=m(Xt,Tr,Tt.i),Tt.n=m(tr,kr,Tt.n),Tt.s=m(Zt,lr,Tt.s),Tt.h=m(vt,Mt,Tt.h),Tt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),Je}}),gr),Be.style.setProperty("display","inline-block"),Be.style.setProperty("min-width","350px"),a(Be,M(Ge,{get when(){return t.invoice?.products?.length>0},get children(){var Je=Df(),Et=Je.firstChild,Wt=Et.firstChild,Yt=Et.nextSibling;return Je.style.setProperty("display","flex"),Je.style.setProperty("justify-content","space-between"),Je.style.setProperty("margin-bottom","0.5rem"),a(Et,()=>e("invoices.productsSubtotal"),Wt),a(Yt,()=>l(t?.parseData?.productSubtotal)),Je}}),Pt),a(Be,M(Ge,{get when(){return t.invoice?.reservas?.length>0},get children(){var Je=Df(),Et=Je.firstChild,Wt=Et.firstChild,Yt=Et.nextSibling;return Je.style.setProperty("display","flex"),Je.style.setProperty("justify-content","space-between"),Je.style.setProperty("margin-bottom","0.5rem"),a(Et,()=>e("invoices.reservationsSubtotal"),Wt),a(Yt,()=>l(t?.parseData?.reservaSubtotal)),Je}}),Pt),a(Be,M(Ge,{get when(){return t?.parseData?.subtotalBeforeTax},get children(){var Je=Df(),Et=Je.firstChild,Wt=Et.firstChild,Yt=Et.nextSibling;return Je.style.setProperty("display","flex"),Je.style.setProperty("justify-content","space-between"),Je.style.setProperty("margin-bottom","0.5rem"),a(Et,()=>e("common.subtotal"),Wt),a(Yt,()=>l(t?.parseData?.subtotalBeforeTax)),Je}}),Ct),a(Be,M(Ge,{get when(){return t?.parseData?.taxAmount},get children(){var Je=MR(),Et=Je.firstChild,Wt=Et.firstChild,Yt=Wt.nextSibling;Yt.nextSibling;var er=Et.nextSibling;return Je.style.setProperty("display","flex"),Je.style.setProperty("justify-content","space-between"),Je.style.setProperty("margin-bottom","0.5rem"),a(Et,()=>e("common.tax"),Wt),a(Et,()=>t?.parseData.paymentMethods?.taxPercent||7,Yt),a(er,()=>l(t?.parseData?.taxAmount)),Je}}),Ct),a(tt,()=>e("invoices.total"),ft),Vt.style.setProperty("color","var(--primary-color)"),a(Vt,()=>l(c().total)),it.addEventListener("mouseleave",Je=>Je.currentTarget.style.opacity="1"),it.addEventListener("mouseenter",Je=>Je.currentTarget.style.opacity="0.9"),it.$$click=_,a(it,()=>e("invoices.printInvoice"),null),ts(yt,"click",ER,!0),It.addEventListener("mouseleave",Je=>{Je.currentTarget.style.background="white",Je.currentTarget.style.color="var(--primary-color)"}),It.addEventListener("mouseenter",Je=>{Je.currentTarget.style.background="var(--primary-color)",Je.currentTarget.style.color="white"}),It.$$click=w,a(It,()=>e("invoices.exportPdf"),null),a(rr,M(Ge,{get when(){return pr.state?.profile?.isAdmin},get children(){var Je=FR();return Je.$$click=W,Je.addEventListener("mouseleave",Et=>Et.currentTarget.style.opacity="1"),Je.addEventListener("mouseenter",Et=>Et.currentTarget.style.opacity="0.9"),Se(Et=>m(Je,T,Et)),Je}}),null),a(Jt,`
        @media print {
          .invoice-display {
            box-shadow: none !important;
            padding: 0 !important;
          }
          
          ${E} {
            display: none !important;
          }
        }
      `),Se(Je=>{var Et=g,Wt=f,Yt=x,er=S,kt=P,Xt=$,tr=U,Zt=x,vt=S,ir=P,Tt=$,Ir=U,or={...$,"margin-top":"0.75rem"},cr=U,_r={...$,"margin-top":"0.75rem"},Tr=U,kr=P,lr=$,Mt={...$,"margin-top":"0.75rem"},yn=U,gn={...$,"margin-top":"0.75rem"},En=U,Nr={...f,"text-align":"right"},On={...re,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},bi={...re,display:"flex","justify-content":"space-between","padding-top":"0.75rem","border-top":"2px solid #dee2e6"},_i={...f,"text-align":"center",color:"#666","font-size":"0.875rem"},hr=E,Lr=T,jr={...T,background:"#28a745"},fn=j;return Je.e=m(I,Et,Je.e),Je.t=m(J,Wt,Je.t),Je.a=m(te,Yt,Je.a),Je.o=m(ee,er,Je.o),Je.i=m(ne,kt,Je.i),Je.n=m(G,Xt,Je.n),Je.s=m(ce,tr,Je.s),Je.h=m(z,Zt,Je.h),Je.r=m(de,vt,Je.r),Je.d=m(fe,ir,Je.d),Je.l=m(ue,Tt,Je.l),Je.u=m(ge,Ir,Je.u),Je.c=m(De,or,Je.c),Je.w=m(Te,cr,Je.w),Je.m=m($e,_r,Je.m),Je.f=m(Ie,Tr,Je.f),Je.y=m(Re,kr,Je.y),Je.g=m(Ke,lr,Je.g),Je.p=m(je,Mt,Je.p),Je.b=m(We,yn,Je.b),Je.T=m(Qe,gn,Je.T),Je.A=m(at,En,Je.A),Je.O=m(gr,Nr,Je.O),Je.I=m(Pt,On,Je.I),Je.S=m(Ct,bi,Je.S),Je.W=m(Rt,_i,Je.W),Je.C=m(rr,hr,Je.C),Je.B=m(it,Lr,Je.B),Je.v=m(yt,jr,Je.v),Je.k=m(It,fn,Je.k),Je},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0,B:void 0,v:void 0,k:void 0}),K})()};yr(["click"]);const hu={invoice:"",description:"",store:"",guide:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",phoneNumberS:"",cid:"",passport:"",address:""},products:[],reservas:[],packagesOrder:!1,shippingMethod:"",paymentMethods:{taxOnTotal:!1,taxPercent:0,exemptTaxOnCash:!1,cash:0,zelle:0,creditCard:0}},Yy="invoice_styled_form_draft",jR=()=>{try{const t=localStorage.getItem(Yy);if(t){const e=JSON.parse(t);return{...hu,...e,shipper_consignee:{...hu.shipper_consignee,...e.shipper_consignee||{}},paymentMethods:{...hu.paymentMethods,...e.paymentMethods||{}},products:e.products||[],reservas:e.reservas||[]}}}catch(t){console.warn("Failed to load styled invoice form from storage:",t)}return console.log("No saved data found, using default form data"),{...hu}},Ky=t=>{try{localStorage.setItem(Yy,JSON.stringify(t))}catch(e){console.warn("Failed to save styled invoice form to storage:",e)}},gb=()=>{try{localStorage.removeItem(Yy)}catch(t){console.warn("Failed to clear styled invoice form from storage:",t)}},[sl,Vo]=Ce(jR()),[v_,lo]=Ce(!1),[VR,uh]=Ce(null);let Mf=null;const gs=()=>{Mf&&clearTimeout(Mf),Mf=setTimeout(()=>{const t=sl();Ky(t),uh(new Date),console.log("Styled invoice form auto-saved at",new Date().toLocaleTimeString())},1e3)},Hr={formData:sl,get isDirty(){return v_()},get lastSaved(){return VR()},updateForm:t=>{Vo(e=>{const r={...e,...t};return lo(!0),gs(),r})},updateShipperConsignee:t=>{Vo(e=>{const r={...e,shipper_consignee:{...e.shipper_consignee,...t}};return lo(!0),gs(),r})},updatePaymentMethods:t=>{Vo(e=>{const r={...e,paymentMethods:{...e.paymentMethods,...t}};return lo(!0),gs(),r})},addProduct:t=>{Vo(e=>{const r={...e,products:[...e.products,t]};return lo(!0),gs(),r})},updateProduct:(t,e)=>{Vo(r=>{const n=[...r.products];n[t]={...n[t],...e};const i={...r,products:n};return lo(!0),gs(),i})},removeProduct:t=>{Vo(e=>{const r=e.products.filter((i,o)=>o!==t),n={...e,products:r};return lo(!0),gs(),n})},addReserva:t=>{Vo(e=>{const r={...e,reservas:[...e.reservas,t]};return lo(!0),gs(),r})},updateReserva:(t,e)=>{Vo(r=>{const n=[...r.reservas];n[t]={...n[t],...e};const i={...r,reservas:n};return lo(!0),gs(),i})},removeReserva:t=>{Vo(e=>{const r=e.reservas.filter((i,o)=>o!==t),n={...e,reservas:r};return lo(!0),gs(),n})},clearForm:()=>{Vo({...hu}),lo(!1),gb(),uh(null)},markCompleted:()=>{gb(),lo(!1),uh(null)},forceSave:()=>{Ky(sl()),uh(new Date),lo(!1)},hasData:()=>{const t=sl();return t.invoice!==""||t.description!==""||t.store!==""||t.shipper_consignee.name!==""||t.shipper_consignee.firstName!==""||t.shipper_consignee.cid!==""||t.products.length>0||t.reservas.length>0||t.paymentMethods.cash>0||t.paymentMethods.zelle>0||t.paymentMethods.creditCard>0},isValid:()=>{const t=sl();return t.invoice.trim()!==""&&t.shipper_consignee.firstName.trim()!==""&&t.shipper_consignee.lastName.trim()!==""&&t.shipper_consignee.cid.trim()!==""&&(t.products.length>0||t.reservas.length>0)},getFormData:()=>sl()};typeof window<"u"&&window.addEventListener("beforeunload",t=>{if(v_()&&(Ky(sl()),Hr.hasData()))return t.preventDefault(),t.returnValue="You have unsaved changes in your invoice. Are you sure you want to leave?",t.returnValue});var qR=he("<div>🔄 "),zR=he("<div>⚠️ <div>"),UR=he("<div><span>🔄</span><span>"),Xd=he("<div>"),HR=he("<div><div><div><input type=text autocomplete=off>"),GR=he("<button type=button>+"),WR=he("<div><div></div><div>"),YR=he("<div><div><div><div></div><div><span>: </span><span>•</span><span></span><span>•</span><span></span></div></div><div><div> </div><div></div><div>: "),KR=he("<span>"),JR=he("<span>⚠️ ");const QR=t=>{const{t:e}=sr(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),[c,u]=Ce(!1),[h,y]=Ce(null),[g,f]=Ce([]),[x,S]=Ce(null),P=t.searchDelay||300,$=t.maxResults||40,U=Dt(()=>{if(!t.value)return null;const J=g().find(te=>te.id===t.value);return J||ct.getProductById(t.value)}),se=async J=>{if(!J.trim()){f([]);return}u(!0),y(null);const te=ct.getActiveProducts().filter(ee=>ee.name.toLowerCase().includes(J.toLowerCase())||ee.sku.toLowerCase().includes(J.toLowerCase())||ee?.UPC?.toLowerCase().includes(J?.toLowerCase())||ee.category.toLowerCase().includes(J.toLowerCase())).slice(0,$);f(te),u(!1)},X=Dt(()=>i().toLowerCase()?g():ct.getActiveProducts().slice(0,10)),Z=()=>{n(!0),o(""),l(-1),y(null),i()||f(ct.getActiveProducts().slice(0,10))},re=J=>{const ee=J.target.value;o(ee),n(!0),l(-1),y(null),x()&&clearTimeout(x());const ne=setTimeout(()=>{se(ee)},P);S(ne)},E=J=>{t.onChange(J.id),n(!1),o(""),l(-1),y(null),x()&&(clearTimeout(x()),S(null))},C=J=>{const te=X();switch(J.key){case"ArrowDown":J.preventDefault(),l(ee=>Math.min(ee+1,te.length-1));break;case"ArrowUp":J.preventDefault(),l(ee=>Math.max(ee-1,-1));break;case"Enter":J.preventDefault(),s()>=0&&te[s()]&&E(te[s()]);break;case"Escape":n(!1),o(""),l(-1),y(null),x()&&(clearTimeout(x()),S(null));break}},T=J=>{setTimeout(()=>{n(!1),o(""),l(-1),x()&&(clearTimeout(x()),S(null))},150)},j=J=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(J),b=J=>ct.stockLevels.filter(te=>te.productId===J).reduce((te,ee)=>te+ee.quantity,0);Sn(()=>()=>{x()&&clearTimeout(x())});const w={position:"relative",width:"100%",...t.style},_={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},W={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"400px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},K=J=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:J?"var(--strip-color)":"transparent",color:J?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),k={display:"flex","justify-content":"space-between","align-items":"center"},R={flex:"1"},Y={"font-weight":"500","margin-bottom":"0.25rem"},q={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex",gap:"0.5rem","flex-wrap":"wrap"},O={"text-align":"right","font-size":"0.875rem"},le={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},N={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"},D={padding:"1rem","text-align":"center",color:"#d32f2f",background:"#ffebee","border-radius":"var(--border-radius-sm)",margin:"0.5rem","font-size":"0.875rem"},V=()=>r()&&i()?i():U()?`${U().name} (${U().sku})`:"",I={display:"flex","align-items":"stretch",width:"100%"},F={padding:"0.75rem",border:"1px solid var(--border-color)","border-left":"none","border-radius":"0 var(--border-radius-sm) var(--border-radius-sm) 0",background:"var(--surface-color)",cursor:"pointer",color:"var(--primary-color)","font-weight":"600","font-size":"1rem",transition:"all 0.2s ease","min-width":"40px",display:"flex","align-items":"center","justify-content":"center"},Q={..._,"border-radius":t.onAddNew?"var(--border-radius-sm) 0 0 var(--border-radius-sm)":"var(--border-radius-sm)","border-right":t.onAddNew?"none":"1px solid var(--border-color)"},H={position:"absolute",right:t.onAddNew?"50px":"0.75rem",top:"50%",transform:"translateY(-50%)","font-size":"0.875rem",color:"var(--text-muted)","pointer-events":"none"};return(()=>{var J=HR(),te=J.firstChild,ee=te.firstChild,ne=ee.firstChild;return m(te,I),ee.style.setProperty("position","relative"),ee.style.setProperty("flex","1"),ne.addEventListener("blur",T),ne.$$keydown=C,ne.$$click=Z,ne.$$input=re,a(ee,M(Ge,{get when(){return c()},get children(){var G=qR();return G.firstChild,a(G,()=>e("common.searching","Searching..."),null),Se(ce=>m(G,H,ce)),G}}),null),a(te,(()=>{var G=Ee(()=>!!t.onAddNew);return()=>G()&&(()=>{var ce=GR();return ce.addEventListener("mouseleave",oe=>{oe.currentTarget.style.background="var(--surface-color)",oe.currentTarget.style.color="var(--primary-color)"}),ce.addEventListener("mouseenter",oe=>{oe.currentTarget.style.background="var(--primary-color)",oe.currentTarget.style.color="white"}),ts(ce,"click",t.onAddNew,!0),m(ce,F),Se(()=>nr(ce,"title",e("inventory.addProduct","Add new product"))),ce})()})(),null),a(J,M(Ge,{get when(){return r()},get children(){var G=Xd();return a(G,M(Ge,{get when(){return h()},get children(){var ce=zR(),oe=ce.firstChild,z=oe.nextSibling;return m(ce,D),a(ce,h,z),z.style.setProperty("margin-top","0.5rem"),z.style.setProperty("font-size","0.75rem"),a(z,()=>e("inventory.searchFallback","Showing local results")),ce}}),null),a(G,M(Ge,{get when(){return c()},get children(){var ce=UR(),oe=ce.firstChild,z=oe.nextSibling;return m(ce,N),a(z,()=>e("common.searching","Searching products...")),ce}}),null),a(G,M(Ge,{get when(){return Ee(()=>!c())()&&X().length>0},get fallback(){return Ee(()=>!c())()&&(()=>{var ce=Xd();return m(ce,le),a(ce,(()=>{var oe=Ee(()=>!!i());return()=>oe()?(()=>{var z=WR(),de=z.firstChild,fe=de.nextSibling;return a(de,()=>e("inventory.noProductsFound","No products found matching your search.")),fe.style.setProperty("margin-top","0.5rem"),fe.style.setProperty("font-size","0.75rem"),a(fe,()=>e("inventory.tryDifferentTerm","Try a different search term or check spelling.")),z})():e("inventory.noProductsAvailable","No products available.")})()),ce})()},get children(){return[M(Ht,{get each(){return X()},children:(ce,oe)=>{const z=b(ce.id),de=z<=ce.minStockLevel;return(()=>{var fe=YR(),ue=fe.firstChild,ge=ue.firstChild,xe=ge.firstChild,pe=xe.nextSibling,_e=pe.firstChild,Le=_e.firstChild,De=_e.nextSibling,Te=De.nextSibling,$e=Te.nextSibling,Ie=$e.nextSibling,Re=ge.nextSibling,Ke=Re.firstChild,je=Ke.firstChild,We=Ke.nextSibling,Qe=We.nextSibling,at=Qe.firstChild;return fe.addEventListener("mouseenter",()=>l(oe())),fe.$$click=()=>E(ce),m(ue,k),m(ge,R),m(xe,Y),a(xe,()=>ce.name,null),a(xe,(()=>{var nt=Ee(()=>!!i());return()=>nt()&&(()=>{var Ye=KR();return Ye.style.setProperty("margin-left","0.5rem"),Ye.style.setProperty("font-size","0.75rem"),Ye.style.setProperty("color","var(--primary-color)"),Ye.style.setProperty("font-weight","normal"),a(Ye,()=>g().includes(ce)?"🌐 API":"💾 Local"),Ye})()})(),null),m(pe,q),a(_e,()=>e("inventory.sku","SKU"),Le),a(_e,()=>ce.sku,null),a(Te,()=>ce.category),a(Ie,()=>j(ce.unitCost)),a(ge,(()=>{var nt=Ee(()=>!!ce.description);return()=>nt()&&(()=>{var Ye=Xd();return Ye.style.setProperty("font-size","0.75rem"),Ye.style.setProperty("color","var(--text-muted)"),Ye.style.setProperty("margin-top","0.25rem"),Ye.style.setProperty("font-style","italic"),a(Ye,(()=>{var ht=Ee(()=>ce.description.length>60);return()=>ht()?`${ce.description.substring(0,60)}...`:ce.description})()),Ye})()})(),null),m(Re,O),Ke.style.setProperty("font-weight","600"),(de?"#f44336":"var(--text-primary)")!=null?Ke.style.setProperty("color",de?"#f44336":"var(--text-primary)"):Ke.style.removeProperty("color"),a(Ke,z,je),a(Ke,()=>ce.unitOfMeasure,null),We.style.setProperty("color","var(--text-muted)"),a(We,()=>de?(()=>{var nt=JR();return nt.firstChild,nt.style.setProperty("color","#f44336"),a(nt,()=>e("inventory.lowStock","Low Stock"),null),nt})():e("inventory.inStock","In Stock")),Qe.style.setProperty("font-size","0.75rem"),Qe.style.setProperty("color","var(--text-muted)"),Qe.style.setProperty("margin-top","0.25rem"),a(Qe,()=>e("inventory.min","Min"),at),a(Qe,()=>ce.minStockLevel,null),Se(nt=>m(fe,K(oe()===s()),nt)),fe})()}}),Ee(()=>Ee(()=>X().length===$)()&&(()=>{var ce=Xd();return ce.style.setProperty("padding","0.5rem"),ce.style.setProperty("text-align","center"),ce.style.setProperty("font-size","0.75rem"),ce.style.setProperty("color","var(--text-muted)"),ce.style.setProperty("border-top","1px solid var(--border-color)"),ce.style.setProperty("font-style","italic"),a(ce,()=>e("inventory.showingTopResults","Showing top {{count}} results",{count:$})),ce})())]}}),null),Se(ce=>m(G,W,ce)),G}}),null),Se(G=>{var ce=w,oe=Q,z=t.placeholder||e("inventory.searchProducts","Search products by name, SKU, or category..."),de=t.disabled,fe=t.required;return G.e=m(J,ce,G.e),G.t=m(ne,oe,G.t),z!==G.a&&nr(ne,"placeholder",G.a=z),de!==G.o&&(ne.disabled=G.o=de),fe!==G.i&&(ne.required=G.i=fe),G},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>ne.value=V()),J})()};yr(["input","click","keydown"]);var XR=he("<label>"),Ff=he("<div>"),ZR=he("<div><span>🔄</span><span>"),eD=he("<div><input type=text autocomplete=off>"),tD=he("<span>📞 "),rD=he("<span>🆔 "),nD=he("<span>📧 "),iD=he("<div><div><div><div>👤 </div><div>");const oD=t=>{const{t:e}=sr(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),[c,u]=Ce(!1),[h,y]=Ce([]),[g,f]=Ce(null),x=async R=>{if(!R.trim()||R.trim().length<6){y([]);return}try{u(!0);const Y=await gi.getConsigee(R);console.log(Y);const q=Object.values(Y).map(O=>({id:O.consigneeId,firstName:O.firstName+(O.middleName?" "+O.middleName:""),fullName:O.firstName+(O.middleName?" "+O.middleName:"")+" "+O.lastName+" "+O.lastName2,lastName:O.lastName+" "+O.lastName2,cid:O.cid,phoneNumber:O.phoneNumber,ybbetwen1:O.ybbetwen1,ybcity:O.ybcity,ybestate:O.ybestate,ybreparto:O.ybreparto,ybstreet:O.ybstreet,ybstreetNo:O.ybstreetNo,address:`Calle ${O.ybstreet}${O.ybstreetNo?" # "+O.ybstreetNo:""}${O.ybbetwen1?" / "+O.ybbetwen1:""}${O.ybbetwen2?" y "+O.ybbetwen2:""}${O.ybreparto?", Rpto "+O.ybreparto:""}, ${O.ybcity?O.ybcity:""}, ${O.ybestate?O.ybestate:""}`}));y(q)}catch(Y){console.warn("API search failed, falling back to local search:",Y)}finally{u(!1)}},S=()=>{n(!0),o(""),l(-1),i()||x("")},P=R=>{const q=R.target.value;o(q),n(!0),l(-1),g()&&clearTimeout(g());const O=setTimeout(()=>{x(q)},600);f(O)},$=R=>{t.onChange(R),n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},U=R=>{const Y=h();switch(R.key){case"ArrowDown":R.preventDefault(),l(q=>Math.min(q+1,Y.length-1));break;case"ArrowUp":R.preventDefault(),l(q=>Math.max(q-1,-1));break;case"Enter":R.preventDefault(),s()>=0&&Y[s()]&&$(Y[s()]);break;case"Escape":n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null));break}},se=R=>{setTimeout(()=>{n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},150)},X=()=>r()&&i()?i():t.value?t.value.cid:"";Sn(()=>(x(""),()=>{g()&&clearTimeout(g())}));const Z={position:"relative",width:"100%",...t.style},re={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},E={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},C={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},T={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},j=R=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:R?"var(--strip-color)":"transparent",color:R?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),b={display:"flex","justify-content":"space-between","align-items":"flex-start"},w={flex:"1"},_={"font-weight":"500","margin-bottom":"0.25rem"},W={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},K={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},k={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"};return(()=>{var R=eD(),Y=R.firstChild;return a(R,M(Ge,{get when(){return t.label},get children(){var q=XR();return m(q,re),a(q,()=>t.label),q}}),Y),a(R,M(Ge,{get when(){return t.description},get children(){var q=Ff();return m(q,E),a(q,()=>t.description),q}}),Y),Y.addEventListener("blur",se),Y.$$keydown=U,Y.$$click=S,Y.$$input=P,a(R,M(Ge,{get when(){return r()},get children(){var q=Ff();return a(q,M(Ge,{get when(){return c()},get children(){var O=ZR(),le=O.firstChild,N=le.nextSibling;return m(O,k),a(N,()=>e("common.searching","Buscando clientes...")),O}}),null),a(q,M(Ge,{get when(){return Ee(()=>!c())()&&h().length>0},get fallback(){return Ee(()=>!c())()&&(()=>{var O=Ff();return m(O,K),a(O,(()=>{var le=Ee(()=>!!i());return()=>le()?e("customer.noCustomersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noCustomersAvailable","No se encontraron clientes previos. Se creará un nuevo cliente.")})()),O})()},get children(){return M(Ht,{get each(){return h()},children:(O,le)=>(()=>{var N=iD(),D=N.firstChild,V=D.firstChild,I=V.firstChild;I.firstChild;var F=I.nextSibling;return N.addEventListener("mouseenter",()=>l(le())),N.$$click=()=>$(O),m(D,b),m(V,w),m(I,_),a(I,()=>O.fullName,null),m(F,W),a(F,M(Ge,{get when(){return O.phoneNumber},get children(){var Q=tD();return Q.firstChild,a(Q,()=>O.phoneNumber,null),Q}}),null),a(F,M(Ge,{get when(){return O.cid},get children(){var Q=rD();return Q.firstChild,a(Q,()=>O.cid,null),Q}}),null),a(F,M(Ge,{get when(){return O.email},get children(){var Q=nD();return Q.firstChild,a(Q,()=>O.email,null),Q}}),null),Se(Q=>m(N,j(le()===s()),Q)),N})()})}}),null),Se(O=>m(q,T,O)),q}}),null),Se(q=>{var O=Z,le=C,N=t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, teléfono, ID..."),D=t.disabled,V=t.required;return q.e=m(R,O,q.e),q.t=m(Y,le,q.t),N!==q.a&&nr(Y,"placeholder",q.a=N),D!==q.o&&(Y.disabled=q.o=D),V!==q.i&&(Y.required=q.i=V),q},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>Y.value=X()),R})()};yr(["input","click","keydown"]);var sD=he("<label>"),Of=he("<div>"),aD=he("<div><span>🔄</span><span>"),lD=he("<div><input type=text autocomplete=off>"),cD=he("<span>📞 "),uD=he("<div><div><div><div>👤 </div><div>");const dD=t=>{const{t:e}=sr(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(-1),[c,u]=Ce(!1),[h,y]=Ce([]),[g,f]=Ce(null),x=600,S=async Y=>{if(!Y.trim()||Y.trim().length<6){y([]);return}try{u(!0);const q=await gi.getShipper(Y),O=Object.values(q).map(le=>({id:le.shipperId,name:le.name,dob:le.dob,phoneNumberS:le.phoneNumber}));y(O)}catch(q){console.warn("API search failed, falling back to local search:",q)}finally{u(!1)}},P=Y=>{const O=Y.target.value;o(O),n(!0),l(-1),g()&&clearTimeout(g());const le=setTimeout(()=>{S(O)},x);f(le)},$=()=>{n(!0),o(""),l(-1),i()||S("")},U=Y=>{t.onChange(Y),n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},se=Y=>{const q=h();switch(Y.key){case"ArrowDown":Y.preventDefault(),l(O=>Math.min(O+1,q.length-1));break;case"ArrowUp":Y.preventDefault(),l(O=>Math.max(O-1,-1));break;case"Enter":Y.preventDefault(),s()>=0&&q[s()]&&U(q[s()]);break;case"Escape":n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null));break}},X=Y=>{setTimeout(()=>{n(!1),o(""),l(-1),g()&&(clearTimeout(g()),f(null))},150)},Z=()=>r()&&i()?i():t.value?t.value.name:"";Sn(()=>(S(""),()=>{g()&&clearTimeout(g())}));const re={position:"relative",width:"100%",...t.style},E={display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},C={"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","font-style":"italic"},T={width:"100%",padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--surface-color)",cursor:t.disabled?"not-allowed":"text",opacity:t.disabled?"0.6":"1"},j={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},b=Y=>({padding:"0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:Y?"var(--strip-color)":"transparent",color:Y?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease"}),w={display:"flex","justify-content":"space-between","align-items":"flex-start"},_={flex:"1"},W={"font-weight":"500","margin-bottom":"0.25rem"},K={"font-size":"0.875rem",color:"var(--text-muted)",display:"flex","flex-direction":"column",gap:"0.125rem"},k={padding:"1rem","text-align":"center",color:"var(--text-muted)","font-style":"italic"},R={padding:"1rem","text-align":"center",color:"var(--text-muted)",display:"flex","align-items":"center","justify-content":"center",gap:"0.5rem"};return(()=>{var Y=lD(),q=Y.firstChild;return a(Y,M(Ge,{get when(){return t.label},get children(){var O=sD();return m(O,E),a(O,()=>t.label),O}}),q),a(Y,M(Ge,{get when(){return t.description},get children(){var O=Of();return m(O,C),a(O,()=>t.description),O}}),q),q.addEventListener("blur",X),q.$$keydown=se,q.$$click=$,q.$$input=P,a(Y,M(Ge,{get when(){return r()},get children(){var O=Of();return a(O,M(Ge,{get when(){return c()},get children(){var le=aD(),N=le.firstChild,D=N.nextSibling;return m(le,R),a(D,()=>e("common.searching","Buscando clientes...")),le}}),null),a(O,M(Ge,{get when(){return Ee(()=>!c())()&&h().length>0},get fallback(){return Ee(()=>!c())()&&(()=>{var le=Of();return m(le,k),a(le,(()=>{var N=Ee(()=>!!i());return()=>N()?e("customer.noShippersFound","No se encontraron clientes. Puede crear un nuevo cliente llenando el formulario."):e("customer.noShippersAvailable","No se encontraron clientes previos. Se creará un nuevo cliente.")})()),le})()},get children(){return M(Ht,{get each(){return h()},children:(le,N)=>(()=>{var D=uD(),V=D.firstChild,I=V.firstChild,F=I.firstChild;F.firstChild;var Q=F.nextSibling;return D.addEventListener("mouseenter",()=>l(N())),D.$$click=()=>U(le),m(V,w),m(I,_),m(F,W),a(F,()=>le.name,null),m(Q,K),a(Q,M(Ge,{get when(){return le.phoneNumberS},get children(){var H=cD();return H.firstChild,a(H,()=>le.phoneNumberS,null),H}})),Se(H=>m(D,b(N()===s()),H)),D})()})}}),null),Se(le=>m(O,j,le)),O}}),null),Se(O=>{var le=re,N=T,D=t.placeholder||e("customer.searchPlaceholder","Buscar clientes por nombre, teléfono, ID..."),V=t.disabled,I=t.required;return O.e=m(Y,le,O.e),O.t=m(q,N,O.t),D!==O.a&&nr(q,"placeholder",O.a=D),V!==O.o&&(q.disabled=O.o=V),I!==O.i&&(q.required=O.i=I),O},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>q.value=Z()),Y})()};yr(["input","click","keydown"]);var hD=he("<div>⚠️ "),Yh=he("<div>"),pD=he('<div><h3>👤 Información del Cliente</h3><div></div><div><div><label>Nombre del Cliente/Empresa *</label><input type=text placeholder="ej., Juan Pérez o Empresa ABC"required></div><div><label>Número de Teléfono Principal</label><input type=tel placeholder="ej., +53-5-123-4567">'),fD=he('<div><h3>👤 Información del Destinatario</h3><div></div><div><label>Primer Nombre</label><input type=text placeholder="ej., Juan"></div><div><label>Apellido</label><input type=text placeholder="ej., Pérez"></div><div><label>Número de Identificación</label><input type=text placeholder="ej., 12345678901 o A1234567"></div><div><label>Número de Pasaporte</label><input type=text placeholder="ej., AB1234567"></div><div><label>Número de Teléfono Principal</label><input type=tel placeholder="ej., +53-5-123-4567"></div><div><label>Dirección de Entrega/Facturación</label><textarea placeholder="ej., Calle 23 #456, Apto 4B, Vedado, La Habana, 10400">'),vb=he("<div><strong>Subtotal: $"),mD=he("<div><div><span>🎫 Reservas y Servicios</span><button>➕ Agregar Servicio/Reserva"),yD=he("<div><div><span>📦 Productos y Artículos</span></div><div><label>Agregar Productos a la Factura"),gD=he("<div><div>Vista previa del cálculo:</div><div>Subtotal: $</div><div>• Del Subtotal: $<!>(Total: $<!>)</div><div>• Del Total: $<!>(Total: $<!>)"),vD=he("<div><div>💰 Beneficio por Pago en Efectivo:</div><div>Efectivo: $<!> (<!>% del pago)</div><div>Ahorro en impuestos: $</div><div>Impuesto original: $<!> → Impuesto final: $"),bD=he("<div><label><input type=checkbox><span>💵 Exención de Impuesto por Pago en Efectivo</span></label><div>Los pagos en efectivo estarán exentos de impuestos. Mientras mayor sea el porcentaje pagado en efectivo, mayor será la exención."),_D=he("<div><div><label>Impuesto (%)</label><div>Porcentaje de impuesto. Puede aplicarse sobre el subtotal o como porcentaje del total final.</div><input type=number placeholder=0 min=0 max=99 step=0.01><div><div><label><input type=radio name=taxMethod><span>Del Subtotal (tradicional)</span></label><div>Impuesto = Subtotal × <!>%</div><label><input type=radio name=taxMethod><span>Del Total Final</span></label><div>El impuesto representa el <!>% del total final"),SD=he("<span>💰 Sin impuesto"),PD=he('<div><div><span>💳 Métodos de Pago</span></div><div>Distribuya el pago total entre los diferentes métodos de pago disponibles.</div><div><button type=button>💵 Todo Efectivo</button><button type=button title="Pagar todo por Zelle">📱 Todo Zelle</button><button type=button title="Pagar todo con tarjeta">💳 Todo Tarjeta</button><button type=button title="Limpiar todos los pagos">🗑️ Limpiar</button></div><div><div><label>💵 Efectivo</label><input type=text placeholder=0.00 min=0 step=0.01></div><div><label>📱 Zelle</label><input type=text placeholder=0.00 min=0 step=0.01></div></div><div><label>💳 Tarjeta de Crédito</label><input type=text placeholder=0.00 min=0 step=0.01></div><div><div><div>Total de Pagos: <strong>$</strong></div><div>Balance: <strong>$</strong></div></div><div><div>Total a Pagar: <strong>$</strong></div><div>'),wD=he("<span>(Ahorro: $<!>)"),xD=he("<div>Impuesto (<!>% <!>): $"),AD=he("<div>Envío: "),CD=he("<div><div><div>Productos: $</div><div>Reservas: $</div><div>Subtotal: $</div><div>Total: $"),ID=he("<span><span></span>Auto-guardando cambios..."),$D=he("<span><span></span>Guardado: "),ED=he("<button>Limpiar Formulario"),TD=he("<div><div>"),kD=he("<button>"),ND=he("<div><button></button><button>🆕 Nueva Factura"),LD=he('<div><h2>📄 Crear Nueva Factura</h2><div><div><div><h3>📋 Información de Factura</h3><div><div><label>Número de Factura *</label><input type=text></div><div><label>Ubicación de Tienda *</label></div></div><div><div><label>Método de Envío</label><div>Seleccione el método de transporte para esta orden.</div><select><option value>Seleccionar método...</option><option value=AEREO>✈️ Aéreo (Avión)</option><option value=SEA>🚢 Marítimo (Barco)</option></select></div><div><label>fecha</label><div>Seleccione una fecha si es diferente al dia de hoy.</div><input type=date></div><div><label>No de Guia</label><select><option value=all></option></select></div></div><div><label>Descripción de Factura</label><textarea placeholder="ej., Venta regular, pedido mayorista, descuento especial aplicado..."></textarea></div><label><input type=checkbox><div><span>Orden de Paquete/Envío</span><div>Marque esto si esta factura incluye servicios de envío o manejo de paquetes.</div></div></label></div></div><div>'),RD=he("<option>"),bb=he("<span> ($<!>)"),DD=he("<div>(<!>×<!>+<!>)"),MD=he("<div><div><button>×</button></div><div><div><label>Cant (lbs)</label></div><div><label>Precio</label></div><div><label>Arancel</label></div><div>$"),FD=he("<div><div><div><div></div><div></div></div><button>×</button></div><div><div>$"),OD=he("<input step=0.01>"),BD=he("<div><div><input type=text autocomplete=off><div>");const _b=["👕 Ropa","👞 Zapatos","🌀 Ventilador","🏠 Útiles del Hogar","📺 TV","📱 Teléfono Móvil","💻 Computadora/Laptop","🎧 Audífonos","⌚ Reloj","💍 Joyería","🧴 Productos de Belleza","💊 Medicamentos","🍫 Alimentos","🧸 Juguetes","📚 Libros","🎮 Videojuegos","🔧 Herramientas","🚗 Repuestos de Auto","🏃 Artículos Deportivos","🎵 Instrumentos Musicales","🖨️ Electrónicos","🧳 Maletas","🕶️ Lentes","🔌 Cables y Accesorios","🏥 Equipos Médicos","🎨 Materiales de Arte","📷 Cámaras","🔋 Baterías","🧼 Productos de Limpieza","🛏️ Artículos para el Hogar","Transportacion","Cajas","Servicio de Rapeado"],jD={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},st={container:{padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)"},header:{"font-size":"1.5rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"1.5rem"},grid:{display:"grid","grid-template-columns":"repeat(auto-fit, minmax(350px, 1fr))",gap:"1.5rem"},section:{background:"var(--background-color)",padding:"1.25rem","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)"},sectionTitle:{"font-size":"1.125rem","font-weight":"600",color:"var(--text-primary)","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},formGroup:{"margin-bottom":"1rem"},label:{display:"block","font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)","margin-bottom":"0.25rem"},fieldDescription:{"font-size":"0.75rem",color:"var(--text-muted)","margin-bottom":"0.5rem","line-height":"1.4","font-style":"italic"},input:{width:"100%",padding:"0.625rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",background:"var(--surface-color)",transition:"border-color 0.2s",outline:"none"},textarea:{width:"100%",padding:"0.625rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"0.875rem",background:"var(--surface-color)",resize:"vertical","min-height":"60px"},button:{padding:"0.625rem 1.25rem",border:"none","border-radius":"var(--border-radius-sm)","font-size":"0.875rem","font-weight":"500",cursor:"pointer",transition:"all 0.2s",display:"inline-flex","align-items":"center",gap:"0.5rem"},primaryButton:{background:"var(--primary-color)",color:"white"},secondaryButton:{background:"var(--secondary-color)",color:"white"},successButton:{background:"#4CAF50",color:"white"},alert:{padding:"0.75rem 1rem","border-radius":"var(--border-radius-sm)","margin-bottom":"1rem","font-size":"0.875rem",display:"flex","align-items":"center",gap:"0.5rem"},errorAlert:{background:"#ffebee",border:"1px solid #ffcdd2",color:"#d32f2f"},successAlert:{background:"#e8f5e9",border:"1px solid #c8e6c9",color:"#2e7d32"},productWrapItem:{padding:"0.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius-sm)",border:"1px solid var(--border-color)","margin-bottom":"0.5rem"},productItem:{display:"flex","align-items":"center",gap:"0.5rem",padding:"0.5rem","margin-bottom":"0.5rem"},smallInput:{width:"70px",padding:"0.375rem 0.5rem","font-size":"0.8125rem"},removeButton:{background:"none",border:"none",color:"#f44336",cursor:"pointer","font-size":"1.25rem",padding:"0.25rem"},totalSection:{padding:"1rem","border-radius":"var(--border-radius-sm)","text-align":"right"},gridTwo:{display:"grid","grid-template-columns":"1fr 1fr",gap:"1rem"}},VD=()=>{const{t}=sr(),e=Hr.formData,r=G=>Hr.updateForm(G),[n,i]=Ce(null),[o,s]=Ce(""),[l,c]=Ce(""),[u,h]=Ce(null);Sn(()=>{console.log("Styled invoice form mounted, loaded data:",e()),Hr.hasData()&&(P("Form data restored from previous session"),setTimeout(()=>P(""),3e3))});const[y,g]=Ce(!1),[f,x]=Ce(""),[S,P]=Ce(""),[$,U]=Ce(""),[se,X]=Ce(!1),Z=G=>{if(!G)return"";const ce=ct.getLocationById(G),oe=ce?.code||ce?.name?.substring(0,3).toUpperCase()||"INV",de=new Date().toISOString().slice(0,10).replace(/-/g,"");return`${bP(6)}-${oe}-${de}`};yi(()=>{const G=o();if(G&&!e().invoice.trim()){const ce=Z(G);c(ce),r({invoice:ce})}}),yi(()=>{const G=n();G&&Hr.updateShipperConsignee({name:G.name,firstName:G.firstName||"",lastName:G.lastName||"",phoneNumber:G.phoneNumber||"",cid:G.cid||"",passport:G.passport||"",address:G.address||""})}),yi(()=>{});const re=G=>{const ce=ct.getProductById(G);if(!ce)return;const oe={id:Date.now().toString(),product:{id:ce.id,code:ce.sku||"",label:ce.name||"",price:ce.unitCost||0},qty:1,salePrice:ce.unitCost||0,total:ce.unitCost||0};Hr.addProduct(oe)},E=G=>{s(G),r({store:G})},C=G=>{i(ce=>({...ce,...G}))},T=G=>{h({name:G?.name}),i(ce=>({...ce,phoneNumberS:G?.phoneNumberS,name:G?.name,dob:G?.dob}))},j=(G,ce,oe)=>{const z=e().products,de=z.findIndex(fe=>fe.id===G);if(de!==-1){const fe={...z[de],[ce]:oe};fe.total=fe.qty*fe.salePrice,Hr.updateProduct(de,fe)}},b=G=>{const ce=e().products.findIndex(oe=>oe.id===G);ce!==-1&&Hr.removeProduct(ce)},w=()=>{const G={id:Date.now().toString(),type:"",qty:1,price:0,arancel:0,total:0};Hr.addReserva(G)},_=(G,ce,oe)=>{const z=e().reservas,de=z.findIndex(fe=>fe.id===G);if(de!==-1){const fe={...z[de],[ce]:oe};(ce==="qty"||ce==="price"||ce==="arancel")&&(fe.total=Number(fe.qty)*Number(fe.price)+Number(fe.arancel)),Hr.updateReserva(de,fe)}},W=G=>{const ce=e().reservas.findIndex(oe=>oe.id===G);ce!==-1&&Hr.removeReserva(ce)},K=()=>e().products.reduce((G,ce)=>G+ce.total,0),k=()=>e().reservas.reduce((G,ce)=>G+ce.total,0),R=()=>K()+k(),Y=()=>{if(e()?.paymentMethods.taxPercent===0)return 0;if(e()?.paymentMethods.exemptTaxOnCash){const G=le()>0?e().paymentMethods.cash/le():0,ce=Math.min(G,1);let oe;return e()?.paymentMethods.taxOnTotal?oe=R()/(1-e()?.paymentMethods.taxPercent/100)-R():oe=R()*(e()?.paymentMethods.taxPercent/100),oe*(1-ce)}return e()?.paymentMethods.taxOnTotal?R()/(1-e()?.paymentMethods?.taxPercent/100)-R():R()*(e()?.paymentMethods?.taxPercent/100)},q=()=>{if(!e()?.paymentMethods.exemptTaxOnCash||e()?.paymentMethods.taxPercent===0)return 0;const G=le()>0?e().paymentMethods.cash/le():0,ce=Math.min(G,1);let oe;return e()?.paymentMethods.taxOnTotal?oe=R()/(1-e()?.paymentMethods?.taxPercent/100)-R():oe=R()*(e()?.paymentMethods?.taxPercent/100),oe*ce},O=()=>R()+Y(),le=()=>{const G=e().paymentMethods;return G.cash+G.zelle+G.creditCard},N=()=>O()-le(),D=(G,ce)=>{Hr.updatePaymentMethods({[G]:ce})},V=(G,ce)=>{Hr.updatePaymentMethods({[G]:ce})},I=G=>{const ce=O();Hr.updatePaymentMethods({cash:G==="cash"?ce:0,zelle:G==="zelle"?ce:0,creditCard:G==="creditCard"?ce:0})},F=()=>{Hr.updatePaymentMethods({cash:0,zelle:0,creditCard:0})},Q=async()=>{g(!0),x(""),P("");try{if(!e().invoice.trim())throw new Error("Número de factura es requerido");if(!e().shipper_consignee.name.trim())throw new Error("Nombre del cliente es requerido");if(e().products.length===0&&e().reservas.length===0)throw new Error("Al menos un producto o reserva es requerido");if(Math.round(N())>.01)throw new Error(`El total de pagos (${le().toFixed()}) no coincide con el total de la factura (${O().toFixed()})`);const G={...e(),type:"SALES",ssg_inventory_key:`INVOICE-${Date.now()}`,ssg_sorder_key:`SO-${Date.now()}`,createDate:e().createDate||Date.now(),businessId:"YB100423253156428",isCompleted:!0,productSubtotal:K(),reservaSubtotal:k(),subtotalBeforeTax:R(),taxAmount:Y(),taxSavings:q(),total:O(),shippingMethod:e().shippingMethod,taxCalculationMethod:e()?.paymentMethods.taxOnTotal?"total":"subtotal",cashPaymentRatio:le()>0?e().paymentMethods.cash/le():0,paymentMethods:e().paymentMethods};console.log("createInvoice",JSON.stringify(G,null,4));const ce=await gi.addInventory(G);gi.addInvoice(ce),U(ce.data),P("✅ Invoice created successfully! You can now generate a PDF."),Hr.markCompleted(),J()}catch(G){x(G.message||"Error creating invoice")}finally{g(!1)}},H=async()=>{if($()){X(!0),x("");try{const{generateEnhancedInvoicePDF:G}=await Oi(async()=>{const{generateEnhancedInvoicePDF:de}=await import("./enhancedInvoicePdfGenerator-DSDNJkSZ.js");return{generateEnhancedInvoicePDF:de}},[]);console.log(JSON.stringify(e()));const oe={invoiceId:$(),shippingMethod:e().shippingMethod,taxPercent:e()?.paymentMethods.taxPercent,taxOnTotal:e()?.paymentMethods.taxOnTotal,exemptTaxOnCash:e()?.paymentMethods.exemptTaxOnCash,paymentMethods:e().paymentMethods,productSubtotal:K(),reservaSubtotal:k(),subtotalBeforeTax:R(),taxAmount:Y(),taxSavings:e()?.paymentMethods.exemptTaxOnCash?R()*e()?.paymentMethods.taxPercent/100-Y():0,total:O(),cashPaymentRatio:le()>0?e().paymentMethods.cash/le():0};console.log(JSON.stringify(oe));const z=await G({...e(),...oe},"es","modern");P(`📄 PDF generated successfully: ${z}`)}catch(G){x(G.message||"Error generating PDF")}finally{X(!1)}}},J=()=>{Hr.clearForm(),U(""),P(""),x("")},te=()=>Hr.hasData()&&Hr.isDirty,ee=()=>{te()?confirm("Are you sure you want to clear the form? All unsaved changes will be lost.")&&J():J()};Sn(()=>{});const ne=Dt(()=>{const G=new Set([2516,2517,2518,2519,2520,2521,2522,2523].map(ce=>ce));return Array.from(G).sort((ce,oe)=>ce-oe)});return(()=>{var G=LD(),ce=G.firstChild,oe=ce.nextSibling,z=oe.firstChild,de=z.firstChild,fe=de.firstChild,ue=fe.nextSibling,ge=ue.firstChild,xe=ge.firstChild,pe=xe.nextSibling,_e=ge.nextSibling,Le=_e.firstChild,De=ue.nextSibling,Te=De.firstChild,$e=Te.firstChild,Ie=$e.nextSibling,Re=Ie.nextSibling,Ke=Te.nextSibling,je=Ke.firstChild,We=je.nextSibling,Qe=We.nextSibling,at=Ke.nextSibling,nt=at.firstChild,Ye=nt.nextSibling,ht=Ye.firstChild,lt=De.nextSibling,$t=lt.firstChild,_t=$t.nextSibling,ze=lt.nextSibling,Lt=ze.firstChild,Nt=Lt.nextSibling,wt=Nt.firstChild,Ot=wt.nextSibling,gr=z.nextSibling;return a(G,M(Ge,{get when(){return f()},get children(){var Be=hD();return Be.firstChild,a(Be,f,null),Se(Pt=>m(Be,{...st.alert,...st.errorAlert},Pt)),Be}}),oe),a(G,M(Ge,{get when(){return S()},get children(){var Be=Yh();return a(Be,S),Se(Pt=>m(Be,{...st.alert,...st.successAlert},Pt)),Be}}),oe),pe.$$input=Be=>r({invoice:Be.target.value}),a(_e,M(Vu,{get value(){return o()},onChange:E,get placeholder(){return t("inventory.selectStoreLocation","Buscar y seleccionar ubicación de tienda...")},filterType:"store",required:!0}),null),Re.addEventListener("change",Be=>r({shippingMethod:Be.currentTarget.value})),Qe.addEventListener("change",Be=>r({createDate:Be.currentTarget.value})),m(Qe,jD),Ye.addEventListener("change",Be=>r({guide:Be.currentTarget.value})),Ye.style.setProperty("width","100%"),Ye.style.setProperty("padding","0.5rem"),Ye.style.setProperty("border","1px solid var(--border-color)"),Ye.style.setProperty("border-radius","var(--border-radius-sm)"),Ye.style.setProperty("background","var(--surface-color)"),a(ht,()=>t("common.all","All")),a(Ye,M(Ht,{get each(){return ne()},children:Be=>(()=>{var Pt=RD();return Pt.value=Be,a(Pt,Be),Pt})()}),null),_t.$$input=Be=>r({description:Be.target.value}),Lt.addEventListener("change",Be=>r({packagesOrder:Be.target.checked})),a(z,M(Ge,{get when(){return Ee(()=>!!(e().shippingMethod&&e().invoice&&e().guide))()&&o()},get children(){return[(()=>{var Be=pD(),Pt=Be.firstChild,Ct=Pt.nextSibling,tt=Ct.nextSibling,ft=tt.firstChild,Vt=ft.firstChild,Rt=Vt.nextSibling,rr=ft.nextSibling,it=rr.firstChild,yt=it.nextSibling;return a(Ct,M(dD,{get value(){return u()},onChange:T,label:"Buscar Cliente Existente",description:"Busque clientes existentes por nombre, teléfono o ID. Si no se encuentra, complete el formulario a continuación para crear un nuevo cliente.",placeholder:"Escriba nombre del cliente, número de teléfono o ID para buscar..."})),Rt.$$input=It=>Hr.updateShipperConsignee({name:It.target.value}),yt.$$input=It=>Hr.updateShipperConsignee({phoneNumberS:It.target.value}),Se(It=>{var Jt={...st.section,"margin-top":"1rem"},Je=st.sectionTitle,Et=st.formGroup,Wt=st.gridTwo,Yt=st.formGroup,er=st.label,kt=st.input,Xt=st.formGroup,tr=st.label,Zt=st.input;return It.e=m(Be,Jt,It.e),It.t=m(Pt,Je,It.t),It.a=m(Ct,Et,It.a),It.o=m(tt,Wt,It.o),It.i=m(ft,Yt,It.i),It.n=m(Vt,er,It.n),It.s=m(Rt,kt,It.s),It.h=m(rr,Xt,It.h),It.r=m(it,tr,It.r),It.d=m(yt,Zt,It.d),It},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),Se(()=>Rt.value=e().shipper_consignee.name),Se(()=>yt.value=e().shipper_consignee.phoneNumberS||""),Be})(),(()=>{var Be=fD(),Pt=Be.firstChild,Ct=Pt.nextSibling,tt=Ct.nextSibling,ft=tt.firstChild,Vt=ft.nextSibling,Rt=tt.nextSibling,rr=Rt.firstChild,it=rr.nextSibling,yt=Rt.nextSibling,It=yt.firstChild,Jt=It.nextSibling,Je=yt.nextSibling,Et=Je.firstChild,Wt=Et.nextSibling,Yt=Je.nextSibling,er=Yt.firstChild,kt=er.nextSibling,Xt=Yt.nextSibling,tr=Xt.firstChild,Zt=tr.nextSibling;return a(Ct,M(oD,{get value(){return n()},onChange:C,label:"Buscar Destinatario Existente",description:"Busque Destinatario existentes por teléfono o ID. Si no se encuentra, complete el formulario a continuación para crear un nuevo destinatario.",placeholder:"Escriba nombre del destinatario, número de teléfono o ID para buscar..."})),Vt.$$input=vt=>Hr.updateShipperConsignee({firstName:vt.target.value}),it.$$input=vt=>Hr.updateShipperConsignee({lastName:vt.target.value}),Jt.$$input=vt=>Hr.updateShipperConsignee({cid:vt.target.value}),Wt.$$input=vt=>Hr.updateShipperConsignee({passport:vt.target.value}),kt.$$input=vt=>Hr.updateShipperConsignee({phoneNumber:vt.target.value}),Zt.$$input=vt=>Hr.updateShipperConsignee({address:vt.target.value}),Se(vt=>{var ir={...st.section,"margin-top":"1rem"},Tt=st.sectionTitle,Ir=st.formGroup,or=st.formGroup,cr=st.label,_r=st.input,Tr=st.formGroup,kr=st.label,lr=st.input,Mt=st.formGroup,yn=st.label,gn=st.input,En=st.formGroup,Nr=st.label,On=st.input,bi=st.formGroup,_i=st.label,hr=st.input,Lr=st.formGroup,jr=st.label,fn=st.textarea;return vt.e=m(Be,ir,vt.e),vt.t=m(Pt,Tt,vt.t),vt.a=m(Ct,Ir,vt.a),vt.o=m(tt,or,vt.o),vt.i=m(ft,cr,vt.i),vt.n=m(Vt,_r,vt.n),vt.s=m(Rt,Tr,vt.s),vt.h=m(rr,kr,vt.h),vt.r=m(it,lr,vt.r),vt.d=m(yt,Mt,vt.d),vt.l=m(It,yn,vt.l),vt.u=m(Jt,gn,vt.u),vt.c=m(Je,En,vt.c),vt.w=m(Et,Nr,vt.w),vt.m=m(Wt,On,vt.m),vt.f=m(Yt,bi,vt.f),vt.y=m(er,_i,vt.y),vt.g=m(kt,hr,vt.g),vt.p=m(Xt,Lr,vt.p),vt.b=m(tr,jr,vt.b),vt.T=m(Zt,fn,vt.T),vt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0}),Se(()=>Vt.value=e().shipper_consignee.firstName||""),Se(()=>it.value=e().shipper_consignee.lastName||""),Se(()=>Jt.value=e().shipper_consignee.cid||""),Se(()=>Wt.value=e().shipper_consignee.passport||""),Se(()=>kt.value=e().shipper_consignee.phoneNumber||""),Se(()=>Zt.value=e().shipper_consignee.address||""),Be})()]}}),null),a(gr,M(Ge,{get when(){return Ee(()=>!!(e().shippingMethod&&e().invoice&&e().shipper_consignee?.cid))()&&e().shipper_consignee?.name},get children(){return[(()=>{var Be=mD(),Pt=Be.firstChild,Ct=Pt.firstChild,tt=Ct.nextSibling;return tt.$$click=w,a(Be,M(Ht,{get each(){return e().reservas},children:ft=>M(qD,{updateReserva:_,reserva:ft,removeReserva:W})}),null),a(Be,M(Ge,{get when(){return e().reservas.length>0},get children(){var ft=vb(),Vt=ft.firstChild;return Vt.firstChild,ft.style.setProperty("margin-top","0.75rem"),ft.style.setProperty("padding-top","0.75rem"),ft.style.setProperty("border-top","1px solid var(--border-color)"),ft.style.setProperty("text-align","right"),a(Vt,()=>k().toFixed(),null),ft}}),null),Se(ft=>{var Vt={...st.section,"margin-top":"1rem"},Rt={...st.sectionTitle,"justify-content":"space-between"},rr={...st.button,...st.successButton};return ft.e=m(Be,Vt,ft.e),ft.t=m(Pt,Rt,ft.t),ft.a=m(tt,rr,ft.a),ft},{e:void 0,t:void 0,a:void 0}),Be})(),(()=>{var Be=yD(),Pt=Be.firstChild,Ct=Pt.nextSibling,tt=Ct.firstChild;return a(Ct,M(QR,{value:"",onChange:re,get placeholder(){return t("inventory.searchProductsToAdd","Buscar productos por nombre, SKU o categoría para agregar a la factura...")},searchDelay:300,maxResults:15}),null),a(Be,M(Ht,{get each(){return e().products},children:ft=>M(zD,{product:ft,updateProduct:j,removeProduct:b})}),null),a(Be,M(Ge,{get when(){return e().products.length>0},get children(){var ft=vb(),Vt=ft.firstChild;return Vt.firstChild,ft.style.setProperty("margin-top","0.75rem"),ft.style.setProperty("padding-top","0.75rem"),ft.style.setProperty("border-top","1px solid var(--border-color)"),ft.style.setProperty("text-align","right"),a(Vt,()=>K().toFixed(),null),ft}}),null),Se(ft=>{var Vt={...st.section,"margin-top":"1rem"},Rt={...st.sectionTitle,"justify-content":"space-between"},rr=st.formGroup,it=st.label;return ft.e=m(Be,Vt,ft.e),ft.t=m(Pt,Rt,ft.t),ft.a=m(Ct,rr,ft.a),ft.o=m(tt,it,ft.o),ft},{e:void 0,t:void 0,a:void 0,o:void 0}),Be})(),(()=>{var Be=_D(),Pt=Be.firstChild,Ct=Pt.firstChild,tt=Ct.nextSibling,ft=tt.nextSibling,Vt=ft.nextSibling,Rt=Vt.firstChild,rr=Rt.firstChild,it=rr.firstChild,yt=rr.nextSibling,It=yt.firstChild,Jt=It.nextSibling;Jt.nextSibling;var Je=yt.nextSibling,Et=Je.firstChild,Wt=Je.nextSibling,Yt=Wt.firstChild,er=Yt.nextSibling;return er.nextSibling,a(Pt,M(Ge,{get when(){return Ee(()=>e()?.paymentMethods.taxPercent>0)()&&R()>0},get children(){var kt=gD(),Xt=kt.firstChild,tr=Xt.nextSibling;tr.firstChild;var Zt=tr.nextSibling,vt=Zt.firstChild,ir=vt.nextSibling,Tt=ir.nextSibling,Ir=Tt.nextSibling;Ir.nextSibling;var or=Zt.nextSibling,cr=or.firstChild,_r=cr.nextSibling,Tr=_r.nextSibling,kr=Tr.nextSibling;return kr.nextSibling,kt.style.setProperty("margin-top","0.5rem"),kt.style.setProperty("padding","0.5rem"),kt.style.setProperty("background","var(--strip-color)"),kt.style.setProperty("border-radius","var(--border-radius-sm)"),kt.style.setProperty("font-size","0.75rem"),kt.style.setProperty("border","1px solid var(--border-color)"),Xt.style.setProperty("font-weight","500"),Xt.style.setProperty("margin-bottom","0.25rem"),a(tr,()=>R().toFixed(2),null),a(Zt,()=>(R()*e()?.paymentMethods?.taxPercent/100).toFixed(2),ir),a(Zt,()=>(R()+R()*e()?.paymentMethods?.taxPercent/100).toFixed(2),Ir),a(or,()=>Y().toFixed(2),_r),a(or,()=>O().toFixed(2),kr),Se(lr=>{var Mt=e()?.paymentMethods?.taxOnTotal?"var(--primary-color)":"var(--text-muted)",yn=e()?.paymentMethods?.taxOnTotal?"var(--text-muted)":"var(--primary-color)";return Mt!==lr.e&&((lr.e=Mt)!=null?Zt.style.setProperty("color",Mt):Zt.style.removeProperty("color")),yn!==lr.t&&((lr.t=yn)!=null?or.style.setProperty("color",yn):or.style.removeProperty("color")),lr},{e:void 0,t:void 0}),kt}}),ft),ft.$$input=kt=>D("taxPercent",parseFloat(kt.target.value)||0),Vt.style.setProperty("margin-top","0.5rem"),Vt.style.setProperty("align-items","center"),Vt.style.setProperty("gap","0.5rem"),Rt.style.setProperty("margin-top","0.5rem"),it.addEventListener("change",()=>D("taxOnTotal",!1)),a(yt,()=>e()?.paymentMethods?.taxPercent,Jt),a(yt,(()=>{var kt=Ee(()=>e()?.paymentMethods?.taxPercent>0&&!e()?.paymentMethods?.taxOnTotal);return()=>kt()&&(()=>{var Xt=bb(),tr=Xt.firstChild,Zt=tr.nextSibling;return Zt.nextSibling,Xt.style.setProperty("color","var(--primary-color)"),a(Xt,()=>(R()*e()?.paymentMethods?.taxPercent/100).toFixed(2),Zt),Xt})()})(),null),Et.addEventListener("change",()=>D("taxOnTotal",!0)),a(Wt,()=>e()?.paymentMethods?.taxPercent,er),a(Wt,(()=>{var kt=Ee(()=>!!(e()?.paymentMethods?.taxPercent>0&&e()?.paymentMethods?.taxOnTotal));return()=>kt()&&(()=>{var Xt=bb(),tr=Xt.firstChild,Zt=tr.nextSibling;return Zt.nextSibling,Xt.style.setProperty("color","var(--primary-color)"),a(Xt,()=>Y().toFixed(2),Zt),Xt})()})(),null),a(Vt,M(Ge,{get when(){return e()?.paymentMethods?.taxPercent>0},get children(){var kt=bD(),Xt=kt.firstChild,tr=Xt.firstChild,Zt=Xt.nextSibling;return kt.style.setProperty("margin-top","1rem"),kt.style.setProperty("padding-top","1rem"),kt.style.setProperty("border-top","1px solid var(--border-color)"),tr.addEventListener("change",vt=>V("exemptTaxOnCash",vt.target.checked)),a(kt,M(Ge,{get when(){return Ee(()=>!!e()?.paymentMethods?.exemptTaxOnCash)()&&le()>0},get children(){var vt=vD(),ir=vt.firstChild,Tt=ir.nextSibling,Ir=Tt.firstChild,or=Ir.nextSibling,cr=or.nextSibling,_r=cr.nextSibling;_r.nextSibling;var Tr=Tt.nextSibling;Tr.firstChild;var kr=Tr.nextSibling,lr=kr.firstChild,Mt=lr.nextSibling;return Mt.nextSibling,vt.style.setProperty("margin-top","0.5rem"),vt.style.setProperty("padding","0.75rem"),vt.style.setProperty("background","#e8f5e9"),vt.style.setProperty("border-radius","var(--border-radius-sm)"),vt.style.setProperty("font-size","0.875rem"),vt.style.setProperty("border","1px solid #c8e6c9"),ir.style.setProperty("font-weight","500"),ir.style.setProperty("color","#2e7d32"),ir.style.setProperty("margin-bottom","0.5rem"),a(Tt,()=>e().paymentMethods.cash.toFixed(2),or),a(Tt,()=>(e().paymentMethods.cash/le()*100).toFixed(1),_r),Tr.style.setProperty("color","#4CAF50"),Tr.style.setProperty("font-weight","500"),a(Tr,()=>q().toFixed(2),null),kr.style.setProperty("font-size","0.8rem"),kr.style.setProperty("color","#666"),kr.style.setProperty("margin-top","0.25rem"),a(kr,()=>(Y()+q()).toFixed(2),Mt),a(kr,()=>Y().toFixed(2),null),vt}}),null),Se(vt=>{var ir={...st.label,display:"flex","align-items":"center",gap:"0.5rem","margin-bottom":"0.5rem"},Tt=st.fieldDescription;return vt.e=m(Xt,ir,vt.e),vt.t=m(Zt,Tt,vt.t),vt},{e:void 0,t:void 0}),Se(()=>tr.checked=e()?.paymentMethods?.exemptTaxOnCash),kt}}),null),Se(kt=>{var Xt={...st.section,"margin-top":"1rem"},tr=st.formGroup,Zt=st.label,vt=st.fieldDescription,ir=st.input,Tt={...st.label,display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.8rem","margin-bottom":"0.25rem"},Ir={...st.fieldDescription,"margin-left":"1.5rem","margin-bottom":"0.5rem"},or={...st.label,display:"flex","align-items":"center",gap:"0.5rem","font-size":"0.8rem","margin-bottom":"0.25rem"},cr={...st.fieldDescription,"margin-left":"1.5rem"};return kt.e=m(Be,Xt,kt.e),kt.t=m(Pt,tr,kt.t),kt.a=m(Ct,Zt,kt.a),kt.o=m(tt,vt,kt.o),kt.i=m(ft,ir,kt.i),kt.n=m(rr,Tt,kt.n),kt.s=m(yt,Ir,kt.s),kt.h=m(Je,or,kt.h),kt.r=m(Wt,cr,kt.r),kt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),Se(()=>ft.value=e()?.paymentMethods?.taxPercent),Se(()=>it.checked=!e()?.paymentMethods?.taxOnTotal),Se(()=>Et.checked=e()?.paymentMethods?.taxOnTotal),Be})(),(()=>{var Be=PD(),Pt=Be.firstChild,Ct=Pt.nextSibling,tt=Ct.nextSibling,ft=tt.firstChild;ft.firstChild;var Vt=ft.nextSibling,Rt=Vt.nextSibling,rr=Rt.nextSibling,it=tt.nextSibling,yt=it.firstChild,It=yt.firstChild,Jt=It.nextSibling,Je=yt.nextSibling,Et=Je.firstChild,Wt=Et.nextSibling,Yt=it.nextSibling,er=Yt.firstChild,kt=er.nextSibling,Xt=Yt.nextSibling,tr=Xt.firstChild,Zt=tr.firstChild,vt=Zt.firstChild,ir=vt.nextSibling;ir.firstChild;var Tt=Zt.nextSibling,Ir=Tt.firstChild,or=Ir.nextSibling;or.firstChild;var cr=tr.nextSibling,_r=cr.firstChild,Tr=_r.firstChild,kr=Tr.nextSibling;kr.firstChild;var lr=_r.nextSibling;return tt.style.setProperty("display","flex"),tt.style.setProperty("gap","0.5rem"),tt.style.setProperty("margin-bottom","1rem"),tt.style.setProperty("flex-wrap","wrap"),ft.$$click=()=>I("cash"),a(ft,M(Ge,{get when(){return Ee(()=>!!e()?.paymentMethods.exemptTaxOnCash)()&&e()?.paymentMethods.taxPercent>0},get children(){var Mt=SD();return Mt.style.setProperty("font-size","0.6rem"),Mt.style.setProperty("display","block"),Mt.style.setProperty("line-height","1"),Mt}}),null),Vt.$$click=()=>I("zelle"),Rt.$$click=()=>I("creditCard"),rr.$$click=F,Jt.$$input=Mt=>D("cash",parseFloat(Mt.target.value)||0),Wt.$$input=Mt=>D("zelle",parseFloat(Mt.target.value)||0),kt.$$input=Mt=>D("creditCard",parseFloat(Mt.target.value)||0),Xt.style.setProperty("margin-top","1rem"),Xt.style.setProperty("padding-top","1rem"),Xt.style.setProperty("border-top","1px solid var(--border-color)"),Xt.style.setProperty("display","grid"),Xt.style.setProperty("grid-template-columns","1fr 1fr"),Xt.style.setProperty("gap","1rem"),Xt.style.setProperty("font-size","0.875rem"),a(ir,()=>le().toFixed(),null),a(or,()=>N().toFixed(),null),cr.style.setProperty("text-align","right"),a(kr,()=>O().toFixed(),null),lr.style.setProperty("font-weight","500"),a(lr,(()=>{var Mt=Ee(()=>Math.round(N())===0);return()=>Mt()?"✓ Pagado Completo":N()>0?"Falta Pagar":"Sobrepago"})()),Se(Mt=>{var yn={...st.section,"margin-top":"1rem"},gn=st.sectionTitle,En=st.fieldDescription,Nr={...st.button,...e()?.paymentMethods.exemptTaxOnCash&&e()?.paymentMethods.taxPercent>0?{background:"#4CAF50",color:"white"}:st.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem",position:"relative"},On=e()?.paymentMethods.exemptTaxOnCash&&e()?.paymentMethods.taxPercent>0?`Pagar todo en efectivo (Ahorro: $${(R()*e()?.paymentMethods.taxPercent/100).toFixed(2)})`:"Pagar todo en efectivo",bi={...st.button,...st.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem"},_i={...st.button,...st.secondaryButton,"font-size":"0.75rem",padding:"0.5rem 0.75rem"},hr={...st.button,background:"#f44336",color:"white","font-size":"0.75rem",padding:"0.5rem 0.75rem"},Lr=st.gridTwo,jr=st.formGroup,fn=st.label,Gr=st.input,Br=st.formGroup,Wn=st.label,ri=st.input,Si=st.formGroup,qr=st.label,Vi=st.input,Pi=parseFloat(N().toFixed())===0?"#4CAF50":N()>0?"#f44336":"#FF9800",wi=parseFloat(N().toFixed())===0?"#4CAF50":"#f44336";return Mt.e=m(Be,yn,Mt.e),Mt.t=m(Pt,gn,Mt.t),Mt.a=m(Ct,En,Mt.a),Mt.o=m(ft,Nr,Mt.o),On!==Mt.i&&nr(ft,"title",Mt.i=On),Mt.n=m(Vt,bi,Mt.n),Mt.s=m(Rt,_i,Mt.s),Mt.h=m(rr,hr,Mt.h),Mt.r=m(it,Lr,Mt.r),Mt.d=m(yt,jr,Mt.d),Mt.l=m(It,fn,Mt.l),Mt.u=m(Jt,Gr,Mt.u),Mt.c=m(Je,Br,Mt.c),Mt.w=m(Et,Wn,Mt.w),Mt.m=m(Wt,ri,Mt.m),Mt.f=m(Yt,Si,Mt.f),Mt.y=m(er,qr,Mt.y),Mt.g=m(kt,Vi,Mt.g),Pi!==Mt.p&&((Mt.p=Pi)!=null?Tt.style.setProperty("color",Pi):Tt.style.removeProperty("color")),wi!==Mt.b&&((Mt.b=wi)!=null?lr.style.setProperty("color",wi):lr.style.removeProperty("color")),Mt},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0}),Se(()=>Jt.value=e().paymentMethods.cash),Se(()=>Wt.value=e().paymentMethods.zelle),Se(()=>kt.value=e().paymentMethods.creditCard),Be})(),(()=>{var Be=CD(),Pt=Be.firstChild,Ct=Pt.firstChild;Ct.firstChild;var tt=Ct.nextSibling;tt.firstChild;var ft=tt.nextSibling;ft.firstChild;var Vt=ft.nextSibling;return Vt.firstChild,Ct.style.setProperty("font-size","0.875rem"),Ct.style.setProperty("opacity","0.9"),a(Ct,()=>K().toFixed(),null),tt.style.setProperty("font-size","0.875rem"),tt.style.setProperty("opacity","0.9"),a(tt,()=>k().toFixed(),null),ft.style.setProperty("font-size","0.875rem"),ft.style.setProperty("opacity","0.9"),ft.style.setProperty("border-top","1px solid rgba(175,175,175,0.2)"),ft.style.setProperty("padding-top","0.5rem"),ft.style.setProperty("margin-top","0.5rem"),a(ft,()=>R().toFixed(2),null),a(Pt,M(Ge,{get when(){return e()?.paymentMethods?.taxPercent>0},get children(){var Rt=xD(),rr=Rt.firstChild,it=rr.nextSibling,yt=it.nextSibling,It=yt.nextSibling;return It.nextSibling,Rt.style.setProperty("font-size","0.875rem"),Rt.style.setProperty("opacity","0.9"),a(Rt,()=>e()?.paymentMethods?.taxPercent,it),a(Rt,()=>e()?.paymentMethods?.taxOnTotal?"del total":"del subtotal",It),a(Rt,()=>Y().toFixed(2),null),a(Rt,M(Ge,{get when(){return Ee(()=>!!e()?.paymentMethods?.exemptTaxOnCash)()&&q()>0},get children(){var Jt=wD(),Je=Jt.firstChild,Et=Je.nextSibling;return Et.nextSibling,Jt.style.setProperty("color","#4CAF50"),Jt.style.setProperty("margin-left","0.5rem"),a(Jt,()=>q().toFixed(2),Et),Jt}}),null),Rt}}),Vt),a(Pt,M(Ge,{get when(){return e().shippingMethod},get children(){var Rt=AD();return Rt.firstChild,Rt.style.setProperty("font-size","0.875rem"),Rt.style.setProperty("opacity","0.9"),a(Rt,()=>e().shippingMethod==="aereo"?"✈️ Aéreo":"🚢 Marítimo",null),Rt}}),Vt),Vt.style.setProperty("font-size","1.5rem"),Vt.style.setProperty("font-weight","700"),Vt.style.setProperty("margin-top","0.5rem"),Vt.style.setProperty("border-top","1px solid rgba(175,175,175,0.3)"),Vt.style.setProperty("padding-top","0.5rem"),a(Vt,()=>O().toFixed(0),null),Se(Rt=>{var rr={...st.section,"margin-top":"1rem"},it=st.totalSection;return Rt.e=m(Be,rr,Rt.e),Rt.t=m(Pt,it,Rt.t),Rt},{e:void 0,t:void 0}),Be})(),(()=>{var Be=Yh();return Be.style.setProperty("margin-top","1rem"),Be})(),M(Ge,{get when(){return Hr.isDirty||Hr.lastSaved},get children(){var Be=TD(),Pt=Be.firstChild;return Be.style.setProperty("margin-top","1rem"),Be.style.setProperty("background","rgba(76, 175, 80, 0.1)"),Be.style.setProperty("border","1px solid rgba(76, 175, 80, 0.3)"),Be.style.setProperty("border-radius","var(--border-radius-sm)"),Be.style.setProperty("padding","0.75rem"),Pt.style.setProperty("display","flex"),Pt.style.setProperty("align-items","center"),Pt.style.setProperty("justify-content","space-between"),Pt.style.setProperty("font-size","0.875rem"),a(Pt,M(Ge,{get when(){return Hr.isDirty},get children(){var Ct=ID(),tt=Ct.firstChild;return Ct.style.setProperty("color","#4CAF50"),Ct.style.setProperty("display","flex"),Ct.style.setProperty("align-items","center"),Ct.style.setProperty("gap","0.5rem"),tt.style.setProperty("width","8px"),tt.style.setProperty("height","8px"),tt.style.setProperty("background","#4CAF50"),tt.style.setProperty("border-radius","50%"),tt.style.setProperty("display","inline-block"),tt.style.setProperty("animation","pulse 2s infinite"),Ct}}),null),a(Pt,M(Ge,{get when(){return!Hr.isDirty&&Hr.lastSaved},get children(){var Ct=$D(),tt=Ct.firstChild;return tt.nextSibling,Ct.style.setProperty("color","#4CAF50"),Ct.style.setProperty("display","flex"),Ct.style.setProperty("align-items","center"),Ct.style.setProperty("gap","0.5rem"),tt.style.setProperty("width","8px"),tt.style.setProperty("height","8px"),tt.style.setProperty("background","#4CAF50"),tt.style.setProperty("border-radius","50%"),tt.style.setProperty("display","inline-block"),a(Ct,()=>Hr.lastSaved?.toLocaleTimeString(),null),Ct}}),null),a(Pt,M(Ge,{get when(){return te()},get children(){var Ct=ED();return Ct.$$click=ee,Ct.style.setProperty("background","none"),Ct.style.setProperty("border","none"),Ct.style.setProperty("color","#f44336"),Ct.style.setProperty("cursor","pointer"),Ct.style.setProperty("font-size","0.75rem"),Ct.style.setProperty("text-decoration","underline"),Ct}}),null),Be}}),M(Ge,{get when(){return Ee(()=>!$()&&O()>0)()&&!(y()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round(N())>.01)},get children(){var Be=kD();return Be.$$click=Q,a(Be,()=>y()?"⏳ Creando Factura...":"💾 Crear Factura"),Se(Pt=>{var Ct=y()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round(N())>.01,tt={...st.button,...st.primaryButton,width:"100%","justify-content":"center",padding:"0.875rem","font-size":"1rem",opacity:y()||!e().invoice.trim()||!e().shipper_consignee.name.trim()||Math.round(N())>.01?"0.6":"1"},ft=e().invoice.trim()?e().shipper_consignee.name.trim()?Math.abs(N())>.01?`El balance de pago debe ser $0.00 (actual: $${N().toFixed(2)})`:"Crear esta factura":"Por favor ingrese el nombre del cliente":"Por favor ingrese un número de factura";return Ct!==Pt.e&&(Be.disabled=Pt.e=Ct),Pt.t=m(Be,tt,Pt.t),ft!==Pt.a&&nr(Be,"title",Pt.a=ft),Pt},{e:void 0,t:void 0,a:void 0}),Be}}),M(Ge,{get when(){return $()},get children(){var Be=ND(),Pt=Be.firstChild,Ct=Pt.nextSibling;return Be.style.setProperty("display","grid"),Be.style.setProperty("grid-template-columns","1fr 1fr"),Be.style.setProperty("gap","0.75rem"),Pt.$$click=H,a(Pt,()=>se()?"⏳ Generando...":"📄 Generar PDF"),Ct.$$click=ee,Se(tt=>{var ft=se(),Vt={...st.button,...st.successButton,"justify-content":"center",opacity:se()?"0.6":"1"},Rt={...st.button,...st.secondaryButton,"justify-content":"center"};return ft!==tt.e&&(Pt.disabled=tt.e=ft),tt.t=m(Pt,Vt,tt.t),tt.a=m(Ct,Rt,tt.a),tt},{e:void 0,t:void 0,a:void 0}),Be}})]}})),Se(Be=>{var Pt=st.container,Ct=st.header,tt=st.grid,ft=st.section,Vt=st.sectionTitle,Rt=st.gridTwo,rr=st.formGroup,it=st.label,yt=st.input,It=l()||"INV-20241201-1234",Jt=st.formGroup,Je=st.label,Et=st.gridTwo,Wt=st.formGroup,Yt=st.label,er=st.fieldDescription,kt=st.input,Xt=st.formGroup,tr=st.label,Zt=st.fieldDescription,vt=st.formGroup,ir=st.label,Tt=st.formGroup,Ir=st.label,or=st.textarea,cr={...st.label,display:"flex","align-items":"center",gap:"0.5rem"},_r=st.fieldDescription;return Be.e=m(G,Pt,Be.e),Be.t=m(ce,Ct,Be.t),Be.a=m(oe,tt,Be.a),Be.o=m(de,ft,Be.o),Be.i=m(fe,Vt,Be.i),Be.n=m(ue,Rt,Be.n),Be.s=m(ge,rr,Be.s),Be.h=m(xe,it,Be.h),Be.r=m(pe,yt,Be.r),It!==Be.d&&nr(pe,"placeholder",Be.d=It),Be.l=m(_e,Jt,Be.l),Be.u=m(Le,Je,Be.u),Be.c=m(De,Et,Be.c),Be.w=m(Te,Wt,Be.w),Be.m=m($e,Yt,Be.m),Be.f=m(Ie,er,Be.f),Be.y=m(Re,kt,Be.y),Be.g=m(Ke,Xt,Be.g),Be.p=m(je,tr,Be.p),Be.b=m(We,Zt,Be.b),Be.T=m(at,vt,Be.T),Be.A=m(nt,ir,Be.A),Be.O=m(lt,Tt,Be.O),Be.I=m($t,Ir,Be.I),Be.S=m(_t,or,Be.S),Be.W=m(ze,cr,Be.W),Be.C=m(Ot,_r,Be.C),Be},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0,b:void 0,T:void 0,A:void 0,O:void 0,I:void 0,S:void 0,W:void 0,C:void 0}),Se(()=>pe.value=e().invoice),Se(()=>Re.value=e().shippingMethod),Se(()=>Qe.value=e().createDate),Se(()=>Ye.value=e().guide),Se(()=>_t.value=e().description),Se(()=>Lt.checked=e().packagesOrder),G})()},qD=t=>{let{reserva:e,updateReserva:r,removeReserva:n}=t;return(()=>{var i=MD(),o=i.firstChild,s=o.firstChild,l=o.nextSibling,c=l.firstChild,u=c.firstChild,h=c.nextSibling,y=h.firstChild,g=h.nextSibling,f=g.firstChild,x=g.nextSibling;return x.firstChild,a(o,M(UD,{get value(){return e.type},onChange:S=>r(e.id,"type",S),placeholder:"ej., Ropa, Zapatos, TV, Útiles del Hogar...",width:"80%",index:1}),s),s.$$click=()=>n(e.id),a(c,M(Cu,{type:"number",get value(){return e.qty},update:S=>r(e.id,"qty",parseFloat(S)||0),get style(){return{...st.input,...st.smallInput,width:"60px"}},placeholder:"Cant",min:"1",step:"0.01",index:2}),null),a(h,M(Cu,{type:"number",get value(){return e.price},update:S=>r(e.id,"price",parseFloat(S)||0),get style(){return{...st.input,...st.smallInput}},placeholder:"Precio",step:"0.01",index:3}),null),a(g,M(Cu,{type:"number",get value(){return e.arancel},update:S=>r(e.id,"arancel",parseFloat(S)||0),get style(){return{...st.input,...st.smallInput}},placeholder:"Arancel",step:"0.01",index:4}),null),x.style.setProperty("width","80px"),x.style.setProperty("text-align","right"),x.style.setProperty("font-weight","500"),a(x,()=>e.total?.toFixed(2)||"0.00",null),a(x,M(Ge,{get when(){return!1},get children(){var S=DD(),P=S.firstChild,$=P.nextSibling,U=$.nextSibling,se=U.nextSibling,X=se.nextSibling,Z=X.nextSibling;return Z.nextSibling,S.style.setProperty("font-size","0.6rem"),S.style.setProperty("color","var(--text-muted)"),a(S,()=>e.qty,$),a(S,()=>e.price,se),a(S,()=>e.arancel,Z),S}}),null),Se(S=>{var P=st.productWrapItem,$={...st.productItem,"justify-content":"space-around"},U=st.removeButton,se=st.productItem,X=st.formGroup,Z=st.label,re=st.formGroup,E=st.label,C=st.formGroup,T=st.label;return S.e=m(i,P,S.e),S.t=m(o,$,S.t),S.a=m(s,U,S.a),S.o=m(l,se,S.o),S.i=m(c,X,S.i),S.n=m(u,Z,S.n),S.s=m(h,re,S.s),S.h=m(y,E,S.h),S.r=m(g,C,S.r),S.d=m(f,T,S.d),S},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),i})()},zD=t=>{let{product:e,updateProduct:r,removeProduct:n}=t;return(()=>{var i=FD(),o=i.firstChild,s=o.firstChild,l=s.firstChild,c=l.nextSibling,u=s.nextSibling,h=o.nextSibling,y=h.firstChild;return y.firstChild,s.style.setProperty("flex","1"),l.style.setProperty("font-weight","500"),l.style.setProperty("font-size","0.875rem"),a(l,()=>e?.product.label),c.style.setProperty("font-size","0.75rem"),c.style.setProperty("color","var(--text-muted)"),a(c,()=>e?.product.code),u.$$click=()=>n(e?.id),a(h,M(Cu,{type:"number",get value(){return e?.qty},placeholder:"Cant",update:g=>r(e?.id,"qty",parseFloat(g)||0)}),y),a(h,M(Cu,{type:"number",get value(){return e?.salePrice},placeholder:"Precio",update:g=>r(e?.id,"salePrice",parseFloat(g)||0)}),y),y.style.setProperty("width","80px"),y.style.setProperty("text-align","right"),y.style.setProperty("font-weight","500"),a(y,()=>e?.total.toFixed(2),null),Se(g=>{var f=st.productWrapItem,x=st.productItem,S=st.removeButton,P=st.productItem;return g.e=m(i,f,g.e),g.t=m(o,x,g.t),g.a=m(u,S,g.a),g.o=m(h,P,g.o),g},{e:void 0,t:void 0,a:void 0,o:void 0}),i})()},Cu=t=>{const[e,r]=Ce("");Sn(()=>{t?.value!==void 0&&r(t.value.toString())});const n=o=>{(o.key==="Enter"||o.key==="Escape"||o.key==="Tab")&&t.update&&pl(e())&&t.update(e())},i=()=>{t.update&&pl(e())&&t.update(e())};return(()=>{var o=OD();return o.addEventListener("blur",i),o.$$keydown=n,o.$$input=s=>r(s.target.value),Se(s=>{var l=t?.type,c={...st.input,...st.smallInput,width:t?.width||"90px"},u=t.placeholder,h=t.title,y=t?.index;return l!==s.e&&nr(o,"type",s.e=l),s.t=m(o,c,s.t),u!==s.a&&nr(o,"placeholder",s.a=u),h!==s.o&&nr(o,"title",s.o=h),y!==s.i&&nr(o,"tabindex",s.i=y),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>o.value=e()),o})()},UD=t=>{const[e,r]=Ce(!1),[n,i]=Ce(""),[o,s]=Ce(-1),l=()=>{const se=n().toLowerCase();if(!se)return _b;const X=_b.filter(Z=>Z.toLowerCase().includes(se));return X.length===0&&se.length>0?[`✏️ Agregar "${n()}"`]:X},c=()=>{r(!0),i(""),s(-1)},u=se=>{const Z=se.target.value;i(Z),r(Z.length>0),s(-1)},h=se=>{let X;se.startsWith("✏️ Agregar")?X=n():X=se.replace(/^[\u{1F000}-\u{1F9FF}\u{2600}-\u{27BF}]\s*/u,""),t.onChange(X),r(!1),i(""),s(-1)},y=se=>{const X=l();switch(se.key){case"ArrowDown":se.preventDefault(),s(Z=>Math.min(Z+1,X.length-1));break;case"ArrowUp":se.preventDefault(),s(Z=>Math.max(Z-1,-1));break;case"Enter":se.preventDefault(),o()>=0&&X[o()]?h(X[o()]):(t.onChange(n()||t.value),r(!1));break;case"Escape":r(!1),i(""),s(-1);break}},g=()=>{setTimeout(()=>{n()&&n()!==t.value&&t.onChange(n()),r(!1),i(""),s(-1)},150)},f=()=>e()&&n()?n():t.value||"",x={position:"relative",width:t.width||"100%",flex:t.width?void 0:"1"},S={...st.input,width:"100%","padding-right":"2rem"},P={position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"200px","overflow-y":"auto",background:"var(--surface-color)",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","box-shadow":"0 4px 12px rgba(0,0,0,0.15)","margin-top":"2px"},$=se=>({padding:"0.5rem 0.75rem",cursor:"pointer","border-bottom":"1px solid var(--border-color)",background:se?"var(--strip-color)":"transparent",color:se?"var(--primary-color)":"var(--text-primary)",transition:"all 0.2s ease","font-size":"0.875rem"}),U={position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)","pointer-events":"none",color:"var(--text-muted)","font-size":"0.75rem"};return(()=>{var se=BD(),X=se.firstChild,Z=X.firstChild,re=Z.nextSibling;return X.style.setProperty("position","relative"),Z.addEventListener("blur",g),Z.$$keydown=y,Z.$$click=c,Z.$$input=u,a(re,()=>e()?"▲":"▼"),a(se,M(Ge,{get when(){return Ee(()=>!!e())()&&l().length>0},get children(){var E=Yh();return a(E,M(Ht,{get each(){return l()},children:(C,T)=>{const j=C.startsWith("✏️ Agregar");return(()=>{var b=Yh();return b.addEventListener("mouseenter",()=>s(T())),b.$$click=()=>h(C),a(b,C),Se(w=>m(b,{...$(T()===o()),...j&&{"font-style":"italic","border-left":"3px solid var(--primary-color)",background:T()===o()?"var(--primary-color)":"#f0f8ff",color:T()===o()?"white":"var(--primary-color)"}},w)),b})()}})),Se(C=>m(E,P,C)),E}}),null),Se(E=>{var C=x,T=S,j=t.placeholder,b=t?.index,w=U;return E.e=m(se,C,E.e),E.t=m(Z,T,E.t),j!==E.a&&nr(Z,"placeholder",E.a=j),b!==E.o&&nr(Z,"tabindex",E.o=b),E.i=m(re,w,E.i),E},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),Se(()=>Z.value=f()),se})()};yr(["input","click","keydown"]);const HD={common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",close:"Close",search:"Search",filter:"Filter",reset:"Reset",back:"Back",next:"Next",previous:"Previous",yes:"Yes",no:"No",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",actions:"Actions",status:"Status",active:"Active",inactive:"Inactive",date:"Date",time:"Time",description:"Description",notes:"Notes",amount:"Amount",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Language",english:"English",spanish:"Spanish",noDataFound:"No data found",required:"Required",optional:"Optional",all:"All",none:"None",select:"Select",clear:"Clear",view:"View",unknown:"Unknown",details:"Details",notAvailable:"N/A",download:"Download",upload:"Upload",print:"Print",export:"Export",import:"Import",exportCSV:"Export CSV",exportExcel:"Export Excel",showing:"Showing",of:"of",dateFrom:"Date From",dateTo:"Date To",showFilters:"Show Filters",hideFilters:"Hide Filters",clearFilters:"Clear Filters"},navigation:{dashboard:"Dashboard",accounts:"Chart of Accounts",balanceSheet:"Balance Sheet",inventory:"Inventory",inventoryManagement:"Inventory Management",employees:"Employees",employeeManagement:"Employee Management",entryBooks:"Entry Books",journalEntries:"Journal Entries",consolidate:"Bank Consolidation",reports:"Reports",settings:"Settings",logout:"Logout",home:"Home",hbl:"House Bill of Lading"},dashboard:{title:"Dashboard",welcome:"Welcome to HRM Finance",overview:"Overview",recentActivity:"Recent Activity",quickActions:"Quick Actions",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalEquity:"Total Equity",totalRevenue:"Total Revenue",totalExpenses:"Total Expenses",netIncome:"Net Income",cashBalance:"Cash Balance",accountsReceivable:"Accounts Receivable",accountsPayable:"Accounts Payable",inventoryValue:"Inventory Value",lowStockItems:"Low Stock Items",pendingInvoices:"Pending Invoices",employeeCount:"Employee Count",monthlyPayroll:"Monthly Payroll"},accounts:{title:"Chart of Accounts",accountNumber:"Account Number",accountName:"Account Name",accountType:"Account Type",category:"Category",balance:"Balance",parentAccount:"Parent Account",subAccounts:"Sub-accounts",addAccount:"Add Account",editAccount:"Edit Account",deleteAccount:"Delete Account",accountDetails:"Account Details",transactions:"Transactions",accountHistory:"Account History",types:{asset:"Asset",liability:"Liability",equity:"Equity",revenue:"Revenue",expense:"Expense"},categories:{currentAssets:"Current Assets",fixedAssets:"Fixed Assets",currentLiabilities:"Current Liabilities",longTermLiabilities:"Long-term Liabilities",ownersEquity:"Owner's Equity",operatingRevenue:"Operating Revenue",operatingExpenses:"Operating Expenses"},allAccounts:"All Accounts"},banking:{title:"Banking",unreconciled:"Unreconciled",reconciled:"Reconciled",reconciliation:"Reconciliation",notReconciled:"Not Reconciled"},balanceSheet:{title:"Balance Sheet",asOf:"As of",assets:"Assets",liabilities:"Liabilities",equity:"Equity",totalAssets:"Total Assets",totalLiabilities:"Total Liabilities",totalEquity:"Total Equity",currentAssets:"Current Assets",nonCurrentAssets:"Non-current Assets",currentLiabilities:"Current Liabilities",nonCurrentLiabilities:"Non-current Liabilities",retainedEarnings:"Retained Earnings",commonStock:"Common Stock",generateReport:"Generate Report",exportPDF:"Export PDF",exportExcel:"Export Excel"},inventory:{title:"Inventory Management",products:"Products",locations:"Locations",movements:"Movements",overview:"Overview",addProduct:"Add Product",addLocation:"Add Location",addMovement:"Add Movement",bulkMovement:"Bulk Movement",productName:"Product Name",productCode:"Product Code",sku:"SKU",category:"Category",quantity:"Quantity",unitOfMeasure:"Unit of Measure",unitCost:"Unit Cost",totalValue:"Total Value",minStockLevel:"Min Stock Level",maxStockLevel:"Max Stock Level",reorderPoint:"Reorder Point",locationName:"Location Name",locationType:"Location Type",locationCode:"Location Code",address:"Address",movementType:"Movement Type",fromLocation:"From Location",toLocation:"To Location",referenceNumber:"Reference Number",invoiceNumber:"Invoice Number",stockIn:"Stock In",stockOut:"Stock Out",transfer:"Transfer",adjustment:"Adjustment",inStock:"In Stock",lowStock:"Low Stock",outOfStock:"Out of Stock",stockLevels:"Stock Levels",stockByLocation:"Stock by Location",recentMovements:"Recent Movements",searchProducts:"Search products...",searchLocations:"Search locations...",noMovements:"No movements found",productDetails:"Product Details",locationDetails:"Location Details",movementDetails:"Movement Details",totalProducts:"Total Products",activeProducts:"Active Products",totalLocations:"Total Locations",activeLocations:"Active Locations",lowStockAlert:"Low Stock Alert",productsNeedRestocking:"products need restocking",lastSeen:"Last seen",noProducts:"No products at this location",warehouseType:"Warehouse",storeType:"Store",supplierType:"Supplier",customerType:"Customer"},employees:{title:"Employee Management",employeeList:"Employee List",addEmployee:"Add Employee",editEmployee:"Edit Employee",employeeDetails:"Employee Details",personalInfo:"Personal Information",employmentInfo:"Employment Information",payrollInfo:"Payroll Information",firstName:"First Name",lastName:"Last Name",fullName:"Full Name",email:"Email",phone:"Phone",address:"Address",dateOfBirth:"Date of Birth",employeeId:"Employee ID",department:"Department",position:"Position",hireDate:"Hire Date",employmentStatus:"Employment Status",salary:"Salary",payFrequency:"Pay Frequency",taxId:"Tax ID",bankAccount:"Bank Account",emergencyContact:"Emergency Contact",activeEmployees:"Active Employees",inactiveEmployees:"Inactive Employees",totalPayroll:"Total Payroll",searchEmployees:"Search employees..."},journal:{title:"Journal Entries",entryNumber:"Entry Number",entryDate:"Entry Date",debit:"Debit",credit:"Credit",account:"Account",memo:"Memo",reference:"Reference",createEntry:"Create Entry",editEntry:"Edit Entry",deleteEntry:"Delete Entry",addEntry:"Add Journal Entry",updateEntry:"Update Entry",saveAsDraft:"Save as Draft",post:"Post",postEntry:"Post Entry",voidEntry:"Void Entry",posted:"Posted",draft:"Draft",reversed:"Reversed",balanced:"Balanced",notBalanced:"Not Balanced",outOfBalance:"Out of Balance",unbalanced:"Unbalanced",recurringEntry:"Recurring Entry",attachments:"Attachments",draftEntry:"Draft Entry",postedEntry:"Posted Entry",totalDebits:"Total Debits",totalCredits:"Total Credits",totalDebit:"Total Debit",totalCredit:"Total Credit",totalAmount:"Total Amount",debitShort:"Dr.",creditShort:"Cr.",allEntries:"All Entries",noReference:"No reference",createdBy:"By",lines:"Lines",entryLines:"Journal Entry Lines",journalLines:"Journal Lines",addLine:"Add Line",lineDescription:"Line description",accountLines:"Account Lines",noDescription:"No description",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",balanceStatus:"Balance Status",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",fixBalance:"Fix Balance",editEntryTooltip:"Edit this journal entry",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",draftEntryDescription:"This entry can be edited and posted.",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",entryMustBeBalanced:"Entry must be balanced to post",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",entryNotBalancedShort:"Entry is not balanced",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",minTwoLinesRequired:"At least 2 line items are required",entryNotBalanced:"Entry is not balanced. Debit: ${debit}, Credit: ${credit}",lineAccountRequired:"Line {lineNumber}: Account is required",lineAmountRequired:"Line {lineNumber}: Either debit or credit amount must be provided",lineBothAmounts:"Line {lineNumber}: Cannot have both debit and credit amounts",enterEntryDescription:"Enter journal entry description",enterReferenceNumber:"Enter reference number",quickEntry:"Quick Journal Entry",selectCategory:"Select Category",selectTemplate:"Select Template",chooseCategory:"Choose a category...",chooseTemplate:"Choose a template...",enterAmounts:"Enter Amounts",entryPreview:"Entry Preview",createQuickEntry:"Create Quick Entry",templateRequired:"Please select a template",amountRequired:"Amount is required for {field}",templates:"Templates",manageTemplates:"Manage Templates",addNewTemplate:"Add New Template",templateDetails:"Template Details",newTemplate:"New Template",editTemplate:"Edit Template",templateName:"Template Name",enterTemplateName:"Enter template name",enterTemplateDescription:"Enter template description",category:"Category",templateLines:"Template Lines",type:"Type",amountType:"Amount Type",fieldName:"Field Name",selectAccount:"Select account...",variable:"Variable",fixed:"Fixed",fieldNamePlaceholder:"e.g., Amount",custom:"Custom",templateNameRequired:"Template name is required",templateDescriptionRequired:"Template description is required",lineDescriptionRequired:"Line {lineNumber}: Description is required",amountFieldNameRequired:"Line {lineNumber}: Amount field name is required",confirmDeleteTemplate:"Are you sure you want to delete this template?",selectTemplateToView:"Select a template from the list to view details",orCreateNew:"or create a new custom template",reconciliationSummary:"Reconciliation Summary",totalLines:"Total Lines",bankAccounts:"Bank Accounts",bankReconciled:"Bank Reconciled",bankPending:"Bank Pending",reconciledLines:"Reconciled Lines",unreconciledLines:"Unreconciled Lines",fullyReconciled:"Fully Reconciled",partiallyReconciled:"Partially Reconciled",unreconciled:"Unreconciled",reconciled:"Reconciled",pending:"Pending",matched:"Matched",manual:"Manual",pendingBankReconciliation:"Pending Bank Reconciliation",visitBankConsolidations:"Visit Bank Consolidations to reconcile these transactions",reconciliationTip:"Reconciliation Tip",unreconciledBankTransactions:"This entry has unreconciled bank account transactions.",bankAccount:"bank account",currentUser:"Current User",errorDeletingTemplate:"Error deleting template",errorSavingTemplate:"Error saving template",noLines:"No lines",noTemplateLines:"No template lines"},invoiceReport:{title:"Invoice Resume Report",filters:"Filters",storeLocation:"Store Location",allStores:"All Stores",fromDate:"From Date",toDate:"To Date",paymentMethod:"Payment Method",allMethods:"All Methods",cash:"Cash",zelle:"Zelle",other:"Other",shippingType:"Shipping Type",allTypes:"All Types",maritime:"🚢 Maritime",air:"✈️ Air",generateReport:"Generate Report",loading:"Loading...",print:"🖨️ Print",exportPdf:"📄 Export PDF",generating:"📄 Generating...",close:"Close",invoiceSummary:"Invoice Summary",totalInvoices:"Total Invoices",dateRange:"Date Range",store:"Store",shippingTypeLabel:"Shipping Type",notSet:"Not Set",paymentMethods:"Payment Methods",total:"Total",additionalCharges:"Additional Charges",transport:"Transport",aranceles:"Aranceles",tax:"Tax",productsSummary:"Products Summary",productType:"Product Type",quantity:"Quantity",totalValue:"Total Value",avgPrice:"Avg Price",reservasSummary:"Reservas Summary (Grouped by Price)",reservaType:"Reserva Type",totalQtyLbs:"Total Qty (lbs)",priceGroups:"Price Groups (Price → Qty)",otherServicesTitle:"Other Services & Charges",serviceType:"Service Type",totalOtherServices:"Total Other Services",totalSummary:"Total Summary",productsTotal:"Products Total",reservasTotal:"Reservas Total",transportServices:"Transport & Services",grandTotal:"GRAND TOTAL",invoiceReferences:"Invoice References",type:"Type",pricePerPound:"Price per pound",totalInvoicesCount:"Total invoices",invoiceNumbers:"Invoice Numbers",copyInvoiceNumbers:"📋 Copy Invoice Numbers",reportPeriod:"Report Period",allTimeReport:"All Time Report",generatedOn:"Generated on",generatingReport:"Generating report...",pdfGenerationFailed:"PDF generation failed. Using print instead.",invoiceNumbersCopied:"Invoice numbers copied to clipboard!",allTypesOption:"All Types",seaOption:"🚢 Maritime",airOption:"✈️ Air",allMethodsOption:"All Methods",cashOption:"Cash",zelleOption:"Zelle",otherOption:"Other",pdf:{title:"Invoice Resume Report",subtitle:"Comprehensive Financial Summary",paymentMethodsSummary:"Payment Methods Summary",productsSummary:"Products Summary",reservasSummary:"Reservas Summary (Grouped by Price)",otherServicesTitle:"Other Services & Charges",totalSummary:"Total Summary",paymentMethod:"Payment Method",amount:"Amount",product:"Product",quantity:"Quantity",total:"Total",type:"Type",totalQty:"Total Qty",priceGroups:"Price Groups",serviceType:"Service Type",productsTotal:"Products Total",reservasTotal:"Reservas Total",transportServices:"Transport & Services",grandTotal:"GRAND TOTAL",generatedOn:"Generated on:",all:"All",reportDate:"Report Date:",dateRange:"Date Range:",totalInvoices:"Total Invoices:",allTypes:"All Types",lbs:"lbs",page:"Page",of:"of"}},entryBooks:{title:"Entry Books",andMoreLines:"... and {count} more lines",viewDetails:"View Details",entryDetails:"Journal Entry Details",entryNotFound:"Entry Not Found",entryNotFoundMessage:"The journal entry you're looking for could not be found or may have been deleted.",details:"Details",journalLines:"Journal Lines",balanceStatus:"Balance Status",unbalanced:"Unbalanced",difference:"difference",createdAt:"Created At",postedAt:"Posted At",quickActions:"Quick Actions",postEntry:"Post Entry",fixBalance:"Fix Balance",draftEntry:"Draft Entry",draftEntryDescription:"This entry can be edited and posted.",entryMustBeBalancedBeforePosting:"Entry must be balanced before posting.",postedEntry:"Posted Entry",postedEntryDescription:"This entry has been posted to the general ledger. Editing will create a new draft copy.",voidEntryDescription:"This entry has been voided and cannot be modified.",editEntryTooltip:"Edit this journal entry",entryMustBeBalanced:"Entry must be balanced to post",postEntryTooltip:"Post this journal entry",voidEntryTooltip:"Void this journal entry",post:"Post",confirmEditPosted:"This entry has been posted. Editing will create a new draft copy. Continue?",confirmPost:"Are you sure you want to post this journal entry? This action cannot be undone.",confirmVoid:"Are you sure you want to void this journal entry?",voidEntry:"Void Entry",entryNotBalanced:"Entry Not Balanced",reconciliationSummary:"Reconciliation Summary",totalLines:"Total Lines",bankAccounts:"Bank Accounts",bankReconciled:"Bank Reconciled",bankPending:"Bank Pending",reconciledLines:"Reconciled Lines",manual:"Manual",pendingBankReconciliation:"Pending Bank Reconciliation",visitBankConsolidations:"Visit Bank Consolidations to reconcile these transactions",reconciliationTip:"Reconciliation Tip",unreconciledBankTransactions:"This entry has unreconciled bank account transactions.",unreconciledLines:"Unreconciled Lines",fullyReconciled:"Fully Reconciled",partiallyReconciled:"Partially Reconciled",unreconciled:"Unreconciled",reconciled:"Reconciled",pending:"Pending",matched:"Matched",noDescription:"No description",bankAccount:"bank account",currentUser:"Current User",errorDeletingTemplate:"Error deleting template",errorSavingTemplate:"Error saving template",noLines:"No lines",noTemplateLines:"No template lines"},consolidation:{title:"Bank Consolidation",bankAccount:"Bank Account",statementDate:"Statement Date",beginningBalance:"Beginning Balance",endingBalance:"Ending Balance",deposits:"Deposits",withdrawals:"Withdrawals",bankCharges:"Bank Charges",interest:"Interest",reconcile:"Reconcile",matched:"Matched",unmatched:"Unmatched",importStatement:"Import Statement",manualEntry:"Manual Entry",autoMatch:"Auto Match",clearAll:"Clear All",reconciliationStatus:"Reconciliation Status",difference:"Difference",bookBalance:"Book Balance",statementBalance:"Statement Balance",outstandingChecks:"Outstanding Checks",depositsInTransit:"Deposits in Transit"},forms:{requiredField:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",minLength:"Minimum length is",maxLength:"Maximum length is",minValue:"Minimum value is",maxValue:"Maximum value is",passwordMismatch:"Passwords do not match",selectOption:"Please select an option",enterValue:"Please enter a value",confirmDelete:"Are you sure you want to delete this item?",unsavedChanges:"You have unsaved changes. Do you want to continue?",saveSuccess:"Saved successfully",saveError:"Error saving data",deleteSuccess:"Deleted successfully",deleteError:"Error deleting item",descriptionRequired:"Description is required",errorOccurred:"An error occurred",errorPostingEntry:"An error occurred while posting the entry"},reports:{title:"Reports",incomeStatement:"Income Statement",balanceSheet:"Balance Sheet",cashFlow:"Cash Flow Statement",trialBalance:"Trial Balance",generalLedger:"General Ledger",accountsReceivable:"Accounts Receivable",accountsPayable:"Accounts Payable",inventoryReport:"Inventory Report",payrollReport:"Payroll Report",taxReport:"Tax Report",customReport:"Custom Report",dateRange:"Date Range",fromDate:"From Date",toDate:"To Date",generateReport:"Generate Report",exportOptions:"Export Options",pdf:"PDF",excel:"Excel",csv:"CSV"},settings:{title:"Settings",general:"General",company:"Company",users:"Users",security:"Security",backup:"Backup",companyName:"Company Name",companyAddress:"Company Address",taxId:"Tax ID",fiscalYear:"Fiscal Year",currency:"Currency",dateFormat:"Date Format",timeZone:"Time Zone",language:"Language",theme:"Theme",lightTheme:"Light",darkTheme:"Dark",autoBackup:"Auto Backup",backupFrequency:"Backup Frequency",lastBackup:"Last Backup",restoreBackup:"Restore Backup",exportData:"Export Data",importData:"Import Data",changePassword:"Change Password",twoFactorAuth:"Two-factor Authentication",sessionTimeout:"Session Timeout",auditLog:"Audit Log"},unauthorized:{title:"Access Restricted",accessDenied:"Access Denied",noPermission:"You don't have permission to access",thisFeature:"this feature",whySeeing:"Why am I seeing this?",explanation:"Your account doesn't have the necessary permissions to view this content.",requiredPermission:"Required permission:",goToDashboard:"Go to Dashboard",goBack:"Go Back",featuresCanAccess:"Features you can access:",dashboardAccess:"Dashboard and overview statistics",profileAccess:"Your profile and settings",roleBasedAccess:"Features enabled for your role",needAccess:"Need access? Contact your administrator or manager to request the appropriate permissions.",permissions:{accountAccess:"Account Management Access",inventoryAccess:"Inventory Access",employeeAccess:"HR Access",bankingAccess:"Banking Access",journalAccess:"Journal Entry Access",adminAccess:"Administrative Access",financialReporting:"Financial Reporting Access",invoiceManagement:"Invoice Management Access",productManagement:"Product Management Access",HBLAccess:"HBL Management Access"}},hbl:{title:"House Bill of Lading Management",records:"records",searchPlaceholder:"Search by HBL#, air guide, shipper, consignee, commodity, bag#, identity...",addNew:"Add New HBL",hblNumber:"HBL Number",airGuide:"Air Guide",airNumber:"Air Number",shipper:"Shipper",consignee:"Consignee",shipperPhone:"Shipper Phone",consigneePhone:"Consignee Phone",identity:"Identity",classification:"Classification",address:"Address",city:"City",state:"State",street:"Street",commodity:"Commodity",weight:"Weight",quantity:"Quantity",bagNumber:"Bag Number",agency:"Agency",guide:"Guide",guideNumber:"Guide Number",guideNo:"Guide No.",reserveDate:"Reserve Date",status:{"EN BODEGA":"In Warehouse",ENVIADO:"Shipped",ENTREGADO:"Delivered",CANCELADO:"Cancelled",PENDIENTE:"Pending"}}},GD={common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",add:"Agregar",close:"Cerrar",search:"Buscar",filter:"Filtrar",reset:"Restablecer",back:"Atrás",next:"Siguiente",previous:"Anterior",yes:"Sí",no:"No",from:"Desde",to:"Hasta",loading:"Cargando...",error:"Error",success:"Éxito",warning:"Advertencia",info:"Información",confirm:"Confirmar",actions:"Acciones",status:"Estado",active:"Activo",inactive:"Inactivo",date:"Fecha",time:"Hora",description:"Descripción",notes:"Notas",amount:"Monto",total:"Total",subtotal:"Subtotal",currency:"USD",language:"Idioma",english:"Inglés",spanish:"Español",noDataFound:"No se encontraron datos",required:"Requerido",optional:"Opcional",all:"Todos",none:"Ninguno",select:"Seleccionar",clear:"Limpiar",view:"Ver",unknown:"Desconocido",details:"Detalles",notAvailable:"N/A",download:"Descargar",upload:"Cargar",print:"Imprimir",export:"Exportar",import:"Importar",exportCSV:"Exportar CSV",exportExcel:"Exportar Excel",showing:"Mostrando",of:"de",dateFrom:"Fecha Desde",dateTo:"Fecha Hasta",showFilters:"Mostrar Filtros",hideFilters:"Ocultar Filtros",clearFilters:"Limpiar Filtros"},navigation:{dashboard:"Panel de Control",accounts:"Plan de Cuentas",balanceSheet:"Balance General",inventory:"Inventario",inventoryManagement:"Gestión de Inventario",employees:"Empleados",employeeManagement:"Gestión de Empleados",entryBooks:"Libros de Entrada",journalEntries:"Asientos Contables",consolidate:"Consolidación Bancaria",reports:"Reportes",settings:"Configuración",logout:"Cerrar Sesión",home:"Inicio",hbl:"Conocimiento de Embarque"},dashboard:{title:"Panel de Control",welcome:"Bienvenido a HRM Finance",overview:"Resumen",recentActivity:"Actividad Reciente",quickActions:"Acciones Rápidas",totalAssets:"Activos Totales",totalLiabilities:"Pasivos Totales",totalEquity:"Patrimonio Total",totalRevenue:"Ingresos Totales",totalExpenses:"Gastos Totales",netIncome:"Ingreso Neto",cashBalance:"Saldo en Efectivo",accountsReceivable:"Cuentas por Cobrar",accountsPayable:"Cuentas por Pagar",inventoryValue:"Valor del Inventario",lowStockItems:"Artículos con Bajo Stock",pendingInvoices:"Facturas Pendientes",employeeCount:"Número de Empleados",monthlyPayroll:"Nómina Mensual"},accounts:{title:"Plan de Cuentas",accountNumber:"Número de Cuenta",accountName:"Nombre de Cuenta",accountType:"Tipo de Cuenta",category:"Categoría",balance:"Saldo",parentAccount:"Cuenta Padre",subAccounts:"Subcuentas",addAccount:"Agregar Cuenta",editAccount:"Editar Cuenta",deleteAccount:"Eliminar Cuenta",accountDetails:"Detalles de Cuenta",transactions:"Transacciones",accountHistory:"Historial de Cuenta",types:{asset:"Activo",liability:"Pasivo",equity:"Patrimonio",revenue:"Ingreso",expense:"Gasto"},categories:{currentAssets:"Activos Corrientes",fixedAssets:"Activos Fijos",currentLiabilities:"Pasivos Corrientes",longTermLiabilities:"Pasivos a Largo Plazo",ownersEquity:"Patrimonio del Propietario",operatingRevenue:"Ingresos Operativos",operatingExpenses:"Gastos Operativos"},allAccounts:"Todas las Cuentas"},banking:{title:"Bancario",unreconciled:"Sin Conciliar",reconciled:"Conciliado",reconciliation:"Conciliación",notReconciled:"No Conciliado"},balanceSheet:{title:"Balance General",asOf:"Al",assets:"Activos",liabilities:"Pasivos",equity:"Patrimonio",totalAssets:"Total de Activos",totalLiabilities:"Total de Pasivos",totalEquity:"Total de Patrimonio",currentAssets:"Activos Corrientes",nonCurrentAssets:"Activos No Corrientes",currentLiabilities:"Pasivos Corrientes",nonCurrentLiabilities:"Pasivos No Corrientes",retainedEarnings:"Utilidades Retenidas",commonStock:"Capital Social",generateReport:"Generar Reporte",exportPDF:"Exportar PDF",exportExcel:"Exportar Excel"},inventory:{title:"Gestión de Inventario",products:"Productos",locations:"Ubicaciones",movements:"Movimientos",overview:"Resumen",addProduct:"Agregar Producto",addLocation:"Agregar Ubicación",addMovement:"Agregar Movimiento",bulkMovement:"Movimiento Masivo",productName:"Nombre del Producto",productCode:"Código del Producto",sku:"SKU",category:"Categoría",quantity:"Cantidad",unitOfMeasure:"Unidad de Medida",unitCost:"Costo Unitario",totalValue:"Valor Total",minStockLevel:"Nivel Mínimo de Stock",maxStockLevel:"Nivel Máximo de Stock",reorderPoint:"Punto de Reorden",locationName:"Nombre de Ubicación",locationType:"Tipo de Ubicación",locationCode:"Código de Ubicación",address:"Dirección",movementType:"Tipo de Movimiento",fromLocation:"Desde Ubicación",toLocation:"Hacia Ubicación",referenceNumber:"Número de Referencia",invoiceNumber:"Número de Factura",stockIn:"Entrada de Stock",stockOut:"Salida de Stock",transfer:"Transferencia",adjustment:"Ajuste",inStock:"En Stock",lowStock:"Stock Bajo",outOfStock:"Sin Stock",stockLevels:"Niveles de Stock",stockByLocation:"Stock por Ubicación",recentMovements:"Movimientos Recientes",searchProducts:"Buscar productos...",searchLocations:"Buscar ubicaciones...",noMovements:"No se encontraron movimientos",productDetails:"Detalles del Producto",locationDetails:"Detalles de Ubicación",movementDetails:"Detalles del Movimiento",totalProducts:"Total de Productos",activeProducts:"Productos Activos",totalLocations:"Total de Ubicaciones",activeLocations:"Ubicaciones Activas",lowStockAlert:"Alerta de Stock Bajo",productsNeedRestocking:"productos necesitan reabastecimiento",lastSeen:"Visto por última vez",noProducts:"No hay productos en esta ubicación",warehouseType:"Almacén",storeType:"Tienda",supplierType:"Proveedor",customerType:"Cliente"},employees:{title:"Gestión de Empleados",employeeList:"Lista de Empleados",addEmployee:"Agregar Empleado",editEmployee:"Editar Empleado",employeeDetails:"Detalles del Empleado",personalInfo:"Información Personal",employmentInfo:"Información Laboral",payrollInfo:"Información de Nómina",firstName:"Nombre",lastName:"Apellido",fullName:"Nombre Completo",email:"Correo Electrónico",phone:"Teléfono",address:"Dirección",dateOfBirth:"Fecha de Nacimiento",employeeId:"ID de Empleado",department:"Departamento",position:"Puesto",hireDate:"Fecha de Contratación",employmentStatus:"Estado Laboral",salary:"Salario",payFrequency:"Frecuencia de Pago",taxId:"ID Fiscal",bankAccount:"Cuenta Bancaria",emergencyContact:"Contacto de Emergencia",activeEmployees:"Empleados Activos",inactiveEmployees:"Empleados Inactivos",totalPayroll:"Nómina Total",searchEmployees:"Buscar empleados..."},journal:{title:"Asientos Contables",entryNumber:"Número de Asiento",entryDate:"Fecha del Asiento",debit:"Débito",credit:"Crédito",account:"Cuenta",memo:"Nota",reference:"Referencia",createEntry:"Crear Asiento",editEntry:"Editar Asiento",deleteEntry:"Eliminar Asiento",addEntry:"Agregar Asiento Contable",updateEntry:"Actualizar Asiento",saveAsDraft:"Guardar como Borrador",post:"Registrar",postEntry:"Registrar Asiento",voidEntry:"Anular Asiento",posted:"Registrado",draft:"Borrador",reversed:"Revertido",balanced:"Balanceado",notBalanced:"No Balanceado",outOfBalance:"Desbalanceado",unbalanced:"Desbalanceado",recurringEntry:"Asiento Recurrente",attachments:"Archivos Adjuntos",draftEntry:"Asiento Borrador",postedEntry:"Asiento Registrado",totalDebits:"Débitos Totales",totalCredits:"Créditos Totales",totalDebit:"Débito Total",totalCredit:"Crédito Total",totalAmount:"Monto Total",debitShort:"Db.",creditShort:"Cr.",allEntries:"Todos los Asientos",noReference:"Sin referencia",createdBy:"Por",lines:"Líneas",entryLines:"Líneas del Asiento Contable",journalLines:"Líneas del Diario",addLine:"Agregar Línea",lineDescription:"Descripción de línea",accountLines:"Líneas de Cuentas",noDescription:"Sin descripción",andMoreLines:"... y {count} líneas más",viewDetails:"Ver Detalles",entryDetails:"Detalles del Asiento Contable",entryNotFound:"Asiento No Encontrado",entryNotFoundMessage:"El asiento contable que busca no se pudo encontrar o puede haber sido eliminado.",balanceStatus:"Estado del Balance",difference:"diferencia",createdAt:"Creado el",postedAt:"Registrado el",quickActions:"Acciones Rápidas",fixBalance:"Corregir Balance",editEntryTooltip:"Editar este asiento contable",postEntryTooltip:"Registrar este asiento contable",voidEntryTooltip:"Anular este asiento contable",draftEntryDescription:"Este asiento puede ser editado y registrado.",postedEntryDescription:"Este asiento ha sido registrado en el libro mayor. Editar creará una nueva copia borrador.",voidEntryDescription:"Este asiento ha sido anulado y no puede ser modificado.",entryMustBeBalanced:"El asiento debe estar balanceado para registrarse",entryMustBeBalancedBeforePosting:"El asiento debe estar balanceado antes de registrarse.",entryNotBalancedShort:"El asiento no está balanceado",confirmEditPosted:"Este asiento ha sido registrado. Editar creará una nueva copia borrador. ¿Continuar?",confirmPost:"¿Está seguro que desea registrar este asiento contable? Esta acción no se puede deshacer.",confirmVoid:"¿Está seguro que desea anular este asiento contable?",minTwoLinesRequired:"Se requieren al menos 2 líneas",entryNotBalanced:"Asiento no balanceado. Débito: ${debit}, Crédito: ${credit}",lineAccountRequired:"Línea {lineNumber}: La cuenta es requerida",lineAmountRequired:"Línea {lineNumber}: Se debe proporcionar monto en débito o crédito",lineBothAmounts:"Línea {lineNumber}: No puede tener montos en débito y crédito",enterEntryDescription:"Ingrese la descripción del asiento contable",enterReferenceNumber:"Ingrese el número de referencia",quickEntry:"Entrada Rápida de Diario",selectCategory:"Seleccionar Categoría",selectTemplate:"Seleccionar Plantilla",chooseCategory:"Elija una categoría...",chooseTemplate:"Elija una plantilla...",enterAmounts:"Ingresar Montos",entryPreview:"Vista Previa del Asiento",createQuickEntry:"Crear Entrada Rápida",templateRequired:"Por favor seleccione una plantilla",amountRequired:"Se requiere monto para {field}",templates:"Plantillas",manageTemplates:"Administrar Plantillas",addNewTemplate:"Agregar Nueva Plantilla",templateDetails:"Detalles de Plantilla",newTemplate:"Nueva Plantilla",editTemplate:"Editar Plantilla",templateName:"Nombre de Plantilla",enterTemplateName:"Ingrese nombre de plantilla",enterTemplateDescription:"Ingrese descripción de plantilla",category:"Categoría",templateLines:"Líneas de Plantilla",type:"Tipo",amountType:"Tipo de Monto",fieldName:"Nombre del Campo",selectAccount:"Seleccionar cuenta...",variable:"Variable",fixed:"Fijo",fieldNamePlaceholder:"ej., Monto",custom:"Personalizado",templateNameRequired:"El nombre de plantilla es requerido",templateDescriptionRequired:"La descripción de plantilla es requerida",lineDescriptionRequired:"Línea {lineNumber}: Se requiere descripción",amountFieldNameRequired:"Línea {lineNumber}: Se requiere nombre del campo de monto",confirmDeleteTemplate:"¿Está seguro que desea eliminar esta plantilla?",selectTemplateToView:"Seleccione una plantilla de la lista para ver detalles",orCreateNew:"o cree una nueva plantilla personalizada",reconciliationSummary:"Resumen de Conciliación",totalLines:"Líneas Totales",bankAccounts:"Cuentas Bancarias",bankReconciled:"Conciliadas Bancarias",bankPending:"Bancarias Pendientes",reconciledLines:"Líneas Conciliadas",unreconciledLines:"Líneas Sin Conciliar",fullyReconciled:"Completamente Conciliado",partiallyReconciled:"Parcialmente Conciliado",unreconciled:"Sin Conciliar",reconciled:"Conciliadas",pending:"Pendientes",matched:"Coincididas",manual:"Manual",pendingBankReconciliation:"Conciliación Bancaria Pendiente",visitBankConsolidations:"Visite Consolidaciones Bancarias para conciliar estas transacciones",reconciliationTip:"Consejo de Conciliación",unreconciledBankTransactions:"Este asiento tiene transacciones de cuentas bancarias sin conciliar.",bankAccount:"cuenta bancaria",currentUser:"Usuario Actual",errorDeletingTemplate:"Error al eliminar plantilla",errorSavingTemplate:"Error al guardar plantilla",noLines:"Sin líneas",noTemplateLines:"Sin líneas de plantilla"},invoiceReport:{title:"Reporte Resumen de Facturas",filters:"Filtros",storeLocation:"Ubicación de Tienda",allStores:"Todas las Tiendas",fromDate:"Fecha Desde",toDate:"Fecha Hasta",paymentMethod:"Método de Pago",allMethods:"Todos los Métodos",cash:"Efectivo",zelle:"Zelle",other:"Otro",shippingType:"Tipo de Envío",allTypes:"Todos los Tipos",maritime:"🚢 Marítimo",air:"✈️ Aéreo",generateReport:"Generar Reporte",loading:"Cargando...",print:"🖨️ Imprimir",exportPdf:"📄 Exportar PDF",generating:"📄 Generando...",close:"Cerrar",invoiceSummary:"Resumen de Facturas",totalInvoices:"Total de Facturas",dateRange:"Rango de Fechas",store:"Tienda",shippingTypeLabel:"Tipo de Envío",notSet:"No Establecido",paymentMethods:"Métodos de Pago",total:"Total",additionalCharges:"Cargos Adicionales",transport:"Transporte",aranceles:"Aranceles",tax:"Impuesto",productsSummary:"Resumen de Productos",productType:"Tipo de Producto",quantity:"Cantidad",totalValue:"Valor Total",avgPrice:"Precio Promedio",reservasSummary:"Resumen de Reservas (Agrupado por Precio)",reservaType:"Tipo de Reserva",totalQtyLbs:"Cantidad Total (lbs)",priceGroups:"Grupos de Precio (Precio → Cantidad)",otherServicesTitle:"Otros Servicios y Cargos",serviceType:"Tipo de Servicio",totalOtherServices:"Total Otros Servicios",totalSummary:"Resumen Total",productsTotal:"Total Productos",reservasTotal:"Total Reservas",transportServices:"Transporte y Servicios",grandTotal:"TOTAL GENERAL",invoiceReferences:"Referencias de Facturas",type:"Tipo",pricePerPound:"Precio por libra",totalInvoicesCount:"Total facturas",invoiceNumbers:"Números de Facturas",copyInvoiceNumbers:"📋 Copiar Números de Facturas",reportPeriod:"Período del Reporte",allTimeReport:"Reporte de Todo el Tiempo",generatedOn:"Generado el",generatingReport:"Generando reporte...",pdfGenerationFailed:"Falló la generación del PDF. Usando impresión en su lugar.",invoiceNumbersCopied:"¡Números de facturas copiados al portapapeles!",allTypesOption:"Todos los Tipos",seaOption:"🚢 Marítimo",airOption:"✈️ Aéreo",allMethodsOption:"Todos los Métodos",cashOption:"Efectivo",zelleOption:"Zelle",otherOption:"Otro",pdf:{title:"Reporte Resumen de Facturas",subtitle:"Resumen Financiero Completo",paymentMethodsSummary:"Resumen de Métodos de Pago",productsSummary:"Resumen de Productos",reservasSummary:"Resumen de Reservas (Agrupado por Precio)",otherServicesTitle:"Otros Servicios y Cargos",totalSummary:"Resumen Total",paymentMethod:"Método de Pago",amount:"Monto",product:"Producto",quantity:"Cantidad",total:"Total",type:"Tipo",totalQty:"Cantidad Total",priceGroups:"Grupos de Precio",serviceType:"Tipo de Servicio",productsTotal:"Total Productos",reservasTotal:"Total Reservas",transportServices:"Transporte y Servicios",grandTotal:"TOTAL GENERAL",generatedOn:"Generado el:",all:"Todo",reportDate:"Fecha del Reporte:",dateRange:"Rango de Fechas:",totalInvoices:"Total de Facturas:",allTypes:"Todos los Tipos",lbs:"lbs",page:"Página",of:"de"}},entryBooks:{title:"Libros de Entrada",subtitle:"Administrar asientos contables y registros del libro mayor",bookName:"Nombre del Libro",bookType:"Tipo de Libro",createBook:"Crear Libro",editBook:"Editar Libro",salesBook:"Libro de Ventas",purchaseBook:"Libro de Compras",cashBook:"Libro de Caja",generalBook:"Libro General",entries:"Entradas",addEntry:"Agregar Entrada",period:"Período",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",bookBalance:"Saldo del Libro",reconciledBalance:"Saldo Conciliado",difference:"Diferencia",reconcile:"Conciliar",isReconciled:"Está Conciliado",totalEntries:"Total de Asientos",allJournalEntries:"Todos los asientos contables",postedEntriesOnly:"Solo asientos registrados",fromPostedEntries:"De {count} asientos registrados",needBankReconciliation:"Necesita conciliación bancaria",allReconciled:"Todo conciliado",sortBy:"Ordenar Por",fromDate:"Fecha Desde",toDate:"Fecha Hasta",order:"Orden",newest:"Más Reciente",oldest:"Más Antiguo",resetFilters:"Restablecer Filtros",activeFilters:"Filtros activos",from:"Desde",to:"Hasta",entriesFound:"{count} asientos encontrados",noJournalEntries:"Sin Asientos Contables",startByCreating:"Comience creando su primer asiento",noEntriesMatch:"No hay asientos que coincidan con sus filtros actuales.",createFirstEntry:"Crear Primer Asiento",confirmVoid:"¿Está seguro que desea anular este asiento contable?",void:"Anulado",viewReconciliation:"Ver Conciliación"},consolidation:{title:"Consolidación Bancaria",bankAccount:"Cuenta Bancaria",statementDate:"Fecha del Estado",beginningBalance:"Saldo Inicial",endingBalance:"Saldo Final",deposits:"Depósitos",withdrawals:"Retiros",bankCharges:"Cargos Bancarios",interest:"Intereses",reconcile:"Conciliar",matched:"Conciliado",unmatched:"No Conciliado",importStatement:"Importar Estado",manualEntry:"Entrada Manual",autoMatch:"Coincidencia Automática",clearAll:"Limpiar Todo",reconciliationStatus:"Estado de Conciliación",difference:"Diferencia",bookBalance:"Saldo en Libros",statementBalance:"Saldo del Estado",outstandingChecks:"Cheques Pendientes",depositsInTransit:"Depósitos en Tránsito"},forms:{requiredField:"Este campo es requerido",invalidEmail:"Dirección de correo inválida",invalidNumber:"Número inválido",invalidDate:"Fecha inválida",minLength:"La longitud mínima es",maxLength:"La longitud máxima es",minValue:"El valor mínimo es",maxValue:"El valor máximo es",passwordMismatch:"Las contraseñas no coinciden",selectOption:"Por favor seleccione una opción",enterValue:"Por favor ingrese un valor",confirmDelete:"¿Está seguro de que desea eliminar este elemento?",unsavedChanges:"Tiene cambios sin guardar. ¿Desea continuar?",saveSuccess:"Guardado exitosamente",saveError:"Error al guardar datos",deleteSuccess:"Eliminado exitosamente",deleteError:"Error al eliminar elemento",descriptionRequired:"La descripción es requerida",errorOccurred:"Ocurrió un error",errorPostingEntry:"Ocurrió un error al registrar el asiento"},reports:{title:"Reportes",incomeStatement:"Estado de Resultados",balanceSheet:"Balance General",cashFlow:"Estado de Flujo de Efectivo",trialBalance:"Balance de Comprobación",generalLedger:"Libro Mayor",accountsReceivable:"Cuentas por Cobrar",accountsPayable:"Cuentas por Pagar",inventoryReport:"Reporte de Inventario",payrollReport:"Reporte de Nómina",taxReport:"Reporte de Impuestos",customReport:"Reporte Personalizado",dateRange:"Rango de Fechas",fromDate:"Desde",toDate:"Hasta",generateReport:"Generar Reporte",exportOptions:"Opciones de Exportación",pdf:"PDF",excel:"Excel",csv:"CSV"},settings:{title:"Configuración",general:"General",company:"Empresa",users:"Usuarios",security:"Seguridad",backup:"Respaldo",companyName:"Nombre de la Empresa",companyAddress:"Dirección de la Empresa",taxId:"ID Fiscal",fiscalYear:"Año Fiscal",currency:"Moneda",dateFormat:"Formato de Fecha",timeZone:"Zona Horaria",language:"Idioma",theme:"Tema",lightTheme:"Claro",darkTheme:"Oscuro",autoBackup:"Respaldo Automático",backupFrequency:"Frecuencia de Respaldo",lastBackup:"Último Respaldo",restoreBackup:"Restaurar Respaldo",exportData:"Exportar Datos",importData:"Importar Datos",changePassword:"Cambiar Contraseña",twoFactorAuth:"Autenticación de Dos Factores",sessionTimeout:"Tiempo de Espera de Sesión",auditLog:"Registro de Auditoría"},unauthorized:{title:"Acceso Restringido",accessDenied:"Acceso Denegado",noPermission:"No tienes permisos para acceder a",thisFeature:"esta funcionalidad",whySeeing:"¿Por qué veo esto?",explanation:"Tu cuenta no tiene los permisos necesarios para ver este contenido.",requiredPermission:"Permiso requerido:",goToDashboard:"Ir al Panel de Control",goBack:"Regresar",featuresCanAccess:"Funcionalidades a las que puedes acceder:",dashboardAccess:"Panel de control y estadísticas generales",profileAccess:"Tu perfil y configuraciones",roleBasedAccess:"Funcionalidades habilitadas para tu rol",needAccess:"¿Necesitas acceso? Contacta a tu administrador o gerente para solicitar los permisos apropiados.",permissions:{accountAccess:"Acceso a Gestión de Cuentas",inventoryAccess:"Acceso a Inventario",employeeAccess:"Acceso a Recursos Humanos",bankingAccess:"Acceso Bancario",journalAccess:"Acceso a Asientos Contables",adminAccess:"Acceso Administrativo",financialReporting:"Acceso a Reportes Financieros",invoiceManagement:"Acceso a Gestión de Facturas",productManagement:"Acceso a Gestión de Productos",HBLAccess:"Acceso a Gestión de HBL"}},hbl:{title:"Gestión de Conocimiento de Embarque",records:"registros",searchPlaceholder:"Buscar por HBL#, guía aérea, remitente, consignatario, mercancía, bolsa#, identidad...",addNew:"Agregar Nuevo HBL",hblNumber:"Número HBL",airGuide:"Guía Aérea",airNumber:"Número Aéreo",shipper:"Remitente",consignee:"Consignatario",shipperPhone:"Teléfono del Remitente",consigneePhone:"Teléfono del Consignatario",identity:"Identidad",classification:"Clasificación",address:"Dirección",city:"Ciudad",state:"Provincia",street:"Calle",commodity:"Mercancía",weight:"Peso",quantity:"Cantidad",bagNumber:"Número de Bolsa",agency:"Agencia",guide:"Guía",guideNumber:"Número de Guía",guideNo:"Guía No.",reserveDate:"Fecha de Reserva",status:{"EN BODEGA":"En Bodega",ENVIADO:"Enviado",ENTREGADO:"Entregado",CANCELADO:"Cancelado",PENDIENTE:"Pendiente"}}},WD=()=>{if(typeof window<"u"){const t=localStorage.getItem("hrmfinance-language");if(t&&["es","en"].includes(t))return t}return"en"},[Sb,YD]=Ce(WD()),[Pb,KD]=Ce({en:{},es:{}}),pu={get language(){return Sb()},get translations(){return Pb()},setLanguage(t){YD(t),typeof window<"u"&&localStorage.setItem("hrmfinance-language",t)},setTranslations(t){KD(t)},translate(t,e){const r=Sb(),n=Pb()[r];if(!n)return e||t;const i=t.split(".");let o=n;for(const s of i)if(o&&typeof o=="object"&&s in o)o=o[s];else return e||t;return typeof o=="string"?o:e||t},t(t,e){return this.translate(t,e)}},JD=()=>({t:pu.translate.bind(pu),language:pu.language,setLanguage:pu.setLanguage});pu.setTranslations({en:HD,es:GD});var QD=he("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label><select><option value=all></option><option value=cash></option><option value=zelle></option><option value=other></option></select></div><div><label></label><select><option value=all></option><option value=SEA></option><option value=AEREO>"),XD=he("<div><div><strong>:</strong> </div><div><strong>:</strong> <!> <!> </div><div><strong>:</strong> </div><div><strong>:</strong> "),ZD=he("<div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),e8=he("<div><div><strong>:</strong> </div><div><strong>:</strong> </div><div><strong>:</strong> "),wb=he("<div>"),xb=he("<div><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody>"),t8=he("<div><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td colspan=4><strong>:</strong></td><td>"),r8=he("<div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div></div></div><div><div></div><div>"),n8=he("<div><div>"),i8=he("<div><div><div><h3></h3><button>×</button></div><div><div>: <strong></strong></div><div>: <strong></strong></div><div>: <strong></strong></div></div><div><div>:</div><div></div></div><div>"),o8=he("<div><div class=print-only><h1></h1><div></div><div>: </div></div><div class=no-print><h1></h1><div>"),s8=he("<option>"),a8=he("<tr><td></td><td></td><td></td><td>"),l8=he("<tr><td></td><td></td><td><div></div></td><td>"),c8=he("<div><span> → <!> lbs</span><button>📋 <!> invoice"),u8=he("<tr><td><div><span></span></div></td><td>");const d8=t=>{const{t:e}=JD(),[r,n]=Ce(!1),[i,o]=Ce(""),[s,l]=Ce(""),[c,u]=Ce("all"),[h,y]=Ce("all"),[g,f]=Ce("all"),[x,S]=Ce("all"),[P,$]=Ce(null),[U,se]=Ce([]),[X,Z]=Ce(!1),[re,E]=Ce(null);Sn(async()=>{await T()});const C=()=>ct.getActiveLocations(),T=async()=>{n(!0);try{let K=c()!=="all"?c():void 0;const k={store:K,dateFrom:i()||void 0,dateTo:s()||void 0};K&&(await Ri.fetchInvoices(k),j())}catch(K){console.error("Error loading report data:",K)}finally{n(!1)}},j=()=>{let K=Ri.getFilteredInvoices({store:c(),dateFrom:i(),dateTo:s()});x()!=="all"&&(K=K.filter(Q=>Q.shippingType===x()||!Q.shippingType&&x()==="SEA")),se(K);let k=0,R=0,Y=0,q=new Map,O=new Map,le=new Map,N=0,D=0,V=0;K.forEach(Q=>{const H=P8(Q),J=parseFloat(H.total);Q.paymentMethods?(Q?.paymentMethods?.cash&&(k+=Q?.paymentMethods?.cash),Q?.paymentMethods?.zelle&&(R+=Q?.paymentMethods?.zelle)):Q.hasTax&&Q?.TaxPercent?(R+=J,V+=Q?.TaxPercent/100*J):k+=J,Q.products?.forEach(te=>{const ee=te.product.label,ne=Math.abs(te.qty),G=parseFloat(__(te));if(q.has(ee)){const ce=q.get(ee);q.set(ee,{qty:ce.qty+ne,total:ce.total+G})}else q.set(ee,{qty:ne,total:G})}),Q.reservas?.forEach(te=>{const ee=te.type,ne=parseInt(te.qty)||0,G=parseFloat(te.price)||0,ce=parseFloat(te.arancel)||0,oe=parseFloat(b_(te));if(["TRANSPORTACION","OTROS SERVICIO","OTROS","SERVICIO DE RAPEADO","CAJAS"].includes(ee)||ne===0)if(N+=oe,le.has(ee)){const de=le.get(ee);le.set(ee,{qty:de.qty+ne,price:de.price,arancel:de.arancel+ce,total:de.total+oe})}else le.set(ee,{qty:ne,price:G,arancel:ce,total:oe});else{const de=ee;if(O.has(de)){const fe=O.get(de);O.set(de,{qty:fe.qty+ne,price:fe.price,total:fe.total+oe,priceGroups:fe.priceGroups});const ue=fe.priceGroups.get(G)||{qty:0,invoices:[]};ue.qty+=ne,ue.invoices.includes(Q.invoice)||ue.invoices.push(Q.invoice),fe.priceGroups.set(G,ue)}else{const fe=new Map;fe.set(G,{qty:ne,invoices:[Q.invoice]}),O.set(de,{qty:ne,price:G,arancel:ce,total:oe,priceGroups:fe})}}D+=ce})});const I=k+R+Y,F={dateRange:{from:i(),to:s()},store:c(),shippingType:x(),totalInvoices:K.length,paymentMethods:{cash:k,zelle:R,other:Y,total:k+R+Y},productsByType:q,reservasByTypeAndPrice:O,otherServicesByType:le,transportTotal:N,arancelesTotal:D,taxTotal:V,grandTotal:I+V};$(F)},b=K=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(K),w=()=>{_(),setTimeout(()=>{},100)},_=async()=>{try{const K=W();if(K){Z(!0);const{generateInvoiceResumePDF:k}=await Oi(async()=>{const{generateInvoiceResumePDF:Y}=await import("./invoiceResumePdfGenerator-bgjktVol.js");return{generateInvoiceResumePDF:Y}},[]),R=`invoice-resume-report-${new Date().toISOString().split("T")[0]}.pdf`;await k(K,e,R),console.log(`PDF generated successfully: ${R}`)}}catch(K){console.error("Error generating PDF:",K),alert(e("invoiceReport.pdfGenerationFailed")),w()}finally{Z(!1)}},W=Dt(()=>P());return(()=>{var K=o8(),k=K.firstChild,R=k.firstChild,Y=R.nextSibling,q=Y.nextSibling,O=q.firstChild,le=k.nextSibling,N=le.firstChild,D=N.nextSibling;return K.style.setProperty("padding","2rem"),K.style.setProperty("max-width","1200px"),K.style.setProperty("margin","0 auto"),k.style.setProperty("text-align","center"),k.style.setProperty("margin-bottom","2rem"),k.style.setProperty("border-bottom","2px solid #333"),k.style.setProperty("padding-bottom","1rem"),a(R,()=>e("invoiceReport.title")),Y.style.setProperty("font-size","12pt"),Y.style.setProperty("margin-top","0.5rem"),Y.style.setProperty("color","#666"),a(Y,M(Ge,{get when(){return Ee(()=>!!W()?.dateRange?.from)()&&W()?.dateRange?.to},get children(){return[Ee(()=>e("invoiceReport.reportPeriod")),": ",Ee(()=>W()?.dateRange?.from)," to ",Ee(()=>W()?.dateRange?.to)]}}),null),a(Y,M(Ge,{get when(){return!W()?.dateRange?.from||!W()?.dateRange?.to},get children(){return e("invoiceReport.allTimeReport")}}),null),q.style.setProperty("font-size","10pt"),q.style.setProperty("margin-top","0.5rem"),a(q,()=>e("invoiceReport.generatedOn"),O),a(q,()=>new Date().toLocaleDateString(),null),le.style.setProperty("display","flex"),le.style.setProperty("justify-content","space-between"),le.style.setProperty("align-items","center"),le.style.setProperty("margin-bottom","2rem"),N.style.setProperty("font-size","1.75rem"),N.style.setProperty("font-weight","bold"),a(N,()=>e("invoiceReport.title")),D.style.setProperty("display","flex"),D.style.setProperty("gap","1rem"),a(D,M(dt,{variant:"outline",onClick:w,get children(){return e("invoiceReport.print")}}),null),a(D,M(dt,{variant:"outline",onClick:_,get disabled(){return X()},get children(){return Ee(()=>!!X())()?e("invoiceReport.generating"):e("invoiceReport.exportPdf")}}),null),a(D,M(Ge,{get when(){return t.onClose},get children(){return M(dt,{variant:"secondary",get onClick(){return t.onClose},get children(){return e("invoiceReport.close")}})}}),null),a(K,M(Ft,{get title(){return e("invoiceReport.filters")},style:{"margin-bottom":"2rem"},class:"no-print",get children(){var V=QD(),I=V.firstChild,F=I.firstChild,Q=F.nextSibling,H=Q.firstChild,J=I.nextSibling,te=J.firstChild,ee=te.nextSibling,ne=J.nextSibling,G=ne.firstChild,ce=G.nextSibling,oe=ne.nextSibling,z=oe.firstChild,de=z.nextSibling,fe=de.firstChild,ue=fe.nextSibling,ge=ue.nextSibling,xe=ge.nextSibling,pe=oe.nextSibling,_e=pe.firstChild,Le=_e.nextSibling,De=Le.firstChild,Te=De.nextSibling,$e=Te.nextSibling;return V.style.setProperty("display","grid"),V.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),V.style.setProperty("gap","1rem"),V.style.setProperty("align-items","end"),F.style.setProperty("display","block"),F.style.setProperty("margin-bottom","0.5rem"),F.style.setProperty("font-weight","500"),a(F,()=>e("invoiceReport.storeLocation")),Q.addEventListener("change",Ie=>u(Ie.currentTarget.value)),Q.style.setProperty("width","100%"),Q.style.setProperty("padding","0.75rem"),Q.style.setProperty("border","1px solid var(--border-color)"),Q.style.setProperty("border-radius","var(--border-radius-sm)"),a(H,()=>e("invoiceReport.allStores")),a(Q,M(Ht,{get each(){return C()},children:Ie=>(()=>{var Re=s8();return a(Re,()=>Ie.name),Se(()=>Re.value=Ie.id),Re})()}),null),te.style.setProperty("display","block"),te.style.setProperty("margin-bottom","0.5rem"),te.style.setProperty("font-weight","500"),a(te,()=>e("invoiceReport.fromDate")),ee.addEventListener("change",Ie=>o(Ie.currentTarget.value)),ee.style.setProperty("width","100%"),ee.style.setProperty("padding","0.75rem"),ee.style.setProperty("border","1px solid var(--border-color)"),ee.style.setProperty("border-radius","var(--border-radius-sm)"),G.style.setProperty("display","block"),G.style.setProperty("margin-bottom","0.5rem"),G.style.setProperty("font-weight","500"),a(G,()=>e("invoiceReport.toDate")),ce.addEventListener("change",Ie=>l(Ie.currentTarget.value)),ce.style.setProperty("width","100%"),ce.style.setProperty("padding","0.75rem"),ce.style.setProperty("border","1px solid var(--border-color)"),ce.style.setProperty("border-radius","var(--border-radius-sm)"),z.style.setProperty("display","block"),z.style.setProperty("margin-bottom","0.5rem"),z.style.setProperty("font-weight","500"),a(z,()=>e("invoiceReport.paymentMethod")),de.addEventListener("change",Ie=>f(Ie.currentTarget.value)),de.style.setProperty("width","100%"),de.style.setProperty("padding","0.75rem"),de.style.setProperty("border","1px solid var(--border-color)"),de.style.setProperty("border-radius","var(--border-radius-sm)"),a(fe,()=>e("invoiceReport.allMethodsOption")),a(ue,()=>e("invoiceReport.cashOption")),a(ge,()=>e("invoiceReport.zelleOption")),a(xe,()=>e("invoiceReport.otherOption")),_e.style.setProperty("display","block"),_e.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("font-weight","500"),a(_e,()=>e("invoiceReport.shippingType")),Le.addEventListener("change",Ie=>S(Ie.currentTarget.value)),Le.style.setProperty("width","100%"),Le.style.setProperty("padding","0.75rem"),Le.style.setProperty("border","1px solid var(--border-color)"),Le.style.setProperty("border-radius","var(--border-radius-sm)"),a(De,()=>e("invoiceReport.allTypesOption")),a(Te,()=>e("invoiceReport.seaOption")),a($e,()=>e("invoiceReport.airOption")),a(V,M(Ge,{get when(){return c()!=="all"},get children(){return M(dt,{variant:"primary",onClick:T,get disabled(){return Ee(()=>c()==="all")()&&r()},get children(){return Ee(()=>!!r())()?e("invoiceReport.loading"):e("invoiceReport.generateReport")}})}}),null),Se(()=>Q.value=c()),Se(()=>ee.value=i()),Se(()=>ce.value=s()),Se(()=>de.value=g()),Se(()=>Le.value=x()),V}}),null),a(K,M(Ge,{get when(){return Ee(()=>!!(c()!=="all"&&W()))()&&!r()},get children(){return[(()=>{var V=wb();return V.style.setProperty("display","grid"),V.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(250px, 1fr))"),V.style.setProperty("gap","1.5rem"),V.style.setProperty("margin-bottom","2rem"),a(V,M(Ft,{get title(){return e("invoiceReport.invoiceSummary")},get children(){var I=XD(),F=I.firstChild,Q=F.firstChild,H=Q.firstChild;Q.nextSibling;var J=F.nextSibling,te=J.firstChild,ee=te.firstChild,ne=te.nextSibling,G=ne.nextSibling,ce=G.nextSibling,oe=ce.nextSibling;oe.nextSibling;var z=J.nextSibling,de=z.firstChild,fe=de.firstChild;de.nextSibling;var ue=z.nextSibling,ge=ue.firstChild,xe=ge.firstChild;return ge.nextSibling,I.style.setProperty("padding","1rem"),F.style.setProperty("margin-bottom","0.5rem"),a(Q,()=>e("invoiceReport.totalInvoices"),H),a(F,()=>W().totalInvoices,null),J.style.setProperty("margin-bottom","0.5rem"),a(te,()=>e("invoiceReport.dateRange"),ee),a(J,()=>W().dateRange.from||e("common.all"),G),a(J,()=>e("common.to"),oe),a(J,()=>W().dateRange.to||e("common.all"),null),z.style.setProperty("margin-bottom","0.5rem"),a(de,()=>e("invoiceReport.store"),fe),a(z,(()=>{var pe=Ee(()=>W().store==="all");return()=>pe()?e("invoiceReport.allStores"):W().store})(),null),a(ge,()=>e("invoiceReport.shippingTypeLabel"),xe),a(ue,(()=>{var pe=Ee(()=>W().shippingType==="all");return()=>pe()?e("invoiceReport.allTypes"):Ee(()=>W().shippingType==="SEA")()?e("invoiceReport.maritime"):Ee(()=>W().shippingType==="AEREO")()?e("invoiceReport.air"):e("invoiceReport.notSet")})(),null),I}}),null),a(V,M(Ft,{get title(){return e("invoiceReport.paymentMethods")},get children(){var I=ZD(),F=I.firstChild,Q=F.firstChild,H=Q.firstChild;Q.nextSibling;var J=F.nextSibling,te=J.firstChild,ee=te.firstChild;te.nextSibling;var ne=J.nextSibling,G=ne.firstChild,ce=G.firstChild;G.nextSibling;var oe=ne.nextSibling,z=oe.firstChild,de=z.firstChild;return z.nextSibling,I.style.setProperty("padding","1rem"),F.style.setProperty("margin-bottom","0.5rem"),a(Q,()=>e("invoiceReport.cash"),H),a(F,()=>b(W().paymentMethods.cash),null),J.style.setProperty("margin-bottom","0.5rem"),a(te,()=>e("invoiceReport.zelle"),ee),a(J,()=>b(W().paymentMethods.zelle),null),ne.style.setProperty("margin-bottom","0.5rem"),a(G,()=>e("invoiceReport.other"),ce),a(ne,()=>b(W().paymentMethods.other),null),oe.style.setProperty("border-top","1px solid var(--border-color)"),oe.style.setProperty("padding-top","0.5rem"),oe.style.setProperty("font-weight","bold"),a(z,()=>e("invoiceReport.total"),de),a(oe,()=>b(W().paymentMethods.total),null),I}}),null),a(V,M(Ft,{get title(){return e("invoiceReport.additionalCharges")},get children(){var I=e8(),F=I.firstChild,Q=F.firstChild,H=Q.firstChild;Q.nextSibling;var J=F.nextSibling,te=J.firstChild,ee=te.firstChild;te.nextSibling;var ne=J.nextSibling,G=ne.firstChild,ce=G.firstChild;return G.nextSibling,I.style.setProperty("padding","1rem"),F.style.setProperty("margin-bottom","0.5rem"),a(Q,()=>e("invoiceReport.transport"),H),a(F,()=>b(W().transportTotal),null),J.style.setProperty("margin-bottom","0.5rem"),a(te,()=>e("invoiceReport.aranceles"),ee),a(J,()=>b(W().arancelesTotal),null),ne.style.setProperty("margin-bottom","0.5rem"),a(G,()=>e("invoiceReport.tax"),ce),a(ne,()=>b(W().taxTotal),null),I}}),null),V})(),M(Ge,{get when(){return W().productsByType?.size>0},get children(){return M(Ft,{get title(){return e("invoiceReport.productsSummary")},style:{"margin-bottom":"2rem"},get children(){var V=xb(),I=V.firstChild,F=I.firstChild,Q=F.firstChild,H=Q.firstChild,J=H.nextSibling,te=J.nextSibling,ee=te.nextSibling,ne=F.nextSibling;return V.style.setProperty("overflow-x","auto"),I.style.setProperty("width","100%"),I.style.setProperty("border-collapse","collapse"),Q.style.setProperty("background","var(--background-color)"),H.style.setProperty("padding","1rem"),H.style.setProperty("text-align","left"),H.style.setProperty("border-bottom","2px solid var(--border-color)"),a(H,()=>e("invoiceReport.productType")),J.style.setProperty("padding","1rem"),J.style.setProperty("text-align","right"),J.style.setProperty("border-bottom","2px solid var(--border-color)"),a(J,()=>e("invoiceReport.quantity")),te.style.setProperty("padding","1rem"),te.style.setProperty("text-align","right"),te.style.setProperty("border-bottom","2px solid var(--border-color)"),a(te,()=>e("invoiceReport.totalValue")),ee.style.setProperty("padding","1rem"),ee.style.setProperty("text-align","right"),ee.style.setProperty("border-bottom","2px solid var(--border-color)"),a(ee,()=>e("invoiceReport.avgPrice")),a(ne,M(Ht,{get each(){return Array.from(W().productsByType.entries()).sort((G,ce)=>ce[1].total-G[1].total)},children:([G,ce])=>(()=>{var oe=a8(),z=oe.firstChild,de=z.nextSibling,fe=de.nextSibling,ue=fe.nextSibling;return z.style.setProperty("padding","0.75rem"),z.style.setProperty("border-bottom","1px solid var(--border-color)"),a(z,G),de.style.setProperty("padding","0.75rem"),de.style.setProperty("text-align","right"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),a(de,()=>ce.qty),fe.style.setProperty("padding","0.75rem"),fe.style.setProperty("text-align","right"),fe.style.setProperty("border-bottom","1px solid var(--border-color)"),fe.style.setProperty("font-weight","600"),a(fe,()=>b(ce.total)),ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("text-align","right"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),a(ue,()=>b(ce.total/ce.qty)),oe})()})),V}})}}),M(Ge,{get when(){return W().reservasByTypeAndPrice?.size>0},get children(){return M(Ft,{get title(){return e("invoiceReport.reservasSummary")},style:{"margin-bottom":"2rem"},get children(){var V=xb(),I=V.firstChild,F=I.firstChild,Q=F.firstChild,H=Q.firstChild,J=H.nextSibling,te=J.nextSibling,ee=te.nextSibling,ne=F.nextSibling;return V.style.setProperty("overflow-x","auto"),I.style.setProperty("width","100%"),I.style.setProperty("border-collapse","collapse"),Q.style.setProperty("background","var(--background-color)"),H.style.setProperty("padding","1rem"),H.style.setProperty("text-align","left"),H.style.setProperty("border-bottom","2px solid var(--border-color)"),a(H,()=>e("invoiceReport.reservaType")),J.style.setProperty("padding","1rem"),J.style.setProperty("text-align","right"),J.style.setProperty("border-bottom","2px solid var(--border-color)"),a(J,()=>e("invoiceReport.totalQtyLbs")),te.style.setProperty("padding","1rem"),te.style.setProperty("text-align","left"),te.style.setProperty("border-bottom","2px solid var(--border-color)"),a(te,()=>e("invoiceReport.priceGroups")),ee.style.setProperty("padding","1rem"),ee.style.setProperty("text-align","right"),ee.style.setProperty("border-bottom","2px solid var(--border-color)"),a(ee,()=>e("invoiceReport.total")),a(ne,M(Ht,{get each(){return Array.from(W().reservasByTypeAndPrice.entries()).sort((G,ce)=>ce[1].total-G[1].total)},children:([G,ce])=>(()=>{var oe=l8(),z=oe.firstChild,de=z.nextSibling,fe=de.nextSibling,ue=fe.firstChild,ge=fe.nextSibling;return z.style.setProperty("padding","0.75rem"),z.style.setProperty("border-bottom","1px solid var(--border-color)"),a(z,G),de.style.setProperty("padding","0.75rem"),de.style.setProperty("text-align","right"),de.style.setProperty("border-bottom","1px solid var(--border-color)"),de.style.setProperty("font-weight","600"),a(de,()=>ce.qty),fe.style.setProperty("padding","0.75rem"),fe.style.setProperty("border-bottom","1px solid var(--border-color)"),ue.style.setProperty("font-size","0.875rem"),a(ue,M(Ht,{get each(){return Array.from(ce.priceGroups.entries()).sort((xe,pe)=>xe[0]-pe[0])},children:([xe,pe])=>(()=>{var _e=c8(),Le=_e.firstChild,De=Le.firstChild,Te=De.nextSibling;Te.nextSibling;var $e=Le.nextSibling,Ie=$e.firstChild,Re=Ie.nextSibling;return Re.nextSibling,_e.style.setProperty("margin-bottom","0.5rem"),_e.style.setProperty("display","flex"),_e.style.setProperty("align-items","center"),_e.style.setProperty("gap","0.5rem"),a(Le,()=>b(xe),De),a(Le,()=>pe.qty,Te),$e.addEventListener("mouseleave",Ke=>Ke.currentTarget.style.background="#3498db"),$e.addEventListener("mouseenter",Ke=>Ke.currentTarget.style.background="#2980b9"),$e.$$click=()=>E({price:xe,invoices:pe.invoices,type:G}),$e.style.setProperty("background","#3498db"),$e.style.setProperty("color","white"),$e.style.setProperty("border","none"),$e.style.setProperty("border-radius","4px"),$e.style.setProperty("padding","0.25rem 0.5rem"),$e.style.setProperty("font-size","0.75rem"),$e.style.setProperty("cursor","pointer"),$e.style.setProperty("transition","background 0.2s"),a($e,()=>pe.invoices.length,Re),a($e,()=>pe.invoices.length>1?"s":"",null),_e})()})),ge.style.setProperty("padding","0.75rem"),ge.style.setProperty("text-align","right"),ge.style.setProperty("border-bottom","1px solid var(--border-color)"),ge.style.setProperty("font-weight","600"),a(ge,()=>b(ce.total)),oe})()})),V}})}}),M(Ge,{get when(){return W().otherServicesByType?.size>0},get children(){return M(Ft,{get title(){return e("invoiceReport.otherServicesTitle")},style:{"margin-bottom":"2rem"},get children(){var V=t8(),I=V.firstChild,F=I.firstChild,Q=F.firstChild,H=Q.firstChild,J=H.nextSibling,te=F.nextSibling,ee=te.firstChild,ne=ee.firstChild,G=ne.firstChild,ce=G.firstChild,oe=ne.nextSibling;return V.style.setProperty("overflow-x","auto"),I.style.setProperty("width","100%"),I.style.setProperty("border-collapse","collapse"),Q.style.setProperty("background","var(--background-color)"),H.style.setProperty("padding","1rem"),H.style.setProperty("text-align","left"),H.style.setProperty("border-bottom","2px solid var(--border-color)"),a(H,()=>e("invoiceReport.serviceType")),J.style.setProperty("padding","1rem"),J.style.setProperty("text-align","right"),J.style.setProperty("border-bottom","2px solid var(--border-color)"),a(J,()=>e("invoiceReport.total")),a(te,M(Ht,{get each(){return Array.from(W().otherServicesByType.entries()).sort((z,de)=>de[1].total-z[1].total)},children:([z,de])=>(()=>{var fe=u8(),ue=fe.firstChild,ge=ue.firstChild,xe=ge.firstChild,pe=ue.nextSibling;return ue.style.setProperty("padding","0.75rem"),ue.style.setProperty("border-bottom","1px solid var(--border-color)"),ge.style.setProperty("display","flex"),ge.style.setProperty("align-items","center"),ge.style.setProperty("gap","0.5rem"),(z==="TRANSPORTACION"?"#e3f2fd":z==="CAJAS"?"#f3e5f5":"#fff3e0")!=null?xe.style.setProperty("background",z==="TRANSPORTACION"?"#e3f2fd":z==="CAJAS"?"#f3e5f5":"#fff3e0"):xe.style.removeProperty("background"),(z==="TRANSPORTACION"?"#1976d2":z==="CAJAS"?"#7b1fa2":"#f57c00")!=null?xe.style.setProperty("color",z==="TRANSPORTACION"?"#1976d2":z==="CAJAS"?"#7b1fa2":"#f57c00"):xe.style.removeProperty("color"),xe.style.setProperty("padding","0.25rem 0.5rem"),xe.style.setProperty("border-radius","4px"),xe.style.setProperty("font-size","0.75rem"),xe.style.setProperty("font-weight","600"),a(xe,z==="TRANSPORTACION"?"🚛":z==="CAJAS"?"📦":z==="SERVICIO DE RAPEADO"?"🔧":"⚙️"),a(ge,z,null),pe.style.setProperty("padding","0.75rem"),pe.style.setProperty("text-align","right"),pe.style.setProperty("border-bottom","1px solid var(--border-color)"),pe.style.setProperty("font-weight","600"),a(pe,()=>b(de.total)),fe})()}),ee),ee.style.setProperty("background","var(--strip-color)"),ee.style.setProperty("font-weight","bold"),ne.style.setProperty("padding","0.75rem"),ne.style.setProperty("text-align","right"),ne.style.setProperty("border-top","2px solid var(--border-color)"),a(G,()=>e("invoiceReport.totalOtherServices"),ce),oe.style.setProperty("padding","0.75rem"),oe.style.setProperty("text-align","right"),oe.style.setProperty("border-top","2px solid var(--border-color)"),oe.style.setProperty("font-weight","700"),a(oe,()=>b(W().transportTotal)),V}})}}),M(Ft,{get title(){return e("invoiceReport.totalSummary")},get children(){var V=r8(),I=V.firstChild,F=I.firstChild,Q=F.nextSibling,H=I.nextSibling,J=H.firstChild,te=J.nextSibling,ee=H.nextSibling,ne=ee.firstChild,G=ne.nextSibling,ce=ee.nextSibling,oe=ce.firstChild,z=oe.nextSibling;return V.style.setProperty("display","grid"),V.style.setProperty("grid-template-columns","repeat(auto-fit, minmax(200px, 1fr))"),V.style.setProperty("gap","2rem"),V.style.setProperty("padding","2rem"),I.style.setProperty("text-align","center"),F.style.setProperty("font-size","0.875rem"),F.style.setProperty("color","var(--text-secondary)"),F.style.setProperty("margin-bottom","0.5rem"),a(F,()=>e("invoiceReport.productsTotal")),Q.style.setProperty("font-size","1.5rem"),Q.style.setProperty("font-weight","bold"),Q.style.setProperty("color","var(--primary-color)"),a(Q,()=>b(Array.from(W().productsByType.values()).reduce((de,fe)=>de+fe.total,0))),H.style.setProperty("text-align","center"),J.style.setProperty("font-size","0.875rem"),J.style.setProperty("color","var(--text-secondary)"),J.style.setProperty("margin-bottom","0.5rem"),a(J,()=>e("invoiceReport.reservasTotal")),te.style.setProperty("font-size","1.5rem"),te.style.setProperty("font-weight","bold"),te.style.setProperty("color","var(--primary-color)"),a(te,()=>b(Array.from(W().reservasByTypeAndPrice.values()).reduce((de,fe)=>de+fe.total,0))),ee.style.setProperty("text-align","center"),ne.style.setProperty("font-size","0.875rem"),ne.style.setProperty("color","var(--text-secondary)"),ne.style.setProperty("margin-bottom","0.5rem"),a(ne,()=>e("invoiceReport.transportServices")),G.style.setProperty("font-size","1.5rem"),G.style.setProperty("font-weight","bold"),G.style.setProperty("color","var(--primary-color)"),a(G,()=>b(W().transportTotal)),ce.style.setProperty("text-align","center"),ce.style.setProperty("border-left","2px solid var(--primary-color)"),ce.style.setProperty("padding-left","2rem"),oe.style.setProperty("font-size","0.875rem"),oe.style.setProperty("color","var(--text-secondary)"),oe.style.setProperty("margin-bottom","0.5rem"),a(oe,()=>e("invoiceReport.grandTotal")),z.style.setProperty("font-size","2rem"),z.style.setProperty("font-weight","bold"),z.style.setProperty("color","var(--primary-color)"),a(z,()=>b(W().paymentMethods.total)),V}})]}}),null),a(K,M(Ge,{get when(){return r()},get children(){var V=n8(),I=V.firstChild;return V.style.setProperty("text-align","center"),V.style.setProperty("padding","3rem"),I.style.setProperty("font-size","1.25rem"),I.style.setProperty("margin-bottom","1rem"),a(I,()=>e("invoiceReport.generatingReport")),V}}),null),a(K,M(Ge,{get when(){return re()},get children(){var V=i8(),I=V.firstChild,F=I.firstChild,Q=F.firstChild,H=Q.nextSibling,J=F.nextSibling,te=J.firstChild,ee=te.firstChild,ne=ee.nextSibling,G=te.nextSibling,ce=G.firstChild,oe=ce.nextSibling,z=G.nextSibling,de=z.firstChild,fe=de.nextSibling,ue=J.nextSibling,ge=ue.firstChild,xe=ge.firstChild,pe=ge.nextSibling,_e=ue.nextSibling;return V.$$click=()=>E(null),V.style.setProperty("position","fixed"),V.style.setProperty("top","0"),V.style.setProperty("left","0"),V.style.setProperty("right","0"),V.style.setProperty("bottom","0"),V.style.setProperty("background","rgba(0, 0, 0, 0.5)"),V.style.setProperty("display","flex"),V.style.setProperty("align-items","center"),V.style.setProperty("justify-content","center"),V.style.setProperty("z-index","1000"),I.$$click=Le=>Le.stopPropagation(),I.style.setProperty("background","white"),I.style.setProperty("padding","2rem"),I.style.setProperty("border-radius","var(--border-radius)"),I.style.setProperty("max-width","600px"),I.style.setProperty("max-height","80vh"),I.style.setProperty("overflow-y","auto"),I.style.setProperty("box-shadow","var(--shadow-lg)"),F.style.setProperty("display","flex"),F.style.setProperty("justify-content","space-between"),F.style.setProperty("align-items","center"),F.style.setProperty("margin-bottom","1.5rem"),Q.style.setProperty("font-size","1.25rem"),Q.style.setProperty("font-weight","bold"),a(Q,()=>e("invoiceReport.invoiceReferences")),H.$$click=()=>E(null),H.style.setProperty("background","none"),H.style.setProperty("border","none"),H.style.setProperty("font-size","1.5rem"),H.style.setProperty("cursor","pointer"),H.style.setProperty("color","#666"),J.style.setProperty("margin-bottom","1rem"),te.style.setProperty("font-size","0.875rem"),te.style.setProperty("color","var(--text-secondary)"),a(te,()=>e("invoiceReport.type"),ee),a(ne,()=>re().type),G.style.setProperty("font-size","0.875rem"),G.style.setProperty("color","var(--text-secondary)"),a(G,()=>e("invoiceReport.pricePerPound"),ce),a(oe,()=>b(re().price)),z.style.setProperty("font-size","0.875rem"),z.style.setProperty("color","var(--text-secondary)"),a(z,()=>e("invoiceReport.totalInvoicesCount"),de),a(fe,()=>re().invoices.length),ue.style.setProperty("border","1px solid var(--border-color)"),ue.style.setProperty("border-radius","var(--border-radius-sm)"),ue.style.setProperty("padding","1rem"),ue.style.setProperty("background","var(--background-color)"),ge.style.setProperty("font-weight","600"),ge.style.setProperty("margin-bottom","0.75rem"),a(ge,()=>e("invoiceReport.invoiceNumbers"),xe),pe.style.setProperty("display","grid"),pe.style.setProperty("grid-template-columns","repeat(auto-fill, minmax(120px, 1fr))"),pe.style.setProperty("gap","0.5rem"),a(pe,M(Ht,{get each(){return re().invoices},children:Le=>(()=>{var De=wb();return De.$$click=()=>{const Te=U().find($e=>$e.invoice===Le);Te&&console.log("Invoice details:",Te)},De.addEventListener("mouseleave",Te=>{Te.currentTarget.style.background="white",Te.currentTarget.style.borderColor="var(--border-color)"}),De.addEventListener("mouseenter",Te=>{Te.currentTarget.style.background="#e3f2fd",Te.currentTarget.style.borderColor="#2196f3"}),De.style.setProperty("padding","0.5rem"),De.style.setProperty("background","white"),De.style.setProperty("border","1px solid var(--border-color)"),De.style.setProperty("border-radius","var(--border-radius-sm)"),De.style.setProperty("font-family","monospace"),De.style.setProperty("font-size","0.875rem"),De.style.setProperty("text-align","center"),De.style.setProperty("transition","all 0.2s"),De.style.setProperty("cursor","pointer"),a(De,Le),De})()})),_e.style.setProperty("margin-top","1.5rem"),_e.style.setProperty("display","flex"),_e.style.setProperty("justify-content","flex-end"),_e.style.setProperty("gap","1rem"),a(_e,M(dt,{variant:"outline",onClick:()=>{const Le=re().invoices.join(", ");navigator.clipboard.writeText(Le).then(()=>{alert(e("invoiceReport.invoiceNumbersCopied"))})},get children(){return e("invoiceReport.copyInvoiceNumbers")}}),null),a(_e,M(dt,{variant:"primary",onClick:()=>E(null),get children(){return e("invoiceReport.close")}}),null),V}}),null),K})()};yr(["click"]);var h8=he("<div><div>"),p8=he("<div>⚠️ "),f8=he("<div><div><label></label><select><option value=all></option></select></div><div><label></label><input type=date></div><div><label></label><input type=date></div><div><label></label><input type=text>"),m8=he("<div><button></button><button></button><button>➕ Crear Nueva Factura</button><button>📊 Resume Report"),el=he("<div>"),y8=he("<div><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody>"),g8=he("<button>← "),v8=he("<option>"),b8=he("<div><div></div><div></div><div></div><div>"),Ab=he("<div><span></span><span> "),_8=he("<div><span></span><span> $"),S8=he("<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td><span></span></td><td><button>");const dh=t=>parseFloat(t?.toString())||0,b_=t=>{let e=dh(t.qty),r=dh(t.price),n=dh(t.arancel);return`${(e*r+n)?.toFixed(2)}`},__=t=>{let e=Math.abs(t.qty),r=dh(t.salePrice);return`${(e*r)?.toFixed(2)}`},P8=t=>{let e=0;t?.reservas?.forEach(i=>{e+=parseFloat(b_(i))});let r=0;t?.products?.forEach(i=>{r+=parseFloat(__(i))});let n={};return n.reservaSubtotal=e.toFixed(2),n.productSubtotal=r.toFixed(2),n.subtotalBeforeTax=(r+e).toFixed(2),n.total=n.subtotalBeforeTax,n},w8=t=>{const{t:e}=sr(),[r,n]=Ce(!1),[i,o]=Ce("all"),[s,l]=Ce(""),[c,u]=Ce(""),[h,y]=Ce(null),[g,f]=Ce(null),[x,S]=Ce("dashboard"),[P,$]=Ce([]),[U,se]=Ce(""),[X,Z]=Ce("overview");Sn(async()=>{try{t.invoices;try{const ne=await Ri.fetchStores();let G=Array.isArray(ne)?ne:Object.keys(ne)||[]}catch{const G=Ri.state.invoices||t.invoices,ce=[...new Set(G.map(oe=>oe.store))];$(ce.sort())}}catch(ne){console.error("Error loading dashboard data:",ne)}}),Dt(()=>Ri.state.invoices||t.invoices);const re=Dt(()=>{let ne;return t.invoices?ne=Ri.getFilteredInvoices({store:i(),dateFrom:s(),dateTo:c()}):ne=Ri.getFilteredInvoices({store:i(),dateFrom:s(),dateTo:c()}),ne}),E=async()=>{try{t.invoices,n(!0),await Ri.refreshData({store:i()!=="all"?i():void 0,dateFrom:s()||void 0,dateTo:c()||void 0,search:U()}),n(!1)}catch(ne){console.error("Error refreshing data:",ne)}},C=Dt(()=>{r();const ne=re(),G=Ri.calculateSummary(ne);let ce=new Map,oe=new Map,z=new Map;return ne.forEach(de=>{de?.products?.length>0&&de?.products?.forEach(fe=>{const ue=Math.abs(fe.qty),ge=fe.product.label;ce.set(ge,(ce.get(ge)||0)+ue)}),de?.reservas?.length>0&&de?.reservas?.forEach(fe=>{let ue=parseInt(fe.qty);isNaN(ue)&&(ue=0),{TRANSPORTACION:1,"OTROS SERVICIO":1,OTROS:1,"SERVICIO DE RAPEADO":1,CAJAS:1}[fe.type]||fe?.onlyTariff?(ue=parseFloat(fe.arancel)||parseFloat(fe.qty)*parseFloat(fe.price),z.set(fe.type,(oe.get(fe.type)||0)+ue)):oe.set(fe.type,(oe.get(fe.type)||0)+ue)})}),{...G,productsByCategory:ce,reservasByType:oe,othersByType:z}}),T=ne=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ne),j=ne=>new Date(ne).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),b={padding:"2rem"},w={display:"flex",gap:"1rem","align-items":"flex-end","margin-bottom":"2rem","flex-wrap":"wrap",padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)"},_={display:"flex","flex-direction":"column",gap:"0.5rem",flex:"1","min-width":"200px"},W={"font-size":"0.875rem","font-weight":"500",color:"var(--text-secondary)"},K={padding:"0.75rem",border:"1px solid var(--border-color)","border-radius":"var(--border-radius-sm)","font-size":"1rem",background:"var(--background-color)"},k={display:"grid","grid-template-columns":"repeat(auto-fit, minmax(280px, 1fr))",gap:"1.5rem","margin-bottom":"2rem"},R={padding:"1.5rem",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",border:"1px solid var(--border-color)"},Y={width:"48px",height:"48px","border-radius":"12px",display:"flex","align-items":"center","justify-content":"center","font-size":"1.5rem","margin-bottom":"1rem"},q={"font-size":"0.875rem",color:"var(--text-secondary)","margin-bottom":"0.5rem"},O={"font-size":"1.75rem","font-weight":"700",color:"var(--text-primary)","margin-bottom":"0.25rem"},le={"font-size":"0.75rem",color:"var(--text-muted)"},N={width:"100%",background:"var(--surface-color)","border-radius":"var(--border-radius)","box-shadow":"var(--shadow-sm)",overflow:"hidden"},D={padding:"1rem","text-align":"left",background:"var(--background-color)","font-weight":"600",color:"var(--text-secondary)","font-size":"0.875rem","border-bottom":"2px solid var(--border-color)"},V={padding:"1rem","border-bottom":"1px solid var(--border-color)"},I={display:"flex","border-bottom":"1px solid var(--border-color)","margin-bottom":"1.5rem"},F=ne=>({padding:"0.75rem 1rem",background:"none",border:"none",cursor:"pointer","font-weight":"500",color:ne?"var(--primary-color)":"var(--text-muted)","border-bottom":ne?"2px solid var(--primary-color)":"2px solid transparent",transition:"all 0.2s ease"}),Q={padding:"0.5rem 1rem",background:"var(--primary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","font-size":"0.875rem",transition:"opacity 0.2s"},H={padding:"0.75rem 1.5rem",background:"var(--secondary-color)",color:"white",border:"none","border-radius":"var(--border-radius-sm)",cursor:"pointer","margin-bottom":"1rem",display:"flex","align-items":"center",gap:"0.5rem"},J=()=>[{title:e("invoices.totalRevenue"),value:C().grandTotal,icon:"💰",color:"#4CAF50",subtext:`${e("common.of")} ${C().totalInvoices} ${e("common.invoice")} `},{title:e("invoices.totalProducts"),value:C().totalProducts,icon:"📦",color:"#2196F3",subtext:`${T(C().totalProductAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.totalReservations"),value:C().totalReservas,icon:"🎫",color:"#FF9800",subtext:`${T(C().totalReservaAmount)} ${e("invoices.value")}`,isNumber:!0},{title:e("invoices.aranceles"),value:C().totalAranceles,icon:"🏛️",color:"#9C27B0",subtext:e("invoices.customsFees")},{title:e("invoices.uniqueCustomers"),value:C().uniqueCustomers,icon:"👥",color:"#00BCD4",subtext:e("invoices.activeCustomers"),isNumber:!0},{title:e("invoices.averageInvoice"),value:C().avgInvoiceValue,icon:"📊",color:"#FF5722",subtext:e("invoices.perInvoiceValue")},{title:e("invoices.completed"),value:C().completedInvoices,icon:"✅",color:"#4CAF50",subtext:`${C().pendingInvoices} ${e("invoices.pending")}`,isNumber:!0},{title:e("invoices.storesActive"),value:P().length,icon:"🏪",color:"#795548",subtext:e("invoices.locations"),isNumber:!0}],te=()=>ct.getActiveLocations();yi(()=>{});const ee=async()=>{let ne="YB1";qy.calcStockLevels(),await ct.fecthProduct(ne),await ct.fecthInventory(ne)};return Sn(()=>{ee()}),M(Qi,{get title(){return e("invoices.title")},get children(){var ne=el();return m(ne,b),a(ne,M(Ge,{get when(){return x()==="dashboard"},get children(){return[M(Ge,{get when(){return!t.invoices&&Ri.state.loading},get children(){var G=h8(),ce=G.firstChild;return G.style.setProperty("text-align","center"),G.style.setProperty("padding","2rem"),ce.style.setProperty("font-size","1.25rem"),ce.style.setProperty("margin-bottom","1rem"),a(ce,()=>e("invoices.loadingInvoices")),G}}),M(Ge,{get when(){return Ri.state.error},get children(){var G=p8();return G.firstChild,G.style.setProperty("padding","1rem"),G.style.setProperty("margin-bottom","1rem"),G.style.setProperty("background","#ffebee"),G.style.setProperty("border","1px solid #ffcdd2"),G.style.setProperty("border-radius","var(--border-radius)"),G.style.setProperty("color","#d32f2f"),a(G,()=>Ri.state.error,null),a(G,M(dt,{variant:"outline",size:"sm",onClick:E,style:{"margin-left":"1rem"},get children(){return e("invoices.refreshData")}}),null),G}}),(()=>{var G=f8(),ce=G.firstChild,oe=ce.firstChild,z=oe.nextSibling,de=z.firstChild,fe=ce.nextSibling,ue=fe.firstChild,ge=ue.nextSibling,xe=fe.nextSibling,pe=xe.firstChild,_e=pe.nextSibling,Le=xe.nextSibling,De=Le.firstChild,Te=De.nextSibling;return m(G,w),a(oe,()=>e("invoices.storeLocation")),z.addEventListener("change",$e=>o($e.currentTarget.value)),a(de,()=>e("invoices.allStores")),a(z,M(Ht,{get each(){return te()},children:$e=>(()=>{var Ie=v8();return a(Ie,()=>$e.name),Se(()=>Ie.value=$e.id),Ie})()}),null),a(ue,()=>e("invoices.fromDate")),ge.addEventListener("change",$e=>l($e.currentTarget.value)),a(pe,()=>e("invoices.toDate")),_e.addEventListener("change",$e=>u($e.currentTarget.value)),a(De,()=>e("invoices.search")),Te.addEventListener("change",$e=>se($e.currentTarget.value)),a(G,M(dt,{variant:"secondary",onClick:()=>{o("all"),l(""),u(""),se("")},get children(){return e("invoices.clearFilters")}}),null),a(G,M(dt,{variant:"primary",onClick:E,get disabled(){return!t.invoices&&Ri.state.loading},get children(){return["🔄 ",Ee(()=>e("invoices.refreshData"))]}}),null),Se($e=>{var Ie=_,Re=W,Ke=K,je=_,We=W,Qe=K,at=_,nt=W,Ye=K,ht=_,lt=W,$t=K,_t=e("invoices.searchPlaceholder");return $e.e=m(ce,Ie,$e.e),$e.t=m(oe,Re,$e.t),$e.a=m(z,Ke,$e.a),$e.o=m(fe,je,$e.o),$e.i=m(ue,We,$e.i),$e.n=m(ge,Qe,$e.n),$e.s=m(xe,at,$e.s),$e.h=m(pe,nt,$e.h),$e.r=m(_e,Ye,$e.r),$e.d=m(Le,ht,$e.d),$e.l=m(De,lt,$e.l),$e.u=m(Te,$t,$e.u),_t!==$e.c&&nr(Te,"placeholder",$e.c=_t),$e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0}),Se(()=>z.value=i()),Se(()=>ge.value=s()),Se(()=>_e.value=c()),Se(()=>Te.value=U()),G})(),(()=>{var G=m8(),ce=G.firstChild,oe=ce.nextSibling,z=oe.nextSibling,de=z.nextSibling;return m(G,I),ce.$$click=()=>Z("overview"),a(ce,()=>e("inventory.overview")),oe.$$click=()=>Z("invoices"),a(oe,()=>e("invoices.invoices")),z.$$click=()=>Z("add"),de.$$click=()=>Z("report"),Se(fe=>{var ue=F(X()==="overview"),ge=F(X()==="invoices"),xe=F(X()==="add"),pe=F(X()==="report");return fe.e=m(ce,ue,fe.e),fe.t=m(oe,ge,fe.t),fe.a=m(z,xe,fe.a),fe.o=m(de,pe,fe.o),fe},{e:void 0,t:void 0,a:void 0,o:void 0}),G})(),M(Ge,{get when(){return X()==="overview"},get children(){return[(()=>{var G=el();return m(G,k),a(G,M(Ht,{get each(){return J()},children:ce=>(()=>{var oe=b8(),z=oe.firstChild,de=z.nextSibling,fe=de.nextSibling,ue=fe.nextSibling;return m(oe,R),a(z,()=>ce?.icon),m(de,q),a(de,()=>ce?.title),m(fe,O),a(fe,(()=>{var ge=Ee(()=>!!ce.isNumber);return()=>ge()?ce.value:T(ce.value)})()),m(ue,le),a(ue,()=>ce.subtext),Se(ge=>m(z,{...Y,background:`${ce?.color}20`,color:ce?.color},ge)),oe})()})),G})(),M(Ge,{get when(){return C()?.productsByCategory?.size>0},get children(){return M(Ft,{get title(){return e("invoices.topProducts")},get subtitle(){return e("invoices.mostSoldProducts")},get children(){var G=el();return G.style.setProperty("max-height","300px"),G.style.setProperty("overflow-y","auto"),a(G,()=>Array.from(C().productsByCategory.entries()).sort((ce,oe)=>oe[1]-ce[1]).slice(0,10).map(([ce,oe])=>(()=>{var z=Ab(),de=z.firstChild,fe=de.nextSibling,ue=fe.firstChild;return z.style.setProperty("display","flex"),z.style.setProperty("justify-content","space-between"),z.style.setProperty("padding","0.75rem"),z.style.setProperty("border-bottom","1px solid var(--border-color)"),a(de,ce),fe.style.setProperty("font-weight","600"),a(fe,oe,ue),a(fe,()=>e("common.units"),null),z})())),G}})}}),(()=>{var G=el();return G.style.setProperty("margin","19px"),G})(),M(Ge,{get when(){return C()?.reservasByType?.size>0},get children(){return M(Ft,{get title(){return e("invoices.reservationsByType")},get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var G=el();return G.style.setProperty("max-height","300px"),G.style.setProperty("overflow-y","auto"),a(G,()=>Array.from(C().reservasByType.entries()).sort((ce,oe)=>oe[1]-ce[1]).map(([ce,oe])=>(()=>{var z=Ab(),de=z.firstChild,fe=de.nextSibling,ue=fe.firstChild;return z.style.setProperty("display","flex"),z.style.setProperty("justify-content","space-between"),z.style.setProperty("padding","0.75rem"),z.style.setProperty("border-bottom","1px solid var(--border-color)"),a(de,ce),fe.style.setProperty("font-weight","600"),a(fe,oe,ue),a(fe,()=>e("common.lbs"),null),z})())),G}})}}),(()=>{var G=el();return G.style.setProperty("margin","19px"),G})(),M(Ge,{get when(){return C()?.othersByType?.size>0},get children(){return M(Ft,{title:"Aranceles y otros servicios",get subtitle(){return e("invoices.distributionOfCategories")},style:{"margin-top":"1.5rem"},get children(){var G=el();return G.style.setProperty("max-height","300px"),G.style.setProperty("overflow-y","auto"),a(G,()=>Array.from(C().othersByType.entries()).sort((ce,oe)=>oe[1]-ce[1]).map(([ce,oe])=>(()=>{var z=_8(),de=z.firstChild,fe=de.nextSibling,ue=fe.firstChild;return z.style.setProperty("display","flex"),z.style.setProperty("justify-content","space-between"),z.style.setProperty("padding","0.75rem"),z.style.setProperty("border-bottom","1px solid var(--border-color)"),a(de,ce),fe.style.setProperty("font-weight","600"),a(fe,oe,ue),z})())),G}})}})]}})]}}),null),a(ne,M(Ge,{get when(){return X()==="invoices"},get children(){return[M(Ge,{get when(){return x()!=="detail"},get children(){return M(Ft,{get title(){return e("invoices.recentInvoices")},get subtitle(){return`Mostrando ${re().length} facturas`},style:{"margin-top":"1.5rem"},get children(){var G=y8(),ce=G.firstChild,oe=ce.firstChild,z=oe.firstChild,de=z.firstChild,fe=de.nextSibling,ue=fe.nextSibling,ge=ue.nextSibling,xe=ge.nextSibling,pe=xe.nextSibling,_e=pe.nextSibling,Le=_e.nextSibling,De=Le.nextSibling,Te=oe.nextSibling;return G.style.setProperty("overflow-x","auto"),m(ce,N),a(de,()=>e("invoices.invoiceNumber")),a(fe,()=>e("invoices.date")),a(ue,()=>e("invoices.customer")),a(ge,()=>e("invoices.store")),a(xe,()=>e("invoices.products")),a(pe,()=>e("invoices.reservations")),a(_e,()=>e("invoices.total")),a(Le,()=>e("invoices.status")),a(De,()=>e("invoices.actions")),a(Te,M(Ht,{get each(){return re().slice(0,50)},children:$e=>{console.log($e);const Ie=()=>{let Re=Wh($e);return Re.productSubtotal,Re.reservaSubtotal,Re.total,Re};return(()=>{var Re=S8(),Ke=Re.firstChild,je=Ke.nextSibling,We=je.nextSibling,Qe=We.nextSibling,at=Qe.nextSibling,nt=at.nextSibling,Ye=nt.nextSibling,ht=Ye.nextSibling,lt=ht.firstChild,$t=ht.nextSibling,_t=$t.firstChild;return a(Ke,()=>$e?.invoice),a(je,()=>j($e?.createDate)),a(We,()=>$e?.shipper_consignee?.name),a(Qe,()=>$e?.store),a(at,()=>Ie()?.productSubtotal),a(nt,()=>Ie()?.reservaSubtotal),a(Ye,()=>T(Ie()?.total)),lt.style.setProperty("padding","0.25rem 0.75rem"),lt.style.setProperty("border-radius","9999px"),lt.style.setProperty("font-size","0.75rem"),lt.style.setProperty("font-weight","600"),a(lt,(()=>{var ze=Ee(()=>!!$e.isCompleted);return()=>ze()?e("invoices.completed"):e("invoices.pending")})()),_t.addEventListener("mouseleave",ze=>ze.currentTarget.style.opacity="1"),_t.addEventListener("mouseenter",ze=>ze.currentTarget.style.opacity="0.8"),_t.$$click=()=>{f(Wh($e)),y($e),S("detail")},m(_t,Q),a(_t,()=>e("invoices.view")),Se(ze=>{var Lt=V,Nt=V,wt=V,Ot=V,gr=V,Be=V,Pt={...V,"text-align":"right","font-weight":"600"},Ct=V,tt=$e.isCompleted?"#d4edda":"#fff3cd",ft=$e.isCompleted?"#155724":"#856404",Vt=V;return ze.e=m(Ke,Lt,ze.e),ze.t=m(je,Nt,ze.t),ze.a=m(We,wt,ze.a),ze.o=m(Qe,Ot,ze.o),ze.i=m(at,gr,ze.i),ze.n=m(nt,Be,ze.n),ze.s=m(Ye,Pt,ze.s),ze.h=m(ht,Ct,ze.h),tt!==ze.r&&((ze.r=tt)!=null?lt.style.setProperty("background",tt):lt.style.removeProperty("background")),ft!==ze.d&&((ze.d=ft)!=null?lt.style.setProperty("color",ft):lt.style.removeProperty("color")),ze.l=m($t,Vt,ze.l),ze},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0}),Re})()}})),Se($e=>{var Ie=D,Re=D,Ke=D,je=D,We=D,Qe=D,at={...D,"text-align":"right"},nt=D,Ye=D;return $e.e=m(de,Ie,$e.e),$e.t=m(fe,Re,$e.t),$e.a=m(ue,Ke,$e.a),$e.o=m(ge,je,$e.o),$e.i=m(xe,We,$e.i),$e.n=m(pe,Qe,$e.n),$e.s=m(_e,at,$e.s),$e.h=m(Le,nt,$e.h),$e.r=m(De,Ye,$e.r),$e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),G}})}}),M(Ge,{get when(){return Ee(()=>x()==="detail")()&&h()},get children(){return[(()=>{var G=g8();return G.firstChild,G.$$click=()=>{S("dashboard"),y(null)},m(G,H),a(G,()=>e("invoices.backToDashboard"),null),G})(),M(BR,{get invoice(){return h()},onPrint:()=>window.print(),get parseData(){return g()},goBack:()=>{S("dashboard"),y(null)}})]}})]}}),null),a(ne,M(Ge,{get when(){return X()==="add"},get children(){return M(VD,{})}}),null),a(ne,M(Ge,{get when(){return X()==="report"},get children(){return M(d8,{})}}),null),ne}})};yr(["click"]);const x8=()=>M(w8,{invoices:[{type:"SALES",invoice:"20255FK6S4B43SSS",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCim",ssg_sorder_key:"JqdrRwGBpdBfRCim",createDate:1736132690425,shipper_consignee:{name:"Yudith Perez Medero",phoneNumberS:"5022408378",dob:"1982-07-23",firstName:"RAUL",lastName:"BATISTA",lastName2:"ESPOSITO",middleName:"",email:"",phoneNumber:"52393232",altPhoneNumber:"",cid:"48121007305",ybstreetNo:"9",ybstreet:"10",ybbetwen1:"CARRALERO",ybbetwen2:"3RA",ybapt:"",ybreparto:"PUEBLO NUEVO",consigneeId:"26144",ssg_consignee_key:"26144",passport:"NA",nacionality:"CUB",ybcity:"HOLGUIN",ybestate:"HOLGUIN",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534800",reservas:[{type:"UTILES DEL HOGAR",qty:"15",arancel:"10",price:"5",key:"1GB16SD80"},{type:"MISCELANEAS",qty:"19",arancel:"",price:"4",key:"0DS6K14Y2"}],products:[{product:{id:"CmrhMfVjLR9HxT6P",label:"FOGONES ELECTRICO DOBLE RESISTENCIA DE ALAMBRE",code:"978Y82K94"},qty:-1,price:23.696296296296296,salePrice:"34"},{product:{id:"ov56aPYGbXIq4XGy",label:"Caramelos",code:"C852CSKB5"},qty:-2,price:5.990000000000001,salePrice:"10"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43TTT",description:"",store:"YY_8803",ssg_inventory_key:"JqdrRwGBpdBfRCin",ssg_sorder_key:"JqdrRwGBpdBfRCin",createDate:1736032690425,shipper_consignee:{name:"Maria Rodriguez Santos",phoneNumberS:"5024567890",dob:"1990-03-15",firstName:"MARIA",lastName:"RODRIGUEZ",lastName2:"SANTOS",middleName:"ELENA",email:"maria@email.com",phoneNumber:"52987654",altPhoneNumber:"",cid:"90031507890",ybstreetNo:"15",ybstreet:"23",ybbetwen1:"MARTI",ybbetwen2:"CESPEDES",ybapt:"2A",ybreparto:"CENTRO",consigneeId:"26145",ssg_consignee_key:"26145",passport:"A1234567",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534801",reservas:[{type:"ELECTRONICOS",qty:"5",arancel:"15",price:"12",key:"2GB16SD81"},{type:"ROPA Y CALZADO",qty:"8",arancel:"8",price:"7",key:"0DS6K14Y3"}],products:[{product:{id:"XmrhMfVjLR9HxT6Q",label:"TELEVISOR LED 32 PULGADAS",code:"TV32LED01"},qty:-1,price:150.5,salePrice:"220"},{product:{id:"Yv56aPYGbXIq4XGz",label:"Zapatos Deportivos Nike",code:"ZAP001"},qty:-1,price:45.99,salePrice:"75"}],isCompleted:!1},{type:"SALES",invoice:"20255FK6S4B43UUU",description:"",store:"YY_8816",ssg_inventory_key:"JqdrRwGBpdBfRCio",ssg_sorder_key:"JqdrRwGBpdBfRCio",createDate:1735932690425,shipper_consignee:{name:"Carlos Mendez Perez",phoneNumberS:"5025678901",dob:"1975-12-08",firstName:"CARLOS",lastName:"MENDEZ",lastName2:"PEREZ",middleName:"ANTONIO",email:"",phoneNumber:"52876543",altPhoneNumber:"",cid:"75120878901",ybstreetNo:"7",ybstreet:"45",ybbetwen1:"LINEA",ybbetwen2:"PASEO",ybapt:"",ybreparto:"VEDADO",consigneeId:"26146",ssg_consignee_key:"26146",passport:"NA",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:""},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534802",reservas:[{type:"ALIMENTOS",qty:"25",arancel:"5",price:"3",key:"3GB16SD82"}],products:[{product:{id:"ZmrhMfVjLR9HxT6R",label:"ARROZ ESPECIAL 5LB",code:"ARZ005"},qty:-5,price:2.5,salePrice:"4"},{product:{id:"Av56aPYGbXIq4XG1",label:"ACEITE DE COCINA 1L",code:"ACE001"},qty:-3,price:3.75,salePrice:"6"}],isCompleted:!0},{type:"SALES",invoice:"20255FK6S4B43VVV",description:"",store:"YY_8802",ssg_inventory_key:"JqdrRwGBpdBfRCip",ssg_sorder_key:"JqdrRwGBpdBfRCip",createDate:1735832690425,shipper_consignee:{name:"Ana Lucia Fernandez",phoneNumberS:"5026789012",dob:"1988-06-20",firstName:"ANA",lastName:"FERNANDEZ",lastName2:"LOPEZ",middleName:"LUCIA",email:"ana.lucia@email.com",phoneNumber:"52765432",altPhoneNumber:"52111222",cid:"88062076789",ybstreetNo:"12",ybstreet:"18",ybbetwen1:"CALZADA",ybbetwen2:"SAN LAZARO",ybapt:"3B",ybreparto:"CENTRO HABANA",consigneeId:"26147",ssg_consignee_key:"26147",passport:"B9876543",nacionality:"CUB",ybcity:"HAVANA",ybestate:"HAVANA",comment:"Entrega en horario de oficina"},packagesOrder:!0,businessId:"YB100423253156428",userId:"108694446087560534803",reservas:[{type:"MEDICINA Y SALUD",qty:"10",arancel:"12",price:"8",key:"4GB16SD83"},{type:"UTILES DEL HOGAR",qty:"6",arancel:"6",price:"4",key:"5GB16SD84"}],products:[{product:{id:"BmrhMfVjLR9HxT6S",label:"VITAMINAS MULTIPLES 60 CAP",code:"VIT001"},qty:-2,price:12.5,salePrice:"18"}],isCompleted:!0}]}),hh={invoice:"",description:"",store:"",shipper_consignee:{name:"",firstName:"",middleName:"",lastName:"",lastName2:"",phoneNumber:"",cid:"",passport:"",address:""},products:[],reservas:[],packagesOrder:!1,shippingType:"SEA"},Jy="invoice_form_draft",A8=()=>{try{const t=localStorage.getItem(Jy);if(t){const e=JSON.parse(t),r={...hh,...e,shipper_consignee:{...hh.shipper_consignee,...e.shipper_consignee||{}},products:e.products||[],reservas:e.reservas||[]};return console.log("Loaded form data from storage:",r),r}}catch(t){console.warn("Failed to load invoice form from storage:",t)}return console.log("No saved data found, using default form data"),{...hh}},Qy=t=>{try{localStorage.setItem(Jy,JSON.stringify(t))}catch(e){console.warn("Failed to save invoice form to storage:",e)}},Cb=()=>{try{localStorage.removeItem(Jy)}catch(t){console.warn("Failed to clear invoice form from storage:",t)}},[al,vs]=Ce(A8()),[S_,wo]=Ce(!1),[C8,ph]=Ce(null);let Bf=null;const ua=()=>{Bf&&clearTimeout(Bf),Bf=setTimeout(()=>{const t=al();Qy(t),ph(new Date),console.log("Invoice form auto-saved at",new Date().toLocaleTimeString())},1e3)},I8={formData:al,get isDirty(){return S_()},get lastSaved(){return C8()},updateForm:t=>{vs(e=>{const r={...e,...t};return wo(!0),ua(),r})},updateShipperConsignee:t=>{vs(e=>{const r={...e,shipper_consignee:{...e.shipper_consignee,...t}};return wo(!0),ua(),r})},addProduct:t=>{vs(e=>{const r={...e,products:[...e.products,t]};return wo(!0),ua(),r})},updateProduct:(t,e)=>{vs(r=>{const n=[...r.products];n[t]={...n[t],...e};const i={...r,products:n};return wo(!0),ua(),i})},removeProduct:t=>{vs(e=>{const r=e.products.filter((i,o)=>o!==t),n={...e,products:r};return wo(!0),ua(),n})},addReserva:t=>{vs(e=>{const r={...e,reservas:[...e.reservas,t]};return wo(!0),ua(),r})},updateReserva:(t,e)=>{vs(r=>{const n=[...r.reservas];n[t]={...n[t],...e};const i={...r,reservas:n};return wo(!0),ua(),i})},removeReserva:t=>{vs(e=>{const r=e.reservas.filter((i,o)=>o!==t),n={...e,reservas:r};return wo(!0),ua(),n})},clearForm:()=>{vs({...hh}),wo(!1),Cb(),ph(null)},markCompleted:()=>{Cb(),wo(!1),ph(null)},forceSave:()=>{Qy(al()),ph(new Date),wo(!1)},hasData:()=>{const t=al();return t.invoice!==""||t.description!==""||t.store!==""||t.shipper_consignee.name!==""||t.shipper_consignee.firstName!==""||t.shipper_consignee.cid!==""||t.products.length>0||t.reservas.length>0},isValid:()=>{const t=al();return t.invoice.trim()!==""&&t.shipper_consignee.firstName.trim()!==""&&t.shipper_consignee.lastName.trim()!==""&&t.shipper_consignee.cid.trim()!==""&&(t.products.length>0||t.reservas.length>0)},getFormData:()=>al()};typeof window<"u"&&window.addEventListener("beforeunload",t=>{if(S_()&&(Qy(al()),I8.hasData()))return t.preventDefault(),t.returnValue="You have unsaved changes in your invoice. Are you sure you want to leave?",t.returnValue});var $8=he("<div><main>");const E8=t=>[M(y$,{}),Ee(()=>t.children)],T8=()=>M(GI,{get children(){var t=$8(),e=t.firstChild;return a(e,M(pP,{root:E8,get children(){return[M(so,{path:"/",component:mR}),M(so,{path:"/accounts",component:()=>M(_o,{permission:"AccountAccess",featureName:"Accounts",get children(){return M(sE,{})}})}),M(so,{path:"/accounts/:id",component:()=>M(_o,{permission:"AccountAccess",featureName:"Account Details",get children(){return M(pE,{})}})}),M(so,{path:"/entry-books",component:()=>M(_o,{permission:"JournalAccess",featureName:"Entry Books",get children(){return M(yL,{})}})}),M(so,{path:"/employees",component:()=>M(_o,{permission:"EmployeeAccess",featureName:"Employee Management",get children(){return M(pN,{})}})}),M(so,{path:"/bank-consolidations",component:()=>M(_o,{permission:"BankingAccess",featureName:"Bank Consolidations",get children(){return M(VN,{})}})}),M(so,{path:"/balance-sheet",component:()=>M(_o,{permission:"AccountAccess",featureName:"Balance Sheet",get children(){return M(bE,{})}})}),M(so,{path:"/invoices",component:()=>M(_o,{permission:"invoiceAccess",featureName:"Invoices",get children(){return M(x8,{})}})}),M(so,{path:"/inventory",component:()=>M(_o,{permission:"InventoryAccess",featureName:"Inventory Management",get children(){return M(iN,{})}})}),M(so,{path:"/products",component:()=>M(_o,{permission:"InventoryAccess",featureName:"Product Management",get children(){return M(k5,{})}})}),M(so,{path:"/hbl",component:()=>M(_o,{permission:"HBLAccess",featureName:"HBL Management",get children(){return M(lR,{})}})}),M(so,{path:"/admin/users",component:()=>M(_o,{permission:"isAdmin",featureName:"User Administration",get children(){return M($R,{})}})})]}})),a(t,(()=>{var r=Ee(()=>!1);return()=>r()&&M($$,{})})(),null),t}}),k8=document.getElementById("root");$S(()=>M(T8,{}),k8);export{dr as E,Oi as _,tn as a,D8 as b,ct as i,r_ as j};
